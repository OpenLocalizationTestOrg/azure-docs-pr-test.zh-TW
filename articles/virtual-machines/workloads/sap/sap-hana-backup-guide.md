---
title: "aaaBackup 指南的 SAP HANA Azure 虛擬機器上 |Microsoft 文件"
description: "SAP HANA 備份指南說明備份 Azure 虛擬機器上 SAP HANA 的兩種主要做法"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: e651091bb5da2698ec8bf80cad405bfce5b192cf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="backup-guide-for-sap-hana-on-azure-virtual-machines"></a><span data-ttu-id="81209-103">Azure 虛擬機器上的 SAP HANA 備份指南</span><span class="sxs-lookup"><span data-stu-id="81209-103">Backup guide for SAP HANA on Azure Virtual Machines</span></span>

## <a name="getting-started"></a><span data-ttu-id="81209-104">開始使用</span><span class="sxs-lookup"><span data-stu-id="81209-104">Getting Started</span></span>

<span data-ttu-id="81209-105">Azure 虛擬機器上執行的 SAP hana hello 備份指南只會描述 Azure 相關的主題。</span><span class="sxs-lookup"><span data-stu-id="81209-105">hello backup guide for SAP HANA running on Azure virtual Machines will only describe Azure-specific topics.</span></span> <span data-ttu-id="81209-106">針對一般 SAP HANA 備份相關項目，請查看 hello SAP HANA 文件 (請參閱_SAP HANA 備份文件_本文稍後的)。</span><span class="sxs-lookup"><span data-stu-id="81209-106">For general SAP HANA backup related items, check hello SAP HANA documentation (see _SAP HANA backup documentation_ later in this article).</span></span>

<span data-ttu-id="81209-107">hello 這篇文章的焦點是兩種主要備份可能性 SAP HANA Azure 虛擬機器上：</span><span class="sxs-lookup"><span data-stu-id="81209-107">hello focus of this article is on two major backup possibilities for SAP HANA on Azure virtual machines:</span></span>

- <span data-ttu-id="81209-108">HANA 備份 toohello 檔案系統中 Azure Linux 虛擬機器 (請參閱[SAP HANA Azure 備份檔案層級上](sap-hana-backup-file-level.md))</span><span class="sxs-lookup"><span data-stu-id="81209-108">HANA backup toohello file system in an Azure Linux Virtual Machine (see [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md))</span></span>
- <span data-ttu-id="81209-109">HANA 備份為基礎儲存體使用手動 hello Azure 儲存體 blob 快照集功能的快照集或 Azure 備份服務 (請參閱[SAP HANA 備份為基礎儲存快照集](sap-hana-backup-storage-snapshots.md))</span><span class="sxs-lookup"><span data-stu-id="81209-109">HANA backup based on storage snapshots using hello Azure storage blob snapshot feature manually or Azure Backup Service (see [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md))</span></span>

<span data-ttu-id="81209-110">SAP HANA 提供 API，可讓協力廠商備份工具 toointegrate 直接與 SAP HANA 的備份。</span><span class="sxs-lookup"><span data-stu-id="81209-110">SAP HANA offers a backup API, which allows third-party backup tools toointegrate directly with SAP HANA.</span></span> <span data-ttu-id="81209-111">（這是不在本指南的 hello 範圍內）。根據此 API，目前 SAP HANA 與 Azure 備份服務沒有任何直接整合。</span><span class="sxs-lookup"><span data-stu-id="81209-111">(That is not within hello scope of this guide.) There is no direct integration of SAP HANA with Azure Backup service available right now based on this API.</span></span>

<span data-ttu-id="81209-112">SAP HANA 正式支援 Azure VM 類型 GS5 上做為單一執行個體的額外限制 tooOLAP 工作負載 (請參閱[尋找認證 IaaS 平台](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html)hello SAP 網站上)。</span><span class="sxs-lookup"><span data-stu-id="81209-112">SAP HANA is officially supported on Azure VM type GS5 as single instance with an additional restriction tooOLAP workloads (see [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) on hello SAP website).</span></span> <span data-ttu-id="81209-113">這篇文章將會更新為新的供應項目，您就可以使用 Azure 上的 SAP HANA。</span><span class="sxs-lookup"><span data-stu-id="81209-113">This article will be updated as new offerings for SAP HANA on Azure become available.</span></span>

<span data-ttu-id="81209-114">Azure 上另外還有一個 SAP HANA 的混合式解決方案，其中的 SAP HANA 是在實體伺服器上非虛擬化的執行。</span><span class="sxs-lookup"><span data-stu-id="81209-114">There is also an SAP HANA hybrid solution available on Azure, where SAP HANA runs non-virtualized on physical servers.</span></span> <span data-ttu-id="81209-115">不過，此 SAP HANA Azure 備份指南涵蓋純 Azure 環境，即 SAP HANA 在 Azure VM 中執行，而不是 SAP HANA 在「大型執行個體」&quot;&quot;上執行。針對此備份解決方案在「大型執行個體」&quot;&quot;上執行以儲存體快照集為基礎的備份，如需詳細資訊請參閱 [Azure 上的 SAP HANA (大型執行個體) 概觀和架構](hana-overview-architecture.md)。</span><span class="sxs-lookup"><span data-stu-id="81209-115">However, this SAP HANA Azure backup guide covers a pure Azure environment where SAP HANA runs in an Azure VM, not SAP HANA running on &quot;large instances.&quot; See [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) for more information about this backup solution on &quot;large instances&quot; based on storage snapshots.</span></span>

<span data-ttu-id="81209-116">Azure 上支援的 SAP 產品資訊可在 [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533) 之中找到。</span><span class="sxs-lookup"><span data-stu-id="81209-116">General information about SAP products supported on Azure can be found in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

<span data-ttu-id="81209-117">hello 下列三個圖表概觀 hello SAP HANA 備份目前使用原生的 Azure 功能的選項，也會顯示三個潛在未來備份的案例。</span><span class="sxs-lookup"><span data-stu-id="81209-117">hello following three figures give an overview of hello SAP HANA backup options using native Azure capabilities currently, and also show three potential future backup scenarios.</span></span> <span data-ttu-id="81209-118">hello 相關文章[SAP HANA Azure 備份檔案層級上](sap-hana-backup-file-level.md)和[SAP HANA 備份為基礎儲存快照集](sap-hana-backup-storage-snapshots.md)說明這些選項的詳細資料，包括適用於 SAP 的大小和效能考量HANA 備份多重數 tb 的大小。</span><span class="sxs-lookup"><span data-stu-id="81209-118">hello related articles [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) and [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describe these options in more detail, including size and performance considerations for SAP HANA backups that are multi-terabytes in size.</span></span>

![此圖將顯示兩種可能性儲存 hello 目前 VM 狀態](media/sap-hana-backup-guide/image001.png)

<span data-ttu-id="81209-120">此圖顯示 hello 可能性儲存 hello 目前 VM 的狀態，已透過 Azure 備份服務或 VM 磁碟的手動快照集。</span><span class="sxs-lookup"><span data-stu-id="81209-120">This figure shows hello possibility of saving hello current VM state, either via Azure Backup service or manual snapshot of VM disks.</span></span> <span data-ttu-id="81209-121">這種方法，也為 &#39; 沒有 toomanage SAP HANA 備份。</span><span class="sxs-lookup"><span data-stu-id="81209-121">With this approach, one doesn&#39;t have toomanage SAP HANA backups.</span></span> <span data-ttu-id="81209-122">hello 挑戰的 hello 磁碟快照集是案例的檔案系統一致性，且應用程式一致的磁碟狀態。</span><span class="sxs-lookup"><span data-stu-id="81209-122">hello challenge of hello disk snapshot scenario is file system consistency, and an application-consistent disk state.</span></span> <span data-ttu-id="81209-123">hello 章節中的 hello 一致性主題會討論_建立儲存體的快照集時，SAP HANA 資料一致性_本文稍後。</span><span class="sxs-lookup"><span data-stu-id="81209-123">hello consistency topic is discussed in hello section _SAP HANA data consistency when taking storage snapshots_ later in this article.</span></span> <span data-ttu-id="81209-124">功能以及限制的 Azure 備份服務相關的 tooSAP HANA 備份也將在本文稍後討論。</span><span class="sxs-lookup"><span data-stu-id="81209-124">Capabilities and restrictions of Azure Backup service related tooSAP HANA backups are also discussed later in this article.</span></span>

![此圖將顯示選項，以取得 SAP HANA 檔案內 hello VM 備份](media/sap-hana-backup-guide/image002.png)

<span data-ttu-id="81209-126">此圖中顯示選項取得 hello VM，在 SAP HANA 檔案備份，然後再將 HANA 備份檔案的地方使用不同的工具。</span><span class="sxs-lookup"><span data-stu-id="81209-126">This figure shows options for taking an SAP HANA file backup inside hello VM, and then storing it HANA backup files somewhere else using different tools.</span></span> <span data-ttu-id="81209-127">建立 HANA 備份需要的時間比以快照集為基礎的備份解決方案更多，但具有整體性與一致性的優點。</span><span class="sxs-lookup"><span data-stu-id="81209-127">Taking a HANA backup requires more time than a snapshot-based backup solution, but it has advantages regarding integrity and consistency.</span></span> <span data-ttu-id="81209-128">本文稍後將提供更詳細的說明。</span><span class="sxs-lookup"><span data-stu-id="81209-128">More details are provided later in this article.</span></span>

![此圖顯示未來可能的 SAP HANA 備份案例](media/sap-hana-backup-guide/image003.png)

<span data-ttu-id="81209-130">此圖顯示未來可能的 SAP HANA 備份案例。</span><span class="sxs-lookup"><span data-stu-id="81209-130">This figure shows a potential future SAP HANA backup scenario.</span></span> <span data-ttu-id="81209-131">如果 SAP HANA 允許從次要複寫建立備份，會加入額外的備份策略選項。</span><span class="sxs-lookup"><span data-stu-id="81209-131">If SAP HANA allowed taking backups from a replication secondary, it would add additional options for backup strategies.</span></span> <span data-ttu-id="81209-132">目前不可能根據 tooa hello SAP HANA Wiki 中的文章：</span><span class="sxs-lookup"><span data-stu-id="81209-132">Currently it isn't possible according tooa post in hello SAP HANA Wiki:</span></span>

<span data-ttu-id="81209-133">_&quot;它是在 hello 次要端可能 tootake 備份嗎？_</span><span class="sxs-lookup"><span data-stu-id="81209-133">_&quot;Is it possible tootake backups on hello secondary side?_</span></span>

<span data-ttu-id="81209-134">_否，目前您只能取得資料和記錄備份 hello 主要端上。如果已啟用自動記錄備份之後接管 toohello 次要端，, 自動將那里寫入 hello 記錄備份。&quot;_</span><span class="sxs-lookup"><span data-stu-id="81209-134">_No, currently you can only take data and log backups on hello primary side. If automatic log backup is enabled, after takeover toohello secondary side, hello log backups will automatically be written there.&quot;_</span></span>

## <a name="sap-resources-for-hana-backup"></a><span data-ttu-id="81209-135">HANA 備份的 SAP 資源</span><span class="sxs-lookup"><span data-stu-id="81209-135">SAP resources for HANA backup</span></span>

### <a name="sap-hana-backup-documentation"></a><span data-ttu-id="81209-136">SAP HANA 備份文件</span><span class="sxs-lookup"><span data-stu-id="81209-136">SAP HANA backup documentation</span></span>

- [<span data-ttu-id="81209-137">簡介 tooSAP HANA 管理</span><span class="sxs-lookup"><span data-stu-id="81209-137">Introduction tooSAP HANA Administration</span></span>](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US)
- [<span data-ttu-id="81209-138">規劃備份和復原策略</span><span class="sxs-lookup"><span data-stu-id="81209-138">Planning Your Backup and Recovery Strategy</span></span>](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)
- [<span data-ttu-id="81209-139">使用 ABAP DBACOCKPIT 排程 HANA 備份</span><span class="sxs-lookup"><span data-stu-id="81209-139">Schedule HANA Backup using ABAP DBACOCKPIT</span></span>](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html)
- [<span data-ttu-id="81209-140">排程資料備份 (SAP HANA Cockpit)</span><span class="sxs-lookup"><span data-stu-id="81209-140">Schedule Data Backups (SAP HANA Cockpit)</span></span>](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm)
- <span data-ttu-id="81209-141">[SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148) 中的 SAP HANA 備份常見問題集</span><span class="sxs-lookup"><span data-stu-id="81209-141">FAQ about SAP HANA backup in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span></span>
- <span data-ttu-id="81209-142">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) 中的 SAP HANA 資料庫和儲存體快照集的常見問題集</span><span class="sxs-lookup"><span data-stu-id="81209-142">FAQ about SAP HANA database and storage snapshots in [SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span></span>
- <span data-ttu-id="81209-143">[SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) 中的不適用於備份和復原的網路檔案系統</span><span class="sxs-lookup"><span data-stu-id="81209-143">Unsuitable network file systems for backup and recovery in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span></span>

### <a name="why-sap-hana-backup"></a><span data-ttu-id="81209-144">為什麼要使用 SAP HANA 備份？</span><span class="sxs-lookup"><span data-stu-id="81209-144">Why SAP HANA backup?</span></span>

<span data-ttu-id="81209-145">Azure 儲存體提供可用性和可靠性 hello 現成 (請參閱[簡介 tooMicrosoft Azure 儲存體](../../../storage/common/storage-introduction.md)如需有關 Azure 儲存體)。</span><span class="sxs-lookup"><span data-stu-id="81209-145">Azure storage offers availability and reliability out of hello box (see [Introduction tooMicrosoft Azure Storage](../../../storage/common/storage-introduction.md) for more information about Azure storage).</span></span>

<span data-ttu-id="81209-146">最小值的 hello&quot;備份&quot;是 toorely 上 hello Azure Sla，保留 hello Azure Vhd 附加的 toohello SAP HANA 伺服器 VM 上的 SAP HANA 資料和記錄檔。</span><span class="sxs-lookup"><span data-stu-id="81209-146">hello minimum for &quot;backup&quot; is toorely on hello Azure SLAs, keeping hello SAP HANA data and log files on Azure VHDs attached toohello SAP HANA server VM.</span></span> <span data-ttu-id="81209-147">這個方法會涵蓋 VM 失敗，但不是可能損害 toohello SAP HANA 資料和記錄檔或邏輯錯誤，例如不小心刪除資料或檔案。</span><span class="sxs-lookup"><span data-stu-id="81209-147">This approach covers VM failures, but not potential damage toohello SAP HANA data and log files, or logical errors like deleting data or files by accident.</span></span> <span data-ttu-id="81209-148">備份也是基於合規性或法律因素而有其必要。</span><span class="sxs-lookup"><span data-stu-id="81209-148">Backups are also required for compliance or legal reasons.</span></span> <span data-ttu-id="81209-149">簡單地說，一定需要 SAP HANA 備份。</span><span class="sxs-lookup"><span data-stu-id="81209-149">In short, there is always a need for SAP HANA backups.</span></span>

### <a name="how-tooverify-correctness-of-sap-hana-backup"></a><span data-ttu-id="81209-150">如何 tooverify 正確性的 SAP HANA 備份</span><span class="sxs-lookup"><span data-stu-id="81209-150">How tooverify correctness of SAP HANA backup</span></span>
<span data-ttu-id="81209-151">使用儲存體快照集時，建議在不同的系統上執行測試還原。</span><span class="sxs-lookup"><span data-stu-id="81209-151">When using storage snapshots, running a test restore on a different system is recommended.</span></span> <span data-ttu-id="81209-152">此方法提供方式 tooensure 備份符合預期的備份和還原工作的正確和內部程序。</span><span class="sxs-lookup"><span data-stu-id="81209-152">This approach provides a way tooensure that a backup is correct, and internal processes for backup and restore work as expected.</span></span> <span data-ttu-id="81209-153">雖然這是嚴重的障礙內部，它是 hello 定域機組中的更容易 tooaccomplish 方法所需的資源暫時提供此用途的。</span><span class="sxs-lookup"><span data-stu-id="81209-153">While this is a significant hurdle on-premises, it is much easier tooaccomplish in hello cloud by providing necessary resources temporarily for this purpose.</span></span>

<span data-ttu-id="81209-154">請記住，光是簡單執行還原，然後確認 HANA 有在執行是不夠的。</span><span class="sxs-lookup"><span data-stu-id="81209-154">Keep in mind that doing a simple restore and checking if HANA is up and running is not sufficient.</span></span> <span data-ttu-id="81209-155">在理想情況下，其中一個應該執行資料表的一致性檢查 toobe 確定該 hello 還原資料庫很好。</span><span class="sxs-lookup"><span data-stu-id="81209-155">Ideally, one should run a table consistency check toobe sure that hello restored database is fine.</span></span> <span data-ttu-id="81209-156">SAP HANA 提供數種一致性檢查，如 [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584) 中所述。</span><span class="sxs-lookup"><span data-stu-id="81209-156">SAP HANA offers several kinds of consistency checks described in [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span></span>

<span data-ttu-id="81209-157">Hello 資料表的一致性檢查的相關資訊也可以在 hello SAP 網站上找到[資料表和類別目錄一致性檢查](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b)。</span><span class="sxs-lookup"><span data-stu-id="81209-157">Information about hello table consistency check can also be found on hello SAP website at [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span></span>

<span data-ttu-id="81209-158">若是進行標準檔案備份，則不需要測試還原。</span><span class="sxs-lookup"><span data-stu-id="81209-158">For standard file backups, a test restore is not necessary.</span></span> <span data-ttu-id="81209-159">有兩個 SAP HANA 工具可協助的 toocheck 可用的備份進行還原： hdbbackupdiag 和 hdbbackupcheck。</span><span class="sxs-lookup"><span data-stu-id="81209-159">There are two SAP HANA tools that help toocheck which backup can be used for restore: hdbbackupdiag and hdbbackupcheck.</span></span> <span data-ttu-id="81209-160">如需有關這些工具的資訊，請參閱[手動檢查是否有可能復原](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm)。</span><span class="sxs-lookup"><span data-stu-id="81209-160">See [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) for more information about these tools.</span></span>

### <a name="pros-and-cons-of-hana-backup-versus-storage-snapshot"></a><span data-ttu-id="81209-161">比較 HANA 備份與儲存體快照集的優缺點</span><span class="sxs-lookup"><span data-stu-id="81209-161">Pros and cons of HANA backup versus storage snapshot</span></span>

<span data-ttu-id="81209-162">SAP 規定 &#39; t 給予喜好設定 tooeither HANA 備份與儲存快照集。</span><span class="sxs-lookup"><span data-stu-id="81209-162">SAP doesn&#39;t give preference tooeither HANA backup versus storage snapshot.</span></span> <span data-ttu-id="81209-163">它會列出其優缺點，因此一個可以判斷哪些 toouse 視 hello 情況和可用的存放裝置技術而定 (請參閱[規劃您的備份和復原策略](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm))。</span><span class="sxs-lookup"><span data-stu-id="81209-163">It lists their pros and cons, so one can determine which toouse depending on hello situation and available storage technology (see [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span></span>

<span data-ttu-id="81209-164">在 Azure 中，注意 hello 事實的 hello Azure blob 快照集功能不 &#39; 保證檔案系統一致性的 t (請參閱[使用 blob 快照集，使用 PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/))。</span><span class="sxs-lookup"><span data-stu-id="81209-164">On Azure, be aware of hello fact that hello Azure blob snapshot feature doesn&#39;t guarantee file system consistency (see [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span></span> <span data-ttu-id="81209-165">hello 下一節_建立儲存體的快照集時，SAP HANA 資料一致性_，討論有關這項功能的一些考量。</span><span class="sxs-lookup"><span data-stu-id="81209-165">hello next section, _SAP HANA data consistency when taking storage snapshots_, discusses some considerations regarding this feature.</span></span>

<span data-ttu-id="81209-166">此外，有一個具有 toounderstand hello 的計費方式，本文章中所述經常使用 blob 快照集時：[了解如何快照 snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)— 它目前 &#39; t 明顯做為使用 Azure虛擬磁碟。</span><span class="sxs-lookup"><span data-stu-id="81209-166">In addition, one has toounderstand hello billing implications when working frequently with blob snapshots as described in this article: [Understanding How Snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)—it isn&#39;t as obvious as using Azure virtual disks.</span></span>

### <a name="sap-hana-data-consistency-when-taking-storage-snapshots"></a><span data-ttu-id="81209-167">建立儲存體快照集時，SAP HANA 資料的一致性</span><span class="sxs-lookup"><span data-stu-id="81209-167">SAP HANA data consistency when taking storage snapshots</span></span>

<span data-ttu-id="81209-168">建立儲存體快照集時，檔案系統和應用程式的一致性是複雜的問題。</span><span class="sxs-lookup"><span data-stu-id="81209-168">File system and application consistency is a complex issue when taking storage snapshots.</span></span> <span data-ttu-id="81209-169">要向 SAP HANA tooshut hello 最簡單方式 tooavoid 問題或甚至 hello 整個虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="81209-169">hello easiest way tooavoid problems would be tooshut down SAP HANA, or maybe even hello whole virtual machine.</span></span> <span data-ttu-id="81209-170">關機在示範或原型，或甚至開發系統上也許可行，但不是生產系統的選項。</span><span class="sxs-lookup"><span data-stu-id="81209-170">A shutdown might be doable with a demo or prototype, or even a development system, but it is not an option for a production system.</span></span>

<span data-ttu-id="81209-171">在 Azure 上、 其中一個有 tookeep 記住 hello Azure blob 快照集功能不 &#39; t 保證檔案系統一致性。</span><span class="sxs-lookup"><span data-stu-id="81209-171">On Azure, one has tookeep in mind that hello Azure blob snapshot feature doesn&#39;t guarantee file system consistency.</span></span> <span data-ttu-id="81209-172">它會正常運作但是使用 hello SAP HANA 快照集功能，只要沒有相關的只是單一的虛擬磁碟。</span><span class="sxs-lookup"><span data-stu-id="81209-172">It works fine however by using hello SAP HANA snapshot feature, as long as there is only a single virtual disk involved.</span></span> <span data-ttu-id="81209-173">但即使是使用單一磁碟，其他項目有 toobe 檢查。</span><span class="sxs-lookup"><span data-stu-id="81209-173">But even with a single disk, additional items have toobe checked.</span></span> <span data-ttu-id="81209-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) 中有關於透過儲存體快照集進行 SAP HANA 備份的重要資訊。</span><span class="sxs-lookup"><span data-stu-id="81209-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) has important information about SAP HANA backups via storage snapshots.</span></span> <span data-ttu-id="81209-175">例如，它會提及，hello XFS 檔案系統，它是必要的 toorun **xfs\_凍結**啟動儲存體 tooguarantee 一致性的快照集之前 (請參閱[xfs\_freeze(8)-Linux 攔截頁面](https://linux.die.net/man/8/xfs_freeze)如需詳細資訊**xfs\_凍結**)。</span><span class="sxs-lookup"><span data-stu-id="81209-175">For example, it mentions that, with hello XFS file system, it is necessary toorun **xfs\_freeze** before starting a storage snapshot tooguarantee consistency (see [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) for details on **xfs\_freeze**).</span></span>

<span data-ttu-id="81209-176">一致性的 hello 主題會成為在單一檔案系統位置跨越多個磁碟/磁碟區的情況下甚至更具挑戰性。</span><span class="sxs-lookup"><span data-stu-id="81209-176">hello topic of consistency becomes even more challenging in a case where a single file system spans multiple disks/volumes.</span></span> <span data-ttu-id="81209-177">例如，使用 mdadm 或 LVM 和串接。</span><span class="sxs-lookup"><span data-stu-id="81209-177">For example, by using mdadm or LVM and striping.</span></span> <span data-ttu-id="81209-178">hello 狀態上面所提 SAP 附註：</span><span class="sxs-lookup"><span data-stu-id="81209-178">hello SAP Note mentioned above states:</span></span>

<span data-ttu-id="81209-179">_&quot;但是請記住以下幾點 hello 儲存系統具有 tooguarantee I/O 一致性，建立每個 SAP HANA 資料磁碟區的儲存體快照集時，也就是 SAP HANA 服務特定的資料磁碟區的快照必須是不可部分完成的作業。&quot;_</span><span class="sxs-lookup"><span data-stu-id="81209-179">_&quot;But keep in mind that hello storage system has tooguarantee I/O consistency while creating a storage snapshot per SAP HANA data volume, i.e. snapshotting of an SAP HANA service-specific data volume must be an atomic operation.&quot;_</span></span>

<span data-ttu-id="81209-180">假設 XFS 檔案系統跨越四個 Azure 的虛擬磁碟，hello 下列步驟提供一致的快照集，表示 hello HANA 資料區域：</span><span class="sxs-lookup"><span data-stu-id="81209-180">Assuming there is an XFS file system spanning four Azure virtual disks, hello following steps provide a consistent snapshot that represents hello HANA data area:</span></span>

- <span data-ttu-id="81209-181">準備 HANA 快照集</span><span class="sxs-lookup"><span data-stu-id="81209-181">HANA snapshot prepare</span></span>
- <span data-ttu-id="81209-182">凍結 hello 檔案系統 (例如，使用**xfs\_凍結**)</span><span class="sxs-lookup"><span data-stu-id="81209-182">Freeze hello file system (for example, use **xfs\_freeze**)</span></span>
- <span data-ttu-id="81209-183">在 Azure 上建立所有必要的 blob 快照集</span><span class="sxs-lookup"><span data-stu-id="81209-183">Create all necessary blob snapshots on Azure</span></span>
- <span data-ttu-id="81209-184">取消凍結 hello 檔案系統</span><span class="sxs-lookup"><span data-stu-id="81209-184">Unfreeze hello file system</span></span>
- <span data-ttu-id="81209-185">確認 hello HANA 快照集</span><span class="sxs-lookup"><span data-stu-id="81209-185">Confirm hello HANA snapshot</span></span>

<span data-ttu-id="81209-186">建議是 toouse hello 上述程序中所有的情況下 toobe hello 安全的理由，不論檔案系統上。</span><span class="sxs-lookup"><span data-stu-id="81209-186">Recommendation is toouse hello procedure above in all cases toobe on hello safe side, no matter which file system.</span></span> <span data-ttu-id="81209-187">或者，如果是單一磁碟或串接，透過 mdadm 或 LVM 跨多個磁碟。</span><span class="sxs-lookup"><span data-stu-id="81209-187">Or if it is a single disk or striping, via mdadm or LVM across multiple disks.</span></span>

<span data-ttu-id="81209-188">很重要的 tooconfirm hello HANA 快照集。</span><span class="sxs-lookup"><span data-stu-id="81209-188">It is important tooconfirm hello HANA snapshot.</span></span> <span data-ttu-id="81209-189">到期 toohello&quot;上寫入複製&quot;SAP HANA 可能不需要額外的磁碟空間，而在此模式準備快照集。</span><span class="sxs-lookup"><span data-stu-id="81209-189">Due toohello &quot;Copy-on-Write,&quot; SAP HANA might not require additional disk space while in this snapshot-prepare mode.</span></span> <span data-ttu-id="81209-190">它 &#39; s 也不可能 toostart 新的備份之前確認 hello SAP HANA 快照集。</span><span class="sxs-lookup"><span data-stu-id="81209-190">It&#39;s also not possible toostart new backups until hello SAP HANA snapshot is confirmed.</span></span>

<span data-ttu-id="81209-191">Azure 備份服務會使用 Azure VM 延伸模組 tootake care of hello 檔案系統一致性。</span><span class="sxs-lookup"><span data-stu-id="81209-191">Azure Backup service uses Azure VM extensions tootake care of hello file system consistency.</span></span> <span data-ttu-id="81209-192">這些 VM 擴充功能無法獨立使用。</span><span class="sxs-lookup"><span data-stu-id="81209-192">These VM extensions are not available for standalone usage.</span></span> <span data-ttu-id="81209-193">其中一個仍然有 toomanage SAP HANA 一致性。</span><span class="sxs-lookup"><span data-stu-id="81209-193">One still has toomanage SAP HANA consistency.</span></span> <span data-ttu-id="81209-194">請參閱相關文件 hello[檔案層級上的 SAP HANA Azure Backup](sap-hana-backup-file-level.md)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="81209-194">See hello related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) for more information.</span></span>

### <a name="sap-hana-backup-scheduling-strategy"></a><span data-ttu-id="81209-195">SAP HANA 備份排程策略</span><span class="sxs-lookup"><span data-stu-id="81209-195">SAP HANA backup scheduling strategy</span></span>

<span data-ttu-id="81209-196">hello SAP HANA 文章[規劃您的備份和復原策略](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)狀態的基本計劃 toodo 備份：</span><span class="sxs-lookup"><span data-stu-id="81209-196">hello SAP HANA article [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) states a basic plan toodo backups:</span></span>

- <span data-ttu-id="81209-197">儲存體快照集 (每天)</span><span class="sxs-lookup"><span data-stu-id="81209-197">Storage snapshot (daily)</span></span>
- <span data-ttu-id="81209-198">使用檔案或 bacint 格式進行完整的資料備份 (每週一次)</span><span class="sxs-lookup"><span data-stu-id="81209-198">Complete data backup using file or bacint format (once a week)</span></span>
- <span data-ttu-id="81209-199">自動記錄備份</span><span class="sxs-lookup"><span data-stu-id="81209-199">Automatic log backups</span></span>

<span data-ttu-id="81209-200">您可以選擇完全不進行儲存體快照集；可利用 HANA 差別備份來準備它們，例如增量或差異備份 (請參閱[差別備份](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm))。</span><span class="sxs-lookup"><span data-stu-id="81209-200">Optionally, one could go completely without storage snapshots; they could be replaced by HANA delta backups, like incremental or differential backups (see [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span></span>

<span data-ttu-id="81209-201">hello HANA 系統管理指南提供的範例清單。</span><span class="sxs-lookup"><span data-stu-id="81209-201">hello HANA Administration guide provides an example list.</span></span> <span data-ttu-id="81209-202">建議您一次使用下列的備份順序的 hello 復原 SAP HANA tooa 特定點：</span><span class="sxs-lookup"><span data-stu-id="81209-202">It suggests that one recover SAP HANA tooa specific point in time using hello following sequence of backups:</span></span>

1. <span data-ttu-id="81209-203">完整資料備份</span><span class="sxs-lookup"><span data-stu-id="81209-203">Full data backup</span></span>
2. <span data-ttu-id="81209-204">差異備份</span><span class="sxs-lookup"><span data-stu-id="81209-204">Differential backup</span></span>
3. <span data-ttu-id="81209-205">增量備份 1</span><span class="sxs-lookup"><span data-stu-id="81209-205">Incremental backup 1</span></span>
4. <span data-ttu-id="81209-206">增量備份 2</span><span class="sxs-lookup"><span data-stu-id="81209-206">Incremental backup 2</span></span>
5. <span data-ttu-id="81209-207">記錄備份</span><span class="sxs-lookup"><span data-stu-id="81209-207">Log backups</span></span>

<span data-ttu-id="81209-208">關於 toowhen 和特定的備份類型應該發生的頻率的確切排程，則不可能 toogive 一般指導方針 — 它是太客戶，而多少資料變更會發生在 hello 系統而定。</span><span class="sxs-lookup"><span data-stu-id="81209-208">Regarding an exact schedule as toowhen and how often a specific backup type should happen, it is not possible toogive a general guideline—it is too customer-specific, and depends on how many data changes occur in hello system.</span></span> <span data-ttu-id="81209-209">一個基本從 SAP 端，可視為一般指引，建議 toomake 一個完整 HANA 備份每週一次。</span><span class="sxs-lookup"><span data-stu-id="81209-209">One basic recommendation from SAP side, which can be seen as general guidance, is toomake one full HANA backup once a week.</span></span>
<span data-ttu-id="81209-210">有關記錄檔備份，請參閱 hello SAP HANA 文件[記錄備份](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)。</span><span class="sxs-lookup"><span data-stu-id="81209-210">Regarding log backups, see hello SAP HANA documentation [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span></span>

<span data-ttu-id="81209-211">SAP 也建議您某些環境的 hello 備份類別目錄 tookeep 維護從無限成長 (請參閱[備份類別目錄和備份存放例行性](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm))。</span><span class="sxs-lookup"><span data-stu-id="81209-211">SAP also recommends doing some housekeeping of hello backup catalog tookeep it from growing infinitely (see [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span></span>

### <a name="sap-hana-configuration-files"></a><span data-ttu-id="81209-212">SAP HANA 組態檔</span><span class="sxs-lookup"><span data-stu-id="81209-212">SAP HANA configuration files</span></span>

<span data-ttu-id="81209-213">中的 hello 常見問題集中所述[SAP 附註 1642148](https://launchpad.support.sap.com/#/notes/1642148)，hello SAP HANA 組態檔不是標準的 HANA 備份的一部分。</span><span class="sxs-lookup"><span data-stu-id="81209-213">As stated in hello FAQ in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148), hello SAP HANA configuration files are not part of a standard HANA backup.</span></span> <span data-ttu-id="81209-214">它們不是基本 toorestore 系統。</span><span class="sxs-lookup"><span data-stu-id="81209-214">They are not essential toorestore a system.</span></span> <span data-ttu-id="81209-215">hello 還原之後無法手動變更 hello HANA 組態。</span><span class="sxs-lookup"><span data-stu-id="81209-215">hello HANA configuration could be changed manually after hello restore.</span></span> <span data-ttu-id="81209-216">萬一其中一個希望 tooget hello 相同的自訂組態 hello 還原程序，它是必要 tooback hello HANA 組態檔案分開。</span><span class="sxs-lookup"><span data-stu-id="81209-216">In case one would like tooget hello same custom configuration during hello restore process, it is necessary tooback up hello HANA configuration files separately.</span></span>

<span data-ttu-id="81209-217">如果標準 HANA 備份即將 tooa 專用 HANA 備份的檔案系統，其中也無法複製 hello 設定檔 toohello 相同備份的檔案系統，並再複製所有要一起 toohello 儲存體目的地的項目很棒的 blob 儲存體。</span><span class="sxs-lookup"><span data-stu-id="81209-217">If standard HANA backups are going tooa dedicated HANA backup file system, one could also copy hello configuration files toohello same backup filesystem, and then copy everything together toohello final storage destination like cool blob storage.</span></span>

### <a name="sap-hana-cockpit"></a><span data-ttu-id="81209-218">SAP HANA Cockpit</span><span class="sxs-lookup"><span data-stu-id="81209-218">SAP HANA Cockpit</span></span>

<span data-ttu-id="81209-219">SAP HANA Cockpit 提供監視和管理 SAP HANA 透過瀏覽器的 hello 的可能性。</span><span class="sxs-lookup"><span data-stu-id="81209-219">SAP HANA Cockpit offers hello possibility of monitoring and managing SAP HANA via a browser.</span></span> <span data-ttu-id="81209-220">它也可讓處理的 SAP HANA 備份，並因此可做為替代 tooSAP HANA Studio 及 ABAP DBACOCKPIT (請參閱[SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm)如需詳細資訊)。</span><span class="sxs-lookup"><span data-stu-id="81209-220">It also allows handling of SAP HANA backups, and therefore can be used as an alternative tooSAP HANA Studio and ABAP DBACOCKPIT (see [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) for more information).</span></span>

![此圖將顯示 hello SAP HANA Cockpit 資料庫管理畫面](media/sap-hana-backup-guide/image004.png)

<span data-ttu-id="81209-222">此圖顯示 hello SAP HANA Cockpit 資料庫管理畫面及 hello 上剩餘的 hello 備份 磚。</span><span class="sxs-lookup"><span data-stu-id="81209-222">This figure shows hello SAP HANA Cockpit Database Administration Screen, and hello backup tile on hello left.</span></span> <span data-ttu-id="81209-223">文件都看到 hello 備份磚登入帳戶需要適當的使用者權限。</span><span class="sxs-lookup"><span data-stu-id="81209-223">Seeing hello backup tile requires appropriate user permissions for login account.</span></span>

![備份正在進行時，可以在 SAP HANA Cockpit 中監視備份](media/sap-hana-backup-guide/image005.png)

<span data-ttu-id="81209-225">它們會持續進行，並在它完成時，所有的 hello 備份詳細資料可用時，可以在 SAP HANA Cockpit 監視備份。</span><span class="sxs-lookup"><span data-stu-id="81209-225">Backups can be monitored in SAP HANA Cockpit while they are ongoing and, once it is finished, all hello backup details are available.</span></span>

![在 Azure SLES 12 VM 及 Gnome 桌面上使用 Firefox 的範例](media/sap-hana-backup-guide/image006.png)

<span data-ttu-id="81209-227">從 Windows Azure VM 進行 hello 上一個螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="81209-227">hello previous screenshots were made from an Azure Windows VM.</span></span> <span data-ttu-id="81209-228">這一個是 Gnome 桌面搭配 Azure SLES 12 VM 使用 Firefox 的範例。</span><span class="sxs-lookup"><span data-stu-id="81209-228">This one is an example using Firefox on an Azure SLES 12 VM with Gnome desktop.</span></span> <span data-ttu-id="81209-229">它會顯示 hello 選項 toodefine SAP HANA 備份排程在 SAP HANA Cockpit。</span><span class="sxs-lookup"><span data-stu-id="81209-229">It shows hello option toodefine SAP HANA backup schedules in SAP HANA Cockpit.</span></span> <span data-ttu-id="81209-230">也可以看到其中一個，日期/時間做為前置詞 hello 備份檔案的建議。</span><span class="sxs-lookup"><span data-stu-id="81209-230">As one can also see, it suggests date/time as a prefix for hello backup files.</span></span> <span data-ttu-id="81209-231">在 SAP HANA Studio hello 預設前置詞是&quot;完成\_資料\_備份&quot;時執行的完整檔案備份。</span><span class="sxs-lookup"><span data-stu-id="81209-231">In SAP HANA Studio, hello default prefix is &quot;COMPLETE\_DATA\_BACKUP&quot; when doing a full file backup.</span></span> <span data-ttu-id="81209-232">建議使用唯一的前置詞。</span><span class="sxs-lookup"><span data-stu-id="81209-232">Using a unique prefix is recommended.</span></span>

### <a name="sap-hana-backup-encryption"></a><span data-ttu-id="81209-233">SAP HANA 備份的加密</span><span class="sxs-lookup"><span data-stu-id="81209-233">SAP HANA backup encryption</span></span>

<span data-ttu-id="81209-234">SAP HANA 提供加密資料和記錄的功能。</span><span class="sxs-lookup"><span data-stu-id="81209-234">SAP HANA offers encryption of data and log.</span></span> <span data-ttu-id="81209-235">如果未加密 SAP HANA 資料和記錄檔，然後 hello 備份也不會加密。</span><span class="sxs-lookup"><span data-stu-id="81209-235">If SAP HANA data and log are not encrypted, then hello backups are also not encrypted.</span></span> <span data-ttu-id="81209-236">它已啟動 toohello 客戶 toouse 某種形式的協力廠商解決方案 tooencrypt hello SAP HANA 備份。</span><span class="sxs-lookup"><span data-stu-id="81209-236">It is up toohello customer toouse some form of third-party solution tooencrypt hello SAP HANA backups.</span></span> <span data-ttu-id="81209-237">請參閱[資料和記錄檔磁碟區加密](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm)toofind SAP HANA 加密深入了解。</span><span class="sxs-lookup"><span data-stu-id="81209-237">See [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) toofind out more about SAP HANA encryption.</span></span>

<span data-ttu-id="81209-238">在 Microsoft Azure 客戶無法使用 hello IaaS VM 加密功能 tooencrypt。</span><span class="sxs-lookup"><span data-stu-id="81209-238">On Microsoft Azure, a customer could use hello IaaS VM encryption feature tooencrypt.</span></span> <span data-ttu-id="81209-239">比方說，其中一個可以使用專用的資料磁碟附加的 toohello VM，而是使用的 toostore SAP HANA 備份，接著建立這些磁碟的複本。</span><span class="sxs-lookup"><span data-stu-id="81209-239">For example, one could use dedicated data disks attached toohello VM, which are used toostore SAP HANA backups, then make copies of these disks.</span></span>

<span data-ttu-id="81209-240">Azure 備份服務可以處理加密的 Vm 磁碟 (請參閱[tooback 向上及還原加密使用 Azure 備份的虛擬機器](../../../backup/backup-azure-vms-encryption.md))。</span><span class="sxs-lookup"><span data-stu-id="81209-240">Azure Backup service can handle encrypted VMs/disks (see [How tooback up and restore encrypted virtual machines with Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span></span>

<span data-ttu-id="81209-241">另一個選項可能會 toomaintain hello SAP HANA VM 和其磁碟未加密，而且 hello SAP HANA 備份檔案儲存在加密已啟用的儲存體帳戶 (請參閱[Azure 儲存體服務加密待用資料](../../../storage/common/storage-service-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="81209-241">Another option would be toomaintain hello SAP HANA VM and its disks without encryption, and store hello SAP HANA backup files in a storage account for which encryption was enabled (see [Azure Storage Service Encryption for Data at Rest](../../../storage/common/storage-service-encryption.md)).</span></span>

## <a name="test-setup"></a><span data-ttu-id="81209-242">測試設定</span><span class="sxs-lookup"><span data-stu-id="81209-242">Test setup</span></span>

### <a name="test-virtual-machine-on-azure"></a><span data-ttu-id="81209-243">測試 Azure 上的虛擬機器</span><span class="sxs-lookup"><span data-stu-id="81209-243">Test Virtual Machine on Azure</span></span>

<span data-ttu-id="81209-244">SAP HANA GS5 Azure VM 中的安裝用於 hello 下列備份/還原測試。</span><span class="sxs-lookup"><span data-stu-id="81209-244">An SAP HANA installation in an Azure GS5 VM was used for hello following backup/restore tests.</span></span>

![此圖顯示一部分 hello hello HANA 測試 VM 的 Azure 入口網站總覽](media/sap-hana-backup-guide/image007.png)

<span data-ttu-id="81209-246">此圖中顯示部分 hello hello HANA 測試 VM 的 Azure 入口網站的概觀。</span><span class="sxs-lookup"><span data-stu-id="81209-246">This figure shows part of hello Azure portal overview for hello HANA test VM.</span></span>

### <a name="test-backup-size"></a><span data-ttu-id="81209-247">測試備份大小</span><span class="sxs-lookup"><span data-stu-id="81209-247">Test backup size</span></span>

![此圖取自 HANA Studio 中的 hello 備份主控台，並顯示 hello 備份檔案大小為 229 GB hello HANA 索引伺服器](media/sap-hana-backup-guide/image008.png)

<span data-ttu-id="81209-249">空的資料表已填滿資料 tooget 與備份的資料大小總計超過 200 GB tooderive 實際的效能資料。</span><span class="sxs-lookup"><span data-stu-id="81209-249">A dummy table was filled up with data tooget a total data backup size of over 200 GB tooderive realistic performance data.</span></span> <span data-ttu-id="81209-250">hello 圖取自 HANA Studio 中的 hello 備份主控台，並顯示 hello 備份檔案大小為 229 GB hello HANA 索引伺服器。</span><span class="sxs-lookup"><span data-stu-id="81209-250">hello figure was taken from hello backup console in HANA Studio and shows hello backup file size of 229 GB for hello HANA index server.</span></span> <span data-ttu-id="81209-251">Hello 測試中，使用 hello 預設備份前置詞"COMPLETE_DATA_BACKUP 「 SAP HANA Studio 中。</span><span class="sxs-lookup"><span data-stu-id="81209-251">For hello tests, hello default backup prefix "COMPLETE_DATA_BACKUP" in SAP HANA Studio was used.</span></span> <span data-ttu-id="81209-252">在實際生產系統中，應該定義更實用的前置詞。</span><span class="sxs-lookup"><span data-stu-id="81209-252">In real production systems, a more useful prefix should be defined.</span></span> <span data-ttu-id="81209-253">SAP HANA Cockpit 的建議是日期/時間。</span><span class="sxs-lookup"><span data-stu-id="81209-253">SAP HANA Cockpit suggests date/time.</span></span>

### <a name="test-tool-toocopy-files-directly-tooazure-storage"></a><span data-ttu-id="81209-254">測試工具 toocopy 直接檔案 tooAzure 儲存體</span><span class="sxs-lookup"><span data-stu-id="81209-254">Test tool toocopy files directly tooAzure storage</span></span>

<span data-ttu-id="81209-255">tootransfer SAP HANA 備份檔案直接 tooAzure blob 儲存體或 Azure 的檔案共用，hello blobxfer 工具已使用，因為它支援目標，以及它可以輕鬆地整合到自動化指令碼，因為 tooits 命令列介面。</span><span class="sxs-lookup"><span data-stu-id="81209-255">tootransfer SAP HANA backup files directly tooAzure blob storage, or Azure file shares, hello blobxfer tool was used because it supports both targets and it can be easily integrated into automation scripts due tooits command-line interface.</span></span> <span data-ttu-id="81209-256">hello blobxfer 工具 」 可於[GitHub](https://github.com/Azure/blobxfer)。</span><span class="sxs-lookup"><span data-stu-id="81209-256">hello blobxfer tool is available on [GitHub](https://github.com/Azure/blobxfer).</span></span>

### <a name="test-backup-size-estimation"></a><span data-ttu-id="81209-257">測試備份大小估計</span><span class="sxs-lookup"><span data-stu-id="81209-257">Test backup size estimation</span></span>

<span data-ttu-id="81209-258">它是 SAP HANA 的重要 tooestimate hello 備份大小。</span><span class="sxs-lookup"><span data-stu-id="81209-258">It is important tooestimate hello backup size of SAP HANA.</span></span> <span data-ttu-id="81209-259">此預估值的定義 hello 備份檔案大小上限的備份檔案數目，有助於 tooimprove 效能到期 tooparallelism 期間檔案複製。</span><span class="sxs-lookup"><span data-stu-id="81209-259">This estimate helps tooimprove performance by defining hello max backup file size for a number of backup files, due tooparallelism during a file copy.</span></span> <span data-ttu-id="81209-260">(詳情稍後在本文中會加以說明。)其中也必須決定 toodo 完整備份或差異備份 （增量或差異）。</span><span class="sxs-lookup"><span data-stu-id="81209-260">(Those details are explained later in this article.) One must also decide whether toodo a full backup or a delta backup (incremental or differential).</span></span>

<span data-ttu-id="81209-261">幸運的是，沒有簡單的 SQL 陳述式來估計 hello hello 備份檔案大小：**選取\*從 M\_備份\_大小\_估計**(請參閱[評估 hello 空間需要在 hello 檔案系統的一種資料備份](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm))。</span><span class="sxs-lookup"><span data-stu-id="81209-261">Fortunately, there is a simple SQL statement that estimates hello size of hello backup files: **select \* from M\_BACKUP\_SIZE\_ESTIMATIONS** (see [Estimate hello Space Needed in hello File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span></span>

![此 SQL 陳述式的 hello 輸出符合幾乎完全 hello 實際大小 hello 完整的資料上的備份磁碟](media/sap-hana-backup-guide/image009.png)

<span data-ttu-id="81209-263">如 hello 測試系統，此 SQL 陳述式的 hello 輸出符合幾乎完全 hello 實際大小 hello 完整的資料上的備份磁碟。</span><span class="sxs-lookup"><span data-stu-id="81209-263">For hello test system, hello output of this SQL statement matches almost exactly hello real size of hello full data backup on disk.</span></span>

### <a name="test-hana-backup-file-size"></a><span data-ttu-id="81209-264">測試 HANA 備份檔案大小</span><span class="sxs-lookup"><span data-stu-id="81209-264">Test HANA backup file size</span></span>

![hello HANA Studio 備份主控台可讓一個 toorestrict hello 檔案大小上限的 HANA 備份檔案](media/sap-hana-backup-guide/image010.png)

<span data-ttu-id="81209-266">hello HANA Studio 備份主控台可讓一個 toorestrict hello 檔案大小上限的 HANA 備份檔案。</span><span class="sxs-lookup"><span data-stu-id="81209-266">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="81209-267">在 hello 範例環境中，該功能可讓多個較小的備份檔案而不是一個 230 GB 的備份檔案的可能 tooget。</span><span class="sxs-lookup"><span data-stu-id="81209-267">In hello sample environment, that feature makes it possible tooget multiple smaller backup files instead of one 230-GB backup file.</span></span> <span data-ttu-id="81209-268">較小的檔案大小對效能有顯著的影響 (請參閱相關文件 hello[檔案層級上的 SAP HANA Azure Backup](sap-hana-backup-file-level.md))。</span><span class="sxs-lookup"><span data-stu-id="81209-268">Smaller file size has a significant impact on performance (see hello related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md)).</span></span>

## <a name="summary"></a><span data-ttu-id="81209-269">摘要</span><span class="sxs-lookup"><span data-stu-id="81209-269">Summary</span></span>

<span data-ttu-id="81209-270">根據 hello 下表顯示的 Azure 虛擬機器上執行的 SAP HANA 資料庫解決方案 tooback 優缺點 hello 測試結果。</span><span class="sxs-lookup"><span data-stu-id="81209-270">Based on hello test results hello following tables show pros and cons of solutions tooback up an SAP HANA database running on Azure virtual machines.</span></span>

<span data-ttu-id="81209-271">**備份 SAP HANA toohello 檔案系統和複製備份之後檔案 toohello 最後的備份目的地**</span><span class="sxs-lookup"><span data-stu-id="81209-271">**Back up SAP HANA toohello file system and copy backup files afterwards toohello final backup destination**</span></span>

|<span data-ttu-id="81209-272">方案</span><span class="sxs-lookup"><span data-stu-id="81209-272">Solution</span></span>                                           |<span data-ttu-id="81209-273">優點</span><span class="sxs-lookup"><span data-stu-id="81209-273">Pros</span></span>                                 |<span data-ttu-id="81209-274">缺點</span><span class="sxs-lookup"><span data-stu-id="81209-274">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="81209-275">將 HANA 備份保留在 VM 磁碟上</span><span class="sxs-lookup"><span data-stu-id="81209-275">Keep HANA backups on VM disks</span></span>                      |<span data-ttu-id="81209-276">沒有額外的管理工作</span><span class="sxs-lookup"><span data-stu-id="81209-276">No additional management efforts</span></span>     |<span data-ttu-id="81209-277">耗盡本機 VM 磁碟空間</span><span class="sxs-lookup"><span data-stu-id="81209-277">Eats up local VM disk space</span></span>           |
|<span data-ttu-id="81209-278">Blobxfer 工具 toocopy 備份檔案 tooblob 儲存體</span><span class="sxs-lookup"><span data-stu-id="81209-278">Blobxfer tool toocopy backup files tooblob storage</span></span> |<span data-ttu-id="81209-279">平行處理原則 toocopy 多個檔案、 選擇 toouse 酷炫的 blob 儲存體</span><span class="sxs-lookup"><span data-stu-id="81209-279">Parallelism toocopy multiple files, choice toouse cool blob storage</span></span> | <span data-ttu-id="81209-280">需額外維護工具和自訂指令碼</span><span class="sxs-lookup"><span data-stu-id="81209-280">Additional tool maintenance and custom scripting</span></span> | 
|<span data-ttu-id="81209-281">透過 Powershell 或 CLI 進行 blob 複製</span><span class="sxs-lookup"><span data-stu-id="81209-281">Blob copy via Powershell or CLI</span></span>                    |<span data-ttu-id="81209-282">不需要額外的工具，透過 Azure Powershell 或 CLI 即可完成</span><span class="sxs-lookup"><span data-stu-id="81209-282">No additional tool necessary, can be accomplished via Azure Powershell or CLI</span></span> |<span data-ttu-id="81209-283">手動程序，客戶有 tootake care of 指令碼和管理的複製 blob 還原</span><span class="sxs-lookup"><span data-stu-id="81209-283">manual process, customer has tootake care of scripting and management of copied blobs for restore</span></span>|
|<span data-ttu-id="81209-284">複製 tooNFS 共用</span><span class="sxs-lookup"><span data-stu-id="81209-284">Copy tooNFS share</span></span>                                  |<span data-ttu-id="81209-285">備份檔案，而不會影響 hello HANA 伺服器上的其他 VM 上的後續處理</span><span class="sxs-lookup"><span data-stu-id="81209-285">Post-processing of backup files on other VM without impact on hello HANA server</span></span>|<span data-ttu-id="81209-286">複製程序緩慢</span><span class="sxs-lookup"><span data-stu-id="81209-286">Slow copy process</span></span>|
|<span data-ttu-id="81209-287">Blobxfer 複製 tooAzure 檔案服務</span><span class="sxs-lookup"><span data-stu-id="81209-287">Blobxfer copy tooAzure File Service</span></span>                |<span data-ttu-id="81209-288">不會耗盡本機 VM 磁碟上的空間</span><span class="sxs-lookup"><span data-stu-id="81209-288">Doesn't eat up space on local VM disks</span></span>|<span data-ttu-id="81209-289">HANA 備份不支援直接寫入、檔案共用目前的大小限制為 5 TB</span><span class="sxs-lookup"><span data-stu-id="81209-289">No direct write support by HANA backup, size restriction of file share currently at 5 TB</span></span>|
|<span data-ttu-id="81209-290">Azure 備份代理程式</span><span class="sxs-lookup"><span data-stu-id="81209-290">Azure Backup Agent</span></span>                                 | <span data-ttu-id="81209-291">會是較佳的解決方案</span><span class="sxs-lookup"><span data-stu-id="81209-291">Would be preferred solution</span></span>         | <span data-ttu-id="81209-292">目前無法在 Linux 上使用</span><span class="sxs-lookup"><span data-stu-id="81209-292">Currently not available on Linux</span></span>    |



<span data-ttu-id="81209-293">**以儲存體快照集為基礎的 SAP HANA 備份**</span><span class="sxs-lookup"><span data-stu-id="81209-293">**Backup SAP HANA based on storage snapshots**</span></span>

|<span data-ttu-id="81209-294">方案</span><span class="sxs-lookup"><span data-stu-id="81209-294">Solution</span></span>                                           |<span data-ttu-id="81209-295">優點</span><span class="sxs-lookup"><span data-stu-id="81209-295">Pros</span></span>                                 |<span data-ttu-id="81209-296">缺點</span><span class="sxs-lookup"><span data-stu-id="81209-296">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="81209-297">Azure 備份服務</span><span class="sxs-lookup"><span data-stu-id="81209-297">Azure Backup Service</span></span>                               | <span data-ttu-id="81209-298">允許以 blob 快照集為基礎備份 VM</span><span class="sxs-lookup"><span data-stu-id="81209-298">Allows VM backup based on blob snapshots</span></span> | <span data-ttu-id="81209-299">當不使用檔案層級還原，需要 hello 建立新的 VM hello 還原程序，表示然後 hello 需要新的 SAP HANA 授權金鑰</span><span class="sxs-lookup"><span data-stu-id="81209-299">When not using file level restore, it requires hello creation of a new VM for hello restore process, which then implies hello need of a new SAP HANA license key</span></span>|
|<span data-ttu-id="81209-300">手動 blob 快照集</span><span class="sxs-lookup"><span data-stu-id="81209-300">Manual blob snapshots</span></span>                              | <span data-ttu-id="81209-301">彈性 toocreate 和還原特定 VM 磁碟而不需要變更 hello VM 的唯一識別碼</span><span class="sxs-lookup"><span data-stu-id="81209-301">Flexibility toocreate and restore specific VM disks without changing hello unique VM ID</span></span>|<span data-ttu-id="81209-302">所有的手動工作，已由 hello 客戶 toobe</span><span class="sxs-lookup"><span data-stu-id="81209-302">All manual work, which has toobe done by hello customer</span></span>|

## <a name="next-steps"></a><span data-ttu-id="81209-303">後續步驟</span><span class="sxs-lookup"><span data-stu-id="81209-303">Next steps</span></span>
* <span data-ttu-id="81209-304">[SAP HANA Azure 備份檔案層級上](sap-hana-backup-file-level.md)hello 以檔案為基礎的備份選項的描述。</span><span class="sxs-lookup"><span data-stu-id="81209-304">[SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) describes hello file-based backup option.</span></span>
* <span data-ttu-id="81209-305">[SAP HANA 備份為基礎儲存快照集](sap-hana-backup-storage-snapshots.md)hello 儲存快照集式備份選項的描述。</span><span class="sxs-lookup"><span data-stu-id="81209-305">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="81209-306">toolearn tooestablish 高可用性和 Azure （大型執行個體） 上的 SAP HANA 災害復原計劃的看到[SAP HANA （大型執行個體） 高可用性和災害復原在 Azure 上的](hana-overview-high-availability-disaster-recovery.md)。</span><span class="sxs-lookup"><span data-stu-id="81209-306">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
