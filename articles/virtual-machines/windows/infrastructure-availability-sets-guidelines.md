---
title: "適用於 Windows Vm 在 Azure 中設定 aaaAvailability |Microsoft 文件"
description: "深入了解 hello 金鑰設計和實作指導方針在 Azure 基礎結構服務中部署可用性設定組。"
documentationcenter: 
services: virtual-machines-windows
author: iainfoulds
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: f9449f58-664b-4d5d-82f6-84c5d083047f
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 06/26/2017
ms.author: iainfou
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: cc35fd1e913434d9facb94116edb1b1c30447c71
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-availability-sets-guidelines-for-windows-vms"></a><span data-ttu-id="1e9d8-103">適用於 Windows VM 的 Azure 可用性設定組指導方針</span><span class="sxs-lookup"><span data-stu-id="1e9d8-103">Azure availability sets guidelines for Windows VMs</span></span>

[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-intro](../../../includes/virtual-machines-windows-infrastructure-guidelines-intro.md)]

<span data-ttu-id="1e9d8-104">本文著重在所需的了解 hello 規劃步驟，為可用性設定組 tooensure 應用程式仍然可以存取在計劃性或非計劃性的事件。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-104">This article focuses on understanding hello required planning steps for availability sets tooensure your applications remains accessible during planned or unplanned events.</span></span>

## <a name="implementation-guidelines-for-availability-sets"></a><span data-ttu-id="1e9d8-105">可用性設定組的實作指導方針</span><span class="sxs-lookup"><span data-stu-id="1e9d8-105">Implementation guidelines for availability sets</span></span>
<span data-ttu-id="1e9d8-106">决策：</span><span class="sxs-lookup"><span data-stu-id="1e9d8-106">Decisions:</span></span>

* <span data-ttu-id="1e9d8-107">多少可用性設定組您需要 hello 各種角色與階層中您的應用程式基礎結構？</span><span class="sxs-lookup"><span data-stu-id="1e9d8-107">How many availability sets do you need for hello various roles and tiers in your application infrastructure?</span></span>

<span data-ttu-id="1e9d8-108">工作：</span><span class="sxs-lookup"><span data-stu-id="1e9d8-108">Tasks:</span></span>

* <span data-ttu-id="1e9d8-109">您要求每個應用程式層中定義 Vm 的 hello 數目。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-109">Define hello number of VMs in each application tier you require.</span></span>
* <span data-ttu-id="1e9d8-110">判斷您是否需要使用您的應用程式的錯誤或更新網域 toobe tooadjust hello 數目。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-110">Determine if you need tooadjust hello number of fault or update domains toobe used for your application.</span></span>
* <span data-ttu-id="1e9d8-111">定義使用命名慣例和功能的所需的 hello 可用性設定組的 Vm 位於它們。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-111">Define hello required availability sets using your naming convention and what VMs reside in them.</span></span> <span data-ttu-id="1e9d8-112">一個可用性設定組中只能放置一個 VM。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-112">A VM can only reside in one availability set.</span></span>

## <a name="availability-sets"></a><span data-ttu-id="1e9d8-113">可用性集合</span><span class="sxs-lookup"><span data-stu-id="1e9d8-113">Availability sets</span></span>
<span data-ttu-id="1e9d8-114">在 Azure 中，虛擬機器 (Vm) 可以置於 tooa 邏輯群組稱為可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-114">In Azure, virtual machines (VMs) can be placed in tooa logical grouping called an availability set.</span></span> <span data-ttu-id="1e9d8-115">當您建立可用性設定組內的 Vm 時，hello Azure 平台會將這些 Vm 的 hello 放置分散 hello 基礎基礎結構。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-115">When you create VMs within an availability set, hello Azure platform distributes hello placement of those VMs across hello underlying infrastructure.</span></span> <span data-ttu-id="1e9d8-116">應該有預定的維護事件 toohello Azure 平台或基礎硬體/基礎結構錯誤，hello 使用可用性設定組可確保至少一個 VM 仍繼續執行。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-116">Should there be a planned maintenance event toohello Azure platform or an underlying hardware / infrastructure fault, hello use of availability sets ensures that at least one VM remains running.</span></span>

<span data-ttu-id="1e9d8-117">最佳作法是不將應用程式放置在單一 VM 上。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-117">As a best practice, applications should not reside on a single VM.</span></span> <span data-ttu-id="1e9d8-118">可用性設定組包含單一 VM 不會取得任何規劃或未規劃的事件內 hello Azure 平台的保護。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-118">An availability set that contains a single VM doesn't gain any protection from planned or unplanned events within hello Azure platform.</span></span> <span data-ttu-id="1e9d8-119">hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines)需要可用性集 tooallow hello 分配的 Vm hello 基礎基礎結構內的兩個或多個 Vm。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-119">hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines) requires two or more VMs within an availability set tooallow hello distribution of VMs across hello underlying infrastructure.</span></span> <span data-ttu-id="1e9d8-120">如果您使用[Azure 高階儲存體](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)，hello Azure SLA 套用 tooa 單一 VM。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-120">If you are using [Azure Premium Storage](../../storage/storage-premium-storage.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json), hello Azure SLA applies tooa single VM.</span></span>

<span data-ttu-id="1e9d8-121">在 Azure 中的 hello 基礎結構就會劃分 toomultiple 硬體叢集中。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-121">hello underlying infrastructure in Azure is divided in toomultiple hardware clusters.</span></span> <span data-ttu-id="1e9d8-122">每個硬體叢集皆可支援某個 VM 大小範圍。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-122">Each hardware cluster can support a range of VM sizes.</span></span> <span data-ttu-id="1e9d8-123">不論何時，可用性設定組都只能裝載在單一硬體叢集上。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-123">An availability set can only be hosted on a single hardware cluster at any point in time.</span></span> <span data-ttu-id="1e9d8-124">因此，可以存在於一個可用性設定組中的 hello 範圍的 VM 大小是 hello 硬體叢集所支援的限制的 toohello 範圍的 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-124">Therefore, hello range of VM sizes that can exist in a single availability set is limited toohello range of VM sizes supported by hello hardware cluster.</span></span> <span data-ttu-id="1e9d8-125">hello hello 可用性設定組中的第一個 VM 部署時，或啟動 hello hello 停止取消配置狀態目前是所有 Vm 的可用性設定組中的第一個 VM 時，會選取 hello 可用性設定組的 hello 硬體叢集。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-125">hello hardware cluster for hello availability set is selected when hello first VM in hello availability set is deployed or when starting hello first VM in an availability set where all VMs are currently in hello stopped-deallocated state.</span></span> <span data-ttu-id="1e9d8-126">下列 PowerShell 命令的 hello 可以是可用的可用性設定組的使用的 toodetermine hello 範圍的 VM 大小:"Get AzureRmVMSize ResourceGroupName\<字串\>-AvailabilitySetName\<字串\>"</span><span class="sxs-lookup"><span data-stu-id="1e9d8-126">hello following PowerShell command can be used toodetermine hello range of VM sizes available for an availability set: "Get-AzureRmVMSize -ResourceGroupName \<string\> -AvailabilitySetName \<string\>"</span></span>

<span data-ttu-id="1e9d8-127">每個硬體叢集分割 toomultiple 更新網域和故障網域。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-127">Each hardware cluster is divided in toomultiple update domains and fault domains.</span></span> <span data-ttu-id="1e9d8-128">這些網域是會根據主機是共用一般更新週期，或共用類似的實體基礎結構 (例如電源和網路功能) 來定義。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-128">These domains are defined by what hosts share a common update cycle, or share similar physical infrastructure such as power and networking.</span></span> <span data-ttu-id="1e9d8-129">Azure 會自動發佈您的 Vm 內的可用性設定組，跨網域 toomaintain 可用性和容錯功能。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-129">Azure automatically distributes your VMs within an availability set across domains toomaintain availability and fault tolerance.</span></span> <span data-ttu-id="1e9d8-130">根據應用程式與 hello Vm 數目在可用性集合中的 hello 大小，您可以調整 hello 數目的網域中，您想 toouse。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-130">Depending on hello size of your application and hello number of VMs within an availability set, you can adjust hello number of domains you wish toouse.</span></span> <span data-ttu-id="1e9d8-131">您可以深入了解[管理更新和容錯網域的可用性及使用](manage-availability.md)。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-131">You can read more about [managing availability and use of update and fault domains](manage-availability.md).</span></span>

<span data-ttu-id="1e9d8-132">在設計您的應用程式基礎結構時，規劃您使用的 hello 應用程式層。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-132">When designing your application infrastructure, plan hello application tiers that you use.</span></span> <span data-ttu-id="1e9d8-133">群組 Vm 做 hello 相同用途 tooavailability 集，例如可用性設定組為您執行 IIS 的前端 Vm。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-133">Group VMs that serve hello same purpose in tooavailability sets, such as an availability set for your front-end VMs running IIS.</span></span> <span data-ttu-id="1e9d8-134">為執行 SQL Server 的後端 VM 建立個別的可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-134">Create a separate availability set for your back-end VMs running SQL Server.</span></span> <span data-ttu-id="1e9d8-135">hello 目標是 tooensure 應用程式的每個元件受可用性設定組，且至少一次執行個體一定會保持執行。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-135">hello goal is tooensure that each component of your application is protected by an availability set and at least once instance always remains running.</span></span>

<span data-ttu-id="1e9d8-136">負載平衡器可以利用每個可用性設定組旁的應用程式層 toowork 前面，並確保流量都可以路由的 tooa 執行執行個體。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-136">Load balancers can be utilized in front of each application tier toowork alongside an availability set and ensure traffic can always be routed tooa running instance.</span></span> <span data-ttu-id="1e9d8-137">沒有負載平衡器 Vm 可能會繼續執行在計劃性與非計劃性的維護事件，但使用者可能無法 tooresolve 它們如果 hello 主要 VM 處於無法使用。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-137">Without a load balancer, your VMs may continue running throughout planned and unplanned maintenance events, but your end user may not be able tooresolve them if hello primary VM is unavailable.</span></span>

<span data-ttu-id="1e9d8-138">針對儲存層的高可用性設計應用程式。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-138">Design your application for high availability at storage layer.</span></span> <span data-ttu-id="1e9d8-139">hello 最佳做法太[的可用性設定組的 Vm 使用受管理磁碟](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set)。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-139">hello best practice is too[use Managed Disks for VMs in an Availability Set](manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span> <span data-ttu-id="1e9d8-140">如果您目前使用未受管理的磁碟，我們強烈建議您使用太[轉換中可用性設定組 toouse 管理磁碟 Vm](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set)。</span><span class="sxs-lookup"><span data-stu-id="1e9d8-140">If you are currently using unmanaged disks, we highly recommend you too[convert VMs in Availability Set toouse Managed Disks](convert-unmanaged-to-managed-disks.md#convert-vms-in-an-availability-set).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1e9d8-141">後續步驟</span><span class="sxs-lookup"><span data-stu-id="1e9d8-141">Next steps</span></span>
[!INCLUDE [virtual-machines-windows-infrastructure-guidelines-next-steps](../../../includes/virtual-machines-windows-infrastructure-guidelines-next-steps.md)]
