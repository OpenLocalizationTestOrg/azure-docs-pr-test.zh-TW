---
title: "Azure 中的虛擬網路和 Windows 虛擬機器 | Microsoft Docs"
description: "了解網路運作方式，因為這與在 Azure 中建立 Windows 虛擬機器的基本知識有關。"
services: virtual-machines-windows
documentationcenter: 
author: davidmu1
manager: timlt
editor: tysonn
tags: azure-resource-manager
ms.assetid: 5493e9f7-7d45-4e98-be9a-657a53708746
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: get-started-article
ms.date: 07/17/2017
ms.author: davidmu
ms.openlocfilehash: ad43daa8778d7b6046983cedceeef024ddc521e0
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="virtual-networks-and-windows-virtual-machines-in-azure"></a><span data-ttu-id="2cbfc-103">Azure 中的虛擬網路和 Windows 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="2cbfc-103">Virtual networks and Windows virtual machines in Azure</span></span> 

<span data-ttu-id="2cbfc-104">當您建立 Azure 虛擬機器 (VM) 時，您必須建立[虛擬網路](../../virtual-network/virtual-networks-overview.md) (VNet)，或使用現有的 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-104">When you create an Azure virtual machine (VM), you must create a [virtual network](../../virtual-network/virtual-networks-overview.md) (VNet) or use an existing VNet.</span></span> <span data-ttu-id="2cbfc-105">您也需要決定如何在 VNet 上存取您的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-105">You also need to decide how your VMs are intended to be accessed on the VNet.</span></span> <span data-ttu-id="2cbfc-106">請務必[在建立資源前進行規劃](../../virtual-network/virtual-network-vnet-plan-design-arm.md)，並確定您已了解[網路資源的限制](../../azure-subscription-service-limits.md#networking-limits)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-106">It is important to [plan before creating resources](../../virtual-network/virtual-network-vnet-plan-design-arm.md) and make sure that you understand the [limits of networking resources](../../azure-subscription-service-limits.md#networking-limits).</span></span>

<span data-ttu-id="2cbfc-107">在下圖中，VM 是以 Web 伺服器和資料庫伺服器表示。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-107">In the following figure, VMs are represented as web servers and database servers.</span></span> <span data-ttu-id="2cbfc-108">每一組 VM 都會指派給 VNet 中的個別子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-108">Each set of VMs are assigned to separate subnets in the VNet.</span></span>

![Azure 虛擬網路](./media/network-overview/vnetoverview.png)

<span data-ttu-id="2cbfc-110">您可以在建立 VM 前建立 VNet，也可以在建立 VM 時建立 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-110">You can either create a VNet before you create a VM or you can create the VNet when creating a VM.</span></span> <span data-ttu-id="2cbfc-111">您必須自行建立 VNet，否則系統會在您建立 VM 時為您建立 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-111">You must either create a VNet yourself or one is created for you when you create a VM.</span></span>

<span data-ttu-id="2cbfc-112">您可建立下列資源來支援與 VM 的通訊︰</span><span class="sxs-lookup"><span data-stu-id="2cbfc-112">You create these resources to support communication with a VM:</span></span>

- <span data-ttu-id="2cbfc-113">網路介面</span><span class="sxs-lookup"><span data-stu-id="2cbfc-113">Network interfaces</span></span>
- <span data-ttu-id="2cbfc-114">IP 位址</span><span class="sxs-lookup"><span data-stu-id="2cbfc-114">IP addresses</span></span>
- <span data-ttu-id="2cbfc-115">虛擬網路和子網路</span><span class="sxs-lookup"><span data-stu-id="2cbfc-115">Virtual network and subnets</span></span>

<span data-ttu-id="2cbfc-116">除了上述基本資源以外，您也應該考慮下列選擇性資源︰</span><span class="sxs-lookup"><span data-stu-id="2cbfc-116">In addition to those basic resources, you should also consider these optional resources:</span></span>

- <span data-ttu-id="2cbfc-117">網路安全性群組</span><span class="sxs-lookup"><span data-stu-id="2cbfc-117">Network security groups</span></span>
- <span data-ttu-id="2cbfc-118">負載平衡器</span><span class="sxs-lookup"><span data-stu-id="2cbfc-118">Load balancers</span></span> 

## <a name="network-interfaces"></a><span data-ttu-id="2cbfc-119">網路介面</span><span class="sxs-lookup"><span data-stu-id="2cbfc-119">Network interfaces</span></span>

<span data-ttu-id="2cbfc-120">[網路介面 (NIC)](../../virtual-network/virtual-network-network-interface.md) 是 VM 與虛擬網路 (VNet) 之間互相連線的橋樑。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-120">A [network interface (NIC)](../../virtual-network/virtual-network-network-interface.md) is the interconnection between a VM and a virtual network (VNet).</span></span> <span data-ttu-id="2cbfc-121">VM 必須有至少一個 NIC，但視您所建立的 VM 大小而定，可以有一個以上的 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-121">A VM must have at least one NIC, but can have more than one, depending on the size of the VM you create.</span></span> <span data-ttu-id="2cbfc-122">若要了解每個 VM 大小支援幾個 NIC，請參閱 [Azure 中的虛擬機器大小](sizes.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-122">Learn about how many NICs each VM size supports in [Sizes for virtual machines in Azure](sizes.md).</span></span> 

<span data-ttu-id="2cbfc-123">如果您想要建立具有多個 NIC 的 VM，您必須建立至少有兩個 NIC 的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-123">If you want to create a VM with more than one NIC, you must create the VM with at least two.</span></span>  <span data-ttu-id="2cbfc-124">建立之後，您可以新增其他 NIC，直到 VM 大小所支援的數目為止，但不論 VM 大小可支援多少個 NIC，您都無法將其他 NIC 新增至僅以一個 NIC 建立的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-124">After creation you can add additional NICs up to the number supported by the VM size, but you cannot add additional NICs to a VM only created with one, regardless of how many NICs the VM size supports.</span></span> 

<span data-ttu-id="2cbfc-125">如果 VM 已新增至可用性設定組，則可用性設定組內的所有 VM 都必須具有一或多個 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-125">If the VM is added to an availability set, all VMs within the availability set must have one or multiple NICs.</span></span> <span data-ttu-id="2cbfc-126">具有多個 NIC 的 VM 不需要有相同數目的 NIC，但全都必須有至少兩個 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-126">VMs with more than one NIC aren’t required to have the same number of NICs, but they must all have at least two.</span></span>

<span data-ttu-id="2cbfc-127">連接到 VM 的每個 NIC 都必須與 VM 位於相同的位置和訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-127">Each NIC attached to a VM must exist in the same location and subscription as the VM.</span></span> <span data-ttu-id="2cbfc-128">每個 NIC 都必須連接到與 NIC 位於相同 Azure 位置和訂用帳戶中的 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-128">Each NIC must be connected to a VNet that exists in the same Azure location and subscription as the NIC.</span></span> <span data-ttu-id="2cbfc-129">NIC 建立之後，您可以變更它所連線的子網路，但無法變更它所連線的 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-129">After a NIC is created, you can change the subnet it's connected to, but you cannot change the VNet it's connected to.</span></span>  <span data-ttu-id="2cbfc-130">連接到 VM 的每個 NIC 會被指派 MAC 位址，該 MAC 位址在 VM 刪除前不會變更。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-130">Each NIC attached to a VM is assigned a MAC address that doesn’t change until the VM is deleted.</span></span>

<span data-ttu-id="2cbfc-131">下表列出可用於建立網路介面的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-131">This table lists the methods that you can use to create a network interface.</span></span>

| <span data-ttu-id="2cbfc-132">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-132">Method</span></span> | <span data-ttu-id="2cbfc-133">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-133">Description</span></span> |
| ------ | ----------- |
| <span data-ttu-id="2cbfc-134">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-134">Azure portal</span></span> | <span data-ttu-id="2cbfc-135">當您在 Azure 入口網站中建立 VM 時，系統會自動為您建立網路介面 (您無法使用您個別建立的 NIC)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-135">When you create a VM in the Azure portal, a network interface is automatically created for you (you cannot use a NIC you create separately).</span></span> <span data-ttu-id="2cbfc-136">入口網站會建立只有一個 NIC 的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-136">The portal creates a VM with only one NIC.</span></span> <span data-ttu-id="2cbfc-137">如果您想要建立具有多個 NIC 的 VM，您必須使用不同的方法來建立它。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-137">If you want to create a VM with more than one NIC, you must create it with a different method.</span></span> |
| [<span data-ttu-id="2cbfc-138">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-138">Azure PowerShell</span></span>](../../virtual-network/virtual-network-deploy-multinic-arm-ps.md) | <span data-ttu-id="2cbfc-139">使用 [New-AzureRmNetworkInterface](/powershell/module/azurerm.network/new-azurermnetworkinterface) 搭配 **-PublicIpAddressId** 參數，提供您先前建立之公用 IP 位址的識別項。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-139">Use [New-AzureRmNetworkInterface](/powershell/module/azurerm.network/new-azurermnetworkinterface) with the **-PublicIpAddressId** parameter to provide the identifer of the public IP address that you previously created.</span></span> |
| [<span data-ttu-id="2cbfc-140">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-140">Azure CLI</span></span>](../../virtual-network/virtual-network-deploy-multinic-arm-cli.md) | <span data-ttu-id="2cbfc-141">若要提供您先前建立之公用 IP 位址的識別項，請使用 [az network nic create](https://docs.microsoft.com/cli/azure/network/nic#create) 搭配 **--public-ip-address** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-141">To provide the identifer of the public IP address that you previously created, use [az network nic create](https://docs.microsoft.com/cli/azure/network/nic#create) with the **--public-ip-address** parameter.</span></span> |
| [<span data-ttu-id="2cbfc-142">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-142">Template</span></span>](../../virtual-network/virtual-network-deploy-multinic-arm-template.md) | <span data-ttu-id="2cbfc-143">使用[虛擬網路中具有公用 IP 位址的網路介面](https://github.com/Azure/azure-quickstart-templates/tree/master/101-nic-publicip-dns-vnet)做為使用範本部署網路介面的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-143">Use [Network Interface in a Virtual Network with Public IP Address](https://github.com/Azure/azure-quickstart-templates/tree/master/101-nic-publicip-dns-vnet) as a guide for deploying a network interface using a template.</span></span> |

## <a name="ip-addresses"></a><span data-ttu-id="2cbfc-144">IP 位址</span><span class="sxs-lookup"><span data-stu-id="2cbfc-144">IP addresses</span></span> 

<span data-ttu-id="2cbfc-145">您可以將下列 [IP 位址](../../virtual-network/virtual-network-ip-addresses-overview-arm.md)類型指派給 Azure 中的 NIC：</span><span class="sxs-lookup"><span data-stu-id="2cbfc-145">You can assign these types of [IP addresses](../../virtual-network/virtual-network-ip-addresses-overview-arm.md) to a NIC in Azure:</span></span>

- <span data-ttu-id="2cbfc-146">**公用 IP 位址** - 用來進行輸入和輸出 (不需網路位址轉譯 (NAT)) 與網際網路及其他未連接到 VNet 之 Azure 資源的通訊。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-146">**Public IP addresses** - Used to communicate inbound and outbound (without network address translation (NAT)) with the Internet and other Azure resources not connected to a VNet.</span></span> <span data-ttu-id="2cbfc-147">將公用 IP 位址指派給 NIC 是選擇性作業。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-147">Assigning a public IP address to a NIC is optional.</span></span> <span data-ttu-id="2cbfc-148">公用 IP 位址有象徵性費用，而每個訂用帳戶都有可用的數目上限。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-148">Public IP addresses have a nominal charge and there's a maximum number that can be used per subscription.</span></span>
- <span data-ttu-id="2cbfc-149">**私用 IP 位址** - 用於在 VNet、內部部署網路和網際網路 (需要 NAT) 內的通訊。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-149">**Private IP addresses** - Used for communication within a VNet, your on-premises network, and the Internet (with NAT).</span></span> <span data-ttu-id="2cbfc-150">您必須將至少一個私人 IP 位址指派給 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-150">You must assign at least one private IP address to a VM.</span></span> <span data-ttu-id="2cbfc-151">若要了解 Azure 中的 NAT，請參閱[了解 Azure 中的輸出連線](../../load-balancer/load-balancer-outbound-connections.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-151">To learn more about NAT in Azure, read [Understanding outbound connections in Azure](../../load-balancer/load-balancer-outbound-connections.md).</span></span>

<span data-ttu-id="2cbfc-152">您可以將公用 IP 位址指派給 VM 或網際網路面向的負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-152">You can assign public IP addresses to VMs or internet-facing load balancers.</span></span> <span data-ttu-id="2cbfc-153">您可以將私人 IP 位址指派給 VM 和內部負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-153">You can assign private IP addresses to VMs and internal load balancers.</span></span> <span data-ttu-id="2cbfc-154">您可使用網路介面將 IP 位址指派給 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-154">You assign IP addresses to a VM using a network interface.</span></span>

<span data-ttu-id="2cbfc-155">有兩種方法可將 IP 位址配置給資源：動態或靜態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-155">There are two methods in which an IP address is allocated to a resource - dynamic or static.</span></span> <span data-ttu-id="2cbfc-156">預設配置方法為動態，此方法不會在建立 IP 位址時進行配置。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-156">The default allocation method is dynamic, where an IP address is not allocated when it's created.</span></span> <span data-ttu-id="2cbfc-157">然而，IP 位址會在您建立 VM 或啟動已停止的 VM 時進行配置。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-157">Instead, the IP address is allocated when you create a VM or start a stopped VM.</span></span> <span data-ttu-id="2cbfc-158">此 IP 位址會在您停止或刪除 VM 時釋出。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-158">The IP address is released when you stop or delete the VM.</span></span> 

<span data-ttu-id="2cbfc-159">若要確保 VM 的 IP 位址維持不變，您可以明確地將配置方法設定為靜態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-159">To ensure the IP address for the VM remains the same, you can set the allocation method explicitly to static.</span></span> <span data-ttu-id="2cbfc-160">在此情況下會立即指派 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-160">In this case, an IP address is assigned immediately.</span></span> <span data-ttu-id="2cbfc-161">只有在您刪除 VM 或將其配置方法變更為動態時，才會釋出 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-161">It is released only when you delete the VM or change its allocation method to dynamic.</span></span>
    
<span data-ttu-id="2cbfc-162">下表列出可用於建立 IP 位址的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-162">This table lists the methods that you can use to create an IP address.</span></span>

| <span data-ttu-id="2cbfc-163">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-163">Method</span></span> | <span data-ttu-id="2cbfc-164">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-164">Description</span></span> |
| ------ | ----------- |
| [<span data-ttu-id="2cbfc-165">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-165">Azure portal</span></span>](../../virtual-network/virtual-network-deploy-static-pip-arm-portal.md) | <span data-ttu-id="2cbfc-166">依照預設，公用 IP 位址是動態的，而且與其相關聯的位址可能會在停止或刪除 VM 時變更。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-166">By default, public IP addresses are dynamic and the address associated to them may change when the VM is stopped or deleted.</span></span> <span data-ttu-id="2cbfc-167">若要保證 VM 一律使用相同的公用 IP 位址，請建立靜態公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-167">To guarantee that the VM always uses the same public IP address, create a static public IP address.</span></span> <span data-ttu-id="2cbfc-168">根據預設，入口網站會在建立 VM 時將動態私人 IP 位址指派給 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-168">By default, the portal assigns a dynamic private IP address to a NIC when creating a VM.</span></span> <span data-ttu-id="2cbfc-169">您可以在 VM 建立後，將此變更為靜態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-169">You can change this to static after the VM is created.</span></span>|
| [<span data-ttu-id="2cbfc-170">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-170">Azure PowerShell</span></span>](../../virtual-network/virtual-network-deploy-static-pip-arm-ps.md) | <span data-ttu-id="2cbfc-171">您可使用 [New-AzureRmPublicIpAddress](/powershell/module/azurerm.network/new-azurermpublicipaddress) 搭配 [動態] 或 [靜態] 的 **-AllocationMethod** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-171">You use [New-AzureRmPublicIpAddress](/powershell/module/azurerm.network/new-azurermpublicipaddress) with the **-AllocationMethod** parameter as Dynamic or Static.</span></span> |
| [<span data-ttu-id="2cbfc-172">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-172">Azure CLI</span></span>](../../virtual-network/virtual-network-deploy-static-pip-arm-cli.md) | <span data-ttu-id="2cbfc-173">您可使用 [az network public-ip create](https://docs.microsoft.com/cli/azure/network/public-ip#create) 搭配 [動態] 或 [靜態] 的 **--allocation-method** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-173">You use [az network public-ip create](https://docs.microsoft.com/cli/azure/network/public-ip#create) with the **--allocation-method** parameter as Dynamic or Static.</span></span> |
| [<span data-ttu-id="2cbfc-174">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-174">Template</span></span>](../../virtual-network/virtual-network-deploy-static-pip-arm-template.md) | <span data-ttu-id="2cbfc-175">使用[虛擬網路中具有公用 IP 位址的網路介面](https://github.com/Azure/azure-quickstart-templates/tree/master/101-nic-publicip-dns-vnet)做為使用範本部署公用 IP 位址的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-175">Use [Network Interface in a Virtual Network with Public IP Address](https://github.com/Azure/azure-quickstart-templates/tree/master/101-nic-publicip-dns-vnet) as a guide for deploying a public IP address using a template.</span></span> |

<span data-ttu-id="2cbfc-176">建立公用 IP 位址之後，您可以將它指派給 NIC 以建立其與 VM 的關聯。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-176">After you create a public IP address, you can associate it with a VM by assigning it to a NIC.</span></span>

## <a name="virtual-network-and-subnets"></a><span data-ttu-id="2cbfc-177">虛擬網路和子網路</span><span class="sxs-lookup"><span data-stu-id="2cbfc-177">Virtual network and subnets</span></span>

<span data-ttu-id="2cbfc-178">子網路是 VNet 中的 IP 位址範圍。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-178">A subnet is a range of IP addresses in the VNet.</span></span> <span data-ttu-id="2cbfc-179">您可以針對組織和安全性，將 VNet 分割成多個子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-179">You can divide a VNet into multiple subnets for organization and security.</span></span> <span data-ttu-id="2cbfc-180">VM 中的每個 NIC 都會連接到一個 VNet 中的一個子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-180">Each NIC in a VM is connected to one subnet in one VNet.</span></span> <span data-ttu-id="2cbfc-181">連接到 VNet 內 (相同或不同) 子網路的 NIC 不需要進行額外設定，就可以彼此通訊。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-181">NICs connected to subnets (same or different) within a VNet can communicate with each other without any extra configuration.</span></span>

<span data-ttu-id="2cbfc-182">當您設定 VNet 時，您可以指定拓撲，包括可用的位址空間和子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-182">When you set up a VNet, you specify the topology, including the available address spaces and subnets.</span></span> <span data-ttu-id="2cbfc-183">如果 VNet 要連接至其他 Vnet 或內部部署網路，您必須選取不重疊的位址範圍。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-183">If the VNet is to be connected to other VNets or on-premises networks, you must select address ranges that don't overlap.</span></span> <span data-ttu-id="2cbfc-184">IP 位址是無法從網際網路存取的私人位址，而不可路由傳送的 IP 位址也是如此，例如 10.0.0.0/8、172.16.0.0/12 或 192.168.0.0/16。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-184">The IP addresses are private and can't be accessed from the Internet, which was true only for the non-routeable IP addresses such as 10.0.0.0/8, 172.16.0.0/12, or 192.168.0.0/16.</span></span> <span data-ttu-id="2cbfc-185">現在，Azure 會將任何位址範圍視為私人 VNet IP 位址空間的一部分，而該位址空間僅能在 VNet、互連式 VNet 中，以及從內部部署位置進行存取。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-185">Now, Azure treats any address range as part of the private VNet IP address space that is only reachable within the VNet, within interconnected VNets, and from your on-premises location.</span></span> 

<span data-ttu-id="2cbfc-186">如果您在由他人負責內部網路的組織中工作，您應該先洽詢該人員，再選取您的位址空間。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-186">If you work within an organization in which someone else is responsible for the internal networks, you should talk to that person before selecting your address space.</span></span> <span data-ttu-id="2cbfc-187">請確定沒有重疊，並且讓他們知道您想要使用的空間，他們才不會嘗試使用相同的 IP 位址範圍。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-187">Make sure there is no overlap and let them know the space you want to use so they don’t try to use the same range of IP addresses.</span></span> 

<span data-ttu-id="2cbfc-188">根據預設，子網路之間沒有任何安全界限，所以每個子網路中的 VM 都可以彼此通訊。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-188">By default, there is no security boundary between subnets, so VMs in each of these subnets can talk to one another.</span></span> <span data-ttu-id="2cbfc-189">不過，您可以設定網路安全性群組 (NSG)，以便控制往返子網路及往返 VM 的流量。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-189">However, you can set up Network Security Groups (NSGs), which allow you to control the traffic flow to and from subnets and to and from VMs.</span></span> 

<span data-ttu-id="2cbfc-190">下表列出可用於建立 VNet 和子網路的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-190">This table lists the methods that you can use to create a VNet and subnets.</span></span> 

| <span data-ttu-id="2cbfc-191">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-191">Method</span></span> | <span data-ttu-id="2cbfc-192">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-192">Description</span></span> |
| ------ | ----------- |
| [<span data-ttu-id="2cbfc-193">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-193">Azure portal</span></span>](../../virtual-network/virtual-networks-create-vnet-arm-pportal.md) | <span data-ttu-id="2cbfc-194">如果您讓 Azure 在您建立 VM 時建立 VNet，則名稱為包含 VNet 和 **-vnet** 的資源群組名稱組合。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-194">If you let Azure create a VNet when you create a VM, the name is a combination of the resource group name that contains the VNet and **-vnet**.</span></span> <span data-ttu-id="2cbfc-195">位址空間是 10.0.0.0/24，必要的子網路名稱是**default**，而子網路位址範圍是 10.0.0.0/24。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-195">The address space is 10.0.0.0/24, the required subnet name is **default**, and the subnet address range is 10.0.0.0/24.</span></span> |
| [<span data-ttu-id="2cbfc-196">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-196">Azure PowerShell</span></span>](../../virtual-network/virtual-networks-create-vnet-arm-ps.md) | <span data-ttu-id="2cbfc-197">您可使用 [New-AzureRmVirtualNetworkSubnetConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmVirtualNetworkSubnetConfig) 和 [New-AzureRmVirtualNetwork](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmVirtualNetwork) 來建立子網路和 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-197">You use [New-AzureRmVirtualNetworkSubnetConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmVirtualNetworkSubnetConfig) and [New-AzureRmVirtualNetwork](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmVirtualNetwork) to create a subnet and a VNet.</span></span> <span data-ttu-id="2cbfc-198">您也可以使用 [Add-AzureRmVirtualNetworkSubnetConfig](/powershell/module/azurerm.network/add-azurermvirtualnetworksubnetconfig) 將子網路新增至現有的 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-198">You can also use [Add-AzureRmVirtualNetworkSubnetConfig](/powershell/module/azurerm.network/add-azurermvirtualnetworksubnetconfig) to add a subnet to an existing VNet.</span></span> |
| [<span data-ttu-id="2cbfc-199">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-199">Azure CLI</span></span>](../../virtual-network/virtual-networks-create-vnet-arm-cli.md) | <span data-ttu-id="2cbfc-200">子網路和 VNet 會在同一時間建立。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-200">The subnet and the VNet are created at the same time.</span></span> <span data-ttu-id="2cbfc-201">將 **--subnet-name** 參數提供給包含子網路名稱的 [az network vnet create](https://docs.microsoft.com/cli/azure/network/vnet#create)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-201">Provide a **--subnet-name** parameter to [az network vnet create](https://docs.microsoft.com/cli/azure/network/vnet#create) with the subnet name.</span></span> |
| [<span data-ttu-id="2cbfc-202">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-202">Template</span></span>](../../virtual-network/virtual-networks-create-vnet-arm-template-click.md) | <span data-ttu-id="2cbfc-203">建立 VNet 和子網路的最簡單方式就是下載現有的範本 (例如[具有兩個子網路的虛擬網路](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vnet-two-subnets))，並針對您的需求加以修改。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-203">The easiest way to create a VNet and subnets is to download an existing template, such as [Virtual Network with two Subnets](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vnet-two-subnets), and modify it for your needs.</span></span> |

## <a name="network-security-groups"></a><span data-ttu-id="2cbfc-204">網路安全性群組</span><span class="sxs-lookup"><span data-stu-id="2cbfc-204">Network security groups</span></span>

<span data-ttu-id="2cbfc-205">[網路安全性群組 (NSG)](../../virtual-network/virtual-networks-nsg.md) 包含存取控制清單 (ACL) 規則的清單，可允許或拒絕子網路、NIC 或兩者的網路流量。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-205">A [network security group (NSG)](../../virtual-network/virtual-networks-nsg.md) contains a list of Access Control List (ACL) rules that allow or deny network traffic to subnets, NICs, or both.</span></span> <span data-ttu-id="2cbfc-206">NSG 可與子網路或連接到子網路的個別 VM 相關聯。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-206">NSGs can be associated with either subnets or individual NICs connected to a subnet.</span></span> <span data-ttu-id="2cbfc-207">當 NSG 與子網路相關聯時，ACL 規則便會套用至該子網路中的所有 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-207">When an NSG is associated with a subnet, the ACL rules apply to all the VMs in that subnet.</span></span> <span data-ttu-id="2cbfc-208">此外，將 NSG 直接關聯至 NIC，即可限制個別 NIC 的流量。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-208">In addition, traffic to an individual NIC can be restricted by associating an NSG directly to a NIC.</span></span>

<span data-ttu-id="2cbfc-209">NSG 包含兩組規則：輸入和輸出。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-209">NSGs contain two sets of rules: inbound and outbound.</span></span> <span data-ttu-id="2cbfc-210">規則的優先順序在每一個集合中必須是唯一的。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-210">The priority for a rule must be unique within each set.</span></span> <span data-ttu-id="2cbfc-211">每個規則都有通訊協定、來源和目的地連接埠範圍、位址前置詞、流量方向、優先順序和存取類型的屬性。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-211">Each rule has properties of protocol, source and destination port ranges, address prefixes, direction of traffic, priority, and access type.</span></span> 

<span data-ttu-id="2cbfc-212">所有 NSG 都包含一組預設規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-212">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="2cbfc-213">預設規則無法刪除，但因為其會指派為最低優先權，因此可以由您所建立的規則覆寫預設規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-213">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span></span> 

<span data-ttu-id="2cbfc-214">當您將 NSG 與 NIC 建立關聯時，NSG 中的網路存取規則只會套用到該 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-214">When you associate an NSG to a NIC, the network access rules in the NSG are applied only to that NIC.</span></span> <span data-ttu-id="2cbfc-215">如果 NSG 已套用到多重 NIC VM 上的單一 NIC，則不會影響其他 NIC 的流量。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-215">If an NSG is applied to a single NIC on a multi-NIC VM, it does not affect traffic to the other NICs.</span></span> <span data-ttu-id="2cbfc-216">您可以將不同的 NSG 與 NIC (或 VM，根據部署模型而定) 和 NIC 或 VM 所繫結的子網路建立關聯。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-216">You can associate different NSGs to a NIC (or VM, depending on the deployment model) and the subnet that a NIC or VM is bound to.</span></span> <span data-ttu-id="2cbfc-217">優先順序是根據流量的方向來提供。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-217">Priority is given based on the direction of traffic.</span></span>

<span data-ttu-id="2cbfc-218">請務必在規劃 VM 和 VNet 時[規劃](../../virtual-network/virtual-networks-nsg.md#planning) NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-218">Be sure to [plan](../../virtual-network/virtual-networks-nsg.md#planning) your NSGs when you plan your VMs and VNet.</span></span>

<span data-ttu-id="2cbfc-219">下表列出可用於建立網路安全性群組的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-219">This table lists the methods that you can use to create a network security group.</span></span>

| <span data-ttu-id="2cbfc-220">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-220">Method</span></span> | <span data-ttu-id="2cbfc-221">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-221">Description</span></span> |
| ------ | ----------- |
| [<span data-ttu-id="2cbfc-222">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-222">Azure portal</span></span>](../../virtual-network/virtual-networks-create-nsg-arm-pportal.md) | <span data-ttu-id="2cbfc-223">當您在 Azure 入口網站中建立 VM 時，NSG 會自動建立並與入口網站所建立的 NIC 產生關聯。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-223">When you create a VM in the Azure portal, an NSG is automatically created and associated to the NIC the portal creates.</span></span> <span data-ttu-id="2cbfc-224">NSG 名稱是 VM 名稱與 **-nsg** 的組合。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-224">The name of the NSG is a combination of the name of the VM and **-nsg**.</span></span> <span data-ttu-id="2cbfc-225">此 NSG 包含一個輸入規則，其優先順序為 1000、服務設定為 RDP、通訊協定設定為 TCP、連接埠設定為 3389，而動作設定為 [允許]。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-225">This NSG contains one inbound rule with a priority of 1000, service set to RDP, the protocol set to TCP, port set to 3389, and action set to Allow.</span></span> <span data-ttu-id="2cbfc-226">如果想要允許 VM 的任何其他輸入流量，您必須將其他規則新增至 NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-226">If you want to allow any other inbound traffic to the VM, you must add additional rules to the NSG.</span></span> |
| [<span data-ttu-id="2cbfc-227">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-227">Azure PowerShell</span></span>](../../virtual-network/virtual-networks-create-nsg-arm-ps.md) | <span data-ttu-id="2cbfc-228">使用 [New-AzureRmNetworkSecurityRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmNetworkSecurityRuleConfig) 並提供必要的規則資訊。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-228">Use [New-AzureRmNetworkSecurityRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmNetworkSecurityRuleConfig) and provide the required rule information.</span></span> <span data-ttu-id="2cbfc-229">使用 [New-AzureRmNetworkSecurityGroup](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmNetworkSecurityGroup) 建立 NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-229">Use [New-AzureRmNetworkSecurityGroup](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmNetworkSecurityGroup) to create the NSG.</span></span> <span data-ttu-id="2cbfc-230">使用 [Set-AzureRmVirtualNetworkSubnetConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/Set-AzureRmVirtualNetworkSubnetConfig) 設定子網路的 NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-230">Use [Set-AzureRmVirtualNetworkSubnetConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/Set-AzureRmVirtualNetworkSubnetConfig) to configure the NSG for the subnet.</span></span> <span data-ttu-id="2cbfc-231">使用 [Set-AzureRmVirtualNetwork](/powershell/module/azurerm.network/set-azurermvirtualnetwork) 將 NSG 新增至 VNet。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-231">Use [Set-AzureRmVirtualNetwork](/powershell/module/azurerm.network/set-azurermvirtualnetwork) to add the NSG to the VNet.</span></span> |
| [<span data-ttu-id="2cbfc-232">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-232">Azure CLI</span></span>](../../virtual-network/virtual-networks-create-nsg-arm-cli.md) | <span data-ttu-id="2cbfc-233">使用 [az network nsg create](https://docs.microsoft.com/cli/azure/network/nsg#create) 初始建立 NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-233">Use [az network nsg create](https://docs.microsoft.com/cli/azure/network/nsg#create) to initially create the NSG.</span></span> <span data-ttu-id="2cbfc-234">使用 [az network nsg create](https://docs.microsoft.com/cli/azure/network/nsg/rule#create) 將規則新增至 NSG。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-234">Use [az network nsg rule create](https://docs.microsoft.com/cli/azure/network/nsg/rule#create) to add rules to the NSG.</span></span> <span data-ttu-id="2cbfc-235">使用 [az network vnet subnet update](https://docs.microsoft.com/en-us/cli/azure/network/vnet/subnet#update) 將 NSG 新增至子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-235">Use [az network vnet subnet update](https://docs.microsoft.com/en-us/cli/azure/network/vnet/subnet#update) to add the NSG to the subnet.</span></span> |
| [<span data-ttu-id="2cbfc-236">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-236">Template</span></span>](../../virtual-network/virtual-networks-create-nsg-arm-template.md) | <span data-ttu-id="2cbfc-237">使用[建立網路安全性群組](https://github.com/Azure/azure-quickstart-templates/tree/master/101-security-group-create)做為使用範本部署網路安全性群組的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-237">Use [Create a Network Security Group](https://github.com/Azure/azure-quickstart-templates/tree/master/101-security-group-create) as a guide for deploying a network security group using a template.</span></span> |

## <a name="load-balancers"></a><span data-ttu-id="2cbfc-238">負載平衡器</span><span class="sxs-lookup"><span data-stu-id="2cbfc-238">Load balancers</span></span>

<span data-ttu-id="2cbfc-239">[Azure Load Balancer](../../load-balancer/load-balancer-overview.md) 可為您的應用程式提供高可用性和網路效能。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-239">[Azure Load Balancer](../../load-balancer/load-balancer-overview.md) delivers high availability and network performance to your applications.</span></span> <span data-ttu-id="2cbfc-240">您可以將負載平衡器設定成[平衡 VM 的傳入網際網路流量](../../load-balancer/load-balancer-internet-overview.md)或[平衡 VNet 中 VM 之間的流量](../../load-balancer/load-balancer-internal-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-240">A load balancer can be configured to [balance incoming Internet traffic](../../load-balancer/load-balancer-internet-overview.md) to VMs or [balance traffic between VMs in a VNet](../../load-balancer/load-balancer-internal-overview.md).</span></span> <span data-ttu-id="2cbfc-241">負載平衡器也可以平衡內部部署電腦與跨內部部署網路中 VM 之間的流量，或將外部流量轉送到特定的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-241">A load balancer can also balance traffic between on-premises computers and VMs in a cross-premises network, or forward external traffic to a specific VM.</span></span>

<span data-ttu-id="2cbfc-242">負載平衡器會對應公用 IP 位址與負載平衡器上連接埠以及私人 IP 位址與 VM 連接埠之間的傳入和傳出流量。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-242">The load balancer maps incoming and outgoing traffic between the public IP address and port on the load balancer and the private IP address and port of the VM.</span></span>

<span data-ttu-id="2cbfc-243">當您建立負載平衡器時，您也必須考慮下列組態元素︰</span><span class="sxs-lookup"><span data-stu-id="2cbfc-243">When you create a load balancer, you must also consider these configuration elements:</span></span>

- <span data-ttu-id="2cbfc-244">**前端 IP 組態** – 負載平衡器可以包含一或多個前端 IP 位址 (亦稱為虛擬 IP (VIP))。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-244">**Front-end IP configuration** – A load balancer can include one or more front-end IP addresses, otherwise known as virtual IPs (VIPs).</span></span> <span data-ttu-id="2cbfc-245">這些 IP 位址做為流量的輸入。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-245">These IP addresses serve as ingress for the traffic.</span></span>
- <span data-ttu-id="2cbfc-246">**後端位址集區** – 與 NIC 相關聯的 IP 位址，而負載會散發到該 NIC。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-246">**Back-end address pool** – IP addresses that are associated with the NIC to which load is distributed.</span></span>
- <span data-ttu-id="2cbfc-247">**NAT 規則** - 定義輸入流量流經前端 IP 並散發到後端 IP 的方式。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-247">**NAT rules** - Defines how inbound traffic flows through the front-end IP and distributed to the back-end IP.</span></span>
- <span data-ttu-id="2cbfc-248">**負載平衡器規則** - 將指定的前端 IP 與連接埠組合對應到一組後端 IP 位址與連接埠組合。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-248">**Load balancer rules** - Maps a given front-end IP and port combination to a set of back-end IP addresses and port combination.</span></span> <span data-ttu-id="2cbfc-249">單一負載平衡器可以有多個負載平衡規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-249">A single load balancer can have multiple load balancing rules.</span></span> <span data-ttu-id="2cbfc-250">每個規則都是與 VM 相關聯的前端 IP 和連接埠以及後端 IP 和連接埠的組合。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-250">Each rule is a combination of a front-end IP and port and back-end IP and port associated with VMs.</span></span>
- <span data-ttu-id="2cbfc-251">**[探查](../../load-balancer/load-balancer-custom-probe-overview.md)** - 監視 VM 的健康狀態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-251">**[Probes](../../load-balancer/load-balancer-custom-probe-overview.md)** - Monitors the health of VMs.</span></span> <span data-ttu-id="2cbfc-252">當探查無法回應時，負載平衡器會停止將新的連線傳送至狀況不良的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-252">When a probe fails to respond, the load balancer stops sending new connections to the unhealthy VM.</span></span> <span data-ttu-id="2cbfc-253">現有的連線不會受到影響，而新的連線會傳送到狀況良好的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-253">The existing connections are not affected, and new connections are sent to healthy VMs.</span></span>

<span data-ttu-id="2cbfc-254">下表列出可用於建立網際網路面向負載平衡器的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-254">This table lists the methods that you can use to create an internet-facing load balancer.</span></span>

| <span data-ttu-id="2cbfc-255">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-255">Method</span></span> | <span data-ttu-id="2cbfc-256">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-256">Description</span></span> |
| ------ | ----------- |
| <span data-ttu-id="2cbfc-257">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-257">Azure portal</span></span> | <span data-ttu-id="2cbfc-258">您目前無法使用 Azure 入口網站建立網際網路面向的負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-258">You can't currently create an internet-facing load balancer using the Azure portal.</span></span> |
| [<span data-ttu-id="2cbfc-259">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-259">Azure PowerShell</span></span>](../../load-balancer/load-balancer-get-started-internet-arm-ps.md) | <span data-ttu-id="2cbfc-260">若要提供您先前建立之公用 IP 位址的識別項，請使用 [New-AzureRmLoadBalancerFrontendIpConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerFrontendIpConfig) 搭配 **-PublicIpAddress** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-260">To provide the identifer of the public IP address that you previously created, use [New-AzureRmLoadBalancerFrontendIpConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerFrontendIpConfig) with the **-PublicIpAddress** parameter.</span></span> <span data-ttu-id="2cbfc-261">使用 [New-AzureRmLoadBalancerBackendAddressPoolConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerBackendAddressPoolConfig) 建立後端位址集區的組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-261">Use [New-AzureRmLoadBalancerBackendAddressPoolConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerBackendAddressPoolConfig) to create the configuration of the back-end address pool.</span></span> <span data-ttu-id="2cbfc-262">使用 [New-AzureRmLoadBalancerInboundNatRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerInboundNatRuleConfig) 建立與您所建立之前端 IP 組態相關聯的輸入 NAT 規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-262">Use [New-AzureRmLoadBalancerInboundNatRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerInboundNatRuleConfig) to create inbound NAT rules associated with the front-end IP configuration that you created.</span></span> <span data-ttu-id="2cbfc-263">使用 [New-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerProbeConfig) 建立您所需的探查。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-263">Use [New-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerProbeConfig) to create the probes that you need.</span></span> <span data-ttu-id="2cbfc-264">使用 [New-AzureRmLoadBalancerRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerRuleConfig) 建立負載平衡器組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-264">Use [New-AzureRmLoadBalancerRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerRuleConfig) to create the load balancer configuration.</span></span> <span data-ttu-id="2cbfc-265">使用 [New-AzureRmLoadBalancer](/powershell/module/azurerm.network/new-azurermloadbalancer) 建立負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-265">Use [New-AzureRmLoadBalancer](/powershell/module/azurerm.network/new-azurermloadbalancer) to create the load balancer.</span></span>|
| [<span data-ttu-id="2cbfc-266">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-266">Azure CLI</span></span>](../../load-balancer/load-balancer-get-started-internet-arm-cli.md) | <span data-ttu-id="2cbfc-267">使用 [az network lb create](https://docs.microsoft.com/cli/azure/network/lb#create) 建立初始的負載平衡器組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-267">Use [az network lb create](https://docs.microsoft.com/cli/azure/network/lb#create) to create the initial load balancer configuration.</span></span> <span data-ttu-id="2cbfc-268">使用 [az network lb frontend-ip create](https://docs.microsoft.com/cli/azure/network/lb/frontend-ip#create) 新增您先前建立的公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-268">Use [az network lb frontend-ip create](https://docs.microsoft.com/cli/azure/network/lb/frontend-ip#create) to add the public IP address that you previously created.</span></span> <span data-ttu-id="2cbfc-269">使用 [az network lb address-pool create](https://docs.microsoft.com/cli/azure/network/lb/address-pool#create) 新增後端位址集區的組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-269">Use [az network lb address-pool create](https://docs.microsoft.com/cli/azure/network/lb/address-pool#create) to add the configuration of the back-end address pool.</span></span> <span data-ttu-id="2cbfc-270">使用 [az network lb inbound-nat-rule create](https://docs.microsoft.com/cli/azure/network/lb/inbound-nat-rule#create) 新增 NAT 規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-270">Use [az network lb inbound-nat-rule create](https://docs.microsoft.com/cli/azure/network/lb/inbound-nat-rule#create) to add NAT rules.</span></span> <span data-ttu-id="2cbfc-271">使用 [az network lb rule create](https://docs.microsoft.com/cli/azure/network/lb/rule#create) 新增負載平衡器規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-271">Use [az network lb rule create](https://docs.microsoft.com/cli/azure/network/lb/rule#create) to add the load balancer rules.</span></span> <span data-ttu-id="2cbfc-272">使用 [az network lb probe create](https://docs.microsoft.com/cli/azure/network/lb/probe#create) 新增探查。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-272">Use [az network lb probe create](https://docs.microsoft.com/cli/azure/network/lb/probe#create) to add the probes.</span></span> |
| [<span data-ttu-id="2cbfc-273">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-273">Template</span></span>](../../load-balancer/load-balancer-get-started-internet-arm-template.md) | <span data-ttu-id="2cbfc-274">以[負載平衡器中的 2 部 VM 並在 LB 上設定 NAT 規則](https://github.com/Azure/azure-quickstart-templates/tree/master/201-2-vms-loadbalancer-natrules)做為使用範本部署負載平衡器的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-274">Use [2 VMs in a Load Balancer and configure NAT rules on the LB](https://github.com/Azure/azure-quickstart-templates/tree/master/201-2-vms-loadbalancer-natrules) as a guide for deploying a load balancer using a template.</span></span> |
    
<span data-ttu-id="2cbfc-275">下表列出可用於建立內部負載平衡器的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-275">This table lists the methods that you can use to create an internal load balancer.</span></span>

| <span data-ttu-id="2cbfc-276">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-276">Method</span></span> | <span data-ttu-id="2cbfc-277">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-277">Description</span></span> |
| ------ | ----------- |
| <span data-ttu-id="2cbfc-278">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-278">Azure portal</span></span> | <span data-ttu-id="2cbfc-279">您目前無法使用 Azure 入口網站建立內部負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-279">You can't currently create an internal load balancer using the Azure portal.</span></span> |
| [<span data-ttu-id="2cbfc-280">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-280">Azure PowerShell</span></span>](../../load-balancer/load-balancer-get-started-ilb-arm-ps.md) | <span data-ttu-id="2cbfc-281">若要在網路子網路中提供私人 IP 位址，請使用 [New-AzureRmLoadBalancerFrontendIpConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerFrontendIpConfig) 搭配 **-PrivateIpAddress** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-281">To provide a private IP address in the network subnet, use [New-AzureRmLoadBalancerFrontendIpConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerFrontendIpConfig) with the **-PrivateIpAddress** parameter.</span></span> <span data-ttu-id="2cbfc-282">使用 [New-AzureRmLoadBalancerBackendAddressPoolConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerBackendAddressPoolConfig) 建立後端位址集區的組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-282">Use [New-AzureRmLoadBalancerBackendAddressPoolConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerBackendAddressPoolConfig) to create the configuration of the back-end address pool.</span></span> <span data-ttu-id="2cbfc-283">使用 [New-AzureRmLoadBalancerInboundNatRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerInboundNatRuleConfig) 建立與您所建立之前端 IP 組態相關聯的輸入 NAT 規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-283">Use [New-AzureRmLoadBalancerInboundNatRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerInboundNatRuleConfig) to create inbound NAT rules associated with the front-end IP configuration that you created.</span></span> <span data-ttu-id="2cbfc-284">使用 [New-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerProbeConfig) 建立您所需的探查。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-284">Use [New-AzureRmLoadBalancerProbeConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerProbeConfig) to create the probes that you need.</span></span> <span data-ttu-id="2cbfc-285">使用 [New-AzureRmLoadBalancerRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerRuleConfig) 建立負載平衡器組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-285">Use [New-AzureRmLoadBalancerRuleConfig](https://docs.microsoft.com/powershell/resourcemanager/AzureRM.Network/v1.0.13/New-AzureRmLoadBalancerRuleConfig) to create the load balancer configuration.</span></span> <span data-ttu-id="2cbfc-286">使用 [New-AzureRmLoadBalancer](/powershell/module/azurerm.network/new-azurermloadbalancer) 建立負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-286">Use [New-AzureRmLoadBalancer](/powershell/module/azurerm.network/new-azurermloadbalancer) to create the load balancer.</span></span>|
| [<span data-ttu-id="2cbfc-287">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="2cbfc-287">Azure CLI</span></span>](../../load-balancer/load-balancer-get-started-ilb-arm-cli.md) | <span data-ttu-id="2cbfc-288">使用 [az network lb create](https://docs.microsoft.com/cli/azure/network/lb#create) 命令建立初始的負載平衡器組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-288">Use the [az network lb create](https://docs.microsoft.com/cli/azure/network/lb#create) command to create the initial load balancer configuration.</span></span> <span data-ttu-id="2cbfc-289">若要定義私人 IP 位址，請使用 [az network lb frontend-ip create](https://docs.microsoft.com/cli/azure/network/lb/frontend-ip#create) 搭配 **--private-ip-address** 參數。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-289">To define the private IP address, use [az network lb frontend-ip create](https://docs.microsoft.com/cli/azure/network/lb/frontend-ip#create) with the **--private-ip-address** parameter.</span></span> <span data-ttu-id="2cbfc-290">使用 [az network lb address-pool create](https://docs.microsoft.com/cli/azure/network/lb/address-pool#create) 新增後端位址集區的組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-290">Use [az network lb address-pool create](https://docs.microsoft.com/cli/azure/network/lb/address-pool#create) to add the configuration of the back-end address pool.</span></span> <span data-ttu-id="2cbfc-291">使用 [az network lb inbound-nat-rule create](https://docs.microsoft.com/cli/azure/network/lb/inbound-nat-rule#create) 新增 NAT 規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-291">Use [az network lb inbound-nat-rule create](https://docs.microsoft.com/cli/azure/network/lb/inbound-nat-rule#create) to add NAT rules.</span></span> <span data-ttu-id="2cbfc-292">使用 [az network lb rule create](https://docs.microsoft.com/cli/azure/network/lb/rule#create) 新增負載平衡器規則。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-292">Use [az network lb rule create](https://docs.microsoft.com/cli/azure/network/lb/rule#create) to add the load balancer rules.</span></span> <span data-ttu-id="2cbfc-293">使用 [az network lb probe create](https://docs.microsoft.com/cli/azure/network/lb/probe#create) 新增探查。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-293">Use [az network lb probe create](https://docs.microsoft.com/cli/azure/network/lb/probe#create) to add the probes.</span></span>|
| [<span data-ttu-id="2cbfc-294">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-294">Template</span></span>](../../load-balancer/load-balancer-get-started-ilb-arm-template.md) | <span data-ttu-id="2cbfc-295">以[負載平衡器中的 2 部 VM 並在 LB 上設定 NAT 規則](https://github.com/Azure/azure-quickstart-templates/tree/master/201-2-vms-internal-load-balancer)做為使用範本部署負載平衡器的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-295">Use [2 VMs in a Load Balancer and configure NAT rules on the LB](https://github.com/Azure/azure-quickstart-templates/tree/master/201-2-vms-internal-load-balancer) as a guide for deploying a load balancer using a template.</span></span> |

## <a name="vms"></a><span data-ttu-id="2cbfc-296">VM</span><span class="sxs-lookup"><span data-stu-id="2cbfc-296">VMs</span></span>

<span data-ttu-id="2cbfc-297">您可以在相同的 VNet 中建立 VM，而這些 VM 可以使用私人 IP 位址彼此連接。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-297">VMs can be created in the same VNet and they can connect to each other using private IP addresses.</span></span> <span data-ttu-id="2cbfc-298">即使它們位於不同的子網路中，仍可連接，而不需設定閘道或使用公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-298">They can connect even if they are in different subnets without the need to configure a gateway or use public IP addresses.</span></span> <span data-ttu-id="2cbfc-299">若要將 VM 放入 VNet 中，您可建立 VNet，然後在建立每個 VM 時，將它指派給 VNet 和子網路。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-299">To put VMs into a VNet, you create the VNet and then as you create each VM, you assign it to the VNet and subnet.</span></span> <span data-ttu-id="2cbfc-300">VM 會在部署或啟動期間取得其網路設定。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-300">VMs acquire their network settings during deployment or startup.</span></span>  

<span data-ttu-id="2cbfc-301">VM 會在部署時被指派 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-301">VMs are assigned an IP address when they are deployed.</span></span> <span data-ttu-id="2cbfc-302">如果您將多部 VM 部署至 VNet 或子網路，它們會在啟動時被指派 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-302">If you deploy multiple VMs into a VNet or subnet, they are assigned IP addresses as they boot up.</span></span> <span data-ttu-id="2cbfc-303">動態 IP 位址 (DIP) 是與 VM 相關聯的內部 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-303">A dynamic IP address (DIP) is the internal IP address associated with a VM.</span></span> <span data-ttu-id="2cbfc-304">您可以將靜態 DIP 配置給 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-304">You can allocate a static DIP to a VM.</span></span> <span data-ttu-id="2cbfc-305">如果您要配置靜態 DIP，您應該考慮使用特定的子網路，以避免不小心將靜態 DIP 重複使用於另一部 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-305">If you allocate a static DIP, you should consider using a specific subnet to avoid accidentally reusing a static DIP for another VM.</span></span>  

<span data-ttu-id="2cbfc-306">如果您建立 VM 而稍後想要將它移轉至 VNet，則不太容易進行組態變更。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-306">If you create a VM and later want to migrate it into a VNet, it is not a simple configuration change.</span></span> <span data-ttu-id="2cbfc-307">您必須將 VM 重新部署到 VNet 中。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-307">You must redeploy the VM into the VNet.</span></span> <span data-ttu-id="2cbfc-308">最簡單的重新部署方法就是刪除 VM (但不刪除連接到它的任何磁碟)，然後使用原始磁碟在 VNet 中重新建立 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-308">The easiest way to redeploy is to delete the VM, but not any disks attached to it, and then re-create the VM using the original disks in the VNet.</span></span> 

<span data-ttu-id="2cbfc-309">下表列出可用於在 VNet 中建立 VM 的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-309">This table lists the methods that you can use to create a VM in a VNet.</span></span>

| <span data-ttu-id="2cbfc-310">方法</span><span class="sxs-lookup"><span data-stu-id="2cbfc-310">Method</span></span> | <span data-ttu-id="2cbfc-311">說明</span><span class="sxs-lookup"><span data-stu-id="2cbfc-311">Description</span></span> |
| ------ | ----------- |
| [<span data-ttu-id="2cbfc-312">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="2cbfc-312">Azure portal</span></span>](../virtual-machines-windows-hero-tutorial.md) | <span data-ttu-id="2cbfc-313">使用先前所述的預設網路設定來建立具有單一 NIC 的 VM。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-313">Uses the default network settings that were previously mentioned to create a VM with a single NIC.</span></span> <span data-ttu-id="2cbfc-314">若要建立具有多個 NIC 的 VM，您必須使用不同的方法。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-314">To create a VM with multiple NICs, you must use a different method.</span></span> |
| [<span data-ttu-id="2cbfc-315">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="2cbfc-315">Azure PowerShell</span></span>](../virtual-machines-windows-ps-create.md) | <span data-ttu-id="2cbfc-316">包含使用 [Add-AzureRmVMNetworkInterface](/powershell/module/azurerm.compute/add-azurermvmnetworkinterface) 將先前建立的 NIC 新增至 VM 組態。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-316">Includes the use of [Add-AzureRmVMNetworkInterface](/powershell/module/azurerm.compute/add-azurermvmnetworkinterface) to add the NIC that you previously created to the VM configuration.</span></span> |
| [<span data-ttu-id="2cbfc-317">範本</span><span class="sxs-lookup"><span data-stu-id="2cbfc-317">Template</span></span>](ps-template.md) | <span data-ttu-id="2cbfc-318">使用[非常簡單的 Windows VM 部署](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-simple-windows)做為使用範本部署 VM 的指南。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-318">Use [Very simple deployment of a Windows VM](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-simple-windows) as a guide for deploying a VM using a template.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="2cbfc-319">後續步驟</span><span class="sxs-lookup"><span data-stu-id="2cbfc-319">Next steps</span></span>

- <span data-ttu-id="2cbfc-320">了解如何設定[使用者定義的路由和 IP 轉送](../../virtual-network/virtual-networks-udr-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-320">Learn how to configure [user-defined routes and IP forwarding](../../virtual-network/virtual-networks-udr-overview.md).</span></span> 
- <span data-ttu-id="2cbfc-321">了解如何設定 [VNet 對 VNet 連接](../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-321">Learn how to configure [VNet to VNet connections](../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md).</span></span>
- <span data-ttu-id="2cbfc-322">了解如何[針對路由進行疑難排解](../../virtual-network/virtual-network-routes-troubleshoot-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="2cbfc-322">Learn how to [Troubleshoot routes](../../virtual-network/virtual-network-routes-troubleshoot-portal.md).</span></span>
