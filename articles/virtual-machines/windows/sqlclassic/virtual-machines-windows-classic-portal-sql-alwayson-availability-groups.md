---
title: "aaaConfigure Always On 可用性群組在 Azure 虛擬機器 （傳統） |Microsoft 文件"
description: "使用 Azure 虛擬機器建立 Always On 可用性群組。 本教學課程主要是使用 hello 使用者介面和工具，而非編寫指令碼。"
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 8d48a3d2-79f8-4ab0-9327-2f30ee0b2ff1
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 03/17/2017
ms.author: mikeray
ms.openlocfilehash: f428ad994a55378c281c959f4696fdcaf50632b1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="configure-always-on-availability-group-in-azure-virtual-machines-classic"></a><span data-ttu-id="b8dd9-104">設定 Azure 虛擬機器中的 Always On 可用性群組 (傳統)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-104">Configure Always On availability group in Azure Virtual Machines (classic)</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="b8dd9-105">傳統：UI</span><span class="sxs-lookup"><span data-stu-id="b8dd9-105">Classic: UI</span></span>](../classic/portal-sql-alwayson-availability-groups.md)
> * <span data-ttu-id="b8dd9-106">[傳統：PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span><span class="sxs-lookup"><span data-stu-id="b8dd9-106">[Classic: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span></span><br/>

<span data-ttu-id="b8dd9-107">請在開始之前仔細思考一下，您現在已經可以在 Azure Resource Manager 模型中完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-107">Before you begin, consider that you can now complete this task in Azure Resource Manager model.</span></span> <span data-ttu-id="b8dd9-108">我們建議新的部署採用 Azure Resource Manager 模型。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-108">We recommend Azure Resource Manager model for new deployments.</span></span> <span data-ttu-id="b8dd9-109">請參閱 [Azure 虛擬機器上的 SQL Server Always On 可用性群組](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-109">See [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="b8dd9-110">Microsoft 建議最新的部署使用 hello 資源管理員的模型。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-110">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="b8dd9-111">Azure 有兩個不同的部署模型 toocreate 和資源的使用：[資源管理員] 和 [傳統](../../../azure-resource-manager/resource-manager-deployment-model.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-111">Azure has two different deployment models toocreate and work with resources: [Resource Manager and classic](../../../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="b8dd9-112">本文說明如何 toouse hello 傳統部署模型。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-112">This article explains how toouse hello classic deployment model.</span></span> 

<span data-ttu-id="b8dd9-113">toocomplete 這項工作使用 hello Azure Resource Manager 模型時，請參閱[SQL Server Always On 可用性群組在 Azure 虛擬機器上的](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-113">toocomplete this task with hello Azure Resource Manager model, see [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

<span data-ttu-id="b8dd9-114">此端對端教學課程會示範 tooimplement 可用性群組使用 SQL Server Always On Azure 虛擬機器上執行的方式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-114">This end-to-end tutorial shows you how tooimplement availability groups by using SQL Server Always On running on Azure Virtual Machines.</span></span>

<span data-ttu-id="b8dd9-115">結尾 hello hello 教學課程中，在 Azure 中的 SQL Server Alwayson 方案將會包含下列項目 hello:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-115">At hello end of hello tutorial, your SQL Server Always On solution in Azure will consist of hello following elements:</span></span>

* <span data-ttu-id="b8dd9-116">包含多個子網路並包括前端和後端子網路的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-116">A virtual network that contains multiple subnets and includes a frontend and a backend subnet</span></span>
* <span data-ttu-id="b8dd9-117">具有 Active Directory (Azure AD) 網域的網域控制站</span><span class="sxs-lookup"><span data-stu-id="b8dd9-117">A domain controller with an Active Directory (Azure AD) domain</span></span>
* <span data-ttu-id="b8dd9-118">執行 SQL Server，而且已部署的 toohello 後端子網路和網域聯結的 toohello Azure AD 的兩部虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-118">Two virtual machines that run SQL Server and are deployed toohello backend subnet and joined toohello Azure AD domain</span></span>
* <span data-ttu-id="b8dd9-119">Hello 節點多數 仲裁模型具有三個節點的容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="b8dd9-119">A three-node failover cluster with hello Node Majority quorum model</span></span>
* <span data-ttu-id="b8dd9-120">具有兩份可用性資料庫同步認可複本的可用性群組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-120">An availability group that has two synchronous-commit replicas of an availability database</span></span>

<span data-ttu-id="b8dd9-121">下列圖例 hello 是 hello 方案的圖形表示法。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-121">hello following illustration is a graphical representation of hello solution.</span></span>

![Azure 中可用性群組的測試實驗室架構](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC791912.png)

<span data-ttu-id="b8dd9-123">請注意以下這是一個可用的組態。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-123">Note that this is one possible configuration.</span></span> <span data-ttu-id="b8dd9-124">例如，您可以減少 hello 對於兩個複本的可用性群組的虛擬機器數目。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-124">For example, you can minimize hello number of virtual machines for a two-replica availability group.</span></span> <span data-ttu-id="b8dd9-125">此組態為 hello 仲裁檔案共用見證雙節點叢集中使用 hello 網域控制站會將儲存在 Azure 中的計算時數。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-125">This configuration saves on compute hours in Azure by using hello domain controller as hello quorum file share witness in a two-node cluster.</span></span> <span data-ttu-id="b8dd9-126">這個方法可以減少一個從 hello 所述設定 hello 虛擬機器計數。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-126">This method reduces hello virtual machine count by one from hello illustrated configuration.</span></span>

<span data-ttu-id="b8dd9-127">本教學課程假設 hello 下列：</span><span class="sxs-lookup"><span data-stu-id="b8dd9-127">This tutorial assumes hello following:</span></span>

* <span data-ttu-id="b8dd9-128">您已經有 Azure 帳戶。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-128">You already have an Azure account.</span></span>
* <span data-ttu-id="b8dd9-129">您已經知道如何 toouse hello GUI hello 虛擬機器資源庫 tooprovision 中傳統的虛擬機器以執行 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-129">You already know how toouse hello GUI in hello virtual machine gallery tooprovision a classic virtual machine that runs SQL Server.</span></span>
* <span data-ttu-id="b8dd9-130">您已非常熟悉 Always On 可用性群組的功能。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-130">You already have a solid understanding of Always On availability groups.</span></span> <span data-ttu-id="b8dd9-131">如需詳細資訊，請參閱 [Always On 可用性群組 (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-131">For more information, see [Always On Availability Groups (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="b8dd9-132">如想將 Always On 可用性群組與 SharePoint 搭配使用，另請參閱[為 SharePoint 2013 設定 SQL Server 2012 Always On 可用性群組](https://technet.microsoft.com/library/jj715261.aspx)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-132">If you are interested in using Always On availability groups with SharePoint, also see [Configure SQL Server 2012 Always On Availability Groups for SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span></span>
> 
> 

## <a name="create-hello-virtual-network-and-domain-controller-server"></a><span data-ttu-id="b8dd9-133">建立 hello 虛擬網路和網域控制站伺服器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-133">Create hello virtual network and domain controller server</span></span>
<span data-ttu-id="b8dd9-134">一開始先建立新的 Azure 試用帳戶。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-134">You begin with a new Azure trial account.</span></span> <span data-ttu-id="b8dd9-135">設定您的帳戶之後，您應該 hello hello Azure 傳統入口網站的首頁 螢幕上。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-135">After you set up your account, you should be on hello home screen of hello Azure classic portal.</span></span>

1. <span data-ttu-id="b8dd9-136">按一下 hello**新增**hello 左上角的 hello 頁面上，如下列螢幕擷取畫面的 hello 中所示的 hello 底部的按鈕。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-136">Click hello **New** button at hello left corner of hello bottom of hello page, as shown in hello following screenshot.</span></span>
   
    ![Hello 入口網站中，按一下 [新增]](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665511.gif)
2. <span data-ttu-id="b8dd9-138">按一下**網路服務** > **虛擬網路** > **自訂建立**hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-138">Click **Network Services** > **Virtual Network** > **Custom Create**, as shown in hello following screenshot.</span></span>
   
    ![建立虛擬網路](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665512.gif)
3. <span data-ttu-id="b8dd9-140">在 hello**建立虛擬網路**對話方塊方塊中，逐步執行 hello 頁面，並使用 hello 下表中的 hello 設定建立新的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-140">In hello **CREATE A VIRTUAL NETWORK** dialog box, create a new virtual network by stepping through hello pages and using hello settings in hello following table.</span></span> 
   
   | <span data-ttu-id="b8dd9-141">Page</span><span class="sxs-lookup"><span data-stu-id="b8dd9-141">Page</span></span> | <span data-ttu-id="b8dd9-142">設定</span><span class="sxs-lookup"><span data-stu-id="b8dd9-142">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="b8dd9-143">虛擬網路詳細資料</span><span class="sxs-lookup"><span data-stu-id="b8dd9-143">Virtual Network Details</span></span> |<span data-ttu-id="b8dd9-144">**名稱 = ContosoNET**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-144">**NAME = ContosoNET**</span></span><br/><span data-ttu-id="b8dd9-145">**地區 = 美國西部**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-145">**REGION = West US**</span></span> |
   | <span data-ttu-id="b8dd9-146">DNS 伺服器和 VPN 連線能力</span><span class="sxs-lookup"><span data-stu-id="b8dd9-146">DNS Servers and VPN Connectivity</span></span> |<span data-ttu-id="b8dd9-147">None</span><span class="sxs-lookup"><span data-stu-id="b8dd9-147">None</span></span> |
   | <span data-ttu-id="b8dd9-148">虛擬網路位址空間</span><span class="sxs-lookup"><span data-stu-id="b8dd9-148">Virtual Network Address Spaces</span></span> |<span data-ttu-id="b8dd9-149">設定以 hello 下列螢幕擷取畫面所示：</span><span class="sxs-lookup"><span data-stu-id="b8dd9-149">Settings are shown in hello following screenshot:</span></span> ![建立虛擬網路](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784620.png) |
4. <span data-ttu-id="b8dd9-151">建立 hello 做 hello 網域控制站 (DC)，您將使用的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-151">Create hello virtual machine that you will use as hello domain controller (DC).</span></span> <span data-ttu-id="b8dd9-152">按一下**新增** > **計算** > **虛擬機器** > **從組件庫**，如下所示下列螢幕擷取畫面的 hello。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-152">Click **New** > **Compute** > **Virtual Machine** > **From Gallery**, as shown in hello following screenshot.</span></span>
   
    ![建立虛擬機器](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784621.png)
5. <span data-ttu-id="b8dd9-154">在 hello**建立虛擬機器**對話方塊方塊中，逐步執行 hello 頁面，以及使用 hello 下表中的 hello 設定來設定新的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-154">In hello **CREATE A VIRTUAL MACHINE** dialog box, configure a new virtual machine by stepping through hello pages and using hello settings in hello following table.</span></span> 
   
   | <span data-ttu-id="b8dd9-155">Page</span><span class="sxs-lookup"><span data-stu-id="b8dd9-155">Page</span></span> | <span data-ttu-id="b8dd9-156">設定</span><span class="sxs-lookup"><span data-stu-id="b8dd9-156">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="b8dd9-157">虛擬機器作業系統選取 hello</span><span class="sxs-lookup"><span data-stu-id="b8dd9-157">Select hello virtual machine operating system</span></span> |<span data-ttu-id="b8dd9-158">Windows Server 2012 R2 Datacenter</span><span class="sxs-lookup"><span data-stu-id="b8dd9-158">Windows Server 2012 R2 Datacenter</span></span> |
   | <span data-ttu-id="b8dd9-159">虛擬機器組態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-159">Virtual machine configuration</span></span> |<span data-ttu-id="b8dd9-160">**版本發行日期** = (最新版本)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-160">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="b8dd9-161">**虛擬機器名稱** = ContosoDC</span><span class="sxs-lookup"><span data-stu-id="b8dd9-161">**VIRTUAL MACHINE NAME** = ContosoDC</span></span><br/><span data-ttu-id="b8dd9-162">**層** = 標準</span><span class="sxs-lookup"><span data-stu-id="b8dd9-162">**TIER** = STANDARD</span></span><br/><span data-ttu-id="b8dd9-163">**大小** = A2 (2 核心)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-163">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="b8dd9-164">**新使用者名稱** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="b8dd9-164">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="b8dd9-165">**新密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-165">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="b8dd9-166">**確認** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-166">**CONFIRM** = Contoso!000</span></span> |
   | <span data-ttu-id="b8dd9-167">虛擬機器組態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-167">Virtual machine configuration</span></span> |<span data-ttu-id="b8dd9-168">**雲端服務** = 建立新的雲端服務</span><span class="sxs-lookup"><span data-stu-id="b8dd9-168">**CLOUD SERVICE** = Create a new cloud service</span></span><br/><span data-ttu-id="b8dd9-169">**雲端服務 DNS 名稱** = 唯一的雲端服務名稱</span><span class="sxs-lookup"><span data-stu-id="b8dd9-169">**CLOUD SERVICE DNS NAME** = A unique cloud service name</span></span><br/><span data-ttu-id="b8dd9-170">**DNS 名稱** = 唯一的名稱 (例如：ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-170">**DNS NAME** = A unique name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="b8dd9-171">**區域/同質群組/虛擬網路** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="b8dd9-171">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="b8dd9-172">**虛擬網路子網路** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-172">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="b8dd9-173">**儲存體帳戶** = 使用自動產生的儲存體帳戶</span><span class="sxs-lookup"><span data-stu-id="b8dd9-173">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="b8dd9-174">**可用性設定組** = (無)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-174">**AVAILABILITY SET** = (None)</span></span> |
   | <span data-ttu-id="b8dd9-175">虛擬機器選項</span><span class="sxs-lookup"><span data-stu-id="b8dd9-175">Virtual machine options</span></span> |<span data-ttu-id="b8dd9-176">使用預設值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-176">Use defaults</span></span> |

<span data-ttu-id="b8dd9-177">設定 hello 新的虛擬機器之後，等候 hello 虛擬機器 toobe 完畢。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-177">After you configure hello new virtual machine, wait for hello virtual machine toobe provsioned.</span></span> <span data-ttu-id="b8dd9-178">這個程序需要一些時間 toofinish。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-178">This process takes some time toofinish.</span></span> <span data-ttu-id="b8dd9-179">如果您按一下 hello**虛擬機器** 索引標籤中 hello Azure 傳統入口網站中，您可以看到 ContosoDC 循環的狀態從**啟動 （正在佈建）**太**已停止**， **啟動**，**執行 （正在佈建）**，最後再**執行**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-179">If you click hello **Virtual Machine** tab in hello Azure classic portal, you can see ContosoDC cycling states from **Starting (Provisioning)** too**Stopped**, **Starting**, **Running (Provisioning)**, and finally **Running**.</span></span>

<span data-ttu-id="b8dd9-180">現在已成功佈建 hello DC 伺服器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-180">hello DC server is now successfully provisioned.</span></span> <span data-ttu-id="b8dd9-181">接下來，您將在此 DC 伺服器上設定 hello Active Directory 網域。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-181">Next, you will configure hello Active Directory domain on this DC server.</span></span>

## <a name="configure-hello-domain-controller"></a><span data-ttu-id="b8dd9-182">設定 hello 網域控制站</span><span class="sxs-lookup"><span data-stu-id="b8dd9-182">Configure hello domain controller</span></span>
<span data-ttu-id="b8dd9-183">在 hello 下列步驟，您必須 hello ContosoDC 機器設定為 corp.contoso.com 的網域控制站中。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-183">In hello following steps, you configure hello ContosoDC machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="b8dd9-184">在 hello 入口網站中，選取 hello **ContosoDC**機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-184">In hello portal, select hello **ContosoDC** machine.</span></span> <span data-ttu-id="b8dd9-185">在 hello**儀表板**索引標籤上，按一下 **連接**tooopen 遠端桌面存取的遠端桌面 (RDP) 檔案。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-185">On hello **Dashboard** tab, click **Connect** tooopen a remote desktop (RDP) file for remote desktop access.</span></span>
   
    ![連接 tooVritual 機器](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784622.png)
2. <span data-ttu-id="b8dd9-187">以所設定的系統管理員帳戶 (**\AzureAdmin**) 和密碼 (**Contoso!000**) 登入。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-187">Sign in with your configured administrator account (**\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="b8dd9-188">根據預設，hello**伺服器管理員**應該顯示儀表板。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-188">By default, hello **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="b8dd9-189">按一下 hello**新增角色及功能**hello 儀表板上的連結。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-189">Click hello **Add roles and features** link on hello dashboard.</span></span>
   
    ![透過 [伺服器總管] 新增角色](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784623.png)
5. <span data-ttu-id="b8dd9-191">按一下**下一步**直到 toohello**伺服器角色**> 一節。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-191">Click **Next** until you get toohello **Server Roles** section.</span></span>
6. <span data-ttu-id="b8dd9-192">選取 hello **Active Directory 網域服務**和**DNS 伺服器**角色。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-192">Select hello **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="b8dd9-193">出現提示時，新增這些角色需要的更多功能。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-193">When prompted, add more features that these roles require.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="b8dd9-194">螢幕會顯示無靜態 IP 位址的驗證警告。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-194">You will get a validation warning that there is no static IP address.</span></span> <span data-ttu-id="b8dd9-195">如果您要測試 hello 組態，按一下**繼續**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-195">If you are testing hello configuration, click **Continue**.</span></span> <span data-ttu-id="b8dd9-196">生產案例[使用 PowerShell tooset hello 靜態 IP 位址的 hello 網域控制站機器](../../../virtual-network/virtual-networks-reserved-private-ip.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-196">For production scenarios [use PowerShell tooset hello static IP address of hello domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   > 
   > 
   
    ![新增角色對話方塊](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784624.png)
7. <span data-ttu-id="b8dd9-198">按一下**下一步**直到您到達 hello**確認**> 一節。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-198">Click **Next** until you reach hello **Confirmation** section.</span></span> <span data-ttu-id="b8dd9-199">選取 hello**必要時自動重新啟動 hello 目的地伺服器**核取方塊。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-199">Select hello **Restart hello destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="b8dd9-200">按一下 [Install] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-200">Click **Install**.</span></span>
9. <span data-ttu-id="b8dd9-201">Hello 功能的安裝之後，傳回 toohello**伺服器管理員**儀表板。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-201">After hello features are installed, return toohello **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="b8dd9-202">選取新的 hello **AD DS** hello 左窗格上的選項。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-202">Select hello new **AD DS** option on hello left pane.</span></span>
11. <span data-ttu-id="b8dd9-203">按一下 hello**詳細**hello 黃色警告列上的連結。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-203">Click hello **More** link on hello yellow warning bar.</span></span>
    
     ![DNS 伺服器虛擬機器上的 AS DS 對話方塊](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784625.png)
12. <span data-ttu-id="b8dd9-205">在 hello**動作**hello 的資料行**所有伺服器工作詳細資料**對話方塊中，按一下**升級此伺服器 tooa 網域控制站**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-205">In hello **Action** column of hello **All Server Task Details** dialog box, click **Promote this server tooa domain controller**.</span></span>
13. <span data-ttu-id="b8dd9-206">在 hello **Active Directory 網域服務設定精靈**，使用下列值的 hello:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-206">In hello **Active Directory Domain Services Configuration Wizard**, use hello following values:</span></span>
    
    | <span data-ttu-id="b8dd9-207">Page</span><span class="sxs-lookup"><span data-stu-id="b8dd9-207">Page</span></span> | <span data-ttu-id="b8dd9-208">設定</span><span class="sxs-lookup"><span data-stu-id="b8dd9-208">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="b8dd9-209">部署組態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-209">Deployment Configuration</span></span> |<span data-ttu-id="b8dd9-210">**新增樹系** = 已選取</span><span class="sxs-lookup"><span data-stu-id="b8dd9-210">**Add a new forest** = Selected</span></span><br/><span data-ttu-id="b8dd9-211">**根網域名稱** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="b8dd9-211">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="b8dd9-212">網域控制站選項</span><span class="sxs-lookup"><span data-stu-id="b8dd9-212">Domain Controller Options</span></span> |<span data-ttu-id="b8dd9-213">**密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-213">**Password** = Contoso!000</span></span><br/><span data-ttu-id="b8dd9-214">**確認密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-214">**Confirm Password** = Contoso!000</span></span> |
14. <span data-ttu-id="b8dd9-215">按一下**下一步**透過 toogo hello hello 精靈中的其他頁面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-215">Click **Next** toogo through hello other pages in hello wizard.</span></span> <span data-ttu-id="b8dd9-216">在 hello**必要條件檢查**頁面上，確認您看到下列訊息的 hello:**順利通過所有先決條件檢查**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-216">On hello **Prerequisites Check** page, verify that you see hello following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="b8dd9-217">請注意，您應該檢閱所有適用的警告訊息，但是它可能 toocontinue hello 安裝。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-217">Note that you should review all applicable warning messages, but it is possible toocontinue with hello installation.</span></span>
15. <span data-ttu-id="b8dd9-218">按一下 [Install] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-218">Click **Install**.</span></span> <span data-ttu-id="b8dd9-219">hello **ContosoDC**虛擬機器會自動重新開機。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-219">hello **ContosoDC** virtual machine will automatically reboot.</span></span>

## <a name="configure-domain-accounts"></a><span data-ttu-id="b8dd9-220">設定網域帳戶</span><span class="sxs-lookup"><span data-stu-id="b8dd9-220">Configure domain accounts</span></span>
<span data-ttu-id="b8dd9-221">hello 接下來的步驟設定 hello Active Directory 帳戶，供日後使用。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-221">hello next steps configure hello Active Directory accounts for later use.</span></span>

1. <span data-ttu-id="b8dd9-222">重新登入 toohello **ContosoDC**機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-222">Sign back in toohello **ContosoDC** machine.</span></span>
2. <span data-ttu-id="b8dd9-223">在 [伺服器管理員]  中，按一下 [工具]  >  [Active Directory 管理中心] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-223">In **Server Manager**, click **Tools** > **Active Directory Administrative Center**.</span></span>
   
    ![Active Directory 管理中心](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784626.png)
3. <span data-ttu-id="b8dd9-225">在 hello **Active Directory 管理中心**，選取**corp （本機）** hello 左窗格中。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-225">In hello **Active Directory Administrative Center**, select **corp (local)** in hello left pane.</span></span>
4. <span data-ttu-id="b8dd9-226">在右邊的 hello**工作**] 窗格中，按一下 [**新增** > **使用者**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-226">On hello right **Tasks** pane, click **New** > **User**.</span></span> <span data-ttu-id="b8dd9-227">使用下列設定的 hello:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-227">Use hello following settings:</span></span>
   
   | <span data-ttu-id="b8dd9-228">設定</span><span class="sxs-lookup"><span data-stu-id="b8dd9-228">Setting</span></span> | <span data-ttu-id="b8dd9-229">值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-229">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="b8dd9-230">**名字**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-230">**First Name**</span></span> |<span data-ttu-id="b8dd9-231">Install</span><span class="sxs-lookup"><span data-stu-id="b8dd9-231">Install</span></span> |
   | <span data-ttu-id="b8dd9-232">**使用者 SamAccountName**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-232">**User SamAccountName**</span></span> |<span data-ttu-id="b8dd9-233">Install</span><span class="sxs-lookup"><span data-stu-id="b8dd9-233">Install</span></span> |
   | <span data-ttu-id="b8dd9-234">**密碼**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-234">**Password**</span></span> |<span data-ttu-id="b8dd9-235">Contoso! 000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-235">Contoso!000</span></span> |
   | <span data-ttu-id="b8dd9-236">**確認密碼**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-236">**Confirm password**</span></span> |<span data-ttu-id="b8dd9-237">Contoso! 000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-237">Contoso!000</span></span> |
   | <span data-ttu-id="b8dd9-238">**其他密碼選項**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-238">**Other password options**</span></span> |<span data-ttu-id="b8dd9-239">已選取</span><span class="sxs-lookup"><span data-stu-id="b8dd9-239">Selected</span></span> |
   | <span data-ttu-id="b8dd9-240">**密碼永久有效**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-240">**Password never expires**</span></span> |<span data-ttu-id="b8dd9-241">已檢查</span><span class="sxs-lookup"><span data-stu-id="b8dd9-241">Checked</span></span> |
5. <span data-ttu-id="b8dd9-242">按一下**確定**toocreate hello**安裝**使用者。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-242">Click **OK** toocreate hello **Install** user.</span></span> <span data-ttu-id="b8dd9-243">此帳戶將會使用的 tooconfigure hello 容錯移轉叢集和 hello 可用性群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-243">This account will be used tooconfigure hello failover cluster and hello availability group.</span></span>
6. <span data-ttu-id="b8dd9-244">建立兩個額外的使用者， **CORP\SQLSvc1**和**CORP\SQLSvc2**，hello 與相同的步驟。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-244">Create two additional users, **CORP\SQLSvc1** and **CORP\SQLSvc2**, with hello same steps.</span></span> <span data-ttu-id="b8dd9-245">這些帳戶將用於 hello SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-245">These accounts will be used for hello SQL Server instances.</span></span> <span data-ttu-id="b8dd9-246">接下來，您必須 toogive **CORP\Install** hello 必要的權限 tooconfigure Windows 容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-246">Next, you need toogive **CORP\Install** hello necessary permissions tooconfigure Windows failover clustering.</span></span>
7. <span data-ttu-id="b8dd9-247">在 hello **Active Directory 管理中心**，按一下  **corp （本機）** hello 左窗格中。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-247">In hello **Active Directory Administrative Center**, click **corp (local)** in hello left pane.</span></span> <span data-ttu-id="b8dd9-248">在 hello**工作** 窗格中，按一下 **屬性**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-248">In hello **Tasks** pane, click **Properties**.</span></span>
   
    ![公司使用者內容](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784627.png)
8. <span data-ttu-id="b8dd9-250">選取**延伸**，然後按一下hello**進階**按鈕 hello**安全性** 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-250">Select **Extensions**, and then click hello **Advanced** button on hello **Security** tab.</span></span>
9. <span data-ttu-id="b8dd9-251">在 hello **corp 的進階安全性設定**對話方塊中，按一下 **新增**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-251">In hello **Advanced Security Settings for corp** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="b8dd9-252">按一下 選取主體、搜尋 **CORP\Install**，然後按一下確定。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-252">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
11. <span data-ttu-id="b8dd9-253">選取 hello**讀取全部內容**和**建立電腦物件**權限。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-253">Select hello **Read all properties** and **Create Computer objects** permissions.</span></span>
    
     ![公司使用者權限](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784628.png)
12. <span data-ttu-id="b8dd9-255">按一下 [確定]，再按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-255">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="b8dd9-256">關閉 hello corp 屬性 視窗。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-256">Close hello corp properties window.</span></span>

<span data-ttu-id="b8dd9-257">現在，您可以設定 Active Directory 與 hello 使用者物件，您將建立三個 SQL Server 虛擬機器，並將它們 toothis 網域。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-257">Now that you configured Active Directory and hello user objects, you will create three SQL Server virtual machines and join them toothis domain.</span></span>

## <a name="create-hello-sql-server-virtual-machines"></a><span data-ttu-id="b8dd9-258">SQL Server 虛擬機器建立 hello</span><span class="sxs-lookup"><span data-stu-id="b8dd9-258">Create hello SQL Server virtual machines</span></span>
<span data-ttu-id="b8dd9-259">建立三個虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-259">Create three virtual machines.</span></span> <span data-ttu-id="b8dd9-260">一個節點用於叢集節點，兩個節點用於 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-260">One is for a cluster node and two are for SQL Server.</span></span> <span data-ttu-id="b8dd9-261">toocreate 每個 hello 的虛擬機器移回 toohello Azure 傳統入口網站中，按一下**新增** > **計算** > **虛擬機器** > **從組件庫**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-261">toocreate each of hello virtual machines, go back toohello Azure classic portal, click **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span> <span data-ttu-id="b8dd9-262">然後，使用下列資料表 toohelp 建立 hello 虛擬機器的 hello hello 樣板。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-262">Then, use hello templates in hello following table toohelp you create hello virtual machines.</span></span>

| <span data-ttu-id="b8dd9-263">Page</span><span class="sxs-lookup"><span data-stu-id="b8dd9-263">Page</span></span> | <span data-ttu-id="b8dd9-264">VM1</span><span class="sxs-lookup"><span data-stu-id="b8dd9-264">VM1</span></span> | <span data-ttu-id="b8dd9-265">VM2</span><span class="sxs-lookup"><span data-stu-id="b8dd9-265">VM2</span></span> | <span data-ttu-id="b8dd9-266">VM3</span><span class="sxs-lookup"><span data-stu-id="b8dd9-266">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="b8dd9-267">虛擬機器作業系統選取 hello</span><span class="sxs-lookup"><span data-stu-id="b8dd9-267">Select hello virtual machine operating system</span></span> |<span data-ttu-id="b8dd9-268">**Windows Server 2012 R2 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-268">**Windows Server 2012 R2 Datacenter**</span></span> |<span data-ttu-id="b8dd9-269">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-269">**SQL Server 2014 RTM Enterprise**</span></span> |<span data-ttu-id="b8dd9-270">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-270">**SQL Server 2014 RTM Enterprise**</span></span> |
| <span data-ttu-id="b8dd9-271">虛擬機器組態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-271">Virtual machine configuration</span></span> |<span data-ttu-id="b8dd9-272">**版本發行日期** = (最新版本)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-272">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="b8dd9-273">**虛擬機器名稱** = ContosoWSFCNode</span><span class="sxs-lookup"><span data-stu-id="b8dd9-273">**VIRTUAL MACHINE NAME** = ContosoWSFCNode</span></span><br/><span data-ttu-id="b8dd9-274">**層** = 標準</span><span class="sxs-lookup"><span data-stu-id="b8dd9-274">**TIER** = STANDARD</span></span><br/><span data-ttu-id="b8dd9-275">**大小** = A2 (2 核心)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-275">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="b8dd9-276">**新使用者名稱** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="b8dd9-276">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="b8dd9-277">**新密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-277">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="b8dd9-278">**確認** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-278">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="b8dd9-279">**版本發行日期** = (最新版本)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-279">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="b8dd9-280">**虛擬機器名稱** = ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="b8dd9-280">**VIRTUAL MACHINE NAME** = ContosoSQL1</span></span><br/><span data-ttu-id="b8dd9-281">**層** = 標準</span><span class="sxs-lookup"><span data-stu-id="b8dd9-281">**TIER** = STANDARD</span></span><br/><span data-ttu-id="b8dd9-282">**大小** = A3 (4 核心)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-282">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="b8dd9-283">**新使用者名稱** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="b8dd9-283">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="b8dd9-284">**新密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-284">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="b8dd9-285">**確認** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-285">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="b8dd9-286">**版本發行日期** = (最新版本)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-286">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="b8dd9-287">**虛擬機器名稱** = ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="b8dd9-287">**VIRTUAL MACHINE NAME** = ContosoSQL2</span></span><br/><span data-ttu-id="b8dd9-288">**層** = 標準</span><span class="sxs-lookup"><span data-stu-id="b8dd9-288">**TIER** = STANDARD</span></span><br/><span data-ttu-id="b8dd9-289">**大小** = A3 (4 核心)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-289">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="b8dd9-290">**新使用者名稱** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="b8dd9-290">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="b8dd9-291">**新密碼** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-291">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="b8dd9-292">**確認** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="b8dd9-292">**CONFIRM** = Contoso!000</span></span> |
| <span data-ttu-id="b8dd9-293">虛擬機器組態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-293">Virtual machine configuration</span></span> |<span data-ttu-id="b8dd9-294">**雲端服務** = 先前建立的唯一雲端服務 DNS 名稱 (例如︰ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-294">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="b8dd9-295">**區域/同質群組/虛擬網路** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="b8dd9-295">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="b8dd9-296">**虛擬網路子網路** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-296">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="b8dd9-297">**儲存體帳戶** = 使用自動產生的儲存體帳戶</span><span class="sxs-lookup"><span data-stu-id="b8dd9-297">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="b8dd9-298">**可用性設定組** = 建立可用性設定組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-298">**AVAILABILITY SET** = Create an availability set</span></span><br/><span data-ttu-id="b8dd9-299">**可用性設定組名稱** = SQLHADR</span><span class="sxs-lookup"><span data-stu-id="b8dd9-299">**AVAILABILITY SET NAME** = SQLHADR</span></span> |<span data-ttu-id="b8dd9-300">**雲端服務** = 先前建立的唯一雲端服務 DNS 名稱 (例如︰ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-300">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="b8dd9-301">**區域/同質群組/虛擬網路** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="b8dd9-301">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="b8dd9-302">**虛擬網路子網路** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-302">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="b8dd9-303">**儲存體帳戶** = 使用自動產生的儲存體帳戶</span><span class="sxs-lookup"><span data-stu-id="b8dd9-303">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="b8dd9-304">**可用性設定組**= 的 SQLHADR （您也可以設定 hello 可用性設定組 hello 機器建立之後。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-304">**AVAILABILITY SET** = SQLHADR (You can also configure hello availability set after hello machine has been created.</span></span> <span data-ttu-id="b8dd9-305">所有的三部機器都應該指派 toohello SQLHADR 可用性設定組。）</span><span class="sxs-lookup"><span data-stu-id="b8dd9-305">All three machines should be assigned toohello SQLHADR availability set.)</span></span> |<span data-ttu-id="b8dd9-306">**雲端服務** = 先前建立的唯一雲端服務 DNS 名稱 (例如︰ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-306">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="b8dd9-307">**區域/同質群組/虛擬網路** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="b8dd9-307">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="b8dd9-308">**虛擬網路子網路** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="b8dd9-308">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="b8dd9-309">**儲存體帳戶** = 使用自動產生的儲存體帳戶</span><span class="sxs-lookup"><span data-stu-id="b8dd9-309">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="b8dd9-310">**可用性設定組**= 的 SQLHADR （您也可以設定 hello 可用性設定組 hello 機器建立之後。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-310">**AVAILABILITY SET** = SQLHADR (You can also configure hello availability set after hello machine has been created.</span></span> <span data-ttu-id="b8dd9-311">所有的三部機器都應該指派 toohello SQLHADR 可用性設定組。）</span><span class="sxs-lookup"><span data-stu-id="b8dd9-311">All three machines should be assigned toohello SQLHADR availability set.)</span></span> |
| <span data-ttu-id="b8dd9-312">虛擬機器選項</span><span class="sxs-lookup"><span data-stu-id="b8dd9-312">Virtual machine options</span></span> |<span data-ttu-id="b8dd9-313">使用預設值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-313">Use defaults</span></span> |<span data-ttu-id="b8dd9-314">使用預設值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-314">Use defaults</span></span> |<span data-ttu-id="b8dd9-315">使用預設值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-315">Use defaults</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="b8dd9-316">hello 先前的設定建議標準層的虛擬機器，因為基本層機器不支援負載平衡的端點。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-316">hello previous configuration suggests STANDARD tier virtual machines, because BASIC tier machines do not support load-balanced endpoints.</span></span> <span data-ttu-id="b8dd9-317">需要負載平衡的端點稍後 toocreate 可用性群組接聽程式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-317">You need load-balanced endpoints later toocreate an availability group listener.</span></span> <span data-ttu-id="b8dd9-318">此外，我們建議的 hello 機器大小是為了測試可用性群組在 Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-318">Also, hello machine sizes that are suggested here are meant for testing availability groups in Azure Virtual Machines.</span></span> <span data-ttu-id="b8dd9-319">Hello 實際執行工作負載的最佳效能，請參閱 SQL Server 機器大小和組態中的 hello 建議[Azure 虛擬機器中 SQL Server 的效能最佳做法](../sql/virtual-machines-windows-sql-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-319">For hello best performance on production workloads, see hello recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure Virtual Machines](../sql/virtual-machines-windows-sql-performance.md).</span></span>
> 
> 

<span data-ttu-id="b8dd9-320">Hello 三個虛擬機器完整佈建之後，您需要 toojoin 它們 toohello **corp.contoso.com**網域和授與 CORP\Install 管理權限 toohello 機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-320">After hello three virtual machines are fully provisioned, you need toojoin them toohello **corp.contoso.com** domain and grant CORP\Install administrative rights toohello machines.</span></span> <span data-ttu-id="b8dd9-321">toodo hello 三個虛擬機器的每一個遵循步驟，使用 hello。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-321">toodo this, use hello following steps for each of hello three virtual machines.</span></span>

1. <span data-ttu-id="b8dd9-322">首先，變更 hello 慣用 DNS 伺服器位址。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-322">First, change hello preferred DNS server address.</span></span> <span data-ttu-id="b8dd9-323">下載每個虛擬機器的 RDP 檔案 tooyour 本機目錄 hello 清單中選取 hello 虛擬機器，然後按一下 hello**連接** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-323">Download each virtual machine's RDP file tooyour local directory by selecting hello virtual machine in hello list and clicking hello **Connect** button.</span></span> <span data-ttu-id="b8dd9-324">tooselect 虛擬機器，但 hello 第一個資料格在 hello 列中，按一下任何位置，hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-324">tooselect a virtual machine, click anywhere but hello first cell in hello row, as shown in hello following screenshot.</span></span>
   
    ![下載 hello RDP 檔案](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664953.jpg)
2. <span data-ttu-id="b8dd9-326">開啟 hello RDP 檔，您已下載，與使用設定的管理員帳戶登入 toohello 虛擬機器 (**BUILTIN\AzureAdmin**) 和密碼 (**Contoso ！ 000**)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-326">Open hello RDP file that you downloaded, and sign in toohello virtual machine by using your configured administrator account (**BUILTIN\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="b8dd9-327">登入之後，您應該會看到 hello**伺服器管理員**儀表板。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-327">After you sign in, you should see hello **Server Manager** dashboard.</span></span> <span data-ttu-id="b8dd9-328">按一下**本機伺服器**hello 左窗格中。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-328">Click **Local Server** in hello left pane.</span></span>
4. <span data-ttu-id="b8dd9-329">按一下 hello**啟用 IPv6 的 DHCP 所指派的 IPv4 位址**連結。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-329">Click hello **IPv4 address assigned by DHCP, IPv6 enabled** link.</span></span>
5. <span data-ttu-id="b8dd9-330">在 hello**網路連線**對話方塊方塊中，按一下 hello 網路圖示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-330">In hello **Network Connections** dialog box, click hello network icon.</span></span>
   
    ![變更 hello 虛擬機器的慣用 DNS 伺服器](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784629.png)
6. <span data-ttu-id="b8dd9-332">Hello 命令列上，按一下**變更這個連線的 hello 設定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-332">On hello command bar, click **Change hello settings of this connection**.</span></span> <span data-ttu-id="b8dd9-333">（根據您的視窗 hello 大小，您可能必須 tooclick hello 雙重向右鍵 toosee 這個命令）。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-333">(Depending on hello size of your window, you might have tooclick hello double right arrow toosee this command).</span></span>
7. <span data-ttu-id="b8dd9-334">選取 網際網路通訊協定第 4 版 (TCP/IPv4) ，然後按一下內容 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-334">Select **Internet Protocol Version 4 (TCP/IPv4)**, and then click **Properties**.</span></span>
8. <span data-ttu-id="b8dd9-335">選取**下列的 DNS 伺服器位址使用 hello** ，然後指定**10.10.2.4**中**慣用 DNS 伺服器**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-335">Select **Use hello following DNS server addresses** and then specify **10.10.2.4** in **Preferred DNS server**.</span></span>
9. <span data-ttu-id="b8dd9-336">hello **10.10.2.4**位址是 hello 位址，是指派的 tooa Azure 的虛擬網路中的 hello 10.10.2.0/24 子網路中的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-336">hello **10.10.2.4** address is hello address that's assigned tooa virtual machine in hello 10.10.2.0/24 subnet in an Azure virtual network.</span></span> <span data-ttu-id="b8dd9-337">虛擬機器是 **ContosoDC**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-337">That virtual machine is **ContosoDC**.</span></span> <span data-ttu-id="b8dd9-338">tooverify **ContosoDC**的 IP 位址，使用**nslookup contosodc** hello 命令提示字元視窗，hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-338">tooverify **ContosoDC**'s IP address, use **nslookup contosodc** in hello command prompt window, as shown in hello following screenshot.</span></span>
   
    ![對網域控制站使用 NSLOOKUP toofind IP 位址](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664954.jpg)
10. <span data-ttu-id="b8dd9-340">按一下**確定** > **關閉**toocommit hello 變更。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-340">Click **OK** > **Close** toocommit hello changes.</span></span> <span data-ttu-id="b8dd9-341">您可以現在的加入 hello 虛擬機器**corp.contoso.com**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-341">You can now join hello virtual machine too**corp.contoso.com**.</span></span>
11. <span data-ttu-id="b8dd9-342">在 hello**本機伺服器**視窗中，按一下 hello **WORKGROUP**連結。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-342">Back in hello **Local Server** window, click hello **WORKGROUP** link.</span></span>
12. <span data-ttu-id="b8dd9-343">在 hello**電腦名稱**區段中，按一下**變更**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-343">In hello **Computer Name** section, click **Change**.</span></span>
13. <span data-ttu-id="b8dd9-344">選取 hello**網域**核取方塊，輸入**corp.contoso.com**在 hello 文字方塊中，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-344">Select hello **Domain** check box, type **corp.contoso.com** in hello text box, and then click **OK**.</span></span>
14. <span data-ttu-id="b8dd9-345">在 hello **Windows 安全性**對話方塊方塊中，指定 hello hello 預設網域系統管理員帳戶的認證 (**CORP\AzureAdmin**) 和 hello 密碼 (**Contoso ！ 000**).</span><span class="sxs-lookup"><span data-stu-id="b8dd9-345">In hello **Windows Security** dialog box, specify hello credentials for hello default domain administrator account (**CORP\AzureAdmin**) and hello password (**Contoso!000**).</span></span>
15. <span data-ttu-id="b8dd9-346">當您看見 hello 「  褖畫惎 toohello corp.contoso.com 網域 」 訊息時，按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-346">When you see hello "Welcome toohello corp.contoso.com domain" message, click **OK**.</span></span>
16. <span data-ttu-id="b8dd9-347">按一下**關閉** > **立即重新啟動**hello 對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-347">Click **Close** > **Restart Now** in hello dialog box.</span></span>

### <a name="add-hello-corpinstall-user-as-an-administrator-on-each-virtual-machine"></a><span data-ttu-id="b8dd9-348">將 hello Corp\Install 使用者新增為每個虛擬機器上的系統管理員</span><span class="sxs-lookup"><span data-stu-id="b8dd9-348">Add hello Corp\Install user as an administrator on each virtual machine</span></span>
1. <span data-ttu-id="b8dd9-349">等候 hello 虛擬機器重新啟動，並開啟 hello RDP 檔案一次 toosign toohello 虛擬機器中使用 hello **BUILTIN\AzureAdmin**帳戶。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-349">Wait until hello virtual machine restarts, and then open hello RDP file again toosign in toohello virtual machine by using hello **BUILTIN\AzureAdmin** account.</span></span>
2. <span data-ttu-id="b8dd9-350">在**伺服器管理員**按一下**工具** > **電腦管理**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-350">In **Server Manager** click **Tools** > **Computer Management**.</span></span>
   
    ![電腦管理](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784630.png)
3. <span data-ttu-id="b8dd9-352">在 hello**電腦管理**對話方塊方塊中，展開 **本機使用者和群組**，然後按一下**群組**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-352">In hello **Computer Management** dialog box, expand **Local Users and Groups**, and then click **Groups**.</span></span>
4. <span data-ttu-id="b8dd9-353">按兩下 hello**管理員**群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-353">Double-click hello **Administrators** group.</span></span>
5. <span data-ttu-id="b8dd9-354">在 [hello**系統管理員屬性**對話方塊方塊中，按一下 hello**新增**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-354">In hello **Administrators Properties** dialog box, click hello **Add** button.</span></span>
6. <span data-ttu-id="b8dd9-355">輸入 hello 使用者**CORP\Install**，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-355">Enter hello user **CORP\Install**, and then click **OK**.</span></span> <span data-ttu-id="b8dd9-356">當提示您輸入認證，使用 hello **AzureAdmin**帳戶以 hello **Contoso ！ 000**密碼。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-356">When prompted for credentials, use hello **AzureAdmin** account with hello **Contoso!000** password.</span></span>
7. <span data-ttu-id="b8dd9-357">按一下**確定**tooclose hello**系統管理員內容** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-357">Click **OK** tooclose hello **Administrator Properties** dialog box.</span></span>

### <a name="add-hello-failover-clustering-feature-tooeach-virtual-machine"></a><span data-ttu-id="b8dd9-358">新增 hello 容錯移轉叢集功能 tooeach 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-358">Add hello Failover Clustering feature tooeach virtual machine</span></span>
1. <span data-ttu-id="b8dd9-359">在 hello**伺服器管理員**儀表板，按一下 **新增角色及功能**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-359">In hello **Server Manager** dashboard, click **Add roles and features**.</span></span>
2. <span data-ttu-id="b8dd9-360">在 [hello**新增角色及功能精靈**，按一下**下一步]**直到 toohello**功能**頁面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-360">In hello **Add Roles and Features Wizard**, click **Next** until you get toohello **Features** page.</span></span>
3. <span data-ttu-id="b8dd9-361">選取 [容錯移轉叢集] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-361">Select **Failover Clustering**.</span></span> <span data-ttu-id="b8dd9-362">出現提示時，請新增其他相依功能。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-362">When prompted, add other dependent features.</span></span>
   
    ![新增容錯移轉叢集功能 toovirtual 機器](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784631.png)
4. <span data-ttu-id="b8dd9-364">按一下**下一步**，然後按一下**安裝**上 hello**確認**頁面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-364">Click **Next**, and then click **Install** on hello **Confirmation** page.</span></span>
5. <span data-ttu-id="b8dd9-365">當 hello**容錯移轉叢集**功能安裝完成後，按一下 **關閉**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-365">When hello **Failover Clustering** feature installation is finished, click **Close**.</span></span>
6. <span data-ttu-id="b8dd9-366">登出 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-366">Sign out of hello virtual machine.</span></span>
7. <span data-ttu-id="b8dd9-367">重複步驟三部伺服器都本節中的 hello: **ContosoWSFCNode**， **ContosoSQL1**，和**ContosoSQL2**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-367">Repeat hello steps in this section for all three servers: **ContosoWSFCNode**, **ContosoSQL1**, and **ContosoSQL2**.</span></span>

<span data-ttu-id="b8dd9-368">hello SQL Server 虛擬機器現在已佈建且正在執行，但其中一個 hello for SQL Server 的預設選項。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-368">hello SQL Server virtual machines are now provisioned and running, but each has hello default options for SQL Server.</span></span>

## <a name="create-hello-failover-cluster"></a><span data-ttu-id="b8dd9-369">建立 hello 容錯移轉叢集</span><span class="sxs-lookup"><span data-stu-id="b8dd9-369">Create hello failover cluster</span></span>
<span data-ttu-id="b8dd9-370">在本節中，您可以建立 hello 容錯移轉叢集來裝載您稍後建立 hello 可用性群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-370">In this section, you create hello failover cluster that will host hello availability group that you will create later.</span></span> <span data-ttu-id="b8dd9-371">現在，您應該完成下列 tooeach hello 三個虛擬機器，您將使用 hello 容錯移轉叢集中的 hello:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-371">By now, you should have done hello following tooeach of hello three virtual machines that you will use in hello failover cluster:</span></span>

* <span data-ttu-id="b8dd9-372">在 Azure 中的 hello 完整佈建的虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-372">Fully provisioned hello virtual machine in Azure</span></span>
* <span data-ttu-id="b8dd9-373">加入 hello 虛擬機器 toohello 網域</span><span class="sxs-lookup"><span data-stu-id="b8dd9-373">Joined hello virtual machine toohello domain</span></span>
* <span data-ttu-id="b8dd9-374">加入**CORP\Install** toohello 本機 Administrators 群組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-374">Added **CORP\Install** toohello local Administrators group</span></span>
* <span data-ttu-id="b8dd9-375">加入的 hello 容錯移轉叢集功能</span><span class="sxs-lookup"><span data-stu-id="b8dd9-375">Added hello failover clustering feature</span></span>

<span data-ttu-id="b8dd9-376">您可以將它 toohello 容錯移轉叢集之前，這些都是在每個虛擬機器上的必要條件。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-376">All these are prerequisites on each virtual machine before you can join it toohello failover cluster.</span></span>

<span data-ttu-id="b8dd9-377">此外，請注意，Azure 虛擬網路的 hello 行為 hello 相同的內部部署網路的方式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-377">Also, note that hello Azure virtual network does not behave in hello same way as an on-premises network.</span></span> <span data-ttu-id="b8dd9-378">您需要在 hello 順序 toocreate hello 叢集：</span><span class="sxs-lookup"><span data-stu-id="b8dd9-378">You need toocreate hello cluster in hello following order:</span></span>

1. <span data-ttu-id="b8dd9-379">在一個節點上 (**ContosoSQL1**) 建立單一節點叢集。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-379">Create a single-node cluster on one node (**ContosoSQL1**).</span></span>
2. <span data-ttu-id="b8dd9-380">修改 hello 叢集 IP 位址 tooan 未使用的 IP 位址 (**10.10.2.101**)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-380">Modify hello cluster IP address tooan unused IP address (**10.10.2.101**).</span></span>
3. <span data-ttu-id="b8dd9-381">將 hello 叢集名稱上線。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-381">Bring hello cluster name online.</span></span>
4. <span data-ttu-id="b8dd9-382">新增 hello 其他節點 (**ContosoSQL2**和**ContosoWSFCNode**)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-382">Add hello other nodes (**ContosoSQL2** and **ContosoWSFCNode**).</span></span>

<span data-ttu-id="b8dd9-383">使用下列步驟，完整設定叢集 hello toocomplete hello 工作 hello。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-383">Use hello following steps toocomplete hello tasks that fully configure hello cluster.</span></span>

1. <span data-ttu-id="b8dd9-384">開啟 hello RDP 檔案**ContosoSQL1**，並使用 hello 網域帳戶登入**CORP\Install**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-384">Open hello RDP file for **ContosoSQL1**, and sign in by using hello domain account **CORP\Install**.</span></span>
2. <span data-ttu-id="b8dd9-385">在 hello**伺服器管理員**儀表板，按一下 **工具** > **容錯移轉叢集管理員**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-385">In hello **Server Manager** dashboard, click **Tools** > **Failover Cluster Manager**.</span></span>
3. <span data-ttu-id="b8dd9-386">Hello 左窗格中，以滑鼠右鍵按一下**容錯移轉叢集管理員**，然後按一下**建立叢集**hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-386">In hello left pane, right-click **Failover Cluster Manager**, and then click **Create a Cluster**, as shown in hello following screenshot.</span></span>
   
    ![建立叢集](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784632.png)
4. <span data-ttu-id="b8dd9-388">在 hello 建立叢集精靈，逐步執行 hello 頁面，以及使用 hello 下表中的 hello 設定來建立單一節點叢集：</span><span class="sxs-lookup"><span data-stu-id="b8dd9-388">In hello Create Cluster Wizard, create a one-node cluster by stepping through hello pages and using hello settings in hello following table:</span></span>
   
   | <span data-ttu-id="b8dd9-389">Page</span><span class="sxs-lookup"><span data-stu-id="b8dd9-389">Page</span></span> | <span data-ttu-id="b8dd9-390">設定</span><span class="sxs-lookup"><span data-stu-id="b8dd9-390">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="b8dd9-391">開始之前</span><span class="sxs-lookup"><span data-stu-id="b8dd9-391">Before You Begin</span></span> |<span data-ttu-id="b8dd9-392">使用預設值</span><span class="sxs-lookup"><span data-stu-id="b8dd9-392">Use defaults</span></span> |
   | <span data-ttu-id="b8dd9-393">選取伺服器</span><span class="sxs-lookup"><span data-stu-id="b8dd9-393">Select Servers</span></span> |<span data-ttu-id="b8dd9-394">在 [輸入伺服器名稱] 中輸入 **ContosoSQL1**，然後按一下 [新增]</span><span class="sxs-lookup"><span data-stu-id="b8dd9-394">Type **ContosoSQL1** in **Enter server name** and click **Add**</span></span> |
   | <span data-ttu-id="b8dd9-395">驗證警告</span><span class="sxs-lookup"><span data-stu-id="b8dd9-395">Validation Warning</span></span> |<span data-ttu-id="b8dd9-396">選取**否。 我不需要此群集中，來自 Microsoft 的支援和不想 toorun hello 驗證測試。當我按 [下一步] 時，繼續建立 hello 叢集**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-396">Select **No. I do not require support from Microsoft for this cluster, and therefore do not want toorun hello validation tests. When I click Next, continue creating hello cluster**.</span></span> |
   | <span data-ttu-id="b8dd9-397">用於管理 hello 叢集存取點</span><span class="sxs-lookup"><span data-stu-id="b8dd9-397">Access Point for Administering hello Cluster</span></span> |<span data-ttu-id="b8dd9-398">在 [叢集名稱] 中輸入 **Cluster1**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-398">Type **Cluster1** in **Cluster Name**</span></span> |
   | <span data-ttu-id="b8dd9-399">確認</span><span class="sxs-lookup"><span data-stu-id="b8dd9-399">Confirmation</span></span> |<span data-ttu-id="b8dd9-400">除非您使用的是儲存空間，否則請使用預設值。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-400">Use defaults unless you are using Storage Spaces.</span></span> <span data-ttu-id="b8dd9-401">請參閱本表格後的 hello 警告。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-401">See hello warning following this table.</span></span> |
   
   > [!WARNING]
   > <span data-ttu-id="b8dd9-402">如果您使用[儲存空間](https://technet.microsoft.com/library/hh831739)、 將多個磁碟組成儲存集區，則必須清除 hello**新增所有合格的存放裝置 toohello 叢集**hello 核取方塊**確認**頁面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-402">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear hello **Add all eligible storage toohello cluster** check box on hello **Confirmation** page.</span></span> <span data-ttu-id="b8dd9-403">如果您不要清除此選項，則會卸離 hello 虛擬磁碟 hello 叢集程序期間。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-403">If you do not clear this option, hello virtual disks will be detached during hello clustering process.</span></span> <span data-ttu-id="b8dd9-404">如此一來，他們也不會在磁碟管理員] 或 [檔案總管之前從 hello 叢集中移除 hello 儲存空間，並使用 PowerShell 來重新附加它。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-404">As a result, they will also not appear in Disk Manager or Explorer until hello storage spaces are removed from hello cluster and reattached by using PowerShell.</span></span>
   > 
   > 
5. <span data-ttu-id="b8dd9-405">Hello 左窗格中，展開 **容錯移轉叢集管理員**，然後按一下 **Cluster1.corp.contoso.com**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-405">In hello left pane, expand **Failover Cluster Manager**, and then click **Cluster1.corp.contoso.com**.</span></span>
6. <span data-ttu-id="b8dd9-406">在 hello 中央窗格中，向下捲動 toohello**叢集核心資源**區段，然後展開 hello**名稱： Clutser1**詳細資料。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-406">In hello center pane, scroll down toohello **Cluster Core Resources** section, and expand hello **Name: Clutser1** details.</span></span> <span data-ttu-id="b8dd9-407">您應該會看到這兩個 hello**名稱**和 hello **IP 位址**hello 中的資源**失敗**狀態。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-407">You should see both hello **Name** and hello **IP Address** resources in hello **Failed** state.</span></span> <span data-ttu-id="b8dd9-408">hello IP 位址資源無法上線因為 hello 叢集指派 hello hello 機器本身，相同的 IP 位址，這是重複的位址。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-408">hello IP address resource cannot be brought online because hello cluster is assigned hello same IP address as hello machine itself, which is a duplicate address.</span></span>
7. <span data-ttu-id="b8dd9-409">以滑鼠右鍵按一下失敗的 hello **IP 位址**資源，然後再按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-409">Right-click hello failed **IP Address** resource, and then click **Properties**.</span></span>
   
    ![叢集屬性](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784633.png)
8. <span data-ttu-id="b8dd9-411">選取**靜態 IP 位址**，指定**10.10.2.101**在 hello**位址**文字方塊，然後再按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-411">Select **Static IP Address**, specify **10.10.2.101** in hello **Address** text box, and then click **OK**.</span></span>
9. <span data-ttu-id="b8dd9-412">在 hello**叢集核心資源**區段中，以滑鼠右鍵按一下**名稱： Cluster1**，然後按一下**上線**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-412">In hello **Cluster Core Resources** section, right-click **Name: Cluster1**, and then click **Bring Online**.</span></span> <span data-ttu-id="b8dd9-413">等待兩個資源上線。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-413">Wait until both resources are online.</span></span> <span data-ttu-id="b8dd9-414">Hello 叢集名稱資源上線時，會以新的 Active Directory 電腦帳戶更新 hello DC 伺服器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-414">When hello cluster name resource comes online, hello DC server is updated with a new Active Directory computer account.</span></span> <span data-ttu-id="b8dd9-415">這個 Active Directory 帳戶將用於稍後 toorun hello 可用性群組的叢集的服務。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-415">This Active Directory account will be used toorun hello availability group clustered service later.</span></span>
10. <span data-ttu-id="b8dd9-416">新增 hello 剩餘節點 toohello 叢集。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-416">Add hello remaining nodes toohello cluster.</span></span> <span data-ttu-id="b8dd9-417">Hello 瀏覽器樹狀目錄中，以滑鼠右鍵按一下**Cluster1.corp.contoso.com**，然後按一下**加入節點**hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-417">In hello browser tree, right-click **Cluster1.corp.contoso.com**, and then click **Add Node**, as shown in hello following screenshot.</span></span>
    
     ![新增節點 toohello 叢集](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784634.png)
11. <span data-ttu-id="b8dd9-419">在 [hello**新增節點精靈**，按一下**下一步]**上 hello**選取伺服器**頁面上，加入**ContosoSQL2**和**ContosoWSFCNode** toohello 清單中的 hello 伺服器名稱**輸入伺服器名稱**，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-419">In hello **Add Node Wizard**, click **Next** on hello **Select Servers** page, add **ContosoSQL2** and **ContosoWSFCNode** toohello list by typing hello server name in **Enter server name** and then clicking **Add**.</span></span> <span data-ttu-id="b8dd9-420">完成之後，按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-420">When you are done, click **Next**.</span></span>
12. <span data-ttu-id="b8dd9-421">在 hello**驗證警告**頁面上，按一下**否**，但是在生產案例中，您應該執行 hello 驗證測試。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-421">On hello **Validation Warning** page, click **No**, although in a production scenario, you should perform hello validation tests.</span></span> <span data-ttu-id="b8dd9-422">然後按 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-422">Then, click **Next**.</span></span>
13. <span data-ttu-id="b8dd9-423">在 hello**確認**頁面上，按一下**下一步**tooadd hello 節點。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-423">On hello **Confirmation** page, click **Next** tooadd hello nodes.</span></span>
    
    > [!WARNING]
    > <span data-ttu-id="b8dd9-424">如果您使用[儲存空間](https://technet.microsoft.com/library/hh831739)、 將多個磁碟組成儲存集區，則必須清除 hello**新增所有合格的存放裝置 toohello 叢集**核取方塊。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-424">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear hello **Add all eligible storage toohello cluster** check box.</span></span> <span data-ttu-id="b8dd9-425">如果您不要清除此選項，則會卸離 hello 虛擬磁碟 hello 叢集程序期間。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-425">If you do not clear this option, hello virtual disks will be detached during hello clustering process.</span></span> <span data-ttu-id="b8dd9-426">如此一來，他們也不會出現在 磁碟管理員 或 檔案總管之前從叢集移除 hello 儲存空間，並使用 PowerShell 將其重新附加。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-426">As a result, they will also not appear in Disk Manager or Explorer until hello storage spaces are removed from cluster and reattached using PowerShell.</span></span>
    > 
    > 
14. <span data-ttu-id="b8dd9-427">Hello 節點會加入 toohello 叢集之後，請按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-427">After hello nodes are added toohello cluster, click **Finish**.</span></span> <span data-ttu-id="b8dd9-428">容錯移轉叢集管理員現在應該會顯示您的叢集有 3 個節點，並將其列在 hello**節點**容器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-428">Failover Cluster Manager should now show that your cluster has three nodes and list them in hello **Nodes** container.</span></span>
15. <span data-ttu-id="b8dd9-429">登出 hello 遠端桌面工作階段。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-429">Sign out of hello remote desktop session.</span></span>

## <a name="prepare-hello-sql-server-instances-for-availability-groups"></a><span data-ttu-id="b8dd9-430">針對可用性群組準備 hello SQL Server 執行個體</span><span class="sxs-lookup"><span data-stu-id="b8dd9-430">Prepare hello SQL Server instances for availability groups</span></span>
<span data-ttu-id="b8dd9-431">在本節中，您要執行 hello 上同時**ContosoSQL1**和**contosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-431">In this section, you will do hello following on both **ContosoSQL1** and **contosoSQL2**:</span></span>

* <span data-ttu-id="b8dd9-432">新增的登入**NT AUTHORITY\System**具備必要權限設定 toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-432">Add a login for **NT AUTHORITY\System** with necessary permissions set toohello default SQL Server instance.</span></span>
* <span data-ttu-id="b8dd9-433">新增**CORP\Install**為 sysadmin 角色 toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-433">Add **CORP\Install** as a sysadmin role toohello default SQL Server instance.</span></span>
* <span data-ttu-id="b8dd9-434">開啟 SQL server 的遠端存取的 hello 防火牆。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-434">Open hello firewall for remote access of SQL Server.</span></span>
* <span data-ttu-id="b8dd9-435">啟用 hello Alwayson 可用性群組功能。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-435">Enable hello Always On availability groups feature.</span></span>
* <span data-ttu-id="b8dd9-436">Hello SQL Server 服務帳戶變更太**CORP\SQLSvc1**和**CORP\SQLSvc2**分別。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-436">Change hello SQL Server service account too**CORP\SQLSvc1** and **CORP\SQLSvc2**, respectively.</span></span>

<span data-ttu-id="b8dd9-437">執行這些動作沒有順序限制。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-437">These actions can be performed in any order.</span></span> <span data-ttu-id="b8dd9-438">不過，遵循步驟 hello 逐步執行順序。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-438">Nevertheless, hello following steps will walk through them in order.</span></span> <span data-ttu-id="b8dd9-439">兩個步驟 hello **ContosoSQL1**和**ContosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="b8dd9-439">Follow hello steps for both **ContosoSQL1** and **ContosoSQL2**:</span></span>

1. <span data-ttu-id="b8dd9-440">如果您沒有已登出 hello 遠端桌面工作階段的 hello 虛擬機器，請立刻執行。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-440">If you have not signed out of hello remote desktop session for hello virtual machine, do so now.</span></span>
2. <span data-ttu-id="b8dd9-441">開啟 hello RDP 檔案**ContosoSQL1**和**ContosoSQL2**，並以登入**BUILTIN\AzureAdmin**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-441">Open hello RDP files for **ContosoSQL1** and **ContosoSQL2**, and sign in as **BUILTIN\AzureAdmin**.</span></span>
3. <span data-ttu-id="b8dd9-442">新增**NT AUTHORITY\System** toohello 具備必要權限的 SQL Server 登入。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-442">Add **NT AUTHORITY\System** toohello SQL Server logins with necessary permissions.</span></span> <span data-ttu-id="b8dd9-443">開啟 **SQL Server Management Studio**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-443">Open **SQL Server Management Studio**.</span></span>
4. <span data-ttu-id="b8dd9-444">按一下**連接**tooconnect toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-444">Click **Connect** tooconnect toohello default SQL Server instance.</span></span>
5. <span data-ttu-id="b8dd9-445">在 [物件總管] 中，依序展開 [安全性]、[登入]。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-445">In **Object Explorer**, expand **Security**, and then expand **Logins**.</span></span>
6. <span data-ttu-id="b8dd9-446">以滑鼠右鍵按一下 hello **NT AUTHORITY\System**登入，然後再按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-446">Right-click hello **NT AUTHORITY\System** login, and then click **Properties**.</span></span>
7. <span data-ttu-id="b8dd9-447">在 [hello**安全性實體**hello 本機伺服器，請選取] 頁面上，**授與**的 hello 下列權限，，然後按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-447">On hello **Securables** page, for hello local server, select **Grant** for hello following permissions, and then click **OK**.</span></span>
   
   * <span data-ttu-id="b8dd9-448">更改所有可用性群組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-448">Alter any availability group</span></span>
   * <span data-ttu-id="b8dd9-449">連接 SQL</span><span class="sxs-lookup"><span data-stu-id="b8dd9-449">Connect SQL</span></span>
   * <span data-ttu-id="b8dd9-450">檢視伺服器狀態</span><span class="sxs-lookup"><span data-stu-id="b8dd9-450">View server state</span></span>
8. <span data-ttu-id="b8dd9-451">新增**CORP\Install**為**sysadmin**角色 toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-451">Add **CORP\Install** as a **sysadmin** role toohello default SQL Server instance.</span></span> <span data-ttu-id="b8dd9-452">在 [物件總管]  中，以滑鼠右鍵按一下 [登入] ，再按一下 [新增登入] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-452">In **Object Explorer**, right-click **Logins**, and then click **New Login**.</span></span>
9. <span data-ttu-id="b8dd9-453">在 [登入名稱] 中輸入 **CORP\Install**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-453">Type **CORP\Install** in **Login name**.</span></span>
10. <span data-ttu-id="b8dd9-454">在 hello**伺服器角色**頁面上，選取**sysadmin**，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-454">On hello **Server Roles** page, select **sysadmin**, and then click **OK**.</span></span> <span data-ttu-id="b8dd9-455">您建立 hello 登入之後，可以查看展開**登入**中**物件總管 中**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-455">After you create hello login, you can see it by expanding **Logins** in **Object Explorer**.</span></span>
11. <span data-ttu-id="b8dd9-456">SQL Server 的防火牆規則上 hello toocreate**啟動**畫面上，開啟**具有進階安全性的 Windows 防火牆**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-456">toocreate a firewall rule for SQL Server, on hello **Start** screen, open **Windows Firewall with Advanced Security**.</span></span>
12. <span data-ttu-id="b8dd9-457">Hello 左窗格中，選取**輸入規則**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-457">In hello left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="b8dd9-458">Hello 右窗格中，按一下 **新規則**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-458">In hello right pane, click **New Rule**.</span></span>
13. <span data-ttu-id="b8dd9-459">在 hello**規則類型**頁面上，按一下**程式** > **下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-459">On hello **Rule Type** page, click **Program** > **Next**.</span></span>
14. <span data-ttu-id="b8dd9-460">在 hello**程式**頁面上，選取**這個程式路徑**，型別**%ProgramFiles%\Microsoft SQL Server\MSSQL12。MSSQLSERVER\MSSQL\Binn\sqlservr.exe**在 hello 文字方塊中，然後按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-460">On hello **Program** page, select **This program path**, type **%ProgramFiles%\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe** in hello text box, and then click **Next**.</span></span> <span data-ttu-id="b8dd9-461">如果您要遵循這些指示，但使用 SQL Server 2012，hello SQL Server 目錄是**MSSQL11。MSSQLSERVER**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-461">If you are following these directions but using SQL Server 2012, hello SQL Server directory is **MSSQL11.MSSQLSERVER**.</span></span>
15. <span data-ttu-id="b8dd9-462">在 hello**動作**頁面上，保留**允許 hello 連線**選取，然後再按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-462">On hello **Action** page, keep **Allow hello connection** selected, and then click **Next**.</span></span>
16. <span data-ttu-id="b8dd9-463">在 hello**設定檔**頁面上，接受 hello 預設設定，然後按**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-463">On hello **Profile** page, accept hello default settings, and then click **Next**.</span></span>
17. <span data-ttu-id="b8dd9-464">在 hello**名稱**頁面上，指定規則的名稱，例如**SQL Server （程式規則）**，在 hello**名稱**文字方塊，然後按一下 **完成**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-464">On hello **Name** page, specify a rule name, such as **SQL Server (Program Rule)**, in hello **Name** text box, then click **Finish**.</span></span>
18. <span data-ttu-id="b8dd9-465">tooenable hello **Always On 可用性群組**功能，在 hello**啟動**畫面上，開啟**SQL Server 組態管理員**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-465">tooenable hello **Always On Availability Groups** feature, on hello **Start** screen, open **SQL Server Configuration Manager**.</span></span>
19. <span data-ttu-id="b8dd9-466">在 hello 瀏覽器樹狀目錄中，按一下  **SQL Server 服務**，以滑鼠右鍵按一下 hello **SQL Server (MSSQLSERVER)**服務，然後再按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-466">In hello browser tree, click **SQL Server Services**, right-click hello **SQL Server (MSSQLSERVER)** service, and then click **Properties**.</span></span>
20. <span data-ttu-id="b8dd9-467">按一下 hello **Alwayson 高可用性**索引標籤上，選取**啟用 Alwayson 可用性群組**，如下所示 hello 下列螢幕擷取畫面，然後按一下**套用**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-467">Click hello **Always On High Availability** tab, select **Enable Always On Availability Groups**, as shown in hello following screenshot, and then click **Apply**.</span></span> <span data-ttu-id="b8dd9-468">按一下**確定**在 hello 對話方塊中，但不要關閉 hello**屬性**尚未對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-468">Click **OK** in hello dialog box, and do not close hello **Properties** dialog box yet.</span></span> <span data-ttu-id="b8dd9-469">變更 hello 服務帳戶之後，您將會重新啟動 hello SQL Server 服務。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-469">You will restart hello SQL Server service after you change hello service account.</span></span>
    
     ![啟用 Always On 可用性群組](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665520.gif)
21. <span data-ttu-id="b8dd9-471">toochange hello SQL Server 服務帳戶，按一下 hello**登入**索引標籤上，輸入**CORP\SQLSvc1** (如**ContosoSQL1**) 或**CORP\SQLSvc2** (如**ContosoSQL2**) 中**帳戶名稱**、 填入並確認 hello 密碼，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-471">toochange hello SQL Server service account, click hello **Log On** tab, type **CORP\SQLSvc1** (for **ContosoSQL1**) or **CORP\SQLSvc2** (for **ContosoSQL2**) in **Account Name**, fill in and confirm hello password, and then click **OK**.</span></span>
22. <span data-ttu-id="b8dd9-472">在 hello 開啟對話方塊，按一下 **是**toorestart hello SQL Server 服務。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-472">In hello dialog box that opens, click **Yes** toorestart hello SQL Server service.</span></span> <span data-ttu-id="b8dd9-473">Hello SQL Server 服務重新啟動之後，變更您所做 hello**屬性**對話方塊都有效。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-473">After hello SQL Server service restarts, changes that you made in hello **Properties** dialog box are effective.</span></span>
23. <span data-ttu-id="b8dd9-474">登出 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-474">Sign out of hello virtual machines.</span></span>

## <a name="create-hello-availability-group"></a><span data-ttu-id="b8dd9-475">建立 hello 可用性群組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-475">Create hello availability group</span></span>
<span data-ttu-id="b8dd9-476">現在您已經準備就緒 tooconfigure 可用性群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-476">You are now ready tooconfigure an availability group.</span></span> <span data-ttu-id="b8dd9-477">以下列出需執行的動作：</span><span class="sxs-lookup"><span data-stu-id="b8dd9-477">Below is an outline of what you will do:</span></span>

* <span data-ttu-id="b8dd9-478">在 **ContosoSQL1** 上建立新的資料庫 (**MyDB1**)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-478">Create a new database (**MyDB1**) on **ContosoSQL1**.</span></span>
* <span data-ttu-id="b8dd9-479">利用完整備份與 hello 資料庫的交易記錄備份。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-479">Take both a full backup and a transaction log backup of hello database.</span></span>
* <span data-ttu-id="b8dd9-480">還原完整的 hello 和太記錄備份**ContosoSQL2**以 hello **NORECOVERY**選項。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-480">Restore hello full and log backups too**ContosoSQL2** with hello **NORECOVERY** option.</span></span>
* <span data-ttu-id="b8dd9-481">建立 hello 可用性群組 (**AG1**) 同步認可、 自動容錯移轉，與可讀取次要複本。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-481">Create hello availability group (**AG1**) with synchronous commit, automatic failover, and readable secondary replicas.</span></span>

### <a name="create-hello-mydb1-database-on-contososql1"></a><span data-ttu-id="b8dd9-482">在 ContosoSQL1 上建立 hello MyDB1 資料庫</span><span class="sxs-lookup"><span data-stu-id="b8dd9-482">Create hello MyDB1 database on ContosoSQL1</span></span>
1. <span data-ttu-id="b8dd9-483">如果您已不已經登出 hello 遠端桌面工作階段的**ContosoSQL1**和**ContosoSQL2**，請立刻執行。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-483">If you have not already signed out of hello remote desktop sessions for **ContosoSQL1** and **ContosoSQL2**, do so now.</span></span>
2. <span data-ttu-id="b8dd9-484">開啟 hello RDP 檔案**ContosoSQL1**，並以登入**CORP\Install**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-484">Open hello RDP file for **ContosoSQL1**, and sign in as **CORP\Install**.</span></span>
3. <span data-ttu-id="b8dd9-485">在 [檔案總管]  中，於 **\\C:** 磁碟中，建立名為 **備份** 的目錄。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-485">In **File Explorer**, under **C:\\**, create a directory named **backup**.</span></span> <span data-ttu-id="b8dd9-486">您將使用此目錄 tooback 及還原您的資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-486">You will use this directory tooback up and restore your database.</span></span>
4. <span data-ttu-id="b8dd9-487">Hello 新目錄按一下滑鼠右鍵，指向太**分享**，然後按一下**特定人員**hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-487">Right-click hello new directory, point too**Share with**, and then click **Specific people**, as shown in hello following screenshot.</span></span>
   
    ![建立備份資料夾](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665521.gif)
5. <span data-ttu-id="b8dd9-489">新增**CORP\SQLSvc1**，然後為 hello**讀/寫**權限。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-489">Add **CORP\SQLSvc1**, and then give it hello **Read/Write** permission.</span></span> <span data-ttu-id="b8dd9-490">新增**CORP\SQLSvc2**，然後為 hello**讀取**權限，如中所示 hello 下列螢幕擷取畫面，然後按一下**共用**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-490">Add **CORP\SQLSvc2**, and then give it hello **Read** permission, as shown in hello following screenshot, and then click **Share**.</span></span> <span data-ttu-id="b8dd9-491">Hello 檔案共用的程序完成之後，請按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-491">After hello file-sharing process is finished, click **Done**.</span></span>
   
    ![將權限授與備份資料夾](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665522.gif)
6. <span data-ttu-id="b8dd9-493">從 hello toocreate hello 資料庫**啟動**功能表中，開啟**SQL Server Management Studio**，然後按一下**連接**tooconnect toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-493">toocreate hello database, from hello **Start** menu, open **SQL Server Management Studio**, and then click **Connect** tooconnect toohello default SQL Server instance.</span></span>
7. <span data-ttu-id="b8dd9-494">在 物件總管 中，以滑鼠右鍵按一下 資料庫 ，然後按一下新增資料庫 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-494">In **Object Explorer**, right-click **Databases**, and then click **New Database**.</span></span>
8. <span data-ttu-id="b8dd9-495">在 資料庫名稱  中，輸入 **MyDB1**，然後按一下確定 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-495">In **Database name**, type **MyDB1**, and then click **OK**.</span></span>

### <a name="make-a-full-backup-of-mydb1-and-restore-it-on-contososql2"></a><span data-ttu-id="b8dd9-496">建立 MyDB1 的完整備份，然後將其還原至 ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="b8dd9-496">Make a full backup of MyDB1 and restore it on ContosoSQL2</span></span>
1. <span data-ttu-id="b8dd9-497">toomake hello 的完整備份資料庫，在**物件總管 中**，依序展開**資料庫**，以滑鼠右鍵按一下**MyDB1**，點太**工作**，和然後按一下 **Back Up**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-497">toomake a full backup of hello database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point too**Tasks**, and then click **Back Up**.</span></span>
2. <span data-ttu-id="b8dd9-498">在 hello**來源**區段中，持續**備份類型**設定得**完整**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-498">In hello **Source** section, keep **Backup type** set too**Full**.</span></span> <span data-ttu-id="b8dd9-499">在 hello**目的地**區段中，按一下**移除**tooremove hello 預設 hello 備份檔案的檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-499">In hello **Destination** section, click **Remove** tooremove hello default file path for hello backup file.</span></span>
3. <span data-ttu-id="b8dd9-500">在 hello**目的地**區段中，按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-500">In hello **Destination** section, click **Add**.</span></span>
4. <span data-ttu-id="b8dd9-501">在 hello**檔案名稱**文字方塊中，輸入 **\\ContosoSQL1\backup\MyDB1.bak**，按一下**[確定]**，然後按一下**確定**再次tooback hello 資料庫備份。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-501">In hello **File name** text box, type **\\ContosoSQL1\backup\MyDB1.bak**, click **OK**, and then click **OK** again tooback up hello database.</span></span> <span data-ttu-id="b8dd9-502">Hello 備份作業完成時，按一下**確定**再次 tooclose hello 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-502">When hello backup operation finishes, click **OK** again tooclose hello dialog box.</span></span>
5. <span data-ttu-id="b8dd9-503">toomake 交易記錄的 hello 資料庫備份，**物件總管 中**，依序展開**資料庫**，以滑鼠右鍵按一下**MyDB1**，點太**工作**，然後按一下 **Back Up**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-503">toomake a transaction log backup of hello database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point too**Tasks**, and then click **Back Up**.</span></span>
6. <span data-ttu-id="b8dd9-504">在 [備份類型]  中，選取 [交易記錄] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-504">In **Backup type**, select **Transaction Log**.</span></span> <span data-ttu-id="b8dd9-505">保留 hello**目的地**檔案路徑集 toohello 您稍早指定的其中一個，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-505">Keep hello **Destination** file path set toohello one you specified earlier, and then click **OK**.</span></span> <span data-ttu-id="b8dd9-506">Hello 備份作業完成之後，請按一下**確定**一次。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-506">After hello backup operation finishes, click **OK** again.</span></span>
7. <span data-ttu-id="b8dd9-507">完整的 toorestore hello 和交易記錄備份**ContosoSQL2**，開啟 hello RDP 檔，以取得**ContosoSQL2**，並以登入**CORP\Install**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-507">toorestore hello full and transaction log backups on **ContosoSQL2**, open hello RDP file for **ContosoSQL2**, and sign in as **CORP\Install**.</span></span> <span data-ttu-id="b8dd9-508">保留 hello 遠端桌面工作階段的**ContosoSQL1**開啟。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-508">Leave hello remote desktop session for **ContosoSQL1** open.</span></span>
8. <span data-ttu-id="b8dd9-509">從 hello**啟動**功能表中，開啟**SQL Server Management Studio**，然後按一下**連接**tooconnect toohello 預設 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-509">From hello **Start** menu, open **SQL Server Management Studio**, and then click **Connect** tooconnect toohello default SQL Server instance.</span></span>
9. <span data-ttu-id="b8dd9-510">在 [物件總管]  中，以滑鼠右鍵按一下 [資料庫] ，再按一下 [還原資料庫] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-510">In **Object Explorer**, right-click **Databases**, and then click **Restore Database**.</span></span>
10. <span data-ttu-id="b8dd9-511">在 hello**來源**區段中，選取**裝置**，並按一下省略符號，hello **...**</span><span class="sxs-lookup"><span data-stu-id="b8dd9-511">In hello **Source** section, select **Device**, and click hello ellipsis **…**</span></span> <span data-ttu-id="b8dd9-512">按鈕。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-512">button.</span></span>
11. <span data-ttu-id="b8dd9-513">在 [選取備份裝置] 中按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-513">In **Select backup devices**, click **Add**.</span></span>
12. <span data-ttu-id="b8dd9-514">在 [備份檔案位置]  中，輸入 **\\ContosoSQL1\backup**，按一下 [重新整理] **Refresh**，選取 **MyDB1.bak**，按一下 [確定] ，然後再按一次 [確定] **OK**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-514">In **Backup file location**, type **\\ContosoSQL1\backup**, click **Refresh**, select **MyDB1.bak**, click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="b8dd9-515">您現在應該會看到完整備份的 hello 與 hello 記錄檔備份在 hello**備份組 toorestore**窗格。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-515">You should now see hello full backup and hello log backup in hello **Backup sets toorestore** pane.</span></span>
13. <span data-ttu-id="b8dd9-516">移 toohello**選項**頁面上，選取**RESTORE WITH NORECOVERY**中**復原狀態**，然後按一下**確定**toorestore hello 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-516">Go toohello **Options** page, select **RESTORE WITH NORECOVERY** in **Recovery state**, and then click **OK** toorestore hello database.</span></span> <span data-ttu-id="b8dd9-517">Hello 之後還原作業完成，請按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-517">After hello restore operation finishes, click **OK**.</span></span>

### <a name="create-hello-availability-group"></a><span data-ttu-id="b8dd9-518">建立 hello 可用性群組</span><span class="sxs-lookup"><span data-stu-id="b8dd9-518">Create hello availability group</span></span>
1. <span data-ttu-id="b8dd9-519">移回 toohello 遠端桌面工作階段的**ContosoSQL1**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-519">Go back toohello remote desktop session for **ContosoSQL1**.</span></span> <span data-ttu-id="b8dd9-520">在**物件總管 中**在 SQL Server Management Studio，以滑鼠右鍵按一下**Alwayson 高可用性**，然後按一下**新增可用性群組精靈**hello 所示，下列螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-520">In **Object Explorer** in SQL Server Management Studio, right-click **Always On High Availability**, and then click **New Availability Group Wizard**, as shown in hello following screenshot.</span></span>
   
    ![啟動新增可用性群組精靈](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665523.gif)
2. <span data-ttu-id="b8dd9-522">在 hello**簡介**頁面上，按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-522">On hello **Introduction** page, click **Next**.</span></span> <span data-ttu-id="b8dd9-523">在 hello**指定可用性群組名稱**頁面上，輸入**AG1**中**可用性群組名稱**，然後按一下 **下一步**一次。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-523">On hello **Specify Availability Group Name** page, type **AG1** in **Availability group name**, then click **Next** again.</span></span>
   
    ![新增可用性群組精靈，指定可用性群組名稱](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665524.gif)
3. <span data-ttu-id="b8dd9-525">在 [hello**選取資料庫**頁面上，選取**MyDB1**，然後按一下**下一步]**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-525">On hello **Select Databases** page, select **MyDB1**, and then click **Next**.</span></span> <span data-ttu-id="b8dd9-526">由於您已執行至少一個完整備份 hello 預定的主要複本上，hello 資料庫會符合可用性群組的 hello 必要條件。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-526">hello database meets hello prerequisites for an availability group because you have taken at least one full backup on hello intended primary replica.</span></span>
   
    ![新增可用性群組精靈：選取資料庫](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665525.gif)
4. <span data-ttu-id="b8dd9-528">在 hello**指定複本**頁面上，按一下**將複本加入**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-528">on hello **Specify Replicas** page, click **Add Replica**.</span></span>
   
    ![新增可用性群組精靈：選取複本](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665526.gif)
5. <span data-ttu-id="b8dd9-530">在 hello**連接 tooServer**  對話方塊中，輸入**ContosoSQL2**中**伺服器名稱**，然後按一下**連接**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-530">In hello **Connect tooServer** dialog box, type **ContosoSQL2** in **Server name**, and then click **Connect**.</span></span>
   
    ![新的可用性群組精靈 連接 tooserver](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665527.gif)
6. <span data-ttu-id="b8dd9-532">在 hello**指定複本**頁面上，您現在應該會看到**ContosoSQL2**中所列**可用複本**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-532">Back on hello **Specify Replicas** page, you should now see **ContosoSQL2** listed in **Available Replicas**.</span></span> <span data-ttu-id="b8dd9-533">Hello 複本設定 hello 下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-533">Configure hello replicas as shown in hello following screenshot.</span></span> <span data-ttu-id="b8dd9-534">完成後，請按 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-534">When you are finished, click **Next**.</span></span>
   
    ![新增可用性群組精靈：選取複本 (完整)](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665528.gif)
7. <span data-ttu-id="b8dd9-536">在 hello**選取初始資料同步處理**頁面上，選取**僅聯結**，然後按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-536">On hello **Select Initial Data Synchronization** page, select **Join only**, and then click **Next**.</span></span> <span data-ttu-id="b8dd9-537">您已執行資料同步處理以手動方式上進行 hello 完整和交易備份時**ContosoSQL1**還原它們**ContosoSQL2**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-537">You already performed data synchronization manually when you made hello full and transaction backups on **ContosoSQL1** and restored them on **ContosoSQL2**.</span></span> <span data-ttu-id="b8dd9-538">您可以選擇不 tooperform hello 在資料庫上的備份和還原作業，而是選取**完整**toolet hello 新增可用性群組精靈為您執行資料同步處理。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-538">You can choose not tooperform hello backup and restore operations on your database and instead select **Full** toolet hello New Availability Group Wizard perform data synchronization for you.</span></span> <span data-ttu-id="b8dd9-539">不過，我們不建議針對某些企業中的超大型資料庫採用這種選項。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-539">However, we do not recommend this option for very large databases that are found in some enterprises.</span></span>
   
    ![新增可用性群組精靈：選取初始資料同步處理](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665529.gif)
8. <span data-ttu-id="b8dd9-541">在 hello**驗證**頁面上，按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-541">On hello **Validation** page, click **Next**.</span></span> <span data-ttu-id="b8dd9-542">此頁面應看起來類似 toohello 下列螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-542">This page should look similar toohello following screenshot.</span></span> <span data-ttu-id="b8dd9-543">沒有 hello 接聽程式設定的警告，因為您尚未設定可用性群組接聽程式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-543">There is a warning for hello listener configuration because you have not configured an availability group listener.</span></span> <span data-ttu-id="b8dd9-544">您可以忽略此警告，因為本教學課程不會示範設定接聽程式的步驟。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-544">You can ignore this warning, because this tutorial does not configure a listener.</span></span> <span data-ttu-id="b8dd9-545">tooconfigure hello 接聽程式之後您完成這個教學課程，請參閱[在 Azure 中設定 Alwayson 可用性群組的 ILB 接聽程式](../classic/ps-sql-int-listener.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-545">tooconfigure hello listener after you complete this tutorial, see [Configure an ILB listener for Always On Availability Groups in Azure](../classic/ps-sql-int-listener.md).</span></span>
   
    ![新增可用性群組精靈：驗證](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665530.gif)
9. <span data-ttu-id="b8dd9-547">在 hello**摘要**頁面上，按一下**完成**，hello 精靈設定 hello 新可用性群組，然後等候。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-547">On hello **Summary** page, click **Finish**, and then wait while hello wizard configures hello new availability group.</span></span> <span data-ttu-id="b8dd9-548">在 [hello**進度**] 頁面上，您可以按一下**更多詳細資料**tooview hello 詳細進度。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-548">On hello **Progress** page, you can click **More details** tooview hello detailed progress.</span></span> <span data-ttu-id="b8dd9-549">Hello 精靈完成後，檢查 hello**結果**頁面 tooverify 該 hello 可用性群組建立成功時 hello 下列螢幕擷取畫面所示，然後按一下**關閉**tooexit hello精靈。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-549">After hello wizard finishes, inspect hello **Results** page tooverify that hello availability group is successfully created, as shown in hello following screenshot, and then click **Close** tooexit hello wizard.</span></span>
   
    ![新增可用性群組精靈：結果](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665531.gif)
10. <span data-ttu-id="b8dd9-551">在 [物件總管]  中，展開 [AlwaysOn 高可用性] ，再展開 [可用性群組] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-551">In **Object Explorer**, expand **Always On High Availability**, and then expand **Availability Groups**.</span></span> <span data-ttu-id="b8dd9-552">您現在應該會看到此容器中的 hello 新可用性群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-552">You should now see hello new availability group in this container.</span></span> <span data-ttu-id="b8dd9-553">以滑鼠右鍵按一下 [AG1 (主要)] ，再按一下 [顯示儀表板] 。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-553">Right-click **AG1 (Primary)**, and then click **Show Dashboard**.</span></span>
    
     ![顯示可用性群組儀表板](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665532.gif)
11. <span data-ttu-id="b8dd9-555">您**Alwayson 儀表板**應該外觀類似 toohello 一個 hello 在下列螢幕擷取畫面。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-555">Your **Always On Dashboard** should look similar toohello one in hello following screenshot.</span></span> <span data-ttu-id="b8dd9-556">您可以看到 hello 複本，每個複本和 hello 同步處理狀態的 hello 容錯移轉模式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-556">You can see hello replicas, hello failover mode of each replica, and hello synchronization state.</span></span>
    
     ![可用性群組儀表板](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665533.gif)
12. <span data-ttu-id="b8dd9-558">傳回太**伺服器管理員**，按一下 **工具**，然後開啟**容錯移轉叢集管理員**。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-558">Return too**Server Manager**, click **Tools**, and then open **Failover Cluster Manager**.</span></span>
13. <span data-ttu-id="b8dd9-559">展開 [Cluster1.corp.contoso.com]，然後展開 [服務和應用程式]。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-559">Expand **Cluster1.corp.contoso.com**, and then expand **Services and applications**.</span></span> <span data-ttu-id="b8dd9-560">選取**角色**並記下該 hello **AG1**已建立可用性群組的角色。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-560">Select **Roles** and note that hello **AG1** availability group role has been created.</span></span> <span data-ttu-id="b8dd9-561">請注意，AG1 並沒有 IP 位址供資料庫用戶端可以連線 toohello 可用性群組，因為您並未設定接聽程式。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-561">Note that AG1 does not have an IP address by which database clients can connect toohello availability group, because you did not configure a listener.</span></span> <span data-ttu-id="b8dd9-562">Toohello 讀取-寫入作業的主要節點和唯讀查詢的 hello 次要節點，您可以直接連接。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-562">You can connect directly toohello primary node for read-write operations and hello secondary node for read-only queries.</span></span>
    
     ![容錯移轉叢集管理員中的 AG](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665534.gif)

> [!WARNING]
> <span data-ttu-id="b8dd9-564">請勿嘗試 toofail 移轉 hello 從 hello 容錯移轉叢集管理員的可用性群組。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-564">Do not try toofail over hello availability group from hello Failover Cluster Manager.</span></span> <span data-ttu-id="b8dd9-565">所有容錯移轉作業都應在 SQL Server Management Studio 的 [AlwaysOn 儀表板]  中執行。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-565">All failover operations should be performed from within **Always On Dashboard** in SQL Server Management Studio.</span></span> <span data-ttu-id="b8dd9-566">如需詳細資訊，請參閱[限制使用 hello 與可用性群組容錯移轉叢集管理員](https://msdn.microsoft.com/library/ff929171.aspx)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-566">For more information, see [Restrictions on Using hello Failover Cluster Manager with Availability Groups](https://msdn.microsoft.com/library/ff929171.aspx).</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="b8dd9-567">後續步驟</span><span class="sxs-lookup"><span data-stu-id="b8dd9-567">Next steps</span></span>
<span data-ttu-id="b8dd9-568">現在，您已透過在 Azure 中建立可用性群組的方式，成功實作 SQL Server Always On。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-568">You have now successfully implemented SQL Server Always On by creating an availability group in Azure.</span></span> <span data-ttu-id="b8dd9-569">tooconfigure 這個可用性群組接聽程式，請參閱[在 Azure 中設定 Alwayson 可用性群組的 ILB 接聽程式](../classic/ps-sql-int-listener.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-569">tooconfigure a listener for this availability group, see [Configure an ILB listener for Always On availability groups in Azure](../classic/ps-sql-int-listener.md).</span></span>

<span data-ttu-id="b8dd9-570">如需在 Azure 中使用 SQL Server 的其他資訊，請參閱 [Azure 虛擬機器上的 SQL Server](../sql/virtual-machines-windows-sql-server-iaas-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b8dd9-570">For other information about using SQL Server in Azure, see [SQL Server on Azure Virtual Machines](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

