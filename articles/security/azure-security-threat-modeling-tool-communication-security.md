---
title: "通訊安全性 - Microsoft 威脅模型化工具 - Azure | Microsoft Docs"
description: "降低威脅模型化工具所暴露的威脅"
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: b85003a94df3b97f5c64eb3b7e62071f07674c5e
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-communication-security--mitigations"></a><span data-ttu-id="ac4fd-103">安全性架構︰通訊安全性 | 風險降低</span><span class="sxs-lookup"><span data-stu-id="ac4fd-103">Security Frame: Communication Security | Mitigations</span></span> 
| <span data-ttu-id="ac4fd-104">產品/服務</span><span class="sxs-lookup"><span data-stu-id="ac4fd-104">Product/Service</span></span> | <span data-ttu-id="ac4fd-105">文章</span><span class="sxs-lookup"><span data-stu-id="ac4fd-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="ac4fd-106">**Azure 事件中樞**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-106">**Azure Event Hub**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-107">使用 SSL/TLS 保護與事件中樞的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-107">Secure communication to Event Hub using SSL/TLS</span></span>](#comm-ssltls)</li></ul> |
| <span data-ttu-id="ac4fd-108">**Dynamics CRM**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-108">**Dynamics CRM**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-109">檢查服務帳戶權限，並確認自訂服務或 ASP.NET 網頁採用 CRM 的安全性</span><span class="sxs-lookup"><span data-stu-id="ac4fd-109">Check service account privileges and check that the custom Services or ASP.NET Pages respect CRM's security</span></span>](#priv-aspnet)</li></ul> |
| <span data-ttu-id="ac4fd-110">**Azure Data Factory**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-110">**Azure Data Factory**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-111">在將內部部署 SQL Server 連線至 Azure Data Factory 時使用資料管理閘道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-111">Use Data management gateway while connecting On Prem SQL Server to Azure Data Factory</span></span>](#sqlserver-factory)</li></ul> |
| <span data-ttu-id="ac4fd-112">**Identity Server**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-112">**Identity Server**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-113">確定前往 Identity Server 的所有流量都是透過 HTTPS 連線</span><span class="sxs-lookup"><span data-stu-id="ac4fd-113">Ensure that all traffic to Identity Server is over HTTPS connection</span></span>](#identity-https)</li></ul> |
| <span data-ttu-id="ac4fd-114">**Web 應用程式**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-114">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-115">驗證用來驗證 SSL、TLS 及 DTLS 連線的 X.509 憑證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-115">Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections</span></span>](#x509-ssltls)</li><li>[<span data-ttu-id="ac4fd-116">在 Azure App Service 中設定自訂網域的 SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-116">Configure SSL certificate for custom domain in Azure App Service</span></span>](#ssl-appservice)</li><li>[<span data-ttu-id="ac4fd-117">強制所有前往 Azure App Service 的流量透過 HTTPS 連線來進行</span><span class="sxs-lookup"><span data-stu-id="ac4fd-117">Force all traffic to Azure App Service over HTTPS connection</span></span>](#appservice-https)</li><li>[<span data-ttu-id="ac4fd-118">啟用 HTTP Strict Transport Security (HSTS)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-118">Enable HTTP Strict Transport Security (HSTS)</span></span>](#http-hsts)</li></ul> |
| <span data-ttu-id="ac4fd-119">**資料庫**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-119">**Database**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-120">啟用 SQL Server 連線加密和憑證驗證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-120">Ensure SQL server connection encryption and certificate validation</span></span>](#sqlserver-validation)</li><li>[<span data-ttu-id="ac4fd-121">強制加密與 SQL Server 的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-121">Force Encrypted communication to SQL server</span></span>](#encrypted-sqlserver)</li></ul> |
| <span data-ttu-id="ac4fd-122">**Azure 儲存體**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-122">**Azure Storage**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-123">確定對 Azure 儲存體的通訊是透過 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-123">Ensure that communication to Azure Storage is over HTTPS</span></span>](#comm-storage)</li><li>[<span data-ttu-id="ac4fd-124">如果無法啟用 HTTPS，則在下載 Blob 之後驗證 MD5 雜湊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-124">Validate MD5 hash after downloading blob if HTTPS cannot be enabled</span></span>](#md5-https)</li><li>[<span data-ttu-id="ac4fd-125">使用 SMB 3.0 相容用戶端來確保要傳輸到 Azure 檔案共用的資料會加密</span><span class="sxs-lookup"><span data-stu-id="ac4fd-125">Use SMB 3.0 compatible client to ensure in-transit data encryption to Azure File Shares</span></span>](#smb-shares)</li></ul> |
| <span data-ttu-id="ac4fd-126">**行動用戶端**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-126">**Mobile Client**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-127">實作憑證釘選</span><span class="sxs-lookup"><span data-stu-id="ac4fd-127">Implement Certificate Pinning</span></span>](#cert-pinning)</li></ul> |
| <span data-ttu-id="ac4fd-128">**WCF**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-128">**WCF**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-129">啟用 HTTPS - 安全傳輸通道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-129">Enable HTTPS - Secure Transport channel</span></span>](#https-transport)</li><li>[<span data-ttu-id="ac4fd-130">WCF︰將訊息安全性保護層級設定為 EncryptAndSign</span><span class="sxs-lookup"><span data-stu-id="ac4fd-130">WCF: Set Message security Protection level to EncryptAndSign</span></span>](#message-protection)</li><li>[<span data-ttu-id="ac4fd-131">WCF︰使用最低權限帳戶來執行 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="ac4fd-131">WCF: Use a least-privileged account to run your WCF service</span></span>](#least-account-wcf)</li></ul> |
| <span data-ttu-id="ac4fd-132">**Web API**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-132">**Web API**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-133">強制所有前往 Web API 的流量透過 HTTPS 連線來進行</span><span class="sxs-lookup"><span data-stu-id="ac4fd-133">Force all traffic to Web APIs over HTTPS connection</span></span>](#webapi-https)</li></ul> |
| <span data-ttu-id="ac4fd-134">**Azure Redis 快取**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-134">**Azure Redis Cache**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-135">確定對 Azure Redis 快取的通訊是透過 SSL</span><span class="sxs-lookup"><span data-stu-id="ac4fd-135">Ensure that communication to Azure Redis Cache is over SSL</span></span>](#redis-ssl)</li></ul> |
| <span data-ttu-id="ac4fd-136">**IoT 現場閘道**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-136">**IoT Field Gateway**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-137">保護裝置對現場閘道的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-137">Secure Device to Field Gateway communication</span></span>](#device-field)</li></ul> |
| <span data-ttu-id="ac4fd-138">**IoT 雲端閘道**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-138">**IoT Cloud Gateway**</span></span> | <ul><li>[<span data-ttu-id="ac4fd-139">使用 SSL/TLS 保護裝置對雲端閘道的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-139">Secure Device to Cloud Gateway communication using SSL/TLS</span></span>](#device-cloud)</li></ul> |

## <span data-ttu-id="ac4fd-140"><a id="comm-ssltls"></a>使用 SSL/TLS 保護與事件中樞的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-140"><a id="comm-ssltls"></a>Secure communication to Event Hub using SSL/TLS</span></span>

| <span data-ttu-id="ac4fd-141">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-141">Title</span></span>                   | <span data-ttu-id="ac4fd-142">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-142">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-143">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-143">**Component**</span></span>               | <span data-ttu-id="ac4fd-144">Azure 事件中樞</span><span class="sxs-lookup"><span data-stu-id="ac4fd-144">Azure Event Hub</span></span> | 
| <span data-ttu-id="ac4fd-145">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-145">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-146">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-146">Build</span></span> |  
| <span data-ttu-id="ac4fd-147">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-147">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-148">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-148">Generic</span></span> |
| <span data-ttu-id="ac4fd-149">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-149">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-150">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-150">N/A</span></span>  |
| <span data-ttu-id="ac4fd-151">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-151">**References**</span></span>              | [<span data-ttu-id="ac4fd-152">事件中樞驗證和安全性模型概觀</span><span class="sxs-lookup"><span data-stu-id="ac4fd-152">Event Hubs authentication and security model overview</span></span>](https://azure.microsoft.com/documentation/articles/event-hubs-authentication-and-security-model-overview/) |
| <span data-ttu-id="ac4fd-153">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-153">**Steps**</span></span> | <span data-ttu-id="ac4fd-154">使用 SSL/TLS 保護事件中樞的 AMQP 或 HTTP 連線</span><span class="sxs-lookup"><span data-stu-id="ac4fd-154">Secure AMQP or HTTP connections to Event Hub using SSL/TLS</span></span> |

## <span data-ttu-id="ac4fd-155"><a id="priv-aspnet"></a>檢查服務帳戶權限，並確認自訂服務或 ASP.NET 網頁採用 CRM 的安全性</span><span class="sxs-lookup"><span data-stu-id="ac4fd-155"><a id="priv-aspnet"></a>Check service account privileges and check that the custom Services or ASP.NET Pages respect CRM's security</span></span>

| <span data-ttu-id="ac4fd-156">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-156">Title</span></span>                   | <span data-ttu-id="ac4fd-157">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-157">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-158">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-158">**Component**</span></span>               | <span data-ttu-id="ac4fd-159">Dynamics CRM</span><span class="sxs-lookup"><span data-stu-id="ac4fd-159">Dynamics CRM</span></span> | 
| <span data-ttu-id="ac4fd-160">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-160">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-161">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-161">Build</span></span> |  
| <span data-ttu-id="ac4fd-162">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-162">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-163">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-163">Generic</span></span> |
| <span data-ttu-id="ac4fd-164">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-164">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-165">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-165">N/A</span></span>  |
| <span data-ttu-id="ac4fd-166">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-166">**References**</span></span>              | <span data-ttu-id="ac4fd-167">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-167">N/A</span></span>  |
| <span data-ttu-id="ac4fd-168">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-168">**Steps**</span></span> | <span data-ttu-id="ac4fd-169">檢查服務帳戶權限，並確認自訂服務或 ASP.NET 網頁採用 CRM 的安全性</span><span class="sxs-lookup"><span data-stu-id="ac4fd-169">Check service account privileges and check that the custom Services or ASP.NET Pages respect CRM's security</span></span> |

## <span data-ttu-id="ac4fd-170"><a id="sqlserver-factory"></a>在將內部部署 SQL Server 連線至 Azure Data Factory 時使用資料管理閘道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-170"><a id="sqlserver-factory"></a>Use Data management gateway while connecting On Prem SQL Server to Azure Data Factory</span></span>

| <span data-ttu-id="ac4fd-171">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-171">Title</span></span>                   | <span data-ttu-id="ac4fd-172">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-172">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-173">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-173">**Component**</span></span>               | <span data-ttu-id="ac4fd-174">Azure Data Factory</span><span class="sxs-lookup"><span data-stu-id="ac4fd-174">Azure Data Factory</span></span> | 
| <span data-ttu-id="ac4fd-175">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-175">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-176">部署</span><span class="sxs-lookup"><span data-stu-id="ac4fd-176">Deployment</span></span> |  
| <span data-ttu-id="ac4fd-177">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-177">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-178">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-178">Generic</span></span> |
| <span data-ttu-id="ac4fd-179">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-179">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-180">連結服務類型 - Azure 和內部部署</span><span class="sxs-lookup"><span data-stu-id="ac4fd-180">Linked Service Types - Azure and On Prem</span></span> |
| <span data-ttu-id="ac4fd-181">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-181">**References**</span></span>              |<span data-ttu-id="ac4fd-182">[在內部部署與 Azure Data Factory 之間移動資料](https://azure.microsoft.com/documentation/articles/data-factory-move-data-between-onprem-and-cloud/#create-gateway)、[資料管理閘道](https://azure.microsoft.com/documentation/articles/data-factory-data-management-gateway/)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-182">[ Moving data between On Prem and Azure Data Factory](https://azure.microsoft.com/documentation/articles/data-factory-move-data-between-onprem-and-cloud/#create-gateway), [Data management gateway](https://azure.microsoft.com/documentation/articles/data-factory-data-management-gateway/)</span></span> |
| <span data-ttu-id="ac4fd-183">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-183">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-184">必須有資料管理閘道 (DMG) 工具才能連線到受到公司網路或防火牆保護的資料來源。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-184">The Data Management Gateway (DMG) tool is required to connect to data sources which are protected behind corpnet or a firewall.</span></span></p><ol><li><span data-ttu-id="ac4fd-185">鎖定電腦會隔離 DMG 工具，防止資料來源電腦上未正常運作的程式損壞或窺探。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-185">Locking down the machine isolates the DMG tool and prevents malfunctioning programs from damaging or snooping on the data source machine.</span></span> <span data-ttu-id="ac4fd-186">(例如，</span><span class="sxs-lookup"><span data-stu-id="ac4fd-186">(E.g.</span></span> <span data-ttu-id="ac4fd-187">必須安裝最新的更新，啟用最低需求連接埠、受控制的帳戶佈建、啟用稽核、啟用磁碟加密等。)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-187">latest updates must be installed, enable minimum required ports, controlled accounts provisioning, auditing enabled, disk encryption enabled etc.)</span></span></li><li><span data-ttu-id="ac4fd-188">資料閘道金鑰必須經常輪替，或是在每次 DMG 服務帳戶密碼更新時輪替</span><span class="sxs-lookup"><span data-stu-id="ac4fd-188">Data Gateway key must be rotated at frequent intervals or whenever the DMG service account password renews</span></span></li><li><span data-ttu-id="ac4fd-189">必須加密透過連結服務傳輸的資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-189">Data transits through Link Service must be encrypted</span></span></li></ol> |

## <span data-ttu-id="ac4fd-190"><a id="identity-https"></a>確定前往 Identity Server 的所有流量都是透過 HTTPS 連線</span><span class="sxs-lookup"><span data-stu-id="ac4fd-190"><a id="identity-https"></a>Ensure that all traffic to Identity Server is over HTTPS connection</span></span>

| <span data-ttu-id="ac4fd-191">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-191">Title</span></span>                   | <span data-ttu-id="ac4fd-192">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-192">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-193">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-193">**Component**</span></span>               | <span data-ttu-id="ac4fd-194">Identity Server</span><span class="sxs-lookup"><span data-stu-id="ac4fd-194">Identity Server</span></span> | 
| <span data-ttu-id="ac4fd-195">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-195">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-196">部署</span><span class="sxs-lookup"><span data-stu-id="ac4fd-196">Deployment</span></span> |  
| <span data-ttu-id="ac4fd-197">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-197">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-198">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-198">Generic</span></span> |
| <span data-ttu-id="ac4fd-199">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-199">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-200">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-200">N/A</span></span>  |
| <span data-ttu-id="ac4fd-201">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-201">**References**</span></span>              | <span data-ttu-id="ac4fd-202">[IdentityServer3 - 金鑰、簽章和密碼編譯](https://identityserver.github.io/Documentation/docsv2/configuration/crypto.html)、[IdentityServer3 - 部署](https://identityserver.github.io/Documentation/docsv2/advanced/deployment.html)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-202">[IdentityServer3 - Keys, Signatures and Cryptography](https://identityserver.github.io/Documentation/docsv2/configuration/crypto.html), [IdentityServer3 - Deployment](https://identityserver.github.io/Documentation/docsv2/advanced/deployment.html)</span></span> |
| <span data-ttu-id="ac4fd-203">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-203">**Steps**</span></span> | <span data-ttu-id="ac4fd-204">根據預設，IdentityServer 要求所有連入連線必須透過 HTTPS 傳輸過來。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-204">By default, IdentityServer requires all incoming connections to come over HTTPS.</span></span> <span data-ttu-id="ac4fd-205">與 IdentityServer 的通訊絕對必須只透過安全的傳輸來進行。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-205">It is absolutely mandatory that communication with IdentityServer is done over secured transports only.</span></span> <span data-ttu-id="ac4fd-206">某些部署案例 (例如 SSL 卸載) 可以放寬這項需求。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-206">There are certain deployment scenarios like SSL offloading where this requirement can be relaxed.</span></span> <span data-ttu-id="ac4fd-207">如需詳細資訊，請參閱 [參考] 中的 Identity Server 部署頁面。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-207">See the Identity Server deployment page in the references for more information.</span></span> |

## <span data-ttu-id="ac4fd-208"><a id="x509-ssltls"></a>驗證用來驗證 SSL、TLS 及 DTLS 連線的 X.509 憑證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-208"><a id="x509-ssltls"></a>Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections</span></span>

| <span data-ttu-id="ac4fd-209">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-209">Title</span></span>                   | <span data-ttu-id="ac4fd-210">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-210">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-211">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-211">**Component**</span></span>               | <span data-ttu-id="ac4fd-212">Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="ac4fd-212">Web Application</span></span> | 
| <span data-ttu-id="ac4fd-213">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-213">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-214">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-214">Build</span></span> |  
| <span data-ttu-id="ac4fd-215">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-215">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-216">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-216">Generic</span></span> |
| <span data-ttu-id="ac4fd-217">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-217">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-218">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-218">N/A</span></span>  |
| <span data-ttu-id="ac4fd-219">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-219">**References**</span></span>              | <span data-ttu-id="ac4fd-220">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-220">N/A</span></span>  |
| <span data-ttu-id="ac4fd-221">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-221">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-222">使用 SSL、TLS 或 DTLS 的應用程式必須完全驗證其所連線到之實體的 X.509 憑證。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-222">Applications that use SSL, TLS, or DTLS must fully verify the X.509 certificates of the entities they connect to.</span></span> <span data-ttu-id="ac4fd-223">這包括驗證憑證的下列項目︰</span><span class="sxs-lookup"><span data-stu-id="ac4fd-223">This includes verification of the certificates for:</span></span></p><ul><li><span data-ttu-id="ac4fd-224">網域名稱</span><span class="sxs-lookup"><span data-stu-id="ac4fd-224">Domain name</span></span></li><li><span data-ttu-id="ac4fd-225">有效日期 (開始日期和到期日期)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-225">Validity dates (both beginning and expiration dates)</span></span></li><li><span data-ttu-id="ac4fd-226">撤銷狀態</span><span class="sxs-lookup"><span data-stu-id="ac4fd-226">Revocation status</span></span></li><li><span data-ttu-id="ac4fd-227">使用方式 (例如，伺服器使用伺服器驗證、用戶端使用用戶端驗證)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-227">Usage (for example, Server Authentication for servers, Client Authentication for clients)</span></span></li><li><span data-ttu-id="ac4fd-228">信任鏈結。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-228">Trust chain.</span></span> <span data-ttu-id="ac4fd-229">憑證必須鏈結至平台所信任或系統管理員所明確設定的根憑證授權單位 (CA)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-229">Certificates must chain to a root certification authority (CA) that is trusted by the platform or explicitly configured by the administrator</span></span></li><li><span data-ttu-id="ac4fd-230">憑證的公開金鑰長度必須 > 2048 位元</span><span class="sxs-lookup"><span data-stu-id="ac4fd-230">Key length of certificate's public key must be >2048 bits</span></span></li><li><span data-ttu-id="ac4fd-231">雜湊演算法必須是 SHA256 或以上版本</span><span class="sxs-lookup"><span data-stu-id="ac4fd-231">Hashing algorithm must be SHA256 and above</span></span> |

## <span data-ttu-id="ac4fd-232"><a id="ssl-appservice"></a>在 Azure App Service 中設定自訂網域的 SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-232"><a id="ssl-appservice"></a>Configure SSL certificate for custom domain in Azure App Service</span></span>

| <span data-ttu-id="ac4fd-233">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-233">Title</span></span>                   | <span data-ttu-id="ac4fd-234">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-234">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-235">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-235">**Component**</span></span>               | <span data-ttu-id="ac4fd-236">Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="ac4fd-236">Web Application</span></span> | 
| <span data-ttu-id="ac4fd-237">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-237">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-238">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-238">Build</span></span> |  
| <span data-ttu-id="ac4fd-239">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-239">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-240">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-240">Generic</span></span> |
| <span data-ttu-id="ac4fd-241">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-241">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-242">EnvironmentType - Azure</span><span class="sxs-lookup"><span data-stu-id="ac4fd-242">EnvironmentType - Azure</span></span> |
| <span data-ttu-id="ac4fd-243">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-243">**References**</span></span>              | [<span data-ttu-id="ac4fd-244">針對 Azure App Service 中的 App 啟用 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-244">Enable HTTPS for an app in Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-configure-ssl-certificate/) |
| <span data-ttu-id="ac4fd-245">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-245">**Steps**</span></span> | <span data-ttu-id="ac4fd-246">根據預設，Azure 已使用 *.azurewebsites.net 網域的萬用字元憑證來啟用每一個應用程式的 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-246">By default, Azure already enables HTTPS for every app with a wildcard certificate for the *.azurewebsites.net domain.</span></span> <span data-ttu-id="ac4fd-247">但是，就像所有萬用字元網域一樣，這並不如使用自訂網域搭配自己的憑證那麼安全。[參閱](https://casecurity.org/2014/02/26/pros-and-cons-of-single-domain-multi-domain-and-wildcard-certificates/)。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-247">However, like all wildcard domains, it is not as secure as using a custom domain with own certificate [Refer](https://casecurity.org/2014/02/26/pros-and-cons-of-single-domain-multi-domain-and-wildcard-certificates/).</span></span> <span data-ttu-id="ac4fd-248">建議您針對要透過其存取已部署應用程式的自訂網域啟用 SSL</span><span class="sxs-lookup"><span data-stu-id="ac4fd-248">It is recommended to enable SSL for the custom domain which the deployed app will be accessed through</span></span>|

## <span data-ttu-id="ac4fd-249"><a id="appservice-https"></a>強制所有前往 Azure App Service 的流量透過 HTTPS 連線來進行</span><span class="sxs-lookup"><span data-stu-id="ac4fd-249"><a id="appservice-https"></a>Force all traffic to Azure App Service over HTTPS connection</span></span>

| <span data-ttu-id="ac4fd-250">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-250">Title</span></span>                   | <span data-ttu-id="ac4fd-251">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-251">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-252">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-252">**Component**</span></span>               | <span data-ttu-id="ac4fd-253">Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="ac4fd-253">Web Application</span></span> | 
| <span data-ttu-id="ac4fd-254">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-254">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-255">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-255">Build</span></span> |  
| <span data-ttu-id="ac4fd-256">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-256">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-257">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-257">Generic</span></span> |
| <span data-ttu-id="ac4fd-258">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-258">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-259">EnvironmentType - Azure</span><span class="sxs-lookup"><span data-stu-id="ac4fd-259">EnvironmentType - Azure</span></span> |
| <span data-ttu-id="ac4fd-260">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-260">**References**</span></span>              | <span data-ttu-id="ac4fd-261">[對 Azure App Service 強制使用 HTTPS]https://azure.microsoft.com/documentation/articles/web-sites-configure-ssl-certificate/#4-enforce-https-on-your-app)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-261">[Enforce HTTPS on Azure App Service]https://azure.microsoft.com/documentation/articles/web-sites-configure-ssl-certificate/#4-enforce-https-on-your-app)</span></span> |
| <span data-ttu-id="ac4fd-262">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-262">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-263">雖然 Azure 已使用 *.azurewebsites.net 網域的萬用字元憑證來啟用 Azure App Service 的 HTTPS，但它不會強制使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-263">Though Azure already enables HTTPS for Azure app services with a wildcard certificate for the domain *.azurewebsites.net, it do not enforce HTTPS.</span></span> <span data-ttu-id="ac4fd-264">訪客可能仍會使用 HTTP 存取應用程式，而危及應用程式的安全性，因此您必須明確地強制使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-264">Visitors may still access the app using HTTP, which may compromise the app's security and hence HTTPS has to be enforced explicitly.</span></span> <span data-ttu-id="ac4fd-265">ASP.NET MVC 應用程式應使用 [RequireHttps 篩選](http://msdn.microsoft.com/library/system.web.mvc.requirehttpsattribute.aspx) 來強迫不安全的 HTTP 要求透過 HTTPS 重新傳送。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-265">ASP.NET MVC applications should use the [RequireHttps filter](http://msdn.microsoft.com/library/system.web.mvc.requirehttpsattribute.aspx) that forces an unsecured HTTP request to be re-sent over HTTPS.</span></span></p><p><span data-ttu-id="ac4fd-266">或者，您也可以使用 Azure App Service 隨附的 URL Rewrite 模組來強制使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-266">Alternatively, the URL Rewrite module, which is included with Azure App Service can be used to enforce HTTPS.</span></span> <span data-ttu-id="ac4fd-267">URL Rewrite 模組可讓開發人員定義連入要求在送達應用程式之前要套用的規則。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-267">URL Rewrite module enables developers to define rules that are applied to incoming requests before the requests are handed to your application.</span></span> <span data-ttu-id="ac4fd-268">您可以在儲存於應用程式根目錄的 web.config 檔案中定義 URL Rewrite 規則</span><span class="sxs-lookup"><span data-stu-id="ac4fd-268">URL Rewrite rules are defined in a web.config file stored in the root of the application</span></span></p>|

### <a name="example"></a><span data-ttu-id="ac4fd-269">範例</span><span class="sxs-lookup"><span data-stu-id="ac4fd-269">Example</span></span>
<span data-ttu-id="ac4fd-270">下列範例包含可強制所有連入流量使用 HTTPS 的基本 URL Rewrite 規則</span><span class="sxs-lookup"><span data-stu-id="ac4fd-270">The following example contains a basic URL Rewrite rule that forces all incoming traffic to use HTTPS</span></span>
```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <rule name="Force HTTPS" enabled="true">
          <match url="(.*)" ignoreCase="false" />
          <conditions>
            <add input="{HTTPS}" pattern="off" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" appendQueryString="true" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
  </system.webServer>
</configuration>
```
<span data-ttu-id="ac4fd-271">此規則的運作方式是當使用者使用 HTTP 要求頁面時，便傳回 HTTP 狀態碼 301 (永久重新導向)。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-271">This rule works by returning an HTTP status code of 301 (permanent redirect) when the user requests a page using HTTP.</span></span> <span data-ttu-id="ac4fd-272">301 會將要求重新導向至與訪客要求相同的 URL，但使用 HTTPS 來取代要求的 HTTP 部分。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-272">The 301 redirects the request to the same URL as the visitor requested, but replaces the HTTP portion of the request with HTTPS.</span></span> <span data-ttu-id="ac4fd-273">例如，HTTP://contoso.com 會被重新導向至 HTTPS://contoso.com。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-273">For example, HTTP://contoso.com would be redirected to HTTPS://contoso.com.</span></span> 

## <span data-ttu-id="ac4fd-274"><a id="http-hsts"></a>啟用 HTTP Strict Transport Security (HSTS)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-274"><a id="http-hsts"></a>Enable HTTP Strict Transport Security (HSTS)</span></span>

| <span data-ttu-id="ac4fd-275">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-275">Title</span></span>                   | <span data-ttu-id="ac4fd-276">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-276">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-277">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-277">**Component**</span></span>               | <span data-ttu-id="ac4fd-278">Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="ac4fd-278">Web Application</span></span> | 
| <span data-ttu-id="ac4fd-279">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-279">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-280">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-280">Build</span></span> |  
| <span data-ttu-id="ac4fd-281">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-281">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-282">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-282">Generic</span></span> |
| <span data-ttu-id="ac4fd-283">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-283">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-284">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-284">N/A</span></span>  |
| <span data-ttu-id="ac4fd-285">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-285">**References**</span></span>              | [<span data-ttu-id="ac4fd-286">OWASP HTTP Strict Transport Security 功能提要</span><span class="sxs-lookup"><span data-stu-id="ac4fd-286">OWASP HTTP Strict Transport Security Cheat Sheet</span></span>](https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet) |
| <span data-ttu-id="ac4fd-287">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-287">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-288">HTTP Strict Transport Security (HSTS) 是可供選擇加入的安全性增強功能，可由 Web 應用程式透過使用特殊的回應標頭來指定。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-288">HTTP Strict Transport Security (HSTS) is an opt-in security enhancement that is specified by a web application through the use of a special response header.</span></span> <span data-ttu-id="ac4fd-289">支援的瀏覽器在收到此標頭之後，該瀏覽器會防止任何通訊透過 HTTP 傳送到指定網域，並改為透過 HTTPS 傳送所有通訊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-289">Once a supported browser receives this header that browser will prevent any communications from being sent over HTTP to the specified domain and will instead send all communications over HTTPS.</span></span> <span data-ttu-id="ac4fd-290">它也可以防止瀏覽器上出現 HTTPS 點選提示。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-290">It also prevents HTTPS click through prompts on browsers.</span></span></p><p><span data-ttu-id="ac4fd-291">若要實作 HSTS，必須在網站全域設定下列回應標頭，不論是設定於程式碼或組態中。Strict-Transport-Security: max-age=300；includeSubDomains HSTS 可應付下列威脅：</span><span class="sxs-lookup"><span data-stu-id="ac4fd-291">To implement HSTS, the following response header has to be configured for a website globally, either in code or in config. Strict-Transport-Security: max-age=300; includeSubDomains HSTS addresses the following threats:</span></span></p><ul><li><span data-ttu-id="ac4fd-292">使用者手動輸入 http://example.com 或將其設定為書籤，而且容易受到攔截式攻擊者的危害︰HSTS 會自動將目標網域的 HTTP 要求重新導向至 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-292">User bookmarks or manually types http://example.com and is subject to a man-in-the-middle attacker: HSTS automatically redirects HTTP requests to HTTPS for the target domain</span></span></li><li><span data-ttu-id="ac4fd-293">預計只能使用 HTTPS 的 Web 應用程式不慎包含 HTTP 連結或透過 HTTP 提供內容︰HSTS 會自動將目標網域的 HTTP 要求重新導向至 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-293">Web application that is intended to be purely HTTPS inadvertently contains HTTP links or serves content over HTTP: HSTS automatically redirects HTTP requests to HTTPS for the target domain</span></span></li><li><span data-ttu-id="ac4fd-294">攔截式攻擊者嘗試使用無效憑證攔截受害使用者的流量，並希望使用者會接受不正確的憑證︰HSTS 不允許使用者覆寫無效的憑證訊息</span><span class="sxs-lookup"><span data-stu-id="ac4fd-294">A man-in-the-middle attacker attempts to intercept traffic from a victim user using an invalid certificate and hopes the user will accept the bad certificate: HSTS does not allow a user to override the invalid certificate message</span></span></li></ul>|

## <span data-ttu-id="ac4fd-295"><a id="sqlserver-validation"></a>啟用 SQL Server 連線加密和憑證驗證</span><span class="sxs-lookup"><span data-stu-id="ac4fd-295"><a id="sqlserver-validation"></a>Ensure SQL server connection encryption and certificate validation</span></span>

| <span data-ttu-id="ac4fd-296">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-296">Title</span></span>                   | <span data-ttu-id="ac4fd-297">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-297">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-298">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-298">**Component**</span></span>               | <span data-ttu-id="ac4fd-299">資料庫</span><span class="sxs-lookup"><span data-stu-id="ac4fd-299">Database</span></span> | 
| <span data-ttu-id="ac4fd-300">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-300">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-301">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-301">Build</span></span> |  
| <span data-ttu-id="ac4fd-302">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-302">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-303">SQL Azure</span><span class="sxs-lookup"><span data-stu-id="ac4fd-303">SQL Azure</span></span>  |
| <span data-ttu-id="ac4fd-304">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-304">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-305">SQL 版本 - V12</span><span class="sxs-lookup"><span data-stu-id="ac4fd-305">SQL Version - V12</span></span> |
| <span data-ttu-id="ac4fd-306">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-306">**References**</span></span>              | [<span data-ttu-id="ac4fd-307">為 SQL Database 撰寫安全連接字串的最佳作法</span><span class="sxs-lookup"><span data-stu-id="ac4fd-307">Best Practices on Writing Secure Connection Strings for SQL Database</span></span>](http://social.technet.microsoft.com/wiki/contents/articles/2951.windows-azure-sql-database-connection-security.aspx#best) |
| <span data-ttu-id="ac4fd-308">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-308">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-309">SQL Database 和用戶端應用程式之間的所有通訊永遠都會使用安全通訊端層 (SSL) 來加密。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-309">All communications between SQL Database and a client application are encrypted using Secure Sockets Layer (SSL) at all times.</span></span> <span data-ttu-id="ac4fd-310">SQL Database 不支援未加密連線。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-310">SQL Database doesn’t support unencrypted connections.</span></span> <span data-ttu-id="ac4fd-311">若要使用應用程式程式碼或工具驗證憑證，請明確地要求加密的連接，並且不要信任伺服器憑證。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-311">To validate certificates with application code or tools, explicitly request an encrypted connection and do not trust the server certificates.</span></span> <span data-ttu-id="ac4fd-312">即使您的應用程式程式碼或工具未要求加密連線，它們仍然會接收加密的連線</span><span class="sxs-lookup"><span data-stu-id="ac4fd-312">If your application code or tools do not request an encrypted connection, they will still receive encrypted connections</span></span></p><p><span data-ttu-id="ac4fd-313">不過，它們可能不會驗證伺服器憑證，這樣一來很容易受到「攔截式」攻擊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-313">However, they may not validate the server certificates and thus will be susceptible to "man in the middle" attacks.</span></span> <span data-ttu-id="ac4fd-314">若要使用 ADO.NET 應用程式程式碼驗證憑證，請在資料庫連接字串中設定 `Encrypt=True` 和 `TrustServerCertificate=False`。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-314">To validate certificates with ADO.NET application code, set `Encrypt=True` and `TrustServerCertificate=False` in the database connection string.</span></span> <span data-ttu-id="ac4fd-315">若要透過 SQL Server Management Studio 驗證憑證，請開啟 [連線至伺服器] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-315">To validate certificates via SQL Server Management Studio, open the Connect to Server dialog box.</span></span> <span data-ttu-id="ac4fd-316">按一下 [連線屬性] 索引標籤上的 [加密連線]</span><span class="sxs-lookup"><span data-stu-id="ac4fd-316">Click Encrypt connection on the Connection Properties tab</span></span></p>|

## <span data-ttu-id="ac4fd-317"><a id="encrypted-sqlserver"></a>強制加密與 SQL Server 的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-317"><a id="encrypted-sqlserver"></a>Force Encrypted communication to SQL server</span></span>

| <span data-ttu-id="ac4fd-318">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-318">Title</span></span>                   | <span data-ttu-id="ac4fd-319">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-319">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-320">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-320">**Component**</span></span>               | <span data-ttu-id="ac4fd-321">資料庫</span><span class="sxs-lookup"><span data-stu-id="ac4fd-321">Database</span></span> | 
| <span data-ttu-id="ac4fd-322">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-322">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-323">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-323">Build</span></span> |  
| <span data-ttu-id="ac4fd-324">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-324">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-325">OnPrem</span><span class="sxs-lookup"><span data-stu-id="ac4fd-325">OnPrem</span></span> |
| <span data-ttu-id="ac4fd-326">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-326">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-327">SQL 版本 - MsSQL2016、SQL 版本 - MsSQL2012、SQL 版本 - MsSQL2014</span><span class="sxs-lookup"><span data-stu-id="ac4fd-327">SQL Version - MsSQL2016, SQL Version - MsSQL2012, SQL Version - MsSQL2014</span></span> |
| <span data-ttu-id="ac4fd-328">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-328">**References**</span></span>              | [<span data-ttu-id="ac4fd-329">啟用 Database Engine 的加密連線</span><span class="sxs-lookup"><span data-stu-id="ac4fd-329">Enable Encrypted Connections to the Database Engine</span></span>](https://msdn.microsoft.com/library/ms191192)  |
| <span data-ttu-id="ac4fd-330">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-330">**Steps**</span></span> | <span data-ttu-id="ac4fd-331">啟用 SSL 加密可提高 SQL Server 執行個體和應用程式之間跨網路傳輸之資料的安全性。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-331">Enabling SSL encryption increases the security of data transmitted across networks between instances of SQL Server and applications.</span></span> |

## <span data-ttu-id="ac4fd-332"><a id="comm-storage"></a>確定對 Azure 儲存體的通訊是透過 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-332"><a id="comm-storage"></a>Ensure that communication to Azure Storage is over HTTPS</span></span>

| <span data-ttu-id="ac4fd-333">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-333">Title</span></span>                   | <span data-ttu-id="ac4fd-334">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-334">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-335">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-335">**Component**</span></span>               | <span data-ttu-id="ac4fd-336">Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="ac4fd-336">Azure Storage</span></span> | 
| <span data-ttu-id="ac4fd-337">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-337">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-338">部署</span><span class="sxs-lookup"><span data-stu-id="ac4fd-338">Deployment</span></span> |  
| <span data-ttu-id="ac4fd-339">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-339">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-340">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-340">Generic</span></span> |
| <span data-ttu-id="ac4fd-341">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-341">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-342">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-342">N/A</span></span>  |
| <span data-ttu-id="ac4fd-343">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-343">**References**</span></span>              | [<span data-ttu-id="ac4fd-344">Azure 儲存體傳輸層級加密 – 使用 HTTPS</span><span class="sxs-lookup"><span data-stu-id="ac4fd-344">Azure Storage Transport-Level Encryption – Using HTTPS</span></span>](https://azure.microsoft.com/documentation/articles/storage-security-guide/#_encryption-in-transit) |
| <span data-ttu-id="ac4fd-345">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-345">**Steps**</span></span> | <span data-ttu-id="ac4fd-346">若要確保傳輸中 Azure 儲存體資料的安全性，請在呼叫 REST API 或存取儲存體中的物件時一律使用 HTTPS 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-346">To ensure the security of Azure Storage data in-transit, always use the HTTPS protocol when calling the REST APIs or accessing objects in storage.</span></span> <span data-ttu-id="ac4fd-347">此外，共用存取簽章 (可用來委派 Azure 儲存體物件的存取權) 包含一個選項，可指定在使用共用存取簽章時只能使用 HTTPS 通訊協定，以確保任何使用 SAS 權杖送出連結的人都將使用正確的通訊協定。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-347">Also, Shared Access Signatures, which can be used to delegate access to Azure Storage objects, include an option to specify that only the HTTPS protocol can be used when using Shared Access Signatures, ensuring that anybody sending out links with SAS tokens will use the proper protocol.</span></span>|

## <span data-ttu-id="ac4fd-348"><a id="md5-https"></a>如果無法啟用 HTTPS，則在下載 Blob 之後驗證 MD5 雜湊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-348"><a id="md5-https"></a>Validate MD5 hash after downloading blob if HTTPS cannot be enabled</span></span>

| <span data-ttu-id="ac4fd-349">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-349">Title</span></span>                   | <span data-ttu-id="ac4fd-350">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-350">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-351">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-351">**Component**</span></span>               | <span data-ttu-id="ac4fd-352">Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="ac4fd-352">Azure Storage</span></span> | 
| <span data-ttu-id="ac4fd-353">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-353">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-354">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-354">Build</span></span> |  
| <span data-ttu-id="ac4fd-355">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-355">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-356">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-356">Generic</span></span> |
| <span data-ttu-id="ac4fd-357">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-357">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-358">StorageType - Blob</span><span class="sxs-lookup"><span data-stu-id="ac4fd-358">StorageType - Blob</span></span> |
| <span data-ttu-id="ac4fd-359">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-359">**References**</span></span>              | [<span data-ttu-id="ac4fd-360">Windows Azure Blob MD5 概觀</span><span class="sxs-lookup"><span data-stu-id="ac4fd-360">Windows Azure Blob MD5 Overview</span></span>](https://blogs.msdn.microsoft.com/windowsazurestorage/2011/02/17/windows-azure-blob-md5-overview/) |
| <span data-ttu-id="ac4fd-361">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-361">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-362">Windows Azure Blob 服務會提供相關機制來確保應用程式和傳輸層的資料完整性。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-362">Windows Azure Blob service provides mechanisms to ensure data integrity both at the application and transport layers.</span></span> <span data-ttu-id="ac4fd-363">如果基於任何原因，您必須使用 HTTP 而不是 HTTPS，且您要使用區塊 Blob，您可以使用 MD5 檢查，協助確認要傳輸的 Blob 完整性</span><span class="sxs-lookup"><span data-stu-id="ac4fd-363">If for any reason you need to use HTTP instead of HTTPS and you are working with block blobs, you can use MD5 checking to help verify the integrity of the blobs being transferred</span></span></p><p><span data-ttu-id="ac4fd-364">這有助於提供保護以防止發生網路/傳輸層錯誤，但不一定是媒介攻擊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-364">This will help with protection from network/transport layer errors, but not necessarily with intermediary attacks.</span></span> <span data-ttu-id="ac4fd-365">如果您可以使用 HTTPS 來提供傳輸層安全性，則使用 MD5 檢查是多餘且不必要的。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-365">If you can use HTTPS, which provides transport level security, then using MD5 checking is redundant and unnecessary.</span></span></p>|

## <span data-ttu-id="ac4fd-366"><a id="smb-shares"></a>使用 SMB 3.0 相容用戶端來確保要傳輸到 Azure 檔案共用的資料會加密</span><span class="sxs-lookup"><span data-stu-id="ac4fd-366"><a id="smb-shares"></a>Use SMB 3.0 compatible client to ensure in-transit data encryption to Azure File shares</span></span>

| <span data-ttu-id="ac4fd-367">課程名稱</span><span class="sxs-lookup"><span data-stu-id="ac4fd-367">Title</span></span>                   | <span data-ttu-id="ac4fd-368">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-368">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-369">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-369">**Component**</span></span>               | <span data-ttu-id="ac4fd-370">行動用戶端</span><span class="sxs-lookup"><span data-stu-id="ac4fd-370">Mobile Client</span></span> | 
| <span data-ttu-id="ac4fd-371">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-371">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-372">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-372">Build</span></span> |  
| <span data-ttu-id="ac4fd-373">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-373">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-374">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-374">Generic</span></span> |
| <span data-ttu-id="ac4fd-375">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-375">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-376">StorageType - 檔案</span><span class="sxs-lookup"><span data-stu-id="ac4fd-376">StorageType - File</span></span> |
| <span data-ttu-id="ac4fd-377">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-377">**References**</span></span>              | <span data-ttu-id="ac4fd-378">[Azure 檔案儲存體](https://azure.microsoft.com/blog/azure-file-storage-now-generally-available/#comment-2529238931)、[Windows 用戶端的 Azure 檔案儲存體 SMB 支援](https://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-files/#_mount-the-file-share)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-378">[Azure File Storage](https://azure.microsoft.com/blog/azure-file-storage-now-generally-available/#comment-2529238931), [Azure File Storage SMB Support for Windows Clients](https://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-files/#_mount-the-file-share)</span></span> |
| <span data-ttu-id="ac4fd-379">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-379">**Steps**</span></span> | <span data-ttu-id="ac4fd-380">使用 REST API 時，Azure 檔案儲存體支援 HTTPS，但較常用來做為連接到 VM 的 SMB 檔案共用。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-380">Azure File Storage supports HTTPS when using the REST API, but is more commonly used as an SMB file share attached to a VM.</span></span> <span data-ttu-id="ac4fd-381">SMB 2.1 不支援加密，因此只允許在 Azure 中的相同區域內連接。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-381">SMB 2.1 does not support encryption, so connections are only allowed within the same region in Azure.</span></span> <span data-ttu-id="ac4fd-382">不過，SMB 3.0 支援加密，而且可以搭配 Windows Server 2012 R2、Windows 8、Windows 8.1 和 Windows 10 使用，允許跨區域存取，甚至是桌面上的存取。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-382">However, SMB 3.0 supports encryption, and can be used with Windows Server 2012 R2, Windows 8, Windows 8.1, and Windows 10, allowing cross-region access and even access on the desktop.</span></span> |

## <span data-ttu-id="ac4fd-383"><a id="cert-pinning"></a>實作憑證釘選</span><span class="sxs-lookup"><span data-stu-id="ac4fd-383"><a id="cert-pinning"></a>Implement Certificate Pinning</span></span>

| <span data-ttu-id="ac4fd-384">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-384">Title</span></span>                   | <span data-ttu-id="ac4fd-385">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-385">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-386">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-386">**Component**</span></span>               | <span data-ttu-id="ac4fd-387">Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="ac4fd-387">Azure Storage</span></span> | 
| <span data-ttu-id="ac4fd-388">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-388">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-389">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-389">Build</span></span> |  
| <span data-ttu-id="ac4fd-390">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-390">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-391">泛型、Windows Phone</span><span class="sxs-lookup"><span data-stu-id="ac4fd-391">Generic, Windows Phone</span></span> |
| <span data-ttu-id="ac4fd-392">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-392">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-393">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-393">N/A</span></span>  |
| <span data-ttu-id="ac4fd-394">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-394">**References**</span></span>              | [<span data-ttu-id="ac4fd-395">憑證和公開金鑰釘選</span><span class="sxs-lookup"><span data-stu-id="ac4fd-395">Certificate and Public Key Pinning</span></span>](https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning#.Net) |
| <span data-ttu-id="ac4fd-396">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-396">**Steps**</span></span> | <p><span data-ttu-id="ac4fd-397">憑證釘選可防止攔截式 (MITM) 攻擊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-397">Certificate pinning defends against Man-In-The-Middle (MITM) attacks.</span></span> <span data-ttu-id="ac4fd-398">釘選程序會將主機與其預期的 X509 憑證或公開金鑰相關聯。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-398">Pinning is the process of associating a host with their expected X509 certificate or public key.</span></span> <span data-ttu-id="ac4fd-399">在主機已知或已看到憑證或公開金鑰後，憑證或公開金鑰便已關聯或「釘選」到主機。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-399">Once a certificate or public key is known or seen for a host, the certificate or public key is associated or 'pinned' to the host.</span></span> </p><p><span data-ttu-id="ac4fd-400">因此，當攻擊者嘗試發動 SSL MITM 攻擊時，在 SSL 信號交換期間，來自攻擊者伺服器的金鑰會與已釘選之憑證的金鑰不同，因而會捨棄要求，因此，就能藉由實作 ServicePointManager 的 `ServerCertificateValidationCallback` 委派來防止 MITM 憑證釘選。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-400">Thus, when an adversary attempts to do SSL MITM attack, during SSL handshake the key from attacker's server will be different from the pinned certificate's key, and the request will be discarded, thus preventing MITM Certificate pinning can be achieved by implementing ServicePointManager's `ServerCertificateValidationCallback` delegate.</span></span></p>|

### <a name="example"></a><span data-ttu-id="ac4fd-401">範例</span><span class="sxs-lookup"><span data-stu-id="ac4fd-401">Example</span></span>
```C#
using System;
using System.Net;
using System.Net.Security;
using System.Security.Cryptography;

namespace CertificatePinningExample
{
    class CertificatePinningExample
    {
        /* Note: In this example, we're hardcoding a the certificate's public key and algorithm for 
           demonstration purposes. In a real-world application, this should be stored in a secure
           configuration area that can be updated as needed. */

        private static readonly string PINNED_ALGORITHM = "RSA";

        private static readonly string PINNED_PUBLIC_KEY = "3082010A0282010100B0E75B7CBE56D31658EF79B3A1" +
            "294D506A88DFCDD603F6EF15E7F5BCBDF32291EC50B2B82BA158E905FE6A83EE044A48258B07FAC3D6356AF09B2" +
            "3EDAB15D00507B70DB08DB9A20C7D1201417B3071A346D663A241061C151B6EC5B5B4ECCCDCDBEA24F051962809" +
            "FEC499BF2D093C06E3BDA7D0BB83CDC1C2C6660B8ECB2EA30A685ADE2DC83C88314010FFC7F4F0F895EDDBE5C02" +
            "ABF78E50B708E0A0EB984A9AA536BCE61A0C31DB95425C6FEE5A564B158EE7C4F0693C439AE010EF83CA8155750" +
            "09B17537C29F86071E5DD8CA50EBD8A409494F479B07574D83EDCE6F68A8F7D40447471D05BC3F5EAD7862FA748" +
            "EA3C92A60A128344B1CEF7A0B0D94E50203010001";


        public static void Main(string[] args)
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://azure.microsoft.com");
            request.ServerCertificateValidationCallback = (sender, certificate, chain, sslPolicyErrors) =>
            {
                if (certificate == null || sslPolicyErrors != SslPolicyErrors.None)
                {
                    // Error getting certificate or the certificate failed basic validation
                    return false;
                }

                var targetKeyAlgorithm = new Oid(certificate.GetKeyAlgorithm()).FriendlyName;
                var targetPublicKey = certificate.GetPublicKeyString();
                
                if (targetKeyAlgorithm == PINNED_ALGORITHM &&
                    targetPublicKey == PINNED_PUBLIC_KEY)
                {
                    // Success, the certificate matches the pinned value.
                    return true;
                }
                // Reject, either the key or the algorithm does not match the expected value.
                return false;
            };

            try
            {
                var response = (HttpWebResponse)request.GetResponse();
                Console.WriteLine($"Success, HTTP status code: {response.StatusCode}");
            }
            catch(Exception ex)
            {
                Console.WriteLine($"Failure, {ex.Message}");
            }
            Console.WriteLine("Press any key to end.");
            Console.ReadKey();
        }
    }
}
```

## <span data-ttu-id="ac4fd-402"><a id="https-transport"></a>啟用 HTTPS - 安全傳輸通道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-402"><a id="https-transport"></a>Enable HTTPS - Secure Transport channel</span></span>

| <span data-ttu-id="ac4fd-403">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-403">Title</span></span>                   | <span data-ttu-id="ac4fd-404">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-404">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-405">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-405">**Component**</span></span>               | <span data-ttu-id="ac4fd-406">WCF</span><span class="sxs-lookup"><span data-stu-id="ac4fd-406">WCF</span></span> | 
| <span data-ttu-id="ac4fd-407">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-407">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-408">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-408">Build</span></span> |  
| <span data-ttu-id="ac4fd-409">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-409">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-410">NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="ac4fd-410">NET Framework 3</span></span> |
| <span data-ttu-id="ac4fd-411">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-411">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-412">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-412">N/A</span></span>  |
| <span data-ttu-id="ac4fd-413">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-413">**References**</span></span>              | <span data-ttu-id="ac4fd-414">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx)、[Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html)</span><span class="sxs-lookup"><span data-stu-id="ac4fd-414">[MSDN](https://msdn.microsoft.com/library/ff648500.aspx), [Fortify Kingdom](https://vulncat.fortify.com/en/vulncat/index.html)</span></span> |
| <span data-ttu-id="ac4fd-415">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-415">**Steps**</span></span> | <span data-ttu-id="ac4fd-416">應用程式組態應確定敏感性資訊的所有存取都會使用 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-416">The application configuration should ensure that HTTPS is used for all access to sensitive information.</span></span><ul><li><span data-ttu-id="ac4fd-417">**說明︰**如果某應用程式負責處理敏感性資訊，卻未使用訊息層級加密，則只應允許其透過加密的傳輸通道進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-417">**EXPLANATION:** If an application handles sensitive information and does not use message-level encryption, then it should only be allowed to communicate over an encrypted transport channel.</span></span></li><li><span data-ttu-id="ac4fd-418">**建議︰**確定已停用 HTTP 傳輸，並改為啟用 HTTPS 傳輸。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-418">**RECOMMENDATIONS:** Ensure that HTTP transport is disabled and enable HTTPS transport instead.</span></span> <span data-ttu-id="ac4fd-419">例如，以 `<httpsTransport/>` 標籤取代 `<httpTransport/>`。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-419">For example, replace the `<httpTransport/>` with `<httpsTransport/>` tag.</span></span> <span data-ttu-id="ac4fd-420">請勿依賴網路組態 (防火牆) 來保證應用程式只能透過安全通道加以存取。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-420">Do not rely on a network configuration (firewall) to guarantee that the application can only be accessed over a secure channel.</span></span> <span data-ttu-id="ac4fd-421">從哲學觀點來看，應用程式不該仰賴網路來確保其安全性。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-421">From a philosophical point of view, the application should not depend on the network for its security.</span></span></li></ul><p><span data-ttu-id="ac4fd-422">但從現實觀點來看，負責保護網路的人員不一定能跟隨應用程式安全性需求的演變腳步。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-422">From a practical point of view, the people responsible for securing the network do not always track the security requirements of the application as they evolve.</span></span></p>|

## <span data-ttu-id="ac4fd-423"><a id="message-protection"></a>WCF︰將訊息安全性保護層級設定為 EncryptAndSign</span><span class="sxs-lookup"><span data-stu-id="ac4fd-423"><a id="message-protection"></a>WCF: Set Message security Protection level to EncryptAndSign</span></span>

| <span data-ttu-id="ac4fd-424">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-424">Title</span></span>                   | <span data-ttu-id="ac4fd-425">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-425">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-426">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-426">**Component**</span></span>               | <span data-ttu-id="ac4fd-427">WCF</span><span class="sxs-lookup"><span data-stu-id="ac4fd-427">WCF</span></span> | 
| <span data-ttu-id="ac4fd-428">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-428">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-429">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-429">Build</span></span> |  
| <span data-ttu-id="ac4fd-430">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-430">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-431">.NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="ac4fd-431">.NET Framework 3</span></span> |
| <span data-ttu-id="ac4fd-432">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-432">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-433">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-433">N/A</span></span>  |
| <span data-ttu-id="ac4fd-434">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-434">**References**</span></span>              | [<span data-ttu-id="ac4fd-435">MSDN</span><span class="sxs-lookup"><span data-stu-id="ac4fd-435">MSDN</span></span>](https://msdn.microsoft.com/library/ff650862.aspx) |
| <span data-ttu-id="ac4fd-436">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-436">**Steps**</span></span> | <ul><li><span data-ttu-id="ac4fd-437">**說明︰**保護層級設定為「無」時，它會停用訊息保護。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-437">**EXPLANATION:** When Protection level is set to "none" it will disable message protection.</span></span> <span data-ttu-id="ac4fd-438">機密性和完整性要有適當的設定層級才能實現。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-438">Confidentiality and integrity is achieved with appropriate level of setting.</span></span></li><li><span data-ttu-id="ac4fd-439">**建議︰**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-439">**RECOMMENDATIONS:**</span></span><ul><li><span data-ttu-id="ac4fd-440">當 `Mode=None` 時 - 停用訊息保護</span><span class="sxs-lookup"><span data-stu-id="ac4fd-440">when `Mode=None` - Disables message protection</span></span></li><li><span data-ttu-id="ac4fd-441">當 `Mode=Sign` 時 - 會簽署但不加密訊息；若您認為資料完整性很重要，便應使用</span><span class="sxs-lookup"><span data-stu-id="ac4fd-441">when `Mode=Sign` - Signs but does not encrypt the message; should be used when data integrity is important</span></span></li><li><span data-ttu-id="ac4fd-442">當 `Mode=EncryptAndSign` 時 - 簽署並加密訊息</span><span class="sxs-lookup"><span data-stu-id="ac4fd-442">when `Mode=EncryptAndSign` - Signs and encrypts the message</span></span></li></ul></li></ul><p><span data-ttu-id="ac4fd-443">若您只需要驗證資訊的完整性而不必擔心機密性，請考慮關閉加密功能，只要簽署訊息即可。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-443">Consider turning off encryption and only signing your message when you just need to validate the integrity of the information without concerns of confidentiality.</span></span> <span data-ttu-id="ac4fd-444">對於需要驗證原始傳送者，但不會傳輸敏感性資料的作業或服務合約，這會非常實用。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-444">This may be useful for operations or service contracts in which you need to validate the original sender but no sensitive data is transmitted.</span></span> <span data-ttu-id="ac4fd-445">在降低保護層級時，請注意訊息中並未包含任何個人識別資訊 (PII)。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-445">When reducing the protection level, be careful that the message does not contain any personally identifiable information (PII).</span></span></p>|

### <a name="example"></a><span data-ttu-id="ac4fd-446">範例</span><span class="sxs-lookup"><span data-stu-id="ac4fd-446">Example</span></span>
<span data-ttu-id="ac4fd-447">下列範例顯示將服務和作業設定為只簽署訊息的情況。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-447">Configuring the service and the operation to only sign the message is shown in the following examples.</span></span> <span data-ttu-id="ac4fd-448">`ProtectionLevel.Sign` 的服務合約範例：以下是在服務合約層級使用 ProtectionLevel.Sign 的範例︰</span><span class="sxs-lookup"><span data-stu-id="ac4fd-448">Service Contract Example of `ProtectionLevel.Sign`: The following is an example of using ProtectionLevel.Sign at the Service Contract level:</span></span> 
```
[ServiceContract(Protection Level=ProtectionLevel.Sign] 
public interface IService 
  { 
  string GetData(int value); 
  } 
```

### <a name="example"></a><span data-ttu-id="ac4fd-449">範例</span><span class="sxs-lookup"><span data-stu-id="ac4fd-449">Example</span></span>
<span data-ttu-id="ac4fd-450">`ProtectionLevel.Sign` 的作業合約範例 (適用於細微控制)︰以下是在作業合約層級使用 `ProtectionLevel.Sign` 的範例︰</span><span class="sxs-lookup"><span data-stu-id="ac4fd-450">Operation Contract Example of `ProtectionLevel.Sign` (for Granular Control): The following is an example of using `ProtectionLevel.Sign` at the OperationContract level:</span></span>

```
[OperationContract(ProtectionLevel=ProtectionLevel.Sign] 
string GetData(int value);
``` 

## <span data-ttu-id="ac4fd-451"><a id="least-account-wcf"></a>WCF︰使用最低權限帳戶來執行 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="ac4fd-451"><a id="least-account-wcf"></a>WCF: Use a least-privileged account to run your WCF service</span></span>

| <span data-ttu-id="ac4fd-452">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-452">Title</span></span>                   | <span data-ttu-id="ac4fd-453">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-453">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-454">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-454">**Component**</span></span>               | <span data-ttu-id="ac4fd-455">WCF</span><span class="sxs-lookup"><span data-stu-id="ac4fd-455">WCF</span></span> | 
| <span data-ttu-id="ac4fd-456">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-456">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-457">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-457">Build</span></span> |  
| <span data-ttu-id="ac4fd-458">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-458">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-459">.NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="ac4fd-459">.NET Framework 3</span></span> |
| <span data-ttu-id="ac4fd-460">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-460">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-461">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-461">N/A</span></span>  |
| <span data-ttu-id="ac4fd-462">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-462">**References**</span></span>              | [<span data-ttu-id="ac4fd-463">MSDN</span><span class="sxs-lookup"><span data-stu-id="ac4fd-463">MSDN</span></span>](https://msdn.microsoft.com/library/ff648826.aspx ) |
| <span data-ttu-id="ac4fd-464">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-464">**Steps**</span></span> | <ul><li><span data-ttu-id="ac4fd-465">**說明︰**請勿使用系統管理員或高權限帳戶執行 WCF 服務。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-465">**EXPLANATION:** Do not run WCF services under admin or high privilege account.</span></span> <span data-ttu-id="ac4fd-466">萬一發生服務入侵，這會造成很大的影響。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-466">in case of services compromise it will result in high impact.</span></span></li><li><span data-ttu-id="ac4fd-467">**建議︰**使用最低權限帳戶來裝載 WCF 服務，因為這會降低應用程式的受攻擊面，並減少遭受攻擊時可能受到的損害。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-467">**RECOMMENDATIONS:** Use a least-privileged account to host your WCF service because it will reduce your application's attack surface and reduce the potential damage if you are attacked.</span></span> <span data-ttu-id="ac4fd-468">如果服務帳戶需要其他的基礎結構資源存取權限 (例如 MSMQ、事件記錄、效能計數器和檔案系統)，則應對這些資源提供適當權限，WCF 服務才能夠順利執行。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-468">If the service account requires additional access rights on infrastructure resources such as MSMQ, the event log, performance counters, and the file system, appropriate permissions should be given to these resources so that the WCF service can run successfully.</span></span></li></ul><p><span data-ttu-id="ac4fd-469">如果您的服務需要代表原始呼叫者存取特定資源，請使用模擬與委派來傳送呼叫者的身分識別以進行下游授權檢查。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-469">If your service needs to access specific resources on behalf of the original caller, use impersonation and delegation to flow the caller's identity for a downstream authorization check.</span></span> <span data-ttu-id="ac4fd-470">在開發案例中，請使用區域網路服務帳戶，這是擁有較小權限的特殊內建帳戶。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-470">In a development scenario, use the local network service account, which is a special built-in account that has reduced privileges.</span></span> <span data-ttu-id="ac4fd-471">在生產案例中，請建立最低權限的自訂網域服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-471">In a production scenario, create a least-privileged custom domain service account.</span></span></p>|

## <span data-ttu-id="ac4fd-472"><a id="webapi-https"></a>強制所有前往 Web API 的流量透過 HTTPS 連線來進行</span><span class="sxs-lookup"><span data-stu-id="ac4fd-472"><a id="webapi-https"></a>Force all traffic to Web APIs over HTTPS connection</span></span>

| <span data-ttu-id="ac4fd-473">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-473">Title</span></span>                   | <span data-ttu-id="ac4fd-474">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-474">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-475">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-475">**Component**</span></span>               | <span data-ttu-id="ac4fd-476">Web API</span><span class="sxs-lookup"><span data-stu-id="ac4fd-476">Web API</span></span> | 
| <span data-ttu-id="ac4fd-477">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-477">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-478">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-478">Build</span></span> |  
| <span data-ttu-id="ac4fd-479">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-479">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-480">MVC5、MVC6</span><span class="sxs-lookup"><span data-stu-id="ac4fd-480">MVC5, MVC6</span></span> |
| <span data-ttu-id="ac4fd-481">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-481">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-482">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-482">N/A</span></span>  |
| <span data-ttu-id="ac4fd-483">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-483">**References**</span></span>              | [<span data-ttu-id="ac4fd-484">在 Web API 控制器中強制執行 SSL</span><span class="sxs-lookup"><span data-stu-id="ac4fd-484">Enforcing SSL in a Web API Controller</span></span>](http://www.asp.net/web-api/overview/security/working-with-ssl-in-web-api) |
| <span data-ttu-id="ac4fd-485">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-485">**Steps**</span></span> | <span data-ttu-id="ac4fd-486">如果應用程式同時具有 HTTPS 和 HTTP 繫結，用戶端仍可使用 HTTP 來存取網站。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-486">If an application has both an HTTPS and an HTTP binding, clients can still use HTTP to access the site.</span></span> <span data-ttu-id="ac4fd-487">若要避免這個問題，請使用動作篩選來確保受保護之 API 的要求一律會透過 HTTPS。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-487">To prevent this, use an action filter to ensure that requests to protected APIs are always over HTTPS.</span></span>|

### <a name="example"></a><span data-ttu-id="ac4fd-488">範例</span><span class="sxs-lookup"><span data-stu-id="ac4fd-488">Example</span></span> 
<span data-ttu-id="ac4fd-489">下列程式碼顯示會檢查 SSL 的 Web API 驗證篩選︰</span><span class="sxs-lookup"><span data-stu-id="ac4fd-489">The following code shows a Web API authentication filter that checks for SSL:</span></span> 
```C#
public class RequireHttpsAttribute : AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext actionContext)
    {
        if (actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps)
        {
            actionContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden)
            {
                ReasonPhrase = "HTTPS Required"
            };
        }
        else
        {
            base.OnAuthorization(actionContext);
        }
    }
}
```
<span data-ttu-id="ac4fd-490">將此篩選新增至任何需要 SSL 的 Web API 動作︰</span><span class="sxs-lookup"><span data-stu-id="ac4fd-490">Add this filter to any Web API actions that require SSL:</span></span> 
```C#
public class ValuesController : ApiController
{
    [RequireHttps]
    public HttpResponseMessage Get() { ... }
}
```
 
## <span data-ttu-id="ac4fd-491"><a id="redis-ssl"></a>確定對 Azure Redis 快取的通訊是透過 SSL</span><span class="sxs-lookup"><span data-stu-id="ac4fd-491"><a id="redis-ssl"></a>Ensure that communication to Azure Redis Cache is over SSL</span></span>

| <span data-ttu-id="ac4fd-492">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-492">Title</span></span>                   | <span data-ttu-id="ac4fd-493">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-493">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-494">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-494">**Component**</span></span>               | <span data-ttu-id="ac4fd-495">Azure Redis 快取</span><span class="sxs-lookup"><span data-stu-id="ac4fd-495">Azure Redis Cache</span></span> | 
| <span data-ttu-id="ac4fd-496">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-496">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-497">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-497">Build</span></span> |  
| <span data-ttu-id="ac4fd-498">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-498">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-499">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-499">Generic</span></span> |
| <span data-ttu-id="ac4fd-500">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-500">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-501">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-501">N/A</span></span>  |
| <span data-ttu-id="ac4fd-502">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-502">**References**</span></span>              | [<span data-ttu-id="ac4fd-503">Azure Redis SSL 支援</span><span class="sxs-lookup"><span data-stu-id="ac4fd-503">Azure Redis SSL support</span></span>](https://azure.microsoft.com/documentation/articles/cache-faq/#when-should-i-enable-the-non-ssl-port-for-connecting-to-redis) |
| <span data-ttu-id="ac4fd-504">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-504">**Steps**</span></span> | <span data-ttu-id="ac4fd-505">Redis 伺服器不支援非預設 SSL，但是 Azure Redis 快取則支援。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-505">Redis server does not support SSL out of the box, but Azure Redis Cache does.</span></span> <span data-ttu-id="ac4fd-506">如果您是連線至 Azure Redis 快取，並且您的用戶端支援 SSL (例如 StackExchange.Redis)，則應該使用 SSL。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-506">If you are connecting to Azure Redis Cache and your client supports SSL, like StackExchange.Redis, then you should use SSL.</span></span> <span data-ttu-id="ac4fd-507">新的 Azure Redis 快取執行個體已預設停用非 SSL 連接埠。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-507">By default non-SSL port is disabled for new Azure Redis Cache instances.</span></span> <span data-ttu-id="ac4fd-508">除非 Redis 用戶端仰賴 SSL 支援，否則請確保安全的預設值未遭變更。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-508">Ensure that the secure defaults are not changed unless there is a dependency on SSL support for redis clients.</span></span> |

<span data-ttu-id="ac4fd-509">請注意，Redis 是設計成要供受信任環境內的受信任用戶端存取。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-509">Please note that Redis is designed to be accessed by trusted clients inside trusted environments.</span></span> <span data-ttu-id="ac4fd-510">這表示，讓 Redis 執行個體直接面對網際網路通常不是什麼好主意，或者一般來說，讓它直接面對不受信任之用戶端可直接存取 Redis TCP 連接埠或 UNIX 通訊端的環境也不是好主意。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-510">This means that usually it is not a good idea to expose the Redis instance directly to the internet or, in general, to an environment where untrusted clients can directly access the Redis TCP port or UNIX socket.</span></span> 

## <span data-ttu-id="ac4fd-511"><a id="device-field"></a>保護裝置對現場閘道的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-511"><a id="device-field"></a>Secure Device to Field Gateway communication</span></span>

| <span data-ttu-id="ac4fd-512">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-512">Title</span></span>                   | <span data-ttu-id="ac4fd-513">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-513">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-514">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-514">**Component**</span></span>               | <span data-ttu-id="ac4fd-515">IoT 現場閘道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-515">IoT Field Gateway</span></span> | 
| <span data-ttu-id="ac4fd-516">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-516">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-517">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-517">Build</span></span> |  
| <span data-ttu-id="ac4fd-518">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-518">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-519">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-519">Generic</span></span> |
| <span data-ttu-id="ac4fd-520">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-520">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-521">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-521">N/A</span></span>  |
| <span data-ttu-id="ac4fd-522">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-522">**References**</span></span>              | <span data-ttu-id="ac4fd-523">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-523">N/A</span></span>  |
| <span data-ttu-id="ac4fd-524">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-524">**Steps**</span></span> | <span data-ttu-id="ac4fd-525">對於 IP 型裝置，通訊協定通常可以封裝在 SSL/TLS 通道來保護傳輸中的資料。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-525">For IP based devices, the communication protocol could typically be encapsulated in a SSL/TLS channel to protect data in transit.</span></span> <span data-ttu-id="ac4fd-526">對於其他不支援 SSL/TLS 的通訊協定，請調查是否有安全版本的通訊協定可在傳輸層或訊息層提供安全性。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-526">For other protocols that do not support SSL/TLS investigate if there are secure versions of the protocol that provide security at transport or message layer.</span></span> |

## <span data-ttu-id="ac4fd-527"><a id="device-cloud"></a>使用 SSL/TLS 保護裝置對雲端閘道的通訊</span><span class="sxs-lookup"><span data-stu-id="ac4fd-527"><a id="device-cloud"></a>Secure Device to Cloud Gateway communication using SSL/TLS</span></span>

| <span data-ttu-id="ac4fd-528">Title</span><span class="sxs-lookup"><span data-stu-id="ac4fd-528">Title</span></span>                   | <span data-ttu-id="ac4fd-529">詳細資料</span><span class="sxs-lookup"><span data-stu-id="ac4fd-529">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="ac4fd-530">**元件**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-530">**Component**</span></span>               | <span data-ttu-id="ac4fd-531">IoT 雲端閘道</span><span class="sxs-lookup"><span data-stu-id="ac4fd-531">IoT Cloud Gateway</span></span> | 
| <span data-ttu-id="ac4fd-532">**SDL 階段**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-532">**SDL Phase**</span></span>               | <span data-ttu-id="ac4fd-533">建置</span><span class="sxs-lookup"><span data-stu-id="ac4fd-533">Build</span></span> |  
| <span data-ttu-id="ac4fd-534">**適用的技術**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-534">**Applicable Technologies**</span></span> | <span data-ttu-id="ac4fd-535">泛型</span><span class="sxs-lookup"><span data-stu-id="ac4fd-535">Generic</span></span> |
| <span data-ttu-id="ac4fd-536">**屬性**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-536">**Attributes**</span></span>              | <span data-ttu-id="ac4fd-537">N/A</span><span class="sxs-lookup"><span data-stu-id="ac4fd-537">N/A</span></span>  |
| <span data-ttu-id="ac4fd-538">**參考**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-538">**References**</span></span>              | [<span data-ttu-id="ac4fd-539">選擇您的通訊協定</span><span class="sxs-lookup"><span data-stu-id="ac4fd-539">Choose your Communication Protocol</span></span>](https://azure.microsoft.com/documentation/articles/iot-hub-devguide/#messaging) |
| <span data-ttu-id="ac4fd-540">**步驟**</span><span class="sxs-lookup"><span data-stu-id="ac4fd-540">**Steps**</span></span> | <span data-ttu-id="ac4fd-541">使用 SSL/TLS 的安全 HTTP/AMQP 或 MQTT 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="ac4fd-541">Secure HTTP/AMQP or MQTT protocols using SSL/TLS.</span></span> |
