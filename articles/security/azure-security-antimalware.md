---
title: "azure 的反惡意程式碼 aaaMicrosoft |Microsoft 文件"
description: "本文提供適用於 Azure 的 Microsoft Antimalware 架構概觀，其中包括支援的案例和針對 Azure 雲端服務和虛擬機器啟用、設定及部署保護的設定。 我們將討論基本組態、 管理和監視功能可透過 Microsoft Azure 服務管理 API、 PowerShell 指令碼、 hello Azure 入口網站和 Visual Studio 存取。"
services: security
documentationcenter: na
author: YuriDio
manager: swadhwa
editor: 
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/15/2017
ms.author: yurid
ms.openlocfilehash: 8f50ff145d7dd884cad3ebecba937d2021dc8db4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>適用於 Azure 雲端服務和虛擬機器的 Microsoft Antimalware
雲端環境的 hello 現今的威脅架構之下是非常動態的企業的 IT hello 壓力雲端 「 訂閱者 」 toomaintain 有效保護順序 toomeet 相容性和安全性需求。 Microsoft Antimalware for Azure 可用的即時保護功能，可協助識別並移除病毒、 間諜軟體，並且其他惡意軟體，可設定的警示已知惡意或垃圾軟體時嘗試 tooinstall 本身或執行在程式Azure 系統。

hello 方案建置在 hello 相同反惡意程式碼的平台，即 Microsoft Security Essentials \[MSE\]，Microsoft Forefront Endpoint Protection、 Microsoft System Center Endpoint Protection、 Windows Intune 和 Windows Defender 的Windows 8.0 （含） 以上。 Microsoft Antimalware for Azure 是單一代理程式解決方案的應用程式和租用戶環境中，設計 toorun hello 背景需要人為介入。 您可以部署根據您的應用程式工作負載，與其中一個基本安全依預設的 hello 需求或進階自訂組態，包括監視反惡意程式碼的保護。

當您部署應用程式啟用 azure 的 Microsoft 反惡意程式碼時，hello 下列核心功能是可用：

* **即時保護**-監視雲端服務和虛擬機器 toodetect 和封鎖惡意程式碼執行的活動。
* **排程掃描**-目標掃描 toodetect 惡意程式碼，包括正在執行的程式會定期執行。
* **惡意程式碼補救** - 自動針對偵測到的惡意程式碼採取行動，例如刪除或隔離惡意檔案及清除惡意的登錄項目。
* **簽章更新**-自動安裝 hello 最新保護 （防毒定義） 的簽章 tooensure 保護是最新的預先決定的頻率。
* **反惡意程式碼引擎更新**– 自動更新 hello Microsoft 反惡意程式碼引擎。
* **反惡意程式碼的平台更新**– 自動更新 hello Microsoft 反惡意程式碼的平台。
* **作用中保護**： 遙測中繼資料會報告有關偵測到的威脅和可疑資源 tooMicrosoft Azure tooensure 快速回應 toohello 發展威脅架構之下，以及啟用即時同步的簽章傳遞透過 hello Microsoft Active Protection 系統 (MAPS)。
* **範例 reporting** ： 提供和報告範例 toohello Microsoft 反惡意程式碼服務 toohelp 精簡 hello 服務和啟用疑難排解。
* **排除項目**– 可讓應用程式和服務系統管理員 tooconfigure 某些檔案時，處理程序，並從保護以及掃描的效能及/或其他原因，磁碟機 tooexclude。
* **反惡意程式碼的事件集合**-hello 反惡意程式碼服務健全狀況、 可疑活動，以及在 hello 作業系統事件記錄檔中所採取的修復動作記錄，並會加以收集到 hello 客戶的 Azure 儲存體帳戶。

> [!NOTE]
> 您也可以使用「Azure 資訊安全中心」來部署 Microsoft Antimalware。 如需詳細資訊，請參閱[在 Azure 資訊安全中心安裝端點保護](../security-center/security-center-install-endpoint-protection.md)。
>
>

## <a name="architecture"></a>架構
Azure 解決方案的 hello Microsoft 反惡意程式碼包含 hello Microsoft 反惡意程式碼用戶端和服務，反惡意程式碼傳統部署模型、 反惡意程式碼的 PowerShell cmdlet 和 Azure 診斷擴充功能。 hello Microsoft 反惡意程式碼解決方案支援 Windows Server 2008 R2、 Windows Server 2012 和 Windows Server 2012 R2 作業系統系列。 不支援在 hello Windows Server 2008 作業系統上。 對 Windows Server 2016 使用 Defender 的支援已釋出，您可以在[這裡](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/)閱讀此更新的相關資訊。

hello Microsoft 反惡意程式碼用戶端和服務會安裝在 hello 雲端服務平台的所有支援的 Azure 客體作業系統系列中的停用狀態的預設值。 hello Microsoft 反惡意程式碼用戶端和服務未安裝預設會在 hello 虛擬機器平台，並可透過 Azure 入口網站 hello 和 Visual Studio 虛擬機器設定安全性延伸模組的選擇性功能。

當使用 Azure 網站，hello 基礎服務該主機 hello web 應用程式具有 Microsoft 反惡意程式碼在其上啟用。 這是使用的 tooprotect Azure 網站基礎結構，而且不會執行對客戶的內容。

### <a name="microsoft-antimalware-workflow"></a>Microsoft Antimalware 工作流程
hello Azure 服務管理員可以啟用 azure 的反惡意程式碼使用預設或自訂設定您的虛擬機器和雲端服務使用下列選項的 hello:

* 虛擬機器 – hello Azure 入口網站中下方**安全性延伸模組**
* 虛擬機器 – 使用 hello Visual Studio 伺服器總管 中的虛擬機器組態
* 虛擬機器和雲端服務 – 使用 hello 反惡意程式碼[傳統部署模型](https://msdn.microsoft.com/library/azure/ee460799.aspx)
* 虛擬機器和雲端服務 – 使用 Antimalware PowerShell Cmdlet

hello Azure 入口網站或 PowerShell 指令程式推入 hello 反惡意程式碼擴充封裝檔案 toohello Azure 系統在預先決定的固定位置。 hello Azure 客體代理程式 （或 hello 網狀架構代理程式） 會啟動 hello 反惡意程式碼擴充功能，套用 hello 反惡意程式碼的組態設定提供做為輸入。 這個步驟可讓 hello 反惡意程式碼服務，使用預設或自訂組態設定。 如果未不提供任何自訂設定，則 hello 反惡意程式碼服務已啟用的 hello 預設組態設定。 請參閱 toohello*反惡意程式碼設定*hello > 一節[Microsoft Antimalware for Azure-程式碼範例](http://aka.ms/amazsamples "Microsoft 反惡意程式碼的 Azure 雲端服務和 Vm的程式碼範例")如需詳細資訊。

一旦執行，hello Microsoft 反惡意程式碼用戶端從 hello 網際網路下載 hello 最新保護引擎和簽章的定義，並將它們載入 hello Azure 系統。 hello Microsoft 反惡意程式碼服務寫入服務相關事件 toohello os hello"Microsoft 反惡意程式碼 「 事件來源 下的事件記錄。 事件包括 hello 反惡意程式碼用戶端健康狀態、 保護及補救狀態、 新和舊的組態設定、 引擎的更新和簽章定義和其他項目。

您可以啟用反惡意程式碼的監視您的雲端服務或虛擬機器 toohave hello 反惡意程式碼事件寫入記錄檔事件時產生 tooyour Azure 儲存體帳戶。 hello 反惡意程式碼服務會使用 hello Azure 診斷擴充功能 toocollect 反惡意程式碼中的事件 hello Azure 系統 hello 客戶的 Azure 儲存體帳戶中的資料表。

hello 部署工作流程中包括設定步驟和選項支援 hello 上述案例記載於[反惡意程式碼的部署案例](#_Antimalware_Deployment_Scenarios)本文件一節。

![Azure 中的 Microsoft Antimalware](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> 不過您可以使用 Powershell/Api 和 Azure 資源管理員範本 toodeploy 虛擬機器擴展集以 hello Microsoft 反惡意程式碼擴充功能。  已在執行的虛擬機器上安裝擴充功能，您可以使用 hello 範例 python 指令碼*vmssextn.py*位於[這裡](https://github.com/gbowerman/vmsstools)。 此指令碼取得 hello 規模調整集合上的 hello 現有的擴充功能組態，並將現有的延伸模組的延伸模組 toohello 清單上 hello VM 規模集。
>
>

### <a name="default-and-custom-antimalware-configuration"></a>預設和自訂的反惡意程式碼組態
當您未提供自訂組態設定，hello 預設組態設定會套用的 tooenable 反惡意程式碼的 Azure 雲端服務或虛擬機器。 hello 預設組態設定都已預先最佳化在 hello Azure 環境中執行。 或者，您可以依 Azure 應用程式或服務部署的需要來自訂這些預設組態設定，並將其套用至其他部署案例。

> [!NOTE]
> 預設會停用 hello Microsoft 反惡意程式碼使用者介面上 Azure 資源管理員， [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/)檔案的 toobypass 不支援此錯誤訊息。 如需有關如何 toocreate 自訂原則，讀取詳細[對 Azure 資源管理員的 Vm 部署後啟用 Microsoft 反惡意程式碼使用者介面](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/)。
>
>

hello 下表摘要說明可用的 hello 反惡意程式碼服務的 hello 組態設定。 在標記為 「 預設 」 底下的 hello 欄位標示 hello 預設組態設定。

![表 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a>反惡意程式碼部署案例
hello 案例 tooenable 和設定反惡意程式碼，包括 Azure 雲端服務和虛擬機器的監視，本章節所討論。

### <a name="virtual-machines---enable-and-configure-antimalware"></a>虛擬機器 - 啟用和設定反惡意程式碼
**使用 Azure 入口網站進行部署**

tooenable hello 反惡意程式碼服務，按一下**新增**hello 延伸模組 刀鋒視窗中，選取**Microsoft 反惡意程式碼**hello 新資源刀鋒視窗中，按一下 **建立**上 helloMicrosoft 反惡意程式碼 刀鋒視窗。 按一下**建立**沒有輸入任何設定值，以 hello tooenable 反惡意程式碼預設設定，或輸入 hello 虛擬機器設定下方圖 2 所示為 hello 反惡意程式碼組態設定。 請參閱 toohello**工具提示**隨附 hello 加入延伸模組 刀鋒視窗 toosee hello 支援組態值的每個組態設定。

![Microsoft Antimalware 的虛擬機器組態設定](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**使用 hello Azure 傳統入口網站部署**

tooenable 和設定 Microsoft Antimalware 的 Azure 虛擬機器使用 hello Azure 入口網站時佈建虛擬機器，請遵循下列 hello 步驟：

1.在 Azure 入口網站記錄到 hello <https://portal.azure.com>

2.toocreate 新虛擬機器時，按一下**新增**，**計算**，**虛擬****機器**，**從組件庫**（不使用快速建立） 如下所示：

![新虛擬機器](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)

3.選取 hello **Microsoft Windows Server**映像上 hello**選擇映像**頁面。

4.按一下 向右箭號 hello 和輸入的 hello 虛擬機器組態。

5.檢查 hello **Microsoft 反惡意程式碼**核取方塊底下**安全性延伸模組**hello 虛擬機器組態 頁面上。

6.dtsx 按一下 hello 送出按鈕 tooenable 及設定 Microsoft 反惡意程式碼的設定，適用於 Azure 虛擬機器的 hello 預設組態設定。

![虛擬機器組態](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**部署使用 hello Visual Studio 虛擬機器組態**

tooenable 設定 hello Microsoft 反惡意程式碼服務，使用 Visual Studio:

1.連線 tooMicrosoft Visual Studio 中的 Azure。

2.選擇您的虛擬機器中 hello**虛擬機器**節點**伺服器總管**

![Visual Studio 中的虛擬機器組態](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3.以滑鼠右鍵按一下**設定**tooview hello 虛擬機器組態 頁面

4.選取**Microsoft 反惡意程式碼**hello 底下的下拉式清單中的延伸模組**安裝擴充功能**按一下**新增**tooconfigure 與預設反惡意程式碼組態設定。

![已安裝的延伸模組](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5.toocustomize hello 預設反惡意程式碼的組態，hello 安裝擴充功能清單中選取 （反白顯示） hello 反惡意程式碼擴充功能，然後按一下**設定**。

6.dtsx hello 預設反惡意程式碼設定取代為您在 hello 支援 JSON 格式的自訂設定**公用組態**文字方塊中按一下 [確定]。

7] 按一下 [hello**更新**按鈕 toopush hello 組態所更新 tooyour 虛擬機器。

![虛擬機器組態延伸模組](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**注意：** hello Visual Studio 虛擬機器組態的反惡意程式碼僅支援 JSON 格式設定。 hello 反惡意程式碼的 JSON 組態設定的範本已納入 hello [Microsoft 反惡意程式碼的 Azure-程式碼範例](http://aka.ms/amazsamples "Microsoft 反惡意程式碼的 Azure-程式碼範例")，顯示 hello 支援反惡意程式碼的組態設定。

**使用 PowerShell Cmdlet 進行部署**

Azure 應用程式或服務可使用 PowerShell Cmdlet 來啟用或設定適用於 Azure 虛擬機器的 Microsoft Antimalware。

tooenable 和設定 Microsoft 反惡意程式碼使用反惡意程式碼的 PowerShell cmdlet:

1. 設定您的 PowerShell 環境，而 toohello 文件，網址<https://github.com/Azure/azure-powershell>
2. 使用 hello 組 AzureVMMicrosoftAntimalwareExtension 反惡意程式碼 cmdlet tooenable 並且您的虛擬機器設定 Microsoft 反惡意程式碼列載於<http://msdn.microsoft.com/library/azure/dn771718.aspx>

**注意：** hello Azure 虛擬機器組態的反惡意程式碼僅支援 JSON 格式設定。 hello 反惡意程式碼的 JSON 組態設定的範本已納入 hello [Microsoft 反惡意程式碼的 Azure-程式碼範例](http://aka.ms/amazsamples "Microsoft 反惡意程式碼的 Azure-程式碼範例")，顯示 hello 支援反惡意程式碼的組態設定。

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>使用 PowerShell Cmdlet 來啟用和設定 Antimalware
Azure 應用程式或服務可使用 PowerShell Cmdlet 來啟用或設定適用於 Azure 雲端服務的 Microsoft Antimalware。 請注意，Microsoft 反惡意程式碼中 hello 雲端服務平台是停用狀態安裝，而且 Azure 應用程式 tooenable 所需要的動作它。

tooenable 和設定 Microsoft 反惡意程式碼使用 PowerShell cmdlet:

1. 設定您的 PowerShell 環境，而 toohello 文件，網址<https://github.com/Azure/azure-sdk-tools#get-started>
2. 使用 hello 組 AzureServiceAntimalwareExtension 反惡意程式碼 cmdlet tooenable 並且您的雲端服務設定 Microsoft 反惡意程式碼列載於<http://msdn.microsoft.com/library/azure/dn771718.aspx>

hello 反惡意程式碼 XML 的組態設定範本已納入 hello [Microsoft 反惡意程式碼的 Azure-程式碼範例](http://aka.ms/amazsamples "Microsoft 反惡意程式碼的 Azure-程式碼範例")，顯示 hello 支援反惡意程式碼的組態設定。

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>雲端服務和虛擬機器 - 使用 PowerShell Cmdlet 進行設定
Azure 應用程式或服務可以擷取雲端服務和虛擬機器使用 PowerShell cmdlet 的 hello Microsoft 反惡意程式碼設定。

使用 PowerShell cmdlet tooretrieve hello Microsoft 反惡意程式碼設定：

1. 設定您的 PowerShell 環境，而 toohello 文件，網址<https://github.com/Azure/azure-sdk-tools#get-started>
2. **虛擬機器的**： 使用 hello Get AzureVMMicrosoftAntimalwareExtension 反惡意程式碼 cmdlet tooget hello 反惡意程式碼組態述<http://msdn.microsoft.com/library/azure/dn771719.aspx>
3. **雲端服務的**： 使用 hello Get AzureServiceAntimalwareConfig 反惡意程式碼 cmdlet tooget hello 反惡意程式碼組態述<http://msdn.microsoft.com/library/azure/dn771722.aspx>

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>使用 PowerShell Cmdlet 來移除 Antimalware 組態
Azure 應用程式或服務可以移除 hello 反惡意程式碼組態和任何相關聯的反惡意程式碼的監視設定 hello 相關 Azure 反惡意程式碼和診斷服務延伸模組相關聯 hello 雲端服務或虛擬機器。

tooremove Microsoft 反惡意程式碼使用 PowerShell cmdlet:

1. 設定您的 PowerShell 環境，而 toohello 文件，網址<https://github.com/Azure/azure-sdk-tools#get-started>
2. **虛擬機器的**: hello 移除 AzureVMMicrosoftAntimalwareExtension 反惡意程式碼指令程式，作為記錄在<http://msdn.microsoft.com/library/azure/dn771720.aspx>
3. **雲端服務：**述使用 hello 移除 AzureServiceAntimalwareExtension 反惡意程式碼指令程式<http://msdn.microsoft.com/library/azure/dn771717.aspx>

太**啟用**反惡意程式碼的虛擬機器使用的事件集合 hello Azure 預覽入口網站：

1. 按一下 hello 監視透鏡 hello 虛擬機器刀鋒視窗中的任何組件
2. 按一下 計量刀鋒伺服器上的 hello 診斷命令
3. 選取**狀態**ON，並檢查 Windows 事件系統的 hello 選項
4. . 您可以在 hello 清單中，選擇的 toouncheck 所有其他選項，或將其啟用每個應用程式的服務需要保留。
5. hello 反惡意程式碼的事件類別目錄 「 錯誤 」、 「 警告 」，「 資訊 」，以此類推，會擷取您的 Azure 儲存體帳戶。

從 hello Windows 事件系統記錄檔 tooyour Azure 儲存體帳戶收集的反惡意程式碼的事件。 您可以設定為您的虛擬機器 toocollect 反惡意程式碼事件的 hello 儲存體帳戶，藉由選取 hello 適當的儲存體帳戶。

![度量和診斷](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> 如需有關如何 tooDiagnostics Azure 反惡意程式碼，記錄讀取[啟用診斷記錄的 Azure 反惡意程式碼](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/)。
>
>

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>使用 PowerShell Cmdlet 來啟用和設定 Antimalware 監視
您可以透過 Antimalware PowerShell cmdlet 使用 Azure 診斷來啟用雲端服務或虛擬機器的 Microsoft Antimalware 事件集合。 hello 延伸可以是 Azure 診斷設定 toocapture hello 系統事件記錄檔來源 」 Microsoft 反惡意程式碼 」 tooyour Azure 儲存體帳戶的事件。 hello 反惡意程式碼的事件類別目錄 「 錯誤 」、 「 警告 」，「 資訊 」，以此類推，會擷取您的 Azure 儲存體帳戶。

tooenable 反惡意程式碼事件集合 tooyour Azure 儲存體帳戶使用 PowerShell cmdlet:

1. 設定您的 PowerShell 環境-請參閱太<https://github.com/Azure/azure-sdk-tools#get-started>
2. **虛擬機器的**-監視 ON 選項使用 hello 組 AzureVMMicrosoftAntimalwareExtension 反惡意程式碼 cmdlet 述<http://msdn.microsoft.com/library/azure/dn771716.aspx>
3. **雲端服務的**-監視 ON 選項使用 hello 組 AzureServiceAntimalwareExtension 反惡意程式碼 cmdlet 述<http://msdn.microsoft.com/library/azure/dn771718.aspx>

您可以藉由查看您設定 tooenable 反惡意程式碼監視 Azure 儲存體帳戶中的 hello WADWindowsEventLogsTable 資料表檢視 hello 反惡意程式碼的原始事件。 這可以是使用反惡意程式碼事件的集合，包括取得深入了解 hello 反惡意程式碼服務的健全狀況的有用 toovalidate。 如需詳細資訊，包括如何的範例程式碼太 tooextract 反惡意程式碼事件，從儲存體帳戶，請參閱[Microsoft 反惡意程式碼的 Azure-程式碼範例](http://aka.ms/amazsamples "Microsoft 反惡意程式碼的 Azure-的程式碼範例").
