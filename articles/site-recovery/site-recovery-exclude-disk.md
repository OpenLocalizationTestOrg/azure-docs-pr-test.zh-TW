---
title: "使用 Azure Site Recovery 的保護 aaaExclude 磁碟 |Microsoft 文件"
description: "描述原因和方式 tooexclude VM 磁碟從複寫案例的 VMware tooAzure 與 HYPER-V tooAzure。"
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 06/05/2017
ms.author: nisoneji
ms.openlocfilehash: f47146bc57aeab3fce90123d0894fa86dde93417
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="exclude-disks-from-replication"></a><span data-ttu-id="58bae-103">從複寫排除磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-103">Exclude disks from replication</span></span>
<span data-ttu-id="58bae-104">本文說明如何 tooexclude 磁碟從複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-104">This article describes how tooexclude disks from replication.</span></span> <span data-ttu-id="58bae-105">這個排除動作可最佳化 hello 耗用複寫頻寬，或最佳化 hello 目標端資源，以便利用這類磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-105">This exclusion can optimize hello consumed replication bandwidth or optimize hello target-side resources that such disks utilize.</span></span> <span data-ttu-id="58bae-106">hello 功能支援的 VMware tooAzure 和 HYPER-V tooAzure 的案例。</span><span class="sxs-lookup"><span data-stu-id="58bae-106">hello feature is supported for scenarios of VMware tooAzure and Hyper-V tooAzure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="58bae-107">必要條件</span><span class="sxs-lookup"><span data-stu-id="58bae-107">Prerequisites</span></span>

<span data-ttu-id="58bae-108">依預設會複寫機器上的所有磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-108">By default, all disks on a machine are replicated.</span></span> <span data-ttu-id="58bae-109">tooexclude 磁碟從複寫中，您必須手動安裝行動服務的 hello hello 電腦上您啟用複寫，如果您從 VMware tooAzure 複寫之前。</span><span class="sxs-lookup"><span data-stu-id="58bae-109">tooexclude a disk from replication, you must manually install hello Mobility service on hello machine before you enable replication if you are replicating from VMware tooAzure.</span></span>


## <a name="why-exclude-disks-from-replication"></a><span data-ttu-id="58bae-110">為什麼要排除磁碟不要複寫？</span><span class="sxs-lookup"><span data-stu-id="58bae-110">Why exclude disks from replication?</span></span>
<span data-ttu-id="58bae-111">排除磁碟不要複寫往往是因為︰</span><span class="sxs-lookup"><span data-stu-id="58bae-111">Excluding disks from replication is often necessary because:</span></span>

- <span data-ttu-id="58bae-112">變換 hello 排除磁碟的 hello 資料並不重要，或不需要 toobe 複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-112">hello data that's churned on hello excluded disk is not important or doesn’t need toobe replicated.</span></span>

- <span data-ttu-id="58bae-113">您想要 toosave 儲存體和網路資源不在複寫此變換。</span><span class="sxs-lookup"><span data-stu-id="58bae-113">You want toosave storage and network resources by not replicating this churn.</span></span>

## <a name="what-are-hello-typical-scenarios"></a><span data-ttu-id="58bae-114">Hello 典型案例有哪些？</span><span class="sxs-lookup"><span data-stu-id="58bae-114">What are hello typical scenarios?</span></span>
<span data-ttu-id="58bae-115">您可以識別資料變換的特定範例，它是排除的絕佳候選項目。</span><span class="sxs-lookup"><span data-stu-id="58bae-115">You can identify specific examples of data churn that are great candidates for exclusion.</span></span> <span data-ttu-id="58bae-116">可能的範例包括寫入 tooa 分頁檔 (pagefile.sys)，並將 toohello tempdb 檔案的 Microsoft SQL Server。</span><span class="sxs-lookup"><span data-stu-id="58bae-116">Examples might include writes tooa paging file (pagefile.sys) and writes toohello tempdb file of Microsoft SQL Server.</span></span> <span data-ttu-id="58bae-117">根據 hello 工作負載和 hello 儲存子系統，hello 分頁檔可以註冊大量的變換。</span><span class="sxs-lookup"><span data-stu-id="58bae-117">Depending on hello workload and hello storage subsystem, hello paging file can register a significant amount of churn.</span></span> <span data-ttu-id="58bae-118">不過，從 hello 主要站台 tooAzure 複寫這項資料會需要大量資源。</span><span class="sxs-lookup"><span data-stu-id="58bae-118">However, replicating this data from hello primary site tooAzure would be resource intensive.</span></span> <span data-ttu-id="58bae-119">因此，您可以使用下列步驟 toooptimize 複寫虛擬機器具有 hello 作業系統和 hello 分頁檔的單一虛擬磁碟的 hello:</span><span class="sxs-lookup"><span data-stu-id="58bae-119">Thus, you can use hello following steps toooptimize replication of a virtual machine with a single virtual disk that has both hello operating system and hello paging file:</span></span>

1. <span data-ttu-id="58bae-120">將 hello 單一虛擬磁碟分割成兩個虛擬磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-120">Split hello single virtual disk into two virtual disks.</span></span> <span data-ttu-id="58bae-121">一個虛擬磁碟 hello 作業系統，而且其他 hello hello 分頁檔。</span><span class="sxs-lookup"><span data-stu-id="58bae-121">One virtual disk has hello operating system, and hello other has hello paging file.</span></span>
2. <span data-ttu-id="58bae-122">從複寫排除 hello 分頁檔案的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-122">Exclude hello paging file disk from replication.</span></span>

<span data-ttu-id="58bae-123">同樣地，您可以使用下列步驟 toooptimize，有兩個 hello Microsoft SQL Server tempdb fie hello 並 hello 系統資料庫檔案：</span><span class="sxs-lookup"><span data-stu-id="58bae-123">Similarly, you can use hello following steps toooptimize a disk that has both hello Microsoft SQL Server tempdb fie and hello system database file:</span></span>

1. <span data-ttu-id="58bae-124">兩個不同的磁碟上保留 hello 系統資料庫和 tempdb。</span><span class="sxs-lookup"><span data-stu-id="58bae-124">Keep hello system database and tempdb on two different disks.</span></span>
2. <span data-ttu-id="58bae-125">從複寫排除 hello tempdb 磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-125">Exclude hello tempdb disk from replication.</span></span>

## <a name="how-tooexclude-disks-from-replication"></a><span data-ttu-id="58bae-126">如何 tooexclude 磁碟從複寫嗎？</span><span class="sxs-lookup"><span data-stu-id="58bae-126">How tooexclude disks from replication?</span></span>

### <a name="vmware-tooazure"></a><span data-ttu-id="58bae-127">VMware tooAzure</span><span class="sxs-lookup"><span data-stu-id="58bae-127">VMware tooAzure</span></span>
<span data-ttu-id="58bae-128">請遵循 hello[啟用複寫](site-recovery-vmware-to-azure.md)工作流程 tooprotect hello Azure Site Recovery 入口網站中的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="58bae-128">Follow hello [Enable replication](site-recovery-vmware-to-azure.md) workflow tooprotect a virtual machine from hello Azure Site Recovery portal.</span></span> <span data-ttu-id="58bae-129">在 hello hello 工作流程的第四個步驟，使用 hello**磁碟 tooREPLICATE**資料行 tooexclude 磁碟從複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-129">In hello fourth step of hello workflow, use hello **DISK tooREPLICATE** column tooexclude disks from replication.</span></span> <span data-ttu-id="58bae-130">依預設會選取所有磁碟進行複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-130">By default, all disks are selected for replication.</span></span> <span data-ttu-id="58bae-131">清除您要從複寫，然後完成 hello 步驟 tooenable 複寫 tooexclude 磁碟 hello 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="58bae-131">Clear hello check box of disks that you want tooexclude from replication, and then complete hello steps tooenable replication.</span></span>

![從複寫排除磁碟，並啟用 VMware tooAzure 容錯回復複寫](./media/site-recovery-exclude-disk/v2a-enable-replication-exclude-disk1.png)


>[!NOTE]
>
> * <span data-ttu-id="58bae-133">您可以排除已擁有 hello 行動服務安裝的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-133">You can exclude only disks that already have hello Mobility service installed.</span></span> <span data-ttu-id="58bae-134">您需要 toomanually 安裝 hello 行動服務，因為使用 hello 發送機制啟用複寫後，才會安裝 hello 行動服務。</span><span class="sxs-lookup"><span data-stu-id="58bae-134">You need toomanually install hello Mobility service, because hello Mobility service is only installed by using hello push mechanism after replication is enabled.</span></span>
> * <span data-ttu-id="58bae-135">只有基本磁碟可以從複寫排除。</span><span class="sxs-lookup"><span data-stu-id="58bae-135">Only basic disks can be excluded from replication.</span></span> <span data-ttu-id="58bae-136">您無法排除作業系統或動態磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-136">You can't exclude operating system or dynamic disks.</span></span>
> * <span data-ttu-id="58bae-137">啟用複寫之後，您無法新增或移除磁碟以進行複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-137">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="58bae-138">如果您想 tooadd 或排除磁碟，您需要 toodisable 保護 hello 機器，並再重新啟用。</span><span class="sxs-lookup"><span data-stu-id="58bae-138">If you want tooadd or exclude a disk, you need toodisable protection for hello machine and then enable it again.</span></span>
> * <span data-ttu-id="58bae-139">如果您排除已針對應用程式 toooperate，容錯移轉 tooAzure 之後所需的磁碟必須 toocreate hello 磁碟在 Azure 中以手動方式使 hello 複寫應用程式可執行。</span><span class="sxs-lookup"><span data-stu-id="58bae-139">If you exclude a disk that's needed for an application toooperate, after failover tooAzure, you’ll need toocreate hello disk manually in Azure so that hello replicated application can run.</span></span> <span data-ttu-id="58bae-140">或者，您可以整合 Azure 自動化的復原計劃 toocreate hello 磁碟 hello 機器容錯移轉期間。</span><span class="sxs-lookup"><span data-stu-id="58bae-140">Alternatively, you can integrate Azure automation into a recovery plan toocreate hello disk during failover of hello machine.</span></span>
> * <span data-ttu-id="58bae-141">Windows 虛擬機器：您以手動方式在 Azure 中建立的磁碟將不會容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-141">Window virtual machine: Disks that you create manually in Azure are not failed back.</span></span> <span data-ttu-id="58bae-142">例如，如果您容錯移轉三個磁碟，並直接在 Azure 虛擬機器中建立兩個磁碟，則只有三個已容錯移轉的磁碟會容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-142">For example, if you fail over three disks and create two disk directly in Azure Virtual Machines, only three disks that were failed over are failed back.</span></span> <span data-ttu-id="58bae-143">您不能包含容錯移轉或重新保護從內部部署 tooAzure 中手動建立的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-143">You can't include disks that you created manually in failback or in reprotect from on-premises tooAzure.</span></span>
> * <span data-ttu-id="58bae-144">Linux 虛擬機器：您以手動方式在 Azure 中建立的磁碟將會容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-144">Linux virtual machine: Disks that you create manually in Azure are failed back.</span></span> <span data-ttu-id="58bae-145">例如，如果您容錯移轉三個磁碟，並直接在 Azure 虛擬機器中建立兩個磁碟，則五個磁碟全都將容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-145">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, all five will be failed back.</span></span> <span data-ttu-id="58bae-146">您無法從容錯回復排除手動建立的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-146">You can't exclude disks that were created manually from failback.</span></span>
>

### <a name="hyper-v-tooazure"></a><span data-ttu-id="58bae-147">HYPER-V tooAzure</span><span class="sxs-lookup"><span data-stu-id="58bae-147">Hyper-V tooAzure</span></span>
<span data-ttu-id="58bae-148">請遵循 hello[啟用複寫](site-recovery-hyper-v-site-to-azure.md)工作流程 tooprotect hello Azure Site Recovery 入口網站中的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="58bae-148">Follow hello [Enable replication](site-recovery-hyper-v-site-to-azure.md) workflow tooprotect a virtual machine from hello Azure Site Recovery portal.</span></span> <span data-ttu-id="58bae-149">在 hello hello 工作流程的第四個步驟，使用 hello**磁碟 tooREPLICATE**資料行 tooexclude 磁碟從複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-149">In hello fourth step of hello workflow, use hello **DISK tooREPLICATE** column tooexclude disks from replication.</span></span> <span data-ttu-id="58bae-150">依預設會選取所有磁碟進行複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-150">By default, all disks are selected for replication.</span></span> <span data-ttu-id="58bae-151">清除您要從複寫，然後完成 hello 步驟 tooenable 複寫 tooexclude 磁碟 hello 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="58bae-151">Clear hello check box of disks that you want tooexclude from replication, and then complete hello steps tooenable replication.</span></span>

![從複寫排除磁碟，並啟用 HYPER-V tooAzure 容錯回復複寫](./media/site-recovery-vmm-to-azure/enable-replication6-with-exclude-disk.png)

>[!NOTE]
>
> * <span data-ttu-id="58bae-153">您只能排除基本磁碟不要複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-153">You can exclude only basic disks from replication.</span></span> <span data-ttu-id="58bae-154">您無法排除作業系統磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-154">You can't exclude operating system disks.</span></span> <span data-ttu-id="58bae-155">我們建議您不要排除動態磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-155">We recommend that you do not exclude dynamic disks.</span></span> <span data-ttu-id="58bae-156">Azure Site Recovery 無法識別哪些虛擬硬碟 (VHD) 是基本或動態 hello 客體虛擬機器中。</span><span class="sxs-lookup"><span data-stu-id="58bae-156">Azure Site Recovery cannot identify which virtual hard disk (VHD) is basic or dynamic in hello guest virtual machine.</span></span>  <span data-ttu-id="58bae-157">如果不排除所有相依的動態磁碟區磁碟，hello 受保護的動態磁碟會容錯移轉虛擬機器上的故障的磁碟，hello 該磁碟上的資料無法存取。</span><span class="sxs-lookup"><span data-stu-id="58bae-157">If all dependent dynamic volume disks are not excluded, hello protected dynamic disk becomes a failed disk on a failover virtual machine, and hello data on that disk is not accessible.</span></span>
> * <span data-ttu-id="58bae-158">啟用複寫之後，您無法新增或移除磁碟以進行複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-158">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="58bae-159">如果您想 tooadd 或排除磁碟，您需要 toodisable 保護 hello 虛擬機器，並再重新啟用。</span><span class="sxs-lookup"><span data-stu-id="58bae-159">If you want tooadd or exclude a disk, you need toodisable protection for hello virtual machine and then enable it again.</span></span>
> * <span data-ttu-id="58bae-160">如果您排除的應用程式 toooperate 所需的磁碟，tooAzure 容錯移轉之後您還需要 toocreate hello 磁碟以手動方式在 Azure 中的以便在執行複寫的 hello 應用程式。</span><span class="sxs-lookup"><span data-stu-id="58bae-160">If you exclude a disk that's needed for an application toooperate, after failover tooAzure you’ll need toocreate hello disk manually in Azure so that hello replicated application can run.</span></span> <span data-ttu-id="58bae-161">或者，您可以整合 Azure 自動化的復原計劃 toocreate hello 磁碟 hello 機器容錯移轉期間。</span><span class="sxs-lookup"><span data-stu-id="58bae-161">Alternatively, you can integrate Azure automation into a recovery plan toocreate hello disk during failover of hello machine.</span></span>
> * <span data-ttu-id="58bae-162">您以手動方式在 Azure 中建立的磁碟不會容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-162">Disks that you create manually in Azure will not be failed back.</span></span> <span data-ttu-id="58bae-163">比方說，如果您無法超過三個磁碟，並直接在 Azure 虛擬機器建立兩個磁碟只有三個磁碟已容錯移轉將無法從 Azure tooHyper-V。</span><span class="sxs-lookup"><span data-stu-id="58bae-163">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, only three disks that were failed over will be failed back from Azure tooHyper-V.</span></span> <span data-ttu-id="58bae-164">您不能包含在容錯回復或從 HYPER-V tooAzure 反轉複寫中手動建立的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-164">You can't include disks that were created manually in failback or in reverse replication from Hyper-V tooAzure.</span></span>



## <a name="end-to-end-scenarios-of-exclude-disks"></a><span data-ttu-id="58bae-165">排除磁碟的端對端案例</span><span class="sxs-lookup"><span data-stu-id="58bae-165">End-to-end scenarios of exclude disks</span></span>
<span data-ttu-id="58bae-166">讓我們考慮兩個案例 toounderstand hello 排除磁碟功能：</span><span class="sxs-lookup"><span data-stu-id="58bae-166">Let's consider two scenarios toounderstand hello exclude disk feature:</span></span>

- <span data-ttu-id="58bae-167">SQL Server tempdb 磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-167">SQL Server tempdb disk</span></span>
- <span data-ttu-id="58bae-168">分頁檔 (pagefile.sys) 磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-168">Paging file (pagefile.sys) disk</span></span>

### <a name="exclude-hello-sql-server-tempdb-disk"></a><span data-ttu-id="58bae-169">排除 hello SQL Server tempdb 磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-169">Exclude hello SQL Server tempdb disk</span></span>
<span data-ttu-id="58bae-170">我們來看一下有 tempdb 可排除的 SQL Server 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="58bae-170">Let's consider a SQL Server virtual machine that has a tempdb that can be excluded.</span></span>

<span data-ttu-id="58bae-171">hello hello 虛擬磁碟名稱是 SalesDB。</span><span class="sxs-lookup"><span data-stu-id="58bae-171">hello name of hello virtual disk is SalesDB.</span></span>

<span data-ttu-id="58bae-172">如下所示為 hello 來源虛擬機器上的磁碟：</span><span class="sxs-lookup"><span data-stu-id="58bae-172">Disks on hello source virtual machine are as follows:</span></span>


<span data-ttu-id="58bae-173">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-173">**Disk name**</span></span> | <span data-ttu-id="58bae-174">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-174">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-175">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-175">**Drive letter**</span></span> | <span data-ttu-id="58bae-176">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-176">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-177">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-177">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-178">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-178">DISK0</span></span> | <span data-ttu-id="58bae-179">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-179">C:\\</span></span> | <span data-ttu-id="58bae-180">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-180">Operating system disk</span></span>
<span data-ttu-id="58bae-181">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-181">DB-Disk1</span></span>| <span data-ttu-id="58bae-182">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-182">Disk1</span></span> | <span data-ttu-id="58bae-183">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-183">D:\\</span></span> | <span data-ttu-id="58bae-184">SQL 系統資料庫和使用者資料庫 1</span><span class="sxs-lookup"><span data-stu-id="58bae-184">SQL system database and User Database1</span></span>
<span data-ttu-id="58bae-185">DB Disk2 （排除不予保護的 hello 磁碟）</span><span class="sxs-lookup"><span data-stu-id="58bae-185">DB-Disk2 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="58bae-186">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-186">Disk2</span></span> | <span data-ttu-id="58bae-187">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-187">E:\\</span></span> | <span data-ttu-id="58bae-188">暫存檔案</span><span class="sxs-lookup"><span data-stu-id="58bae-188">Temp files</span></span>
<span data-ttu-id="58bae-189">DB Disk3 （排除不予保護的 hello 磁碟）</span><span class="sxs-lookup"><span data-stu-id="58bae-189">DB-Disk3 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="58bae-190">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-190">Disk3</span></span> | <span data-ttu-id="58bae-191">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-191">F:\\</span></span> | <span data-ttu-id="58bae-192">SQL tempdb 資料庫 (資料夾路徑 (F:\MSSQL\Data\) </b / >< / b / > 寫下 hello 容錯移轉之前的資料夾路徑。</span><span class="sxs-lookup"><span data-stu-id="58bae-192">SQL tempdb database (folder path(F:\MSSQL\Data\) </br /> </br />Write down hello folder path before failover.</span></span>
<span data-ttu-id="58bae-193">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="58bae-193">DB-Disk4</span></span> | <span data-ttu-id="58bae-194">Disk4</span><span class="sxs-lookup"><span data-stu-id="58bae-194">Disk4</span></span> |<span data-ttu-id="58bae-195">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-195">G:\\</span></span> |<span data-ttu-id="58bae-196">使用者資料庫 2</span><span class="sxs-lookup"><span data-stu-id="58bae-196">User Database2</span></span>

<span data-ttu-id="58bae-197">因為 hello 虛擬機器的兩個磁碟上的資料變換量暫時性的而您也可以保護 hello SalesDB 虛擬機器，請從複寫排除 Disk2 和 Disk3。</span><span class="sxs-lookup"><span data-stu-id="58bae-197">Because data churn on two disks of hello virtual machine is temporary, while you protect hello SalesDB virtual machine, exclude Disk2 and Disk3 from replication.</span></span> <span data-ttu-id="58bae-198">Azure Site Recovery 不會複寫這些磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-198">Azure Site Recovery will not replicate those disks.</span></span> <span data-ttu-id="58bae-199">在容錯移轉時，這些磁碟不會出現在 Azure 上的 hello 容錯移轉虛擬機器上。</span><span class="sxs-lookup"><span data-stu-id="58bae-199">On failover, those disks will not be present on hello failover virtual machine on Azure.</span></span>

<span data-ttu-id="58bae-200">如下所示為 hello 容錯移轉後的 Azure 虛擬機器上的磁碟：</span><span class="sxs-lookup"><span data-stu-id="58bae-200">Disks on hello Azure virtual machine after failover are as follows:</span></span>

<span data-ttu-id="58bae-201">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-201">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-202">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-202">**Drive letter**</span></span> | <span data-ttu-id="58bae-203">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-203">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="58bae-204">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-204">DISK0</span></span> | <span data-ttu-id="58bae-205">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-205">C:\\</span></span> | <span data-ttu-id="58bae-206">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-206">Operating system disk</span></span>
<span data-ttu-id="58bae-207">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-207">Disk1</span></span> | <span data-ttu-id="58bae-208">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-208">E:\\</span></span> | <span data-ttu-id="58bae-209">暫存儲存位置 </b / >< / b / > Azure 新增此磁碟，並指派 hello 第一個可用的磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="58bae-209">Temporary storage</br /> </br />Azure adds this disk and assigns hello first available drive letter.</span></span>
<span data-ttu-id="58bae-210">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-210">Disk2</span></span> | <span data-ttu-id="58bae-211">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-211">D:\\</span></span> | <span data-ttu-id="58bae-212">SQL 系統資料庫和使用者資料庫 1</span><span class="sxs-lookup"><span data-stu-id="58bae-212">SQL system database and User Database1</span></span>
<span data-ttu-id="58bae-213">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-213">Disk3</span></span> | <span data-ttu-id="58bae-214">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-214">G:\\</span></span> | <span data-ttu-id="58bae-215">使用者資料庫 2</span><span class="sxs-lookup"><span data-stu-id="58bae-215">User Database2</span></span>

<span data-ttu-id="58bae-216">因為 Disk2 Disk3 已排除 hello SalesDB 虛擬機器，e： 是 hello 第一個磁碟機代號從 hello 可用的清單。</span><span class="sxs-lookup"><span data-stu-id="58bae-216">Because Disk2 and Disk3 were excluded from hello SalesDB virtual machine, E: is hello first drive letter from hello available list.</span></span> <span data-ttu-id="58bae-217">Azure 將指派 e: toohello 暫時存放磁碟區。</span><span class="sxs-lookup"><span data-stu-id="58bae-217">Azure assigns E: toohello temporary storage volume.</span></span> <span data-ttu-id="58bae-218">所有的複寫 hello 磁碟 hello 磁碟機代號維持 hello 相同。</span><span class="sxs-lookup"><span data-stu-id="58bae-218">For all hello replicated disks, hello drive letters remain hello same.</span></span>

<span data-ttu-id="58bae-219">Disk3，這是 hello SQL tempdb 磁碟 (tempdb 資料夾路徑 F:\MSSQL\Data\)，已從複寫排除。</span><span class="sxs-lookup"><span data-stu-id="58bae-219">Disk3, which was hello SQL tempdb disk (tempdb folder path F:\MSSQL\Data\), was excluded from replication.</span></span> <span data-ttu-id="58bae-220">hello 磁碟不是 hello 容錯移轉虛擬機器上。</span><span class="sxs-lookup"><span data-stu-id="58bae-220">hello disk is not available on hello failover virtual machine.</span></span> <span data-ttu-id="58bae-221">如此一來，hello SQL 服務處於停止狀態，而且必須 hello F:\MSSQL\Data 路徑。</span><span class="sxs-lookup"><span data-stu-id="58bae-221">As a result, hello SQL service is in a stopped state, and it needs hello F:\MSSQL\Data path.</span></span>

<span data-ttu-id="58bae-222">有兩種方式 toocreate 這個路徑：</span><span class="sxs-lookup"><span data-stu-id="58bae-222">There are two ways toocreate this path:</span></span>

- <span data-ttu-id="58bae-223">新增磁碟和指派 tempdb 資料夾路徑。</span><span class="sxs-lookup"><span data-stu-id="58bae-223">Add a new disk and assign tempdb folder path.</span></span>
- <span data-ttu-id="58bae-224">使用現有的暫存磁碟機為 hello tempdb 資料夾路徑。</span><span class="sxs-lookup"><span data-stu-id="58bae-224">Use an existing temporary storage disk for hello tempdb folder path.</span></span>

#### <a name="add-a-new-disk"></a><span data-ttu-id="58bae-225">新增磁碟：</span><span class="sxs-lookup"><span data-stu-id="58bae-225">Add a new disk:</span></span>

1. <span data-ttu-id="58bae-226">記下 SQL tempdb.mdf 和容錯移轉之前 tempdb.ldf hello 路徑。</span><span class="sxs-lookup"><span data-stu-id="58bae-226">Write down hello paths of SQL tempdb.mdf and tempdb.ldf before failover.</span></span>
2. <span data-ttu-id="58bae-227">Hello Azure 入口網站，加入新磁碟 toohello 容錯移轉的虛擬機器以 hello 相同或更多的大小與 hello 來源 SQL tempdb 磁碟 (Disk3)。</span><span class="sxs-lookup"><span data-stu-id="58bae-227">From hello Azure portal, add a new disk toohello failover virtual machine with hello same or more size as that of hello source SQL tempdb disk (Disk3).</span></span>
3. <span data-ttu-id="58bae-228">登入 toohello Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="58bae-228">Sign in toohello Azure virtual machine.</span></span> <span data-ttu-id="58bae-229">從 hello 磁碟管理 (diskmgmt.msc) 主控台中，初始化和格式 hello 新增磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-229">From hello disk management (diskmgmt.msc) console, initialize and format hello newly added disk.</span></span>
4. <span data-ttu-id="58bae-230">相同磁碟機代號 hello SQL tempdb 磁碟 （f:） 所使用的指派 hello。</span><span class="sxs-lookup"><span data-stu-id="58bae-230">Assign hello same drive letter that was used by hello SQL tempdb disk (F:).</span></span>
5. <span data-ttu-id="58bae-231">Tempdb 上建立資料夾 hello f： 磁碟區 (F:\MSSQL\Data)。</span><span class="sxs-lookup"><span data-stu-id="58bae-231">Create a tempdb folder on hello F: volume (F:\MSSQL\Data).</span></span>
6. <span data-ttu-id="58bae-232">從 hello 服務主控台中啟動 hello SQL 服務。</span><span class="sxs-lookup"><span data-stu-id="58bae-232">Start hello SQL service from hello service console.</span></span>

#### <a name="use-an-existing-temporary-storage-disk-for-hello-sql-tempdb-folder-path"></a><span data-ttu-id="58bae-233">使用現有的暫存磁碟機為 hello SQL tempdb 資料夾路徑：</span><span class="sxs-lookup"><span data-stu-id="58bae-233">Use an existing temporary storage disk for hello SQL tempdb folder path:</span></span>

1. <span data-ttu-id="58bae-234">開啟命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="58bae-234">Open a command prompt.</span></span>
2. <span data-ttu-id="58bae-235">Hello 命令提示字元中，在復原模式下執行 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="58bae-235">Run SQL Server in recovery mode from hello command prompt.</span></span>

        Net start MSSQLSERVER /f / T3608

3. <span data-ttu-id="58bae-236">執行下列 sqlcmd toochange hello tempdb toohello 新路徑的 hello。</span><span class="sxs-lookup"><span data-stu-id="58bae-236">Run hello following sqlcmd toochange hello tempdb path toohello new path.</span></span>

        sqlcmd -A -S SalesDB        **Use your SQL DBname**
        USE master;     
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = tempdev, FILENAME = 'E:\MSSQL\tempdata\tempdb.mdf');
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = templog, FILENAME = 'E:\MSSQL\tempdata\templog.ldf');       
        GO


4. <span data-ttu-id="58bae-237">停止 hello Microsoft SQL Server 服務。</span><span class="sxs-lookup"><span data-stu-id="58bae-237">Stop hello Microsoft SQL Server service.</span></span>

        Net stop MSSQLSERVER
5. <span data-ttu-id="58bae-238">啟動 hello Microsoft SQL Server 服務。</span><span class="sxs-lookup"><span data-stu-id="58bae-238">Start hello Microsoft SQL Server service.</span></span>

        Net start MSSQLSERVER

<span data-ttu-id="58bae-239">請參閱 toohello 遵循的暫存磁碟的 Azure 指導方針：</span><span class="sxs-lookup"><span data-stu-id="58bae-239">Refer toohello following Azure guideline for temporary storage disk:</span></span>

* [<span data-ttu-id="58bae-240">在 Azure Vm toostore SQL Server TempDB 和緩衝集區延伸模組中使用 Ssd</span><span class="sxs-lookup"><span data-stu-id="58bae-240">Using SSDs in Azure VMs toostore SQL Server TempDB and Buffer Pool Extensions</span></span>](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/)
* [<span data-ttu-id="58bae-241">Azure 虛擬機器中的 SQL Server 效能最佳做法</span><span class="sxs-lookup"><span data-stu-id="58bae-241">Performance best practices for SQL Server in Azure Virtual Machines</span></span>](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-performance)

### <a name="failback-from-azure-tooan-on-premises-host"></a><span data-ttu-id="58bae-242">（從 Azure tooan 在內部部署主機） 的容錯回復</span><span class="sxs-lookup"><span data-stu-id="58bae-242">Failback (from Azure tooan on-premises host)</span></span>
<span data-ttu-id="58bae-243">現在讓我們了解當您從 Azure tooyour 在內部部署 VMware 或 HYPER-V 主機容錯移轉複寫的 hello 磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-243">Now let's understand hello disks that are replicated when you fail over from Azure tooyour on-premises VMware or Hyper-V host.</span></span> <span data-ttu-id="58bae-244">您以手動方式在 Azure 中建立的磁碟不會複寫。</span><span class="sxs-lookup"><span data-stu-id="58bae-244">Disks that you create manually in Azure will not be replicated.</span></span> <span data-ttu-id="58bae-245">例如，如果您容錯移轉三個磁碟，並直接在 Azure 虛擬機器中建立兩個磁碟，則只有三個已容錯移轉的磁碟會容錯回復。</span><span class="sxs-lookup"><span data-stu-id="58bae-245">For example, if you fail over three disks and create two directly in Azure Virtual Machines, only three disks that were failed over will be failed back.</span></span> <span data-ttu-id="58bae-246">您不能包含在容錯回復或重新保護從內部部署 tooAzure 中手動建立的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-246">You can't include disks that were created manually in failback or in reprotect from on-premises tooAzure.</span></span> <span data-ttu-id="58bae-247">它也不會複寫 hello 暫存磁碟 tooon 內部部署主機。</span><span class="sxs-lookup"><span data-stu-id="58bae-247">It also does not replicate hello temporary storage disk tooon-premises hosts.</span></span>

#### <a name="failback-toooriginal-location-recovery"></a><span data-ttu-id="58bae-248">容錯回復 toooriginal 位置復原</span><span class="sxs-lookup"><span data-stu-id="58bae-248">Failback toooriginal location recovery</span></span>

<span data-ttu-id="58bae-249">Hello 上述範例中，在 hello Azure 虛擬機器是磁碟組態，如下所示：</span><span class="sxs-lookup"><span data-stu-id="58bae-249">In hello previous example, hello Azure virtual machine disk configuration is as follows:</span></span>

<span data-ttu-id="58bae-250">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-250">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-251">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-251">**Drive letter**</span></span> | <span data-ttu-id="58bae-252">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-252">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="58bae-253">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-253">DISK0</span></span> | <span data-ttu-id="58bae-254">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-254">C:\\</span></span> | <span data-ttu-id="58bae-255">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-255">Operating system disk</span></span>
<span data-ttu-id="58bae-256">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-256">Disk1</span></span> | <span data-ttu-id="58bae-257">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-257">E:\\</span></span> | <span data-ttu-id="58bae-258">暫存儲存位置 </b / >< / b / > Azure 新增此磁碟，並指派 hello 第一個可用的磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="58bae-258">Temporary storage</br /> </br />Azure adds this disk and assigns hello first available drive letter.</span></span>
<span data-ttu-id="58bae-259">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-259">Disk2</span></span> | <span data-ttu-id="58bae-260">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-260">D:\\</span></span> | <span data-ttu-id="58bae-261">SQL 系統資料庫和使用者資料庫 1</span><span class="sxs-lookup"><span data-stu-id="58bae-261">SQL system database and User Database1</span></span>
<span data-ttu-id="58bae-262">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-262">Disk3</span></span> | <span data-ttu-id="58bae-263">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-263">G:\\</span></span> | <span data-ttu-id="58bae-264">使用者資料庫 2</span><span class="sxs-lookup"><span data-stu-id="58bae-264">User Database2</span></span>


#### <a name="vmware-tooazure"></a><span data-ttu-id="58bae-265">VMware tooAzure</span><span class="sxs-lookup"><span data-stu-id="58bae-265">VMware tooAzure</span></span>
<span data-ttu-id="58bae-266">當容錯回復完成 toohello 原始位置時，hello 容錯回復虛擬機器磁碟組態中沒有排除的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-266">When failback is done toohello original location, hello failback virtual machine disk configuration does not have excluded disks.</span></span> <span data-ttu-id="58bae-267">從 VMware tooAzure 排除的磁碟不會 hello 容錯回復虛擬機器上。</span><span class="sxs-lookup"><span data-stu-id="58bae-267">Disks that were excluded from VMware tooAzure  will not be available on hello failback virtual machine.</span></span>

<span data-ttu-id="58bae-268">從 Azure tooon 內部部署 VMware 計劃的容錯移轉後, hello VMWare 虛擬機器 （原始位置） 上的磁碟如下：</span><span class="sxs-lookup"><span data-stu-id="58bae-268">After planned failover from Azure tooon-premises VMware, disks on hello VMWare virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="58bae-269">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-269">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-270">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-270">**Drive letter**</span></span> | <span data-ttu-id="58bae-271">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-271">**Data type on hello disk**</span></span>
--- | --- | ---
<span data-ttu-id="58bae-272">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-272">DISK0</span></span> | <span data-ttu-id="58bae-273">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-273">C:\\</span></span> | <span data-ttu-id="58bae-274">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-274">Operating system disk</span></span>
<span data-ttu-id="58bae-275">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-275">Disk1</span></span> | <span data-ttu-id="58bae-276">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-276">D:\\</span></span> | <span data-ttu-id="58bae-277">SQL 系統資料庫和使用者資料庫 1</span><span class="sxs-lookup"><span data-stu-id="58bae-277">SQL system database and User Database1</span></span>
<span data-ttu-id="58bae-278">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-278">Disk2</span></span> | <span data-ttu-id="58bae-279">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-279">G:\\</span></span> | <span data-ttu-id="58bae-280">使用者資料庫 2</span><span class="sxs-lookup"><span data-stu-id="58bae-280">User Database2</span></span>

#### <a name="hyper-v-tooazure"></a><span data-ttu-id="58bae-281">HYPER-V tooAzure</span><span class="sxs-lookup"><span data-stu-id="58bae-281">Hyper-V tooAzure</span></span>
<span data-ttu-id="58bae-282">容錯回復時 toohello 原始位置，hello 容錯回復虛擬機器磁碟組態會維持 hello 相同的 HYPER-V 的原始虛擬機器磁碟組態。</span><span class="sxs-lookup"><span data-stu-id="58bae-282">When failback is toohello original location, hello failback virtual machine disk configuration remains hello same as that of original virtual machine disk configuration for Hyper-V.</span></span> <span data-ttu-id="58bae-283">Hello 容錯回復虛擬機器上使用 HYPER-V 站台 tooAzure 已排除的磁碟。</span><span class="sxs-lookup"><span data-stu-id="58bae-283">Disks that were excluded from Hyper-V site tooAzure are available on hello failback virtual machine.</span></span>

<span data-ttu-id="58bae-284">從 Azure tooon 內部部署 HYPER-V 的規劃容錯移轉之後 hello HYPER-V 虛擬機器 （原始位置） 上的磁碟如下：</span><span class="sxs-lookup"><span data-stu-id="58bae-284">After planned failover from Azure tooon-premises Hyper-V, disks on hello Hyper-V virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="58bae-285">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-285">**Disk Name**</span></span> | <span data-ttu-id="58bae-286">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-286">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-287">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-287">**Drive letter**</span></span> | <span data-ttu-id="58bae-288">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-288">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-289">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-289">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-290">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-290">DISK0</span></span> |   <span data-ttu-id="58bae-291">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-291">C:\\</span></span> | <span data-ttu-id="58bae-292">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-292">Operating system disk</span></span>
<span data-ttu-id="58bae-293">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-293">DB-Disk1</span></span> | <span data-ttu-id="58bae-294">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-294">Disk1</span></span> | <span data-ttu-id="58bae-295">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-295">D:\\</span></span> | <span data-ttu-id="58bae-296">SQL 系統資料庫和使用者資料庫 1</span><span class="sxs-lookup"><span data-stu-id="58bae-296">SQL system database and User Database1</span></span>
<span data-ttu-id="58bae-297">DB-Disk2 (排除的磁碟)</span><span class="sxs-lookup"><span data-stu-id="58bae-297">DB-Disk2 (Excluded disk)</span></span> | <span data-ttu-id="58bae-298">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-298">Disk2</span></span> | <span data-ttu-id="58bae-299">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-299">E:\\</span></span> | <span data-ttu-id="58bae-300">暫存檔案</span><span class="sxs-lookup"><span data-stu-id="58bae-300">Temp files</span></span>
<span data-ttu-id="58bae-301">DB-Disk3 (排除的磁碟)</span><span class="sxs-lookup"><span data-stu-id="58bae-301">DB-Disk3 (Excluded disk)</span></span> | <span data-ttu-id="58bae-302">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-302">Disk3</span></span> | <span data-ttu-id="58bae-303">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-303">F:\\</span></span> | <span data-ttu-id="58bae-304">SQL tempdb 資料庫 (資料夾路徑 (F:\MSSQL\Data\)</span><span class="sxs-lookup"><span data-stu-id="58bae-304">SQL tempdb database (folder path(F:\MSSQL\Data\)</span></span>
<span data-ttu-id="58bae-305">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="58bae-305">DB-Disk4</span></span> | <span data-ttu-id="58bae-306">Disk4</span><span class="sxs-lookup"><span data-stu-id="58bae-306">Disk4</span></span> | <span data-ttu-id="58bae-307">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-307">G:\\</span></span> | <span data-ttu-id="58bae-308">使用者資料庫 2</span><span class="sxs-lookup"><span data-stu-id="58bae-308">User Database2</span></span>


#### <a name="exclude-hello-paging-file-pagefilesys-disk"></a><span data-ttu-id="58bae-309">排除 hello 分頁檔 (pagefile.sys) 磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-309">Exclude hello paging file (pagefile.sys) disk</span></span>

<span data-ttu-id="58bae-310">我們來看一下有分頁檔磁碟可排除的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="58bae-310">Let's consider a virtual machine that has a paging file disk that can be excluded.</span></span>
<span data-ttu-id="58bae-311">有兩種案例。</span><span class="sxs-lookup"><span data-stu-id="58bae-311">There are two cases.</span></span>

#### <a name="case-1-hello-paging-file-is-configured-on-hello-d-drive"></a><span data-ttu-id="58bae-312">案例 1: hello d： 磁碟機上設定 hello 分頁檔</span><span class="sxs-lookup"><span data-stu-id="58bae-312">Case 1: hello paging file is configured on hello D: drive</span></span>
<span data-ttu-id="58bae-313">以下是 hello 磁碟組態：</span><span class="sxs-lookup"><span data-stu-id="58bae-313">Here's hello disk configuration:</span></span>


<span data-ttu-id="58bae-314">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-314">**Disk name**</span></span> | <span data-ttu-id="58bae-315">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-315">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-316">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-316">**Drive letter**</span></span> | <span data-ttu-id="58bae-317">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-317">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-318">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-318">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-319">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-319">DISK0</span></span> | <span data-ttu-id="58bae-320">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-320">C:\\</span></span> | <span data-ttu-id="58bae-321">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-321">Operating system disk</span></span>
<span data-ttu-id="58bae-322">DB Disk1 （排除不予保護 hello hello 磁碟）</span><span class="sxs-lookup"><span data-stu-id="58bae-322">DB-Disk1 (Excluded hello disk from hello protection)</span></span> | <span data-ttu-id="58bae-323">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-323">Disk1</span></span> | <span data-ttu-id="58bae-324">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-324">D:\\</span></span> | <span data-ttu-id="58bae-325">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="58bae-325">pagefile.sys</span></span>
<span data-ttu-id="58bae-326">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-326">DB-Disk2</span></span> | <span data-ttu-id="58bae-327">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-327">Disk2</span></span> | <span data-ttu-id="58bae-328">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-328">E:\\</span></span> | <span data-ttu-id="58bae-329">使用者資料 1</span><span class="sxs-lookup"><span data-stu-id="58bae-329">User data 1</span></span>
<span data-ttu-id="58bae-330">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-330">DB-Disk3</span></span> | <span data-ttu-id="58bae-331">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-331">Disk3</span></span> | <span data-ttu-id="58bae-332">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-332">F:\\</span></span> | <span data-ttu-id="58bae-333">使用者資料 2</span><span class="sxs-lookup"><span data-stu-id="58bae-333">User data 2</span></span>

<span data-ttu-id="58bae-334">以下是 hello 來源虛擬機器上的 hello 分頁檔案設定：</span><span class="sxs-lookup"><span data-stu-id="58bae-334">Here are hello paging file settings on hello source virtual machine:</span></span>

![來源虛擬機器上的分頁檔設定](./media/site-recovery-exclude-disk/pagefile-on-d-drive-sourceVM.png)


<span data-ttu-id="58bae-336">從 VMware tooAzure 或 HYPER-V tooAzure hello 虛擬機器的容錯移轉之後 hello Azure 虛擬機器上的磁碟如下：</span><span class="sxs-lookup"><span data-stu-id="58bae-336">After failover of hello virtual machine from VMware tooAzure or Hyper-V tooAzure, disks on hello Azure virtual machine are as follows:</span></span>

<span data-ttu-id="58bae-337">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-337">**Disk name**</span></span> | <span data-ttu-id="58bae-338">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-338">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-339">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-339">**Drive letter**</span></span> | <span data-ttu-id="58bae-340">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-340">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-341">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-341">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-342">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-342">DISK0</span></span> | <span data-ttu-id="58bae-343">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-343">C:\\</span></span> | <span data-ttu-id="58bae-344">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-344">Operating system disk</span></span>
<span data-ttu-id="58bae-345">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-345">DB-Disk1</span></span> | <span data-ttu-id="58bae-346">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-346">Disk1</span></span> | <span data-ttu-id="58bae-347">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-347">D:\\</span></span> | <span data-ttu-id="58bae-348">暫存儲存體</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="58bae-348">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="58bae-349">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-349">DB-Disk2</span></span> | <span data-ttu-id="58bae-350">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-350">Disk2</span></span> | <span data-ttu-id="58bae-351">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-351">E:\\</span></span> | <span data-ttu-id="58bae-352">使用者資料 1</span><span class="sxs-lookup"><span data-stu-id="58bae-352">User data 1</span></span>
<span data-ttu-id="58bae-353">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-353">DB-Disk3</span></span> | <span data-ttu-id="58bae-354">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-354">Disk3</span></span> | <span data-ttu-id="58bae-355">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-355">F:\\</span></span> | <span data-ttu-id="58bae-356">使用者資料 2</span><span class="sxs-lookup"><span data-stu-id="58bae-356">User data 2</span></span>

<span data-ttu-id="58bae-357">已排除 Disk1 （d:），因為 d： 為從 hello 可用清單 hello 第一個磁碟機代號。</span><span class="sxs-lookup"><span data-stu-id="58bae-357">Because Disk1 (D:) was excluded, D: is hello first drive letter from hello available list.</span></span> <span data-ttu-id="58bae-358">Azure 將指派 d toohello 暫時存放磁碟區。</span><span class="sxs-lookup"><span data-stu-id="58bae-358">Azure assigns D: toohello temporary storage volume.</span></span> <span data-ttu-id="58bae-359">D: hello Azure 虛擬機器功能，因為 hello 分頁檔設定的虛擬機器會維持為 hello hello 相同。</span><span class="sxs-lookup"><span data-stu-id="58bae-359">Because D: is available on hello Azure virtual machine, hello paging file setting of hello virtual machine remains hello same.</span></span>

<span data-ttu-id="58bae-360">以下是在 hello Azure 虛擬機器上的 hello 分頁檔案設定：</span><span class="sxs-lookup"><span data-stu-id="58bae-360">Here are hello paging file settings on hello Azure virtual machine:</span></span>

![Azure 虛擬機器上的分頁檔設定](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover.png)

#### <a name="case-2-hello-paging-file-is-configured-on-another-drive-other-than-d-drive"></a><span data-ttu-id="58bae-362">案例 2: hello 分頁檔設定 （以外 d： 磁碟機） 的另一個磁碟機上</span><span class="sxs-lookup"><span data-stu-id="58bae-362">Case 2: hello paging file is configured on another drive (other than D: drive)</span></span>

<span data-ttu-id="58bae-363">以下是 hello 來源虛擬機器磁碟組態：</span><span class="sxs-lookup"><span data-stu-id="58bae-363">Here's hello source virtual machine disk configuration:</span></span>

<span data-ttu-id="58bae-364">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-364">**Disk name**</span></span> | <span data-ttu-id="58bae-365">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-365">**Guest operating system disk#**</span></span> | <span data-ttu-id="58bae-366">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-366">**Drive letter**</span></span> | <span data-ttu-id="58bae-367">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-367">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-368">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-368">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-369">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-369">DISK0</span></span> | <span data-ttu-id="58bae-370">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-370">C:\\</span></span> | <span data-ttu-id="58bae-371">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-371">Operating system disk</span></span>
<span data-ttu-id="58bae-372">DB Disk1 （排除不予保護的 hello 磁碟）</span><span class="sxs-lookup"><span data-stu-id="58bae-372">DB-Disk1 (Excluded hello disk from protection)</span></span> | <span data-ttu-id="58bae-373">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-373">Disk1</span></span> | <span data-ttu-id="58bae-374">G:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-374">G:\\</span></span> | <span data-ttu-id="58bae-375">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="58bae-375">pagefile.sys</span></span>
<span data-ttu-id="58bae-376">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-376">DB-Disk2</span></span> | <span data-ttu-id="58bae-377">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-377">Disk2</span></span> | <span data-ttu-id="58bae-378">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-378">E:\\</span></span> | <span data-ttu-id="58bae-379">使用者資料 1</span><span class="sxs-lookup"><span data-stu-id="58bae-379">User data 1</span></span>
<span data-ttu-id="58bae-380">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-380">DB-Disk3</span></span> | <span data-ttu-id="58bae-381">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-381">Disk3</span></span> | <span data-ttu-id="58bae-382">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-382">F:\\</span></span> | <span data-ttu-id="58bae-383">使用者資料 2</span><span class="sxs-lookup"><span data-stu-id="58bae-383">User data 2</span></span>

<span data-ttu-id="58bae-384">以下是 hello 在內部部署虛擬機器上的 hello 分頁檔案設定：</span><span class="sxs-lookup"><span data-stu-id="58bae-384">Here are hello paging file settings on hello on-premises virtual machine:</span></span>

![分頁檔 hello 在內部部署虛擬機器上的設定](./media/site-recovery-exclude-disk/pagefile-on-g-drive-sourceVM.png)

<span data-ttu-id="58bae-386">從 VMware/HYPER-V tooAzure hello 虛擬機器的容錯移轉之後 hello Azure 虛擬機器上的磁碟如下：</span><span class="sxs-lookup"><span data-stu-id="58bae-386">After failover of hello virtual machine from VMware/Hyper-V tooAzure, disks on hello Azure virtual machine are as follows:</span></span>

<span data-ttu-id="58bae-387">**磁碟名稱**</span><span class="sxs-lookup"><span data-stu-id="58bae-387">**Disk name**</span></span>| <span data-ttu-id="58bae-388">**客體作業系統磁碟#**</span><span class="sxs-lookup"><span data-stu-id="58bae-388">**Guest operating system disk#**</span></span>| <span data-ttu-id="58bae-389">**磁碟機代號**</span><span class="sxs-lookup"><span data-stu-id="58bae-389">**Drive letter**</span></span> | <span data-ttu-id="58bae-390">**Hello 磁碟上的資料類型**</span><span class="sxs-lookup"><span data-stu-id="58bae-390">**Data type on hello disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="58bae-391">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="58bae-391">DB-Disk0-OS</span></span> | <span data-ttu-id="58bae-392">DISK0</span><span class="sxs-lookup"><span data-stu-id="58bae-392">DISK0</span></span>  |<span data-ttu-id="58bae-393">C:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-393">C:\\</span></span> |<span data-ttu-id="58bae-394">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="58bae-394">Operating system disk</span></span>
<span data-ttu-id="58bae-395">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-395">DB-Disk1</span></span> | <span data-ttu-id="58bae-396">Disk1</span><span class="sxs-lookup"><span data-stu-id="58bae-396">Disk1</span></span> | <span data-ttu-id="58bae-397">D:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-397">D:\\</span></span> | <span data-ttu-id="58bae-398">暫存儲存體</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="58bae-398">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="58bae-399">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-399">DB-Disk2</span></span> | <span data-ttu-id="58bae-400">Disk2</span><span class="sxs-lookup"><span data-stu-id="58bae-400">Disk2</span></span> | <span data-ttu-id="58bae-401">E:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-401">E:\\</span></span> | <span data-ttu-id="58bae-402">使用者資料 1</span><span class="sxs-lookup"><span data-stu-id="58bae-402">User data 1</span></span>
<span data-ttu-id="58bae-403">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-403">DB-Disk3</span></span> | <span data-ttu-id="58bae-404">Disk3</span><span class="sxs-lookup"><span data-stu-id="58bae-404">Disk3</span></span> | <span data-ttu-id="58bae-405">F:\\</span><span class="sxs-lookup"><span data-stu-id="58bae-405">F:\\</span></span> | <span data-ttu-id="58bae-406">使用者資料 2</span><span class="sxs-lookup"><span data-stu-id="58bae-406">User data 2</span></span>

<span data-ttu-id="58bae-407">因為 d： 從清單中可用的 hello hello 第一個磁碟機代號，Azure 將指派 d toohello 暫時存放磁碟區。</span><span class="sxs-lookup"><span data-stu-id="58bae-407">Because D: is hello first drive letter from available hello list, Azure assigns D: toohello temporary storage volume.</span></span> <span data-ttu-id="58bae-408">所有的複寫 hello 磁碟 hello 磁碟機代號維持 hello 相同。</span><span class="sxs-lookup"><span data-stu-id="58bae-408">For all hello replicated disks, hello drive letter remains hello same.</span></span> <span data-ttu-id="58bae-409">找不到 hello g： 磁碟，因為 hello 系統將會使用分頁檔的 hello hello c： 磁碟機。</span><span class="sxs-lookup"><span data-stu-id="58bae-409">Because hello G: disk is not available, hello system will use hello C: drive for hello paging file.</span></span>

<span data-ttu-id="58bae-410">以下是在 hello Azure 虛擬機器上的 hello 分頁檔案設定：</span><span class="sxs-lookup"><span data-stu-id="58bae-410">Here are hello paging file settings on hello Azure virtual machine:</span></span>

![Azure 虛擬機器上的分頁檔設定](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover-2.png)

## <a name="next-steps"></a><span data-ttu-id="58bae-412">後續步驟</span><span class="sxs-lookup"><span data-stu-id="58bae-412">Next steps</span></span>
<span data-ttu-id="58bae-413">在您的部署設定完成並開始執行之後，請 [深入了解](site-recovery-failover.md) 不同類型的容錯移轉。</span><span class="sxs-lookup"><span data-stu-id="58bae-413">After your deployment is set up and running, [learn more](site-recovery-failover.md) about different types of failover.</span></span>
