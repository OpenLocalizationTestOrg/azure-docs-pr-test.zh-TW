---
title: "Azure 中的 IP 位址類型 (傳統) | Microsoft Docs"
description: "了解 Azure 中的公用和私人 IP 位址 (傳統)。"
services: virtual-network
documentationcenter: na
author: jimdial
manager: carmonm
editor: tysonn
tags: azure-service-management
ms.assetid: 2f8664ab-2daf-43fa-bbeb-be9773efc978
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: aa99d3ebd181a76d582670c5219f29858c462d30
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2017
---
# <a name="ip-address-types-and-allocation-methods-classic-in-azure"></a><span data-ttu-id="ca6f0-103">Azure 中的 IP 位址類型及配置方法 (傳統)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-103">IP address types and allocation methods (classic) in Azure</span></span>
<span data-ttu-id="ca6f0-104">您可以將 IP 位址指派給 Azure 資源，來與其他 Azure 資源、內部部署網路和網際網路進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-104">You can assign IP addresses to Azure resources to communicate with other Azure resources, your on-premises network, and the Internet.</span></span> <span data-ttu-id="ca6f0-105">您可以在 Azure 中使用兩種類型的 IP 位址：公用和私人。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-105">There are two types of IP addresses you can use in Azure: public and private.</span></span>

<span data-ttu-id="ca6f0-106">公用 IP 位址用於與網際網路通訊，包括 Azure 公眾對應服務。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-106">Public IP addresses are used for communication with the Internet, including Azure public-facing services.</span></span>

<span data-ttu-id="ca6f0-107">當您使用 VPN 閘道或 ExpressRoute 電路將網路擴充至 Azure 時，私人 IP 位址用於 Azure 虛擬網路 (VNet)、雲端服務和內部部署網路內的通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-107">Private IP addresses are used for communication within an Azure virtual network (VNet), a cloud service, and your on-premises network when you use a VPN gateway or ExpressRoute circuit to extend your network to Azure.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ca6f0-108">Azure 建立和處理資源的部署模型有二種：[Resource Manager 和傳統](../resource-manager-deployment-model.md)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span>  <span data-ttu-id="ca6f0-109">本文涵蓋之內容包括使用傳統部署模型。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-109">This article covers using the classic deployment model.</span></span> <span data-ttu-id="ca6f0-110">Microsoft 建議大部分的新部署使用 Resource Manager。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-110">Microsoft recommends that most new deployments use Resource Manager.</span></span> <span data-ttu-id="ca6f0-111">請參閱 [IP 位址](virtual-network-ip-addresses-overview-arm.md)文章，以了解 Resource Manager 中的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-111">Learn about IP addresses in Resource Manager by reading the [IP addresses](virtual-network-ip-addresses-overview-arm.md) article.</span></span>

## <a name="public-ip-addresses"></a><span data-ttu-id="ca6f0-112">公用 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-112">Public IP addresses</span></span>
<span data-ttu-id="ca6f0-113">Azure 資源可透過公用 IP 位址來與網際網路和 Azure 公眾對應服務 (例如 [Azure Redis 快取](https://azure.microsoft.com/services/cache/)、[Azure 事件中樞](https://azure.microsoft.com/services/event-hubs/)、[SQL Database](../sql-database/sql-database-technical-overview.md) 和 [Azure 儲存體](../storage/common/storage-introduction.md)) 進行通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-113">Public IP addresses allow Azure resources to communicate with Internet and Azure public-facing services such as [Azure Redis Cache](https://azure.microsoft.com/services/cache/), [Azure Event Hubs](https://azure.microsoft.com/services/event-hubs/), [SQL databases](../sql-database/sql-database-technical-overview.md), and [Azure storage](../storage/common/storage-introduction.md).</span></span>

<span data-ttu-id="ca6f0-114">公用 IP 位址與下列任何資源相關聯：</span><span class="sxs-lookup"><span data-stu-id="ca6f0-114">A public IP address is associated with the following resource types:</span></span>

* <span data-ttu-id="ca6f0-115">雲端服務</span><span class="sxs-lookup"><span data-stu-id="ca6f0-115">Cloud services</span></span>
* <span data-ttu-id="ca6f0-116">IaaS 虛擬機器 (VM)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-116">IaaS Virtual Machines (VMs)</span></span>
* <span data-ttu-id="ca6f0-117">PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-117">PaaS role instances</span></span>
* <span data-ttu-id="ca6f0-118">VPN 閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-118">VPN gateways</span></span>
* <span data-ttu-id="ca6f0-119">應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-119">Application gateways</span></span>

### <a name="allocation-method"></a><span data-ttu-id="ca6f0-120">配置方法</span><span class="sxs-lookup"><span data-stu-id="ca6f0-120">Allocation method</span></span>
<span data-ttu-id="ca6f0-121">當公用 IP 位址需要指派給 Azure 資源時，會從資源建立位置內的可用公用 IP 位址集區進行動態  配置。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-121">When a public IP address needs to be assigned to an Azure resource, it is *dynamically* allocated from a pool of available public IP address within the location the resource is created.</span></span> <span data-ttu-id="ca6f0-122">此 IP 位址會在停止資源後釋出。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-122">This IP address is released when the resource is stopped.</span></span> <span data-ttu-id="ca6f0-123">就雲端服務而言，這會發生在所有角色執行個體都被停止的時候，而使用「靜態」  (保留) IP 位址即可避免這種情形 (請參閱 [雲端服務](#Cloud-services))。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-123">In case of a cloud service, this happens when all the role instances are stopped, which can be avoided by using a *static* (reserved) IP address (see [Cloud Services](#Cloud-services)).</span></span>

> [!NOTE]
> <span data-ttu-id="ca6f0-124">將公用 IP 位址配置給 Azure 資源的 IP 範圍清單已發佈於 [Azure 資料中心 IP 範圍](https://www.microsoft.com/download/details.aspx?id=41653)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-124">The list of IP ranges from which public IP addresses are allocated to Azure resources is published at [Azure Datacenter IP ranges](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>
> 
> 

### <a name="dns-hostname-resolution"></a><span data-ttu-id="ca6f0-125">DNS 主機名稱解析</span><span class="sxs-lookup"><span data-stu-id="ca6f0-125">DNS hostname resolution</span></span>
<span data-ttu-id="ca6f0-126">當您建立雲端服務或 IaaS VM 時，您必須提供在 Azure 的所有資源中唯一的雲端服務 DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-126">When you create a cloud service or an IaaS VM, you need to provide a cloud service DNS name which is unique across all resources in Azure.</span></span> <span data-ttu-id="ca6f0-127">這會在 Azure 受管理 DNS 伺服器中建立 *dnsname*.cloudapp.net 與資源公用 IP 位址的對應。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-127">This creates a mapping in the Azure-managed DNS servers for *dnsname*.cloudapp.net to the public IP address of the resource.</span></span> <span data-ttu-id="ca6f0-128">例如，當您建立雲端服務 DNS 名稱為 **contoso** 的雲端服務時，完整網域名稱 (FQDN) **contoso.cloudapp.net** 會解析為雲端服務的公用 IP 位址 (VIP)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-128">For instance, when you create a cloud service with a cloud service DNS name of **contoso**, the fully-qualified domain name (FQDN) **contoso.cloudapp.net** will resolve to a public IP address (VIP) of the cloud service.</span></span> <span data-ttu-id="ca6f0-129">您可以使用此 FQDN 來建立自訂網域 CNAME 記錄，其指向 Azure 中的公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-129">You can use this FQDN to create a custom domain CNAME record pointing to the public IP address in Azure.</span></span>

### <a name="cloud-services"></a><span data-ttu-id="ca6f0-130">雲端服務</span><span class="sxs-lookup"><span data-stu-id="ca6f0-130">Cloud services</span></span>
<span data-ttu-id="ca6f0-131">雲端服務一律有公用 IP 位址，稱為虛擬 IP 位址 (VIP)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-131">A cloud service always has a public IP address referred to as a virtual IP address (VIP).</span></span> <span data-ttu-id="ca6f0-132">您可以在雲端服務中建立端點，以便讓 VIP 中不同的連接埠與 VM 上的內部連接埠和雲端服務內的角色執行個體建立關聯。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-132">You can create endpoints in a cloud service to associate different ports in the VIP to internal ports on VMs and role instances within the cloud service.</span></span> 

<span data-ttu-id="ca6f0-133">雲端服務可以包含多個 IaaS VM，或 PaaS 角色執行個體，都是透過相同的雲端服務 VIP 公開。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-133">A cloud service can contain multiple IaaS VMs, or PaaS role instances, all exposed through the same cloud service VIP.</span></span> <span data-ttu-id="ca6f0-134">您也可以將 [多個公用 VIP 指派給一項雲端服務](../load-balancer/load-balancer-multivip.md)，以實現多重 VIP 案例 (例如具有多個 SSL 架構網站的多租用戶環境)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-134">You can also assign [multiple VIPs to a cloud service](../load-balancer/load-balancer-multivip.md), which enables multi-VIP scenarios like multi-tenant environment with SSL-based websites.</span></span>

<span data-ttu-id="ca6f0-135">即使所有角色執行個體都已停止，您可以使用「靜態」  公用 IP 位址 (稱為 [保留 IP](virtual-networks-reserved-public-ip.md))，確保雲端服務的公用 IP 位址維持不變。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-135">You can ensure the public IP address of a cloud service remains the same, even when all the role instances are stopped, by using a *static* public IP address, referred to as [Reserved IP](virtual-networks-reserved-public-ip.md).</span></span> <span data-ttu-id="ca6f0-136">您可以在特定位置建立靜態 (保留) IP 資源，並將它指派給該位置中的任何雲端服務。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-136">You can create a static (reserved) IP resource in a specific location and assign it to any cloud service in that location.</span></span> <span data-ttu-id="ca6f0-137">您無法指定保留 IP 的實際 IP 位址，它會從資源建立位置中可用的 IP 位址集區進行配置。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-137">You cannot specify the actual IP address for the reserved IP, it is allocated from pool of available IP addresses in the location it is created.</span></span> <span data-ttu-id="ca6f0-138">直到您明確刪除，此 IP 位址才會釋出。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-138">This IP address is not released until you explicitly delete it.</span></span>

<span data-ttu-id="ca6f0-139">靜態 (保留) 公用 IP 位址常使用於下列案例，其中雲端服務：</span><span class="sxs-lookup"><span data-stu-id="ca6f0-139">Static (reserved) public IP addresses are commonly used in the scenarios where a cloud service:</span></span>

* <span data-ttu-id="ca6f0-140">需要由使用者設定防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-140">requires firewall rules to be setup by end-users.</span></span>
* <span data-ttu-id="ca6f0-141">取決於外部 DNS 名稱解析，而動態 IP 會需要更新 A 記錄。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-141">depends on external DNS name resolution, and a dynamic IP would require updating A records.</span></span>
* <span data-ttu-id="ca6f0-142">會取用使用以 IP 為基礎之安全性模型的外部 Web 服務。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-142">consumes external web services which use IP based security model.</span></span>
* <span data-ttu-id="ca6f0-143">使用已連結到 IP 位址的 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-143">uses SSL certificates linked to an IP address.</span></span>

> [!NOTE]
> <span data-ttu-id="ca6f0-144">當您建立傳統 VM，容器 *雲端服務* 是由 Azure 建立，具有一個虛擬 IP 位址 (VIP)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-144">When you create a classic VM, a container *cloud service* is created by Azure, which has a virtual IP address (VIP).</span></span> <span data-ttu-id="ca6f0-145">透過入口網站建立時，預設 RDP 或 SSH *端點* 是由入口網站設定，讓您可以透過雲端服務 VIP 連接至 VM。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-145">When the creation is done through portal, a default RDP or SSH *endpoint* is configured by the portal so you can connect to the VM through the cloud service VIP.</span></span> <span data-ttu-id="ca6f0-146">此雲端服務 VIP 可以保留，以有效地提供保留的 IP 位址，以連接至 VM。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-146">This cloud service VIP can be reserved, which effectively provides a reserved IP address to connect to the VM.</span></span> <span data-ttu-id="ca6f0-147">您可以設定多個端點，以開啟其他連接埠。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-147">You can open additional ports by configuring more endpoints.</span></span>
> 
> 

### <a name="iaas-vms-and-paas-role-instances"></a><span data-ttu-id="ca6f0-148">IaaS VM 和 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-148">IaaS VMs and PaaS role instances</span></span>
<span data-ttu-id="ca6f0-149">您可以將公用 IP 位址直接指派給雲端服務內的 IaaS [VM](../virtual-machines/virtual-machines-linux-about.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) 或 PaaS 角色執行個體。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-149">You can assign a public IP address directly to an IaaS [VM](../virtual-machines/virtual-machines-linux-about.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or PaaS role instance within a cloud service.</span></span> <span data-ttu-id="ca6f0-150">這也稱為執行個體層級公用 IP 位址 ([ILPIP](virtual-networks-instance-level-public-ip.md))。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-150">This is referred to as an instance-level public IP address ([ILPIP](virtual-networks-instance-level-public-ip.md)).</span></span> <span data-ttu-id="ca6f0-151">此公用 IP 位址只能是靜態。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-151">This public IP address can be dynamic only.</span></span>

> [!NOTE]
> <span data-ttu-id="ca6f0-152">這點不同於雲端服務的 VIP，它是 Iaas VM 或 PaaS 角色執行個體的容器，因為雲端服務可以包含多個 IaaS VM 或 PaaS 角色執行個體，都是透過相同的雲端服務 VIP 公開。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-152">This is different from the VIP of the cloud service, which is a container for IaaS VMs or PaaS role instances, since a cloud service can contain multiple IaaS VMs, or PaaS role instances, all exposed through the same cloud service VIP.</span></span>
> 
> 

### <a name="vpn-gateways"></a><span data-ttu-id="ca6f0-153">VPN 閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-153">VPN gateways</span></span>
<span data-ttu-id="ca6f0-154">[VPN 閘道](../vpn-gateway/vpn-gateway-about-vpngateways.md) 可用來將 Azure VNet 連接到其他 Azure Vnet 或內部部署網路。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-154">A [VPN gateway](../vpn-gateway/vpn-gateway-about-vpngateways.md) can be used to connect an Azure VNet to other Azure VNets or on-premises networks.</span></span> <span data-ttu-id="ca6f0-155">VPN 閘道已被動態 指派公用 IP 位址，以便與遠端網路通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-155">A VPN gateway is assigned a public IP address *dynamically*, which enables communication with the remote network.</span></span>

### <a name="application-gateways"></a><span data-ttu-id="ca6f0-156">應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-156">Application gateways</span></span>
<span data-ttu-id="ca6f0-157">Azure [應用程式閘道](../application-gateway/application-gateway-introduction.md) 可用於 Layer7 負載平衡，以便路由傳送以 HTTP 為基礎的網路流量。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-157">An Azure [Application gateway](../application-gateway/application-gateway-introduction.md) can be used for Layer7 load-balancing to route network traffic based on HTTP.</span></span> <span data-ttu-id="ca6f0-158">應用程式閘道已被動態 指派公用 IP 位址，該 IP 位址可做為負載平衡的 VIP。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-158">Application gateway is assigned a public IP address *dynamically*, which serves as the load-balanced VIP.</span></span>

### <a name="at-a-glance"></a><span data-ttu-id="ca6f0-159">速覽</span><span class="sxs-lookup"><span data-stu-id="ca6f0-159">At a glance</span></span>
<span data-ttu-id="ca6f0-160">下表顯示每個資源類型與可能的配置方法 (動態/靜態)，以及指派多個公用 IP 位址的能力。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-160">The table below shows each resource type with the possible allocation methods (dynamic/static), and ability to assign multiple public IP addresses.</span></span>

| <span data-ttu-id="ca6f0-161">資源</span><span class="sxs-lookup"><span data-stu-id="ca6f0-161">Resource</span></span> | <span data-ttu-id="ca6f0-162">動態</span><span class="sxs-lookup"><span data-stu-id="ca6f0-162">Dynamic</span></span> | <span data-ttu-id="ca6f0-163">靜態</span><span class="sxs-lookup"><span data-stu-id="ca6f0-163">Static</span></span> | <span data-ttu-id="ca6f0-164">多個 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-164">Multiple IP addresses</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ca6f0-165">雲端服務</span><span class="sxs-lookup"><span data-stu-id="ca6f0-165">Cloud service</span></span> |<span data-ttu-id="ca6f0-166">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-166">Yes</span></span> |<span data-ttu-id="ca6f0-167">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-167">Yes</span></span> |<span data-ttu-id="ca6f0-168">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-168">Yes</span></span> |
| <span data-ttu-id="ca6f0-169">IaaS VM 或 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-169">IaaS VM or PaaS role instance</span></span> |<span data-ttu-id="ca6f0-170">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-170">Yes</span></span> |<span data-ttu-id="ca6f0-171">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-171">No</span></span> |<span data-ttu-id="ca6f0-172">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-172">No</span></span> |
| <span data-ttu-id="ca6f0-173">VPN 閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-173">VPN gateway</span></span> |<span data-ttu-id="ca6f0-174">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-174">Yes</span></span> |<span data-ttu-id="ca6f0-175">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-175">No</span></span> |<span data-ttu-id="ca6f0-176">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-176">No</span></span> |
| <span data-ttu-id="ca6f0-177">應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-177">Application gateway</span></span> |<span data-ttu-id="ca6f0-178">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-178">Yes</span></span> |<span data-ttu-id="ca6f0-179">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-179">No</span></span> |<span data-ttu-id="ca6f0-180">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-180">No</span></span> |

## <a name="private-ip-addresses"></a><span data-ttu-id="ca6f0-181">私人 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-181">Private IP addresses</span></span>
<span data-ttu-id="ca6f0-182">私人 IP 位址可讓 Azure 資源與雲端服務或 [虛擬網路](virtual-networks-overview.md)(VNet) 或內部部署網路中的其他資源進行通訊 (透過 VPN 閘道或 ExpressRoute 電路)，而不必使用可網際網路連線的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-182">Private IP addresses allow Azure resources to communicate with other resources in a cloud service or a [virtual network](virtual-networks-overview.md)(VNet), or to on-premises network (through a VPN gateway or ExpressRoute circuit), without using an Internet-reachable IP address.</span></span>

<span data-ttu-id="ca6f0-183">在 Azure 傳統部署模型中，可將私人 IP 位址指派給下列 Azure 資源：</span><span class="sxs-lookup"><span data-stu-id="ca6f0-183">In Azure classic deployment model, a private IP address can be assigned to the following Azure resources:</span></span>

* <span data-ttu-id="ca6f0-184">IaaS VM 和 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-184">IaaS VMs and PaaS role instances</span></span>
* <span data-ttu-id="ca6f0-185">內部負載平衡器</span><span class="sxs-lookup"><span data-stu-id="ca6f0-185">Internal load balancer</span></span>
* <span data-ttu-id="ca6f0-186">應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-186">Application gateway</span></span>

### <a name="iaas-vms-and-paas-role-instances"></a><span data-ttu-id="ca6f0-187">IaaS VM 和 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-187">IaaS VMs and PaaS role instances</span></span>
<span data-ttu-id="ca6f0-188">使用傳統部署模型建立的虛擬機器 (VM) 一律放置在雲端服務中 (類似於 PaaS 角色執行個體)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-188">Virtual machines (VMs) created with the classic deployment model are always placed in a cloud service, similar to PaaS role instances.</span></span> <span data-ttu-id="ca6f0-189">私人 IP 位址的行為因此類似於這些資源。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-189">The behavior of private IP addresses are thus similar for these resources.</span></span>

<span data-ttu-id="ca6f0-190">請務必注意，有兩種方式可以部署雲端服務：</span><span class="sxs-lookup"><span data-stu-id="ca6f0-190">It is important to note that a cloud service can be deployed in two ways:</span></span>

* <span data-ttu-id="ca6f0-191">成為獨立  雲端服務，其不在虛擬網路中。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-191">As a *standalone* cloud service, where it is not within a virtual network.</span></span>
* <span data-ttu-id="ca6f0-192">成為虛擬網路的一部分。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-192">As part of a virtual network.</span></span>

#### <a name="allocation-method"></a><span data-ttu-id="ca6f0-193">配置方法</span><span class="sxs-lookup"><span data-stu-id="ca6f0-193">Allocation method</span></span>
<span data-ttu-id="ca6f0-194">如果是「獨立」雲端服務，資源會取得從 Azure 資料中心私人 IP 位址範圍「動態」配置的私人 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-194">In case of a *standalone* cloud service, resources get a private IP address allocated *dynamically* from the Azure datacenter private IP address range.</span></span> <span data-ttu-id="ca6f0-195">它只能用於與相同雲端服務內的其他 VM 通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-195">It can be used only for communication with other VMs within the same cloud service.</span></span> <span data-ttu-id="ca6f0-196">此 IP 位址可在停止並啟動資源時變更。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-196">This IP address can change when the resource is stopped and started.</span></span>

<span data-ttu-id="ca6f0-197">如果是虛擬網路中部署的雲端服務，資源會取得從相關聯子網路的位址範圍配置的私人 IP 位址 (如其網路組態中指定)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-197">In case of a cloud service deployed within a virtual network, resources get private IP address(es) allocated from the address range of the associated subnet(s) (as specified in its network configuration).</span></span> <span data-ttu-id="ca6f0-198">此私人 IP 位址可用於 VNet 中所有 VM 之間的通訊。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-198">This private IP address(es) can be used for communication between all VMs within the VNet.</span></span>

<span data-ttu-id="ca6f0-199">此外，如果是 VNet 中的雲端服務，預設會動態  配置私人 IP 位址 (使用 DHCP)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-199">Additionally, in case of cloud services within a VNet, a private IP address is allocated *dynamically* (using DHCP) by default.</span></span> <span data-ttu-id="ca6f0-200">此 IP 位址可在停止並啟動資源時變更。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-200">It can change when the resource is stopped and started.</span></span> <span data-ttu-id="ca6f0-201">若要確保 IP 位址維持不變，您需要將配置方法設為 [靜態] ，並提供對應位址範圍內的有效 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-201">To ensure the IP address remains the same, you need to set the allocation method to *static*, and provide a valid IP address within the corresponding address range.</span></span>

<span data-ttu-id="ca6f0-202">靜態私人 IP 位址通常用於：</span><span class="sxs-lookup"><span data-stu-id="ca6f0-202">Static private IP addresses are commonly used for:</span></span>

* <span data-ttu-id="ca6f0-203">做為網域控制站或 DNS 伺服器的 VM。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-203">VMs that act as domain controllers or DNS servers.</span></span>
* <span data-ttu-id="ca6f0-204">需要使用 IP 位址的防火牆規則的 VM。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-204">VMs that require firewall rules using IP addresses.</span></span>
* <span data-ttu-id="ca6f0-205">正在執行其他應用程式透過 IP 位址存取之服務的 VM。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-205">VMs running services accessed by other apps through an IP address.</span></span>

#### <a name="internal-dns-hostname-resolution"></a><span data-ttu-id="ca6f0-206">內部 DNS 主機名稱解析</span><span class="sxs-lookup"><span data-stu-id="ca6f0-206">Internal DNS hostname resolution</span></span>
<span data-ttu-id="ca6f0-207">除非明確設定自訂 DNS 伺服器，否則所有 Azure VM 和 PaaS 角色執行個體預設都會設定 [Azure 受管理 DNS 伺服器](virtual-networks-name-resolution-for-vms-and-role-instances.md#azure-provided-name-resolution) 。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-207">All Azure VMs and PaaS role instances are configured with [Azure-managed DNS servers](virtual-networks-name-resolution-for-vms-and-role-instances.md#azure-provided-name-resolution) by default, unless you explicitly configure custom DNS servers.</span></span> <span data-ttu-id="ca6f0-208">這些 DNS 伺服器會針對位於相同 VNet 或雲端服務內的 VM 和角色執行個體提供內部名稱解析。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-208">These DNS servers provide internal name resolution for VMs and role instances that reside within the same VNet or cloud service.</span></span>

<span data-ttu-id="ca6f0-209">當您建立 VM 時，會將主機名稱與其私人 IP 位址的對應加入至 Azure 受管理 DNS 伺服器。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-209">When you create a VM, a mapping for the hostname to its private IP address is added to the Azure-managed DNS servers.</span></span> <span data-ttu-id="ca6f0-210">如果是多個 NIC 的 VM，主機名稱會對應至主要 NIC 的私人 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-210">In case of a multi-NIC VM, the hostname is mapped to the private IP address of the primary NIC.</span></span> <span data-ttu-id="ca6f0-211">不過，此對應資訊僅限於相同雲端服務或 VNet 內的資源。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-211">However, this mapping information is restricted to resources within the same cloud service or VNet.</span></span>

<span data-ttu-id="ca6f0-212">如果是獨立  雲端服務，您只能夠解析相同雲端服務內所有 VM/角色執行個體的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-212">In case of a *standalone* cloud service, you will be able to resolve hostnames of all VMs/role instances within the same cloud service only.</span></span> <span data-ttu-id="ca6f0-213">如果是 VNet 內的雲端服務，您將能夠解析 VNet 內所有 VM/角色執行個體的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-213">In case of a cloud service within a VNet, you will be able to resolve hostnames of all the VMs/role instances within the VNet.</span></span>

### <a name="internal-load-balancers-ilb--application-gateways"></a><span data-ttu-id="ca6f0-214">內部負載平衡器 (ILB) 與應用程式閘道</span><span class="sxs-lookup"><span data-stu-id="ca6f0-214">Internal load balancers (ILB) & Application gateways</span></span>
<span data-ttu-id="ca6f0-215">您可以將私人 IP 位址指派給 [Azure 內部負載平衡器](../load-balancer/load-balancer-internal-overview.md) (ILB) 或 [Azure 應用程式閘道](../application-gateway/application-gateway-introduction.md)的**前端**組態。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-215">You can assign a private IP address to the **front end** configuration of an [Azure Internal Load Balancer](../load-balancer/load-balancer-internal-overview.md) (ILB) or an [Azure Application Gateway](../application-gateway/application-gateway-introduction.md).</span></span> <span data-ttu-id="ca6f0-216">此私人 IP 位址可做為內部端點，只能存取其虛擬網路 (VNet) 內的資源與連線到 VNet 的遠端網路。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-216">This private IP address serves as an internal endpoint, accessible only to the resources within its virtual network (VNet) and the remote networks connected to the VNet.</span></span> <span data-ttu-id="ca6f0-217">您可以將動態或靜態私人 IP 位址指派給前端組態。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-217">You can assign either a dynamic or static private IP address to the front end configuration.</span></span> <span data-ttu-id="ca6f0-218">您也可以指派多個私人 IP 位址，以實現多重 vip 案例。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-218">You can also assign multiple private IP addresses to enable multi-vip scenarios.</span></span>

### <a name="at-a-glance"></a><span data-ttu-id="ca6f0-219">速覽</span><span class="sxs-lookup"><span data-stu-id="ca6f0-219">At a glance</span></span>
<span data-ttu-id="ca6f0-220">下表顯示每個資源類型與可能的配置方法 (動態/靜態)，以及指派多個私人 IP 位址的能力。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-220">The table below shows each resource type with the possible allocation methods (dynamic/static), and ability to assign multiple private IP addresses.</span></span>

| <span data-ttu-id="ca6f0-221">資源</span><span class="sxs-lookup"><span data-stu-id="ca6f0-221">Resource</span></span> | <span data-ttu-id="ca6f0-222">動態</span><span class="sxs-lookup"><span data-stu-id="ca6f0-222">Dynamic</span></span> | <span data-ttu-id="ca6f0-223">靜態</span><span class="sxs-lookup"><span data-stu-id="ca6f0-223">Static</span></span> | <span data-ttu-id="ca6f0-224">多個 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-224">Multiple IP addresses</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ca6f0-225">VM (位於獨立  雲端服務中)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-225">VM (in a *standalone* cloud service)</span></span> |<span data-ttu-id="ca6f0-226">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-226">Yes</span></span> |<span data-ttu-id="ca6f0-227">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-227">Yes</span></span> |<span data-ttu-id="ca6f0-228">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-228">Yes</span></span> |
| <span data-ttu-id="ca6f0-229">PaaS 角色執行個體 (位於獨立  雲端服務中)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-229">PaaS role instance (in a *standalone* cloud service)</span></span> |<span data-ttu-id="ca6f0-230">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-230">Yes</span></span> |<span data-ttu-id="ca6f0-231">否</span><span class="sxs-lookup"><span data-stu-id="ca6f0-231">No</span></span> |<span data-ttu-id="ca6f0-232">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-232">Yes</span></span> |
| <span data-ttu-id="ca6f0-233">VM 或 PaaS 角色執行個體 (位於 VNet 中)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-233">VM or PaaS role instance (in a VNet)</span></span> |<span data-ttu-id="ca6f0-234">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-234">Yes</span></span> |<span data-ttu-id="ca6f0-235">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-235">Yes</span></span> |<span data-ttu-id="ca6f0-236">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-236">Yes</span></span> |
| <span data-ttu-id="ca6f0-237">內部負載平衡器前端</span><span class="sxs-lookup"><span data-stu-id="ca6f0-237">Internal load balancer front end</span></span> |<span data-ttu-id="ca6f0-238">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-238">Yes</span></span> |<span data-ttu-id="ca6f0-239">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-239">Yes</span></span> |<span data-ttu-id="ca6f0-240">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-240">Yes</span></span> |
| <span data-ttu-id="ca6f0-241">應用程式閘道前端</span><span class="sxs-lookup"><span data-stu-id="ca6f0-241">Application gateway front end</span></span> |<span data-ttu-id="ca6f0-242">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-242">Yes</span></span> |<span data-ttu-id="ca6f0-243">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-243">Yes</span></span> |<span data-ttu-id="ca6f0-244">是</span><span class="sxs-lookup"><span data-stu-id="ca6f0-244">Yes</span></span> |

## <a name="limits"></a><span data-ttu-id="ca6f0-245">限制</span><span class="sxs-lookup"><span data-stu-id="ca6f0-245">Limits</span></span>
<span data-ttu-id="ca6f0-246">下表顯示在 Azure 中，針對每一訂用帳戶在 IP 定址上所加諸的限制。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-246">The table below shows the limits imposed on IP addressing in Azure per subscription.</span></span> <span data-ttu-id="ca6f0-247">您可以 [連絡支援人員](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade) ，以根據您的業務需求將預設上限調升到最高上限。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-247">You can [contact support](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade) to increase the default limits up to the maximum limits based on your business needs.</span></span>

|  | <span data-ttu-id="ca6f0-248">預設限制</span><span class="sxs-lookup"><span data-stu-id="ca6f0-248">Default limit</span></span> | <span data-ttu-id="ca6f0-249">上限</span><span class="sxs-lookup"><span data-stu-id="ca6f0-249">Maximum limit</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ca6f0-250">公用 IP 位址 (動態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-250">Public IP addresses (dynamic)</span></span> |<span data-ttu-id="ca6f0-251">5</span><span class="sxs-lookup"><span data-stu-id="ca6f0-251">5</span></span> |<span data-ttu-id="ca6f0-252">連絡支援人員</span><span class="sxs-lookup"><span data-stu-id="ca6f0-252">contact support</span></span> |
| <span data-ttu-id="ca6f0-253">保留的公用 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-253">Reserved public IP addresses</span></span> |<span data-ttu-id="ca6f0-254">20</span><span class="sxs-lookup"><span data-stu-id="ca6f0-254">20</span></span> |<span data-ttu-id="ca6f0-255">連絡支援人員</span><span class="sxs-lookup"><span data-stu-id="ca6f0-255">contact support</span></span> |
| <span data-ttu-id="ca6f0-256">每個部署 (雲端服務) 的公用 VIP</span><span class="sxs-lookup"><span data-stu-id="ca6f0-256">Public VIP per deployment (cloud service)</span></span> |<span data-ttu-id="ca6f0-257">5</span><span class="sxs-lookup"><span data-stu-id="ca6f0-257">5</span></span> |<span data-ttu-id="ca6f0-258">連絡支援人員</span><span class="sxs-lookup"><span data-stu-id="ca6f0-258">contact support</span></span> |
| <span data-ttu-id="ca6f0-259">每個部署 (雲端服務) 的私人 VIP (ILB)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-259">Private VIP (ILB) per deployment (cloud service)</span></span> |<span data-ttu-id="ca6f0-260">1</span><span class="sxs-lookup"><span data-stu-id="ca6f0-260">1</span></span> |<span data-ttu-id="ca6f0-261">1</span><span class="sxs-lookup"><span data-stu-id="ca6f0-261">1</span></span> |

<span data-ttu-id="ca6f0-262">請務必閱讀 Azure 中全部的[網路限制](../azure-subscription-service-limits.md#networking-limits)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-262">Make sure you read the full set of [limits for Networking](../azure-subscription-service-limits.md#networking-limits) in Azure.</span></span>

## <a name="pricing"></a><span data-ttu-id="ca6f0-263">價格</span><span class="sxs-lookup"><span data-stu-id="ca6f0-263">Pricing</span></span>
<span data-ttu-id="ca6f0-264">在大多數情況下，公用 IP 位址是免費的。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-264">In most cases, public IP addresses are free.</span></span> <span data-ttu-id="ca6f0-265">使用額外和 (或) 靜態公用 IP 位址則會有少許費用。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-265">There is a nominal charge to use additional and/or static public IP addresses.</span></span> <span data-ttu-id="ca6f0-266">請務必了解 [公用 IP 的價格結構](https://azure.microsoft.com/pricing/details/ip-addresses/)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-266">Make sure you understand the [pricing structure for public IPs](https://azure.microsoft.com/pricing/details/ip-addresses/).</span></span>

## <a name="differences-between-resource-manager-and-classic-deployments"></a><span data-ttu-id="ca6f0-267">Resource Manager 與傳統部署之間的差異</span><span class="sxs-lookup"><span data-stu-id="ca6f0-267">Differences between Resource Manager and classic deployments</span></span>
<span data-ttu-id="ca6f0-268">以下是 Resource Manager 與傳統部署模型中 IP 定址功能的比較。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-268">Below is a comparison of IP addressing features in Resource Manager and the classic deployment model.</span></span>

|  | <span data-ttu-id="ca6f0-269">資源</span><span class="sxs-lookup"><span data-stu-id="ca6f0-269">Resource</span></span> | <span data-ttu-id="ca6f0-270">傳統</span><span class="sxs-lookup"><span data-stu-id="ca6f0-270">Classic</span></span> | <span data-ttu-id="ca6f0-271">Resource Manager</span><span class="sxs-lookup"><span data-stu-id="ca6f0-271">Resource Manager</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ca6f0-272">**公用 IP 位址**</span><span class="sxs-lookup"><span data-stu-id="ca6f0-272">**Public IP Address**</span></span> |<span data-ttu-id="ca6f0-273">***VM***</span><span class="sxs-lookup"><span data-stu-id="ca6f0-273">***VM***</span></span> |<span data-ttu-id="ca6f0-274">稱為 ILPIP (僅動態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-274">Referred to as an ILPIP (dynamic only)</span></span> |<span data-ttu-id="ca6f0-275">稱為公用 IP (動態或靜態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-275">Referred to as a public IP (dynamic or static)</span></span> |
|  ||<span data-ttu-id="ca6f0-276">指派給 IaaS VM 或 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-276">Assigned to an IaaS VM or a PaaS role instance</span></span> |<span data-ttu-id="ca6f0-277">關連到 VM 的 NIC</span><span class="sxs-lookup"><span data-stu-id="ca6f0-277">Associated to the VM's NIC</span></span> | |
|  |<span data-ttu-id="ca6f0-278">***網際網路對向負載平衡器***</span><span class="sxs-lookup"><span data-stu-id="ca6f0-278">***Internet facing load balancer***</span></span> |<span data-ttu-id="ca6f0-279">稱為 VIP (動態) 或保留的 IP (靜態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-279">Referred to as VIP (dynamic) or Reserved IP (static)</span></span> |<span data-ttu-id="ca6f0-280">稱為公用 IP (動態或靜態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-280">Referred to as a public IP (dynamic or static)</span></span> | |
|  ||<span data-ttu-id="ca6f0-281">指派給雲端服務</span><span class="sxs-lookup"><span data-stu-id="ca6f0-281">Assigned to a cloud service</span></span> |<span data-ttu-id="ca6f0-282">關連到負載平衡器的前端設定</span><span class="sxs-lookup"><span data-stu-id="ca6f0-282">Associated to the load balancer's front end config</span></span> | |
|  | | | |
| <span data-ttu-id="ca6f0-283">**私人 IP 位址**</span><span class="sxs-lookup"><span data-stu-id="ca6f0-283">**Private IP Address**</span></span> |<span data-ttu-id="ca6f0-284">***VM***</span><span class="sxs-lookup"><span data-stu-id="ca6f0-284">***VM***</span></span> |<span data-ttu-id="ca6f0-285">稱為 DIP</span><span class="sxs-lookup"><span data-stu-id="ca6f0-285">Referred to as a DIP</span></span> |<span data-ttu-id="ca6f0-286">稱為私人 IP 位址</span><span class="sxs-lookup"><span data-stu-id="ca6f0-286">Referred to as a private IP address</span></span> |
|  ||<span data-ttu-id="ca6f0-287">指派給 IaaS VM 或 PaaS 角色執行個體</span><span class="sxs-lookup"><span data-stu-id="ca6f0-287">Assigned to an IaaS VM or a PaaS role instance</span></span> |<span data-ttu-id="ca6f0-288">指派給 VM 的 NIC</span><span class="sxs-lookup"><span data-stu-id="ca6f0-288">Assigned to the VM's NIC</span></span> | |
|  |<span data-ttu-id="ca6f0-289">***內部負載平衡器 (ILB)***</span><span class="sxs-lookup"><span data-stu-id="ca6f0-289">***Internal load balancer (ILB)***</span></span> |<span data-ttu-id="ca6f0-290">指派給 ILB (動態或靜態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-290">Assigned to the ILB (dynamic or static)</span></span> |<span data-ttu-id="ca6f0-291">指派給 ILB 的前端設定 (動態或靜態)</span><span class="sxs-lookup"><span data-stu-id="ca6f0-291">Assigned to the ILB's front end configuration (dynamic or static)</span></span> | |

## <a name="next-steps"></a><span data-ttu-id="ca6f0-292">後續步驟</span><span class="sxs-lookup"><span data-stu-id="ca6f0-292">Next steps</span></span>
* <span data-ttu-id="ca6f0-293">使用 Azure 入口網站[部署使用靜態私人 IP 位址的 VM](virtual-networks-static-private-ip-classic-pportal.md)。</span><span class="sxs-lookup"><span data-stu-id="ca6f0-293">[Deploy a VM with a static private IP address](virtual-networks-static-private-ip-classic-pportal.md) using the Azure portal.</span></span>

