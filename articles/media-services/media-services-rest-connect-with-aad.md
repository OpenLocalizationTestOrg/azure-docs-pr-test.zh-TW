---
title: "Azure AD 驗證 tooaccess Azure 媒體服務 API 與其餘 aaaUse |Microsoft 文件"
description: "了解與使用 Azure Active Directory 驗證 tooaccess Azure Media Services API REST 的方式。"
services: media-services
documentationcenter: 
author: willzhan
manager: cfowler
editor: 
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/17/2017
ms.author: willzhan;juliako
ms.openlocfilehash: 114f7bdde3a8f5fe6189d712e05b6afdc8a8787a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="use-azure-ad-authentication-tooaccess-hello-azure-media-services-api-with-rest"></a><span data-ttu-id="f1600-103">使用 Azure AD 驗證 tooaccess hello 與其餘的 Azure 媒體服務 API</span><span class="sxs-lookup"><span data-stu-id="f1600-103">Use Azure AD authentication tooaccess hello Azure Media Services API with REST</span></span>

<span data-ttu-id="f1600-104">hello Azure 媒體服務團隊發行了 Azure Media Services 存取的 Azure Active Directory (Azure AD) 驗證支援。</span><span class="sxs-lookup"><span data-stu-id="f1600-104">hello Azure Media Services team has released Azure Active Directory (Azure AD) authentication support for Azure Media Services access.</span></span> <span data-ttu-id="f1600-105">它也宣佈 Media Services 存取的計劃 toodeprecate Azure 存取控制服務驗證。</span><span class="sxs-lookup"><span data-stu-id="f1600-105">It also announced plans toodeprecate Azure Access Control service authentication for Media Services access.</span></span> <span data-ttu-id="f1600-106">因為每個 Azure 訂用帳戶，且每個 Media Services 帳戶，已附加的 tooan Azure AD 租用戶，Azure AD 驗證的支援會帶來許多的安全性優點。</span><span class="sxs-lookup"><span data-stu-id="f1600-106">Because every Azure subscription, and every Media Services account, is attached tooan Azure AD tenant, Azure AD authentication support brings many security benefits.</span></span> <span data-ttu-id="f1600-107">如需此變更和移轉 （如果您使用 Media Services.NET SDK hello 應用程式），詳細資料，請參閱 hello 下列部落格文章和文章：</span><span class="sxs-lookup"><span data-stu-id="f1600-107">For details about this change and migration (if you use hello Media Services .NET SDK for your app), see hello following blog posts and articles:</span></span>

- <span data-ttu-id="f1600-108">[Azure 媒體服務宣佈支援 Azure AD 驗證，取代存取控制驗證](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation) \(英文\)</span><span class="sxs-lookup"><span data-stu-id="f1600-108">[Azure Media Services announces support for Azure AD and deprecation of Access Control authentication](https://azure.microsoft.com/blog/azure%20media%20service%20aad%20auth%20and%20acs%20deprecation)</span></span>
- [<span data-ttu-id="f1600-109">使用 Azure AD 驗證存取 Azure 媒體服務 API</span><span class="sxs-lookup"><span data-stu-id="f1600-109">Access Azure Media Services API by using Azure AD authentication</span></span>](media-services-use-aad-auth-to-access-ams-api.md)
- [<span data-ttu-id="f1600-110">使用 Microsoft.NET 中使用 Azure AD 驗證 tooaccess Azure 媒體服務 API</span><span class="sxs-lookup"><span data-stu-id="f1600-110">Use Azure AD authentication tooaccess Azure Media Services API by using Microsoft .NET</span></span>](media-services-dotnet-get-started-with-aad.md)
- [<span data-ttu-id="f1600-111">開始使用 Azure AD 驗證使用 hello Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="f1600-111">Getting started with Azure AD authentication by using hello Azure portal</span></span>](media-services-portal-get-started-with-aad.md)

<span data-ttu-id="f1600-112">某些客戶需要 toodevelop hello 遵循條件約束下的其媒體服務方案：</span><span class="sxs-lookup"><span data-stu-id="f1600-112">Some customers need toodevelop their Media Services solutions under hello following constraints:</span></span>

*   <span data-ttu-id="f1600-113">使用不是 Microsoft.NET 或 C# 的程式設計語言或 hello 執行階段環境不是 Windows。</span><span class="sxs-lookup"><span data-stu-id="f1600-113">They use a programming language that is not Microsoft .NET or C#, or hello runtime environment is not Windows.</span></span>
*   <span data-ttu-id="f1600-114">Azure AD 程式庫，例如 Active Directory 驗證程式庫沒有可用的 hello 程式設計語言，或無法使用其執行階段環境。</span><span class="sxs-lookup"><span data-stu-id="f1600-114">Azure AD libraries such as Active Directory Authentication Libraries are not available for hello programming language or can't be used for their runtime environment.</span></span>

<span data-ttu-id="f1600-115">某些客戶已使用 REST API 開發可執行存取控制驗證和存取 Azure 媒體服務的應用程式。</span><span class="sxs-lookup"><span data-stu-id="f1600-115">Some customers have developed applications by using REST API for both Access Control authentication and Azure Media Services access.</span></span> <span data-ttu-id="f1600-116">對於這些客戶，您需要的 Azure AD 驗證的方式 toouse 只有 hello REST API 和後續的 Azure 媒體服務存取。</span><span class="sxs-lookup"><span data-stu-id="f1600-116">For these customers, you need a way toouse only hello REST API for Azure AD authentication and subsequent Azure Media Services access.</span></span> <span data-ttu-id="f1600-117">您需要 toonot 依賴任何 hello Azure AD 文件庫或 hello Media Services.NET SDK 上。</span><span class="sxs-lookup"><span data-stu-id="f1600-117">You need toonot rely on any of hello Azure AD libraries or on hello Media Services .NET SDK.</span></span> <span data-ttu-id="f1600-118">在本文中，我們描述一種解決方案，並提供此案例的範例程式碼。</span><span class="sxs-lookup"><span data-stu-id="f1600-118">In this article, we describe a solution and provide sample code for this scenario.</span></span> <span data-ttu-id="f1600-119">因為所有的 REST API 呼叫，不會相依於任何 Azure AD 與 hello 的程式碼或 Azure Media Services 程式庫，hello 程式碼很容易就能轉譯的 tooany 其他程式語言。</span><span class="sxs-lookup"><span data-stu-id="f1600-119">Because hello code is all REST API calls, with no dependency on any Azure AD or Azure Media Services library, hello code can easily be translated tooany other programming language.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f1600-120">目前，Media Services 支援 hello Azure 存取控制服務驗證模型。</span><span class="sxs-lookup"><span data-stu-id="f1600-120">Currently, Media Services supports hello Azure Access Control services authentication model.</span></span> <span data-ttu-id="f1600-121">不過，存取控制驗證將在 2018 年 6 月 1 日被取代。</span><span class="sxs-lookup"><span data-stu-id="f1600-121">However, Access Control authentication will be deprecated June 1, 2018.</span></span> <span data-ttu-id="f1600-122">我們建議您儘速移轉 toohello Azure AD 驗證模型。</span><span class="sxs-lookup"><span data-stu-id="f1600-122">We recommend that you migrate toohello Azure AD authentication model as soon as possible.</span></span>


## <a name="design"></a><span data-ttu-id="f1600-123">設計</span><span class="sxs-lookup"><span data-stu-id="f1600-123">Design</span></span>

<span data-ttu-id="f1600-124">在本文中，我們會使用 hello 遵循驗證和授權的設計：</span><span class="sxs-lookup"><span data-stu-id="f1600-124">In this article, we use hello following authentication and authorization design:</span></span>

*  <span data-ttu-id="f1600-125">授權通訊協定：OAuth 2.0。</span><span class="sxs-lookup"><span data-stu-id="f1600-125">Authorization protocol: OAuth 2.0.</span></span> <span data-ttu-id="f1600-126">OAuth 2.0 是一種涵蓋驗證和授權的 Web 安全性標準。</span><span class="sxs-lookup"><span data-stu-id="f1600-126">OAuth 2.0 is a web security standard that covers both authentication and authorization.</span></span> <span data-ttu-id="f1600-127">OAuth 2.0 受 Google、Microsoft、Facebook 和 PayPal 支援。</span><span class="sxs-lookup"><span data-stu-id="f1600-127">It is supported by Google, Microsoft, Facebook, and PayPal.</span></span> <span data-ttu-id="f1600-128">它於 2012 年 10 月獲得認可。</span><span class="sxs-lookup"><span data-stu-id="f1600-128">It was ratified October 2012.</span></span> <span data-ttu-id="f1600-129">Microsoft 穩固地支援 OAuth 2.0 和 OpenID Connect。</span><span class="sxs-lookup"><span data-stu-id="f1600-129">Microsoft firmly supports OAuth 2.0 and OpenID Connect.</span></span> <span data-ttu-id="f1600-130">有多種服務和用戶端程式庫均支援這些標準，包括 Azure Active Directory、Open Web Interface for .NET (OWIN) 及 Azure AD 程式庫。</span><span class="sxs-lookup"><span data-stu-id="f1600-130">Both of these standards are supported in multiple services and client libraries, including Azure Active Directory, Open Web Interface for .NET (OWIN) Katana, and Azure AD libraries.</span></span>
*  <span data-ttu-id="f1600-131">授與類型：用戶端認證授與類型。</span><span class="sxs-lookup"><span data-stu-id="f1600-131">Grant type: Client credentials grant type.</span></span> <span data-ttu-id="f1600-132">用戶端認證是在 OAuth 2.0 中的 hello 四個授與類型之一。</span><span class="sxs-lookup"><span data-stu-id="f1600-132">Client credentials is one of hello four grant types in OAuth 2.0.</span></span> <span data-ttu-id="f1600-133">它通常用於 Azure AD Microsoft Graph API 存取。</span><span class="sxs-lookup"><span data-stu-id="f1600-133">It's often used for Azure AD Microsoft Graph API access.</span></span>
*  <span data-ttu-id="f1600-134">驗證模型：服務主體。</span><span class="sxs-lookup"><span data-stu-id="f1600-134">Authentication mode: Service principal.</span></span> <span data-ttu-id="f1600-135">hello 其他驗證模式為使用者或互動式驗證。</span><span class="sxs-lookup"><span data-stu-id="f1600-135">hello other authentication mode is user or interactive authentication.</span></span>

<span data-ttu-id="f1600-136">使用 Media Services 的 hello Azure AD 驗證和授權流程涉及總共四個應用程式或服務。</span><span class="sxs-lookup"><span data-stu-id="f1600-136">A total of four applications or services are involved in hello Azure AD authentication and authorization flow for using Media Services.</span></span> <span data-ttu-id="f1600-137">hello 應用程式和服務，以及 hello 流程 hello 下表所述：</span><span class="sxs-lookup"><span data-stu-id="f1600-137">hello applications and services, and hello flow, are described in hello following table:</span></span>

|<span data-ttu-id="f1600-138">應用程式類型</span><span class="sxs-lookup"><span data-stu-id="f1600-138">Application type</span></span> |<span data-ttu-id="f1600-139">應用程式</span><span class="sxs-lookup"><span data-stu-id="f1600-139">Application</span></span> |<span data-ttu-id="f1600-140">Flow</span><span class="sxs-lookup"><span data-stu-id="f1600-140">Flow</span></span>|
|---|---|---|
|<span data-ttu-id="f1600-141">用戶端</span><span class="sxs-lookup"><span data-stu-id="f1600-141">Client</span></span> | <span data-ttu-id="f1600-142">客戶應用程式或解決方案</span><span class="sxs-lookup"><span data-stu-id="f1600-142">Customer app or solution</span></span> | <span data-ttu-id="f1600-143">中的 hello Azure 訂用帳戶與 hello 媒體服務帳戶位於 hello Azure AD 租用戶中註冊此應用程式 (實際上其 proxy)。</span><span class="sxs-lookup"><span data-stu-id="f1600-143">This app (actually, its proxy) is registered in hello Azure AD tenant in which hello Azure subscription and hello media service account reside.</span></span> <span data-ttu-id="f1600-144">hello hello 註冊應用程式的服務主體是然後授與在 hello 存取控制 (IAM) hello 媒體服務帳戶的擁有者或參與者角色。</span><span class="sxs-lookup"><span data-stu-id="f1600-144">hello service principal of hello registered app is then granted with Owner or Contributor role in hello Access Control (IAM) of hello media service account.</span></span> <span data-ttu-id="f1600-145">hello 應用程式用戶端識別碼和用戶端密碼會以 hello 服務主體。</span><span class="sxs-lookup"><span data-stu-id="f1600-145">hello service principal is represented by hello app client ID and client secret.</span></span> |
|<span data-ttu-id="f1600-146">身分識別提供者 (IDP)</span><span class="sxs-lookup"><span data-stu-id="f1600-146">Identity Provider (IDP)</span></span> | <span data-ttu-id="f1600-147">作為 IDP 的 Azure AD</span><span class="sxs-lookup"><span data-stu-id="f1600-147">Azure AD as IDP</span></span> | <span data-ttu-id="f1600-148">hello 的已註冊的應用程式服務主體 （用戶端識別碼和用戶端密碼） 會由 Azure AD hello IDP 身分進行驗證。</span><span class="sxs-lookup"><span data-stu-id="f1600-148">hello registered app service principal (client ID and client secret) is authenticated by Azure AD as hello IDP.</span></span> <span data-ttu-id="f1600-149">此驗證是在內部以隱含方式執行。</span><span class="sxs-lookup"><span data-stu-id="f1600-149">This authentication is performed internally and implicitly.</span></span> <span data-ttu-id="f1600-150">用戶端認證流程，如同 hello 用戶端會代替 hello 使用者進行驗證。</span><span class="sxs-lookup"><span data-stu-id="f1600-150">As in client credentials flow, hello client is authenticated instead of hello user.</span></span> |
|<span data-ttu-id="f1600-151">安全性權杖服務 (STS)/OAuth 伺服器</span><span class="sxs-lookup"><span data-stu-id="f1600-151">Secure Token Service (STS)/OAuth server</span></span> | <span data-ttu-id="f1600-152">作為 STS 的 Azure AD</span><span class="sxs-lookup"><span data-stu-id="f1600-152">Azure AD as STS</span></span> | <span data-ttu-id="f1600-153">驗證之後 hello IDP （或 OAuth 2.0 中的 OAuth 伺服器），存取權杖或 JSON Web Token (JWT) 做為 STS/OAuth 伺服器存取 toohello 中介層資源的 Azure AD 所簽發： 在此案例中的 hello 媒體服務 REST API 端點。</span><span class="sxs-lookup"><span data-stu-id="f1600-153">After authentication by hello IDP (or OAuth Server in OAuth 2.0 terms), an access token or JSON Web Token (JWT) is issued by Azure AD as STS/OAuth Server for access toohello middle-tier resource: in our case, hello Media Services REST API endpoint.</span></span> |
|<span data-ttu-id="f1600-154">資源</span><span class="sxs-lookup"><span data-stu-id="f1600-154">Resource</span></span> | <span data-ttu-id="f1600-155">媒體服務 REST API</span><span class="sxs-lookup"><span data-stu-id="f1600-155">Media Services REST API</span></span> | <span data-ttu-id="f1600-156">存取權杖是由 Azure AD 所簽發為 STS 或 hello OAuth 伺服器已獲得授權的每個媒體服務 REST API 呼叫。</span><span class="sxs-lookup"><span data-stu-id="f1600-156">Every Media Services REST API call is authorized by an access token that is issued by Azure AD as STS or hello OAuth server.</span></span> |

<span data-ttu-id="f1600-157">如果您執行 hello 範例程式碼，並擷取 JWT 存取權杖，hello JWT 具有下列屬性的 hello:</span><span class="sxs-lookup"><span data-stu-id="f1600-157">If you run hello sample code and capture a JWT or an access token, hello JWT has hello following attributes:</span></span>

    aud: "https://rest.media.azure.net",

    iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    iat: 1497146280,

    nbf: 1497146280,
    exp: 1497150180,

    aio: "Y2ZgYDjuy7SptPzO/muf+uRu1B+ZDQA=",

    appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6",

    appidacr: "1",

    idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/",

    oid: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    sub: "a938cfcc-d3de-479c-b0dd-d4ffe6f50f7c",

    tid: "72f988bf-86f1-41af-91ab-2d7cd011db47",

<span data-ttu-id="f1600-158">以下是 hello JWT 和 hello 四個應用程式中的 hello 屬性或 hello 上述資料表中的服務之間的 hello 對應：</span><span class="sxs-lookup"><span data-stu-id="f1600-158">Here are hello mappings between hello attributes in hello JWT and hello four applications or services in hello preceding table:</span></span>

|<span data-ttu-id="f1600-159">應用程式類型</span><span class="sxs-lookup"><span data-stu-id="f1600-159">Application type</span></span> |<span data-ttu-id="f1600-160">應用程式</span><span class="sxs-lookup"><span data-stu-id="f1600-160">Application</span></span> |<span data-ttu-id="f1600-161">JWT 屬性</span><span class="sxs-lookup"><span data-stu-id="f1600-161">JWT attribute</span></span> |
|---|---|---|
|<span data-ttu-id="f1600-162">用戶端</span><span class="sxs-lookup"><span data-stu-id="f1600-162">Client</span></span> |<span data-ttu-id="f1600-163">客戶應用程式或解決方案</span><span class="sxs-lookup"><span data-stu-id="f1600-163">Customer app or solution</span></span> |<span data-ttu-id="f1600-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6"。</span><span class="sxs-lookup"><span data-stu-id="f1600-164">appid: "02ed1e8e-af8b-477e-af3d-7e7219a99ac6".</span></span> <span data-ttu-id="f1600-165">hello 用戶端識別碼的應用程式會登錄 tooAzure AD hello 下一節。</span><span class="sxs-lookup"><span data-stu-id="f1600-165">hello client ID of an application you will register tooAzure AD in hello next section.</span></span> |
|<span data-ttu-id="f1600-166">身分識別提供者 (IDP)</span><span class="sxs-lookup"><span data-stu-id="f1600-166">Identity Provider (IDP)</span></span> | <span data-ttu-id="f1600-167">作為 IDP 的 Azure AD</span><span class="sxs-lookup"><span data-stu-id="f1600-167">Azure AD as IDP</span></span> |<span data-ttu-id="f1600-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/"。</span><span class="sxs-lookup"><span data-stu-id="f1600-168">idp: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span>  <span data-ttu-id="f1600-169">hello GUID 是 hello 的 Microsoft ID 租用戶 (microsoft.onmicrosoft.com)。</span><span class="sxs-lookup"><span data-stu-id="f1600-169">hello GUID is hello ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="f1600-170">每個租用戶都有專屬的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="f1600-170">Each tenant has its own, unique ID.</span></span> |
|<span data-ttu-id="f1600-171">安全性權杖服務 (STS)/OAuth 伺服器</span><span class="sxs-lookup"><span data-stu-id="f1600-171">Secure Token Service (STS)/OAuth server</span></span> |<span data-ttu-id="f1600-172">作為 STS 的 Azure AD</span><span class="sxs-lookup"><span data-stu-id="f1600-172">Azure AD as STS</span></span> | <span data-ttu-id="f1600-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/"。</span><span class="sxs-lookup"><span data-stu-id="f1600-173">iss: "https://sts.windows.net/72f988bf-86f1-41af-91ab-2d7cd011db47/".</span></span> <span data-ttu-id="f1600-174">hello GUID 是 hello 的 Microsoft ID 租用戶 (microsoft.onmicrosoft.com)。</span><span class="sxs-lookup"><span data-stu-id="f1600-174">hello GUID is hello ID of Microsoft tenant (microsoft.onmicrosoft.com).</span></span> |
|<span data-ttu-id="f1600-175">資源</span><span class="sxs-lookup"><span data-stu-id="f1600-175">Resource</span></span> | <span data-ttu-id="f1600-176">媒體服務 REST API</span><span class="sxs-lookup"><span data-stu-id="f1600-176">Media Services REST API</span></span> |<span data-ttu-id="f1600-177">aud: "https://rest.media.azure.net"。</span><span class="sxs-lookup"><span data-stu-id="f1600-177">aud: "https://rest.media.azure.net".</span></span> <span data-ttu-id="f1600-178">hello 收件者或 hello 存取權杖對象。</span><span class="sxs-lookup"><span data-stu-id="f1600-178">hello recipient or audience of hello access token.</span></span> |

## <a name="steps-for-setup"></a><span data-ttu-id="f1600-179">設定的步驟</span><span class="sxs-lookup"><span data-stu-id="f1600-179">Steps for setup</span></span>

<span data-ttu-id="f1600-180">tooregister 及設定 Azure AD 驗證和存取權杖來呼叫 hello Azure 媒體服務 REST API 端點，完成下列步驟的 hello tooobtain Azure AD 應用程式：</span><span class="sxs-lookup"><span data-stu-id="f1600-180">tooregister and set up an Azure AD application for Azure AD authentication, and tooobtain an access token for calling hello Azure Media Services REST API endpoint, complete hello following steps:</span></span>

1.  <span data-ttu-id="f1600-181">在 [hello [Azure 傳統入口網站](http://go.microsoft.com/fwlink/?LinkID=213885)，註冊 Azure AD 應用程式 (例如，wzmediaservice) toohello Azure AD 租用戶 (例如，microsoft.onmicrosoft.com)。</span><span class="sxs-lookup"><span data-stu-id="f1600-181">In hello [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), register an Azure AD application (for example, wzmediaservice) toohello Azure AD tenant (for example, microsoft.onmicrosoft.com).</span></span> <span data-ttu-id="f1600-182">註冊為 Web 應用程式或原生應用程式都可以。</span><span class="sxs-lookup"><span data-stu-id="f1600-182">It doesn't matter whether you registered as web app or native app.</span></span> <span data-ttu-id="f1600-183">此外，您可以選擇任何登入 URL 和回覆 URL (例如，http://wzmediaservice.com)。</span><span class="sxs-lookup"><span data-stu-id="f1600-183">Also, you can choose any sign-on URL and reply URL (for example, http://wzmediaservice.com for both).</span></span>
2. <span data-ttu-id="f1600-184">在 [hello [Azure 傳統入口網站](http://go.microsoft.com/fwlink/?LinkID=213885)，go toohello**設定**應用程式] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="f1600-184">In hello [Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=213885), go toohello **Configure** tab of your application.</span></span> <span data-ttu-id="f1600-185">請注意 hello**用戶端識別碼**。</span><span class="sxs-lookup"><span data-stu-id="f1600-185">Note hello **client ID**.</span></span> <span data-ttu-id="f1600-186">然後，在 [金鑰]之 下，產生一個 [用戶端金鑰] (用戶端祕密)。</span><span class="sxs-lookup"><span data-stu-id="f1600-186">Then, under **Keys**, generate a **client key** (client secret).</span></span> 

    > [!NOTE] 
    > <span data-ttu-id="f1600-187">記下 hello 用戶端密碼。</span><span class="sxs-lookup"><span data-stu-id="f1600-187">Take note of hello client secret.</span></span> <span data-ttu-id="f1600-188">它將不會再次顯示。</span><span class="sxs-lookup"><span data-stu-id="f1600-188">It won't be shown again.</span></span>
    
3.  <span data-ttu-id="f1600-189">在 [hello [Azure 入口網站](http://ms.portal.azure.com)，go toohello Media Services 帳戶。</span><span class="sxs-lookup"><span data-stu-id="f1600-189">In hello [Azure portal](http://ms.portal.azure.com), go toohello Media Services account.</span></span> <span data-ttu-id="f1600-190">選取 hello**存取控制**(IAM) 窗格。</span><span class="sxs-lookup"><span data-stu-id="f1600-190">Select hello **Access Control** (IAM) pane.</span></span> <span data-ttu-id="f1600-191">加入新的成員具有 hello 擁有者或 hello 參與者角色。</span><span class="sxs-lookup"><span data-stu-id="f1600-191">Add a new member that has either hello Owner or hello Contributor role.</span></span> <span data-ttu-id="f1600-192">Hello 主體搜尋 hello 註冊，讓您在步驟 1 中 （在此範例中，wzmediaservice） 的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="f1600-192">For hello principal, search for hello application name you registered in step 1 (in this example, wzmediaservice).</span></span>

## <a name="info-toocollect"></a><span data-ttu-id="f1600-193">資訊 toocollect</span><span class="sxs-lookup"><span data-stu-id="f1600-193">Info toocollect</span></span>

<span data-ttu-id="f1600-194">tooprepare REST 撰寫程式碼，請收集下列資料點 tooinclude hello 程式碼中的 hello:</span><span class="sxs-lookup"><span data-stu-id="f1600-194">tooprepare REST coding, collect hello following data points tooinclude in hello code:</span></span>

*   <span data-ttu-id="f1600-195">作為 STS 端點的 Azure AD： https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token。</span><span class="sxs-lookup"><span data-stu-id="f1600-195">Azure AD as an STS endpoint: https://login.microsoftonline.com/microsoft.onmicrosoft.com/oauth2/token.</span></span> <span data-ttu-id="f1600-196">JWT 存取權杖是從這個端點要求。</span><span class="sxs-lookup"><span data-stu-id="f1600-196">From this endpoint, a JWT access token is requested.</span></span> <span data-ttu-id="f1600-197">此外 tooserving IDP 身分，Azure AD 也可做為 STS。</span><span class="sxs-lookup"><span data-stu-id="f1600-197">In addition tooserving as an IDP, Azure AD also serves as an STS.</span></span> <span data-ttu-id="f1600-198">Azure AD 會核發存取資源所需的 JWT (存取權杖)。</span><span class="sxs-lookup"><span data-stu-id="f1600-198">Azure AD issues a JWT for resource access (an access token).</span></span> <span data-ttu-id="f1600-199">JWT 權杖含有各種宣告。</span><span class="sxs-lookup"><span data-stu-id="f1600-199">A JWT token has various claims.</span></span>
*   <span data-ttu-id="f1600-200">作為資源或對象的 Azure 媒體服務 REST API：https://rest.media.azure.net。</span><span class="sxs-lookup"><span data-stu-id="f1600-200">Azure Media Services REST API as resource or audience: https://rest.media.azure.net.</span></span>
*   <span data-ttu-id="f1600-201">用戶端識別碼：請參閱[設定步驟](#steps-for-setup)中的步驟 2。</span><span class="sxs-lookup"><span data-stu-id="f1600-201">Client ID: See step 2 in [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="f1600-202">用戶端祕密：請參閱[設定步驟](#steps-for-setup)中的步驟 2。</span><span class="sxs-lookup"><span data-stu-id="f1600-202">Client secret: See step 2 in  [Steps for setup](#steps-for-setup).</span></span>
*   <span data-ttu-id="f1600-203">Media Services 帳戶 hello 遵循格式中的 REST API 端點：</span><span class="sxs-lookup"><span data-stu-id="f1600-203">Your Media Services account REST API endpoint in hello following format:</span></span>

    <span data-ttu-id="f1600-204">https://[media_service_account_name].restv2.[data_center].media.azure.net/API</span><span class="sxs-lookup"><span data-stu-id="f1600-204">https://[media_service_account_name].restv2.[data_center].media.azure.net/API</span></span> 

    <span data-ttu-id="f1600-205">這是針對所有媒體服務 REST API 進行呼叫應用程式中的 hello 端點。</span><span class="sxs-lookup"><span data-stu-id="f1600-205">This is hello endpoint against which all Media Services REST API calls in your application are made.</span></span> <span data-ttu-id="f1600-206">例如，https://willzhanmswjapan.restv2.japanwest.media.azure.net/API。</span><span class="sxs-lookup"><span data-stu-id="f1600-206">For example, https://willzhanmswjapan.restv2.japanwest.media.azure.net/API.</span></span>

<span data-ttu-id="f1600-207">您接著可以在 web.config 或 app.config 檔案中，您的程式碼中的 toouse 放置這些五個參數。</span><span class="sxs-lookup"><span data-stu-id="f1600-207">You can then put these five parameters in your web.config or app.config file, toouse in your code.</span></span>

## <a name="sample-code"></a><span data-ttu-id="f1600-208">範例程式碼</span><span class="sxs-lookup"><span data-stu-id="f1600-208">Sample code</span></span>

<span data-ttu-id="f1600-209">您可以找到 hello 中的範例程式碼[以 Azure Media Services 存取的 Azure AD 驗證： 透過 REST API 兩者](https://github.com/willzhan/WAMSRESTSoln)。</span><span class="sxs-lookup"><span data-stu-id="f1600-209">You can find hello sample code in [Azure AD Authentication for Azure Media Services Access: Both via REST API](https://github.com/willzhan/WAMSRESTSoln).</span></span>

<span data-ttu-id="f1600-210">hello 範例程式碼有兩個部分：</span><span class="sxs-lookup"><span data-stu-id="f1600-210">hello sample code has two parts:</span></span>

*   <span data-ttu-id="f1600-211">Azure AD 驗證與授權的所有 hello REST API 程式碼的 DLL 程式庫專案。</span><span class="sxs-lookup"><span data-stu-id="f1600-211">A DLL library project that has all hello REST API code for Azure AD authentication and authorization.</span></span> <span data-ttu-id="f1600-212">它也有一種方法進行 REST API 呼叫 toohello 媒體服務 REST API 端點展開，以 hello 存取權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-212">It also has a method for making REST API calls toohello Media Services REST API endpoint, with hello access token.</span></span>
*   <span data-ttu-id="f1600-213">主控台測試用戶端，會起始 Azure AD 驗證，並呼叫不同的媒體服務 REST API。</span><span class="sxs-lookup"><span data-stu-id="f1600-213">A console test client, which initiates Azure AD authentication and calls different Media Services REST API.</span></span>

<span data-ttu-id="f1600-214">hello 範例專案具有三個功能：</span><span class="sxs-lookup"><span data-stu-id="f1600-214">hello sample project has three features:</span></span>

*   <span data-ttu-id="f1600-215">Azure AD 驗證，透過 hello 用戶端認證授與使用 hello REST API。</span><span class="sxs-lookup"><span data-stu-id="f1600-215">Azure AD authentications via hello client credentials grant by using only hello REST API.</span></span>
*   <span data-ttu-id="f1600-216">使用 hello REST API 的 azure 媒體服務存取。</span><span class="sxs-lookup"><span data-stu-id="f1600-216">Azure Media Services access by using only hello REST API.</span></span>
*   <span data-ttu-id="f1600-217">使用 azure 儲存體存取權僅 hello REST 應用程式開發介面 （做為使用 toocreate Media Services 帳戶，使用 REST API)。</span><span class="sxs-lookup"><span data-stu-id="f1600-217">Azure Storage access by using only hello REST API (as used toocreate a Media Services account, by using REST API).</span></span>


## <a name="where-is-hello-refresh-token"></a><span data-ttu-id="f1600-218">其中是 hello 重新整理權杖？</span><span class="sxs-lookup"><span data-stu-id="f1600-218">Where is hello refresh token?</span></span>

<span data-ttu-id="f1600-219">某些讀取器可能會要求： 所在 hello 重新整理權杖？</span><span class="sxs-lookup"><span data-stu-id="f1600-219">Some readers might ask: Where is hello refresh token?</span></span> <span data-ttu-id="f1600-220">為何不在此使用重新整理權杖？</span><span class="sxs-lookup"><span data-stu-id="f1600-220">Why not use a refresh token here?</span></span>

<span data-ttu-id="f1600-221">重新整理權杖的 hello 目的不是 toorefresh 存取權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-221">hello purpose of a refresh token is not toorefresh an access token.</span></span> <span data-ttu-id="f1600-222">相反地，它是設計的 toobypass 使用者驗證或使用者的介入，，當先前的權杖到期時仍可以獲得的有效存取權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-222">Instead, it is designed toobypass end-user authentication or user intervention and still get a valid access token when an earlier token expires.</span></span> <span data-ttu-id="f1600-223">比重新整理權杖更適合的名稱可能是像「略過使用者重新登入權杖」的名稱。</span><span class="sxs-lookup"><span data-stu-id="f1600-223">A better name for a refresh token might be something like "bypass user re-sign-in token."</span></span>

<span data-ttu-id="f1600-224">如果您使用 hello OAuth 2.0 授權授與流程 （使用者名稱和密碼，可代表使用者），重新整理權杖可協助您不需要求使用者介入的情況下，取得更新的存取權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-224">If you use hello OAuth 2.0 authorization grant flow (username and password, acting on behalf of a user), a refresh token helps you get a renewed access token without requesting user intervention.</span></span> <span data-ttu-id="f1600-225">不過，hello OAuth 2.0 用戶端認證授與我們在本文中說明的流程，hello 用戶端的作用代替它自己。</span><span class="sxs-lookup"><span data-stu-id="f1600-225">However, for hello OAuth 2.0 client credentials grant flow that we describe in this article, hello client acts on its own behalf.</span></span> <span data-ttu-id="f1600-226">您不需要使用者介入，而且在 hello 授權伺服器不太需要 （及將不會） 提供重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-226">You don't need user intervention at all, and hello authorization server doesn't need too(and won't) give you a refresh token.</span></span> <span data-ttu-id="f1600-227">如果您偵錯 hello **GetUrlEncodedJWT**方法，您會注意到 hello 回應 hello 權杖端點的存取權杖，但不是重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="f1600-227">If you debug hello **GetUrlEncodedJWT** method, you notice that hello response from hello token endpoint has an access token, but no refresh token.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f1600-228">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f1600-228">Next steps</span></span>

<span data-ttu-id="f1600-229">開始使用[上傳檔案 tooyour 帳戶](media-services-dotnet-upload-files.md)。</span><span class="sxs-lookup"><span data-stu-id="f1600-229">Get started with [uploading files tooyour account](media-services-dotnet-upload-files.md).</span></span>
