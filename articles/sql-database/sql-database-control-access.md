---
title: "aaaGranting 存取 tooAzure SQL 資料庫 |Microsoft 文件"
description: "深入了解授與存取 tooMicrosoft Azure SQL Database。"
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: 8e71b04c-bc38-4153-8f83-f2b14faa31d9
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 02/06/2017
ms.author: rickbyh
ms.openlocfilehash: 4c32fafa7e98b731ff2f9bf4666da7e4a3145286
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-sql-database-access-control"></a><span data-ttu-id="b8a51-103">Azure SQL Database 存取控制</span><span class="sxs-lookup"><span data-stu-id="b8a51-103">Azure SQL Database access control</span></span>
<span data-ttu-id="b8a51-104">tooprovide 安全性，SQL Database 與防火牆規則，以限制連線 IP 位址驗證機制需要使用者 tooprove 控制存取他們的身分識別和授權機制限制使用者 toospecific 動作和資料。</span><span class="sxs-lookup"><span data-stu-id="b8a51-104">tooprovide security, SQL Database controls access with firewall rules limiting connectivity by IP address, authentication mechanisms requiring users tooprove their identity, and authorization mechanisms limiting users toospecific actions and data.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="b8a51-105">如需 hello SQL Database 安全性功能的概觀，請參閱[SQL 安全性概觀](sql-database-security-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-105">For an overview of hello SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span> <span data-ttu-id="b8a51-106">如需教學課程，請參閱[保護 Azure SQL Database](sql-database-security-tutorial.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-106">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>

## <a name="firewall-and-firewall-rules"></a><span data-ttu-id="b8a51-107">防火牆與防火牆規則</span><span class="sxs-lookup"><span data-stu-id="b8a51-107">Firewall and firewall rules</span></span>
<span data-ttu-id="b8a51-108">Microsoft Azure SQL Database 為 Azure 和其他網際網路式應用程式提供關聯式資料庫服務。</span><span class="sxs-lookup"><span data-stu-id="b8a51-108">Microsoft Azure SQL Database provides a relational database service for Azure and other Internet-based applications.</span></span> <span data-ttu-id="b8a51-109">toohelp 保護您的資料，防火牆會阻止所有存取 tooyour 資料庫伺服器，直到您指定哪些電腦有權限。</span><span class="sxs-lookup"><span data-stu-id="b8a51-109">toohelp protect your data, firewalls prevent all access tooyour database server until you specify which computers have permission.</span></span> <span data-ttu-id="b8a51-110">hello 防火牆會授與存取 toodatabases hello 來自每個要求的 IP 位址為基礎。</span><span class="sxs-lookup"><span data-stu-id="b8a51-110">hello firewall grants access toodatabases based on hello originating IP address of each request.</span></span> <span data-ttu-id="b8a51-111">如需詳細資訊，請參閱 [Azure SQL Database 防火牆規則概觀](sql-database-firewall-configure.md)</span><span class="sxs-lookup"><span data-stu-id="b8a51-111">For more information, see [Overview of Azure SQL Database firewall rules](sql-database-firewall-configure.md)</span></span>

<span data-ttu-id="b8a51-112">hello Azure SQL Database 服務僅透過 TCP 通訊埠 1433年提供。</span><span class="sxs-lookup"><span data-stu-id="b8a51-112">hello Azure SQL Database service is only available through TCP port 1433.</span></span> <span data-ttu-id="b8a51-113">tooaccess SQL 資料庫，從您的電腦，請確定您的用戶端電腦防火牆允許 TCP 通訊埠 1433年上的傳出 TCP 通訊。</span><span class="sxs-lookup"><span data-stu-id="b8a51-113">tooaccess a SQL Database from your computer, ensure that your client computer firewall allows outgoing TCP communication on TCP port 1433.</span></span> <span data-ttu-id="b8a51-114">如果其他應用程式不需要，請封鎖 TCP 通訊埠 1433 的傳入連線。</span><span class="sxs-lookup"><span data-stu-id="b8a51-114">If not needed for other applications, block inbound connections on TCP port 1433.</span></span> 

<span data-ttu-id="b8a51-115">Hello 連線程序的一部分，從 Azure 虛擬機器的連線會重新導向的 tooa 不同的 IP 位址和連接埠，唯一的每個工作者角色。</span><span class="sxs-lookup"><span data-stu-id="b8a51-115">As part of hello connection process, connections from Azure virtual machines are redirected tooa different IP address and port, unique for each worker role.</span></span> <span data-ttu-id="b8a51-116">hello 連接埠號碼是在 11000 too11999 hello 範圍。</span><span class="sxs-lookup"><span data-stu-id="b8a51-116">hello port number is in hello range from 11000 too11999.</span></span> <span data-ttu-id="b8a51-117">如需 TCP 連接埠的詳細資訊，請參閱[適用於 ADO.NET 4.5 及 SQL Database 的 1433 以外的連接埠](sql-database-develop-direct-route-ports-adonet-v12.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-117">For more information about TCP ports, see [Ports beyond 1433 for ADO.NET 4.5 and SQL Database2](sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>

## <a name="authentication"></a><span data-ttu-id="b8a51-118">驗證</span><span class="sxs-lookup"><span data-stu-id="b8a51-118">Authentication</span></span>

<span data-ttu-id="b8a51-119">SQL Database 支援兩種驗證類型：</span><span class="sxs-lookup"><span data-stu-id="b8a51-119">SQL Database supports two types of authentication:</span></span>

* <span data-ttu-id="b8a51-120">**SQL 驗證**，其需要使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="b8a51-120">**SQL Authentication**, which uses a username and password.</span></span> <span data-ttu-id="b8a51-121">當您為您的資料庫建立 hello 邏輯伺服器時，您可以指定 「 伺服器管理員 」 的登入使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="b8a51-121">When you created hello logical server for your database, you specified a "server admin" login with a username and password.</span></span> <span data-ttu-id="b8a51-122">使用這些認證時，您可以驗證 tooany 為 hello 資料庫擁有者或"dbo"。 該伺服器上的資料庫</span><span class="sxs-lookup"><span data-stu-id="b8a51-122">Using these credentials, you can authenticate tooany database on that server as hello database owner, or "dbo."</span></span> 
* <span data-ttu-id="b8a51-123">**Azure Active Directory 驗證**，它會使用由 Azure Active Directory 管理的身分識別，並支援受管理和整合的網域。</span><span class="sxs-lookup"><span data-stu-id="b8a51-123">**Azure Active Directory Authentication**, which uses identities managed by Azure Active Directory and is supported for managed and integrated domains.</span></span> <span data-ttu-id="b8a51-124">[盡可能](https://docs.microsoft.com/sql/relational-databases/security/choose-an-authentication-mode)使用 Active Directory 驗證 (整合式安全性)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-124">Use Active Directory authentication (integrated security) [whenever possible](https://docs.microsoft.com/sql/relational-databases/security/choose-an-authentication-mode).</span></span> <span data-ttu-id="b8a51-125">如果您想 toouse Azure Active Directory 驗證時，您必須建立另一個伺服器系統管理員稱為 hello"Azure AD admin"，這允許 tooadminister Azure AD 使用者和群組。</span><span class="sxs-lookup"><span data-stu-id="b8a51-125">If you want toouse Azure Active Directory Authentication, you must create another server admin called hello "Azure AD admin," which is allowed tooadminister Azure AD users and groups.</span></span> <span data-ttu-id="b8a51-126">此管理員也可以執行一般伺服器管理員可執行的所有作業。</span><span class="sxs-lookup"><span data-stu-id="b8a51-126">This admin can also perform all operations that a regular server admin can.</span></span> <span data-ttu-id="b8a51-127">請參閱[連接 tooSQL 資料庫使用 Azure Active Directory 驗證](sql-database-aad-authentication.md)方式的逐步解說 toocreate Azure AD 管理員 tooenable Azure Active Directory 驗證。</span><span class="sxs-lookup"><span data-stu-id="b8a51-127">See [Connecting tooSQL Database By Using Azure Active Directory Authentication](sql-database-aad-authentication.md) for a walkthrough of how toocreate an Azure AD admin tooenable Azure Active Directory Authentication.</span></span>

<span data-ttu-id="b8a51-128">hello Database Engine 關閉連接閒置超過 30 分鐘。</span><span class="sxs-lookup"><span data-stu-id="b8a51-128">hello Database Engine closes connections that remain idle for more than 30 minutes.</span></span> <span data-ttu-id="b8a51-129">hello 連線一次必須登入，才能使用。</span><span class="sxs-lookup"><span data-stu-id="b8a51-129">hello connection must login again before it can be used.</span></span> <span data-ttu-id="b8a51-130">作用中連線 tooSQL 資料庫需要重新授權 （hello database engine 所執行） 的持續至少每隔 10 小時。</span><span class="sxs-lookup"><span data-stu-id="b8a51-130">Continuously active connections tooSQL Database require reauthorization (performed by hello database engine) at least every 10 hours.</span></span> <span data-ttu-id="b8a51-131">hello 資料庫引擎會嘗試重新授權使用 hello 最初提交的密碼並不需要使用者輸入。</span><span class="sxs-lookup"><span data-stu-id="b8a51-131">hello database engine attempts reauthorization using hello originally submitted password and no user input is required.</span></span> <span data-ttu-id="b8a51-132">基於效能考量，密碼重設 SQL Database 中時 hello 連接不是重新驗證，即使 hello 重設連接因為 tooconnection 共用。</span><span class="sxs-lookup"><span data-stu-id="b8a51-132">For performance reasons, when a password is reset in SQL Database, hello connection is not be reauthenticated, even if hello connection is reset due tooconnection pooling.</span></span> <span data-ttu-id="b8a51-133">這點不同於在內部部署 SQL Server hello 行為。</span><span class="sxs-lookup"><span data-stu-id="b8a51-133">This is different from hello behavior of on-premises SQL Server.</span></span> <span data-ttu-id="b8a51-134">如果之後 hello 連接一開始授權 hello 密碼已經變更，必須終止 hello 連線，並使用 hello 新密碼建立新的連接。</span><span class="sxs-lookup"><span data-stu-id="b8a51-134">If hello password has been changed since hello connection was initially authorized, hello connection must be terminated and a new connection made using hello new password.</span></span> <span data-ttu-id="b8a51-135">使用者以 hello`KILL DATABASE CONNECTION`權限可以明確地結束連接 tooSQL 資料庫使用 hello [KILL](https://docs.microsoft.com/sql/t-sql/language-elements/kill-transact-sql)命令。</span><span class="sxs-lookup"><span data-stu-id="b8a51-135">A user with hello `KILL DATABASE CONNECTION` permission can explicitly terminate a connection tooSQL Database by using hello [KILL](https://docs.microsoft.com/sql/t-sql/language-elements/kill-transact-sql) command.</span></span>

<span data-ttu-id="b8a51-136">使用者帳戶可建立 hello master 資料庫中，可以在 hello 伺服器上所有資料庫的權限授與或也可以建立在 hello 資料庫本身 （稱為包含的使用者）。</span><span class="sxs-lookup"><span data-stu-id="b8a51-136">User accounts can be created in hello master database and can be granted permissions in all databases on hello server, or they can be created in hello database itself (called contained users).</span></span> <span data-ttu-id="b8a51-137">如需建立和管理登入的資訊，請參閱[管理登入](sql-database-manage-logins.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-137">For information on creating and managing logins, see [Manage logins](sql-database-manage-logins.md).</span></span> <span data-ttu-id="b8a51-138">tooenhance 可攜性和 scalabilty，使用自主的資料庫使用者 tooenhance 延展性。</span><span class="sxs-lookup"><span data-stu-id="b8a51-138">tooenhance portability and scalabilty, use contained database users tooenhance scalability.</span></span> <span data-ttu-id="b8a51-139">如需自主使用者的詳細資訊，請參閱[自主的資料庫使用者 - 使資料庫可攜](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable)、[CREATE USER (Transact-SQL)](https://docs.microsoft.com/sql/t-sql/statements/create-user-transact-sql) 及[自主資料庫](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-139">For more information on contained users, see [Contained Database Users - Making Your Database Portable](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), [CREATE USER (Transact-SQL)](https://docs.microsoft.com/sql/t-sql/statements/create-user-transact-sql), and [Contained Databases](https://docs.microsoft.com/sql/relational-databases/databases/contained-databases).</span></span>

<span data-ttu-id="b8a51-140">最佳作法是您的應用程式應該使用的專用的帳戶 tooauthenticate-如此一來，您可以限制 hello 權限授與 toohello 應用程式，並減少惡意活動的 hello 風險，應用程式程式碼是很容易遭受 tooa SQL 資料隱碼攻擊。</span><span class="sxs-lookup"><span data-stu-id="b8a51-140">As a best practice your application should use a dedicated account tooauthenticate -- this way you can limit hello permissions granted toohello application and reduce hello risks of malicious activity in case your application code is vulnerable tooa SQL injection attack.</span></span> <span data-ttu-id="b8a51-141">hello 建議的作法是 toocreate[自主的資料庫使用者](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable)，可讓您的應用程式 tooauthenticate 直接 toohello 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8a51-141">hello recommended approach is toocreate a [contained database user](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable), which allows your app tooauthenticate directly toohello database.</span></span> 

## <a name="authorization"></a><span data-ttu-id="b8a51-142">Authorization</span><span class="sxs-lookup"><span data-stu-id="b8a51-142">Authorization</span></span>

<span data-ttu-id="b8a51-143">授權是指 toowhat 使用者可以在 Azure SQL Database 中執行，這由您的使用者帳戶資料庫[角色成員資格](https://docs.microsoft.com/sql/relational-databases/security/authentication-access/database-level-roles)和[物件層級權限](https://docs.microsoft.com/sql/relational-databases/security/permissions-database-engine)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-143">Authorization refers toowhat a user can do within an Azure SQL Database, and this is controlled by your user account's database [role memberships](https://docs.microsoft.com/sql/relational-databases/security/authentication-access/database-level-roles) and [object-level permissions](https://docs.microsoft.com/sql/relational-databases/security/permissions-database-engine).</span></span> <span data-ttu-id="b8a51-144">最佳做法，您應該授與使用者 hello 最低必要權限。</span><span class="sxs-lookup"><span data-stu-id="b8a51-144">As a best practice, you should grant users hello least privileges necessary.</span></span> <span data-ttu-id="b8a51-145">hello 您所連接的伺服器系統管理員帳戶是具有授權 toodo hello 資料庫內的任何項目 db_owner 的成員。</span><span class="sxs-lookup"><span data-stu-id="b8a51-145">hello server admin account you are connecting with is a member of db_owner, which has authority toodo anything within hello database.</span></span> <span data-ttu-id="b8a51-146">請儲存此帳戶，以便部署結構描述升級及其他管理作業。</span><span class="sxs-lookup"><span data-stu-id="b8a51-146">Save this account for deploying schema upgrades and other management operations.</span></span> <span data-ttu-id="b8a51-147">使用具有更多限制的權限 tooconnect 從您的應用程式 toohello 資料庫以 hello hello"ApplicationUser"帳戶應用程式所需的最低權限。</span><span class="sxs-lookup"><span data-stu-id="b8a51-147">Use hello "ApplicationUser" account with more limited permissions tooconnect from your application toohello database with hello least privileges needed by your application.</span></span> <span data-ttu-id="b8a51-148">如需詳細資訊，請參閱[管理登入](sql-database-manage-logins.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-148">For more information, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="b8a51-149">通常，只有系統管理員需要存取 toohello`master`資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8a51-149">Typically, only administrators need access toohello `master` database.</span></span> <span data-ttu-id="b8a51-150">透過建立每個資料庫中的非系統管理員的自主的資料庫使用者應該常式存取 tooeach 使用者資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8a51-150">Routine access tooeach user database should be through non-administrator contained database users created in each database.</span></span> <span data-ttu-id="b8a51-151">當您使用自主的資料庫使用者時，您不需要在 hello toocreate 登入`master`資料庫。</span><span class="sxs-lookup"><span data-stu-id="b8a51-151">When you use contained database users, you do not need toocreate logins in hello `master` database.</span></span> <span data-ttu-id="b8a51-152">如需詳細資訊，請參閱 [自主資料庫使用者 - 讓資料庫具有可攜性](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-152">For more information, see [Contained Database Users - Making Your Database Portable](https://docs.microsoft.com/sql/relational-databases/security/contained-database-users-making-your-database-portable).</span></span>

<span data-ttu-id="b8a51-153">您應該熟悉下列功能，可使用的 toolimit 或提高權限的 hello:</span><span class="sxs-lookup"><span data-stu-id="b8a51-153">You should familiarize yourself with hello following features that can be used toolimit or elevate permissions:</span></span>   
* <span data-ttu-id="b8a51-154">[模擬](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server)和[模組簽署](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/signing-stored-procedures-in-sql-server)可以是使用的 toosecurely 將提高權限暫時。</span><span class="sxs-lookup"><span data-stu-id="b8a51-154">[Impersonation](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server) and [module-signing](https://docs.microsoft.com/dotnet/framework/data/adonet/sql/signing-stored-procedures-in-sql-server) can be used toosecurely elevate permissions temporarily.</span></span>
* <span data-ttu-id="b8a51-155">[資料列層級安全性](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) 可用於使用者可存取資料列的限制。</span><span class="sxs-lookup"><span data-stu-id="b8a51-155">[Row-Level Security](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) can be used limit which rows a user can access.</span></span>
* <span data-ttu-id="b8a51-156">[資料遮罩](sql-database-dynamic-data-masking-get-started.md)可以是使用的 toolimit 公開機密資料。</span><span class="sxs-lookup"><span data-stu-id="b8a51-156">[Data Masking](sql-database-dynamic-data-masking-get-started.md) can be used toolimit exposure of sensitive data.</span></span>
* <span data-ttu-id="b8a51-157">[預存程序](https://docs.microsoft.com/sql/relational-databases/stored-procedures/stored-procedures-database-engine)可以是使用的 toolimit 可以 hello 資料庫製作的 hello 動作。</span><span class="sxs-lookup"><span data-stu-id="b8a51-157">[Stored procedures](https://docs.microsoft.com/sql/relational-databases/stored-procedures/stored-procedures-database-engine) can be used toolimit hello actions that can be taken on hello database.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b8a51-158">後續步驟</span><span class="sxs-lookup"><span data-stu-id="b8a51-158">Next steps</span></span>

- <span data-ttu-id="b8a51-159">如需 hello SQL Database 安全性功能的概觀，請參閱[SQL 安全性概觀](sql-database-security-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-159">For an overview of hello SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span>
- <span data-ttu-id="b8a51-160">toolearn 進一步了解防火牆規則，請參閱[防火牆規則](sql-database-firewall-configure.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-160">toolearn more about firewall rules, see [Firewall rules](sql-database-firewall-configure.md).</span></span>
- <span data-ttu-id="b8a51-161">toolearn 有關使用者和登入，請參閱[管理登入](sql-database-manage-logins.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-161">toolearn about users and logins, see [Manage logins](sql-database-manage-logins.md).</span></span> 
- <span data-ttu-id="b8a51-162">關於主動式監視的討論，請參閱[資料庫稽核](sql-database-auditing.md)和 [SQL Database 威脅偵測](sql-database-threat-detection.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-162">For a discussion of proactive monitoring, see [Database Auditing](sql-database-auditing.md) and [SQL Database Threat Detection](sql-database-threat-detection.md).</span></span>
- <span data-ttu-id="b8a51-163">如需教學課程，請參閱[保護 Azure SQL Database](sql-database-security-tutorial.md)。</span><span class="sxs-lookup"><span data-stu-id="b8a51-163">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
