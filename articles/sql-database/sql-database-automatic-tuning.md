---
title: "aaaSQL 資料庫-自動調整 |Microsoft 文件"
description: "SQL Database 會分析 SQL 查詢，並自動調整 toouser 工作負載。"
services: sql-database
documentationcenter: 
author: jovanpop-msft
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/05/2017
ms.author: jovanpop
ms.openlocfilehash: 897a8deaabedb6727dc49958c64d0433c5f2e4f4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-tuning"></a><span data-ttu-id="2bf19-103">自動微調</span><span class="sxs-lookup"><span data-stu-id="2bf19-103">Automatic tuning</span></span>

<span data-ttu-id="2bf19-104">Azure SQL Database 是完全受管理的資料服務，以監視 hello hello 資料庫上執行，但可以自動提升 hello 工作負載效能的查詢。</span><span class="sxs-lookup"><span data-stu-id="2bf19-104">Azure SQL Database is a fully managed data service that monitors hello queries that are executed on hello database and can automatically improve performance of hello workload.</span></span> <span data-ttu-id="2bf19-105">Azure SQL Database 具有內建智慧機制可以自動調整及改善查詢效能，透過動態調整 hello 資料庫 tooyour 工作負載。</span><span class="sxs-lookup"><span data-stu-id="2bf19-105">Azure SQL Database has a built-in intelligence mechanism that can automatically tune and improve performance of your queries by dynamically adapting hello database tooyour workload.</span></span> <span data-ttu-id="2bf19-106">Azure SQL Database 中的自動調整可能會對 Azure SQL Database toooptimize 效能的查詢，您可以啟用 hello 最重要功能之一。</span><span class="sxs-lookup"><span data-stu-id="2bf19-106">Automatic tuning in Azure SQL Database might be one of hello most important features that you can enable on Azure SQL Database toooptimize performance of your queries.</span></span>

<span data-ttu-id="2bf19-107">請參閱這篇文章 hello 步驟太[啟用自動調整](sql-database-automatic-tuning-enable.md)使用 hello Azure 入口網站。</span><span class="sxs-lookup"><span data-stu-id="2bf19-107">See this article for hello steps too[enable automatic tuning](sql-database-automatic-tuning-enable.md) using hello Azure portal.</span></span>

## <a name="why-automatic-tuning"></a><span data-ttu-id="2bf19-108">為何需要自動調整？</span><span class="sxs-lookup"><span data-stu-id="2bf19-108">Why automatic tuning?</span></span>

<span data-ttu-id="2bf19-109">其中一個傳統資料庫管理中的 hello 主要工作正在監視 hello 工作負載，識別重要的 SQL 查詢的索引，應該會新增 tooimprove 效能，而很少使用的索引。</span><span class="sxs-lookup"><span data-stu-id="2bf19-109">One of hello main tasks in classic database administration is monitoring hello workload, identifying critical SQL queries, indexes that should be added tooimprove performance, and rarely used indexes.</span></span> <span data-ttu-id="2bf19-110">Azure SQL Database 提供深入了解 hello 查詢和索引，您需要 toomonitor。</span><span class="sxs-lookup"><span data-stu-id="2bf19-110">Azure SQL Database provides detailed insight into hello queries and indexes that you need toomonitor.</span></span> <span data-ttu-id="2bf19-111">不過，持續監視資料庫是冗長乏味的艱辛工作，尤其是在處理許多資料庫時。</span><span class="sxs-lookup"><span data-stu-id="2bf19-111">However, constantly monitoring database is a hard and tedious task, especially when dealing with many databases.</span></span> <span data-ttu-id="2bf19-112">管理大量的資料庫可能是不可能 toodo 有效率地甚至具有所有可用的工具和 Azure SQL Database 和 Azure 入口網站提供的報表。</span><span class="sxs-lookup"><span data-stu-id="2bf19-112">Managing a huge number of databases might be impossible toodo efficiently even with all available tools and reports that Azure SQL Database and Azure portal provide.</span></span> <span data-ttu-id="2bf19-113">而不是監視，並手動調整您的資料庫，您可能會考慮委派一些 hello 監視及調整動作 tooAzure SQL Database 使用自動調整功能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-113">Instead of monitoring and tuning your database manually, you might consider delegating some of hello monitoring and tuning actions tooAzure SQL Database using automatic tuning feature.</span></span> 


> [!VIDEO https://channel9.msdn.com/Blogs/Azure-in-the-Enterprise/Enabling-Azure-SQL-Database-Auto-Tuning-at-Scale-for-Microsoft-IT/player]
>

## <a name="how-does-automatic-tuning-work"></a><span data-ttu-id="2bf19-114">自動調整的運作方式為何？</span><span class="sxs-lookup"><span data-stu-id="2bf19-114">How does automatic tuning work?</span></span>

<span data-ttu-id="2bf19-115">Azure SQL Database 有連續的效能監視與分析程序，經常藉以了解您的工作負載特性的 hello 與識別潛在的問題和增強功能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-115">Azure SQL Database has a continuous performance monitoring and analysis process that constantly learns about hello characteristic of your workload and identify potential issues and improvements.</span></span>

![自動調整程序](./media/sql-database-automatic-tuning/tuning-process.png)

<span data-ttu-id="2bf19-117">Azure SQL Database toodynamically 調整 tooyour 工作負載，藉由尋找哪些索引和計劃可能會改善您的工作負載的效能和功能索引，此程序讓會影響您的工作負載。</span><span class="sxs-lookup"><span data-stu-id="2bf19-117">This process enables Azure SQL Database toodynamically adapt tooyour workload by finding what indexes and plans might improve performance of your workloads and what indexes affect your workloads.</span></span> <span data-ttu-id="2bf19-118">根據這些調查結果，自動調整會套用可改善工作負載效能的調整動作。</span><span class="sxs-lookup"><span data-stu-id="2bf19-118">Based on these findings, automatic tuning applies tuning actions that improve performance of your workload.</span></span> <span data-ttu-id="2bf19-119">此外，Azure SQL Database 會持續監視，可提升您的工作負載的效能的自動調整 tooensure 所做的任何變更之後的效能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-119">In addition, Azure SQL Database continuously monitors performance after any change made by automatic tuning tooensure that it improves performance of your workload.</span></span> <span data-ttu-id="2bf19-120">未能改善效能的任何動作都會自動還原。</span><span class="sxs-lookup"><span data-stu-id="2bf19-120">Any action that didn’t improve performance is automatically reverted.</span></span> <span data-ttu-id="2bf19-121">這個驗證程序是一項重要功能，可確保所做的自動調整的任何變更不會降低 hello 工作負載效能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-121">This verification process is a key feature that ensures that any change made by automatic tuning does not decrease hello performance of your workload.</span></span>

<span data-ttu-id="2bf19-122">Azure SQL Database 中有兩個可用的自動調整層面：</span><span class="sxs-lookup"><span data-stu-id="2bf19-122">There are two automatic tuning aspects that are available in Azure SQL Database:</span></span>

 -  <span data-ttu-id="2bf19-123">**自動索引管理**：識別您的資料庫中應該新增的索引，以及應該移除的索引。</span><span class="sxs-lookup"><span data-stu-id="2bf19-123">**Automatic index management** that identifies indexes that should be added in your database, and indexes that should be removed.</span></span>
 -  <span data-ttu-id="2bf19-124">**自動計劃更正** (即將推出，已可用於 SQL Server 2017)：識別有問題的計劃並修正 SQL 計劃效能問題。</span><span class="sxs-lookup"><span data-stu-id="2bf19-124">**Automatic plan correction** (coming soon, already available in SQL Server 2017) that identifies problematic plans and fixes SQL plan performance problems.</span></span>

## <a name="automatic-index-management"></a><span data-ttu-id="2bf19-125">自動索引管理</span><span class="sxs-lookup"><span data-stu-id="2bf19-125">Automatic index management</span></span>

<span data-ttu-id="2bf19-126">在 Azure SQL 資料庫中，因為 Azure SQL Database 會了解您的工作負載，並確保永遠以最佳方式為資料編製索引，所以索引管理很簡單。</span><span class="sxs-lookup"><span data-stu-id="2bf19-126">In Azure SQL Database, index management is easy because Azure SQL Database learns about your workload and ensures that your data is always optimally indexed.</span></span> <span data-ttu-id="2bf19-127">您的工作負載要達到最佳效能，有適當的索引設計非常重要，而且自動索引管理可以協助您將索引最佳化。</span><span class="sxs-lookup"><span data-stu-id="2bf19-127">Proper index design is crucial for optimal performance of your workload, and automatic index management can help you optimize your indexes.</span></span> <span data-ttu-id="2bf19-128">自動索引管理可以是在資料庫中不正確的索引，修正效能問題或維護和改善 hello 現有資料庫結構描述的索引。</span><span class="sxs-lookup"><span data-stu-id="2bf19-128">Automatic index management can either fix performance issues in incorrectly indexed databases, or maintain and improve indexes on hello existing database schema.</span></span> 

### <a name="why-do-you-need-index-management"></a><span data-ttu-id="2bf19-129">為什麼需要索引管理？</span><span class="sxs-lookup"><span data-stu-id="2bf19-129">Why do you need index management?</span></span>

<span data-ttu-id="2bf19-130">索引加速一些您從 hello 資料表; 讀取資料的查詢不過，它們會減慢 hello 查詢更新資料。</span><span class="sxs-lookup"><span data-stu-id="2bf19-130">Indexes speed up some of your queries that read data from hello tables; however, they can slow down hello queries that update data.</span></span> <span data-ttu-id="2bf19-131">您需要 toocarefully toocreate 索引和資料行需要在 tooinclude hello 索引時分析。</span><span class="sxs-lookup"><span data-stu-id="2bf19-131">You need toocarefully analyze when toocreate an index and what columns you need tooinclude in hello index.</span></span> <span data-ttu-id="2bf19-132">某些索引在一段時間後可能不再需要。</span><span class="sxs-lookup"><span data-stu-id="2bf19-132">Some indexes might not be needed after some time.</span></span> <span data-ttu-id="2bf19-133">因此，您會需要 tooperiodically 找出並卸除 hello 索引不會帶來任何益處。</span><span class="sxs-lookup"><span data-stu-id="2bf19-133">Therefore, you would need tooperiodically identify and drop hello indexes that do not bring any benefits.</span></span> <span data-ttu-id="2bf19-134">如果您選擇忽略 hello 未使用的索引、 更新資料的 hello 查詢的效能會降低而沒有任何好處 hello 查詢讀取的資料。</span><span class="sxs-lookup"><span data-stu-id="2bf19-134">If you ignore hello unused indexes, performance of hello queries that update data would be decreased without any benefit on hello queries that read data.</span></span> <span data-ttu-id="2bf19-135">未使用的索引也會影響整體系統效能的 hello，因為其他的更新需要不必要的記錄。</span><span class="sxs-lookup"><span data-stu-id="2bf19-135">Unused indexes also affect overall performance of hello system because additional updates require unnecessary logging.</span></span>

<span data-ttu-id="2bf19-136">尋找 hello 組最佳的索引可改善效能的 hello 從資料表讀取資料，以及對更新的影響降到最低的查詢可能會需要連續且複雜的分析。</span><span class="sxs-lookup"><span data-stu-id="2bf19-136">Finding hello optimal set of indexes that improve performance of hello queries that read data from your tables and have minimal impact on updates might require continuous and complex analysis.</span></span>

<span data-ttu-id="2bf19-137">Azure SQL Database 會使用內建智慧和分析查詢，請識別索引會針對目前的工作負載，最佳的進階的規則和 hello 索引可能會移除。</span><span class="sxs-lookup"><span data-stu-id="2bf19-137">Azure SQL Database uses built-in intelligence and advanced rules that analyze your queries, identify indexes that would be optimal for your current workloads, and hello indexes might be removed.</span></span> <span data-ttu-id="2bf19-138">Azure SQL Database 可確保您已最佳化讀取資料的 hello 查詢的索引所需的最小集合，而最小化 hello 會影響到 hello 其他查詢。</span><span class="sxs-lookup"><span data-stu-id="2bf19-138">Azure SQL Database ensures that you have a minimal necessary set of indexes that optimize hello queries that read data, with hello minimized impact on hello other queries.</span></span>

### <a name="how-tooidentify-indexes-that-need-toobe-changed-in-your-database"></a><span data-ttu-id="2bf19-139">如何 tooidentify 索引您的資料庫中變更該需要 toobe 嗎？</span><span class="sxs-lookup"><span data-stu-id="2bf19-139">How tooidentify indexes that need toobe changed in your database?</span></span>

<span data-ttu-id="2bf19-140">Azure SQL Database 讓索引管理程序變得容易。</span><span class="sxs-lookup"><span data-stu-id="2bf19-140">Azure SQL Database makes index management process easy.</span></span> <span data-ttu-id="2bf19-141">而不是手動工作負載分析及監視索引的 hello 冗長程序，Azure SQL Database 分析您的工作負載，找出 hello 查詢可能與新的索引，更快速執行並找出未使用或重複的索引。</span><span class="sxs-lookup"><span data-stu-id="2bf19-141">Instead of hello tedious process of manual workload analysis and index monitoring, Azure SQL Database analyzes your workload, identifies hello queries that could be executed faster with a new index, and identifies unused or duplicated indexes.</span></span> <span data-ttu-id="2bf19-142">如需找出應變更的索引詳細資訊，可在 [Azure 入口網站中的尋找索引建議](sql-database-advisor-portal.md)中找到。</span><span class="sxs-lookup"><span data-stu-id="2bf19-142">Find more information about identification of indexes that should be changed at [Find index recommendations in Azure portal](sql-database-advisor-portal.md).</span></span>

### <a name="automatic-index-management-considerations"></a><span data-ttu-id="2bf19-143">自動索引管理考量</span><span class="sxs-lookup"><span data-stu-id="2bf19-143">Automatic index management considerations</span></span>

<span data-ttu-id="2bf19-144">如果您發現 hello 內建規則改善 hello 對資料庫效能，您可能會讓 Azure SQL database 會自動管理您的索引。</span><span class="sxs-lookup"><span data-stu-id="2bf19-144">If you find that hello built-in rules improve hello performance of your database, you might let Azure SQL database automatically manage your indexes.</span></span>

<span data-ttu-id="2bf19-145">動作需要 toocreate Azure SQL Database 中的必要索引可能會耗用資源，並暫時影響工作負載效能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-145">Actions required toocreate necessary indexes in Azure SQL Databases might consume resources and temporally affect workload performance.</span></span> <span data-ttu-id="2bf19-146">toominimize hello 影響工作負載的效能，Azure SQL Database 上建立索引的任何索引管理作業尋找 hello 適當的時間間隔。</span><span class="sxs-lookup"><span data-stu-id="2bf19-146">toominimize hello impact of index creation on workload performance, Azure SQL Database finds hello appropriate time window for any index management operation.</span></span> <span data-ttu-id="2bf19-147">微調動作就會延後，如果 hello 資料庫需要的資源 tooexecute 您的工作負載，並啟動時 hello 資料庫有足夠的資源運用於 hello 維護工作。</span><span class="sxs-lookup"><span data-stu-id="2bf19-147">Tuning action is postponed if hello database needs resources tooexecute your workload, and started when hello database has enough unused resources that can be used for hello maintenance task.</span></span> <span data-ttu-id="2bf19-148">自動索引管理中的其中一項重要功能是一種確認的 hello 動作。</span><span class="sxs-lookup"><span data-stu-id="2bf19-148">One important feature in automatic index management is a verification of hello actions.</span></span> <span data-ttu-id="2bf19-149">當 Azure SQL Database 建立或卸除索引時，監視的處理序會分析您的工作負載 tooverify hello 動作更佳的 hello 效能的效能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-149">When Azure SQL Database creates or drops index, a monitoring process analyzes performance of your workload tooverify that hello action improved hello performance.</span></span> <span data-ttu-id="2bf19-150">如果它未使顯著改進 – hello 動作才會立即還原。</span><span class="sxs-lookup"><span data-stu-id="2bf19-150">If it didn’t bring significant improvement – hello action is immediately reverted.</span></span> <span data-ttu-id="2bf19-151">如此一來，Azure SQL Database 可確保自動採取的動作不會影響工作負載的效能。</span><span class="sxs-lookup"><span data-stu-id="2bf19-151">This way, Azure SQL Database ensures that automatic actions do not negatively impact performance of your workload.</span></span> <span data-ttu-id="2bf19-152">索引建立的自動調整是透明 hello hello 基礎結構描述上的維護作業。</span><span class="sxs-lookup"><span data-stu-id="2bf19-152">Indexes created by automatic tuning are transparent for hello maintenance operation on hello underlying schema.</span></span> <span data-ttu-id="2bf19-153">結構描述變更，例如卸除或重新命名資料行不會自動建立索引的 hello 與否被封鎖。</span><span class="sxs-lookup"><span data-stu-id="2bf19-153">Schema changes such as dropping or renaming columns are not blocked by hello presence of automatically created indexes.</span></span> <span data-ttu-id="2bf19-154">Azure SQL Database 自動建立的索引會在與之相關的資料表或資料行遭到卸除時立即卸除。</span><span class="sxs-lookup"><span data-stu-id="2bf19-154">Indexes that are automatically created by Azure SQL Database are immediately dropped when related table or columns is dropped.</span></span>

## <a name="automatic-plan-choice-correction"></a><span data-ttu-id="2bf19-155">自動計劃選擇更正</span><span class="sxs-lookup"><span data-stu-id="2bf19-155">Automatic plan choice correction</span></span>

<span data-ttu-id="2bf19-156">自動計劃更正為 SQL Server 2017 CTP2.0 中新增的自動調整功能，可識別行為異常的 SQL 計劃。</span><span class="sxs-lookup"><span data-stu-id="2bf19-156">Automatic plan correction is a new automatic tuning feature added in SQL Server 2017 CTP2.0 that identifies SQL plans that misbehave.</span></span> <span data-ttu-id="2bf19-157">這個自動調整選項即將在 Azure SQL Database 推出。</span><span class="sxs-lookup"><span data-stu-id="2bf19-157">This automatic tuning option is coming soon on Azure SQL Database.</span></span> <span data-ttu-id="2bf19-158">如需詳細資訊，可在[自動調整 SQL Server 2017](https://docs.microsoft.com/sql/relational-databases/automatic-tuning/automatic-tuning) 中找到。</span><span class="sxs-lookup"><span data-stu-id="2bf19-158">Find more information at [Automatic tuning in SQL Server 2017](https://docs.microsoft.com/sql/relational-databases/automatic-tuning/automatic-tuning).</span></span>

## <a name="next-steps"></a><span data-ttu-id="2bf19-159">後續步驟</span><span class="sxs-lookup"><span data-stu-id="2bf19-159">Next steps</span></span>

- <span data-ttu-id="2bf19-160">自動調整 Azure SQL Database，然後讓自動 tooenable 完全微調功能管理您的工作負載，請參閱[啟用自動調整](sql-database-automatic-tuning-enable.md)。</span><span class="sxs-lookup"><span data-stu-id="2bf19-160">tooenable automatic tuning in Azure SQL Database and let automatic tuning feature fully manage your workload, see [Enable automatic tuning](sql-database-automatic-tuning-enable.md).</span></span>
- <span data-ttu-id="2bf19-161">toouse 手動微調，您可以檢閱[微調建議，在 Azure 入口網站中的](sql-database-advisor-portal.md)並手動套用 hello 改善查詢效能的項目。</span><span class="sxs-lookup"><span data-stu-id="2bf19-161">toouse manual tuning, you can review [Tuning recommendations in Azure portal](sql-database-advisor-portal.md) and manually apply hello ones that improve performance of your queries.</span></span>
