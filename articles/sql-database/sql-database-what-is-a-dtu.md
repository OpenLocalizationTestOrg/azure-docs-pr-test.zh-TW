---
title: "SQL Database：DTU 是什麼？ | Microsoft Docs"
description: "了解 Azure SQL Database 交易單元是什麼。"
keywords: "資料庫選項, 資料庫效能"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: CarlRabeler
ms.assetid: 89e3e9ce-2eeb-4949-b40f-6fc3bf520538
ms.service: sql-database
ms.custom: DBs & servers
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 04/13/2017
ms.author: carlrab
ms.openlocfilehash: fac947fa153d83b614dc35c3cc0d8e640bfe1c95
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="explaining-database-transaction-units-dtus-and-elastic-database-transaction-units-edtus"></a><span data-ttu-id="f4cf3-105">說明資料庫交易單位 (DTU) 和彈性資料庫交易單位 (eDTU)</span><span class="sxs-lookup"><span data-stu-id="f4cf3-105">Explaining Database Transaction Units (DTUs) and elastic Database Transaction Units (eDTUs)</span></span>
<span data-ttu-id="f4cf3-106">本文說明資料庫交易單位 (DTU) 和彈性資料庫交易單位 (eDTU)，以及當您達到 DTU 或 eDTU 上限時會發生什麼狀況。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-106">This article explains Database Transaction Units (DTUs) and elastic Database Transaction Units (eDTUs) and what happens when you hit the maximum DTUs or eDTUs.</span></span>  

## <a name="what-are-database-transaction-units-dtus"></a><span data-ttu-id="f4cf3-107">何謂資料庫交易單位 (DTU)</span><span class="sxs-lookup"><span data-stu-id="f4cf3-107">What are Database Transaction Units (DTUs)</span></span>
<span data-ttu-id="f4cf3-108">針對[服務層](sql-database-service-tiers.md#single-database-service-tiers-and-performance-levels)中特定效能等級的單一 Azure SQL Database，Microsoft 保證該資料庫具備特定的資源層級 (與 Azure 雲端的其他任何資料庫無關)，並提供可預測的效能等級。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-108">For a single Azure SQL database at a specific performance level within a [service tier](sql-database-service-tiers.md#single-database-service-tiers-and-performance-levels), Microsoft guarantees a certain level of resources for that database (independent of any other database in the Azure cloud) and providing a predictable level of performance.</span></span> <span data-ttu-id="f4cf3-109">此資源數量會計算為資料庫交易單位 (DTU) 數量，且為 CPU、記憶體、I/O (資料與交易記錄 I/O) 的混合測量。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-109">This amount of resources is calculated as a number of Database Transaction Units or DTUs, and is a blended measure of CPU, memory, I/O (data and transaction log I/O).</span></span> <span data-ttu-id="f4cf3-110">這些資源的比率，原本是由專為一般實際 OLTP 工作負載所設計的 [OLTP 基準測試工作負載](sql-database-benchmark-overview.md)來判定。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-110">The ratio amongst these resources was originally determined by an [OLTP benchmark workload](sql-database-benchmark-overview.md) designed to be typical of real-world OLTP workloads.</span></span> <span data-ttu-id="f4cf3-111">若您的工作負載超過這些任一資源的數量，系統即會節流處理輸送量，因而導致效能變慢和逾時。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-111">When your workload exceeds the amount of any of these resources, your throughput is throttled - resulting in slower performance and timeouts.</span></span> <span data-ttu-id="f4cf3-112">您工作負載使用的資源，不會影響到 Azure 雲端中其他 SQL Database 的可用資源，且其他工作負載所用的資源亦不會影響到您 SQL Database 的可用資源。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-112">The resources used by your workload do not impact the resources available to other SQL databases in the Azure cloud, and the resource used by other workloads do not impact the resources available to your SQL database.</span></span>

![週框方塊](./media/sql-database-what-is-a-dtu/bounding-box.png)

<span data-ttu-id="f4cf3-114">DTU 最適合用於了解處於不同效能等級與服務層之各 Azure SQL Database 間的相對量。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-114">DTUs are most useful for understanding the relative amount of resources between Azure SQL Databases at different performance levels and service tiers.</span></span> <span data-ttu-id="f4cf3-115">例如，藉由提升資料庫的效能等級來使 DTU 加倍，等於讓該資料庫可用的資源集合加倍。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-115">For example, doubling the DTUs by increasing the performance level of a database equates to doubling the set of resource available to that database.</span></span> <span data-ttu-id="f4cf3-116">例如，相較於具有 5 個 DTU 的 Basic 資料庫，具有 1750 個 DTU 的 Premium P11 資料庫可提供 350 倍的 DTU 計算能力。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-116">For example, a Premium P11 database with 1750 DTUs provides 350x more DTU compute power than a Basic database with 5 DTUs.</span></span>  

<span data-ttu-id="f4cf3-117">若要深入探索您工作負載的資源 (DTU) 耗用，請使用 [Azure SQL Database 查詢效能深入解析](sql-database-query-performance.md)執行以下動作：</span><span class="sxs-lookup"><span data-stu-id="f4cf3-117">To gain deeper insight into the resource (DTU) consumption of your workload, use [Azure SQL Database Query Performance Insight](sql-database-query-performance.md) to:</span></span>

- <span data-ttu-id="f4cf3-118">依 CPU/持續時間/執行計數識別排名最前面的查詢，對其進行微調可能有助於改善效能。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-118">Identify the top queries by CPU/Duration/Execution count that can potentially be tuned for improved performance.</span></span> <span data-ttu-id="f4cf3-119">例如，I/O 密集使用的查詢可能會因使用[記憶體內最佳化技術](sql-database-in-memory.md)獲得助益，可更加妥善地運用處於特定服務層和效能等級的可用記憶體。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-119">For example, an I/O intensive query might benefit from the use of [in-memory optimization techniques](sql-database-in-memory.md) to make better use of the available memory at a certain service tier and performance level.</span></span>
- <span data-ttu-id="f4cf3-120">向下鑽研查詢的詳細資料，以檢視其文字和資源使用量的歷程記錄。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-120">Drill down into the details of a query, view its text and history of resource utilization.</span></span>
- <span data-ttu-id="f4cf3-121">存取效能微調建議，其會顯示 [SQL Database Advisor](sql-database-advisor.md) 執行的動作。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-121">Access performance tuning recommendations that show actions performed by [SQL Database Advisor](sql-database-advisor.md).</span></span>

<span data-ttu-id="f4cf3-122">您可以在應用程式停機時間最短 (通常平均少於四秒) 的情況下，隨時 [變更服務層](sql-database-service-tiers.md) 。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-122">You can [change service tiers](sql-database-service-tiers.md) at any time with minimal downtime to your application (generally averaging under four seconds).</span></span> <span data-ttu-id="f4cf3-123">對於許多企業和應用程式而言，只要能夠建立資料庫，並依需求調高或調低的效能即可，尤其是當使用模式相當容易預測時更是如此。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-123">For many businesses and apps, being able to create databases and dial performance up or down on demand is enough, especially if usage patterns are relatively predictable.</span></span> <span data-ttu-id="f4cf3-124">但如果您有無法預測的使用模式，則管理成本和商務模式就會變得相當困難。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-124">But if you have unpredictable usage patterns, it can make it hard to manage costs and your business model.</span></span> <span data-ttu-id="f4cf3-125">針對此案例您可使用彈性集區，以在集區中的多個資料庫之間共用特定數量的 eDTU。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-125">For this scenario, you use an elastic pool with a certain number of eDTUs that are shared among multiple database in the pool.</span></span>

![SQL Database 簡介：不同層級和等級的單一資料庫 DTU](./media/sql-database-what-is-a-dtu/single_db_dtus.png)

## <a name="what-are-elastic-database-transaction-units-edtus"></a><span data-ttu-id="f4cf3-127">何謂彈性資料庫交易單位 (eDTU)</span><span class="sxs-lookup"><span data-stu-id="f4cf3-127">What are elastic Database Transaction Units (eDTUs)</span></span>
<span data-ttu-id="f4cf3-128">與其無論是否需要皆針對 SQL Database 提供隨時可用的專屬資源集 (DTU)，您可選擇將資料庫置於 SQL Database 上的[彈性集區](sql-database-elastic-pool.md)以在各資料庫之間共用資源集區。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-128">Rather than provide a dedicated set of resources (DTUs) to a SQL Database that is always available regardless of whether needed not, you can place databases into an [elastic pool](sql-database-elastic-pool.md) on a SQL Database server that shares a pool of resources among those database.</span></span> <span data-ttu-id="f4cf3-129">彈性集區中的共用資源，是以彈性資料庫交易單位 (eDTU) 來測量。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-129">The shared resources in an elastic pool measured by elastic Database Transaction Units or eDTUs.</span></span> <span data-ttu-id="f4cf3-130">彈性集區提供符合成本效益的簡單解決方案，以管理多個不同且具備無法預測的使用模式資料庫的效能目標。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-130">Elastic pools provide a simple cost effective solution to manage the performance goals for multiple databases that have widely varying and unpredictable usage patterns.</span></span> <span data-ttu-id="f4cf3-131">在彈性集區中，您可確保沒有任何一個資料庫使用集區中的所有資源，且針對彈性集區中的資料庫隨時提供最低限度的可用資源數量。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-131">In an elastic pool, you can guarantee that no one database uses all of the resources in the pool and also that a minimum amount of resources is always available to a database in an elastic pool.</span></span> <span data-ttu-id="f4cf3-132">如需詳細資訊，請參閱[彈性集區](sql-database-elastic-pool.md)。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-132">See  [elastic pools](sql-database-elastic-pool.md) for more information.</span></span>

![SQL Database 簡介：不同層級和等級的 eDTU](./media/sql-database-what-is-a-dtu/sqldb_elastic_pools.png)

<span data-ttu-id="f4cf3-134">集區以固定價格提供固定數目的 eDTU。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-134">A pool is given a set number of eDTUs, for a set price.</span></span> <span data-ttu-id="f4cf3-135">在彈性集區內，會給予個別資料庫彈性以在設定的界限內自動調整。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-135">Within the elastic pool, individual databases are given the flexibility to auto-scale within the configured boundaries.</span></span> <span data-ttu-id="f4cf3-136">在沈重的負載之下，資料庫可能耗用較多 eDTU 以符合需求，而負載較輕的資料庫則耗用較少 eDTU，直到完全無負載的資料庫不使用任何 eDTU 為止。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-136">Under heavy load, a database can consume more eDTUs to meet demand while databases under light loads consume less, up to the point that databases under no load consume no eDTUs.</span></span> <span data-ttu-id="f4cf3-137">針對整個集區佈建資源，而不是針對每個資料庫佈建資源，可簡化管理工作並可預測集區的預算。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-137">By provisioning resources for the entire pool, rather than per database, management tasks are simplified and you have a predictable budget for the pool.</span></span>

<span data-ttu-id="f4cf3-138">其他 eDTU 可以新增至現有集區，而不會造成資料庫停機，且對集區中資料庫沒有影響。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-138">Additional eDTUs can be added to an existing pool with no database downtime and with no impact on the databases in the pool.</span></span> <span data-ttu-id="f4cf3-139">同樣地，如果不再需要額外 eDTU，則隨時可以從現有集區中移除。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-139">Similarly, if extra eDTUs are no longer needed, they can be removed from an existing pool at any point in time.</span></span> <span data-ttu-id="f4cf3-140">您可以增減集區中的資料庫，或限制資料庫在沈重負載下可以使用的 eDTU，以便為其他資料庫保留 eDTU。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-140">You can add or subtract databases to the pool, or limit the amount of eDTUs a database can use under heavy load to reserve eDTUs for other databases.</span></span> <span data-ttu-id="f4cf3-141">如果資料庫可預測未充分使用的資源，您可以將它移出集區並設定為具有可預測資源量的單一資料庫。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-141">If a database is predictably under-utilizing resources, you can move it out of the pool and configure it as a single database with predictable amount of resources it requires.</span></span>

## <a name="how-can-i-determine-the-number-of-dtus-needed-by-my-workload"></a><span data-ttu-id="f4cf3-142">如何判斷我的工作負載所需的 DTU 數目？</span><span class="sxs-lookup"><span data-stu-id="f4cf3-142">How can I determine the number of DTUs needed by my workload?</span></span>
<span data-ttu-id="f4cf3-143">如果您希望將現有的內部部署或 SQL Server 虛擬機器工作負載移轉至 Azure SQL Database，您可以使用 [DTU 計算機](http://dtucalculator.azurewebsites.net/) 來估計所需的 DTU 數目。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-143">If you are looking to migrate an existing on-premises or SQL Server virtual machine workload to Azure SQL Database, you can use the [DTU Calculator](http://dtucalculator.azurewebsites.net/) to approximate the number of DTUs needed.</span></span> <span data-ttu-id="f4cf3-144">對於現有的 Azure SQL Database 工作負載，您可以使用 [SQL Database 查詢效能深入解析](sql-database-query-performance.md) 來了解您的資料庫資源耗用量 (DTU)，以深入了解如何最佳化您的工作負載。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-144">For an existing Azure SQL Database workload, you can use [SQL Database Query Performance Insight](sql-database-query-performance.md) to understand your database resource consumption (DTUs) to get deeper insight into how to optimize your workload.</span></span> <span data-ttu-id="f4cf3-145">您也可以使用 [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) DMV，取得最近一小時的資源耗用資訊。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-145">You can also use the [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) DMV to get the resource consumption information for the last one hour.</span></span> <span data-ttu-id="f4cf3-146">或者，也可查詢目錄檢視 [sys.resource_stats](http://msdn.microsoft.com/library/dn269979.aspx)，以取得最近 14 天的相同資料，雖然五分鐘平均值的精確度較低。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-146">Alternatively, the catalog view [sys.resource_stats](http://msdn.microsoft.com/library/dn269979.aspx) can also be queried to get the same data for the last 14 days, although at a lower fidelity of five-minute averages.</span></span>

## <a name="how-do-i-know-if-i-could-benefit-from-an-elastic-pool-of-resources"></a><span data-ttu-id="f4cf3-147">如何得知我能受益於彈性資源集區？</span><span class="sxs-lookup"><span data-stu-id="f4cf3-147">How do I know if I could benefit from an elastic pool of resources?</span></span>
<span data-ttu-id="f4cf3-148">集區適合於具備特定使用模式的大量資料庫。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-148">Pools are suited for a large number of databases with specific utilization patterns.</span></span> <span data-ttu-id="f4cf3-149">針對指定的資料庫，此模式的特徵是低平均使用量與相對不頻繁的使用量高峰。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-149">For a given database, this pattern is characterized by low average utilization with relatively infrequent utilization spikes.</span></span> <span data-ttu-id="f4cf3-150">SQL Database 會自動評估現有 SQL Database 伺服器中資料庫過去的資源使用量，並在 Azure 入口網站中建議適當的集區組態。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-150">SQL Database automatically evaluates the historical resource usage of databases in an existing SQL Database server and recommends the appropriate pool configuration in the Azure portal.</span></span> <span data-ttu-id="f4cf3-151">如需詳細資訊，請參閱 [何時應該使用彈性集區？](sql-database-elastic-pool.md)</span><span class="sxs-lookup"><span data-stu-id="f4cf3-151">For more information, see [when should an elastic pool be used?](sql-database-elastic-pool.md)</span></span>

## <a name="what-happens-when-i-hit-my-maximum-dtus"></a><span data-ttu-id="f4cf3-152">當我達到 DTU 上限時會發生什麼狀況</span><span class="sxs-lookup"><span data-stu-id="f4cf3-152">What happens when I hit my maximum DTUs</span></span>
<span data-ttu-id="f4cf3-153">效能層級會受校正和管理，以提供所需資源來將您的資料庫工作負載執行到您所選服務層/效能層級允許的上限。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-153">Performance levels are calibrated and governed to provide the needed resources to run your database workload up to the max limits allowed for your selected service tier/performance level.</span></span> <span data-ttu-id="f4cf3-154">如果您的工作負載達到 CPU/資料 IO/記錄檔 IO 限制的其中一項限制，您可繼續接收允許之最大層級的資源，但您可能會經歷較長的查詢延遲。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-154">If your workload is hitting the limits in one of CPU/Data IO/Log IO limits, you continue to receive the resources at the maximum allowed level, but you are likely to see increased latencies for your queries.</span></span> <span data-ttu-id="f4cf3-155">這些限制並不會導致任何錯誤，但除非是速度慢到使查詢開始逾時，否則會使工作負載速度變慢。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-155">These limits do not result in any errors, but rather a slowdown in the workload, unless the slowdown becomes so severe that queries start timing out.</span></span> <span data-ttu-id="f4cf3-156">如果您達到最大允許並行使用者工作階段/要求 (背景工作執行緒) 的限制，您會看到明確的錯誤。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-156">If you are hitting limits of maximum allowed concurrent user sessions/requests (worker threads), you see explicit errors.</span></span> <span data-ttu-id="f4cf3-157">如需 CPU、記憶體、資料 I/O 和交易記錄檔 I/O 以外的資源限制資訊，請參閱 [Azure SQL Database 資源限制](sql-database-resource-limits.md) 。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-157">See [Azure SQL Database resource limits](sql-database-resource-limits.md) for information on limit on resources other than CPU, memory, data I/O, and transaction log I/O.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f4cf3-158">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f4cf3-158">Next steps</span></span>
* <span data-ttu-id="f4cf3-159">如需單一資料庫和彈性集區可用的 DTU 和 eDTU 相關資訊，請參閱[服務層](sql-database-service-tiers.md)。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-159">See [Service tier](sql-database-service-tiers.md) for information on the DTUs and eDTUs available for single databases and for elastic pools.</span></span>
* <span data-ttu-id="f4cf3-160">如需 CPU、記憶體、資料 I/O 和交易記錄檔 I/O 以外的資源限制資訊，請參閱 [Azure SQL Database 資源限制](sql-database-resource-limits.md) 。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-160">See [Azure SQL Database resource limits](sql-database-resource-limits.md) for information on limit on resources other than CPU, memory, data I/O, and transaction log I/O.</span></span>
* <span data-ttu-id="f4cf3-161">請參閱 [SQL Database 查詢效能深入解析](sql-database-query-performance.md) ，以了解您的 (DTU) 耗用量。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-161">See [SQL Database Query Performance Insight](sql-database-query-performance.md) to understand your (DTUs) consumption.</span></span>
* <span data-ttu-id="f4cf3-162">請參閱 [SQL Database 基準測試概觀](sql-database-benchmark-overview.md) ，以了解 OLTP 基準測試工作負載用來判斷 DTU 混合的方法。</span><span class="sxs-lookup"><span data-stu-id="f4cf3-162">See [SQL Database benchmark overview](sql-database-benchmark-overview.md) to understand the methodology behind the OLTP benchmark workload used to determine the DTU blend.</span></span>
