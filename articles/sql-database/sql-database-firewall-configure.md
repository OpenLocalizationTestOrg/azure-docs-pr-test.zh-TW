---
title: "aaaAzure SQL Database 防火牆規則 |Microsoft 文件"
description: "了解如何 tooconfigure SQL 資料庫與伺服器層級和資料庫層級防火牆規則 toomanage 存取的防火牆。"
keywords: "資料庫防火牆"
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: cgronlun
tags: 
ms.assetid: ac57f84c-35c3-4975-9903-241c8059011e
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 04/10/2017
ms.author: rickbyh
ms.openlocfilehash: 6a8cdf629d0d0e55421a5e9f9b894a21371be568
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-sql-database-server-level-and-database-level-firewall-rules"></a><span data-ttu-id="cb1ed-104">Azure SQL Database 伺服器層級和資料庫層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-104">Azure SQL Database server-level and database-level firewall rules</span></span> 

<span data-ttu-id="cb1ed-105">Microsoft Azure SQL Database 為 Azure 和其他網際網路式應用程式提供關聯式資料庫服務。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-105">Microsoft Azure SQL Database provides a relational database service for Azure and other Internet-based applications.</span></span> <span data-ttu-id="cb1ed-106">toohelp 保護您的資料，防火牆會阻止所有存取 tooyour 資料庫伺服器，直到您指定哪些電腦有權限。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-106">toohelp protect your data, firewalls prevent all access tooyour database server until you specify which computers have permission.</span></span> <span data-ttu-id="cb1ed-107">hello 防火牆會授與存取 toodatabases hello 來自每個要求的 IP 位址為基礎。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-107">hello firewall grants access toodatabases based on hello originating IP address of each request.</span></span>

## <a name="overview"></a><span data-ttu-id="cb1ed-108">概觀</span><span class="sxs-lookup"><span data-stu-id="cb1ed-108">Overview</span></span>

<span data-ttu-id="cb1ed-109">一開始，所有的 TRANSACT-SQL 存取 tooyour Azure SQL 伺服器 hello 防火牆封鎖。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-109">Initially, all Transact-SQL access tooyour Azure SQL server is blocked by hello firewall.</span></span> <span data-ttu-id="cb1ed-110">toobegin 使用您的 Azure SQL server，您必須指定一個或多個伺服器層級防火牆規則，讓存取 tooyour Azure SQL 伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-110">toobegin using your Azure SQL server, you must specify one or more server-level firewall rules that enable access tooyour Azure SQL server.</span></span> <span data-ttu-id="cb1ed-111">請使用 hello 防火牆規則 toospecify 的 IP 位址範圍從 hello 允許網際網路，而且 Azure 應用程式是否可以嘗試 tooconnect tooyour Azure SQL server。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-111">Use hello firewall rules toospecify which IP address ranges from hello Internet are allowed, and whether Azure applications can attempt tooconnect tooyour Azure SQL server.</span></span>

<span data-ttu-id="cb1ed-112">tooselectively 授與存取 toojust 其中一個 Azure SQL server 中的 hello 資料庫，您必須建立 hello 需要資料庫的資料庫層級規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-112">tooselectively grant access toojust one of hello databases in your Azure SQL server, you must create a database-level rule for hello required database.</span></span> <span data-ttu-id="cb1ed-113">指定的 IP 位址範圍超出的 hello IP 位址在 hello 的伺服器層級防火牆規則中指定的範圍，請確定 hello hello 用戶端 IP 位址落在 hello hello 資料庫層級規則中指定的範圍內的 hello 資料庫防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-113">Specify an IP address range for hello database firewall rule that is beyond hello IP address range specified in hello server-level firewall rule, and ensure that hello IP address of hello client falls in hello range specified in hello database-level rule.</span></span>

<span data-ttu-id="cb1ed-114">從連線嘗試 hello 網際網路和 Azure 必須先通過 hello 防火牆才能到達您的 Azure SQL server 或 SQL Database 中 hello 下列圖表所示：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-114">Connection attempts from hello Internet and Azure must first pass through hello firewall before they can reach your Azure SQL server or SQL Database, as shown in hello following diagram:</span></span>

   ![圖解防火牆設定。][1]

* <span data-ttu-id="cb1ed-116">**伺服器層級防火牆規則：**這些規則可讓用戶端 tooaccess 整個 Azure SQL 伺服器，也就是所有都 hello 資料庫都 hello 相同邏輯伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-116">**Server-level firewall rules:** These rules enable clients tooaccess your entire Azure SQL server, that is, all hello databases within hello same logical server.</span></span> <span data-ttu-id="cb1ed-117">這些規則會儲存在 hello**主要**資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-117">These rules are stored in hello **master** database.</span></span> <span data-ttu-id="cb1ed-118">使用 hello 入口網站，或使用 TRANSACT-SQL 陳述式，可以設定伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-118">Server-level firewall rules can be configured by using hello portal or by using Transact-SQL statements.</span></span> <span data-ttu-id="cb1ed-119">使用 hello Azure 入口網站或 PowerShell toocreate 伺服器層級防火牆規則，您必須是 hello 訂用帳戶擁有者或訂閱參與者。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-119">toocreate server-level firewall rules using hello Azure portal or PowerShell, you must be hello subscription owner or a subscription contributor.</span></span> <span data-ttu-id="cb1ed-120">toocreate 使用 Transact SQL 的伺服器層級防火牆規則，您必須連接為 hello 伺服器層級主體登入或 hello Azure Active Directory 系統管理員 （亦即必須先建立伺服器層級防火牆規則 toohello SQL Database 執行個體由使用者以 Azure 層級權限）。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-120">toocreate a server-level firewall rule using Transact-SQL, you must connect toohello SQL Database instance as hello server-level principal login or hello Azure Active Directory administrator (which means that a server-level firewall rule must first be created by a user with Azure-level permissions).</span></span>
* <span data-ttu-id="cb1ed-121">**資料庫層級防火牆規則：**這些規則可讓用戶端 tooaccess 某些 （安全） 資料庫內 hello 相同邏輯伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-121">**Database-level firewall rules:** These rules enable clients tooaccess certain (secure) databases within hello same logical server.</span></span> <span data-ttu-id="cb1ed-122">您可以建立這些規則的每個資料庫 (包括 hello**主要**database0)，並儲存在 hello 個別的資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-122">You can create these rules for each database (including hello **master** database0) and they are stored in hello individual databases.</span></span> <span data-ttu-id="cb1ed-123">資料庫層級防火牆規則來設定它必須使用 TRANSACT-SQL 陳述式，而且只能設定之後 hello 第一個伺服器層級防火牆。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-123">Database-level firewall rules can only be configured by using Transact-SQL statements and only after you have configured hello first server-level firewall.</span></span> <span data-ttu-id="cb1ed-124">如果您是外部 hello 範圍 hello 伺服器層級防火牆規則中指定的 hello 資料庫層級防火牆規則中指定 IP 位址範圍，只有在 hello 資料庫層級範圍內有 IP 位址的用戶端才可以存取 hello 資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-124">If you specify an IP address range in hello database-level firewall rule that is outside hello range specified in hello server-level firewall rule, only those clients that have IP addresses in hello database-level range can access hello database.</span></span> <span data-ttu-id="cb1ed-125">對於資料庫，您最多可以有 128 個資料庫層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-125">You can have a maximum of 128 database-level firewall rules for a database.</span></span> <span data-ttu-id="cb1ed-126">主要與使用者資料庫的資料庫層級防火牆規則，僅可透過 Transact-SQL 來建立和管理。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-126">Database-level firewall rules for master and user databases can only be created and managed through Transact-SQL.</span></span> <span data-ttu-id="cb1ed-127">如需有關設定資料庫層級防火牆規則的詳細資訊，請參閱 hello 範例稍後在這個發行項，請參閱[sp_set_database_firewall_rule (Azure SQL Database)](https://msdn.microsoft.com/library/dn270010.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-127">For more information on configuring database-level firewall rules, see hello example later in this article and see [sp_set_database_firewall_rule (Azure SQL Databases)](https://msdn.microsoft.com/library/dn270010.aspx).</span></span>

<span data-ttu-id="cb1ed-128">**建議：** Microsoft 建議使用資料庫層級防火牆規則時可能 tooenhance 安全性和 toomake 更容易移植您的資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-128">**Recommendation:** Microsoft recommends using database-level firewall rules whenever possible tooenhance security and toomake your database more portable.</span></span> <span data-ttu-id="cb1ed-129">系統管理員使用伺服器層級防火牆規則，當您已擁有 hello 的許多資料庫相同的存取需求，且您不想 toospend 個別設定每個資料庫的時間。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-129">Use server-level firewall rules for administrators and when you have many databases that have hello same access requirements and you don't want toospend time configuring each database individually.</span></span>

> [!Note]
> <span data-ttu-id="cb1ed-130">業務續航力的 hello 內容中的可攜式資料庫的相關資訊，請參閱[嚴重損壞修復的驗證需求](sql-database-geo-replication-security-config.md)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-130">For information about portable databases in hello context of business continuity, see [Authentication requirements for disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
>

### <a name="connecting-from-hello-internet"></a><span data-ttu-id="cb1ed-131">從 hello 網際網路連線</span><span class="sxs-lookup"><span data-stu-id="cb1ed-131">Connecting from hello Internet</span></span>

<span data-ttu-id="cb1ed-132">當電腦嘗試從網際網路 hello tooconnect tooyour 資料庫伺服器時，hello 防火牆會先檢查 hello 源自對 hello 資料庫 hello 連線要求的 hello 資料庫層級防火牆規則的 hello 要求的 IP 位址：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-132">When a computer attempts tooconnect tooyour database server from hello Internet, hello firewall first checks hello originating IP address of hello request against hello database-level firewall rules, for hello database that hello connection is requesting:</span></span>

* <span data-ttu-id="cb1ed-133">如果 hello 要求 hello IP 位址是其中一個 hello hello 資料庫層級防火牆規則中指定的範圍內，hello 連接授與 toohello 包含 hello 規則的 SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-133">If hello IP address of hello request is within one of hello ranges specified in hello database-level firewall rules, hello connection is granted toohello SQL Database that contains hello rule.</span></span>
* <span data-ttu-id="cb1ed-134">如果 hello 要求 hello IP 位址不是其中一個 hello hello 資料庫層級防火牆規則中指定的範圍內，會檢查 hello 伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-134">If hello IP address of hello request is not within one of hello ranges specified in hello database-level firewall rule, hello server-level firewall rules are checked.</span></span> <span data-ttu-id="cb1ed-135">如果 hello 要求 hello IP 位址是其中一個 hello hello 伺服器層級防火牆規則中指定的範圍內，會授與 hello 連線。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-135">If hello IP address of hello request is within one of hello ranges specified in hello server-level firewall rules, hello connection is granted.</span></span> <span data-ttu-id="cb1ed-136">伺服器層級防火牆規則 hello Azure SQL server 上套用 tooall SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-136">Server-level firewall rules apply tooall SQL databases on hello Azure SQL server.</span></span>  
* <span data-ttu-id="cb1ed-137">如果 hello 要求 hello IP 位址不在任何 hello 資料庫層級中指定 hello 範圍或伺服器層級防火牆規則，hello 連接要求會失敗。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-137">If hello IP address of hello request is not within hello ranges specified in any of hello database-level or server-level firewall rules, hello connection request fails.</span></span>

> [!NOTE]
> <span data-ttu-id="cb1ed-138">tooaccess Azure SQL 資料庫從本機電腦，請確定 hello 網路和本機電腦上的防火牆允許 TCP 通訊埠 1433年上的傳出通訊。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-138">tooaccess Azure SQL Database from your local computer, ensure hello firewall on your network and local computer allows outgoing communication on TCP port 1433.</span></span>
> 

### <a name="connecting-from-azure"></a><span data-ttu-id="cb1ed-139">從 Azure 連線</span><span class="sxs-lookup"><span data-stu-id="cb1ed-139">Connecting from Azure</span></span>
<span data-ttu-id="cb1ed-140">必須啟用 tooallow 應用程式，從 Azure tooconnect tooyour Azure 的 SQL server，Azure 的連線。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-140">tooallow applications from Azure tooconnect tooyour Azure SQL server, Azure connections must be enabled.</span></span> <span data-ttu-id="cb1ed-141">當從 Azure 應用程式嘗試 tooconnect tooyour 資料庫伺服器時，會驗證 hello 防火牆，允許 Azure 連線。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-141">When an application from Azure attempts tooconnect tooyour database server, hello firewall verifies that Azure connections are allowed.</span></span> <span data-ttu-id="cb1ed-142">防火牆設定的開始和結束位址等於 too0.0.0.0 表示允許這些連接。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-142">A firewall setting with starting and ending address equal too0.0.0.0 indicates these connections are allowed.</span></span> <span data-ttu-id="cb1ed-143">如果不允許 hello 連線嘗試，hello 要求不會到達 hello Azure SQL Database 伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-143">If hello connection attempt is not allowed, hello request does not reach hello Azure SQL Database server.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cb1ed-144">這個選項會設定 hello 防火牆 tooallow 從 Azure 連接包括 hello 訂用帳戶的其他客戶的所有連線。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-144">This option configures hello firewall tooallow all connections from Azure including connections from hello subscriptions of other customers.</span></span> <span data-ttu-id="cb1ed-145">當選取此選項，請確定您的登入與使用者權限限制存取 tooonly 授權使用者。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-145">When selecting this option, make sure your login and user permissions limit access tooonly authorized users.</span></span>
> 

## <a name="creating-and-managing-firewall-rules"></a><span data-ttu-id="cb1ed-146">建立和管理防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-146">Creating and managing firewall rules</span></span>
<span data-ttu-id="cb1ed-147">您可以使用 hello 建立 hello 第一個伺服器層級防火牆設定[Azure 入口網站](https://portal.azure.com/)或以程式設計方式使用[Azure PowerShell](https://msdn.microsoft.com/library/azure/dn546724.aspx)， [Azure CLI](/cli/azure/sql/server/firewall-rule#create)，或使用 hello [REST API](https://msdn.microsoft.com/library/azure/dn505712.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-147">hello first server-level firewall setting can be created using hello [Azure portal](https://portal.azure.com/) or programmatically using [Azure PowerShell](https://msdn.microsoft.com/library/azure/dn546724.aspx), [Azure CLI](/cli/azure/sql/server/firewall-rule#create), or hello [REST API](https://msdn.microsoft.com/library/azure/dn505712.aspx).</span></span> <span data-ttu-id="cb1ed-148">後續的伺服器層級防火牆規則可以使用這些方法，以及透過 Transact-SQL 來建立和管理。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-148">Subsequent server-level firewall rules can be created and managed using these methods, and through Transact-SQL.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="cb1ed-149">資料庫層級防火牆規則只能使用 Transact-SQL 來建立和管理。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-149">Database-level firewall rules can only be created and managed using Transact-SQL.</span></span> 
>

<span data-ttu-id="cb1ed-150">tooimprove 效能考量，伺服器層級防火牆規則會暫時快取 hello 資料庫層級。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-150">tooimprove performance, server-level firewall rules are temporarily cached at hello database level.</span></span> <span data-ttu-id="cb1ed-151">toorefresh hello 快取，請參閱[DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-151">toorefresh hello cache, see [DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx).</span></span> 

> [!TIP]
> <span data-ttu-id="cb1ed-152">您可以使用[SQL Database 稽核](sql-database-auditing.md)tooaudit 伺服器層級和資料庫層級防火牆變更。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-152">You can use [SQL Database Auditing](sql-database-auditing.md) tooaudit server-level and database-level firewall changes.</span></span>
>

### <a name="azure-portal"></a><span data-ttu-id="cb1ed-153">Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="cb1ed-153">Azure portal</span></span>

<span data-ttu-id="cb1ed-154">tooset hello Azure 入口網站中的伺服器層級防火牆規則，您可以 [進入 toohello 概觀] 頁面上的 Azure SQL 資料庫或 hello 概觀頁面 Azure Database 邏輯伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-154">tooset a server-level firewall rule in hello Azure portal, you can either go toohello Overview page for your Azure SQL database or hello Overview page for your Azure Database logical server.</span></span>

> [!TIP]
> <span data-ttu-id="cb1ed-155">如需教學課程，請參閱[使用建立 DB hello Azure 入口網站](sql-database-get-started-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-155">For a tutorial, see [Create a DB using hello Azure portal](sql-database-get-started-portal.md).</span></span>
>

<span data-ttu-id="cb1ed-156">**從資料庫概觀頁面**</span><span class="sxs-lookup"><span data-stu-id="cb1ed-156">**From database overview page**</span></span>

1. <span data-ttu-id="cb1ed-157">按一下 tooset hello 資料庫概觀頁面上，從伺服器層級防火牆規則**設定伺服器防火牆**hello 工具列 hello 下列影像所示： hello**防火牆設定**hello SQL 頁面此時會開啟 資料庫伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-157">tooset a server-level firewall rule from hello database overview page, click **Set server firewall** on hello toolbar as shown in hello following image: hello **Firewall settings** page for hello SQL Database server opens.</span></span>

      ![伺服器防火牆規則](./media/sql-database-get-started-portal/server-firewall-rule.png) 

2. <span data-ttu-id="cb1ed-159">按一下**新增用戶端 IP** hello 工具列 tooadd hello 電腦的 IP 位址 hello 上您目前正在使用，然後按一下**儲存**。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-159">Click **Add client IP** on hello toolbar tooadd hello IP address of hello computer you are currently using and then click **Save**.</span></span> <span data-ttu-id="cb1ed-160">系統便會為目前的 IP 位址建立伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-160">A server-level firewall rule is created for your current IP address.</span></span>

      ![設定伺服器防火牆規則](./media/sql-database-get-started-portal/server-firewall-rule-set.png) 

<span data-ttu-id="cb1ed-162">**從伺服器概觀頁面**</span><span class="sxs-lookup"><span data-stu-id="cb1ed-162">**From server overview page**</span></span>

<span data-ttu-id="cb1ed-163">hello 伺服器隨即開啟，顯示您完全 hello 的概觀頁面格式的伺服器名稱 (例如**mynewserver20170403.database.windows.net**)，並提供進一步組態的選項。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-163">hello overview page for your server opens, showing you hello fully qualified server name (such as **mynewserver20170403.database.windows.net**) and provides options for further configuration.</span></span>

1. <span data-ttu-id="cb1ed-164">按一下 [tooset 伺服器概觀] 頁面上，從伺服器層級規則**防火牆**在底下設定 hello 下列影像中顯示 hello 左側功能表中：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-164">tooset a server-level rule from server overview page, click **Firewall** in hello left-hand menu under Settings as showed in hello following image:</span></span> 

     ![邏輯伺服器概觀](./media/sql-database-migrate-your-sql-server-database/logical-server-overview.png)

2. <span data-ttu-id="cb1ed-166">按一下**新增用戶端 IP** hello 工具列 tooadd hello 電腦的 IP 位址 hello 上您目前正在使用，然後按一下**儲存**。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-166">Click **Add client IP** on hello toolbar tooadd hello IP address of hello computer you are currently using and then click **Save**.</span></span> <span data-ttu-id="cb1ed-167">系統便會為目前的 IP 位址建立伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-167">A server-level firewall rule is created for your current IP address.</span></span>

     ![設定伺服器防火牆規則](./media/sql-database-migrate-your-sql-server-database/server-firewall-rule-set.png)

### <a name="transact-sql"></a><span data-ttu-id="cb1ed-169">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="cb1ed-169">Transact-SQL</span></span>
| <span data-ttu-id="cb1ed-170">目錄檢視或預存程序</span><span class="sxs-lookup"><span data-stu-id="cb1ed-170">Catalog View or Stored Procedure</span></span> | <span data-ttu-id="cb1ed-171">等級</span><span class="sxs-lookup"><span data-stu-id="cb1ed-171">Level</span></span> | <span data-ttu-id="cb1ed-172">說明</span><span class="sxs-lookup"><span data-stu-id="cb1ed-172">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="cb1ed-173">sys.firewall_rules</span><span class="sxs-lookup"><span data-stu-id="cb1ed-173">sys.firewall_rules</span></span>](https://msdn.microsoft.com/library/dn269980.aspx) |<span data-ttu-id="cb1ed-174">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-174">Server</span></span> |<span data-ttu-id="cb1ed-175">顯示 hello 目前的伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-175">Displays hello current server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-176">sp_set_firewall_rule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-176">sp_set_firewall_rule</span></span>](https://msdn.microsoft.com/library/dn270017.aspx) |<span data-ttu-id="cb1ed-177">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-177">Server</span></span> |<span data-ttu-id="cb1ed-178">建立或更新伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-178">Creates or updates server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-179">sp_delete_firewall_rule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-179">sp_delete_firewall_rule</span></span>](https://msdn.microsoft.com/library/dn270024.aspx) |<span data-ttu-id="cb1ed-180">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-180">Server</span></span> |<span data-ttu-id="cb1ed-181">移除伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-181">Removes server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-182">sys.database_firewall_rules</span><span class="sxs-lookup"><span data-stu-id="cb1ed-182">sys.database_firewall_rules</span></span>](https://msdn.microsoft.com/library/dn269982.aspx) |<span data-ttu-id="cb1ed-183">資料庫</span><span class="sxs-lookup"><span data-stu-id="cb1ed-183">Database</span></span> |<span data-ttu-id="cb1ed-184">顯示 hello 目前的資料庫層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-184">Displays hello current database-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-185">sp_set_database_firewall_rule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-185">sp_set_database_firewall_rule</span></span>](https://msdn.microsoft.com/library/dn270010.aspx) |<span data-ttu-id="cb1ed-186">資料庫</span><span class="sxs-lookup"><span data-stu-id="cb1ed-186">Database</span></span> |<span data-ttu-id="cb1ed-187">建立或更新 hello 資料庫層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-187">Creates or updates hello database-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-188">sp_delete_database_firewall_rule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-188">sp_delete_database_firewall_rule</span></span>](https://msdn.microsoft.com/library/dn270030.aspx) |<span data-ttu-id="cb1ed-189">資料庫</span><span class="sxs-lookup"><span data-stu-id="cb1ed-189">Databases</span></span> |<span data-ttu-id="cb1ed-190">移除資料庫層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-190">Removes database-level firewall rules</span></span> |


<span data-ttu-id="cb1ed-191">hello 下列範例檢閱 hello 現有規則，啟用 hello 伺服器 Contoso 上某個範圍的 IP 位址，並刪除防火牆規則：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-191">hello following examples review hello existing rules, enable a range of IP addresses on hello server Contoso, and deletes a firewall rule:</span></span>
   
```sql
SELECT * FROM sys.firewall_rules ORDER BY name;
```
  
<span data-ttu-id="cb1ed-192">接著，加入防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-192">Next, add a firewall rule.</span></span>
   
```sql
EXECUTE sp_set_firewall_rule @name = N'ContosoFirewallRule',
   @start_ip_address = '192.168.1.1', @end_ip_address = '192.168.1.10'
```

<span data-ttu-id="cb1ed-193">toodelete 伺服器層級防火牆規則，執行 hello sp_delete_firewall_rule 預存程序。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-193">toodelete a server-level firewall rule, execute hello sp_delete_firewall_rule stored procedure.</span></span> <span data-ttu-id="cb1ed-194">hello 下列範例會刪除名為 ContosoFirewallRule 的 hello 規則：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-194">hello following example deletes hello rule named ContosoFirewallRule:</span></span>
   
```sql
EXECUTE sp_delete_firewall_rule @name = N'ContosoFirewallRule'
```   

### <a name="azure-powershell"></a><span data-ttu-id="cb1ed-195">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="cb1ed-195">Azure PowerShell</span></span>
| <span data-ttu-id="cb1ed-196">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="cb1ed-196">Cmdlet</span></span> | <span data-ttu-id="cb1ed-197">等級</span><span class="sxs-lookup"><span data-stu-id="cb1ed-197">Level</span></span> | <span data-ttu-id="cb1ed-198">說明</span><span class="sxs-lookup"><span data-stu-id="cb1ed-198">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="cb1ed-199">Get-AzureSqlDatabaseServerFirewallRule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-199">Get-AzureSqlDatabaseServerFirewallRule</span></span>](https://msdn.microsoft.com/library/azure/dn546731.aspx) |<span data-ttu-id="cb1ed-200">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-200">Server</span></span> |<span data-ttu-id="cb1ed-201">傳回目前伺服器層級防火牆規則 hello</span><span class="sxs-lookup"><span data-stu-id="cb1ed-201">Returns hello current server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-202">New-AzureSqlDatabaseServerFirewallRule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-202">New-AzureSqlDatabaseServerFirewallRule</span></span>](https://msdn.microsoft.com/library/azure/dn546724.aspx) |<span data-ttu-id="cb1ed-203">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-203">Server</span></span> |<span data-ttu-id="cb1ed-204">建立新的伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-204">Creates a new server-level firewall rule</span></span> |
| [<span data-ttu-id="cb1ed-205">Set-AzureSqlDatabaseServerFirewallRule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-205">Set-AzureSqlDatabaseServerFirewallRule</span></span>](https://msdn.microsoft.com/library/azure/dn546739.aspx) |<span data-ttu-id="cb1ed-206">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-206">Server</span></span> |<span data-ttu-id="cb1ed-207">更新現有的伺服器層級防火牆規則 hello 屬性</span><span class="sxs-lookup"><span data-stu-id="cb1ed-207">Updates hello properties of an existing server-level firewall rule</span></span> |
| [<span data-ttu-id="cb1ed-208">Remove-AzureSqlDatabaseServerFirewallRule</span><span class="sxs-lookup"><span data-stu-id="cb1ed-208">Remove-AzureSqlDatabaseServerFirewallRule</span></span>](https://msdn.microsoft.com/library/azure/dn546727.aspx) |<span data-ttu-id="cb1ed-209">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-209">Server</span></span> |<span data-ttu-id="cb1ed-210">移除伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-210">Removes server-level firewall rules</span></span> |


<span data-ttu-id="cb1ed-211">下列範例會設定使用 PowerShell 的伺服器層級防火牆規則的 hello:</span><span class="sxs-lookup"><span data-stu-id="cb1ed-211">hello following example sets a server-level firewall rule using PowerShell:</span></span>

```powershell
New-AzureRmSqlServerFirewallRule -ResourceGroupName "myResourceGroup" `
    -ServerName $servername `
    -FirewallRuleName "AllowSome" -StartIpAddress "0.0.0.0" -EndIpAddress "0.0.0.0"
```

> [!TIP]
> <span data-ttu-id="cb1ed-212">PowerShell 範例 hello 內容中的 快速入門，請參閱[建立資料庫-PowerShell](sql-database-get-started-powershell.md)和[建立單一資料庫，並使用 PowerShell 將防火牆規則設定](scripts/sql-database-create-and-configure-database-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="cb1ed-212">For PowerShell examples in hello context of a quick start, see [Create DB - PowerShell](sql-database-get-started-powershell.md) and [Create a single database and configure a firewall rule using PowerShell](scripts/sql-database-create-and-configure-database-powershell.md)</span></span>
>

### <a name="azure-cli"></a><span data-ttu-id="cb1ed-213">Azure CLI</span><span class="sxs-lookup"><span data-stu-id="cb1ed-213">Azure CLI</span></span>
| <span data-ttu-id="cb1ed-214">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="cb1ed-214">Cmdlet</span></span> | <span data-ttu-id="cb1ed-215">等級</span><span class="sxs-lookup"><span data-stu-id="cb1ed-215">Level</span></span> | <span data-ttu-id="cb1ed-216">說明</span><span class="sxs-lookup"><span data-stu-id="cb1ed-216">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="cb1ed-217">az sql server firewall create</span><span class="sxs-lookup"><span data-stu-id="cb1ed-217">az sql server firewall create</span></span>](/cli/azure/sql/server/firewall-rule#create) | <span data-ttu-id="cb1ed-218">Hello hello 輸入 IP 位址範圍內的伺服器上建立防火牆規則 tooallow 存取 tooall SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-218">Creates a firewall rule tooallow access tooall SQL Databases on hello server from hello entered IP address range.</span></span>|
| [<span data-ttu-id="cb1ed-219">az sql server firewall delete</span><span class="sxs-lookup"><span data-stu-id="cb1ed-219">az sql server firewall delete</span></span>](/cli/azure/sql/server/firewall-rule#delete)| <span data-ttu-id="cb1ed-220">刪除防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-220">Deletes a firewall rule.</span></span>|
| [<span data-ttu-id="cb1ed-221">az sql server firewall list</span><span class="sxs-lookup"><span data-stu-id="cb1ed-221">az sql server firewall list</span></span>](/cli/azure/sql/server/firewall-rule#list)| <span data-ttu-id="cb1ed-222">列出 hello 防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-222">Lists hello firewall rules.</span></span>|
| [<span data-ttu-id="cb1ed-223">az sql server firewall rule show</span><span class="sxs-lookup"><span data-stu-id="cb1ed-223">az sql server firewall rule show</span></span>](/cli/azure/sql/server/firewall-rule#show)| <span data-ttu-id="cb1ed-224">顯示 hello 的防火牆規則的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-224">Shows hello details of a firewall rule.</span></span>|
| [<span data-ttu-id="cb1ed-225">ax sql server firewall rule update</span><span class="sxs-lookup"><span data-stu-id="cb1ed-225">ax sql server firewall rule update</span></span>](/cli/azure/sql/server/firewall-rule#update)| <span data-ttu-id="cb1ed-226">更新防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-226">Updates a firewall rule.</span></span>

<span data-ttu-id="cb1ed-227">下列範例會設定伺服器層級防火牆規則，使用 Azure CLI hello hello:</span><span class="sxs-lookup"><span data-stu-id="cb1ed-227">hello following example sets a server-level firewall rule using hello Azure CLI:</span></span> 

```azurecli-interactive
az sql server firewall-rule create --resource-group myResourceGroup --server $servername \
    -n AllowYourIp --start-ip-address 0.0.0.0 --end-ip-address 0.0.0.0
```

> [!TIP]
> <span data-ttu-id="cb1ed-228">如需 Azure CLI 範例 hello 內容中的 快速入門，請參閱[建立 DDB-Azure CLI](sql-database-get-started-cli.md)和[建立單一資料庫，並設定使用 Azure CLI hello 的防火牆規則](scripts/sql-database-create-and-configure-database-cli.md)</span><span class="sxs-lookup"><span data-stu-id="cb1ed-228">For an Azure CLI example in hello context of a quick start, see [Create DDB - Azure CLI](sql-database-get-started-cli.md) and [Create a single database and configure a firewall rule using hello Azure CLI](scripts/sql-database-create-and-configure-database-cli.md)</span></span>
>

### <a name="rest-api"></a><span data-ttu-id="cb1ed-229">REST API</span><span class="sxs-lookup"><span data-stu-id="cb1ed-229">REST API</span></span>
| <span data-ttu-id="cb1ed-230">API</span><span class="sxs-lookup"><span data-stu-id="cb1ed-230">API</span></span> | <span data-ttu-id="cb1ed-231">等級</span><span class="sxs-lookup"><span data-stu-id="cb1ed-231">Level</span></span> | <span data-ttu-id="cb1ed-232">說明</span><span class="sxs-lookup"><span data-stu-id="cb1ed-232">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="cb1ed-233">列出防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-233">List Firewall Rules</span></span>](https://msdn.microsoft.com/library/azure/dn505715.aspx) |<span data-ttu-id="cb1ed-234">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-234">Server</span></span> |<span data-ttu-id="cb1ed-235">顯示 hello 目前的伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-235">Displays hello current server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-236">建立防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-236">Create Firewall Rule</span></span>](https://msdn.microsoft.com/library/azure/dn505712.aspx) |<span data-ttu-id="cb1ed-237">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-237">Server</span></span> |<span data-ttu-id="cb1ed-238">建立或更新伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-238">Creates or updates server-level firewall rules</span></span> |
| [<span data-ttu-id="cb1ed-239">設定防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-239">Set Firewall Rule</span></span>](https://msdn.microsoft.com/library/azure/dn505707.aspx) |<span data-ttu-id="cb1ed-240">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-240">Server</span></span> |<span data-ttu-id="cb1ed-241">更新現有的伺服器層級防火牆規則 hello 屬性</span><span class="sxs-lookup"><span data-stu-id="cb1ed-241">Updates hello properties of an existing server-level firewall rule</span></span> |
| [<span data-ttu-id="cb1ed-242">刪除防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-242">Delete Firewall Rule</span></span>](https://msdn.microsoft.com/library/azure/dn505706.aspx) |<span data-ttu-id="cb1ed-243">伺服器</span><span class="sxs-lookup"><span data-stu-id="cb1ed-243">Server</span></span> |<span data-ttu-id="cb1ed-244">移除伺服器層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-244">Removes server-level firewall rules</span></span> |

## <a name="server-level-firewall-rule-versus-a-database-level-firewall-rule"></a><span data-ttu-id="cb1ed-245">伺服器層級防火牆規則與資料庫層級防火牆規則</span><span class="sxs-lookup"><span data-stu-id="cb1ed-245">Server-level firewall rule versus a database-level firewall rule</span></span>
<span data-ttu-id="cb1ed-246">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-246">Q.</span></span> <span data-ttu-id="cb1ed-247">某個資料庫的使用者是否應該完全與另一個資料庫隔離？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-247">Should users of one database be fully isolated from another database?</span></span>   
  <span data-ttu-id="cb1ed-248">如果是，請使用資料庫層級防火牆規則授與存取權。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-248">If yes, grant access using database-level firewall rules.</span></span> <span data-ttu-id="cb1ed-249">這可避免使用伺服器層級防火牆規則，允許透過 hello 防火牆存取 tooall 資料庫，請減少 hello 深度防禦。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-249">This avoids using server-level firewall rules, which permit access through hello firewall tooall databases, reducing hello depth of your defenses.</span></span>   
 
<span data-ttu-id="cb1ed-250">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-250">Q.</span></span> <span data-ttu-id="cb1ed-251">請勿在 hello IP 位址的使用者需要存取 tooall 資料庫嗎？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-251">Do users at hello IP address’s need access tooall databases?</span></span>   
  <span data-ttu-id="cb1ed-252">使用伺服器層級防火牆規則 tooreduce hello 數目的時間，您必須設定防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-252">Use server-level firewall rules tooreduce hello number of times you must configure firewall rules.</span></span>   

<span data-ttu-id="cb1ed-253">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-253">Q.</span></span> <span data-ttu-id="cb1ed-254">沒有 hello 人員或小組設定 hello 防火牆規則只可以存取透過 hello Azure 網站、 PowerShell 或 REST API 的 hello 嗎？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-254">Does hello person or team configuring hello firewall rules only have access through hello Azure portal, PowerShell, or hello REST API?</span></span>   
  <span data-ttu-id="cb1ed-255">您必須使用伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-255">You must use server-level firewall rules.</span></span> <span data-ttu-id="cb1ed-256">資料庫層級防火牆規則只能使用 Transact-SQL 來設定。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-256">Database-level firewall rules can only be configured using Transact-SQL.</span></span>  

<span data-ttu-id="cb1ed-257">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-257">Q.</span></span> <span data-ttu-id="cb1ed-258">Hello 人員或小組設定 hello 防火牆規則禁止在 hello 資料庫層級有高層級的權限嗎？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-258">Is hello person or team configuring hello firewall rules prohibited from having high-level permission at hello database level?</span></span>   
  <span data-ttu-id="cb1ed-259">使用伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-259">Use server-level firewall rules.</span></span> <span data-ttu-id="cb1ed-260">設定資料庫層級防火牆規則使用 TRANSACT-SQL，至少需要`CONTROL DATABASE`hello 資料庫層級的權限。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-260">Configuring database-level firewall rules using Transact-SQL, requires at least `CONTROL DATABASE` permission at hello database level.</span></span>  

<span data-ttu-id="cb1ed-261">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-261">Q.</span></span> <span data-ttu-id="cb1ed-262">是 hello 人員或小組設定或稽核 hello 的防火牆規則，集中管理防火牆規則的許多 (或許是 100) 的資料庫嗎？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-262">Is hello person or team configuring or auditing hello firewall rules, centrally managing firewall rules for many (perhaps 100s) of databases?</span></span>   
  <span data-ttu-id="cb1ed-263">此選項取決於您的需求和環境。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-263">This selection depends upon your needs and environment.</span></span> <span data-ttu-id="cb1ed-264">伺服器層級防火牆規則可能會更容易 tooconfigure，但是指令碼可以在 hello 資料庫層級設定的規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-264">Server-level firewall rules might be easier tooconfigure, but scripting can configure rules at hello database-level.</span></span> <span data-ttu-id="cb1ed-265">即使您使用伺服器層級防火牆規則，您可能還需要 tooaudit hello 資料庫防火牆規則，toosee，如果使用者具有`CONTROL`hello 資料庫的權限已經建立資料庫層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-265">And even if you use server-level firewall rules, you might need tooaudit hello database-firewall rules, toosee if users with `CONTROL` permission on hello database have created database-level firewall rules.</span></span>   

<span data-ttu-id="cb1ed-266">問：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-266">Q.</span></span> <span data-ttu-id="cb1ed-267">我是否可以混合使用伺服器層級和資料庫層級防火牆規則？</span><span class="sxs-lookup"><span data-stu-id="cb1ed-267">Can I use a mix of both server-level and database-level firewall rules?</span></span>   
  <span data-ttu-id="cb1ed-268">是。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-268">Yes.</span></span> <span data-ttu-id="cb1ed-269">部分使用者 (例如系統管理員) 可能需要伺服器層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-269">Some users, such as administrators might need server-level firewall rules.</span></span> <span data-ttu-id="cb1ed-270">其他使用者 (例如資料庫應用程式的使用者) 可能需要資料庫層級防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-270">Other users, such as users of a database application, might need database-level firewall rules.</span></span>   

## <a name="troubleshooting-hello-database-firewall"></a><span data-ttu-id="cb1ed-271">疑難排解 hello database 防火牆</span><span class="sxs-lookup"><span data-stu-id="cb1ed-271">Troubleshooting hello database firewall</span></span>
<span data-ttu-id="cb1ed-272">請考慮 hello 時存取 toohello Microsoft Azure SQL Database 服務未如預期般運作，下列點：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-272">Consider hello following points when access toohello Microsoft Azure SQL Database service does not behave as you expect:</span></span>

* <span data-ttu-id="cb1ed-273">**本機防火牆組態：**您的電腦可以存取 Azure SQL Database 之前，您可能需要 toocreate 防火牆例外狀況的 TCP 通訊埠 1433年電腦上。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-273">**Local firewall configuration:** Before your computer can access Azure SQL Database, you may need toocreate a firewall exception on your computer for TCP port 1433.</span></span> <span data-ttu-id="cb1ed-274">如果您要進行 hello Azure 雲端界限內連線，您可能必須 tooopen 其他連接埠。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-274">If you are making connections inside hello Azure cloud boundary, you may have tooopen additional ports.</span></span> <span data-ttu-id="cb1ed-275">如需詳細資訊，請參閱 hello **SQL Database： 內部與外部**區段[ADO.NET 4.5 和 SQL Database 1433 以外的連接埠](sql-database-develop-direct-route-ports-adonet-v12.md)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-275">For more information, see hello **SQL Database: Outside vs inside** section of [Ports beyond 1433 for ADO.NET 4.5 and SQL Database](sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>
* <span data-ttu-id="cb1ed-276">**網路位址轉譯 (NAT):**到期 tooNAT，使用您 SQL 資料庫可能會與您電腦的 IP 組態設定中所顯示的 hello IP 位址不同的電腦 tooconnect tooAzure hello IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-276">**Network address translation (NAT):** Due tooNAT, hello IP address used by your computer tooconnect tooAzure SQL Database may be different than hello IP address shown in your computer IP configuration settings.</span></span> <span data-ttu-id="cb1ed-277">您的電腦是 tooview hello IP 位址使用 tooconnect tooAzure，登入 toohello 入口網站，並瀏覽 toohello**設定**hello 裝載您資料庫的伺服器上的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-277">tooview hello IP address your computer is using tooconnect tooAzure, log in toohello portal and navigate toohello **Configure** tab on hello server that hosts your database.</span></span> <span data-ttu-id="cb1ed-278">在 hello**允許的 IP 位址**區段，hello**目前的用戶端 IP 位址**隨即出現。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-278">Under hello **Allowed IP Addresses** section, hello **Current Client IP Address** is displayed.</span></span> <span data-ttu-id="cb1ed-279">按一下**新增**toohello**允許的 IP 位址**tooallow 這部電腦 tooaccess hello 伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-279">Click **Add** toohello **Allowed IP Addresses** tooallow this computer tooaccess hello server.</span></span>
* <span data-ttu-id="cb1ed-280">**變更 toohello 允許清單有尚未生效：**可能會如往常般的五分鐘延遲變更 toohello Azure SQL Database 防火牆設定 tootake 效果。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-280">**Changes toohello allow list have not taken effect yet:** There may be as much as a five-minute delay for changes toohello Azure SQL Database firewall configuration tootake effect.</span></span>
* <span data-ttu-id="cb1ed-281">**hello 登入未獲授權，或使用不正確的密碼：** hello 連接 toohello Azure SQL Database 伺服器登入沒有 hello Azure SQL Database 伺服器的權限，或使用 hello 密碼不正確，遭到拒絕。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-281">**hello login is not authorized or an incorrect password was used:** If a login does not have permissions on hello Azure SQL Database server or hello password used is incorrect, hello connection toohello Azure SQL Database server is denied.</span></span> <span data-ttu-id="cb1ed-282">建立防火牆設定只提供連接 tooyour 伺服器; 機會 tooattempt 用戶端每個用戶端必須提供 hello 必要的安全性認證。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-282">Creating a firewall setting only provides clients with an opportunity tooattempt connecting tooyour server; each client must provide hello necessary security credentials.</span></span> <span data-ttu-id="cb1ed-283">如需準備登入的詳細資訊，請參閱「管理 Azure SQL Database 中的資料庫、登入和使用者」。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-283">For more information about preparing logins, see Managing Databases, Logins, and Users in Azure SQL Database.</span></span>
* <span data-ttu-id="cb1ed-284">**動態 IP 位址：**如果您有使用動態 IP 位址的網際網路連線，並且在經由 hello 防火牆時遇到，您可以嘗試下列解決方案 hello 的其中一個：</span><span class="sxs-lookup"><span data-stu-id="cb1ed-284">**Dynamic IP address:** If you have an Internet connection with dynamic IP addressing and you are having trouble getting through hello firewall, you could try one of hello following solutions:</span></span>
  
  * <span data-ttu-id="cb1ed-285">要求網際網路服務提供者 (ISP) hello IP 位址範圍指派 tooyour 用戶端電腦的存取 hello Azure SQL Database 伺服器，然後將 hello IP 位址範圍新增為防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-285">Ask your Internet Service Provider (ISP) for hello IP address range assigned tooyour client computers that access hello Azure SQL Database server, and then add hello IP address range as a firewall rule.</span></span>
  * <span data-ttu-id="cb1ed-286">取得靜態 IP 位址改為您的用戶端電腦，然後將 hello IP 位址新增為防火牆規則。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-286">Get static IP addressing instead for your client computers, and then add hello IP addresses as firewall rules.</span></span>

## <a name="next-steps"></a><span data-ttu-id="cb1ed-287">後續步驟</span><span class="sxs-lookup"><span data-stu-id="cb1ed-287">Next steps</span></span>

- <span data-ttu-id="cb1ed-288">如需建立資料庫和伺服器層級防火牆規則的快速入門，請參閱[建立 Azure SQL Database](sql-database-get-started-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-288">For a quick start on creating a database and a server-level firewall rule, see [Create an Azure SQL database](sql-database-get-started-portal.md).</span></span>
- <span data-ttu-id="cb1ed-289">連接 tooan Azure SQL database 中的開放原始碼或協力廠商應用程式的說明，請參閱[快速入門用戶端的程式碼範例 tooSQL 資料庫](https://msdn.microsoft.com/library/azure/ee336282.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cb1ed-289">For help in connecting tooan Azure SQL database from open source or third-party applications, see [Client quick-start code samples tooSQL Database](https://msdn.microsoft.com/library/azure/ee336282.aspx).</span></span>
- <span data-ttu-id="cb1ed-290">如需其他連接埠的資訊，您可能需要 tooopen，請參閱 hello **SQL Database： 內部與外部**區段[ADO.NET 4.5 和 SQL Database 1433 以外的連接埠](sql-database-develop-direct-route-ports-adonet-v12.md)</span><span class="sxs-lookup"><span data-stu-id="cb1ed-290">For information on additional ports that you may need tooopen, see hello **SQL Database: Outside vs inside** section of [Ports beyond 1433 for ADO.NET 4.5 and SQL Database](sql-database-develop-direct-route-ports-adonet-v12.md)</span></span>
- <span data-ttu-id="cb1ed-291">如需 Azure SQL Database 安全性的概觀，請參閱[保護您的資料庫](sql-database-security-overview.md)</span><span class="sxs-lookup"><span data-stu-id="cb1ed-291">For an overview of Azure SQL Database security, see [Securing your database](sql-database-security-overview.md)</span></span>

<!--Image references-->
[1]: ./media/sql-database-firewall-configure/sqldb-firewall-1.png
