---
title: "aaaHow tooControl 連入流量 tooan App Service 環境"
description: "深入了解如何 tooconfigure 網路安全性規則 toocontrol 輸入流量 tooan App Service 環境。"
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: 
ms.assetid: 4cc82439-8791-48a4-9485-de6d8e1d1a08
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/11/2017
ms.author: stefsch
ms.openlocfilehash: e7c6e6201db6a1ea77f7a2eee29a3b5445175495
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="how-toocontrol-inbound-traffic-tooan-app-service-environment"></a><span data-ttu-id="0624e-103">如何 tooControl 連入流量 tooan App Service 環境</span><span class="sxs-lookup"><span data-stu-id="0624e-103">How tooControl Inbound Traffic tooan App Service Environment</span></span>
## <a name="overview"></a><span data-ttu-id="0624e-104">概觀</span><span class="sxs-lookup"><span data-stu-id="0624e-104">Overview</span></span>
<span data-ttu-id="0624e-105">您可以在 Azure Resource Manager 虛擬網路**或**傳統部署模型[虛擬網路][virtualnetwork]中建立 App Service Environment。</span><span class="sxs-lookup"><span data-stu-id="0624e-105">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model [virtual network][virtualnetwork].</span></span>  <span data-ttu-id="0624e-106">新的虛擬網路與新的子網路可以在建立 App Service 環境的 hello 階段定義。</span><span class="sxs-lookup"><span data-stu-id="0624e-106">A new virtual network and new subnet can be defined at hello time an App Service Environment is created.</span></span>  <span data-ttu-id="0624e-107">或者亦可在先前既存的虛擬網路和既存的子網路中建立 APP Service 環境。</span><span class="sxs-lookup"><span data-stu-id="0624e-107">Alternatively, an App Service Environment can be created in a pre-existing virtual network and pre-existing subnet.</span></span>  <span data-ttu-id="0624e-108">在 2016 年 6 月所進行的變更之後，ASE 也可以部署到使用公用位址範圍或 RFC1918 位址空間 (也就是私人位址) 的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="0624e-108">With a change made in June 2016, ASEs can also be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e. private addresses).</span></span>  <span data-ttu-id="0624e-109">如需有關建立 App Service 環境的詳細資訊，請參閱[如何 tooCreate App Service 環境][HowToCreateAnAppServiceEnvironment]。</span><span class="sxs-lookup"><span data-stu-id="0624e-109">For more details on creating an App Service Environment see [How tooCreate an App Service Environment][HowToCreateAnAppServiceEnvironment].</span></span>

<span data-ttu-id="0624e-110">App Service 環境必須一定要建立子網路內因為子網路提供網路界限，這可以是使用的 toolock 向上游裝置和服務背後的輸入流量，使得 HTTP 及 HTTPS 流量為只接受來自特定上游IP 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-110">An App Service Environment must always be created within a subnet because a subnet provides a network boundary which can be used toolock down inbound traffic behind upstream devices and services such that HTTP and HTTPS traffic is only accepted from specific upstream IP addresses.</span></span>

<span data-ttu-id="0624e-111">您可以使用[網路安全性群組][NetworkSecurityGroups]來控制子網路上的輸入和輸出網路流量。</span><span class="sxs-lookup"><span data-stu-id="0624e-111">Inbound and outbound network traffic on a subnet is controlled using a [network security group][NetworkSecurityGroups].</span></span> <span data-ttu-id="0624e-112">控制輸入的流量需要建立網路安全性群組中的網路安全性規則，然後指派 hello 網路安全性群組 hello 子網路包含 hello App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="0624e-112">Controlling inbound traffic requires creating network security rules in a network security group, and then assigning hello network security group hello subnet containing hello App Service Environment.</span></span>

<span data-ttu-id="0624e-113">網路安全性群組指派之後 tooa 子網路，App Service 環境會允許/封鎖根據 hello hello 中的輸入的流量 tooapps 允許和拒絕 hello 網路安全性群組中定義的規則。</span><span class="sxs-lookup"><span data-stu-id="0624e-113">Once a network security group is assigned tooa subnet, inbound traffic tooapps in hello App Service Environment is allowed/blocked based on hello allow and deny rules defined in hello network security group.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="inbound-network-ports-used-in-an-app-service-environment"></a><span data-ttu-id="0624e-114">App Service Environment 中使用的輸入網路連接埠</span><span class="sxs-lookup"><span data-stu-id="0624e-114">Inbound Network Ports Used in an App Service Environment</span></span>
<span data-ttu-id="0624e-115">之前鎖定與網路安全性群組的輸入網路流量，是重要的 tooknow hello 的 App Service 環境所使用的必要和選擇性的網路連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-115">Before locking down inbound network traffic with a network security group, it is important tooknow hello set of required and optional network ports used by an App Service Environment.</span></span>  <span data-ttu-id="0624e-116">不小心關閉關閉流量 toosome 連接埠可能會導致遺失 App Service 環境中的功能。</span><span class="sxs-lookup"><span data-stu-id="0624e-116">Accidentally closing off traffic toosome ports can result in loss of functionality in an App Service Environment.</span></span>

<span data-ttu-id="0624e-117">hello 以下是使用 App Service 環境的連接埠的清單。</span><span class="sxs-lookup"><span data-stu-id="0624e-117">hello following is a list of ports used by an App Service Environment.</span></span> <span data-ttu-id="0624e-118">除非明確註明，否則所有連接埠為 **TCP**：</span><span class="sxs-lookup"><span data-stu-id="0624e-118">All ports are **TCP**, unless otherwise clearly noted:</span></span>

* <span data-ttu-id="0624e-119">454：Azure 基礎結構透過 SSL 用來管理和維護 App Service 環境的**必要連接埠**。</span><span class="sxs-lookup"><span data-stu-id="0624e-119">454:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="0624e-120">不會封鎖流量 toothis 連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-120">Do not block traffic toothis port.</span></span>  <span data-ttu-id="0624e-121">此連接埠永遠是繫結的 toohello 公用 VIP 的 ase。</span><span class="sxs-lookup"><span data-stu-id="0624e-121">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="0624e-122">455：Azure 基礎結構透過 SSL 用來管理和維護 App Service 環境的**必要連接埠**。</span><span class="sxs-lookup"><span data-stu-id="0624e-122">455:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="0624e-123">不會封鎖流量 toothis 連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-123">Do not block traffic toothis port.</span></span>  <span data-ttu-id="0624e-124">此連接埠永遠是繫結的 toohello 公用 VIP 的 ase。</span><span class="sxs-lookup"><span data-stu-id="0624e-124">This port is always bound toohello public VIP of an ASE.</span></span>
* <span data-ttu-id="0624e-125">80： 預設通訊埠的傳入 HTTP 流量 tooapps App Service 環境中的應用程式服務方案中執行。</span><span class="sxs-lookup"><span data-stu-id="0624e-125">80:  Default port for inbound HTTP traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="0624e-126">ILB 啟用 ase 中，在此連接埠是 hello ASE 繫結的 toohello ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-126">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="0624e-127">443： 預設通訊埠的輸入 SSL 流量 tooapps App Service 環境中的應用程式服務方案中執行。</span><span class="sxs-lookup"><span data-stu-id="0624e-127">443: Default port for inbound SSL traffic tooapps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="0624e-128">ILB 啟用 ase 中，在此連接埠是 hello ASE 繫結的 toohello ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-128">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="0624e-129">21：FTP 的控制通道。</span><span class="sxs-lookup"><span data-stu-id="0624e-129">21:  Control channel for FTP.</span></span>  <span data-ttu-id="0624e-130">如果未使用 FTP，就可以安全地封鎖此連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-130">This port can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="0624e-131">在 ILB 啟用 ase 中，此連接埠可能繫結的 toohello ILB ase 中的位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-131">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="0624e-132">990：FTPS 的控制通道。</span><span class="sxs-lookup"><span data-stu-id="0624e-132">990:  Control channel for FTPS.</span></span>  <span data-ttu-id="0624e-133">如果未使用 FTPS，就可以安全地封鎖此連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-133">This port can be safely blocked if FTPS is not being used.</span></span>  <span data-ttu-id="0624e-134">在 ILB 啟用 ase 中，此連接埠可能繫結的 toohello ILB ase 中的位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-134">On an ILB-enabled ASE, this port can be bound toohello ILB address for an ASE.</span></span>
* <span data-ttu-id="0624e-135">10001-10020：FTP 的資料通道。</span><span class="sxs-lookup"><span data-stu-id="0624e-135">10001-10020: Data channels for FTP.</span></span>  <span data-ttu-id="0624e-136">做為與 hello 控制通道，這些連接埠可以安全地封鎖如果不使用 FTP。</span><span class="sxs-lookup"><span data-stu-id="0624e-136">As with hello control channel, these ports can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="0624e-137">ILB 啟用 ase 中，在此連接埠可能繫結的 toohello ASE 的 ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-137">On an ILB-enabled ASE, this port can be bound toohello ASE's ILB address.</span></span>
* <span data-ttu-id="0624e-138">4016：用於 Visual Studio 2012 的遠端偵錯。</span><span class="sxs-lookup"><span data-stu-id="0624e-138">4016: Used for remote debugging with Visual Studio 2012.</span></span>  <span data-ttu-id="0624e-139">如果未使用 hello 功能，就可以安全地封鎖這個連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-139">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="0624e-140">ILB 啟用 ase 中，在此連接埠是 hello ASE 繫結的 toohello ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-140">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="0624e-141">4018：用於 Visual Studio 2013 的遠端偵錯。</span><span class="sxs-lookup"><span data-stu-id="0624e-141">4018: Used for remote debugging with Visual Studio 2013.</span></span>  <span data-ttu-id="0624e-142">如果未使用 hello 功能，就可以安全地封鎖這個連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-142">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="0624e-143">ILB 啟用 ase 中，在此連接埠是 hello ASE 繫結的 toohello ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-143">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>
* <span data-ttu-id="0624e-144">4020：用於 Visual Studio 2015 的遠端偵錯。</span><span class="sxs-lookup"><span data-stu-id="0624e-144">4020: Used for remote debugging with Visual Studio 2015.</span></span>  <span data-ttu-id="0624e-145">如果未使用 hello 功能，就可以安全地封鎖這個連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-145">This port can be safely blocked if hello feature is not being used.</span></span>  <span data-ttu-id="0624e-146">ILB 啟用 ase 中，在此連接埠是 hello ASE 繫結的 toohello ILB 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-146">On an ILB-enabled ASE, this port is bound toohello ILB address of hello ASE.</span></span>

## <a name="outbound-connectivity-and-dns-requirements"></a><span data-ttu-id="0624e-147">輸出連線和 DNS 需求</span><span class="sxs-lookup"><span data-stu-id="0624e-147">Outbound Connectivity and DNS Requirements</span></span>
<span data-ttu-id="0624e-148">App Service 環境 toofunction 正常運作，它也需要能夠存取外部 toovarious 端點。</span><span class="sxs-lookup"><span data-stu-id="0624e-148">For an App Service Environment toofunction properly, it also requires outbound access toovarious endpoints.</span></span> <span data-ttu-id="0624e-149">Hello hello 」 所需的網路連接性 」 一節中的 hello ase 中所使用的外部端點的完整清單位於[expressroute 的網路組態](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity)發行項。</span><span class="sxs-lookup"><span data-stu-id="0624e-149">A full list of hello external endpoints used by an ASE is in hello "Required Network Connectivity" section of hello [Network Configuration for ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) article.</span></span>

<span data-ttu-id="0624e-150">App Service 環境需要有效的 DNS 基礎結構，設定 hello 虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="0624e-150">App Service Environments require a valid DNS infrastructure configured for hello virtual network.</span></span>  <span data-ttu-id="0624e-151">如果任何原因 hello DNS 設定會變更在建立 App Service 環境之後，開發人員可以強制的 App Service 環境 toopick hello 新的 DNS 設定。</span><span class="sxs-lookup"><span data-stu-id="0624e-151">If for any reason hello DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment toopick up hello new DNS configuration.</span></span>  <span data-ttu-id="0624e-152">觸發輪流的環境重新開機，使用 「 重新啟動 」 圖示位於的 hello 頂端的 hello App Service 環境管理刀鋒視窗中 hello hello [Azure 入口網站][ NewPortal]會導致 hello 環境 toopick建立 hello 新的 DNS 設定。</span><span class="sxs-lookup"><span data-stu-id="0624e-152">Triggering a rolling environment reboot using hello "Restart" icon located at hello top of hello App Service Environment management blade in hello [Azure portal][NewPortal] will cause hello environment toopick up hello new DNS configuration.</span></span>

<span data-ttu-id="0624e-153">也建議 hello vnet 上的任何自訂 DNS 伺服器會預先時間先前 toocreating App Service 環境的安裝程式。</span><span class="sxs-lookup"><span data-stu-id="0624e-153">It is also recommended that any custom DNS servers on hello vnet be setup ahead of time prior toocreating an App Service Environment.</span></span>  <span data-ttu-id="0624e-154">如果在建立 App Service 環境期間變更虛擬網路的 DNS 設定，，因而造成 hello App Service 環境建立程序失敗。</span><span class="sxs-lookup"><span data-stu-id="0624e-154">If a virtual network's DNS configuration is changed while an App Service Environment is being created, that will result in hello App Service Environment creation process failing.</span></span>  <span data-ttu-id="0624e-155">同樣地，如果自訂的 DNS 伺服器 hello 存在於另一端的 VPN 閘道和 hello DNS 伺服器會為無法連線到或無法使用，hello App Service 環境的建立程序也會失敗。</span><span class="sxs-lookup"><span data-stu-id="0624e-155">In a similar vein, if a custom DNS server exists on hello other end of a VPN gateway, and hello DNS server is unreachable or unavailable, hello App Service Environment creation process will also fail.</span></span>

## <a name="creating-a-network-security-group"></a><span data-ttu-id="0624e-156">建立網路安全性群組</span><span class="sxs-lookup"><span data-stu-id="0624e-156">Creating a Network Security Group</span></span>
<span data-ttu-id="0624e-157">如需如何網路安全性群組工作的完整細節，請參閱 hello 下列[資訊][NetworkSecurityGroups]。</span><span class="sxs-lookup"><span data-stu-id="0624e-157">For full details on how network security groups work see hello following [information][NetworkSecurityGroups].</span></span>  <span data-ttu-id="0624e-158">hello Azure 服務管理下例修飾上反白顯示的網路安全性群組，而且著重於設定與套用安全性群組 tooa 子網路，其中包含 App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="0624e-158">hello Azure Service Management example below touches on highlights of network security groups, with a focus on configuring and applying a network security group tooa subnet that contains an App Service Environment.</span></span>

<span data-ttu-id="0624e-159">**注意：**可以設定網路安全性群組，以圖形方式使用 hello [Azure 入口網站](https://portal.azure.com)或透過 Azure PowerShell。</span><span class="sxs-lookup"><span data-stu-id="0624e-159">**Note:** Network security groups can be configured graphically using hello [Azure Portal](https://portal.azure.com) or through Azure PowerShell.</span></span>

<span data-ttu-id="0624e-160">網路安全性群組首次會建立為與訂用帳戶相關聯的獨立實體。</span><span class="sxs-lookup"><span data-stu-id="0624e-160">Network security groups are first created as a standalone entity associated with a subscription.</span></span> <span data-ttu-id="0624e-161">因為在 Azure 的區域中，會建立網路安全性群組，確認該 hello 網路安全性小組已建立 hello 相同為 App Service 環境的 hello 地區。</span><span class="sxs-lookup"><span data-stu-id="0624e-161">Since network security groups are created in an Azure region, ensure that hello network security group is created in hello same region as hello App Service Environment.</span></span>

<span data-ttu-id="0624e-162">hello 下列示範如何建立網路安全性群組：</span><span class="sxs-lookup"><span data-stu-id="0624e-162">hello following demonstrates creating a network security group:</span></span>

    New-AzureNetworkSecurityGroup -Name "testNSGexample" -Location "South Central US" -Label "Example network security group for an app service environment"

<span data-ttu-id="0624e-163">網路安全性小組建立之後，一或多個網路安全性規則會加入 tooit。</span><span class="sxs-lookup"><span data-stu-id="0624e-163">Once a network security group is created, one or more network security rules are added tooit.</span></span>  <span data-ttu-id="0624e-164">由於 hello 組規則會隨著時間變更，因此建議 toospace 出 hello 編號配置用於規則優先順序 toomake 它輕鬆 tooinsert 其他規則一段時間。</span><span class="sxs-lookup"><span data-stu-id="0624e-164">Since hello set of rules may change over time, it is recommended toospace out hello numbering scheme used for rule priorities toomake it easy tooinsert additional rules over time.</span></span>

<span data-ttu-id="0624e-165">下列的 hello 範例顯示明確授與存取 toohello 管理連接埠所需的 hello Azure 基礎結構 toomanage 並維護 App Service 環境的規則。</span><span class="sxs-lookup"><span data-stu-id="0624e-165">hello example below shows a rule that explicitly grants access toohello management ports needed by hello Azure infrastructure toomanage and maintain an App Service Environment.</span></span>  <span data-ttu-id="0624e-166">請注意，所有管理流量流程透過 SSL 受到用戶端憑證，因此即使 hello 連接埠已開啟他們都無法存取由 Azure 的管理基礎結構的任何實體。</span><span class="sxs-lookup"><span data-stu-id="0624e-166">Note that all management traffic flows over SSL and is secured by client certificates, so even though hello ports are opened they are inaccessible by any entity other than Azure management infrastructure.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "ALLOW AzureMngmt" -Type Inbound -Priority 100 -Action Allow -SourceAddressPrefix 'INTERNET'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '454-455' -Protocol TCP


<span data-ttu-id="0624e-167">當鎖定存取 tooport 80 和 443 太 「 隱藏 」 App Service 環境上游裝置或服務後，您將需要 tooknow hello 上游的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-167">When locking down access tooport 80 and 443 too"hide" an App Service Environment behind upstream devices or services, you will need tooknow hello upstream IP address.</span></span>  <span data-ttu-id="0624e-168">例如，如果您正在使用 web 應用程式的防火牆 (WAF)，hello WAF 必須時使用它自己的 IP 位址 （或位址） proxy 處理流量 tooa 下游的 App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="0624e-168">For example, if you are using a web application firewall (WAF), hello WAF will have its own IP address (or addresses) which it uses when proxying traffic tooa downstream App Service Environment.</span></span>  <span data-ttu-id="0624e-169">您將需要 toouse hello 這個 IP 位址*SourceAddressPrefix*網路安全性規則的參數。</span><span class="sxs-lookup"><span data-stu-id="0624e-169">You will need toouse this IP address in hello *SourceAddressPrefix* parameter of a network security rule.</span></span>

<span data-ttu-id="0624e-170">在 hello 下列範例中，明確地允許從特定的上游 IP 位址的輸入的流量。</span><span class="sxs-lookup"><span data-stu-id="0624e-170">In hello example below, inbound traffic from a specific upstream IP address is explicitly allowed.</span></span>  <span data-ttu-id="0624e-171">hello 位址*1.2.3.4*上游 WAF hello IP 位址做為預留位置。</span><span class="sxs-lookup"><span data-stu-id="0624e-171">hello address *1.2.3.4* is used as a placeholder for hello IP address of an upstream WAF.</span></span>  <span data-ttu-id="0624e-172">變更您上游的裝置或服務所使用的 hello 值 toomatch hello 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-172">Change hello value toomatch hello address used by your upstream device or service.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTP" -Type Inbound -Priority 200 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '80' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTPS" -Type Inbound -Priority 300 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '443' -Protocol TCP

<span data-ttu-id="0624e-173">如果想要使用 FTP 支援，hello 下列規則可用來當作範本 toogrant 存取 toohello FTP 控制連接埠和資料通道連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-173">If FTP support is desired, hello following rules can be used as a template toogrant access toohello FTP control port and data channel ports.</span></span>  <span data-ttu-id="0624e-174">由於 FTP 是可設定狀態的通訊協定，您可能無法透過傳統的 HTTP/HTTPS 的防火牆或 proxy 裝置可以 tooroute FTP 流量。</span><span class="sxs-lookup"><span data-stu-id="0624e-174">Since FTP is a stateful protocol, you may not be able tooroute FTP traffic through a traditional HTTP/HTTPS firewall or proxy device.</span></span>  <span data-ttu-id="0624e-175">在此情況下，您將需要 tooset hello *SourceAddressPrefix* tooa 不同值，例如 hello IP 位址範圍的開發人員套件或部署在執行的 FTP 用戶端的電腦。</span><span class="sxs-lookup"><span data-stu-id="0624e-175">In this case you will need tooset hello *SourceAddressPrefix* tooa different value - for example hello IP address range of developer or deployment machines on which FTP clients are running.</span></span> 

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPCtrl" -Type Inbound -Priority 400 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '21' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPDataRange" -Type Inbound -Priority 500 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10001-10020' -Protocol TCP

<span data-ttu-id="0624e-176">(**附註：** hello 預覽期間可能會變更 hello 資料通道連接埠範圍。)</span><span class="sxs-lookup"><span data-stu-id="0624e-176">(**Note:**  hello data channel port range may change during hello preview period.)</span></span>

<span data-ttu-id="0624e-177">如果使用 Visual Studio 遠端偵錯時，下列規則的 hello 示範 toogrant 的存取方式。</span><span class="sxs-lookup"><span data-stu-id="0624e-177">If remote debugging with Visual Studio is used, hello following rules demonstrate how toogrant access.</span></span>  <span data-ttu-id="0624e-178">因為每個支援的 Visual Studio 版本使用不同的連接埠進行遠端偵錯，所以每個版本會有個別的規則。</span><span class="sxs-lookup"><span data-stu-id="0624e-178">There is a separate rule for each supported version of Visual Studio since each version uses a different port for remote debugging.</span></span>  <span data-ttu-id="0624e-179">如同 FTP 存取，遠端偵錯流量可能不會透過傳統 WAF 或 Proxy 裝置正確傳送。</span><span class="sxs-lookup"><span data-stu-id="0624e-179">As with FTP access, remote debugging traffic may not flow properly through a traditional WAF or proxy device.</span></span>  <span data-ttu-id="0624e-180">hello *SourceAddressPrefix*您可以改為將執行 Visual Studio 程式開發人員電腦 toohello IP 位址範圍。</span><span class="sxs-lookup"><span data-stu-id="0624e-180">hello *SourceAddressPrefix* can instead be set toohello IP address range of developer machines running Visual Studio.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2012" -Type Inbound -Priority 600 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4016' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2013" -Type Inbound -Priority 700 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4018' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2015" -Type Inbound -Priority 800 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4020' -Protocol TCP

## <a name="assigning-a-network-security-group-tooa-subnet"></a><span data-ttu-id="0624e-181">指定網路安全性群組 tooa 子網路</span><span class="sxs-lookup"><span data-stu-id="0624e-181">Assigning a Network Security Group tooa Subnet</span></span>
<span data-ttu-id="0624e-182">網路安全性群組已拒絕存取 tooall 外部流量的預設安全性規則。</span><span class="sxs-lookup"><span data-stu-id="0624e-182">A network security group has a default security rule which denies access tooall external traffic.</span></span>  <span data-ttu-id="0624e-183">hello 自結合 hello，上面所述的網路安全性規則的結果，hello 封鎖輸入的流量的預設安全性規則，從來源位址範圍的資料傳輸相關聯的*允許*動作就可以toosend 流量 tooapps App Service 環境中執行。</span><span class="sxs-lookup"><span data-stu-id="0624e-183">hello result from combining hello network security rules described above, and hello default security rule blocking inbound traffic, is that only traffic from source address ranges associated with an *Allow* action will be able toosend traffic tooapps running in an App Service Environment.</span></span>

<span data-ttu-id="0624e-184">網路安全性群組安全性規則後，它必須包含 hello App Service 環境 toobe 指派 toohello 子網路。</span><span class="sxs-lookup"><span data-stu-id="0624e-184">After a network security group is populated with security rules, it needs toobe assigned toohello subnet containing hello App Service Environment.</span></span>  <span data-ttu-id="0624e-185">hello 分派命令參考兩個 hello hello 虛擬網路的名稱以及 hello hello hello App Service 環境建立所在的子網路名稱，hello App Service 環境的所在位置。</span><span class="sxs-lookup"><span data-stu-id="0624e-185">hello assignment command references both hello name of hello virtual network where hello App Service Environment resides, as well as hello name of hello subnet where hello App Service Environment was created.</span></span>  

<span data-ttu-id="0624e-186">hello 下面範例是網路安全性群組指派 tooa 子網路與虛擬網路：</span><span class="sxs-lookup"><span data-stu-id="0624e-186">hello example below shows a network security group being assigned tooa subnet and virtual network:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityGroupToSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

<span data-ttu-id="0624e-187">一旦 hello 網路安全性的群組指派可成功 （hello 分派是長時間執行的作業伺服器，可能需要幾分鐘的時間 toocomplete），僅輸入流量比對*允許*規則將會成功連線到 hello 應用程式中的應用程式服務的環境。</span><span class="sxs-lookup"><span data-stu-id="0624e-187">Once hello network security group assignment succeeds (hello assignment is a long-running operations and can take a few minutes toocomplete), only inbound traffic matching *Allow* rules will successfully reach apps in hello App Service Environment.</span></span>

<span data-ttu-id="0624e-188">完整性 hello 下列範例會示範如何 tooremove，因此解譯關聯 hello 網路安全性群組從 hello 子網路：</span><span class="sxs-lookup"><span data-stu-id="0624e-188">For completeness hello following example shows how tooremove and thus dis-associate hello network security group from hello subnet:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Remove-AzureNetworkSecurityGroupFromSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

## <a name="special-considerations-for-explicit-ip-ssl"></a><span data-ttu-id="0624e-189">明確 IP-SSL 的特殊考量</span><span class="sxs-lookup"><span data-stu-id="0624e-189">Special Considerations for Explicit IP-SSL</span></span>
<span data-ttu-id="0624e-190">如果應用程式已設定使用明確的 IP SSL 位址 (適用於*只*有公開 VIP 的 tooASEs)，而不是使用 hello App Service 環境的 hello 預設 IP 位址，HTTP 和 HTTPS 流量進入 hello 子網路的流程透過一組不同的連接埠 80 和 443 以外的連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-190">If an app is configured with an explicit IP-SSL address (applicable *only* tooASEs that have a public VIP), instead of using hello default IP address of hello App Service Environment, both HTTP and HTTPS traffic flows into hello subnet over a different set of ports other than ports 80 and 443.</span></span>

<span data-ttu-id="0624e-191">從 hello App Service 環境的詳細資料 UX 刀鋒視窗的 hello 入口網站使用者介面中可以找到 hello 個別對每個 IP SSL 位址所使用的連接埠。</span><span class="sxs-lookup"><span data-stu-id="0624e-191">hello individual pair of ports used by each IP-SSL address can be found in hello portal user interface from hello App Service Environment's details UX blade.</span></span>  <span data-ttu-id="0624e-192">選取 [所有設定] --> [IP 位址]。</span><span class="sxs-lookup"><span data-stu-id="0624e-192">Select "All settings" --> "IP addresses".</span></span>  <span data-ttu-id="0624e-193">hello 「 IP 位址 」 刀鋒視窗中顯示的 hello App Service 環境中，明確地設定所有 IP SSL 位址的資料表是使用的 tooroute hello 特殊的通訊埠組合以及 HTTP 及 HTTPS 流量相關聯每個 IP SSL 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-193">hello "IP addresses" blade shows a table of all explicitly configured IP-SSL addresses for hello App Service Environment, along with hello special port pair that is used tooroute HTTP and HTTPS traffic associated with each IP-SSL address.</span></span>  <span data-ttu-id="0624e-194">它是需要 toobe 設定網路安全性群組中的規則時，為 hello DestinationPortRange 參數使用此連接埠配對。</span><span class="sxs-lookup"><span data-stu-id="0624e-194">It is this port pair that needs toobe used for hello DestinationPortRange parameters when configuring rules in a network security group.</span></span>

<span data-ttu-id="0624e-195">設定的 toouse IP SSL 上 ase 中的應用程式時，外部客戶看不到，而且不需要 tooworry hello 特殊連接埠組對應的相關。</span><span class="sxs-lookup"><span data-stu-id="0624e-195">When an app on an ASE is configured toouse IP-SSL, external customers will not see and do not need tooworry about hello special port pair mapping.</span></span>  <span data-ttu-id="0624e-196">流量 toohello 應用程式通常會流 toohello 設定 IP SSL 位址。</span><span class="sxs-lookup"><span data-stu-id="0624e-196">Traffic toohello apps will flow normally toohello configured IP-SSL address.</span></span>  <span data-ttu-id="0624e-197">hello 轉譯 toohello 特殊的通訊埠組合自動期間進行的作業在內部 hello 最後階段路由傳送流量至 hello 子網路包含 hello ASE。</span><span class="sxs-lookup"><span data-stu-id="0624e-197">hello translation toohello special port pair automatically happens internally during hello final leg of routing traffic into hello subnet containing hello ASE.</span></span> 

## <a name="getting-started"></a><span data-ttu-id="0624e-198">開始使用</span><span class="sxs-lookup"><span data-stu-id="0624e-198">Getting started</span></span>
<span data-ttu-id="0624e-199">tooget 開始使用應用程式服務環境中，請參閱[簡介 tooApp Service 環境][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="0624e-199">tooget started with App Service Environments, see [Introduction tooApp Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="0624e-200">所有發行項以及-的應用程式服務環境的 hello[讀我檔案的應用程式服務環境](../app-service/app-service-app-service-environments-readme.md)。</span><span class="sxs-lookup"><span data-stu-id="0624e-200">All articles and How-To's for App Service Environments are available in hello [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="0624e-201">如需周圍安全地從 App Service 環境連接 toobackend 資源的應用程式的詳細資訊，請參閱[安全地從 App Service 環境連接 tooBackend 資源][SecurelyConnecttoBackend]</span><span class="sxs-lookup"><span data-stu-id="0624e-201">For details around apps securely connecting toobackend resource from an App Service Environment, see [Securely connecting tooBackend resources from an App Service Environment][SecurelyConnecttoBackend]</span></span>

<span data-ttu-id="0624e-202">如需 hello Azure 應用程式服務平台的詳細資訊，請參閱[Azure App Service][AzureAppService]。</span><span class="sxs-lookup"><span data-stu-id="0624e-202">For more information about hello Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[SecurelyConnecttoBackend]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-securely-connecting-to-backend-resources/
[NewPortal]:  https://portal.azure.com  

<!-- IMAGES -->

