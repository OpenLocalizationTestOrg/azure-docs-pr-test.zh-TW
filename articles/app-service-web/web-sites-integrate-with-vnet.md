---
title: "將應用程式與 Azure 虛擬網路整合"
description: "示範如何將 Azure App Service 中的應用程式連接到新的或現有的 Azure 虛擬網路"
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: cephalin
ms.assetid: 90bc6ec6-133d-4d87-a867-fcf77da75f5a
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/23/2017
ms.author: ccompy
ms.openlocfilehash: 61508f759cad92a8c17d72a5d68fb54994c393bc
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2017
---
# <a name="integrate-your-app-with-an-azure-virtual-network"></a><span data-ttu-id="adefd-103">將您的應用程式與 Azure 虛擬網路整合</span><span class="sxs-lookup"><span data-stu-id="adefd-103">Integrate your app with an Azure Virtual Network</span></span>
<span data-ttu-id="adefd-104">本文件說明 Azure App Service 虛擬網路整合功能，以及示範如何使用 [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714)中的應用程式來設定此功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-104">This document describes the Azure App Service virtual network integration feature and shows how to set it up with apps in [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714).</span></span> <span data-ttu-id="adefd-105">如果您不熟悉 Azure 虛擬網路 (VNet)，這是一種功能，可讓您在非網際網路可路由網路中放置許多您可控制其存取的 Azure 資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-105">If you are unfamiliar with Azure Virtual Networks (VNets), this is a capability that allows you to place many of your Azure resources in a non-internet routeable network that you control access to.</span></span> <span data-ttu-id="adefd-106">接著，可以使用各種 VPN 技術，將這些網路連接到您的內部部署網路。</span><span class="sxs-lookup"><span data-stu-id="adefd-106">These networks can then be connected to your on-premises networks using a variety of VPN technologies.</span></span> <span data-ttu-id="adefd-107">若要深入了解「Azure 虛擬網路」，請從以下資訊著手：[Azure 虛擬網路概觀][VNETOverview]。</span><span class="sxs-lookup"><span data-stu-id="adefd-107">To learn more about Azure Virtual Networks, start with the information here: [Azure Virtual Network Overview][VNETOverview].</span></span> 

<span data-ttu-id="adefd-108">Azure App Service 具有兩種形式。</span><span class="sxs-lookup"><span data-stu-id="adefd-108">The Azure App Service has two forms.</span></span> 

1. <span data-ttu-id="adefd-109">支援全系列價格方案的多租用戶系統</span><span class="sxs-lookup"><span data-stu-id="adefd-109">The multi-tenant systems that support the full range of pricing plans</span></span>
2. <span data-ttu-id="adefd-110">部署到您的 VNet 的 App Service 環境 (ASE) 進階功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-110">The App Service Environment (ASE) premium feature, which deploys into your VNet.</span></span> 

<span data-ttu-id="adefd-111">本文會演練 VNet 整合和非 App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="adefd-111">This document goes through VNet Integration and not App Service Environment.</span></span> <span data-ttu-id="adefd-112">如果您想要了解 ASE 功能的相關資訊，請從以下的資訊開始︰[App Service 環境簡介][ASEintro]。</span><span class="sxs-lookup"><span data-stu-id="adefd-112">If you want to learn more about the ASE feature, start with the information here: [App Service Environment introduction][ASEintro].</span></span>

<span data-ttu-id="adefd-113">VNet 整合能讓您的 Web 應用程式存取虛擬網路中的資源，但不授與從虛擬網路存取 Web 應用程式的專用權限。</span><span class="sxs-lookup"><span data-stu-id="adefd-113">VNet Integration gives your web app access to resources in your virtual network but does not grant private access to your web app from the virtual network.</span></span> <span data-ttu-id="adefd-114">私人網站存取是指讓您的應用程式只能透過私人網路 (例如從 Azure 虛擬網路中) 存取。</span><span class="sxs-lookup"><span data-stu-id="adefd-114">Private site access refers to making your app only accessible from a private network such as from within an Azure virtual network.</span></span> <span data-ttu-id="adefd-115">只有使用透過內部負載平衡器 (ILB) 設定的 ASE 才可使用私人網站存取。</span><span class="sxs-lookup"><span data-stu-id="adefd-115">Private site access is only available with an ASE configured with an Internal Load Balancer (ILB).</span></span> <span data-ttu-id="adefd-116">如需使用 ILB ASE 的詳細資訊，請從以下的文章開始︰[建立和使用 ILB ASE][ILBASE]。</span><span class="sxs-lookup"><span data-stu-id="adefd-116">For details on using an ILB ASE, start with the article here: [Creating and using an ILB ASE][ILBASE].</span></span> 

<span data-ttu-id="adefd-117">您會用到的 VNet 整合常見案例，就是讓 Web 應用程式能夠存取資料庫，或存取在 Azure 虛擬網路之虛擬機器上執行的 Web 服務。</span><span class="sxs-lookup"><span data-stu-id="adefd-117">A common scenario where you would use VNet Integration is enabling access from your web app to a database or a web service running on a virtual machine in your Azure virtual network.</span></span> <span data-ttu-id="adefd-118">使用 VNet 整合時，您不需要公開 VM 上應用程式的公用端點，但可以改用專用的非網際網路可路由位址。</span><span class="sxs-lookup"><span data-stu-id="adefd-118">With VNet Integration, you don't need to expose a public endpoint for applications on your VM but can use the private non-internet routable addresses instead.</span></span> 

<span data-ttu-id="adefd-119">VNet 整合功能：</span><span class="sxs-lookup"><span data-stu-id="adefd-119">The VNet Integration feature:</span></span>

* <span data-ttu-id="adefd-120">需要「標準」、「進階」或「隔離」價格方案</span><span class="sxs-lookup"><span data-stu-id="adefd-120">requires a Standard, Premium, or Isolated pricing plan</span></span> 
* <span data-ttu-id="adefd-121">使用傳統 VNet 或 Resource Manager VNet 使用傳統或 Resource Manager VNet</span><span class="sxs-lookup"><span data-stu-id="adefd-121">works with Classic or Resource Manager VNet</span></span> 
* <span data-ttu-id="adefd-122">支援 TCP 和 UDP</span><span class="sxs-lookup"><span data-stu-id="adefd-122">supports TCP and UDP</span></span>
* <span data-ttu-id="adefd-123">使用 Web、行動及 API 應用程式</span><span class="sxs-lookup"><span data-stu-id="adefd-123">works with Web, Mobile, and API apps</span></span>
* <span data-ttu-id="adefd-124">可讓應用程式一次只連接到 1 個 VNet</span><span class="sxs-lookup"><span data-stu-id="adefd-124">enables an app to connect to only 1 VNet at a time</span></span>
* <span data-ttu-id="adefd-125">可在 App Service 方案中與最多五個 VNet 整合</span><span class="sxs-lookup"><span data-stu-id="adefd-125">enables up to five VNets to be integrated with in an App Service Plan</span></span> 
* <span data-ttu-id="adefd-126">可讓 App Service 方案中的多個應用程式使用相同的 VNet</span><span class="sxs-lookup"><span data-stu-id="adefd-126">allows the same VNet to be used by multiple apps in an App Service Plan</span></span>
* <span data-ttu-id="adefd-127">由於 VNet 閘道上的 SLA，可支援 99.9% SLA</span><span class="sxs-lookup"><span data-stu-id="adefd-127">supports a 99.9% SLA due to the SLA on the VNet Gateway</span></span>

<span data-ttu-id="adefd-128">VNet 整合不支援的事項包括：</span><span class="sxs-lookup"><span data-stu-id="adefd-128">There are some things that VNet Integration does not support including:</span></span>

* <span data-ttu-id="adefd-129">掛接磁碟機</span><span class="sxs-lookup"><span data-stu-id="adefd-129">mounting a drive</span></span>
* <span data-ttu-id="adefd-130">AD 整合</span><span class="sxs-lookup"><span data-stu-id="adefd-130">AD integration</span></span> 
* <span data-ttu-id="adefd-131">NetBios</span><span class="sxs-lookup"><span data-stu-id="adefd-131">NetBios</span></span>
* <span data-ttu-id="adefd-132">私人網站存取</span><span class="sxs-lookup"><span data-stu-id="adefd-132">private site access</span></span>

### <a name="getting-started"></a><span data-ttu-id="adefd-133">開始使用</span><span class="sxs-lookup"><span data-stu-id="adefd-133">Getting started</span></span>
<span data-ttu-id="adefd-134">在將 Web 應用程式連接至虛擬網路之前，請留意以下事項：</span><span class="sxs-lookup"><span data-stu-id="adefd-134">Here are some things to keep in mind before connecting your web app to a virtual network:</span></span>

* <span data-ttu-id="adefd-135">VNet 整合僅會使用**標準**、**進階**或**隔離**價格方案中的應用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-135">VNet Integration only works with apps in a **Standard**, **Premium**, or **Isolated** pricing plan.</span></span> <span data-ttu-id="adefd-136">如果您啟用此功能，然後將您的 App Service 方案調整為不支援的價格方案，則您的應用程式會失去與其正在使用之 VNet 的連接。</span><span class="sxs-lookup"><span data-stu-id="adefd-136">If you enable the feature, and then scale your App Service Plan to an unsupported pricing plan your apps lose their connections to the VNets they are using.</span></span> 
* <span data-ttu-id="adefd-137">如果目標虛擬網路已存在，您必須先以動態路由閘道器啟用其點對站 VPN，才能使該虛擬網路與應用程式連接。</span><span class="sxs-lookup"><span data-stu-id="adefd-137">If your target virtual network already exists, it must have point-to-site VPN enabled with a Dynamic routing gateway before it can be connected to an app.</span></span> <span data-ttu-id="adefd-138">如果您以靜態路由設定閘道，便無法啟用點對站的虛擬私人網路 (VPN)。</span><span class="sxs-lookup"><span data-stu-id="adefd-138">If your gateway is configured with Static routing, you cannot enable point-to-site Virtual Private Network (VPN).</span></span>
* <span data-ttu-id="adefd-139">VNet 與您的 App Service 方案 (ASP) 必須位於同一個訂用帳戶中。</span><span class="sxs-lookup"><span data-stu-id="adefd-139">The VNet must be in the same subscription as your App Service Plan(ASP).</span></span> 
* <span data-ttu-id="adefd-140">與 VNet 整合的應用程式將使用指定給該 VNet 的 DNS。</span><span class="sxs-lookup"><span data-stu-id="adefd-140">The apps that integrate with a VNet use the DNS that is specified for that VNet.</span></span>
* <span data-ttu-id="adefd-141">依預設，應用程式整合只會根據 VNet 中定義的路由，將流量路由傳送至 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-141">By default your integrating apps only route traffic into your VNet based on the routes that are defined in your VNet.</span></span> 

## <a name="enabling-vnet-integration"></a><span data-ttu-id="adefd-142">啟用 VNet 整合</span><span class="sxs-lookup"><span data-stu-id="adefd-142">Enabling VNet Integration</span></span>
<span data-ttu-id="adefd-143">本文件主要著重於使用 Azure 入口網站進行 VNet 整合。</span><span class="sxs-lookup"><span data-stu-id="adefd-143">This document is focused primarily on using the Azure portal for VNet Integration.</span></span> <span data-ttu-id="adefd-144">若要使用 PowerShell 啟用與您應用程式的 VNet 整合，請遵循這裡的指示︰[使用 PowerShell 將應用程式連接到虛擬網路][IntPowershell]。</span><span class="sxs-lookup"><span data-stu-id="adefd-144">To enable VNet Integration with your app using PowerShell, follow the directions here: [Connect your app to your virtual network by using PowerShell][IntPowershell].</span></span>

<span data-ttu-id="adefd-145">您可以選擇將應用程式連接到新的或現有的虛擬網路。</span><span class="sxs-lookup"><span data-stu-id="adefd-145">You have the option to connect your app to a new or existing virtual network.</span></span> <span data-ttu-id="adefd-146">如果您在整合時建立新網路，則除了建立 VNet 外，還會為您預先設定動態路由閘道，並將啟用點對站 VPN。</span><span class="sxs-lookup"><span data-stu-id="adefd-146">If you create a new network as a part of your integration, then in addition to just creating the VNet, a dynamic routing gateway is pre-configured for you and Point to Site VPN is enabled.</span></span> 

> [!NOTE]
> <span data-ttu-id="adefd-147">設定新的虛擬網路整合可能需要幾分鐘的時間才能完成。</span><span class="sxs-lookup"><span data-stu-id="adefd-147">Configuring a new virtual network integration can take several minutes.</span></span> 
> 
> 

<span data-ttu-id="adefd-148">若要啟用 VNet 整合，請開啟您的應用程式 [設定]，然後選取 [網路功能]。</span><span class="sxs-lookup"><span data-stu-id="adefd-148">To enable VNet Integration, open your app Settings and then select Networking.</span></span> <span data-ttu-id="adefd-149">開啟的 UI 提供三個網路功能選項。</span><span class="sxs-lookup"><span data-stu-id="adefd-149">The UI that opens up offers three networking choices.</span></span> <span data-ttu-id="adefd-150">本指南只探討 VNet 整合，但本文件稍後會討論混合式連接和 App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="adefd-150">This guide is only going into VNet Integration though Hybrid Connections and App Service Environments are discussed later in this document.</span></span> 

<span data-ttu-id="adefd-151">如果您的應用程式不在正確的價格方案中，UI 可讓您將方案調整為您選擇的更高價格方案。</span><span class="sxs-lookup"><span data-stu-id="adefd-151">If your app is not in the correct pricing plan, the UI enables you to scale your plan to a higher pricing plan of your choice.</span></span>

![][1]

### <a name="enabling-vnet-integration-with-a-pre-existing-vnet"></a><span data-ttu-id="adefd-152">啟用與既存的 VNet 的 VNet 整合</span><span class="sxs-lookup"><span data-stu-id="adefd-152">Enabling VNet Integration with a pre-existing VNet</span></span>
<span data-ttu-id="adefd-153">VNet 整合 UI 可讓您從 VNet 的清單中選取。</span><span class="sxs-lookup"><span data-stu-id="adefd-153">The VNet Integration UI allows you to select from a list of your VNets.</span></span> <span data-ttu-id="adefd-154">傳統 VNet 會在 VNet 名稱旁邊的括號中以「傳統」文字指出它們屬於這一類。</span><span class="sxs-lookup"><span data-stu-id="adefd-154">The Classic VNets indicate that they are such with the word "Classic" in parentheses next to the VNet name.</span></span> <span data-ttu-id="adefd-155">清單會以先列出 Resource Manager VNet 的方式排序。</span><span class="sxs-lookup"><span data-stu-id="adefd-155">The list is sorted such that the Resource Manager VNets are listed first.</span></span> <span data-ttu-id="adefd-156">在下面顯示的影像中，您可以看到只有一個 VNet 可選取。</span><span class="sxs-lookup"><span data-stu-id="adefd-156">In the image shown below you can see that only one VNet can be selected.</span></span> <span data-ttu-id="adefd-157">有多個原因導致 VNet 呈現灰色，包括：</span><span class="sxs-lookup"><span data-stu-id="adefd-157">There are multiple reasons that a VNet can be grayed out including:</span></span>

* <span data-ttu-id="adefd-158">VNet 是您的帳戶有權存取的另一個訂用帳戶</span><span class="sxs-lookup"><span data-stu-id="adefd-158">the VNet is in another subscription that your account has access to</span></span>
* <span data-ttu-id="adefd-159">VNet 未啟用點對站功能</span><span class="sxs-lookup"><span data-stu-id="adefd-159">the VNet does not have Point to Site enabled</span></span>
* <span data-ttu-id="adefd-160">VNet 沒有動態路由閘道</span><span class="sxs-lookup"><span data-stu-id="adefd-160">the VNet does not have a dynamic routing gateway</span></span>

![][2]

<span data-ttu-id="adefd-161">若要啟用整合，只需按一下您想要整合的 VNet 即可。</span><span class="sxs-lookup"><span data-stu-id="adefd-161">To enable integration simply click on the VNet you wish to integrate with.</span></span> <span data-ttu-id="adefd-162">選取 VNet 之後，您的應用程式會自動重新啟動，使變更生效。</span><span class="sxs-lookup"><span data-stu-id="adefd-162">After you select the VNet, your app is automatically restarted for the changes to take effect.</span></span> 

##### <a name="enable-point-to-site-in-a-classic-vnet"></a><span data-ttu-id="adefd-163">在傳統 VNet 中啟用點對站</span><span class="sxs-lookup"><span data-stu-id="adefd-163">Enable Point to Site in a Classic VNet</span></span>
<span data-ttu-id="adefd-164">如果您的 VNet 沒有閘道，也沒有點對站，則您必須先設定它。</span><span class="sxs-lookup"><span data-stu-id="adefd-164">If your VNet does not have a gateway nor has Point to Site, then you have to set that up first.</span></span> <span data-ttu-id="adefd-165">若要針對傳統 VNet 執行此動作，請移至 [Azure 入口網站][AzurePortal]，並引出虛擬網路 (傳統) 的清單。</span><span class="sxs-lookup"><span data-stu-id="adefd-165">To do this for a Classic VNet, go to the [Azure portal][AzurePortal] and bring up the list of Virtual Networks(classic).</span></span> <span data-ttu-id="adefd-166">從這裡按一下您想要整合的網路，並按一下稱為 VPN 連線之基本功能下的大型方塊。</span><span class="sxs-lookup"><span data-stu-id="adefd-166">From here, click on the network you want to integrate with and click on the big box under Essentials called VPN Connections.</span></span> <span data-ttu-id="adefd-167">從這裡您可以建立點對站 VPN，甚至讓它建立閘道。</span><span class="sxs-lookup"><span data-stu-id="adefd-167">From here, you can create your point to site VPN and even have it create a gateway.</span></span> <span data-ttu-id="adefd-168">在您使用閘道建立體驗完成點對站之後，大約 30 分鐘即可使用。</span><span class="sxs-lookup"><span data-stu-id="adefd-168">After you go through the point to site with gateway creation experience it is about 30 minutes before it is ready.</span></span> 

![][8]

##### <a name="enabling-point-to-site-in-a-resource-manager-vnet"></a><span data-ttu-id="adefd-169">啟用 Resource Manager VNet 中的點對站</span><span class="sxs-lookup"><span data-stu-id="adefd-169">Enabling Point to Site in a Resource Manager VNet</span></span>
<span data-ttu-id="adefd-170">若要為 Resource Manager VNet 設定閘道和「點對站」，可以如以下文件所述使用 PowerShel：[使用 PowerShell 設定虛擬網路的點對站連線][V2VNETP2S]；或使用「Azure 入口網站」，如以下文件所述：[使用 Azure 入口網站設定 VNet 的點對站連線][V2VNETPortal]。</span><span class="sxs-lookup"><span data-stu-id="adefd-170">To configure a Resource Manager VNet with a gateway and Point to Site, you can use either PowerShell as documented here, [Configure a Point-to-Site connection to a virtual network using PowerShell][V2VNETP2S] or use the Azure portal as documented here, [Configure a Point-to-Site connection to a VNet using the Azure portal][V2VNETPortal].</span></span> <span data-ttu-id="adefd-171">用來執行這項功能的 UI 尚無法使用。</span><span class="sxs-lookup"><span data-stu-id="adefd-171">The UI to perform this capability is not yet available.</span></span> <span data-ttu-id="adefd-172">請注意，您需要針對「點對站」組態建立憑證。</span><span class="sxs-lookup"><span data-stu-id="adefd-172">Note that you need to create certificates for the Point to Site configuration.</span></span> <span data-ttu-id="adefd-173">這會在您將 WebApp 連線至 VNet 時自動設定。</span><span class="sxs-lookup"><span data-stu-id="adefd-173">This is automatically configured when you connect your WebApp to the VNet.</span></span> 

### <a name="creating-a-pre-configured-vnet"></a><span data-ttu-id="adefd-174">建立預先設定的 VNet</span><span class="sxs-lookup"><span data-stu-id="adefd-174">Creating a pre-configured VNet</span></span>
<span data-ttu-id="adefd-175">如果您想要建立新的 VNet，以閘道和點對站進行設定，則 App Service 網路 UI 具有功能可以完成這項操作，但是僅適用於 Resource Manager VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-175">If you want to create a new VNet that is configured with a gateway and Point-to-Site, then the App Service networking UI has the capability to do that but only for a Resource Manager VNet.</span></span> <span data-ttu-id="adefd-176">如果您想要以閘道和點對站建立 Classic VNet，您需要透過網路使用者介面手動執行。</span><span class="sxs-lookup"><span data-stu-id="adefd-176">If you wish to create a Classic VNet with a gateway and Point-to-Site, then you need to do this manually through the Networking user interface.</span></span> 

<span data-ttu-id="adefd-177">若要透過 VNet 整合 UI 建立 Resource Manager VNet，只需選取 [建立新的虛擬網路]，然後提供：</span><span class="sxs-lookup"><span data-stu-id="adefd-177">To create a Resource Manager VNet through the VNet Integration UI, simply select **Create New Virtual Network** and provide the:</span></span>

* <span data-ttu-id="adefd-178">虛擬網路名稱</span><span class="sxs-lookup"><span data-stu-id="adefd-178">Virtual Network Name</span></span>
* <span data-ttu-id="adefd-179">虛擬網路位址區塊</span><span class="sxs-lookup"><span data-stu-id="adefd-179">Virtual Network Address Block</span></span>
* <span data-ttu-id="adefd-180">子網路名稱</span><span class="sxs-lookup"><span data-stu-id="adefd-180">Subnet Name</span></span>
* <span data-ttu-id="adefd-181">子網路位址區塊</span><span class="sxs-lookup"><span data-stu-id="adefd-181">Subnet Address Block</span></span>
* <span data-ttu-id="adefd-182">閘道器位址區塊</span><span class="sxs-lookup"><span data-stu-id="adefd-182">Gateway Address Block</span></span>
* <span data-ttu-id="adefd-183">點對站位址區塊</span><span class="sxs-lookup"><span data-stu-id="adefd-183">Point-to-Site Address Block</span></span>

<span data-ttu-id="adefd-184">如果您想要此 VNet 連接到任何其他網路，您應該避免挑選與這些網路重疊的 IP 位址空間。</span><span class="sxs-lookup"><span data-stu-id="adefd-184">If you want this VNet to connect to any other networks, then you should avoid picking IP address space that overlaps with those networks.</span></span> 

> [!NOTE]
> <span data-ttu-id="adefd-185">使用閘道建立 Resource Manager VNet 大約需要 30 分鐘，目前無法整合 VNet 與您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-185">Resource Manager VNet creation with a gateway takes about 30 minutes and currently does not integrate the VNet with your app.</span></span> <span data-ttu-id="adefd-186">使用閘道建立 VNet 之後，您必須回到您的應用程式 VNet 整合 UI，並選取新的 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-186">After your VNet is created with the gateway you need to come back to your app VNet Integration UI and select your new VNet.</span></span>
> 
> 

![][3]

<span data-ttu-id="adefd-187">通常，Azure VNet 是在私人網路位址內建立。</span><span class="sxs-lookup"><span data-stu-id="adefd-187">Azure VNets normally are created within private network addresses.</span></span> <span data-ttu-id="adefd-188">根據預設，VNet 整合功能會將任何以這些 IP 位址範圍為目標的流量路由傳送至您的 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-188">By default the VNet Integration feature routes any traffic destined for those IP address ranges into your VNet.</span></span> <span data-ttu-id="adefd-189">私人 IP 位址範圍如下：</span><span class="sxs-lookup"><span data-stu-id="adefd-189">The private IP address ranges are:</span></span>

* <span data-ttu-id="adefd-190">10.0.0.0/8 - 如同 10.0.0.0 - 10.255.255.255</span><span class="sxs-lookup"><span data-stu-id="adefd-190">10.0.0.0/8 - this is the same as 10.0.0.0 - 10.255.255.255</span></span>
* <span data-ttu-id="adefd-191">172.16.0.0/12 - 如同 172.16.0.0 - 172.31.255.255</span><span class="sxs-lookup"><span data-stu-id="adefd-191">172.16.0.0/12 - this is the same as 172.16.0.0 - 172.31.255.255</span></span> 
* <span data-ttu-id="adefd-192">192.168.0.0/16 - 如同 192.168.0.0 - 192.168.255.255</span><span class="sxs-lookup"><span data-stu-id="adefd-192">192.168.0.0/16 - this is the same as 192.168.0.0 - 192.168.255.255</span></span>

<span data-ttu-id="adefd-193">VNet 位址空間需要以 CIDR 標記法指定。</span><span class="sxs-lookup"><span data-stu-id="adefd-193">The VNet address space needs to be specified in CIDR notation.</span></span> <span data-ttu-id="adefd-194">如果您不熟悉 CIDR 標記法，它是使用 IP 位址和代表網路遮罩之整數來指定位址區塊的方法。</span><span class="sxs-lookup"><span data-stu-id="adefd-194">If you are unfamiliar with CIDR notation, it is a method for specifying address blocks using an IP address and an integer that represents the network mask.</span></span> <span data-ttu-id="adefd-195">做為快速參考，請考慮 10.1.0.0/24 將是 256 個位址，而 10.1.0.0/25 將是 128 個位址。</span><span class="sxs-lookup"><span data-stu-id="adefd-195">As a quick reference, consider that 10.1.0.0/24 would be 256 addresses and 10.1.0.0/25 would be 128 addresses.</span></span> <span data-ttu-id="adefd-196">搭配 /32 的 IPv4 位址將只是 1 個地址。</span><span class="sxs-lookup"><span data-stu-id="adefd-196">An IPv4 address with a /32 would be just 1 address.</span></span> 

<span data-ttu-id="adefd-197">如果您在這裡設定 DNS 伺服器資訊，則該資訊是針對您的 VNet 而設定的。</span><span class="sxs-lookup"><span data-stu-id="adefd-197">If you set the DNS server information here, then that is set for your VNet.</span></span> <span data-ttu-id="adefd-198">在建立 VNet 之後，您可以根據 VNet 使用者體驗編輯此資訊。</span><span class="sxs-lookup"><span data-stu-id="adefd-198">After VNet creation you can edit this information from the VNet user experiences.</span></span> <span data-ttu-id="adefd-199">如果您變更 VNet 的 DNS，則需要執行「同步網路」作業。</span><span class="sxs-lookup"><span data-stu-id="adefd-199">If you change the DNS of the VNet, then you need to perform a Sync Network operation.</span></span>

<span data-ttu-id="adefd-200">當您使用 VNet 整合 UI 建立 Classic VNet 時，它會在與您的應用程式相同的資源群組中建立 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-200">When you create a Classic VNet using the VNet Integration UI, it creates a VNet in the same resource group as your app.</span></span> 

## <a name="how-the-system-works"></a><span data-ttu-id="adefd-201">系統的運作方式</span><span class="sxs-lookup"><span data-stu-id="adefd-201">How the system works</span></span>
<span data-ttu-id="adefd-202">此功能實際上組建在點對站 VPN 技術之上，以將您的應用程式連接到您的 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-202">Under the covers this feature builds on top of Point-to-Site VPN technology to connect your app to your VNet.</span></span> <span data-ttu-id="adefd-203">Azure App Service 中的應用程式具備多租用戶的系統架構，其會防止在 VNet 中直接佈建應用程式，就像使用虛擬機器所做的一樣。</span><span class="sxs-lookup"><span data-stu-id="adefd-203">Apps in Azure App Service have a multi-tenant system architecture, which precludes provisioning an app directly in a VNet as is done with virtual machines.</span></span> <span data-ttu-id="adefd-204">藉由以點對站技術為基礎來進行建置，我們得以將網路存取限制為僅限裝載應用程式的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="adefd-204">By building on point-to-site technology we limit network access to just the virtual machine hosting the app.</span></span> <span data-ttu-id="adefd-205">在這些應用程式主機上，我們更進一步限制網路的存取權限，因此應用程式只能存取您設定為供其存取的網路。</span><span class="sxs-lookup"><span data-stu-id="adefd-205">Access to the network is further restricted on those app hosts so that your apps can only access the networks that you configure them to access.</span></span> 

![][4]

<span data-ttu-id="adefd-206">如果您尚未設定虛擬網路的 DNS 伺服器，您的應用程式需要使用 IP 位址才能觸及 VNet 中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-206">If you haven’t configured a DNS server with your virtual network, your app will need to use IP addresses to reach resource in the VNet.</span></span> <span data-ttu-id="adefd-207">在使用 IP 位址時，請記住此功能的主要優點在於它可讓您在私人網路內使用私人位址。</span><span class="sxs-lookup"><span data-stu-id="adefd-207">While using IP addresses, remember that the major benefit of this feature is that it enables you to use the private addresses within your private network.</span></span> <span data-ttu-id="adefd-208">如果將應用程式設為使用其中一個 VM 的公用 IP 位址，則您不是使用 VNet 整合功能，而是透過網際網路進行通訊。</span><span class="sxs-lookup"><span data-stu-id="adefd-208">If you set your app up to use public IP addresses for one of your VMs, then you aren't using the VNet Integration feature and are communicating over the internet.</span></span>

## <a name="managing-the-vnet-integrations"></a><span data-ttu-id="adefd-209">管理 VNet 整合功能</span><span class="sxs-lookup"><span data-stu-id="adefd-209">Managing the VNet Integrations</span></span>
<span data-ttu-id="adefd-210">要在應用程式層級上，才能連接或中斷連接 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-210">The ability to connect and disconnect to a VNet is at an app level.</span></span> <span data-ttu-id="adefd-211">可在多個應用程式之間影響 VNet 整合的作業是在 ASP 層級上。</span><span class="sxs-lookup"><span data-stu-id="adefd-211">Operations that can affect the VNet Integration across multiple apps are at an ASP level.</span></span> <span data-ttu-id="adefd-212">從顯示在應用程式層級的 UI 中，您可以取得 VNet 的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="adefd-212">From the UI that is shown at the app level, you can get details on your VNet.</span></span> <span data-ttu-id="adefd-213">大部分相同的資訊也會顯示在 ASP 層級。</span><span class="sxs-lookup"><span data-stu-id="adefd-213">Most of the same information is also shown at the ASP level.</span></span> 

![][5]

<span data-ttu-id="adefd-214">從 [網路功能狀態] 頁面中，您可以看到應用程式是否已連接到 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-214">From the Network Feature Status page, you can see if your app is connected to your VNet.</span></span> <span data-ttu-id="adefd-215">無論您的 VNet 閘道基於何種原因關閉，此狀態將顯示為未連接。</span><span class="sxs-lookup"><span data-stu-id="adefd-215">If your VNet gateway is down for whatever reason, then this would show as not-connected.</span></span> 

<span data-ttu-id="adefd-216">現在可供您在應用程式層級 VNet 整合 UI 中使用的資訊，與您從 ASP 取得的詳細資訊相同。</span><span class="sxs-lookup"><span data-stu-id="adefd-216">The information you now have available to you in the app level VNet Integration UI is the same as the detail information you get from the ASP.</span></span> <span data-ttu-id="adefd-217">這些項目如下：</span><span class="sxs-lookup"><span data-stu-id="adefd-217">Here are those items:</span></span>

* <span data-ttu-id="adefd-218">VNet 名稱 - 此連結會開啟 Azure 虛擬網路 UI</span><span class="sxs-lookup"><span data-stu-id="adefd-218">VNet Name - This link opens the Azure virtual network UI</span></span>
* <span data-ttu-id="adefd-219">位置 - 這會反映 VNet 的位置。</span><span class="sxs-lookup"><span data-stu-id="adefd-219">Location - This reflects the location of your VNet.</span></span> <span data-ttu-id="adefd-220">可能與另一個位置中的 VNet 整合。</span><span class="sxs-lookup"><span data-stu-id="adefd-220">It is possible to integrate with a VNet in another location.</span></span>
* <span data-ttu-id="adefd-221">憑證狀態 - 有若干憑證，用來保護應用程式與 VNet 之間的 VPN 連線。</span><span class="sxs-lookup"><span data-stu-id="adefd-221">Certificate Status - There are certificates used to secure the VPN connection between the app and the VNet.</span></span> <span data-ttu-id="adefd-222">這會反映測試，以確保它們保持同步。</span><span class="sxs-lookup"><span data-stu-id="adefd-222">This reflects a test to ensure they are in sync.</span></span>
* <span data-ttu-id="adefd-223">閘道狀態 - 無論您的閘道基於何種原因關閉，您的應用程式將無法存取 VNet 中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-223">Gateway Status - Should your gateways be down for whatever reason then your app cannot access resources in the VNet.</span></span> 
* <span data-ttu-id="adefd-224">VNet 位址空間 - 這是 VNet 的 IP 位址空間。</span><span class="sxs-lookup"><span data-stu-id="adefd-224">VNet address space - This is the IP address space for your VNet.</span></span> 
* <span data-ttu-id="adefd-225">點對站位址空間 - 這是 VNet 的點對站 IP 位址空間。</span><span class="sxs-lookup"><span data-stu-id="adefd-225">Point to Site address space - This is the point to site IP address space for your VNet.</span></span> <span data-ttu-id="adefd-226">您的應用程式會顯示來自此位址空間的其中一個 IP 的通訊。</span><span class="sxs-lookup"><span data-stu-id="adefd-226">Your app shows communication as coming from one of the IPs in this address space.</span></span> 
* <span data-ttu-id="adefd-227">站對站位址空間：您可以使用站對站 VPN，將 VNet 連線到內部部署資源或連線到其他 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-227">Site to site address space - You can use Site to Site VPNs to connect your VNet to your on-premises resources or to other VNet.</span></span> <span data-ttu-id="adefd-228">如果您已如此設定，則以該 VPN 連線定義的 IP 範圍會顯示在這裡。</span><span class="sxs-lookup"><span data-stu-id="adefd-228">Should you have that configured then the IP ranges defined with that VPN connection shows here.</span></span>
* <span data-ttu-id="adefd-229">DNS 伺服器 - 如果您已設定 DNS 伺服器與 VNet 搭配，則它們會列示在這裡。</span><span class="sxs-lookup"><span data-stu-id="adefd-229">DNS Servers - If you have DNS Servers configured with your VNet, then they are listed here.</span></span>
* <span data-ttu-id="adefd-230">路由傳送至 VNet 的 IP - 有一個 IP 位址清單，您的 VNet 已定義將路由傳送至這些 IP 位址，這些位址會顯示在這裡。</span><span class="sxs-lookup"><span data-stu-id="adefd-230">IPs routed to the VNet - There are a list of IP addresses that your VNet has routing defined for, and those addresses show here.</span></span> 

<span data-ttu-id="adefd-231">您可以在 VNet 整合的應用程式檢視中採取的唯一作業，就是中斷連接目前連接到 VNet 的應用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-231">The only operation you can take in the app view of your VNet Integration is to disconnect your app from the VNet it is currently connected to.</span></span> <span data-ttu-id="adefd-232">若要這樣做，只需按一下頂端的 [中斷連接] 即可。</span><span class="sxs-lookup"><span data-stu-id="adefd-232">To do this simply click Disconnect at the top.</span></span> <span data-ttu-id="adefd-233">這個動作不會變更您的 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-233">This action does not change your VNet.</span></span> <span data-ttu-id="adefd-234">VNet 及其組態 (包括閘道) 仍會保持原狀。</span><span class="sxs-lookup"><span data-stu-id="adefd-234">The VNet and its configuration including the gateways remains unchanged.</span></span> <span data-ttu-id="adefd-235">如果接著您要刪除 VNet，則需要先刪除其中資源，包括閘道。</span><span class="sxs-lookup"><span data-stu-id="adefd-235">If you then want to delete your VNet, you need to first delete the resources in it including the gateways.</span></span> 

<span data-ttu-id="adefd-236">[App Service 方案] 檢視具有一些其他作業。</span><span class="sxs-lookup"><span data-stu-id="adefd-236">The App Service Plan view has a number of additional operations.</span></span> <span data-ttu-id="adefd-237">也可用不同的方式從應用程式中存取它。</span><span class="sxs-lookup"><span data-stu-id="adefd-237">It is also accessed differently than from the app.</span></span> <span data-ttu-id="adefd-238">若要觸達 ASP 網路功能 UI，只需開啟您的 ASP UI，並向下捲動即可。</span><span class="sxs-lookup"><span data-stu-id="adefd-238">To reach the ASP Networking UI simply open your ASP UI and scroll down.</span></span> <span data-ttu-id="adefd-239">有一個稱為網路功能狀態的 UI 元素。</span><span class="sxs-lookup"><span data-stu-id="adefd-239">There is a UI element called Network Feature Status.</span></span> <span data-ttu-id="adefd-240">它會提供一些有關 VNet 整合的次要詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="adefd-240">It gives some minor details around your VNet Integration.</span></span> <span data-ttu-id="adefd-241">按一下此 UI，即會開啟網路功能狀態 UI。</span><span class="sxs-lookup"><span data-stu-id="adefd-241">Clicking on this UI opens the Network Feature Status UI.</span></span> <span data-ttu-id="adefd-242">如果接著按一下 [按一下這裡以管理]，會開啟 UI，列出此 ASP 中的 VNet 整合。</span><span class="sxs-lookup"><span data-stu-id="adefd-242">If you then click on "Click here to manage", the UI that lists the VNet Integrations in this ASP opens.</span></span>

![][6]

<span data-ttu-id="adefd-243">當查看您要整合之 VNet 的位置時，ASP 的位置很好記。</span><span class="sxs-lookup"><span data-stu-id="adefd-243">The location of the ASP is good to remember when looking at the locations of the VNets you are integrating with.</span></span> <span data-ttu-id="adefd-244">當 VNet 在另一個位置時，您更有可能發現延遲問題。</span><span class="sxs-lookup"><span data-stu-id="adefd-244">When the VNet is in another location you are far more likely to see latency issues.</span></span> 

<span data-ttu-id="adefd-245">整合的 VNet 提醒您，您的應用程式已在此 ASP 與多少個 VNet 整合，以及您可以具有多少個。</span><span class="sxs-lookup"><span data-stu-id="adefd-245">The VNets integrated with is a reminder on how many VNets your apps are integrated with in this ASP and how many you can have.</span></span> 

<span data-ttu-id="adefd-246">若要查看每個 VNet 新增的詳細資料，只需按一下您感興趣的 VNet 即可。</span><span class="sxs-lookup"><span data-stu-id="adefd-246">To see added details on each VNet, just click on the VNet you are interested in.</span></span> <span data-ttu-id="adefd-247">除了先前提到的詳細資料外，您還會在此 ASP 中看到正在使用該 VNet 之應用程式的清單。</span><span class="sxs-lookup"><span data-stu-id="adefd-247">In addition to the details that were noted earlier, you can also see a list of the apps in this ASP that are using that VNet.</span></span> 

<span data-ttu-id="adefd-248">關於動作，有兩個主要動作。</span><span class="sxs-lookup"><span data-stu-id="adefd-248">With respect to actions there are two primary actions.</span></span> <span data-ttu-id="adefd-249">第一個動作能夠新增路由，驅使流量離開您的應用程式進入 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-249">The first is the ability to add routes that drive traffic leaving your app into your VNet.</span></span> <span data-ttu-id="adefd-250">第二個動作能夠同步處理憑證和網路資訊。</span><span class="sxs-lookup"><span data-stu-id="adefd-250">The second action is the ability to sync certificates and network information.</span></span>

![][7]

<span data-ttu-id="adefd-251">**路由** 如先前所述，VNet 中所定義的路由用於將應用程式中的流量導向至 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-251">**Routing** As noted earlier the routes that are defined in your VNet are what is used for directing traffic into your VNet from your app.</span></span> <span data-ttu-id="adefd-252">還有一些用途，就是客戶想要將額外的輸出流量從應用程式傳送到 VNet，但已對他們提供此功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-252">There are some uses though where customers want to send additional outbound traffic from an app into the VNet and for them this capability is provided.</span></span> <span data-ttu-id="adefd-253">傳送後流量發生什麼情況取決於客戶如何設定其 VNet。</span><span class="sxs-lookup"><span data-stu-id="adefd-253">What happens to the traffic after that is up to how the customer configures their VNet.</span></span> 

<span data-ttu-id="adefd-254">**憑證** 憑證狀態反映 App Service 執行的檢查，此檢查用來驗證用於 VPN 連線的憑證是否依然完好。</span><span class="sxs-lookup"><span data-stu-id="adefd-254">**Certificates** The Certificate Status reflects a check being performed by the App Service to validate that the certificates that we are using for the VPN connection are still good.</span></span> <span data-ttu-id="adefd-255">啟用 VNet 整合時，如果這是此 ASP 中的任何應用程式與該 VNet 的第一個整合，則需要交換憑證以確保連線的安全性。</span><span class="sxs-lookup"><span data-stu-id="adefd-255">When VNet Integration enabled, then if this is the first integration to that VNet from any apps in this ASP, there is a required exchange of certificates to ensure the security of the connection.</span></span> <span data-ttu-id="adefd-256">除了憑證以外，我們還得到 DNS 組態、路由，以及其他描述網路的類似項目。</span><span class="sxs-lookup"><span data-stu-id="adefd-256">Along with the certificates we get the DNS configuration, routes and other similar things that describe the network.</span></span>
<span data-ttu-id="adefd-257">如果這些憑證或網路資訊已變更，您需要按一下 [同步處理網路]。</span><span class="sxs-lookup"><span data-stu-id="adefd-257">If those certificates or network information is changed, then you need to click "Sync Network".</span></span> <span data-ttu-id="adefd-258">**注意**：按一下 [同步網路] 時，會導致應用程式與 VNet 之間的連線短暫中斷。</span><span class="sxs-lookup"><span data-stu-id="adefd-258">**NOTE**: When you click "Sync Network" then you cause a brief outage in connectivity between your app and your VNet.</span></span> <span data-ttu-id="adefd-259">如果應用程式未重新啟動，失去連線會導致您的網站無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="adefd-259">While your app is not restarted, the loss of connectivity could cause your site to not function properly.</span></span> 

## <a name="accessing-on-premises-resources"></a><span data-ttu-id="adefd-260">存取內部部署資源</span><span class="sxs-lookup"><span data-stu-id="adefd-260">Accessing on-premises resources</span></span>
<span data-ttu-id="adefd-261">VNet 整合功能的優點之一是，如果 VNet 以站對站 VPN 連線到內部部署網路，應用程式就可以從應用程式中存取內部部署資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-261">One of the benefits of the VNet Integration feature is that if your VNet is connected to your on-premises network with a Site to Site VPN then your apps can have access to your on-premises resources from your app.</span></span> <span data-ttu-id="adefd-262">但若要以此方式運作，您可能需要以點對站 IP 範圍的路由來更新內部部署 VPN 閘道。</span><span class="sxs-lookup"><span data-stu-id="adefd-262">For this to work though you may need to update your on-premises VPN gateway with the routes for your Point to Site IP range.</span></span> <span data-ttu-id="adefd-263">第一次設定站對站 VPN 時，用來設定它的指令碼應該設定路由，包括點對站 VPN。</span><span class="sxs-lookup"><span data-stu-id="adefd-263">When the Site to Site VPN is first set up then the scripts used to configure it should set up routes including your Point to Site VPN.</span></span> <span data-ttu-id="adefd-264">如果在建立站對站 VPN 之後新增點對站 VPN，您需要手動更新路由。</span><span class="sxs-lookup"><span data-stu-id="adefd-264">If you add the Point to Site VPN after you create your Site to Site VPN, then you need to update the routes manually.</span></span> <span data-ttu-id="adefd-265">此做法的詳細資料會根據閘道而有所不同，不在這裡詳述。</span><span class="sxs-lookup"><span data-stu-id="adefd-265">Details on how to do that vary per gateway and are not described here.</span></span> 

> [!NOTE]
> <span data-ttu-id="adefd-266">VNet 整合功能不會將應用程式與具有 ExpressRoute 閘道的 VNet 整合。</span><span class="sxs-lookup"><span data-stu-id="adefd-266">The VNet Integration feature does not integrate an app with a VNet that has an ExpressRoute Gateway.</span></span> <span data-ttu-id="adefd-267">即使是在[共存模式][VPNERCoex]中設定 ExpressRoute 閘道，VNet 整合仍無法運作。</span><span class="sxs-lookup"><span data-stu-id="adefd-267">Even if the ExpressRoute Gateway is configured in [coexistence mode][VPNERCoex] the VNet Integration does not work.</span></span> <span data-ttu-id="adefd-268">如果您需要透過 ExpressRoute 連線存取資源，則可使用在您 VNet 中執行的 [App Service 環境][ASE]。</span><span class="sxs-lookup"><span data-stu-id="adefd-268">If you need to access resources through an ExpressRoute connection, then you can use an [App Service Environment][ASE], which runs in your VNet.</span></span>
> 
> 

## <a name="pricing-details"></a><span data-ttu-id="adefd-269">價格詳細資料</span><span class="sxs-lookup"><span data-stu-id="adefd-269">Pricing details</span></span>
<span data-ttu-id="adefd-270">有幾個您在使用 VNet 整合功能時應該注意的價格細微差別。</span><span class="sxs-lookup"><span data-stu-id="adefd-270">There are a few pricing nuances that you should be aware of when using the VNet Integration feature.</span></span> <span data-ttu-id="adefd-271">有 3 個與使用此功能相關的費用：</span><span class="sxs-lookup"><span data-stu-id="adefd-271">There are 3 related charges to the use of this feature:</span></span>

* <span data-ttu-id="adefd-272">ASP 定價層需求</span><span class="sxs-lookup"><span data-stu-id="adefd-272">ASP pricing tier requirements</span></span>
* <span data-ttu-id="adefd-273">資料傳輸成本</span><span class="sxs-lookup"><span data-stu-id="adefd-273">Data transfer costs</span></span>
* <span data-ttu-id="adefd-274">VPN 閘道器成本</span><span class="sxs-lookup"><span data-stu-id="adefd-274">VPN Gateway costs.</span></span>

<span data-ttu-id="adefd-275">您的應用程式若要能夠使用此功能，它們必須位於標準或進階 App Service 方案中。</span><span class="sxs-lookup"><span data-stu-id="adefd-275">For your apps to be able to use this feature, they need to be in a Standard or Premium App Service Plan.</span></span> <span data-ttu-id="adefd-276">您可以在這裡看到這些成本的詳細資料：[App Service 價格][ASPricing]。</span><span class="sxs-lookup"><span data-stu-id="adefd-276">You can see more details on those costs here: [App Service Pricing][ASPricing].</span></span> 

<span data-ttu-id="adefd-277">由於處理點對站 VPN 的方式，您必須付費，才能透過 VNet 整合連線輸出資料，即使 VNet 位於相同的資料中心也一樣。</span><span class="sxs-lookup"><span data-stu-id="adefd-277">Due to the way Point to Site VPNs are handled, you always have a charge for outbound data through your VNet Integration connection even if the VNet is in the same data center.</span></span> <span data-ttu-id="adefd-278">若要查看這些花費，請參閱這裡：[資料傳輸定價詳細資料][DataPricing]。</span><span class="sxs-lookup"><span data-stu-id="adefd-278">To see what those charges are, take a look here: [Data Transfer Pricing Details][DataPricing].</span></span> 

<span data-ttu-id="adefd-279">最後一個項目就是 VNet 閘道的成本。</span><span class="sxs-lookup"><span data-stu-id="adefd-279">The last item is the cost of the VNet gateways.</span></span> <span data-ttu-id="adefd-280">如果對其他項目 (例如站對站 VPN) 您不需要閘道，表示您的付費是讓閘道支援 VNet gateway 整合功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-280">If you don't need the gateways for something else such as Site to Site VPNs, then you are paying for gateways to support the VNet Integration feature.</span></span> <span data-ttu-id="adefd-281">這裡有這些成本的詳細資料：[VPN 閘道器價格][VNETPricing]。</span><span class="sxs-lookup"><span data-stu-id="adefd-281">There are details on those costs here: [VPN Gateway Pricing][VNETPricing].</span></span> 

## <a name="troubleshooting"></a><span data-ttu-id="adefd-282">疑難排解</span><span class="sxs-lookup"><span data-stu-id="adefd-282">Troubleshooting</span></span>
<span data-ttu-id="adefd-283">儘管功能易於設定，這不表示您的體驗不會遇到問題。</span><span class="sxs-lookup"><span data-stu-id="adefd-283">While the feature is easy to set up, that doesn't mean that your experience will be problem free.</span></span> <span data-ttu-id="adefd-284">如果您在存取所需端點時遇到問題，有一些公用程式，您可以用來從應用程式主控台測試連線功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-284">Should you encounter problems accessing your desired endpoint there are some utilities you can use to test connectivity from the app console.</span></span> <span data-ttu-id="adefd-285">有兩個您可以使用的主控台體驗。</span><span class="sxs-lookup"><span data-stu-id="adefd-285">There are two console experiences you can use.</span></span> <span data-ttu-id="adefd-286">一個是從 Kudu 主控台，另一個則是您可以在 Azure 入口網站觸達的主控台。</span><span class="sxs-lookup"><span data-stu-id="adefd-286">One is from the Kudu console and the other is the console that you can reach in the Azure portal.</span></span> <span data-ttu-id="adefd-287">若要從您的應用程式前往 Kudu 主控台，請移至 [工具] -> [Kudu]。</span><span class="sxs-lookup"><span data-stu-id="adefd-287">To get to the Kudu console from your app go to Tools -> Kudu.</span></span> <span data-ttu-id="adefd-288">這與移至 [sitename].scm.azurewebsites.net 相同。</span><span class="sxs-lookup"><span data-stu-id="adefd-288">This is the same as going to [sitename].scm.azurewebsites.net.</span></span> <span data-ttu-id="adefd-289">一旦開啟，只需移至 [偵錯主控台] 索引標籤即可。若要前往 Azure 入口網站裝載的主控台，請從您的應用程式移至 [工具] -> [主控台]。</span><span class="sxs-lookup"><span data-stu-id="adefd-289">Once that opens simply go to the Debug console tab. To get to the Azure portal hosted console then from your app go to Tools -> Console.</span></span> 

#### <a name="tools"></a><span data-ttu-id="adefd-290">工具</span><span class="sxs-lookup"><span data-stu-id="adefd-290">Tools</span></span>
<span data-ttu-id="adefd-291">由於安全性限制，工具 ping、nslookup 和 tracert 無法透過主控台運作。</span><span class="sxs-lookup"><span data-stu-id="adefd-291">The tools ping, nslookup and tracert won’t work through the console due to security constraints.</span></span> <span data-ttu-id="adefd-292">為了填滿此空隙，已加入兩個不同的工具。</span><span class="sxs-lookup"><span data-stu-id="adefd-292">To fill the void there have been two separate tools added.</span></span> <span data-ttu-id="adefd-293">為了測試 DNS 功能，已加入名為 nameresolver.exe 的工具。</span><span class="sxs-lookup"><span data-stu-id="adefd-293">In order to test DNS functionality we added a tool named nameresolver.exe.</span></span> <span data-ttu-id="adefd-294">語法為：</span><span class="sxs-lookup"><span data-stu-id="adefd-294">The syntax is:</span></span>

    nameresolver.exe hostname [optional: DNS Server]

<span data-ttu-id="adefd-295">您可以使用 nameresolver 來檢查應用程式依賴的主機名稱。</span><span class="sxs-lookup"><span data-stu-id="adefd-295">You can use nameresolver to check the hostnames that your app depends on.</span></span> <span data-ttu-id="adefd-296">如此一來您可以測試是否有任何項目未正確設定，而無法與 DNS 搭配，或可能對 DNS 伺服器沒有存取權。</span><span class="sxs-lookup"><span data-stu-id="adefd-296">This way you can test if you have anything mis-configured with your DNS or perhaps don't have access to your DNS server.</span></span>

<span data-ttu-id="adefd-297">下一個工具可讓您測試主機是否可與 TCP 連線，以及連接埠組合。</span><span class="sxs-lookup"><span data-stu-id="adefd-297">The next tool allows you to test for TCP connectivity to a host and port combination.</span></span> <span data-ttu-id="adefd-298">此工具稱為 tcpping.exe，語法如下：</span><span class="sxs-lookup"><span data-stu-id="adefd-298">This tool is called tcpping.exe and the syntax is:</span></span>

    tcpping.exe hostname [optional: port]

<span data-ttu-id="adefd-299">tcpping 公用程式會讓您知道是否可觸達特定主機和連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-299">The tcpping utility tells you if you can reach a specific host and port.</span></span> <span data-ttu-id="adefd-300">只有在下列情況才會顯示成功：有一個應用程式監聽主機和連接埠組合，並且有網路從您的應用程式存取到指定的主機和連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-300">It only can show success if: there is an application listening at the host and port combination, and there is network access from your app to the specified host and port.</span></span>

#### <a name="debugging-access-to-vnet-hosted-resources"></a><span data-ttu-id="adefd-301">偵錯 VNet 裝載資源的存取</span><span class="sxs-lookup"><span data-stu-id="adefd-301">Debugging access to VNet hosted resources</span></span>
<span data-ttu-id="adefd-302">有一些事物，可以阻止您的應用程式觸達特定的主機和連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-302">There are a number of things that can prevent your app from reaching a specific host and port.</span></span> <span data-ttu-id="adefd-303">大部分的情況下，會是下列三個情況的其中一種︰</span><span class="sxs-lookup"><span data-stu-id="adefd-303">Most of the time it is one of three things:</span></span>

* <span data-ttu-id="adefd-304">**路線中有防火牆** 如果路線中有防火牆，則將會達到 TCP 逾時。</span><span class="sxs-lookup"><span data-stu-id="adefd-304">**There is a firewall in the way** If you have a firewall in the way, you will hit the TCP timeout.</span></span> <span data-ttu-id="adefd-305">此案例中就是 21 秒。</span><span class="sxs-lookup"><span data-stu-id="adefd-305">That is 21 seconds in this case.</span></span> <span data-ttu-id="adefd-306">使用 tcpping 工具來測試連線能力。</span><span class="sxs-lookup"><span data-stu-id="adefd-306">Use the tcpping tool to test connectivity.</span></span> <span data-ttu-id="adefd-307">TCP 逾時可能是因為許多項目越過防火牆並啟動。</span><span class="sxs-lookup"><span data-stu-id="adefd-307">TCP timeouts can be due to many things beyond firewalls but start there.</span></span> 
* <span data-ttu-id="adefd-308">**DNS 無法存取** DNS 逾時值為三秒 (每部 DNS 伺服器)。</span><span class="sxs-lookup"><span data-stu-id="adefd-308">**DNS is not accessible** The DNS timeout is three seconds per DNS server.</span></span> <span data-ttu-id="adefd-309">如果您有兩部 DNS 伺服器，逾時為 6 秒。</span><span class="sxs-lookup"><span data-stu-id="adefd-309">If you have two DNS servers, the timeout is 6 seconds.</span></span> <span data-ttu-id="adefd-310">使用 nameresolver 來檢查 DNS 是否運作。</span><span class="sxs-lookup"><span data-stu-id="adefd-310">Use nameresolver to see if DNS is working.</span></span> <span data-ttu-id="adefd-311">請記住，您不能使用 nslookup，因為它不會使用您的 VNet 設定使用的 DNS。</span><span class="sxs-lookup"><span data-stu-id="adefd-311">Remember you can't use nslookup as that does not use the DNS your VNet is configured with.</span></span>
* <span data-ttu-id="adefd-312">**無效的 P2S IP 範圍** 點對站 IP 範圍需要在 RFC 1918 私人 IP 範圍中 (10.0.0.0-10.255.255.255 / 172.16.0.0-172.31.255.255 / 192.168.0.0-192.168.255.255)。</span><span class="sxs-lookup"><span data-stu-id="adefd-312">**Invalid P2S IP range** The point to site IP range needs to be in the RFC 1918 private IP ranges (10.0.0.0-10.255.255.255 / 172.16.0.0-172.31.255.255 / 192.168.0.0-192.168.255.255).</span></span> <span data-ttu-id="adefd-313">如果範圍中使用的 IP 不在其中，則無法正常運作。</span><span class="sxs-lookup"><span data-stu-id="adefd-313">If the range uses IPs outside of that, then things won't work.</span></span> 

<span data-ttu-id="adefd-314">如果這些項目沒有回答您的問題，請先確認基本問題，例如︰</span><span class="sxs-lookup"><span data-stu-id="adefd-314">If those items don't answer your problem, look first for the simple things like:</span></span> 

* <span data-ttu-id="adefd-315">閘道是否顯示為正在入口網站中啟動？</span><span class="sxs-lookup"><span data-stu-id="adefd-315">Does the Gateway show as being up in the portal?</span></span>
* <span data-ttu-id="adefd-316">憑證是否顯示為同步中？</span><span class="sxs-lookup"><span data-stu-id="adefd-316">Do certificates show as being in sync?</span></span>
* <span data-ttu-id="adefd-317">是否有任何人未在受影響的 ASP 中執行 [同步處理網路] 的情況下變更網路組態？</span><span class="sxs-lookup"><span data-stu-id="adefd-317">Did anybody change the network configuration without doing a "Sync Network" in the affected ASPs?</span></span> 

<span data-ttu-id="adefd-318">如果您的閘道已關閉，請重新啟動。</span><span class="sxs-lookup"><span data-stu-id="adefd-318">If your gateway is down, then bring it back up.</span></span> <span data-ttu-id="adefd-319">如果您的憑證未同步，請移至 VNet 整合的 ASP 檢視，並點擊 [同步網路]。</span><span class="sxs-lookup"><span data-stu-id="adefd-319">If your certificates are out of sync, then go to the ASP view of your VNet Integration and hit "Sync Network".</span></span> <span data-ttu-id="adefd-320">如果您懷疑已對 VNet 組態做了變更，而它未與 ASP 同步，請移至 VNet 整合的 ASP 檢視，並點擊 [同步網路]。只是提醒您，這會導致 VNet 與應用程式的連線短暫中斷。</span><span class="sxs-lookup"><span data-stu-id="adefd-320">If you suspect that there has been a change made to your VNet configuration and it wasn't sync'd with your ASPs, then go to the ASP view of your VNet Integration and hit "Sync Network" Just as a reminder, this causes a brief outage with your VNet connection and your apps.</span></span> 

<span data-ttu-id="adefd-321">如果一切都沒問題，您需要更深入發掘問題：</span><span class="sxs-lookup"><span data-stu-id="adefd-321">If all of that is fine, then you need to dig in a bit deeper:</span></span>

* <span data-ttu-id="adefd-322">是否有任何其他使用 VNet 整合來觸達相同 VNet 中資源的應用程式？</span><span class="sxs-lookup"><span data-stu-id="adefd-322">Are there any other apps using VNet Integration to reach resources in the same VNet?</span></span> 
* <span data-ttu-id="adefd-323">您是否可以移至應用程式主控台，並使用 tcpping 觸達 VNet 中的任何其他資源？</span><span class="sxs-lookup"><span data-stu-id="adefd-323">Can you go to the app console and use tcpping to reach any other resources in your VNet?</span></span> 

<span data-ttu-id="adefd-324">如果上述任一項成立，表示 VNet 整合沒問題，問題出在其他地方。</span><span class="sxs-lookup"><span data-stu-id="adefd-324">If either of the above are true, then your VNet Integration is fine and the problem is somewhere else.</span></span> <span data-ttu-id="adefd-325">此情況將更有挑戰性，因為沒有簡單的方法，來了解為何無法觸達主機:連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-325">This is where it gets to be more of a challenge because there is no simple way to see why you can't reach a host:port.</span></span> <span data-ttu-id="adefd-326">部分原因包括：</span><span class="sxs-lookup"><span data-stu-id="adefd-326">Some of the causes include:</span></span>

* <span data-ttu-id="adefd-327">您已在主機上啟動防火牆，防止從點對站 IP 範圍存取應用程式連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-327">you have a firewall up on your host preventing access to the application port from your point to site IP range.</span></span> <span data-ttu-id="adefd-328">跨子網路通常需要公用存取權。</span><span class="sxs-lookup"><span data-stu-id="adefd-328">Crossing subnets often requires Public access.</span></span>
* <span data-ttu-id="adefd-329">目標主機已關閉</span><span class="sxs-lookup"><span data-stu-id="adefd-329">your target host is down</span></span>
* <span data-ttu-id="adefd-330">應用程式已關閉</span><span class="sxs-lookup"><span data-stu-id="adefd-330">your application is down</span></span>
* <span data-ttu-id="adefd-331">IP 或主機名稱錯誤</span><span class="sxs-lookup"><span data-stu-id="adefd-331">you had the wrong IP or hostname</span></span>
* <span data-ttu-id="adefd-332">應用程式不是接聽您預期的連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-332">your application is listening on a different port than what you expected.</span></span> <span data-ttu-id="adefd-333">您可以移至該主機，並從命令提示字元使用 "netstat -aon" 來檢查此問題。</span><span class="sxs-lookup"><span data-stu-id="adefd-333">You can check this by going onto that host and using "netstat -aon" from the cmd prompt.</span></span> <span data-ttu-id="adefd-334">這會顯示哪個處理程序識別碼正在接聽哪個連接埠。</span><span class="sxs-lookup"><span data-stu-id="adefd-334">This shows you what process ID is listening on what port.</span></span> 
* <span data-ttu-id="adefd-335">您配置網路安全性群組的方式，讓這些群組防止從點對站 IP 範圍存取應用程式主機和連接埠</span><span class="sxs-lookup"><span data-stu-id="adefd-335">your network security groups are configured in such a manner that they prevent access to your application host and port from your point to site IP range</span></span>

<span data-ttu-id="adefd-336">請記住，您不知道應用程式將使用點對站 IP 範圍中的哪個 IP，因此您必須允許從整個範圍存取。</span><span class="sxs-lookup"><span data-stu-id="adefd-336">Remember that you don't know what IP in your Point to Site IP range that your app will use so you need to allow access from the entire range.</span></span> 

<span data-ttu-id="adefd-337">其他偵錯步驟包括：</span><span class="sxs-lookup"><span data-stu-id="adefd-337">Additional debug steps include:</span></span>

* <span data-ttu-id="adefd-338">登入 VNet 中的另一個 VM，並嘗試從該處觸達資源 host:port。</span><span class="sxs-lookup"><span data-stu-id="adefd-338">log onto another VM in your VNet and attempt to reach your resource host:port from there.</span></span> <span data-ttu-id="adefd-339">有一些您可以基於此用途使用的 TCP ping 公用程式，或者甚至需要時，也可使用 telnet。</span><span class="sxs-lookup"><span data-stu-id="adefd-339">There are some TCP ping utilities that you can use for this purpose or can even use telnet if need be.</span></span> <span data-ttu-id="adefd-340">這裡的用途只是判斷是否可從這個其他 VM 連接到該處。</span><span class="sxs-lookup"><span data-stu-id="adefd-340">The purpose here is just to determine if connectivity is there from this other VM.</span></span> 
* <span data-ttu-id="adefd-341">啟動另一個 VM 上的應用程式，並從主控台測試是否可從應用程式存取該主機和連接埠</span><span class="sxs-lookup"><span data-stu-id="adefd-341">bring up an application on another VM and test access to that host and port from the console from your app</span></span>

#### <a name="on-premises-resources"></a><span data-ttu-id="adefd-342">內部部署資源</span><span class="sxs-lookup"><span data-stu-id="adefd-342">On-premises resources</span></span> ####
<span data-ttu-id="adefd-343">如果您的應用程式無法觸達內部部署的資源，則首先應該檢查是否可以觸達 VNet 中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-343">If your app cannot reach resources on-premises, then the first thing you should check is if you can reach a resource in your VNet.</span></span> <span data-ttu-id="adefd-344">如果可以運作，請嘗試從 VNet 中的 VM 嘗試觸達內部部署應用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-344">If that works, try to reach the on-premises application from a VM in the VNet.</span></span> <span data-ttu-id="adefd-345">您可以使用 telnet 或 TCP ping 公用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-345">You can use telnet or a TCP ping utility.</span></span> <span data-ttu-id="adefd-346">如果 VM 無法觸達內部部署資源，請確定站對站 VPN 連線正在運作中。</span><span class="sxs-lookup"><span data-stu-id="adefd-346">If your VM can't reach your on-premises resource, then make sure your Site to Site VPN connection is working.</span></span> <span data-ttu-id="adefd-347">如果正在運作中，接著檢查先前提到的相同事項，以及內部部署閘道組態和狀態。</span><span class="sxs-lookup"><span data-stu-id="adefd-347">If it is working, then check the same things noted earlier as well as the on-premises gateway configuration and status.</span></span> 

<span data-ttu-id="adefd-348">現在，如果 VNet 裝載的 VM 可以觸達您的內部部署系統，但您的應用程式無法觸達此系統，則很可能是下列其中一個原因：</span><span class="sxs-lookup"><span data-stu-id="adefd-348">Now if your VNet hosted VM can reach your on-premises system but your app can't then the reason is likely one of the following:</span></span>

* <span data-ttu-id="adefd-349">內部部署閘道中未以您的點對站 IP 範圍設定路由</span><span class="sxs-lookup"><span data-stu-id="adefd-349">your routes are not configured with your point to site IP ranges in your on-premises gateway</span></span>
* <span data-ttu-id="adefd-350">網路安全性群組已封鎖點對站 IP 範圍的存取</span><span class="sxs-lookup"><span data-stu-id="adefd-350">your network security groups are blocking access for your Point to Site IP range</span></span>
* <span data-ttu-id="adefd-351">內部部署防火牆已封鎖來自點對站 IP 範圍的流量</span><span class="sxs-lookup"><span data-stu-id="adefd-351">your on-premises firewalls are blocking traffic from your Point to Site IP range</span></span>
* <span data-ttu-id="adefd-352">您在 VNet 中有使用者定義的路由 (UDR) 阻止點對站的流量觸達您的內部部署網路</span><span class="sxs-lookup"><span data-stu-id="adefd-352">you have a User Defined Route(UDR) in your VNet that prevents your Point to Site based traffic from reaching your on-premises network</span></span>

## <a name="hybrid-connections-and-app-service-environments"></a><span data-ttu-id="adefd-353">混合式連線和 App Service 環境</span><span class="sxs-lookup"><span data-stu-id="adefd-353">Hybrid Connections and App Service Environments</span></span>
<span data-ttu-id="adefd-354">有三個可讓您存取 VNet 裝載之資源的功能。</span><span class="sxs-lookup"><span data-stu-id="adefd-354">There are three features that enable access to VNet hosted resources.</span></span> <span data-ttu-id="adefd-355">如下：</span><span class="sxs-lookup"><span data-stu-id="adefd-355">They are:</span></span>

* <span data-ttu-id="adefd-356">VNet 整合</span><span class="sxs-lookup"><span data-stu-id="adefd-356">VNet Integration</span></span>
* <span data-ttu-id="adefd-357">混合式連線</span><span class="sxs-lookup"><span data-stu-id="adefd-357">Hybrid Connections</span></span>
* <span data-ttu-id="adefd-358">App Service 環境</span><span class="sxs-lookup"><span data-stu-id="adefd-358">App Service Environments</span></span>

<span data-ttu-id="adefd-359">混合式連線需要您在網路中安裝稱為混合式連線管理員 (HCM) 的轉送代理程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-359">Hybrid Connections requires you to install a relay agent called the Hybrid Connection Manager(HCM) in your network.</span></span> <span data-ttu-id="adefd-360">HCM 必須同時能夠連接至 Azure 和您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="adefd-360">The HCM needs to be able to connect to Azure and also to your application.</span></span> <span data-ttu-id="adefd-361">此解決方案特別適合遠端網路，例如內部部署網路，或甚至是另一個雲端裝載的網路，因為它不需要網際網路可存取的端點。</span><span class="sxs-lookup"><span data-stu-id="adefd-361">This solution is especially great from a remote network such as your on-premises network or even another cloud hosted network because it does not require an internet accessible endpoint.</span></span> <span data-ttu-id="adefd-362">HCM 只在 Windows 上執行，而且您最多可有五個執行個體同時執行，以提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="adefd-362">The HCM only runs on Windows and you can have up to five instances running to provide high availability.</span></span> <span data-ttu-id="adefd-363">雖然混合式連線只支援 TCP，但是每個 HC 端點必須符合特定的主機:連接埠組合。</span><span class="sxs-lookup"><span data-stu-id="adefd-363">Hybrid Connections only supports TCP though and each HC endpoint has to match to a specific host:port combination.</span></span> 

<span data-ttu-id="adefd-364">App Service 環境功能可讓您在 VNet 中執行 Azure App Service 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="adefd-364">The App Service Environment feature allows you to run an instance of the Azure App Service in your VNet.</span></span> <span data-ttu-id="adefd-365">這可讓應用程式無需任何額外的步驟，即可存取 VNet 中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-365">This lets your apps access resources in your VNet without any extra steps.</span></span> <span data-ttu-id="adefd-366">App Service 環境的好處還有您可以搭配最多 14 GB 的 RAM 使用 Dv2 式背景工作角色。</span><span class="sxs-lookup"><span data-stu-id="adefd-366">Some of the other benefits of an App Service Environment are that you can use Dv2 based workers with up to 14 GB of RAM.</span></span> <span data-ttu-id="adefd-367">另一個好處是您可以調整系統以符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="adefd-367">Another benefit is that you can scale the system to meet your needs.</span></span> <span data-ttu-id="adefd-368">與 ASP 受限於 20 個執行個體的多租用戶環境不同，在 ASE 中，您可以相應增加到 100 個 ASP 執行個體。</span><span class="sxs-lookup"><span data-stu-id="adefd-368">Unlike the multi-tenant environments where your ASP is limited to 20 instances, in an ASE you can scale up to 100 ASP instances.</span></span> <span data-ttu-id="adefd-369">VNet 整合無法辦到，但 ASE 辦得到的其中一件事是，App Service 環境可以使用 ExpressRoute VPN。</span><span class="sxs-lookup"><span data-stu-id="adefd-369">One of the things you get with an ASE that you don't with VNet Integration is that an App Service Environment can work with an ExpressRoute VPN.</span></span> 

<span data-ttu-id="adefd-370">儘管有使用案例重疊的情況，但這些功能無法取代彼此。</span><span class="sxs-lookup"><span data-stu-id="adefd-370">While there is some use case overlap, none of these feature can replace any of the others.</span></span> <span data-ttu-id="adefd-371">知道使用哪個功能取決於您的需求。</span><span class="sxs-lookup"><span data-stu-id="adefd-371">Knowing what feature to use is tied to your needs.</span></span> <span data-ttu-id="adefd-372">例如：</span><span class="sxs-lookup"><span data-stu-id="adefd-372">For example:</span></span>

* <span data-ttu-id="adefd-373">如果您是開發人員，而且只是想要在 Azure 中執行網站，並讓它可存取辦公桌下工作站上的資料庫，則最簡單的方式就是使用混合式連線。</span><span class="sxs-lookup"><span data-stu-id="adefd-373">If you are a developer and simply want to run a site in Azure and have it access the database on the workstation under your desk, then the easiest thing to use is Hybrid Connections.</span></span> 
* <span data-ttu-id="adefd-374">如果您是想要將大量 Web 內容放在公用雲端，並在自己的網路中管理它們的大型組織，則您會想要使用 App Service 環境。</span><span class="sxs-lookup"><span data-stu-id="adefd-374">If you are a large organization that wants to put a large number of web properties in the public cloud and manage them in your own network, then you want to go with the App Service Environment.</span></span> 
* <span data-ttu-id="adefd-375">如果您有許多 App Service 裝載的應用程式，而且只想要存取 VNet 中的資源，則 VNet 整合是最好的選擇。</span><span class="sxs-lookup"><span data-stu-id="adefd-375">If you have a number of App Service hosted apps and simply want to access resources in your VNet, then VNet Integration is the way to go.</span></span> 

<span data-ttu-id="adefd-376">除了使用案例以外，還有一些簡單相關層面。</span><span class="sxs-lookup"><span data-stu-id="adefd-376">Beyond the use cases, there are some simplicity related aspects.</span></span> <span data-ttu-id="adefd-377">如果 VNet 已經連線到內部部署網路，則使用 VNet 整合或 App Service 環境是取用內部部署資源的簡單方法。</span><span class="sxs-lookup"><span data-stu-id="adefd-377">If your VNet is already connected to your on-premises network, then using VNet Integration or an App Service Environment is an easy way to consume on-premises resources.</span></span> <span data-ttu-id="adefd-378">另一方面，如果 VNet 未連線到內部部署網路，則相較於安裝 HCM，搭配您的 VNet 設定站對站 VPN，需要更多的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="adefd-378">On the other hand, if your VNet is not connected to your on-premises network then it's a lot more overhead to set up a site to site VPN with your VNet compared with installing the HCM.</span></span> 

<span data-ttu-id="adefd-379">除了功能差異以外，還有價格差異。</span><span class="sxs-lookup"><span data-stu-id="adefd-379">Beyond the functional differences, there are also pricing differences.</span></span> <span data-ttu-id="adefd-380">App Service 環境功能是進階服務供應項目，除了其他很棒的功能外，還提供最多的網路組態可能性。</span><span class="sxs-lookup"><span data-stu-id="adefd-380">The App Service Environment feature is a Premium service offering but offers the most network configuration possibilities in addition to other great features.</span></span> <span data-ttu-id="adefd-381">VNet 整合可與標準或進階 ASP 搭配使用，並非常適合從多租用戶 App Service 安全取用 VNet 中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-381">VNet Integration can be used with Standard or Premium ASPs and is perfect for securely consuming resources in your VNet from the multi-tenant App Service.</span></span> <span data-ttu-id="adefd-382">混合式連線目前取決於 BizTalk 帳戶，此帳戶具有的價格層級，從一開始免費，然後根據您需要的數量而越發昂貴。</span><span class="sxs-lookup"><span data-stu-id="adefd-382">Hybrid Connections currently depends on a BizTalk account, which has pricing levels that start free and then get progressively more expensive based on the amount you need.</span></span> <span data-ttu-id="adefd-383">不過，當在許多網路之間工作時，沒有其他功能像混合式連線一樣，可讓您存取超過 100 個不同網路中的資源。</span><span class="sxs-lookup"><span data-stu-id="adefd-383">When it comes to working across many networks though, there is no other feature like Hybrid Connections, which can enable you to access resources in well over 100 separate networks.</span></span> 

<!--Image references-->
[1]: ./media/web-sites-integrate-with-vnet/vnetint-upgradeplan.png
[2]: ./media/web-sites-integrate-with-vnet/vnetint-existingvnet.png
[3]: ./media/web-sites-integrate-with-vnet/vnetint-createvnet.png
[4]: ./media/web-sites-integrate-with-vnet/vnetint-howitworks.png
[5]: ./media/web-sites-integrate-with-vnet/vnetint-appmanage.png
[6]: ./media/web-sites-integrate-with-vnet/vnetint-aspmanage.png
[7]: ./media/web-sites-integrate-with-vnet/vnetint-aspmanagedetail.png
[8]: ./media/web-sites-integrate-with-vnet/vnetint-vnetp2s.png

<!--Links-->
[VNETOverview]: http://azure.microsoft.com/documentation/articles/virtual-networks-overview/ 
[AzurePortal]: http://portal.azure.com/
[ASPricing]: http://azure.microsoft.com/pricing/details/app-service/
[VNETPricing]: http://azure.microsoft.com/pricing/details/vpn-gateway/
[DataPricing]: http://azure.microsoft.com/pricing/details/data-transfers/
[V2VNETP2S]: http://azure.microsoft.com/documentation/articles/vpn-gateway-howto-point-to-site-rm-ps/
[IntPowershell]: http://azure.microsoft.com/documentation/articles/app-service-vnet-integration-powershell/
[ASEintro]: http://docs.microsoft.com/azure/app-service/app-service-environment/intro
[ILBASE]: http://docs.microsoft.com/azure/app-service/app-service-environment/create-ilb-ase
[V2VNETPortal]: https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal
[VPNERCoex]: http://docs.microsoft.com/en-us/azure/expressroute/expressroute-howto-coexist-resource-manager
[ASE]: http://docs.microsoft.com/azure/app-service/app-service-environment/intro
