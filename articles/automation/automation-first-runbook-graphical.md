---
title: "我在 Azure 自動化中的第一個圖形化 Runbook | Microsoft Docs"
description: "教學課程將逐步引導您建立、測試和發佈簡單的圖形化 Runbook。"
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "runbook, runbook 範本, runbook 自動化, azure runbook"
ms.assetid: dcb88f19-ed2b-4372-9724-6625cd287c8a
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/17/2017
ms.author: magoedte;bwren
ms.openlocfilehash: 9d4b28416376482247127698bec7c99b83308885
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-graphical-runbook"></a><span data-ttu-id="b275f-104">我的第一個圖形化 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-104">My first graphical runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="b275f-105">圖形化</span><span class="sxs-lookup"><span data-stu-id="b275f-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="b275f-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="b275f-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="b275f-107">PowerShell 工作流程</span><span class="sxs-lookup"><span data-stu-id="b275f-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="b275f-108">本教學課程將逐步引導您在 Azure 自動化中建立 [圖形化 Runbook](automation-runbook-types.md#graphical-runbooks) 。</span><span class="sxs-lookup"><span data-stu-id="b275f-108">This tutorial walks you through the creation of a [graphical runbook](automation-runbook-types.md#graphical-runbooks) in Azure Automation.</span></span>  <span data-ttu-id="b275f-109">我們先從測試和發佈的簡單 Runbook 開始，同時說明如何追蹤 Runbook 作業的狀態。</span><span class="sxs-lookup"><span data-stu-id="b275f-109">We start with a simple runbook that tests and publishes while we explain how to track the status of the runbook job.</span></span>  <span data-ttu-id="b275f-110">接著我們會修改 Runbook 以實際管理 Azure 資源，在此情況下會啟動 Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span>  <span data-ttu-id="b275f-111">接著我們會新增 Runbook 參數和條件式連結，讓 Runbook 更加穩固，藉此完成本教學課程。</span><span class="sxs-lookup"><span data-stu-id="b275f-111">Then we complete the tutorial by making the runbook more robust by adding runbook parameters and conditional links.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="b275f-112">必要條件</span><span class="sxs-lookup"><span data-stu-id="b275f-112">Prerequisites</span></span>
<span data-ttu-id="b275f-113">若要完成本教學課程，您需要下列項目。</span><span class="sxs-lookup"><span data-stu-id="b275f-113">To complete this tutorial, you will need the following.</span></span>

* <span data-ttu-id="b275f-114">Azure 訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="b275f-114">Azure subscription.</span></span>  <span data-ttu-id="b275f-115">如果您沒有這類帳戶，可以[啟用自己的 MSDN 訂戶權益<a href="/pricing/free-account/" target="_blank">或](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/)[註冊免費帳戶](https://azure.microsoft.com/free/)。</span><span class="sxs-lookup"><span data-stu-id="b275f-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="b275f-116">[Azure 自動化帳戶](automation-sec-configure-azure-runas-account.md)，用來保存 Runbook 以及向 Azure 資源驗證。</span><span class="sxs-lookup"><span data-stu-id="b275f-116">[Azure Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="b275f-117">此帳戶必須擁有啟動和停止虛擬機器的權限。</span><span class="sxs-lookup"><span data-stu-id="b275f-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="b275f-118">Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-118">An Azure virtual machine.</span></span>  <span data-ttu-id="b275f-119">我們將會停止並啟動這台電腦，因此它不應該是生產環境。</span><span class="sxs-lookup"><span data-stu-id="b275f-119">We will stop and start this machine so it should not be production.</span></span>

## <a name="step-1---create-runbook"></a><span data-ttu-id="b275f-120">步驟 1 - 建立 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-120">Step 1 - Create runbook</span></span>
<span data-ttu-id="b275f-121">我們會由建立一個可輸出文字 Hello World 的簡單 Runbook 開始。</span><span class="sxs-lookup"><span data-stu-id="b275f-121">We start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="b275f-122">在 Azure 入口網站中，開啟您的自動化帳戶。</span><span class="sxs-lookup"><span data-stu-id="b275f-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="b275f-123">[自動化帳戶] 頁面提供這個帳戶中資源的快速檢視。</span><span class="sxs-lookup"><span data-stu-id="b275f-123">The Automation account page gives you a quick view of the resources in this account.</span></span>  <span data-ttu-id="b275f-124">您應該已經有一些資產。</span><span class="sxs-lookup"><span data-stu-id="b275f-124">You should already have some Assets.</span></span>  <span data-ttu-id="b275f-125">其中大部分是會自動包含在新自動化帳戶的模組。</span><span class="sxs-lookup"><span data-stu-id="b275f-125">Most of those are the modules that are automatically included in a new Automation account.</span></span>  <span data-ttu-id="b275f-126">您應該也擁有 [必要條件](#prerequisites)中所述的認證資產。</span><span class="sxs-lookup"><span data-stu-id="b275f-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="b275f-127">按一下 [Runbook]  磚以開啟 Runbook 的清單。</span><span class="sxs-lookup"><span data-stu-id="b275f-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br> <span data-ttu-id="b275f-128">![Runbook 控制項](media/automation-first-runbook-graphical/runbooks-resources-tile.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-128">![Runbooks control](media/automation-first-runbook-graphical/runbooks-resources-tile.png)</span></span>
3. <span data-ttu-id="b275f-129">按一下 [新增 Runbook] 按鈕，然後按一下 [建立新的 Runbook] 來建立新的 Runbook。</span><span class="sxs-lookup"><span data-stu-id="b275f-129">Create a new runbook by clicking on the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="b275f-130">為 Runbook 提供名稱「MyFirstRunbook-Graphical」 。</span><span class="sxs-lookup"><span data-stu-id="b275f-130">Give the runbook the name *MyFirstRunbook-Graphical*.</span></span>
5. <span data-ttu-id="b275f-131">在此情況下，我們要建立[圖形化 Runbook](automation-graphical-authoring-intro.md)，因此請選取 [圖形] 作為 [Runbook 類型]。</span><span class="sxs-lookup"><span data-stu-id="b275f-131">In this case, we're going to create a [graphical runbook](automation-graphical-authoring-intro.md) so select **Graphical** for **Runbook type**.</span></span><br> <span data-ttu-id="b275f-132">![新的 Runbook](media/automation-first-runbook-graphical/create-new-runbook.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-132">![New runbook](media/automation-first-runbook-graphical/create-new-runbook.png)</span></span><br>
6. <span data-ttu-id="b275f-133">按一下 [建立]  來建立 Runbook 並開啟圖形化編輯器。</span><span class="sxs-lookup"><span data-stu-id="b275f-133">Click **Create** to create the runbook and open the graphical editor.</span></span>

## <a name="step-2---add-activities-to-the-runbook"></a><span data-ttu-id="b275f-134">步驟 2 - 將活動加入至 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-134">Step 2 - Add activities to the runbook</span></span>
<span data-ttu-id="b275f-135">編輯器左邊的 [程式庫] 控制項可讓您選取要加入到 Runbook 的活動。</span><span class="sxs-lookup"><span data-stu-id="b275f-135">The Library control on the left side of the editor allows you to select activities to add to your runbook.</span></span>  <span data-ttu-id="b275f-136">我們將會加入 **Write-Output** Cmdlet 以從 Runbook 輸出文字。</span><span class="sxs-lookup"><span data-stu-id="b275f-136">We're going to add a **Write-Output** cmdlet to output text from the runbook.</span></span>

1. <span data-ttu-id="b275f-137">在 [程式庫] 控制項中，按一下搜尋文字方塊並輸入 **Write-Output**。</span><span class="sxs-lookup"><span data-stu-id="b275f-137">In the Library control, click in the search textbox and type **Write-Output**.</span></span>  <span data-ttu-id="b275f-138">搜尋結果將會顯示在下面。</span><span class="sxs-lookup"><span data-stu-id="b275f-138">The search results will be displayed below.</span></span> <br> <span data-ttu-id="b275f-139">![Microsoft.PowerShell.Utility](media/automation-first-runbook-graphical/search-powershell-cmdlet-writeoutput.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-139">![Microsoft.PowerShell.Utility](media/automation-first-runbook-graphical/search-powershell-cmdlet-writeoutput.png)</span></span>
2. <span data-ttu-id="b275f-140">向下捲動到清單底部。</span><span class="sxs-lookup"><span data-stu-id="b275f-140">Scroll down to the bottom of the list.</span></span>  <span data-ttu-id="b275f-141">您可以用滑鼠右鍵按一下 [Write-Output] 並選取 [新增至畫布]，或按一下 Cmdlet 旁邊的省略符號，然後選取 [新增至畫布]。</span><span class="sxs-lookup"><span data-stu-id="b275f-141">You can either right-click **Write-Output** and select **Add to canvas** or click the ellipse next to the cmdlet and then select **Add to canvas**.</span></span>
3. <span data-ttu-id="b275f-142">按一下畫布上的 **Write-Output** 活動。</span><span class="sxs-lookup"><span data-stu-id="b275f-142">Click the **Write-Output** activity on the canvas.</span></span>  <span data-ttu-id="b275f-143">這會開啟可讓您設定活動的 [組態] 控制項刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-143">This opens the Configuration control blade, which allows you to configure the activity.</span></span>
4. <span data-ttu-id="b275f-144">[標籤]  會預設為 Cmdlet 的名稱，但我們可以將它變更為比較好記的名稱。</span><span class="sxs-lookup"><span data-stu-id="b275f-144">The **Label** defaults to the name of the cmdlet, but we can change it to something more friendly.</span></span> <span data-ttu-id="b275f-145">將它變更為「Write Hello World to output」 。</span><span class="sxs-lookup"><span data-stu-id="b275f-145">Change it to *Write Hello World to output*.</span></span>
5. <span data-ttu-id="b275f-146">按一下 [參數] 來提供 Cmdlet 的參數值。</span><span class="sxs-lookup"><span data-stu-id="b275f-146">Click **Parameters** to provide values for the cmdlet's parameters.</span></span>  
   <span data-ttu-id="b275f-147">某些 Cmdlet 有多個參數集，並且您必須選取您要使用的參數。</span><span class="sxs-lookup"><span data-stu-id="b275f-147">Some cmdlets have multiple parameter sets, and you need to select which you one to use.</span></span> <span data-ttu-id="b275f-148">在此情況下，**Write-Output** 有只有一個參數集，因此您不需要選取其中一個。</span><span class="sxs-lookup"><span data-stu-id="b275f-148">In this case, **Write-Output** has only one parameter set, so you don't need to select one.</span></span> <br> <span data-ttu-id="b275f-149">![Write-Output 屬性](media/automation-first-runbook-graphical/write-output-properties-b.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-149">![Write-Output properties](media/automation-first-runbook-graphical/write-output-properties-b.png)</span></span>
6. <span data-ttu-id="b275f-150">選取 **InputObject** 參數。</span><span class="sxs-lookup"><span data-stu-id="b275f-150">Select the **InputObject** parameter.</span></span>  <span data-ttu-id="b275f-151">這是我們在其中指定要傳送至輸出資料流之文字的參數。</span><span class="sxs-lookup"><span data-stu-id="b275f-151">This is the parameter where we specify the text to send to the output stream.</span></span>
7. <span data-ttu-id="b275f-152">在 [資料來源] 下拉式清單中，選取 [PowerShell 運算式]。</span><span class="sxs-lookup"><span data-stu-id="b275f-152">In the **Data source** dropdown, select **PowerShell expression**.</span></span>  <span data-ttu-id="b275f-153">[資料來源]  下拉式清單提供您用來填入參數值的不同來源。</span><span class="sxs-lookup"><span data-stu-id="b275f-153">The **Data source** dropdown provides different sources that you use to populate a parameter value.</span></span>  
   <span data-ttu-id="b275f-154">您可以使用來自這類來源的輸出，例如另一個活動、自動化資產或 PowerShell 運算式。</span><span class="sxs-lookup"><span data-stu-id="b275f-154">You can use output from such sources such as another activity, an Automation asset, or a PowerShell expression.</span></span>  <span data-ttu-id="b275f-155">在此情況下，我們只想要輸出文字「Hello World」 。</span><span class="sxs-lookup"><span data-stu-id="b275f-155">In this case, we just want to output the text *Hello World*.</span></span> <span data-ttu-id="b275f-156">我們可以使用 PowerShell 運算式，並指定字串。</span><span class="sxs-lookup"><span data-stu-id="b275f-156">We can use a PowerShell expression and specify a string.</span></span>
8. <span data-ttu-id="b275f-157">在 [運算式] 方塊中，輸入 "Hello World"，然後按一下 [確定] 兩次以返回畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-157">In the **Expression** box, type *"Hello World"* and then click **OK** twice to return to the canvas.</span></span><br> <span data-ttu-id="b275f-158">![PowerShell Expression](media/automation-first-runbook-graphical/expression-hello-world.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-158">![PowerShell Expression](media/automation-first-runbook-graphical/expression-hello-world.png)</span></span>
9. <span data-ttu-id="b275f-159">按一下 [儲存] 來儲存 Runbook。</span><span class="sxs-lookup"><span data-stu-id="b275f-159">Save the runbook by clicking **Save**.</span></span><br> <span data-ttu-id="b275f-160">![儲存 Runbook](media/automation-first-runbook-graphical/runbook-toolbar-save-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-160">![Save runbook](media/automation-first-runbook-graphical/runbook-toolbar-save-revised20165.png)</span></span>

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="b275f-161">步驟 3 - 測試 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-161">Step 3 - Test the runbook</span></span>
<span data-ttu-id="b275f-162">在我們發佈 Runbook 之前，為了使其可用於生產環境，我們想要測試以確定它可以正常運作。</span><span class="sxs-lookup"><span data-stu-id="b275f-162">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span>  <span data-ttu-id="b275f-163">測試 Runbook 時，您會執行其 **草稿** 版本，並以互動方式檢視其輸出。</span><span class="sxs-lookup"><span data-stu-id="b275f-163">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="b275f-164">按一下 [測試窗格] 來開啟 [測試] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-164">Click **Test pane** to open the Test blade.</span></span><br> <span data-ttu-id="b275f-165">![測試窗格](media/automation-first-runbook-graphical/runbook-toolbar-test-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-165">![Test pane](media/automation-first-runbook-graphical/runbook-toolbar-test-revised20165.png)</span></span>
2. <span data-ttu-id="b275f-166">按一下 [開始]  以開始測試。</span><span class="sxs-lookup"><span data-stu-id="b275f-166">Click **Start** to start the test.</span></span>  <span data-ttu-id="b275f-167">這應該是唯一啟用的選項。</span><span class="sxs-lookup"><span data-stu-id="b275f-167">This should be the only enabled option.</span></span>
3. <span data-ttu-id="b275f-168">隨即會建立 [Runbook 工作](automation-runbook-execution.md) ，並在窗格中顯示其狀態。</span><span class="sxs-lookup"><span data-stu-id="b275f-168">A [runbook job](automation-runbook-execution.md) is created and its status displayed in the pane.</span></span>  
   <span data-ttu-id="b275f-169">作業狀態一開始為「已排入佇列」，表示正在等候雲端中的 Runbook 背景工作可供使用。</span><span class="sxs-lookup"><span data-stu-id="b275f-169">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to become available.</span></span>  <span data-ttu-id="b275f-170">然後當背景工作宣告該作業時，狀態會變更為 [正在開始]，然後 Runbook 實際開始執行時再變更為 [執行中]。</span><span class="sxs-lookup"><span data-stu-id="b275f-170">It then moves to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="b275f-171">Runbook 工作完成時，會顯示其輸出。</span><span class="sxs-lookup"><span data-stu-id="b275f-171">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="b275f-172">在我們的情況中，我們應該會看到 Hello World。</span><span class="sxs-lookup"><span data-stu-id="b275f-172">In our case, we should see *Hello World*.</span></span><br> <span data-ttu-id="b275f-173">![](media/automation-first-runbook-graphical/runbook-test-results.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-173">![Hello World](media/automation-first-runbook-graphical/runbook-test-results.png)</span></span>
5. <span data-ttu-id="b275f-174">關閉 [測試] 刀鋒視窗返回畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-174">Close the Test blade to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="b275f-175">步驟 4 - 發佈和啟動 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-175">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="b275f-176">我們建立的 Runbook 仍處於草稿模式。</span><span class="sxs-lookup"><span data-stu-id="b275f-176">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="b275f-177">我們需要將它發佈，才能在生產環境中執行它。</span><span class="sxs-lookup"><span data-stu-id="b275f-177">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="b275f-178">當您發佈 Runbook 時，您會使用草稿版本覆寫現有的已發佈版本。</span><span class="sxs-lookup"><span data-stu-id="b275f-178">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="b275f-179">在我們的情況中，因為我們剛剛建立 Runbook，因此還沒有已發佈版本。</span><span class="sxs-lookup"><span data-stu-id="b275f-179">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="b275f-180">按一下 [發佈] 來發佈 Runbook，然後出現提示時按一下 [是]。</span><span class="sxs-lookup"><span data-stu-id="b275f-180">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br> <span data-ttu-id="b275f-181">![](media/automation-first-runbook-graphical/runbook-toolbar-publish-revised20166.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-181">![Publish](media/automation-first-runbook-graphical/runbook-toolbar-publish-revised20166.png)</span></span>
2. <span data-ttu-id="b275f-182">如果您向左捲動以檢視 [Runbook] 刀鋒視窗中的 Runbook，它會顯示 [已發佈] 的 [撰寫狀態]。</span><span class="sxs-lookup"><span data-stu-id="b275f-182">If you scroll left to view the runbook in the **Runbooks** blade, it shows an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="b275f-183">捲動回右方以檢視 **MyFirstRunbook**的刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-183">Scroll back to the right to view the blade for **MyFirstRunbook**.</span></span>  
   <span data-ttu-id="b275f-184">在頂端的選項可讓我們啟動 Runbook、排程它在未來的某個時間點啟動，或建立 [webhook](automation-webhooks.md) ，使得可以透過 HTTP 呼叫啟動它。</span><span class="sxs-lookup"><span data-stu-id="b275f-184">The options across the top allow us to start the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="b275f-185">我們只想要啟動 Runbook，因此按一下 [開始]，然後在提示出現時按一下 [是]。</span><span class="sxs-lookup"><span data-stu-id="b275f-185">We just want to start the runbook so click **Start** and then **Yes** when prompted.</span></span><br> <span data-ttu-id="b275f-186">![啟動 Runbook](media/automation-first-runbook-graphical/runbook-controls-start-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-186">![Start runbook](media/automation-first-runbook-graphical/runbook-controls-start-revised20165.png)</span></span>
5. <span data-ttu-id="b275f-187">作業刀鋒視窗會開啟我們建立的 Runbook 作業。</span><span class="sxs-lookup"><span data-stu-id="b275f-187">A job blade is opened for the runbook job that we created.</span></span>  <span data-ttu-id="b275f-188">我們可以關閉此刀鋒視窗，但在此情況下，我們會將它開啟，使得我們可以觀看作業的進度。</span><span class="sxs-lookup"><span data-stu-id="b275f-188">We can close this blade, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="b275f-189">[作業摘要]  中會顯示作業狀態，且符合當我們測試 Runbook 時看到的狀態。</span><span class="sxs-lookup"><span data-stu-id="b275f-189">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br> <span data-ttu-id="b275f-190">![工作摘要](media/automation-first-runbook-graphical/runbook-job-summary.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-190">![Job Summary](media/automation-first-runbook-graphical/runbook-job-summary.png)</span></span>
7. <span data-ttu-id="b275f-191">一旦 Runbook 狀態顯示 [已完成]，請按一下 [輸出]。</span><span class="sxs-lookup"><span data-stu-id="b275f-191">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="b275f-192">[輸出] 刀鋒視窗會開啟，而且可以在窗格中看到我們的 Hello World。</span><span class="sxs-lookup"><span data-stu-id="b275f-192">The **Output** blade is opened, and we can see our *Hello World* in the pane.</span></span><br> <span data-ttu-id="b275f-193">![工作摘要](media/automation-first-runbook-graphical/runbook-job-output.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-193">![Job Summary](media/automation-first-runbook-graphical/runbook-job-output.png)</span></span>  
8. <span data-ttu-id="b275f-194">關閉 [輸出] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-194">Close the Output blade.</span></span>
9. <span data-ttu-id="b275f-195">按一下 [所有記錄檔] 以開啟 Runbook 作業的 [資料流] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-195">Click **All Logs** to open the Streams blade for the runbook job.</span></span>  <span data-ttu-id="b275f-196">我們應該只會在輸出資料流中看到「Hello World」  ，但可能也會顯示 Runbook 作業的其他資料流，例如 Runbook 寫入時發生的詳細資訊和錯誤。</span><span class="sxs-lookup"><span data-stu-id="b275f-196">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br> <span data-ttu-id="b275f-197">![工作摘要](media/automation-first-runbook-graphical/runbook-job-AllLogs.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-197">![Job Summary](media/automation-first-runbook-graphical/runbook-job-AllLogs.png)</span></span>
10. <span data-ttu-id="b275f-198">關閉 [所有記錄檔] 刀鋒視窗和 [作業] 刀鋒視窗以返回 [MyFirstRunbook] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-198">Close the All Logs blade and the Job blade to return to the MyFirstRunbook blade.</span></span>
11. <span data-ttu-id="b275f-199">按一下 [作業] 以開啟此 Runbook 的 [作業] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-199">Click **Jobs** to open the Jobs blade for this runbook.</span></span>  <span data-ttu-id="b275f-200">這樣會列出此 Runbook 所建立的所有作業。</span><span class="sxs-lookup"><span data-stu-id="b275f-200">This lists all the jobs created by this runbook.</span></span> <span data-ttu-id="b275f-201">由於我們只執行一次作業，因此應該只會看到列出一項作業。</span><span class="sxs-lookup"><span data-stu-id="b275f-201">We should only see one job listed since we only ran the job once.</span></span><br> <span data-ttu-id="b275f-202">![作業](media/automation-first-runbook-graphical/runbook-control-jobs.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-202">![Jobs](media/automation-first-runbook-graphical/runbook-control-jobs.png)</span></span>
12. <span data-ttu-id="b275f-203">您可以按一下此作業，以開啟我們啟動 Runbook 時所檢視的相同 [作業] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-203">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span>  <span data-ttu-id="b275f-204">這可讓您回到過去的時間並檢視針對特定 Runbook 所建立的任何工作的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="b275f-204">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---create-variable-assets"></a><span data-ttu-id="b275f-205">步驟 5 - 建立變數資產</span><span class="sxs-lookup"><span data-stu-id="b275f-205">Step 5 - Create variable assets</span></span>
<span data-ttu-id="b275f-206">我們已經測試並發行我們 Runbook，但是到目前為止，它似乎並不實用。</span><span class="sxs-lookup"><span data-stu-id="b275f-206">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="b275f-207">我們想要讓它管理 Azure 資源。</span><span class="sxs-lookup"><span data-stu-id="b275f-207">We want to have it manage Azure resources.</span></span>  <span data-ttu-id="b275f-208">在設定要驗證的 Runbook 之前，我們會建立變數來保存訂用帳戶識別碼，並在設定要在下面的步驟 6 進行驗證的活動後參考此變數。</span><span class="sxs-lookup"><span data-stu-id="b275f-208">Before we configure the runbook to authenticate, we  create a variable to hold the subscription ID and reference it after we set up the activity to authenticate in step 6 below.</span></span>  <span data-ttu-id="b275f-209">包括訂用帳戶內容的參考，可讓您輕鬆地處理多個訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="b275f-209">Including a reference to the subscription context allows you to easily work between multiple subscriptions.</span></span>  <span data-ttu-id="b275f-210">在繼續之前，請從 [導覽] 窗格上的 [訂用帳戶] 選項複製您的訂用帳戶識別碼。</span><span class="sxs-lookup"><span data-stu-id="b275f-210">Before proceeding, copy your subscription ID from the Subscriptions option off the Navigation pane.</span></span>  

1. <span data-ttu-id="b275f-211">在 [自動化帳戶] 刀鋒視窗中按一下 [資產] 圖格，隨即會開啟 [資產] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-211">In the Automation Accounts blade, click the **Assets** tile and the **Assets** blade is opened.</span></span>
2. <span data-ttu-id="b275f-212">在 [資產] 刀鋒視窗中，按一下 [變數] 圖格。</span><span class="sxs-lookup"><span data-stu-id="b275f-212">In the Assets blade, click the **Variables** tile.</span></span>
3. <span data-ttu-id="b275f-213">在 [變數] 刀鋒視窗中，按一下 [新增變數]。</span><span class="sxs-lookup"><span data-stu-id="b275f-213">On the Variables blade, click **Add a variable**.</span></span><br><span data-ttu-id="b275f-214">![自動化變數](media/automation-first-runbook-graphical/create-new-subscriptionid-variable.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-214">![Automation Variable](media/automation-first-runbook-graphical/create-new-subscriptionid-variable.png)</span></span>
4. <span data-ttu-id="b275f-215">在 [新增變數] 刀鋒視窗中，於 [名稱] 方塊中輸入 **AzureSubscriptionId**，並於 [值] 方塊中輸入您的訂用帳戶識別碼。</span><span class="sxs-lookup"><span data-stu-id="b275f-215">In the New variable blade, in the **Name** box, enter **AzureSubscriptionId** and in the **Value** box enter your Subscription ID.</span></span>  <span data-ttu-id="b275f-216">讓 [類型] 保持是 [字串]，並讓 [加密] 保持預設值。</span><span class="sxs-lookup"><span data-stu-id="b275f-216">Keep *string* for the **Type** and the default value for **Encryption**.</span></span>  
5. <span data-ttu-id="b275f-217">按一下 [建立]  來建立變數。</span><span class="sxs-lookup"><span data-stu-id="b275f-217">Click **Create** to create the variable.</span></span>  

## <a name="step-6---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="b275f-218">步驟 6 - 加入驗證來管理 Azure 資源</span><span class="sxs-lookup"><span data-stu-id="b275f-218">Step 6 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="b275f-219">現在我們已經擁有用來保存訂用帳戶識別碼的變數，接下來我們可以設定 Runbook，以使用 [必要條件](#prerequisites)中提到的「執行身分」認證來進行驗證。</span><span class="sxs-lookup"><span data-stu-id="b275f-219">Now that we have a variable to hold our subscription ID, we can configure our runbook to authenticate with the Run As credentials that are referred to in the [prerequisites](#prerequisites).</span></span>  <span data-ttu-id="b275f-220">我們的做法是將 [Azure 執行身分] 連線 **Asset** 和 **Add-AzureRMAccount** Cmdlet 新增至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-220">We do that by adding the Azure Run As connection **Asset** and **Add-AzureRMAccount** cmdlet to the canvas.</span></span>  

1. <span data-ttu-id="b275f-221">按一下 [MyFirstRunbook] 刀鋒視窗上的 [編輯] 來開啟圖形化編輯器。</span><span class="sxs-lookup"><span data-stu-id="b275f-221">Open the graphical editor by clicking **Edit** on the MyFirstRunbook blade.</span></span><br> <span data-ttu-id="b275f-222">![編輯 Runbook](media/automation-first-runbook-graphical/runbook-controls-edit-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-222">![Edit runbook](media/automation-first-runbook-graphical/runbook-controls-edit-revised20165.png)</span></span>
2. <span data-ttu-id="b275f-223">我們不再需要 [撰寫 Hello World 到輸出]，因此以滑鼠右鍵按一下它並選取 [刪除]。</span><span class="sxs-lookup"><span data-stu-id="b275f-223">We don't need the **Write Hello World to output** anymore, so right-click it and select **Delete**.</span></span>
3. <span data-ttu-id="b275f-224">在 [程式庫] 控制項中，展開 [連線]，並選取 [新增至畫布] 以將 [AzureRunAsConnection] 新增至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-224">In the Library control, expand **Connections** and add **AzureRunAsConnection** to the canvas by selecting **Add to canvas**.</span></span>
4. <span data-ttu-id="b275f-225">在畫布上選取 [AzureRunAsConnection]，然後在 [組態] 控制項窗格的 [標籤] 文字方塊中輸入 [取得執行身分連線]。</span><span class="sxs-lookup"><span data-stu-id="b275f-225">On the canvas, select **AzureRunAsConnection** and in the Configuration control pane, type **Get Run As Connection** in the **Label** textbox.</span></span>  <span data-ttu-id="b275f-226">這是連線</span><span class="sxs-lookup"><span data-stu-id="b275f-226">This is the connection</span></span>
5. <span data-ttu-id="b275f-227">在 [程式庫] 控制項中，於搜尋文字方塊中輸入 **Add-AzureRmAccount** 。</span><span class="sxs-lookup"><span data-stu-id="b275f-227">In the Library control, type **Add-AzureRmAccount** in the search textbox.</span></span>
6. <span data-ttu-id="b275f-228">將 [Set-AzureRmContext] **將 [Set-AzureRmContext]-AzureRmAccount** 加入至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-228">Add **Add-AzureRmAccount** to the canvas.</span></span><br> <span data-ttu-id="b275f-229">![](media/automation-first-runbook-graphical/search-powershell-cmdlet-addazurermaccount.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-229">![Add-AzureRMAccount](media/automation-first-runbook-graphical/search-powershell-cmdlet-addazurermaccount.png)</span></span>
7. <span data-ttu-id="b275f-230">將滑鼠停留在 [取得執行身分連線]，直到圖形的底端出現圓形。</span><span class="sxs-lookup"><span data-stu-id="b275f-230">Hover over **Get Run As Connection** until a circle appears on the bottom of the shape.</span></span> <span data-ttu-id="b275f-231">按一下圓形，並將箭頭拖曳到 [指定訂用帳戶識別碼] **Add-AzureRmAccount**。</span><span class="sxs-lookup"><span data-stu-id="b275f-231">Click the circle and drag the arrow to **Add-AzureRmAccount**.</span></span>  <span data-ttu-id="b275f-232">您剛才建立的箭號是「連結」。</span><span class="sxs-lookup"><span data-stu-id="b275f-232">The arrow that you created is a *link*.</span></span>  <span data-ttu-id="b275f-233">Runbook 會開始使用 [取得執行身分連線]，然後執行 [Add-AzureRmAccount]。</span><span class="sxs-lookup"><span data-stu-id="b275f-233">The runbook starts with **Get Run As Connection** and then run **Add-AzureRmAccount**.</span></span><br> <span data-ttu-id="b275f-234">![建立活動之間的連結](media/automation-first-runbook-graphical/runbook-link-auth-activities.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-234">![Create link between activities](media/automation-first-runbook-graphical/runbook-link-auth-activities.png)</span></span>
8. <span data-ttu-id="b275f-235">在畫布上選取 [Add-AzureRmAccount]，然後在 [組態] 控制項窗格的 [標籤] 文字方塊中輸入 [登入 Azure]。</span><span class="sxs-lookup"><span data-stu-id="b275f-235">On the canvas, select **Add-AzureRmAccount** and in the Configuration control pane type **Login to Azure** in the **Label** textbox.</span></span>
9. <span data-ttu-id="b275f-236">按一下 [參數]  ，隨即會顯示 [活動參數組態] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-236">Click **Parameters** and the Activity Parameter Configuration blade appears.</span></span>
10. <span data-ttu-id="b275f-237">**Add-AzureRmAccount** 有多個參數集，因此我們必須先選取一個參數，我們才可以提供參數值。</span><span class="sxs-lookup"><span data-stu-id="b275f-237">**Add-AzureRmAccount** has multiple parameter sets, so we need to select one before we can provide parameter values.</span></span>  <span data-ttu-id="b275f-238">按一下 [參數集]，然後選取 [ServicePrincipalCertificatewithSubscriptionId] 參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-238">Click **Parameter Set** and then select the **ServicePrincipalCertificatewithSubscriptionId** parameter set.</span></span>
11. <span data-ttu-id="b275f-239">一旦您選取參數集，參數會在 [活動參數組態] 刀鋒視窗中顯示。</span><span class="sxs-lookup"><span data-stu-id="b275f-239">Once you select the parameter set, the parameters are displayed in the Activity Parameter Configuration blade.</span></span>  <span data-ttu-id="b275f-240">按一下 [APPLICATIONID]。</span><span class="sxs-lookup"><span data-stu-id="b275f-240">Click **APPLICATIONID**.</span></span><br> <span data-ttu-id="b275f-241">![加入 Azure RM 帳戶參數](media/automation-first-runbook-graphical/add-azurermaccount-params.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-241">![Add Azure RM account parameters](media/automation-first-runbook-graphical/add-azurermaccount-params.png)</span></span>
12. <span data-ttu-id="b275f-242">在 [參數值] 刀鋒視窗中，針對 [資料來源] 選取 [活動輸出] 並從清單中選取 [取得執行身分連線]，在 [欄位路徑] 文字方塊中輸入 **ApplicationId**，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b275f-242">In the Parameter Value blade, select **Activity output** for the **Data source** and select **Get Run As Connection** from the list, in the **Field path** textbox type **ApplicationId**, and then click **OK**.</span></span>  <span data-ttu-id="b275f-243">我們會指定欄位路徑之屬性的名稱，因為活動會輸出具有多個屬性的物件。</span><span class="sxs-lookup"><span data-stu-id="b275f-243">We are specifying the name of the property for the Field path because the activity outputs an object with multiple properties.</span></span>
13. <span data-ttu-id="b275f-244">按一下 [CERTIFICATETHUMBPRINT]，然後在 [參數值] 刀鋒視窗中，針對 [資料來源] 選取 [活動輸出]。</span><span class="sxs-lookup"><span data-stu-id="b275f-244">Click **CERTIFICATETHUMBPRINT**, and in the Parameter Value blade, select **Activity output** for the **Data source**.</span></span>  <span data-ttu-id="b275f-245">從清單中選取 [取得執行身分連線]，在 [欄位路徑] 文字方塊中輸入 **CertificateThumbprint**，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b275f-245">Select **Get Run As Connection** from the list, in the **Field path** textbox type **CertificateThumbprint**, and then click **OK**.</span></span>
14. <span data-ttu-id="b275f-246">按一下 [SERVICEPRINCIPAL] 並在 [參數值] 刀鋒視窗中，針對 [資料來源] 選取 [ConstantValue]，按一下選項 [True]，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b275f-246">Click **SERVICEPRINCIPAL**, and in the Parameter Value blade, select **ConstantValue** for the **Data source**, click the option **True**, and then click **OK**.</span></span>
15. <span data-ttu-id="b275f-247">按一下 [TENANTID]，然後在 [參數值] 刀鋒視窗中，針對 [資料來源] 選取 [活動輸出]。</span><span class="sxs-lookup"><span data-stu-id="b275f-247">Click **TENANTID**, and in the Parameter Value blade, select **Activity output** for the **Data source**.</span></span>  <span data-ttu-id="b275f-248">從清單中選取 [取得執行身分連線]，在 [欄位路徑] 文字方塊中輸入 **TenantId**，然後按兩次 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b275f-248">Select **Get Run As Connection** from the list, in the **Field path** textbox type **TenantId**, and then click **OK** twice.</span></span>  
16. <span data-ttu-id="b275f-249">在 [程式庫] 控制項中，於搜尋文字方塊中輸入 **Set-AzureRmContext** 。</span><span class="sxs-lookup"><span data-stu-id="b275f-249">In the Library control, type **Set-AzureRmContext** in the search textbox.</span></span>
17. <span data-ttu-id="b275f-250">將 [Set-AzureRmContext]  加入至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-250">Add **Set-AzureRmContext** to the canvas.</span></span>
18. <span data-ttu-id="b275f-251">在畫布上選取 [Set-AzureRmContext]，然後在 [組態] 控制項窗格的 [標籤] 文字方塊中輸入 [指定訂用帳戶識別碼]。</span><span class="sxs-lookup"><span data-stu-id="b275f-251">On the canvas, select **Set-AzureRmContext** and in the Configuration control pane type **Specify Subscription Id** in the **Label** textbox.</span></span>
19. <span data-ttu-id="b275f-252">按一下 [參數]  ，隨即會顯示 [活動參數組態] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-252">Click **Parameters** and the Activity Parameter Configuration blade appears.</span></span>
20. <span data-ttu-id="b275f-253">**Set-AzureRmContext** 有多個參數集，因此我們必須先選取一個參數，我們才可以提供參數值。</span><span class="sxs-lookup"><span data-stu-id="b275f-253">**Set-AzureRmContext** has multiple parameter sets, so we need to select one before we can provide parameter values.</span></span>  <span data-ttu-id="b275f-254">按一下 [參數集]，然後選取 [SubscriptionId] 參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-254">Click **Parameter Set** and then select the **SubscriptionId** parameter set.</span></span>  
21. <span data-ttu-id="b275f-255">一旦您選取參數集，參數會在 [活動參數組態] 刀鋒視窗中顯示。</span><span class="sxs-lookup"><span data-stu-id="b275f-255">Once you select the parameter set, the parameters are displayed in the Activity Parameter Configuration blade.</span></span>  <span data-ttu-id="b275f-256">按一下 [SubscriptionID] </span><span class="sxs-lookup"><span data-stu-id="b275f-256">Click **SubscriptionID**</span></span>
22. <span data-ttu-id="b275f-257">在 [參數值] 刀鋒視窗中，針對 [資料來源] 選取 [變數資產]，接著在清單中選取 [AzureSubscriptionId]，然後按兩次 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b275f-257">In the Parameter Value blade, select **Variable Asset** for the **Data source** and select **AzureSubscriptionId** from the list and then click **OK** twice.</span></span>   
23. <span data-ttu-id="b275f-258">將滑鼠停留在 [登入 Azure]  ，直到圖形的底端出現圓形。</span><span class="sxs-lookup"><span data-stu-id="b275f-258">Hover over **Login to Azure** until a circle appears on the bottom of the shape.</span></span> <span data-ttu-id="b275f-259">按一下圓形，並將箭頭拖曳到 [指定訂用帳戶識別碼] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-259">Click the circle and drag the arrow to **Specify Subscription Id**.</span></span>

<span data-ttu-id="b275f-260">此時您的 Runbook 看起來應該像下面這樣︰</span><span class="sxs-lookup"><span data-stu-id="b275f-260">Your runbook should look like the following at this point:</span></span> <br>![Runbook 驗證組態](media/automation-first-runbook-graphical/runbook-auth-config.png)

## <a name="step-7---add-activity-to-start-a-virtual-machine"></a><span data-ttu-id="b275f-262">步驟 7 - 加入活動以啟動虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b275f-262">Step 7 - Add activity to start a virtual machine</span></span>
<span data-ttu-id="b275f-263">我們現在要新增 **Start-AzureRmVM** 活動，以啟動虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-263">Here we add a **Start-AzureRmVM** activity to start a virtual machine.</span></span>  <span data-ttu-id="b275f-264">您可以在您的 Azure 訂用帳戶中挑選任何虛擬機器，而現在您會將該名稱硬式編碼成 Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="b275f-264">You can pick any virtual machine in your Azure subscription, and for now you hardcode that name into the cmdlet.</span></span>

1. <span data-ttu-id="b275f-265">在 [程式庫] 控制項中，於搜尋文字方塊中輸入 **Start-AzureRm** 。</span><span class="sxs-lookup"><span data-stu-id="b275f-265">In the Library control, type **Start-AzureRm** in the search textbox.</span></span>
2. <span data-ttu-id="b275f-266">將 [Start-AzureRmVM] 新增至畫布，然後對它按一下並拖曳到 [指定訂用帳戶識別碼] 底下。</span><span class="sxs-lookup"><span data-stu-id="b275f-266">Add **Start-AzureRmVM** to the canvas and then click and drag it underneath **Specify Subscription Id**.</span></span>
3. <span data-ttu-id="b275f-267">將滑鼠停留在 [指定訂用帳戶識別碼]  ，直到圖形的底端出現圓形。</span><span class="sxs-lookup"><span data-stu-id="b275f-267">Hover over **Specify Subscription Id** until a circle appears on the bottom of the shape.</span></span>  <span data-ttu-id="b275f-268">按一下圓形，並將箭頭拖曳到 [Start-AzureRmVM] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-268">Click the circle and drag the arrow to **Start-AzureRmVM**.</span></span>
4. <span data-ttu-id="b275f-269">選取 [Start-AzureRmVM]。</span><span class="sxs-lookup"><span data-stu-id="b275f-269">Select **Start-AzureRmVM**.</span></span>  <span data-ttu-id="b275f-270">按一下 [參數]，然後按一下 [參數集] 以檢視 [Start-AzureRmVM] 的參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-270">Click **Parameters** and then **Parameter Set** to view the sets for **Start-AzureRmVM**.</span></span>  <span data-ttu-id="b275f-271">選取 [ResourceGroupNameParameterSetName]  參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-271">Select the **ResourceGroupNameParameterSetName** parameter set.</span></span> <span data-ttu-id="b275f-272">請注意，[ResourceGroupName] 和 [名稱] 旁邊具有驚嘆號。</span><span class="sxs-lookup"><span data-stu-id="b275f-272">Note that **ResourceGroupName** and **Name** have exclamation points next them.</span></span>  <span data-ttu-id="b275f-273">這表示它們是必要的參數。</span><span class="sxs-lookup"><span data-stu-id="b275f-273">This indicates that they are required parameters.</span></span>  <span data-ttu-id="b275f-274">也請注意這兩者應該是字串值。</span><span class="sxs-lookup"><span data-stu-id="b275f-274">Also note both expect string values.</span></span>
5. <span data-ttu-id="b275f-275">選取 [Start-AzureRmVM] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-275">Select **Name**.</span></span>  <span data-ttu-id="b275f-276">在 [資料來源] 中選取 [PowerShell 運算式]，並輸入用雙引號括住的虛擬機器名稱，此為我們要用此 Runbook 啟動的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-276">Select **PowerShell expression** for the **Data source** and type in the name of the virtual machine surrounded with double quotes that we start with this runbook.</span></span>  <span data-ttu-id="b275f-277">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-277">Click **OK**.</span></span><br><span data-ttu-id="b275f-278">![Start-AzureRmVM 名稱參數值](media/automation-first-runbook-graphical/runbook-startvm-nameparameter.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-278">![Start-AzureRmVM Name Parameter Value](media/automation-first-runbook-graphical/runbook-startvm-nameparameter.png)</span></span>
6. <span data-ttu-id="b275f-279">選取 [ResourceGroupName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-279">Select **ResourceGroupName**.</span></span> <span data-ttu-id="b275f-280">針對 [資料來源] 使用 [PowerShell 運算式]，並輸入用雙引號括住的資源群組名稱。</span><span class="sxs-lookup"><span data-stu-id="b275f-280">Use **PowerShell expression** for the **Data source** and type in the name of the resource group surrounded with double quotes.</span></span>  <span data-ttu-id="b275f-281">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-281">Click **OK**.</span></span><br> <span data-ttu-id="b275f-282">![Start-AzureRmVM 參數](media/automation-first-runbook-graphical/startazurermvm-params.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-282">![Start-AzureRmVM Parameters](media/automation-first-runbook-graphical/startazurermvm-params.png)</span></span>
7. <span data-ttu-id="b275f-283">按一下 [測試] 窗格，如此我們可以測試 Runbook。</span><span class="sxs-lookup"><span data-stu-id="b275f-283">Click Test pane so that we can test the runbook.</span></span>
8. <span data-ttu-id="b275f-284">按一下 [開始]  以開始測試。</span><span class="sxs-lookup"><span data-stu-id="b275f-284">Click **Start** to start the test.</span></span>  <span data-ttu-id="b275f-285">當它完成時，請檢查虛擬機器已啟動。</span><span class="sxs-lookup"><span data-stu-id="b275f-285">Once it completes, check that the virtual machine was started.</span></span>

<span data-ttu-id="b275f-286">此時您的 Runbook 看起來應該像下面這樣︰</span><span class="sxs-lookup"><span data-stu-id="b275f-286">Your runbook should look like the following at this point:</span></span> <br>![Runbook 驗證組態](media/automation-first-runbook-graphical/runbook-startvm.png)

## <a name="step-8---add-additional-input-parameters-to-the-runbook"></a><span data-ttu-id="b275f-288">步驟 8 - 將其他輸入參數加入至 Runbook</span><span class="sxs-lookup"><span data-stu-id="b275f-288">Step 8 - Add additional input parameters to the runbook</span></span>
<span data-ttu-id="b275f-289">我們的 Runbook 目前會啟動在 **Start-AzureRmVM** Cmdlet 中指定之資源群組內的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-289">Our runbook currently starts the virtual machine in the resource group that we specified in the **Start-AzureRmVM** cmdlet.</span></span>  <span data-ttu-id="b275f-290">如果可以在啟動 Runbook 時指定這兩項，我們的 Runbook 會更有用。</span><span class="sxs-lookup"><span data-stu-id="b275f-290">Our runbook would be more useful if we could specify both when the runbook is started.</span></span>  <span data-ttu-id="b275f-291">我們現在會將輸入參數新增至 Runbook，以提供該功能。</span><span class="sxs-lookup"><span data-stu-id="b275f-291">We now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="b275f-292">按一下 [MyFirstRunbook] 窗格上的 [編輯] 來開啟圖形化編輯器。</span><span class="sxs-lookup"><span data-stu-id="b275f-292">Open the graphical editor by clicking **Edit** on the **MyFirstRunbook** pane.</span></span>
2. <span data-ttu-id="b275f-293">按一下 [輸入和輸出]，然後按一下 [新增輸入] 來開啟 [Runbook 輸入參數] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-293">Click **Input and output** and then **Add input** to open the Runbook Input Parameter pane.</span></span><br> <span data-ttu-id="b275f-294">![Runbook 輸入和輸出](media/automation-first-runbook-graphical/runbook-toolbar-InputandOutput-revised20165.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-294">![Runbook Input and Output](media/automation-first-runbook-graphical/runbook-toolbar-InputandOutput-revised20165.png)</span></span>
3. <span data-ttu-id="b275f-295">對 [ *名稱* ] 指定 **VMName**。</span><span class="sxs-lookup"><span data-stu-id="b275f-295">Specify *VMName* for the **Name**.</span></span>  <span data-ttu-id="b275f-296">將 [類型] 保留為 *string*，但將 [強制] 變更為 [是]。</span><span class="sxs-lookup"><span data-stu-id="b275f-296">Keep *string* for the **Type**, but change **Mandatory** to *Yes*.</span></span>  <span data-ttu-id="b275f-297">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-297">Click **OK**.</span></span>
4. <span data-ttu-id="b275f-298">建立稱為 ResourceGroupName 的第二個必要輸入參數，然後按一下 [確定] 來關閉 [輸入和輸出] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-298">Create a second mandatory input parameter called *ResourceGroupName* and then click **OK** to close the **Input and Output** pane.</span></span><br> <span data-ttu-id="b275f-299">![Runbook 輸入參數](media/automation-first-runbook-graphical/start-azurermvm-params-outputs.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-299">![Runbook Input Parameters](media/automation-first-runbook-graphical/start-azurermvm-params-outputs.png)</span></span>
5. <span data-ttu-id="b275f-300">選取 [Start-AzureRmVM] 活動，然後按一下 [參數]。</span><span class="sxs-lookup"><span data-stu-id="b275f-300">Select the **Start-AzureRmVM** activity and then click **Parameters**.</span></span>
6. <span data-ttu-id="b275f-301">將 [名稱] 的 [資料來源] 變更為 [Runbook 輸入]，然後選取 [VMName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-301">Change the **Data source** for **Name** to **Runbook input** and then select **VMName**.</span></span><br>
7. <span data-ttu-id="b275f-302">將 [ResourceGroupName] 的 [資料來源] 變更為 [Runbook 輸入]，然後選取 [ResourceGroupName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-302">Change the **Data source** for **ResourceGroupName** to **Runbook input** and then select **ResourceGroupName**.</span></span><br> <span data-ttu-id="b275f-303">![Start-AzureVM 參數](media/automation-first-runbook-graphical/start-azurermvm-params-runbookinput.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-303">![Start-AzureVM Parameters](media/automation-first-runbook-graphical/start-azurermvm-params-runbookinput.png)</span></span>
8. <span data-ttu-id="b275f-304">儲存 Runbook 並開啟 [測試] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-304">Save the runbook and open the Test pane.</span></span>  <span data-ttu-id="b275f-305">請注意，您現在可以提供測試中使用的兩個輸入變數的值。</span><span class="sxs-lookup"><span data-stu-id="b275f-305">Note that you can now provide values for the two input variables that you use in the test.</span></span>
9. <span data-ttu-id="b275f-306">關閉 [測試] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-306">Close the Test pane.</span></span>
10. <span data-ttu-id="b275f-307">按一下 [發佈]  來發行新版本的 Runbook。</span><span class="sxs-lookup"><span data-stu-id="b275f-307">Click **Publish** to publish the new version of the runbook.</span></span>
11. <span data-ttu-id="b275f-308">停止您在上一個步驟中啟動的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-308">Stop the virtual machine that you started in the previous step.</span></span>
12. <span data-ttu-id="b275f-309">按一下 [開始]  以啟動 Runbook。</span><span class="sxs-lookup"><span data-stu-id="b275f-309">Click **Start** to start the runbook.</span></span>  <span data-ttu-id="b275f-310">輸入您要啟動之虛擬機器的 [VMName] 和 [ResourceGroupName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-310">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br> <span data-ttu-id="b275f-311">![Start Runbook](media/automation-first-runbook-graphical/runbook-start-inputparams.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-311">![Start Runbook](media/automation-first-runbook-graphical/runbook-start-inputparams.png)</span></span>
13. <span data-ttu-id="b275f-312">Runbook 完成時，請檢查虛擬機器已啟動。</span><span class="sxs-lookup"><span data-stu-id="b275f-312">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="step-9---create-a-conditional-link"></a><span data-ttu-id="b275f-313">步驟 9 - 建立條件式連結</span><span class="sxs-lookup"><span data-stu-id="b275f-313">Step 9 - Create a conditional link</span></span>
<span data-ttu-id="b275f-314">我們現在會修改 Runbook，讓它只會在未啟動時嘗試啟動虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="b275f-314">We now modify the runbook so that it only attempts to start the virtual machine if it is not already started.</span></span>  <span data-ttu-id="b275f-315">您可將 **Get-AzureRmVM** Cmdlet 新增到可取得虛擬機器之執行個體層級狀態的 Runbook，來執行此動作。</span><span class="sxs-lookup"><span data-stu-id="b275f-315">You do this by adding a **Get-AzureRmVM** cmdlet to the runbook that gets the instance level status of the virtual machine.</span></span> <span data-ttu-id="b275f-316">然後您可新增名為 **取得狀態** 的 PowerShell 工作流程程式碼模組與 PowerShell 程式碼片段，來判斷虛擬機器的狀態是正在執行還是已停止。</span><span class="sxs-lookup"><span data-stu-id="b275f-316">Then you add a PowerShell Workflow code module called **Get Status** with a snippet of PowerShell code to determine if the virtual machine state is running or stopped.</span></span>  <span data-ttu-id="b275f-317">只有當目前的執行狀態為已停止時，**取得狀態**模組中的條件式連結才會執行 **Start-AzureRmVM**。</span><span class="sxs-lookup"><span data-stu-id="b275f-317">A conditional link from the **Get Status** module only runs **Start-AzureRmVM** if the current running state is stopped.</span></span>  <span data-ttu-id="b275f-318">最後我們會輸出訊息，通知您 VM 已成功啟動或未使用 PowerShell Write-Output Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="b275f-318">Finally, we output a message to inform you if the VM was successfully started or not using the PowerShell Write-Output cmdlet.</span></span>

1. <span data-ttu-id="b275f-319">在圖形化編輯器中開啟 **MyFirstRunbook** 。</span><span class="sxs-lookup"><span data-stu-id="b275f-319">Open **MyFirstRunbook** in the graphical editor.</span></span>
2. <span data-ttu-id="b275f-320">移除 [指定訂用帳戶識別碼] 和 [Start-AzureRmVM] 之間的連結，方法是按一下該連結，然後按 [刪除] 鍵。</span><span class="sxs-lookup"><span data-stu-id="b275f-320">Remove the link between **Specify Subscription Id** and **Start-AzureRmVM** by clicking on it and then pressing the *Delete* key.</span></span>
3. <span data-ttu-id="b275f-321">在 [程式庫] 控制項中，於搜尋文字方塊中輸入 **Get-AzureRm** 。</span><span class="sxs-lookup"><span data-stu-id="b275f-321">In the Library control, type **Get-AzureRm** in the search textbox.</span></span>
4. <span data-ttu-id="b275f-322">將 [Get-AzureRmVM]  加入至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-322">Add **Get-AzureRmVM** to the canvas.</span></span>
5. <span data-ttu-id="b275f-323">選取 [Get-AzureRmVM]，然後選取 [參數集] 以檢視 [Get-AzureRmVM] 的參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-323">Select **Get-AzureRmVM** and then **Parameter Set** to view the sets for **Get-AzureRmVM**.</span></span>  <span data-ttu-id="b275f-324">選取 [GetVirtualMachineInResourceGroupNameParamSet]  參數集。</span><span class="sxs-lookup"><span data-stu-id="b275f-324">Select the **GetVirtualMachineInResourceGroupNameParamSet** parameter set.</span></span>  <span data-ttu-id="b275f-325">請注意，[ResourceGroupName] 和 [名稱] 旁邊具有驚嘆號。</span><span class="sxs-lookup"><span data-stu-id="b275f-325">Note that **ResourceGroupName** and **Name** have exclamation points next them.</span></span>  <span data-ttu-id="b275f-326">這表示它們是必要的參數。</span><span class="sxs-lookup"><span data-stu-id="b275f-326">This indicates that they are required parameters.</span></span>  <span data-ttu-id="b275f-327">也請注意這兩者應該是字串值。</span><span class="sxs-lookup"><span data-stu-id="b275f-327">Also note both expect string values.</span></span>
6. <span data-ttu-id="b275f-328">在 [名稱] 的 [資料來源] 底下，選取 [Runbook 輸入]，然後選取 [VMName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-328">Under **Data source** for **Name**, select **Runbook input** and then select **VMName**.</span></span>  <span data-ttu-id="b275f-329">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-329">Click **OK**.</span></span>
7. <span data-ttu-id="b275f-330">在 [ResourceGroupName] 的 [資料來源] 底下，選取 [Runbook 輸入]，然後選取 [ResourceGroupName]。</span><span class="sxs-lookup"><span data-stu-id="b275f-330">Under **Data source** for **ResourceGroupName**, select **Runbook input** and then select **ResourceGroupName**.</span></span>  <span data-ttu-id="b275f-331">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-331">Click **OK**.</span></span>
8. <span data-ttu-id="b275f-332">在 [狀態] 的 [資料來源] 底下，選取 [常數值]，然後按一下 [True]。</span><span class="sxs-lookup"><span data-stu-id="b275f-332">Under **Data source** for **Status**, select **Constant value** and then click  **True**.</span></span>  <span data-ttu-id="b275f-333">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="b275f-333">Click **OK**.</span></span>  
9. <span data-ttu-id="b275f-334">建立從 [指定訂用帳戶識別碼] 至 [Get-AzureRmVM] 的連結。</span><span class="sxs-lookup"><span data-stu-id="b275f-334">Create a link from **Specify Subscription Id** to **Get-AzureRmVM**.</span></span>
10. <span data-ttu-id="b275f-335">在 [程式庫] 控制項中展開 [Runbook 控制項]，並將 [程式碼] 新增至畫布。</span><span class="sxs-lookup"><span data-stu-id="b275f-335">In the library control, expand **Runbook Control** and add **Code** to the canvas.</span></span>  
11. <span data-ttu-id="b275f-336">建立從 [Get-AzureRmVM] 至 [程式碼] 的連結。</span><span class="sxs-lookup"><span data-stu-id="b275f-336">Create a link from **Get-AzureRmVM** to **Code**.</span></span>  
12. <span data-ttu-id="b275f-337">按一下 [程式碼]，接著在 [組態] 窗格中將標籤變更為 [取得狀態]。</span><span class="sxs-lookup"><span data-stu-id="b275f-337">Click **Code** and in the Configuration pane, change label to **Get Status**.</span></span>
13. <span data-ttu-id="b275f-338">選取 [程式碼] 參數，隨即出現 [程式碼編輯器] 刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="b275f-338">Select **Code** parameter, and the **Code Editor** blade appears.</span></span>  
14. <span data-ttu-id="b275f-339">在程式碼編輯器中，貼上下列程式碼片段︰</span><span class="sxs-lookup"><span data-stu-id="b275f-339">In the code editor, paste the following snippet of code:</span></span>
    
     ```
     $StatusesJson = $ActivityOutput['Get-AzureRmVM'].StatusesText
     $Statuses = ConvertFrom-Json $StatusesJson
     $StatusOut =""
     foreach ($Status in $Statuses){
     if($Status.Code -eq "Powerstate/running"){$StatusOut = "running"}
     elseif ($Status.Code -eq "Powerstate/deallocated") {$StatusOut = "stopped"}
     }
     $StatusOut
     ```
15. <span data-ttu-id="b275f-340">建立從 [取得狀態] 至 [Start-AzureRmVM] 的連結。</span><span class="sxs-lookup"><span data-stu-id="b275f-340">Create a link from **Get Status** to **Start-AzureRmVM**.</span></span><br> <span data-ttu-id="b275f-341">![程式碼模組的 Runbook](media/automation-first-runbook-graphical/runbook-startvm-get-status.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-341">![Runbook with Code Module](media/automation-first-runbook-graphical/runbook-startvm-get-status.png)</span></span>  
16. <span data-ttu-id="b275f-342">選取該連結，然後在 [組態] 窗格中將 [套用條件] 變更為 [是]。</span><span class="sxs-lookup"><span data-stu-id="b275f-342">Select the link and in the Configuration pane, change **Apply condition** to **Yes**.</span></span>   <span data-ttu-id="b275f-343">請注意，連結轉變為虛線表示目標活動只有在條件解析為 true 時才會執行。</span><span class="sxs-lookup"><span data-stu-id="b275f-343">Note the link turns to a dashed line indicating that the target activity only runs if the condition resolves to true.</span></span>  
17. <span data-ttu-id="b275f-344">在 [條件運算式] 中輸入 $ActivityOutput['Get Status'] -eq "Stopped"。</span><span class="sxs-lookup"><span data-stu-id="b275f-344">For the **Condition expression**, type *$ActivityOutput['Get Status'] -eq "Stopped"*.</span></span>  <span data-ttu-id="b275f-345">**Start-AzureRmVM** 現在只會在虛擬機器停止時執行。</span><span class="sxs-lookup"><span data-stu-id="b275f-345">**Start-AzureRmVM** now only runs if the virtual machine is stopped.</span></span>
18. <span data-ttu-id="b275f-346">在 [程式庫] 控制項中，展開 **Cmdlet**，然後展開 **Microsoft.PowerShell.Utility**。</span><span class="sxs-lookup"><span data-stu-id="b275f-346">In the Library control, expand **Cmdlets** and then **Microsoft.PowerShell.Utility**.</span></span>
19. <span data-ttu-id="b275f-347">將 [Write-Output] 新增至畫布兩次。</span><span class="sxs-lookup"><span data-stu-id="b275f-347">Add **Write-Output** to the canvas twice.</span></span><br> <span data-ttu-id="b275f-348">![Write-Output 的 Runbook](media/automation-first-runbook-graphical/runbook-startazurermvm-complete.png)</span><span class="sxs-lookup"><span data-stu-id="b275f-348">![Runbook with Write-Output](media/automation-first-runbook-graphical/runbook-startazurermvm-complete.png)</span></span>
20. <span data-ttu-id="b275f-349">在第一個 [Write-Output] 控制項中按一下 [參數]，然後將 [標籤] 值變更為 [通知 VM 已啟動]。</span><span class="sxs-lookup"><span data-stu-id="b275f-349">On the first **Write-Output** control, click **Parameters** and change the **Label** value to *Notify VM Started*.</span></span>
21. <span data-ttu-id="b275f-350">在 [InputObject] 中將 [資料來源] 變更為 [PowerShell 運算式]，然後輸入運算式 "$VMName successfully started"。</span><span class="sxs-lookup"><span data-stu-id="b275f-350">For **InputObject**, change **Data source** to **PowerShell expression** and type in the expression *"$VMName successfully started."*.</span></span>
22. <span data-ttu-id="b275f-351">在第二個 [Write-Output] 控制項中按一下 [參數]，然後將 [標籤] 值變更為 [通知 VM 啟動失敗]</span><span class="sxs-lookup"><span data-stu-id="b275f-351">On the second **Write-Output** control, click **Parameters** and change the **Label** value to *Notify VM Start Failed*</span></span>
23. <span data-ttu-id="b275f-352">在 [InputObject] 中將 [資料來源] 變更為 [PowerShell 運算式]，然後輸入運算式 "$VMName could not start"。</span><span class="sxs-lookup"><span data-stu-id="b275f-352">For **InputObject**, change **Data source** to **PowerShell expression** and type in the expression *"$VMName could not start."*.</span></span>
24. <span data-ttu-id="b275f-353">建立從 [Start-AzureRmVM] 至 [通知 VM 已啟動] 和 [通知 VM 啟動失敗] 的連結。</span><span class="sxs-lookup"><span data-stu-id="b275f-353">Create a link from **Start-AzureRmVM** to **Notify VM Started** and **Notify VM Start Failed**.</span></span>
25. <span data-ttu-id="b275f-354">選取連往 [通知 VM 已啟動] 的連結並將 [套用條件] 變更為 [True]。</span><span class="sxs-lookup"><span data-stu-id="b275f-354">Select the link to **Notify VM Started** and change **Apply condition** to **True**.</span></span>
26. <span data-ttu-id="b275f-355">在 [條件運算式] 中輸入 $ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -eq $true。</span><span class="sxs-lookup"><span data-stu-id="b275f-355">For the **Condition expression**, type *$ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -eq $true*.</span></span>  <span data-ttu-id="b275f-356">此 Write-Output 控制項現在只會在虛擬機器已成功啟動時執行。</span><span class="sxs-lookup"><span data-stu-id="b275f-356">This Write-Output control now only runs if the virtual machine is successfully started.</span></span>
27. <span data-ttu-id="b275f-357">選取連往 [通知 VM 啟動失敗] 的連結並將 [套用條件] 變更為 [True]。</span><span class="sxs-lookup"><span data-stu-id="b275f-357">Select the link to **Notify VM Start Failed** and change **Apply condition** to **True**.</span></span>
28. <span data-ttu-id="b275f-358">在 [條件運算式] 中輸入 $ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -ne $true。</span><span class="sxs-lookup"><span data-stu-id="b275f-358">For the **Condition expression**, type *$ActivityOutput['Start-AzureRmVM'].IsSuccessStatusCode -ne $true*.</span></span>  <span data-ttu-id="b275f-359">此 Write-Output 控制項現在只會在虛擬機器未成功啟動時執行。</span><span class="sxs-lookup"><span data-stu-id="b275f-359">This Write-Output control now only runs if the virtual machine is not successfully started.</span></span>
29. <span data-ttu-id="b275f-360">儲存 Runbook 並開啟 [測試] 窗格。</span><span class="sxs-lookup"><span data-stu-id="b275f-360">Save the runbook and open the Test pane.</span></span>
30. <span data-ttu-id="b275f-361">在虛擬機器停止下啟動 Runbook，它應該會啟動。</span><span class="sxs-lookup"><span data-stu-id="b275f-361">Start the runbook with the virtual machine stopped, and it should start.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b275f-362">後續步驟</span><span class="sxs-lookup"><span data-stu-id="b275f-362">Next steps</span></span>
* <span data-ttu-id="b275f-363">若要深入了解圖形化編寫，請參閱 [Azure 自動化中的圖形化編寫](automation-graphical-authoring-intro.md)</span><span class="sxs-lookup"><span data-stu-id="b275f-363">To learn more about Graphical Authoring, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md)</span></span>
* <span data-ttu-id="b275f-364">若要開始使用 PowerShell Runbook，請參閱 [我的第一個 PowerShell Runbook](automation-first-runbook-textual-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="b275f-364">To get started with PowerShell runbooks, see [My first PowerShell runbook](automation-first-runbook-textual-powershell.md)</span></span>
* <span data-ttu-id="b275f-365">若要開始使用 PowerShell 工作流程 Runbook，請參閱 [我的第一個 PowerShell 工作流程 Runbook](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="b275f-365">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>

