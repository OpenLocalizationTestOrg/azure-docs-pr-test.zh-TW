---
title: "Azure 自動化中的 aaaMy 第一個 PowerShell 工作流程 runbook |Microsoft 文件"
description: "教學課程會引導您進行 hello 建立、 測試和發佈使用 PowerShell 工作流程的簡單文字 runbook。"
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "powershell 工作流程, powershell 工作流程範例, 工作流程 powershell"
ms.assetid: 0002d7f7-e2b5-46e3-b5eb-4596b84fd526
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;bwren
ms.openlocfilehash: b5a34d363ef4865878f3f68119833367b5280f83
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="my-first-powershell-workflow-runbook"></a><span data-ttu-id="133be-104">我的第一個 PowerShell 工作流程 Runbook</span><span class="sxs-lookup"><span data-stu-id="133be-104">My first PowerShell Workflow runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="133be-105">圖形化</span><span class="sxs-lookup"><span data-stu-id="133be-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="133be-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="133be-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="133be-107">PowerShell 工作流程</span><span class="sxs-lookup"><span data-stu-id="133be-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="133be-108">本教學課程將引導您完成建立 hello [PowerShell 工作流程 runbook](automation-runbook-types.md#powershell-workflow-runbooks) Azure 自動化中。</span><span class="sxs-lookup"><span data-stu-id="133be-108">This tutorial walks you through hello creation of a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) in Azure Automation.</span></span> <span data-ttu-id="133be-109">我們會開始的簡單 runbook，我們測試發行時解釋如何 tootrack hello hello runbook 工作的狀態。</span><span class="sxs-lookup"><span data-stu-id="133be-109">We start with a simple runbook that we test and publish while explaining how tootrack hello status of hello runbook job.</span></span> <span data-ttu-id="133be-110">然後我們修改 hello runbook tooactually 管理在此情況下啟動 Azure 虛擬機器的 Azure 資源。</span><span class="sxs-lookup"><span data-stu-id="133be-110">Then we modify hello runbook tooactually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="133be-111">最後，我們設 hello 更強固的 runbook 新增 runbook 參數。</span><span class="sxs-lookup"><span data-stu-id="133be-111">Lastly we make hello runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="133be-112">必要條件</span><span class="sxs-lookup"><span data-stu-id="133be-112">Prerequisites</span></span>
<span data-ttu-id="133be-113">toocomplete 本教學課程中，您必須遵循的 hello:</span><span class="sxs-lookup"><span data-stu-id="133be-113">toocomplete this tutorial, you will need hello following:</span></span>

* <span data-ttu-id="133be-114">Azure 訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="133be-114">Azure subscription.</span></span> <span data-ttu-id="133be-115">如果您沒有這類帳戶，可以[啟用自己的 MSDN 訂戶權益<a href="/pricing/free-account/" target="_blank">或](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/)[註冊免費帳戶](https://azure.microsoft.com/free/)。</span><span class="sxs-lookup"><span data-stu-id="133be-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="133be-116">[自動化帳戶](automation-sec-configure-azure-runas-account.md)toohold hello runbook 並驗證 tooAzure 資源。</span><span class="sxs-lookup"><span data-stu-id="133be-116">[Automation account](automation-sec-configure-azure-runas-account.md) toohold hello runbook and authenticate tooAzure resources.</span></span>  <span data-ttu-id="133be-117">此帳戶必須具有權限 toostart，停止 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="133be-117">This account must have permission toostart and stop hello virtual machine.</span></span>
* <span data-ttu-id="133be-118">Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="133be-118">An Azure virtual machine.</span></span> <span data-ttu-id="133be-119">我們會停止並啟動這部電腦，因此它不該是生產 VM。</span><span class="sxs-lookup"><span data-stu-id="133be-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="133be-120">步驟 1 - 建立新的 Runbook</span><span class="sxs-lookup"><span data-stu-id="133be-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="133be-121">我們會先建立輸出的 hello 文字的簡單 runbook *Hello World*。</span><span class="sxs-lookup"><span data-stu-id="133be-121">We'll start by creating a simple runbook that outputs hello text *Hello World*.</span></span>

1. <span data-ttu-id="133be-122">在 hello Azure 入口網站，開啟您的自動化帳戶。</span><span class="sxs-lookup"><span data-stu-id="133be-122">In hello Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="133be-123">hello 自動化帳戶 頁面可讓您快速檢視 hello 資源此帳戶中。</span><span class="sxs-lookup"><span data-stu-id="133be-123">hello Automation account page gives you a quick view of hello resources in this account.</span></span> <span data-ttu-id="133be-124">您應該已經有一些資產。</span><span class="sxs-lookup"><span data-stu-id="133be-124">You should already have some assets.</span></span> <span data-ttu-id="133be-125">其中大部分都是會自動包含在新的自動化帳戶的 hello 模組。</span><span class="sxs-lookup"><span data-stu-id="133be-125">Most of those are hello modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="133be-126">您也應該擁有 hello 認證資產中所述 hello[必要條件](#prerequisites)。</span><span class="sxs-lookup"><span data-stu-id="133be-126">You should also have hello Credential asset that's mentioned in hello [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="133be-127">按一下 hello **Runbook**磚 tooopen hello runbook 的清單。</span><span class="sxs-lookup"><span data-stu-id="133be-127">Click on hello **Runbooks** tile tooopen hello list of runbooks.</span></span><br><br> <span data-ttu-id="133be-128">![Runbook 控制項](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="133be-128">![Runbooks control](media/automation-first-runbook-textual/runbooks-control-tiles.png)</span></span>
3. <span data-ttu-id="133be-129">建立新的 runbook 上 hello 即可**新增 runbook**  按鈕，然後**建立新的 runbook**。</span><span class="sxs-lookup"><span data-stu-id="133be-129">Create a new runbook by clicking on hello **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="133be-130">Hello runbook hello 命名*MyFirstRunbook 工作流程*。</span><span class="sxs-lookup"><span data-stu-id="133be-130">Give hello runbook hello name *MyFirstRunbook-Workflow*.</span></span>
5. <span data-ttu-id="133be-131">在此情況下，我們會 toocreate [PowerShell 工作流程 runbook](automation-runbook-types.md#powershell-workflow-runbooks)因此選取**Powershell 工作流程**如**Runbook 類型**。</span><span class="sxs-lookup"><span data-stu-id="133be-131">In this case, we're going toocreate a [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) so select **Powershell Workflow** for **Runbook type**.</span></span><br><br> <span data-ttu-id="133be-132">![新的 Runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span><span class="sxs-lookup"><span data-stu-id="133be-132">![New runbook](media/automation-first-runbook-textual/new-runbook-properties.png)</span></span>
6. <span data-ttu-id="133be-133">按一下**建立**toocreate hello runbook 和開啟 hello 文字編輯器。</span><span class="sxs-lookup"><span data-stu-id="133be-133">Click **Create** toocreate hello runbook and open hello textual editor.</span></span>

## <a name="step-2---add-code-toohello-runbook"></a><span data-ttu-id="133be-134">步驟 2-加入程式碼 toohello runbook</span><span class="sxs-lookup"><span data-stu-id="133be-134">Step 2 - Add code toohello runbook</span></span>
<span data-ttu-id="133be-135">您可以直接在 hello runbook 的其中一個類型程式碼或您可以從程式庫控制項 hello 選取 cmdlet、 runbook 和資產，但它們已加入 toohello runbook 與任何相關的參數。</span><span class="sxs-lookup"><span data-stu-id="133be-135">You can either type code directly into hello runbook, or you can select cmdlets, runbooks, and assets from hello Library control and have them added toohello runbook with any related parameters.</span></span> <span data-ttu-id="133be-136">這個逐步解說中，我們將直接輸入 hello runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-136">For this walkthrough, we'll type directly into hello runbook.</span></span>

1. <span data-ttu-id="133be-137">我們 runbook 目前是空的所需的 hello 與*工作流程*關鍵字、 hello 名稱我們的 runbook，以及將包封 hello 整個工作流程的 hello 括號。</span><span class="sxs-lookup"><span data-stu-id="133be-137">Our runbook is currently empty with only hello required *workflow* keyword, hello name of our runbook, and hello braces that will encase hello entire workflow.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   }
   ```
2. <span data-ttu-id="133be-138">在括號之間輸入「」 </span><span class="sxs-lookup"><span data-stu-id="133be-138">Type *Write-Output "Hello World."*</span></span> <span data-ttu-id="133be-139">hello 括弧。</span><span class="sxs-lookup"><span data-stu-id="133be-139">between hello braces.</span></span>

   ```
   Workflow MyFirstRunbook-Workflow
   {
   Write-Output "Hello World"
   }
   ```
3. <span data-ttu-id="133be-140">按一下以儲存 hello runbook**儲存**。</span><span class="sxs-lookup"><span data-stu-id="133be-140">Save hello runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="133be-141">![儲存 Runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="133be-141">![Save runbook](media/automation-first-runbook-textual/automation-runbook-edit-controls-save.png)</span></span>

## <a name="step-3---test-hello-runbook"></a><span data-ttu-id="133be-142">步驟 3-測試 hello runbook</span><span class="sxs-lookup"><span data-stu-id="133be-142">Step 3 - Test hello runbook</span></span>
<span data-ttu-id="133be-143">我們發行 hello runbook toomake 之前它可用在生產環境中，我們想要 tootest 它 toomake 確定它是否正常運作。</span><span class="sxs-lookup"><span data-stu-id="133be-143">Before we publish hello runbook toomake it available in production, we want tootest it toomake sure that it works properly.</span></span> <span data-ttu-id="133be-144">測試 Runbook 時，您會執行其 **草稿** 版本，並以互動方式檢視其輸出。</span><span class="sxs-lookup"><span data-stu-id="133be-144">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="133be-145">按一下**測試窗格**tooopen hello 測試窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-145">Click **Test pane** tooopen hello Test pane.</span></span><br><br> <span data-ttu-id="133be-146">![測試窗格](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="133be-146">![Test pane](media/automation-first-runbook-textual/automation-runbook-edit-controls-test.png)</span></span>
2. <span data-ttu-id="133be-147">按一下**啟動**toostart hello 測試。</span><span class="sxs-lookup"><span data-stu-id="133be-147">Click **Start** toostart hello test.</span></span> <span data-ttu-id="133be-148">這應該是 hello 才啟用選項。</span><span class="sxs-lookup"><span data-stu-id="133be-148">This should be hello only enabled option.</span></span>
3. <span data-ttu-id="133be-149">隨即會建立 [Runbook 工作](automation-runbook-execution.md) ，並顯示其狀態。</span><span class="sxs-lookup"><span data-stu-id="133be-149">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="133be-150">hello 工作狀態會做為啟動*排入佇列*表示它正在等待在 hello 雲端 toocome 可用的 runbook worker。</span><span class="sxs-lookup"><span data-stu-id="133be-150">hello job status will start as *Queued* indicating that it is waiting for a runbook worker in hello cloud toocome available.</span></span> <span data-ttu-id="133be-151">它會接著進入太*起始*背景工作宣告 hello 作業時，然後*執行*hello runbook 實際開始執行時。</span><span class="sxs-lookup"><span data-stu-id="133be-151">It will then move too*Starting* when a worker claims hello job, and then *Running* when hello runbook actually starts running.</span></span>  
4. <span data-ttu-id="133be-152">當 hello runbook 作業完成時，會顯示其輸出。</span><span class="sxs-lookup"><span data-stu-id="133be-152">When hello runbook job completes, its output is displayed.</span></span> <span data-ttu-id="133be-153">在我們的情況中，我們應該會看到 Hello World。</span><span class="sxs-lookup"><span data-stu-id="133be-153">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="133be-154">![](media/automation-first-runbook-textual/test-output-hello-world.png)</span><span class="sxs-lookup"><span data-stu-id="133be-154">![Hello World](media/automation-first-runbook-textual/test-output-hello-world.png)</span></span>
5. <span data-ttu-id="133be-155">關閉 hello 測試窗格 tooreturn toohello 畫布。</span><span class="sxs-lookup"><span data-stu-id="133be-155">Close hello Test pane tooreturn toohello canvas.</span></span>

## <a name="step-4---publish-and-start-hello-runbook"></a><span data-ttu-id="133be-156">步驟 4-發佈和啟動 hello runbook</span><span class="sxs-lookup"><span data-stu-id="133be-156">Step 4 - Publish and start hello runbook</span></span>
<span data-ttu-id="133be-157">我們剛建立的 hello runbook 仍處於草稿模式。</span><span class="sxs-lookup"><span data-stu-id="133be-157">hello runbook that we just created is still in Draft mode.</span></span> <span data-ttu-id="133be-158">我們需要 toopublish 前我們可以在生產環境中執行它。</span><span class="sxs-lookup"><span data-stu-id="133be-158">We need toopublish it before we can run it in production.</span></span> <span data-ttu-id="133be-159">當您發行的 runbook 時，您以覆寫現有已發佈版本 hello hello 草稿版本。</span><span class="sxs-lookup"><span data-stu-id="133be-159">When you publish a runbook, you overwrite hello existing Published version with hello Draft version.</span></span> <span data-ttu-id="133be-160">在我們的案例中，我們已發佈版本還沒有因為我們剛才建立 hello runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-160">In our case, we don't have a Published version yet because we just created hello runbook.</span></span>

1. <span data-ttu-id="133be-161">按一下**發行**toopublish hello runbook，然後**是**出現提示時。</span><span class="sxs-lookup"><span data-stu-id="133be-161">Click **Publish** toopublish hello runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="133be-162">![](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="133be-162">![Publish](media/automation-first-runbook-textual/automation-runbook-edit-controls-publish.png)</span></span>
2. <span data-ttu-id="133be-163">當您捲動左的 tooview hello runbook 在 hello **Runbook**窗格現在，它會顯示**撰寫狀態**的**發佈**。</span><span class="sxs-lookup"><span data-stu-id="133be-163">If you scroll left tooview hello runbook in hello **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="133be-164">捲軸背景 toohello 右 tooview hello 窗格**MyFirstRunbook 工作流程**。</span><span class="sxs-lookup"><span data-stu-id="133be-164">Scroll back toohello right tooview hello pane for **MyFirstRunbook-Workflow**.</span></span>  
   <span data-ttu-id="133be-165">hello hello 頂端的選項讓我們 toostart hello runbook、 排程在未來，hello toostart 或建立[webhook](automation-webhooks.md)讓它可以啟動透過 HTTP 呼叫。</span><span class="sxs-lookup"><span data-stu-id="133be-165">hello options across hello top allow us toostart hello runbook, schedule it toostart at some time in hello future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="133be-166">我們只是想 toostart hello runbook 因此按一下**啟動**然後**是**出現提示時。</span><span class="sxs-lookup"><span data-stu-id="133be-166">We just want toostart hello runbook so click **Start** and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="133be-167">![啟動 Runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="133be-167">![Start runbook](media/automation-first-runbook-textual/automation-runbook-controls-start.png)</span></span>
5. <span data-ttu-id="133be-168">工作窗格會開啟供 hello 剛才所建立的 runbook 工作。</span><span class="sxs-lookup"><span data-stu-id="133be-168">A job pane is opened for hello runbook job that we just created.</span></span> <span data-ttu-id="133be-169">我們可以關閉此窗格中，但在此情況下我們會維持開啟，因此我們可以觀看 hello 作業的進度。</span><span class="sxs-lookup"><span data-stu-id="133be-169">We can close this pane, but in this case we'll leave it open so we can watch hello job's progress.</span></span>
6. <span data-ttu-id="133be-170">中會顯示 hello 作業狀態**工作摘要**和相符項目 hello 我們了解我們所測試 hello runbook 時的狀態。</span><span class="sxs-lookup"><span data-stu-id="133be-170">hello job status is shown in **Job Summary** and matches hello statuses that we saw when we tested hello runbook.</span></span><br><br> <span data-ttu-id="133be-171">![工作摘要](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="133be-171">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-jobsummary.png)</span></span>
7. <span data-ttu-id="133be-172">一次 hello runbook 狀態顯示*已完成*，按一下 **輸出**。</span><span class="sxs-lookup"><span data-stu-id="133be-172">Once hello runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="133be-173">hello [輸出] 窗格會開啟，而且我們可以看到我們*Hello World*。</span><span class="sxs-lookup"><span data-stu-id="133be-173">hello Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="133be-174">![工作摘要](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="133be-174">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-outputtile.png)</span></span>  
8. <span data-ttu-id="133be-175">關閉 hello 輸出窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-175">Close hello Output pane.</span></span>
9. <span data-ttu-id="133be-176">按一下**所有記錄檔**hello runbook 工作的 tooopen hello 資料流 窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-176">Click **All Logs** tooopen hello Streams pane for hello runbook job.</span></span> <span data-ttu-id="133be-177">我們應該只會看到*Hello World*在 hello 輸出資料流，但這會顯示 runbook 作業，例如 Verbose 和錯誤的其他資料流 hello runbook 是否寫入 toothem。</span><span class="sxs-lookup"><span data-stu-id="133be-177">We should only see *Hello World* in hello output stream, but this can show other streams for a runbook job such as Verbose and Error if hello runbook writes toothem.</span></span><br><br> <span data-ttu-id="133be-178">![工作摘要](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="133be-178">![Job Summary](media/automation-first-runbook-textual/job-pane-status-blade-alllogstile.png)</span></span>
10. <span data-ttu-id="133be-179">關閉 hello 資料流窗格和 hello 工作窗格 tooreturn toohello MyFirstRunbook 窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-179">Close hello Streams pane and hello Job pane tooreturn toohello MyFirstRunbook pane.</span></span>
11. <span data-ttu-id="133be-180">按一下**作業**tooopen hello [工作] 窗格，針對此 runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-180">Click **Jobs** tooopen hello Jobs pane for this runbook.</span></span> <span data-ttu-id="133be-181">這樣就會列出所有 hello 這個 runbook 所建立的工作。</span><span class="sxs-lookup"><span data-stu-id="133be-181">This lists all of hello jobs created by this runbook.</span></span> <span data-ttu-id="133be-182">我們只能看到列出因為我們只執行 hello 作業一次一項作業。</span><span class="sxs-lookup"><span data-stu-id="133be-182">We should only see one job listed since we only ran hello job once.</span></span><br><br> <span data-ttu-id="133be-183">![作業](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="133be-183">![Jobs](media/automation-first-runbook-textual/runbook-control-job-tile.png)</span></span>
12. <span data-ttu-id="133be-184">您可以按一下此工作 tooopen hello 上相同，我們已開始 hello runbook 時，我們會檢視工作 窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-184">You can click on this job tooopen hello same Job pane that we viewed when we started hello runbook.</span></span> <span data-ttu-id="133be-185">這可讓您 toogo 回時間和檢視 hello 詳細資料中針對特定 runbook 所建立的任何作業。</span><span class="sxs-lookup"><span data-stu-id="133be-185">This allows you toogo back in time and view hello details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-toomanage-azure-resources"></a><span data-ttu-id="133be-186">步驟 5 – 新增驗證 toomanage Azure 資源</span><span class="sxs-lookup"><span data-stu-id="133be-186">Step 5 - Add authentication toomanage Azure resources</span></span>
<span data-ttu-id="133be-187">我們已經測試並發行我們 Runbook，但是到目前為止，它似乎並不實用。</span><span class="sxs-lookup"><span data-stu-id="133be-187">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="133be-188">我們想要 toohave 它管理的 Azure 資源。</span><span class="sxs-lookup"><span data-stu-id="133be-188">We want toohave it manage Azure resources.</span></span> <span data-ttu-id="133be-189">不是能 toodo 雖然除非我們驗證使用 hello 認證稱為 tooin hello[必要條件](#prerequisites)。</span><span class="sxs-lookup"><span data-stu-id="133be-189">It won't be able toodo that though unless we have it authenticate using hello credentials that are referred tooin hello [prerequisites](#prerequisites).</span></span> <span data-ttu-id="133be-190">這是以 hello**新增 AzureRMAccount** cmdlet。</span><span class="sxs-lookup"><span data-stu-id="133be-190">We do that with hello **Add-AzureRMAccount** cmdlet.</span></span>

1. <span data-ttu-id="133be-191">開啟的 hello 文字編輯器，依序按一下**編輯**hello MyFirstRunbook 工作流程 窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-191">Open hello textual editor by clicking **Edit** on hello MyFirstRunbook-Workflow pane.</span></span><br><br> <span data-ttu-id="133be-192">![編輯 Runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="133be-192">![Edit runbook](media/automation-first-runbook-textual/automation-runbook-controls-edit.png)</span></span>
2. <span data-ttu-id="133be-193">我們不需要 hello **Write-output**不再行，因此請繼續進行和刪除。</span><span class="sxs-lookup"><span data-stu-id="133be-193">We don't need hello **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="133be-194">Hello 游標放在空白行 hello 大括號之間。</span><span class="sxs-lookup"><span data-stu-id="133be-194">Position hello cursor on a blank line between hello braces.</span></span>
4. <span data-ttu-id="133be-195">輸入或複製並貼上下列程式碼將處理 hello 驗證與自動化執行身分帳戶的 hello:</span><span class="sxs-lookup"><span data-stu-id="133be-195">Type or copy and paste hello following code that will handle hello authentication with your Automation Run As account:</span></span>

   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
5. <span data-ttu-id="133be-196">按一下**測試窗格**，以便我們可以測試 hello runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-196">Click **Test pane** so that we can test hello runbook.</span></span>
6. <span data-ttu-id="133be-197">按一下**啟動**toostart hello 測試。</span><span class="sxs-lookup"><span data-stu-id="133be-197">Click **Start** toostart hello test.</span></span> <span data-ttu-id="133be-198">在完成時，您應該會收到類似輸出 toohello 之後，顯示您的帳戶的基本資訊。</span><span class="sxs-lookup"><span data-stu-id="133be-198">Once it completes, you should receive output similar toohello following, displaying basic information from your account.</span></span> <span data-ttu-id="133be-199">這可確認該 hello 認證有效。</span><span class="sxs-lookup"><span data-stu-id="133be-199">This confirms that hello credential is valid.</span></span><br><br> <span data-ttu-id="133be-200">![驗證](media/automation-first-runbook-textual/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="133be-200">![Authenticate](media/automation-first-runbook-textual/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-toostart-a-virtual-machine"></a><span data-ttu-id="133be-201">步驟 6-加入程式碼 toostart 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="133be-201">Step 6 - Add code toostart a virtual machine</span></span>
<span data-ttu-id="133be-202">既然我們 runbook 驗證 tooour Azure 訂用帳戶，我們可以管理資源。</span><span class="sxs-lookup"><span data-stu-id="133be-202">Now that our runbook is authenticating tooour Azure subscription, we can manage resources.</span></span> <span data-ttu-id="133be-203">我們加入命令 toostart 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="133be-203">We add a command toostart a virtual machine.</span></span> <span data-ttu-id="133be-204">您可以挑選您 Azure 訂用帳戶中的任何虛擬機器，且現在我們將硬式編碼的 hello runbook 中的名稱。</span><span class="sxs-lookup"><span data-stu-id="133be-204">You can pick any virtual machine in your Azure subscription, and for now we will be hardcoding that name in hello runbook.</span></span>

1. <span data-ttu-id="133be-205">之後*新增 AzureRmAccount*，型別*開始 AzureRmVM-名稱 '為 VMName' ResourceGroupName 'NameofResourceGroup'*提供 hello 名稱和 hello 虛擬機器 toostart 資源群組名稱。</span><span class="sxs-lookup"><span data-stu-id="133be-205">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing hello name and Resource Group name of hello virtual machine toostart.</span></span>  

   ```
   workflow MyFirstRunbook-Workflow
   {
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   }
   ```
2. <span data-ttu-id="133be-206">儲存 hello runbook，然後按一下**測試窗格**，以便我們可以測試它。</span><span class="sxs-lookup"><span data-stu-id="133be-206">Save hello runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="133be-207">按一下**啟動**toostart hello 測試。</span><span class="sxs-lookup"><span data-stu-id="133be-207">Click **Start** toostart hello test.</span></span> <span data-ttu-id="133be-208">在完成時，請檢查該 hello 虛擬機器已啟動。</span><span class="sxs-lookup"><span data-stu-id="133be-208">Once it completes, check that hello virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-toohello-runbook"></a><span data-ttu-id="133be-209">步驟 7-加入的輸入的參數 toohello runbook</span><span class="sxs-lookup"><span data-stu-id="133be-209">Step 7 - Add an input parameter toohello runbook</span></span>
<span data-ttu-id="133be-210">我們 runbook 目前開始 hello 虛擬機器，我們 hello runbook 中的硬式編碼，但如果 hello runbook 啟動時，我們無法指定 hello 虛擬機器會是更有用。</span><span class="sxs-lookup"><span data-stu-id="133be-210">Our runbook currently starts hello virtual machine that we hardcoded in hello runbook, but it would be more useful if we could specify hello virtual machine when hello runbook is started.</span></span> <span data-ttu-id="133be-211">我們現在會將輸入的參數 toohello runbook tooprovide 該功能。</span><span class="sxs-lookup"><span data-stu-id="133be-211">We will now add input parameters toohello runbook tooprovide that functionality.</span></span>

1. <span data-ttu-id="133be-212">加入參數*VMName*和*ResourceGroupName* toohello runbook，並使用這些變數與 hello**開始 AzureRmVM** cmdlet，如下列的 hello 範例所示。</span><span class="sxs-lookup"><span data-stu-id="133be-212">Add parameters for *VMName* and *ResourceGroupName* toohello runbook and use these variables with hello **Start-AzureRmVM** cmdlet as in hello example below.</span></span>

   ```
   workflow MyFirstRunbook-Workflow
   {
    Param(
     [string]$VMName,
     [string]$ResourceGroupName
    )  
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   }
   ```
2. <span data-ttu-id="133be-213">儲存 hello runbook 並開啟 hello 測試窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-213">Save hello runbook and open hello Test pane.</span></span> <span data-ttu-id="133be-214">請注意，您可以現在提供值給 hello hello 測試將使用的兩個輸入的變數。</span><span class="sxs-lookup"><span data-stu-id="133be-214">Note that you can now provide values for hello two input variables that will be used in hello test.</span></span>
3. <span data-ttu-id="133be-215">關閉 hello 測試窗格。</span><span class="sxs-lookup"><span data-stu-id="133be-215">Close hello Test pane.</span></span>
4. <span data-ttu-id="133be-216">按一下**發行**toopublish hello 新版 hello runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-216">Click **Publish** toopublish hello new version of hello runbook.</span></span>
5. <span data-ttu-id="133be-217">停止 hello hello 上一個步驟中啟動的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="133be-217">Stop hello virtual machine that you started in hello previous step.</span></span>
6. <span data-ttu-id="133be-218">按一下**啟動**toostart hello runbook。</span><span class="sxs-lookup"><span data-stu-id="133be-218">Click **Start** toostart hello runbook.</span></span> <span data-ttu-id="133be-219">型別在 hello **VMName**和**ResourceGroupName**要 toostart hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="133be-219">Type in hello **VMName** and **ResourceGroupName** for hello virtual machine that you're going toostart.</span></span><br><br> <span data-ttu-id="133be-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="133be-220">![Start Runbook](media/automation-first-runbook-textual/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="133be-221">Hello runbook 完成時，請檢查該 hello 虛擬機器已啟動。</span><span class="sxs-lookup"><span data-stu-id="133be-221">When hello runbook completes, check that hello virtual machine was started.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="133be-222">後續步驟</span><span class="sxs-lookup"><span data-stu-id="133be-222">Next steps</span></span>
* <span data-ttu-id="133be-223">tooget 開始使用圖形化 runbook，請參閱[我的第一個圖形化 runbook](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="133be-223">tooget started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="133be-224">請參閱 < 開始使用 PowerShell runbook tooget[我的第一個 PowerShell runbook](automation-first-runbook-textual-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="133be-224">tooget started with PowerShell runbooks, see [My first PowerShell runbook](automation-first-runbook-textual-powershell.md)</span></span>
* <span data-ttu-id="133be-225">toolearn 深入了解 runbook 類型、 其優點和限制，請參閱[Azure 自動化 runbook 類型](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="133be-225">toolearn more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="133be-226">如需 PowerShell 指令碼支援功能的詳細資訊，請參閱 [Azure 自動化中的原生 PowerShell 指令碼支援](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="133be-226">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>
