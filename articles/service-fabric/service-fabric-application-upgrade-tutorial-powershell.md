---
title: "使用 PowerShell aaaService 網狀架構應用程式升級 |Microsoft 文件"
description: "本文逐步部署 Service Fabric 應用程式、 變更 hello 程式碼，以及使用 PowerShell 升級所推出的 hello 體驗。"
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 9bc75748-96b0-49ca-8d8a-41fe08398f25
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: f31212264de45c3b257a0efafb75c10c279b989f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-application-upgrade-using-powershell"></a><span data-ttu-id="6c614-103">使用 PowerShell 進行 Service Fabric 應用程式升級</span><span class="sxs-lookup"><span data-stu-id="6c614-103">Service Fabric application upgrade using PowerShell</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="6c614-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="6c614-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="6c614-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6c614-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="6c614-106">hello 最常使用且建議的升級方法不受監視的 hello 輪流升級。</span><span class="sxs-lookup"><span data-stu-id="6c614-106">hello most frequently used and recommended upgrade approach is hello monitored rolling upgrade.</span></span>  <span data-ttu-id="6c614-107">Azure Service Fabric 監視 hello 健全狀況 hello 應用程式正在升級根據一組的健全狀況原則。</span><span class="sxs-lookup"><span data-stu-id="6c614-107">Azure Service Fabric monitors hello health of hello application being upgraded based on a set of health policies.</span></span> <span data-ttu-id="6c614-108">更新網域 (UD) 升級之後，Service Fabric 評估 hello 應用程式健全狀況並繼續進行下一個更新網域 toohello 或依據 hello 健全狀況原則而定的 hello 升級會失敗。</span><span class="sxs-lookup"><span data-stu-id="6c614-108">Once an update domain (UD) is upgraded, Service Fabric evaluates hello application health and either proceeds toohello next update domain or fails hello upgrade depending on hello health policies.</span></span>

<span data-ttu-id="6c614-109">受監視應用程式升級可使用受管理的 hello 或原生 Api，來執行 PowerShell 或 REST。</span><span class="sxs-lookup"><span data-stu-id="6c614-109">A monitored application upgrade can be performed using hello managed or native APIs, PowerShell, or REST.</span></span> <span data-ttu-id="6c614-110">如需有關使用 Visual Studio 來執行升級的說明，請參閱 [使用 Visual Studio 升級您的應用程式](service-fabric-application-upgrade-tutorial.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-110">For instructions on performing an upgrade using Visual Studio, see [Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md).</span></span>

<span data-ttu-id="6c614-111">服務網狀架構監視輪流升級，hello 應用程式系統管理員可以設定 hello 應用程式狀況良好，如果服務網狀架構會使用 toodetermine hello 健康情況評估原則。</span><span class="sxs-lookup"><span data-stu-id="6c614-111">With Service Fabric monitored rolling upgrades, hello application administrator can configure hello health evaluation policy that Service Fabric uses toodetermine if hello application is healthy.</span></span> <span data-ttu-id="6c614-112">此外，hello 系統管理員可以設定 hello 動作 toobe 時 hello 健全狀況評估失敗 （例如，執行自動回復。）本節逐步引導的受監視的其中一個會使用 PowerShell 的 hello SDK 範例的升級。</span><span class="sxs-lookup"><span data-stu-id="6c614-112">In addition, hello administrator can configure hello action toobe taken when hello health evaluation fails (for example, doing an automatic rollback.) This section walks through a monitored upgrade for one of hello SDK samples that uses PowerShell.</span></span> <span data-ttu-id="6c614-113">hello 下列 Microsoft Virtual Academy 影片會引導您完成應用程式升級：<center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span><span class="sxs-lookup"><span data-stu-id="6c614-113">hello following Microsoft Virtual Academy video also walks you through an app upgrade: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span></span>

## <a name="step-1-build-and-deploy-hello-visual-objects-sample"></a><span data-ttu-id="6c614-114">步驟 1： 建置並部署 hello 視覺物件範例</span><span class="sxs-lookup"><span data-stu-id="6c614-114">Step 1: Build and deploy hello Visual Objects sample</span></span>
<span data-ttu-id="6c614-115">建立及發行 hello 應用程式，以滑鼠右鍵按一下 hello 應用程式專案， **VisualObjectsApplication，** ，然後選取 hello**發行**命令。</span><span class="sxs-lookup"><span data-stu-id="6c614-115">Build and publish hello application by right-clicking on hello application project, **VisualObjectsApplication,** and selecting hello **Publish** command.</span></span>  <span data-ttu-id="6c614-116">如需詳細資訊，請參閱 [Service Fabric 應用程式升級教學課程](service-fabric-application-upgrade-tutorial.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-116">For more information, see [Service Fabric application upgrade tutorial](service-fabric-application-upgrade-tutorial.md).</span></span>  <span data-ttu-id="6c614-117">或者，您可以使用 PowerShell toodeploy 您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6c614-117">Alternatively, you can use PowerShell toodeploy your application.</span></span>

> [!NOTE]
> <span data-ttu-id="6c614-118">Hello Service Fabric 命令的任何可能在 PowerShell 中使用之前，您首先需要 tooconnect toohello 叢集使用 hello `Connect-ServiceFabricCluster` cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c614-118">Before any of hello Service Fabric commands may be used in PowerShell, you first need tooconnect toohello cluster by using hello `Connect-ServiceFabricCluster` cmdlet.</span></span> <span data-ttu-id="6c614-119">同樣地，它會假設該叢集具有已設定在本機電腦的 hello。</span><span class="sxs-lookup"><span data-stu-id="6c614-119">Similarly, it is assumed that hello Cluster has already been set up on your local machine.</span></span> <span data-ttu-id="6c614-120">請參閱 hello 文件[設定 Service Fabric 開發環境](service-fabric-get-started.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-120">See hello article on [setting up your Service Fabric development environment](service-fabric-get-started.md).</span></span>
> 
> 

<span data-ttu-id="6c614-121">在建置之後 hello Visual Studio 專案中的，您可以使用 hello PowerShell 命令[複製 ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) toocopy hello 應用程式封裝 toohello ImageStore。</span><span class="sxs-lookup"><span data-stu-id="6c614-121">After building hello project in Visual Studio, you can use hello PowerShell command [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) toocopy hello application package toohello ImageStore.</span></span> <span data-ttu-id="6c614-122">如果您想 tooverify hello 應用程式套件在本機，使用 hello[測試 ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c614-122">If you want tooverify hello app package locally, use hello [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span> <span data-ttu-id="6c614-123">hello 下一個步驟是 tooregister hello 應用程式 toohello Service Fabric 執行階段使用 hello[暫存器 ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c614-123">hello next step is tooregister hello application toohello Service Fabric runtime using hello [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) cmdlet.</span></span> <span data-ttu-id="6c614-124">hello 最後一個步驟是 toostart hello 應用程式的執行個體使用 hello[新增 ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="6c614-124">hello final step is toostart an instance of hello application by using hello [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span>  <span data-ttu-id="6c614-125">這三個步驟是類似 toousing hello**部署**Visual Studio 中的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="6c614-125">These three steps are analogous toousing hello **Deploy** menu item in Visual Studio.</span></span>

<span data-ttu-id="6c614-126">現在，您可以使用[Service Fabric 總管 tooview hello 叢集和 hello 應用程式](service-fabric-visualizing-your-cluster.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-126">Now, you can use [Service Fabric Explorer tooview hello cluster and hello application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="6c614-127">hello 應用程式有可巡覽的 tooin Internet Explorer 中輸入 web 服務[http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) hello 網址列中。</span><span class="sxs-lookup"><span data-stu-id="6c614-127">hello application has a web service that can be navigated tooin Internet Explorer by typing [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) in hello address bar.</span></span>  <span data-ttu-id="6c614-128">您應該會看到一些浮動囉 」 畫面中移動的視覺物件。</span><span class="sxs-lookup"><span data-stu-id="6c614-128">You should see some floating visual objects moving around in hello screen.</span></span>  <span data-ttu-id="6c614-129">此外，您可以使用[Get ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) toocheck hello 應用程式狀態。</span><span class="sxs-lookup"><span data-stu-id="6c614-129">Additionally, you can use [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) toocheck hello application status.</span></span>

## <a name="step-2-update-hello-visual-objects-sample"></a><span data-ttu-id="6c614-130">步驟 2： 更新 hello 視覺物件範例</span><span class="sxs-lookup"><span data-stu-id="6c614-130">Step 2: Update hello Visual Objects sample</span></span>
<span data-ttu-id="6c614-131">您可能會注意到，在步驟 1 中已部署的 hello 版本，hello 視覺物件不旋轉。</span><span class="sxs-lookup"><span data-stu-id="6c614-131">You might notice that with hello version that was deployed in Step 1, hello visual objects do not rotate.</span></span> <span data-ttu-id="6c614-132">讓我們來升級此應用程式 tooone，也旋轉 hello 視覺物件。</span><span class="sxs-lookup"><span data-stu-id="6c614-132">Let's upgrade this application tooone where hello visual objects also rotate.</span></span>

<span data-ttu-id="6c614-133">選取 hello VisualObjects 方案中的 hello VisualObjects.ActorService 專案，並開啟 hello StatefulVisualObjectActor.cs 檔案。</span><span class="sxs-lookup"><span data-stu-id="6c614-133">Select hello VisualObjects.ActorService project within hello VisualObjects solution, and open hello StatefulVisualObjectActor.cs file.</span></span> <span data-ttu-id="6c614-134">在該檔案中，瀏覽 toohello 方法`MoveObject`，標記為註解`this.State.Move()`，並取消註解`this.State.Move(true)`。</span><span class="sxs-lookup"><span data-stu-id="6c614-134">Within that file, navigate toohello method `MoveObject`, comment out `this.State.Move()`, and uncomment `this.State.Move(true)`.</span></span> <span data-ttu-id="6c614-135">Hello 服務升級後，這項變更會旋轉 hello 物件。</span><span class="sxs-lookup"><span data-stu-id="6c614-135">This change rotates hello objects after hello service is upgraded.</span></span>

<span data-ttu-id="6c614-136">我們還需要 tooupdate hello *ServiceManifest.xml* hello 專案檔 （在下目錄） **VisualObjects.ActorService**。</span><span class="sxs-lookup"><span data-stu-id="6c614-136">We also need tooupdate hello *ServiceManifest.xml* file (under PackageRoot) of hello project **VisualObjects.ActorService**.</span></span> <span data-ttu-id="6c614-137">更新 hello *CodePackage* hello 服務版本 too2.0，和 hello hello 中的對應行*ServiceManifest.xml*檔案。</span><span class="sxs-lookup"><span data-stu-id="6c614-137">Update hello *CodePackage* and hello service version too2.0, and hello corresponding lines in hello *ServiceManifest.xml* file.</span></span>
<span data-ttu-id="6c614-138">您可以使用 Visual Studio hello*編輯資訊清單檔案*選項之後，您以滑鼠右鍵按一下 hello 方案 toomake hello 資訊清單檔案變更。</span><span class="sxs-lookup"><span data-stu-id="6c614-138">You can use hello Visual Studio *Edit Manifest Files* option after you right-click on hello solution toomake hello manifest file changes.</span></span>

<span data-ttu-id="6c614-139">Hello 變更之後，hello 資訊清單看起來應該像 hello 下列 （反白顯示的部分會顯示 hello 變更）：</span><span class="sxs-lookup"><span data-stu-id="6c614-139">After hello changes are made, hello manifest should look like hello following (highlighted portions show hello changes):</span></span>

```xml
<ServiceManifestName="VisualObjects.ActorService" Version="2.0" xmlns="http://schemas.microsoft.com/2011/01/fabric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<CodePackageName="Code" Version="2.0">
```

<span data-ttu-id="6c614-140">現在 hello *ApplicationManifest.xml*檔案 (hello 下找到**VisualObjects**下 hello 專案**VisualObjects**方案) 是更新的 hello tooversion2.0**VisualObjects.ActorService**專案。</span><span class="sxs-lookup"><span data-stu-id="6c614-140">Now hello *ApplicationManifest.xml* file (found under hello **VisualObjects** project under hello **VisualObjects** solution) is updated tooversion 2.0 of hello **VisualObjects.ActorService** project.</span></span> <span data-ttu-id="6c614-141">此外，hello 應用程式版本已更新的 too2.0.0.0 從 1.0.0.0。</span><span class="sxs-lookup"><span data-stu-id="6c614-141">In addition, hello Application version is updated too2.0.0.0 from 1.0.0.0.</span></span> <span data-ttu-id="6c614-142">hello *ApplicationManifest.xml*應該看起來像 hello 下列程式碼片段：</span><span class="sxs-lookup"><span data-stu-id="6c614-142">hello *ApplicationManifest.xml* should look like hello following snippet:</span></span>

```xml
<ApplicationManifestxmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ApplicationTypeName="VisualObjects" ApplicationTypeVersion="2.0.0.0" xmlns="http://schemas.microsoft.com/2011/01/fabric">

 <ServiceManifestRefServiceManifestName="VisualObjects.ActorService" ServiceManifestVersion="2.0" />
```


<span data-ttu-id="6c614-143">現在，選取 只 hello 建置 hello 專案**ActorService**專案，然後以滑鼠右鍵按一下並選取 hello**建置**Visual Studio 中的選項。</span><span class="sxs-lookup"><span data-stu-id="6c614-143">Now, build hello project by selecting just hello **ActorService** project, and then right-clicking and selecting hello **Build** option in Visual Studio.</span></span> <span data-ttu-id="6c614-144">如果您選取**全部重建**，因為 hello 程式碼就已經變更，您應該更新 hello 適用於所有的專案版本。</span><span class="sxs-lookup"><span data-stu-id="6c614-144">If you select **Rebuild all**, you should update hello versions for all projects, since hello code would have changed.</span></span> <span data-ttu-id="6c614-145">接下來，讓我們套件 hello 已更新應用程式上按一下滑鼠右鍵***VisualObjectsApplication***、 選取 hello 服務網狀架構 功能表，並按一下**封裝**。</span><span class="sxs-lookup"><span data-stu-id="6c614-145">Next, let's package hello updated application by right-clicking on ***VisualObjectsApplication***, selecting hello Service Fabric Menu, and choosing **Package**.</span></span> <span data-ttu-id="6c614-146">這個動作會建立可部署的應用程式封裝。</span><span class="sxs-lookup"><span data-stu-id="6c614-146">This action creates an application package that can be deployed.</span></span>  <span data-ttu-id="6c614-147">更新的應用程式已準備好 toobe 部署。</span><span class="sxs-lookup"><span data-stu-id="6c614-147">Your updated application is ready toobe deployed.</span></span>

## <a name="step-3--decide-on-health-policies-and-upgrade-parameters"></a><span data-ttu-id="6c614-148">步驟 3：決定健康狀態原則並升級參數</span><span class="sxs-lookup"><span data-stu-id="6c614-148">Step 3:  Decide on health policies and upgrade parameters</span></span>
<span data-ttu-id="6c614-149">熟悉 hello[應用程式升級參數](service-fabric-application-upgrade-parameters.md)和 hello[升級程序](service-fabric-application-upgrade.md)tooget 充分了解各種升級參數、 逾時、 和健全狀況準則套用的 hello.</span><span class="sxs-lookup"><span data-stu-id="6c614-149">Familiarize yourself with hello [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and hello [upgrade process](service-fabric-application-upgrade.md) tooget a good understanding of hello various upgrade parameters, time-outs, and health criterion applied.</span></span> <span data-ttu-id="6c614-150">本逐步解說，hello 服務健全狀況評估準則是設定 toohello 預設 （及建議的） 值，表示所有服務和執行個體應該都是*狀況良好*hello 升級之後。</span><span class="sxs-lookup"><span data-stu-id="6c614-150">For this walkthrough, hello service health evaluation criterion is set toohello default (and recommended) values, which means that all services and instances should be *healthy* after hello upgrade.</span></span>  

<span data-ttu-id="6c614-151">不過，讓我們來增加 hello *HealthCheckStableDuration* too60 的秒數 （以便 hello 服務至少 20 秒才 hello 升級會繼續執行 toohello 接下來更新網域是狀況良好）。</span><span class="sxs-lookup"><span data-stu-id="6c614-151">However, let's increase hello *HealthCheckStableDuration* too60 seconds (so that hello services are healthy for at least 20 seconds before hello upgrade proceeds toohello next update domain).</span></span>  <span data-ttu-id="6c614-152">我們也設定 hello *UpgradeDomainTimeout* toobe 1200 秒和 hello *UpgradeTimeout* toobe 3000 秒。</span><span class="sxs-lookup"><span data-stu-id="6c614-152">Let's also set hello *UpgradeDomainTimeout* toobe 1200 seconds and hello *UpgradeTimeout* toobe 3000 seconds.</span></span>

<span data-ttu-id="6c614-153">最後，我們也設定 hello *UpgradeFailureAction* toorollback。</span><span class="sxs-lookup"><span data-stu-id="6c614-153">Finally, let's also set hello *UpgradeFailureAction* toorollback.</span></span> <span data-ttu-id="6c614-154">此選項需要 Service Fabric tooroll 後 hello 應用程式 toohello 舊版 hello 升級期間遇到任何問題。</span><span class="sxs-lookup"><span data-stu-id="6c614-154">This option requires Service Fabric tooroll back hello application toohello previous version if it encounters any issues during hello upgrade.</span></span> <span data-ttu-id="6c614-155">因此，當開始 （在步驟 4) 中的 hello 升級，hello 下列參數會指定：</span><span class="sxs-lookup"><span data-stu-id="6c614-155">Thus, when starting hello upgrade (in Step 4), hello following parameters are specified:</span></span>

<span data-ttu-id="6c614-156">FailureAction = Rollback</span><span class="sxs-lookup"><span data-stu-id="6c614-156">FailureAction = Rollback</span></span>

<span data-ttu-id="6c614-157">HealthCheckStableDurationSec = 60</span><span class="sxs-lookup"><span data-stu-id="6c614-157">HealthCheckStableDurationSec = 60</span></span>

<span data-ttu-id="6c614-158">UpgradeDomainTimeoutSec = 1200</span><span class="sxs-lookup"><span data-stu-id="6c614-158">UpgradeDomainTimeoutSec = 1200</span></span>

<span data-ttu-id="6c614-159">UpgradeTimeout = 3000</span><span class="sxs-lookup"><span data-stu-id="6c614-159">UpgradeTimeout = 3000</span></span>

## <a name="step-4-prepare-application-for-upgrade"></a><span data-ttu-id="6c614-160">步驟 4：準備應用程式以進行升級</span><span class="sxs-lookup"><span data-stu-id="6c614-160">Step 4: Prepare application for upgrade</span></span>
<span data-ttu-id="6c614-161">現在建立 hello 應用程式，並準備好 toobe 升級。</span><span class="sxs-lookup"><span data-stu-id="6c614-161">Now hello application is built and ready toobe upgraded.</span></span> <span data-ttu-id="6c614-162">如果您以系統管理員身分開啟 PowerShell 視窗並且輸入 [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps)，它應該會讓您知道它是已部署之 **VisualObjects** 的應用程式類型 1.0.0.0。</span><span class="sxs-lookup"><span data-stu-id="6c614-162">If you open up a PowerShell window as an administrator and type [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), it should let you know that it is application type 1.0.0.0 of **VisualObjects** that's been deployed.</span></span>  

<span data-ttu-id="6c614-163">hello 應用程式封裝會儲存在下 hello 下列相對路徑，您未壓縮 hello Service Fabric SDK 層*Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*。</span><span class="sxs-lookup"><span data-stu-id="6c614-163">hello application package is stored under hello following relative path where you uncompressed hello Service Fabric SDK - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span></span> <span data-ttu-id="6c614-164">您應該在該目錄中，儲存 hello 應用程式套件中找到 [封裝] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="6c614-164">You should find a "Package" folder in that directory, where hello application package is stored.</span></span> <span data-ttu-id="6c614-165">請檢查 hello 時間戳記 tooensure 是 hello （您可能需要適當地也 toomodify hello 路徑） 的最新組建。</span><span class="sxs-lookup"><span data-stu-id="6c614-165">Check hello timestamps tooensure that it is hello latest build (you may need toomodify hello paths appropriately as well).</span></span>

<span data-ttu-id="6c614-166">現在讓我們複製 hello 更新應用程式封裝 toohello 服務網狀架構 ImageStore （hello 應用程式封裝會儲存由 Service Fabric）。</span><span class="sxs-lookup"><span data-stu-id="6c614-166">Now let's copy hello updated application package toohello Service Fabric ImageStore (where hello application packages are stored by Service Fabric).</span></span> <span data-ttu-id="6c614-167">hello 參數*ApplicationPackagePathInImageStore*通知服務網狀架構，它可以在哪裡找到 hello 應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="6c614-167">hello parameter *ApplicationPackagePathInImageStore* informs Service Fabric where it can find hello application package.</span></span> <span data-ttu-id="6c614-168">我們已將更新的 hello 應用程式放在 「 VisualObjects\_V2 」 以 hello 下列命令 （您再適當地可能需要 toomodify 路徑）。</span><span class="sxs-lookup"><span data-stu-id="6c614-168">We have put hello updated application in "VisualObjects\_V2" with hello following command (you may need toomodify paths again appropriately).</span></span>

```powershell
Copy-ServiceFabricApplicationPackage  -ApplicationPackagePath .\Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug\Package
-ImageStoreConnectionString fabric:ImageStore   -ApplicationPackagePathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="6c614-169">hello 下一個步驟是以 Service Fabric，可以使用 hello 執行此應用程式的 tooregister[暫存器 ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps)命令：</span><span class="sxs-lookup"><span data-stu-id="6c614-169">hello next step is tooregister this application with Service Fabric, which can be performed using hello [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) command:</span></span>

```powershell
Register-ServiceFabricApplicationType -ApplicationPathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="6c614-170">如果 hello 前述的命令不成功，則可能需要重建所有的服務。</span><span class="sxs-lookup"><span data-stu-id="6c614-170">If hello preceding command doesn't succeed, it is likely that you need a rebuild of all services.</span></span> <span data-ttu-id="6c614-171">步驟 2 所述，您可能必須 tooupdate 您 web 服務版本。</span><span class="sxs-lookup"><span data-stu-id="6c614-171">As mentioned in Step 2, you may have tooupdate your WebService version as well.</span></span>

## <a name="step-5-start-hello-application-upgrade"></a><span data-ttu-id="6c614-172">步驟 5： 啟動 hello 應用程式升級</span><span class="sxs-lookup"><span data-stu-id="6c614-172">Step 5: Start hello application upgrade</span></span>
<span data-ttu-id="6c614-173">現在，我們所有的設定 toostart hello 應用程式升級使用 hello[開始 ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps)命令：</span><span class="sxs-lookup"><span data-stu-id="6c614-173">Now, we're all set toostart hello application upgrade by using hello [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) command:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/VisualObjects -ApplicationTypeVersion 2.0.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000   -FailureAction Rollback -Monitored
```


<span data-ttu-id="6c614-174">hello 應用程式名稱是 hello 相同所述 hello *ApplicationManifest.xml*檔案。</span><span class="sxs-lookup"><span data-stu-id="6c614-174">hello application name is hello same as it was described in hello *ApplicationManifest.xml* file.</span></span> <span data-ttu-id="6c614-175">服務網狀架構會使用哪一個應用程式會取得升級這個名稱 tooidentify。</span><span class="sxs-lookup"><span data-stu-id="6c614-175">Service Fabric uses this name tooidentify which application is getting upgraded.</span></span> <span data-ttu-id="6c614-176">如果您設定 hello 逾時 toobe 太短，可能會遇到失敗訊息狀態 hello 問題。</span><span class="sxs-lookup"><span data-stu-id="6c614-176">If you set hello time-outs toobe too short, you may encounter a failure message that states hello problem.</span></span> <span data-ttu-id="6c614-177">請參閱疑難排解一節，toohello 或增加 hello 逾時。</span><span class="sxs-lookup"><span data-stu-id="6c614-177">Refer toohello troubleshooting section, or increase hello time-outs.</span></span>

<span data-ttu-id="6c614-178">現在，hello 應用程式會繼續進行升級，您可以監視它使用 Service Fabric 總管，或使用 hello [Get ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) PowerShell 命令：</span><span class="sxs-lookup"><span data-stu-id="6c614-178">Now, as hello application upgrade proceeds, you can monitor it using Service Fabric Explorer, or by using hello [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) PowerShell command:</span></span> 

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/VisualObjects
```

<span data-ttu-id="6c614-179">在幾分鐘的時間，你使用 hello 上述 PowerShell 命令的 hello 狀態應該會在已升級所有的更新網域 （完成）。</span><span class="sxs-lookup"><span data-stu-id="6c614-179">In a few minutes, hello status that you got by using hello preceding PowerShell command, should state that all update domains were upgraded (completed).</span></span> <span data-ttu-id="6c614-180">您應該找出您的瀏覽器視窗中的 hello 視覺物件已經啟動旋轉 ！</span><span class="sxs-lookup"><span data-stu-id="6c614-180">And you should find that hello visual objects in your browser window have started rotating!</span></span>

<span data-ttu-id="6c614-181">您可以嘗試從第 2 版 tooversion 3，或從第 2 版 tooversion 做為練習 1 升級。</span><span class="sxs-lookup"><span data-stu-id="6c614-181">You can try upgrading from version 2 tooversion 3, or from version 2 tooversion 1 as an exercise.</span></span> <span data-ttu-id="6c614-182">從第 2 版 tooversion 1 移動也被視為升級。</span><span class="sxs-lookup"><span data-stu-id="6c614-182">Moving from version 2 tooversion 1 is also considered an upgrade.</span></span> <span data-ttu-id="6c614-183">玩逾時和健全狀況原則 toomake 自己熟悉它們。</span><span class="sxs-lookup"><span data-stu-id="6c614-183">Play with time-outs and health policies toomake yourself familiar with them.</span></span> <span data-ttu-id="6c614-184">當您部署 Azure 叢集概略 tooan 時，hello 參數需要 toobe 集適當。</span><span class="sxs-lookup"><span data-stu-id="6c614-184">When you are deploying tooan Azure cluster, hello parameters need toobe set appropriately.</span></span> <span data-ttu-id="6c614-185">以穩當的方式是很好的 tooset hello 逾時。</span><span class="sxs-lookup"><span data-stu-id="6c614-185">It is good tooset hello time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6c614-186">後續步驟</span><span class="sxs-lookup"><span data-stu-id="6c614-186">Next steps</span></span>
<span data-ttu-id="6c614-187">[使用 Visual Studio 升級您的應用程式](service-fabric-application-upgrade-tutorial.md) 將引導您完成使用 Visual Studio 進行應用程式升級的步驟。</span><span class="sxs-lookup"><span data-stu-id="6c614-187">[Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="6c614-188">使用 [升級參數](service-fabric-application-upgrade-parameters.md)來控制您應用程式的升級方式。</span><span class="sxs-lookup"><span data-stu-id="6c614-188">Control how your application upgrades by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="6c614-189">讓應用程式升級相容所學習如何 toouse[資料序列化](service-fabric-application-upgrade-data-serialization.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-189">Make your application upgrades compatible by learning how toouse [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="6c614-190">了解 toouse 把太升級您的應用程式時所進階的功能[進階主題](service-fabric-application-upgrade-advanced.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-190">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="6c614-191">藉由參考 toohello 步驟中的修正應用程式升級的一般問題[疑難排解應用程式升級](service-fabric-application-upgrade-troubleshooting.md)。</span><span class="sxs-lookup"><span data-stu-id="6c614-191">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

