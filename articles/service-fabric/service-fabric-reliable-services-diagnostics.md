---
title: "aaaStateful 可靠 Services 診斷 |Microsoft 文件"
description: "具狀態 Reliable Services 診斷功能"
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: ae0e8f99-69ab-4d45-896d-1fa80ed45659
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/30/2017
ms.author: dekapur
ms.openlocfilehash: 6200800b858957c06039d9af062633b12a446318
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="diagnostic-functionality-for-stateful-reliable-services"></a><span data-ttu-id="aac1c-103">具狀態 Reliable Services 診斷功能</span><span class="sxs-lookup"><span data-stu-id="aac1c-103">Diagnostic functionality for Stateful Reliable Services</span></span>
<span data-ttu-id="aac1c-104">hello 可設定狀態的可靠的服務 StatefulServiceBase 類別發出[EventSource](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.aspx)事件可能是使用的 toodebug hello 服務，提供深入了解如何運作，hello runtime，協助您進行疑難排解。</span><span class="sxs-lookup"><span data-stu-id="aac1c-104">hello Stateful Reliable Services StatefulServiceBase class emits [EventSource](https://msdn.microsoft.com/library/system.diagnostics.tracing.eventsource.aspx) events that can be used toodebug hello service, provide insights into how hello runtime is operating, and help with troubleshooting.</span></span>

## <a name="eventsource-events"></a><span data-ttu-id="aac1c-105">EventSource 事件</span><span class="sxs-lookup"><span data-stu-id="aac1c-105">EventSource events</span></span>
<span data-ttu-id="aac1c-106">hello 可設定狀態的可靠的服務 StatefulServiceBase 類別 hello EventSource 名稱是 「 Microsoft-ServiceFabric-服務 」。</span><span class="sxs-lookup"><span data-stu-id="aac1c-106">hello EventSource name for hello Stateful Reliable Services StatefulServiceBase class is "Microsoft-ServiceFabric-Services".</span></span> <span data-ttu-id="aac1c-107">這個事件來源的事件會出現在[診斷事件](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md#view-service-fabric-system-events-in-visual-studio)正在 hello 服務時，視窗[在 Visual Studio 中偵錯](service-fabric-debugging-your-application.md)。</span><span class="sxs-lookup"><span data-stu-id="aac1c-107">Events from this event source appear in the [Diagnostics Events](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md#view-service-fabric-system-events-in-visual-studio) window when hello service is being [debugged in Visual Studio](service-fabric-debugging-your-application.md).</span></span>

<span data-ttu-id="aac1c-108">可協助您收集和/或檢視 EventSource 事件之工具和技術的範例包括 [PerfView](http://www.microsoft.com/download/details.aspx?id=28567)、[Microsoft Azure 診斷](../cloud-services/cloud-services-dotnet-diagnostics.md)和 [Microsoft TraceEvent 程式庫](http://www.nuget.org/packages/Microsoft.Diagnostics.Tracing.TraceEvent)。</span><span class="sxs-lookup"><span data-stu-id="aac1c-108">Examples of tools and technologies that help in collecting and/or viewing EventSource events are [PerfView](http://www.microsoft.com/download/details.aspx?id=28567), [Microsoft Azure Diagnostics](../cloud-services/cloud-services-dotnet-diagnostics.md), and the [Microsoft TraceEvent Library](http://www.nuget.org/packages/Microsoft.Diagnostics.Tracing.TraceEvent).</span></span>

## <a name="events"></a><span data-ttu-id="aac1c-109">事件</span><span class="sxs-lookup"><span data-stu-id="aac1c-109">Events</span></span>
| <span data-ttu-id="aac1c-110">事件名稱</span><span class="sxs-lookup"><span data-stu-id="aac1c-110">Event name</span></span> | <span data-ttu-id="aac1c-111">事件識別碼</span><span class="sxs-lookup"><span data-stu-id="aac1c-111">Event ID</span></span> | <span data-ttu-id="aac1c-112">Level</span><span class="sxs-lookup"><span data-stu-id="aac1c-112">Level</span></span> | <span data-ttu-id="aac1c-113">事件說明</span><span class="sxs-lookup"><span data-stu-id="aac1c-113">Event description</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="aac1c-114">StatefulRunAsyncInvocation</span><span class="sxs-lookup"><span data-stu-id="aac1c-114">StatefulRunAsyncInvocation</span></span> |<span data-ttu-id="aac1c-115">1</span><span class="sxs-lookup"><span data-stu-id="aac1c-115">1</span></span> |<span data-ttu-id="aac1c-116">資訊</span><span class="sxs-lookup"><span data-stu-id="aac1c-116">Informational</span></span> |<span data-ttu-id="aac1c-117">啟動服務 RunAsync 工作時發出</span><span class="sxs-lookup"><span data-stu-id="aac1c-117">Emitted when service RunAsync task is started</span></span> |
| <span data-ttu-id="aac1c-118">StatefulRunAsyncCancellation</span><span class="sxs-lookup"><span data-stu-id="aac1c-118">StatefulRunAsyncCancellation</span></span> |<span data-ttu-id="aac1c-119">2</span><span class="sxs-lookup"><span data-stu-id="aac1c-119">2</span></span> |<span data-ttu-id="aac1c-120">資訊</span><span class="sxs-lookup"><span data-stu-id="aac1c-120">Informational</span></span> |<span data-ttu-id="aac1c-121">取消服務 RunAsync 工作時發出</span><span class="sxs-lookup"><span data-stu-id="aac1c-121">Emitted when service RunAsync task is cancelled</span></span> |
| <span data-ttu-id="aac1c-122">StatefulRunAsyncCompletion</span><span class="sxs-lookup"><span data-stu-id="aac1c-122">StatefulRunAsyncCompletion</span></span> |<span data-ttu-id="aac1c-123">3</span><span class="sxs-lookup"><span data-stu-id="aac1c-123">3</span></span> |<span data-ttu-id="aac1c-124">資訊</span><span class="sxs-lookup"><span data-stu-id="aac1c-124">Informational</span></span> |<span data-ttu-id="aac1c-125">完成服務 RunAsync 工作時發出</span><span class="sxs-lookup"><span data-stu-id="aac1c-125">Emitted when service RunAsync task is completed</span></span> |
| <span data-ttu-id="aac1c-126">StatefulRunAsyncSlowCancellation</span><span class="sxs-lookup"><span data-stu-id="aac1c-126">StatefulRunAsyncSlowCancellation</span></span> |<span data-ttu-id="aac1c-127">4</span><span class="sxs-lookup"><span data-stu-id="aac1c-127">4</span></span> |<span data-ttu-id="aac1c-128">警告</span><span class="sxs-lookup"><span data-stu-id="aac1c-128">Warning</span></span> |<span data-ttu-id="aac1c-129">當服務 RunAsync 工作花費過長 toocomplete 取消時，就發出</span><span class="sxs-lookup"><span data-stu-id="aac1c-129">Emitted when service RunAsync task takes too long toocomplete cancellation</span></span> |
| <span data-ttu-id="aac1c-130">StatefulRunAsyncFailure</span><span class="sxs-lookup"><span data-stu-id="aac1c-130">StatefulRunAsyncFailure</span></span> |<span data-ttu-id="aac1c-131">5</span><span class="sxs-lookup"><span data-stu-id="aac1c-131">5</span></span> |<span data-ttu-id="aac1c-132">錯誤</span><span class="sxs-lookup"><span data-stu-id="aac1c-132">Error</span></span> |<span data-ttu-id="aac1c-133">服務 RunAsync 工作擲回例外狀況時發出</span><span class="sxs-lookup"><span data-stu-id="aac1c-133">Emitted when service RunAsync task throws an exception</span></span> |

## <a name="interpret-events"></a><span data-ttu-id="aac1c-134">解譯事件</span><span class="sxs-lookup"><span data-stu-id="aac1c-134">Interpret events</span></span>
<span data-ttu-id="aac1c-135">StatefulRunAsyncInvocation、 StatefulRunAsyncCompletion 和 StatefulRunAsyncCancellation 事件會很有用的 toohello 服務寫入器 toounderstand hello 的生命週期服務--，以及當啟動、 已取消，或已完成服務的 hello 時間.</span><span class="sxs-lookup"><span data-stu-id="aac1c-135">StatefulRunAsyncInvocation, StatefulRunAsyncCompletion, and StatefulRunAsyncCancellation events are useful toohello service writer toounderstand hello lifecycle of a service--as well as hello timing for when a service is started, cancelled, or completed.</span></span> <span data-ttu-id="aac1c-136">偵錯服務問題或了解 hello 服務生命週期時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="aac1c-136">This can be useful when debugging service issues or understanding hello service lifecycle.</span></span>

<span data-ttu-id="aac1c-137">服務寫入器應該特別注意 tooStatefulRunAsyncSlowCancellation 和 StatefulRunAsyncFailure 事件，因為它們表示 hello 服務的問題。</span><span class="sxs-lookup"><span data-stu-id="aac1c-137">Service writers should pay close attention tooStatefulRunAsyncSlowCancellation and StatefulRunAsyncFailure events because they indicate issues with hello service.</span></span>

<span data-ttu-id="aac1c-138">只要 hello 服務 RunAsync() 工作擲回例外狀況，就會發出 StatefulRunAsyncFailure。</span><span class="sxs-lookup"><span data-stu-id="aac1c-138">StatefulRunAsyncFailure is emitted whenever hello service RunAsync() task throws an exception.</span></span> <span data-ttu-id="aac1c-139">通常，擲回例外狀況表示發生錯誤或 hello 服務中的 bug。</span><span class="sxs-lookup"><span data-stu-id="aac1c-139">Typically, an exception thrown indicates an error or bug in hello service.</span></span> <span data-ttu-id="aac1c-140">此外，hello 例外狀況會導致 hello 服務 toofail，因此它是移動的 tooa 不同節點。</span><span class="sxs-lookup"><span data-stu-id="aac1c-140">Additionally, hello exception causes hello service toofail, so it is moved tooa different node.</span></span> <span data-ttu-id="aac1c-141">這是很昂貴的作業，並 hello 服務移動時，可以延遲傳入的要求。</span><span class="sxs-lookup"><span data-stu-id="aac1c-141">This can be an expensive operation and can delay incoming requests while hello service is moved.</span></span> <span data-ttu-id="aac1c-142">服務寫入器應該判斷 hello hello 例外狀況的原因，可能的話，請減少這種情況。</span><span class="sxs-lookup"><span data-stu-id="aac1c-142">Service writers should determine hello cause of hello exception and, if possible, mitigate it.</span></span>

<span data-ttu-id="aac1c-143">只要 hello RunAsync 工作的取消要求費時超過 4 秒，就會發出 StatefulRunAsyncSlowCancellation。</span><span class="sxs-lookup"><span data-stu-id="aac1c-143">StatefulRunAsyncSlowCancellation is emitted whenever a cancellation request for hello RunAsync task takes longer than four seconds.</span></span> <span data-ttu-id="aac1c-144">當服務會花太長 toocomplete 取消作業時，它會影響 hello hello 服務 toobe 快速地重新啟動另一個節點上的能力。</span><span class="sxs-lookup"><span data-stu-id="aac1c-144">When a service takes too long toocomplete cancellation, it impacts hello ability for hello service toobe quickly restarted on another node.</span></span> <span data-ttu-id="aac1c-145">這可能會影響 hello hello 服務的整體可用性。</span><span class="sxs-lookup"><span data-stu-id="aac1c-145">This may impact hello overall availability of hello service.</span></span>

## <a name="next-steps"></a><span data-ttu-id="aac1c-146">後續步驟</span><span class="sxs-lookup"><span data-stu-id="aac1c-146">Next steps</span></span>
* [<span data-ttu-id="aac1c-147">PerfView 中的 EventSource 提供者</span><span class="sxs-lookup"><span data-stu-id="aac1c-147">EventSource providers in PerfView</span></span>](https://blogs.msdn.microsoft.com/vancem/2012/07/09/introduction-tutorial-logging-etw-events-in-c-system-diagnostics-tracing-eventsource/)
