---
title: "aaaAutomate Azure Service Fabric 應用程式管理 |Microsoft 文件"
description: "藉由使用 PowerShell 來部署、升級、測試和移除 Service Fabric 應用程式。"
services: service-fabric
documentationcenter: .net
author: rwike77
manager: timlt
editor: 
ms.assetid: f03f4294-571d-4262-8a77-cc8b481b959d
ms.service: service-fabric
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/16/2017
ms.author: ryanwi
redirect_url: /azure/service-fabric/service-fabric-deploy-remove-applications
ms.openlocfilehash: a64a39dbee26be8ac15fee767a90fd06bfe4b896
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="automate-hello-application-lifecycle-using-powershell"></a><span data-ttu-id="ec224-103">自動化 hello 應用程式生命週期使用 PowerShell</span><span class="sxs-lookup"><span data-stu-id="ec224-103">Automate hello application lifecycle using PowerShell</span></span>
<span data-ttu-id="ec224-104">Hello 的許多層面[Service Fabric 應用程式生命週期](service-fabric-application-lifecycle.md)可以自動化。</span><span class="sxs-lookup"><span data-stu-id="ec224-104">Many aspects of hello [Service Fabric application lifecycle](service-fabric-application-lifecycle.md) can be automated.</span></span>  <span data-ttu-id="ec224-105">本文示範 toouse PowerShell tooautomate 常見的部署、 升級、 移除和測試 Azure Service Fabric 應用程式的工作。</span><span class="sxs-lookup"><span data-stu-id="ec224-105">This article shows how toouse PowerShell tooautomate common tasks for deploying, upgrading, removing, and testing Azure Service Fabric applications.</span></span>  <span data-ttu-id="ec224-106">也可使用應用程式管理的 Managed 和 HTTP API。</span><span class="sxs-lookup"><span data-stu-id="ec224-106">Managed and HTTP APIs for app management are also available.</span></span> <span data-ttu-id="ec224-107">如需詳細資訊，請參閱 [應用程式生命週期](service-fabric-application-lifecycle.md) 。</span><span class="sxs-lookup"><span data-stu-id="ec224-107">See [app lifecycle](service-fabric-application-lifecycle.md) for more information.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="ec224-108">必要條件</span><span class="sxs-lookup"><span data-stu-id="ec224-108">Prerequisites</span></span>
<span data-ttu-id="ec224-109">在移動 toohello hello 文件中的工作之前，務必：</span><span class="sxs-lookup"><span data-stu-id="ec224-109">Before you move on toohello tasks in hello article, be sure to:</span></span>

* <span data-ttu-id="ec224-110">讓您熟悉 hello 中所述的 Service Fabric 概念[Service Fabric 的技術概觀](service-fabric-technical-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="ec224-110">Get familiar with hello Service Fabric concepts described in [Technical overview of Service Fabric](service-fabric-technical-overview.md).</span></span>
* <span data-ttu-id="ec224-111">[安裝 hello 執行階段、 SDK 和工具](service-fabric-get-started.md)，這也會安裝 hello **ServiceFabric** PowerShell 模組。</span><span class="sxs-lookup"><span data-stu-id="ec224-111">[Install hello runtime, SDK, and tools](service-fabric-get-started.md), which also installs hello **ServiceFabric** PowerShell module.</span></span>
* <span data-ttu-id="ec224-112">[啟用 PowerShell 指令碼執行](service-fabric-get-started.md#enable-powershell-script-execution)。</span><span class="sxs-lookup"><span data-stu-id="ec224-112">[Enable PowerShell script execution](service-fabric-get-started.md#enable-powershell-script-execution).</span></span>
* <span data-ttu-id="ec224-113">啟動本機叢集。</span><span class="sxs-lookup"><span data-stu-id="ec224-113">Start a local cluster.</span></span>  <span data-ttu-id="ec224-114">啟動新的 PowerShell 視窗，以系統管理員，並從 hello SDK 資料夾執行 hello 叢集安裝指令碼：`& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span><span class="sxs-lookup"><span data-stu-id="ec224-114">Launch a new PowerShell window as an administrator and then run hello cluster setup script from hello SDK folder: `& "$ENV:ProgramFiles\Microsoft SDKs\Service Fabric\ClusterSetup\DevClusterSetup.ps1"`</span></span>
* <span data-ttu-id="ec224-115">在本文中執行任何 PowerShell 命令之前，先 toohello 本機 Service Fabric 叢集使用連線[Connect-servicefabriccluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps):`Connect-ServiceFabricCluster localhost:19000`</span><span class="sxs-lookup"><span data-stu-id="ec224-115">Before you run any PowerShell commands in this article, first connect toohello local Service Fabric cluster by using [Connect-ServiceFabricCluster](/powershell/module/servicefabric/connect-servicefabriccluster?view=azureservicefabricps): `Connect-ServiceFabricCluster localhost:19000`</span></span>
* <span data-ttu-id="ec224-116">下列工作的 hello 需要 v1 應用程式封裝 toodeploy 和 v2 應用程式封裝進行升級。</span><span class="sxs-lookup"><span data-stu-id="ec224-116">hello following tasks require a v1 application package toodeploy and a v2 application package for upgrade.</span></span> <span data-ttu-id="ec224-117">下載 hello [ **WordCount**範例應用程式](http://aka.ms/servicefabricsamples)（位於 hello 快速入門範例）。</span><span class="sxs-lookup"><span data-stu-id="ec224-117">Download hello [**WordCount** sample application](http://aka.ms/servicefabricsamples) (located in hello Getting Started samples).</span></span> <span data-ttu-id="ec224-118">建置並封裝在 Visual Studio 中的 hello 應用程式 (以滑鼠右鍵按一下**WordCount**在方案總管，然後選取**封裝**)。</span><span class="sxs-lookup"><span data-stu-id="ec224-118">Build and package hello application in Visual Studio (right-click on **WordCount** in Solution Explorer and select **Package**).</span></span> <span data-ttu-id="ec224-119">Hello v1 封裝副本中的`C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug`太`C:\Temp\WordCount`。</span><span class="sxs-lookup"><span data-stu-id="ec224-119">Copy hello v1 package in `C:\ServiceFabricSamples\Services\WordCount\WordCount\pkg\Debug` too`C:\Temp\WordCount`.</span></span> <span data-ttu-id="ec224-120">複製`C:\Temp\WordCount`太`C:\Temp\WordCountV2`，建立 hello v2 應用程式封裝的升級。</span><span class="sxs-lookup"><span data-stu-id="ec224-120">Copy `C:\Temp\WordCount` too`C:\Temp\WordCountV2`, creating hello v2 application package for upgrade.</span></span> <span data-ttu-id="ec224-121">在文字編輯器中開啟 `C:\Temp\WordCountV2\ApplicationManifest.xml`。</span><span class="sxs-lookup"><span data-stu-id="ec224-121">Open `C:\Temp\WordCountV2\ApplicationManifest.xml` in a text editor.</span></span> <span data-ttu-id="ec224-122">在 hello **Secretscertificate**元素中，變更 hello **ApplicationTypeVersion**太屬性從 「 1.0.0""2.0.0"tooupdate hello 應用程式版本號碼。</span><span class="sxs-lookup"><span data-stu-id="ec224-122">In hello **ApplicationManifest** element, change hello **ApplicationTypeVersion** attribute from "1.0.0" too"2.0.0" tooupdate hello app version number.</span></span> <span data-ttu-id="ec224-123">儲存變更的 hello ApplicationManifest.xml 檔案。</span><span class="sxs-lookup"><span data-stu-id="ec224-123">Save hello changed ApplicationManifest.xml file.</span></span>

## <a name="task-deploy-a-service-fabric-application"></a><span data-ttu-id="ec224-124">工作：部署 Service Fabric 應用程式</span><span class="sxs-lookup"><span data-stu-id="ec224-124">Task: Deploy a Service Fabric application</span></span>
<span data-ttu-id="ec224-125">您已建置並封裝 hello 應用程式 （或下載 hello 應用程式封裝） 之後，您可以部署到本機的 Service Fabric 叢集中的 hello 應用程式。</span><span class="sxs-lookup"><span data-stu-id="ec224-125">After you've built and packaged hello application (or downloaded hello application package), you can deploy hello application into a local Service Fabric cluster.</span></span> <span data-ttu-id="ec224-126">如果部署涉及 hello 應用程式套件上傳、 註冊 hello 應用程式類型，以及建立 hello 應用程式執行個體。</span><span class="sxs-lookup"><span data-stu-id="ec224-126">Deployment involves uploading hello application package, registering hello application type, and creating hello application instance.</span></span> <span data-ttu-id="ec224-127">使用此區段 toodeploy 新的應用程式 tooa 叢集 hello 指示。</span><span class="sxs-lookup"><span data-stu-id="ec224-127">Use hello instructions in this section toodeploy a new application tooa cluster.</span></span>

### <a name="step-1-upload-hello-application-package"></a><span data-ttu-id="ec224-128">步驟 1： 上傳 hello 應用程式套件</span><span class="sxs-lookup"><span data-stu-id="ec224-128">Step 1: Upload hello application package</span></span>
<span data-ttu-id="ec224-129">上傳 hello 應用程式封裝 toohello 映像存放區將它放在位置存取 toointernal Service Fabric 元件。</span><span class="sxs-lookup"><span data-stu-id="ec224-129">Uploading hello application package toohello image store puts it in a location accessible toointernal Service Fabric components.</span></span>  <span data-ttu-id="ec224-130">hello 應用程式套件包含 hello 必要應用程式資訊清單中，服務資訊清單，然後程式碼中，設定和資料封裝 toocreate hello 應用程式及服務執行個體。</span><span class="sxs-lookup"><span data-stu-id="ec224-130">hello application package contains hello necessary application manifest, service manifests, and code, configuration, and data package(s) toocreate hello application and service instances.</span></span> <span data-ttu-id="ec224-131">如果您想 tooverify hello 應用程式套件在本機，使用 hello[測試 ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ec224-131">If you want tooverify hello app package locally, use hello [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span>  <span data-ttu-id="ec224-132">hello[複製 ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps)上傳 hello 封裝的命令。</span><span class="sxs-lookup"><span data-stu-id="ec224-132">hello [Copy-ServiceFabricApplicationPackage](/powershell/module/servicefabric/copy-servicefabricapplicationpackage?view=azureservicefabricps) command uploads hello package.</span></span> <span data-ttu-id="ec224-133">例如：</span><span class="sxs-lookup"><span data-stu-id="ec224-133">For example:</span></span>

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCount\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

### <a name="step-2-register-hello-application-type"></a><span data-ttu-id="ec224-134">步驟 2： 註冊 hello 應用程式類型</span><span class="sxs-lookup"><span data-stu-id="ec224-134">Step 2: Register hello application type</span></span>
<span data-ttu-id="ec224-135">Hello 應用程式類型和可用的 hello 應用程式資訊清單中宣告使用的版本，可讓註冊的 hello 應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="ec224-135">Registering hello application package makes hello application type and version declared in hello application manifest available for use.</span></span> <span data-ttu-id="ec224-136">hello 系統讀取 hello 封裝上傳 hello 步驟 1 中，確認 hello 封裝 (對等 toorunning[測試 ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage)在本機上)，處理 hello 套件內容，並將複製 hello 處理封裝 tooan內部系統位置。</span><span class="sxs-lookup"><span data-stu-id="ec224-136">hello system reads hello package uploaded in hello step 1, verify hello package (equivalent toorunning [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) locally), process hello package contents, and copy hello processed package tooan internal system location.</span></span>  <span data-ttu-id="ec224-137">執行 hello[暫存器 ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ec224-137">Run hello [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCount
```
<span data-ttu-id="ec224-138">執行 hello 的 hello 叢集中的所有 hello 應用程式類型都註冊的 toosee [Get ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ec224-138">toosee all hello application types registered in hello cluster, run hello [Get-ServiceFabricApplicationType](/powershell/module/servicefabric/get-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationType
```

### <a name="step-3-create-hello-application-instance"></a><span data-ttu-id="ec224-139">步驟 3： 建立 hello 應用程式執行個體</span><span class="sxs-lookup"><span data-stu-id="ec224-139">Step 3: Create hello application instance</span></span>
<span data-ttu-id="ec224-140">應用程式可以使用任何應用程式類型版本，已成功註冊使用 hello 具現化[新增 ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps)命令。</span><span class="sxs-lookup"><span data-stu-id="ec224-140">An application can be instantiated by using any application type version that has been registered successfully by using hello [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) command.</span></span> <span data-ttu-id="ec224-141">部署時間，而且必須以 hello 開頭，每個應用程式的 hello 名稱在宣告**網狀架構：**配置，而且是唯一的每個應用程式執行個體。</span><span class="sxs-lookup"><span data-stu-id="ec224-141">hello name of each application is declared at deploy time and must start with hello **fabric:** scheme and be unique for each application instance.</span></span> <span data-ttu-id="ec224-142">hello 應用程式類型名稱和應用程式類型版本的宣告中 hello **ApplicationManifest.xml** hello 應用程式封裝的檔案。</span><span class="sxs-lookup"><span data-stu-id="ec224-142">hello application type name and application type version are declared in hello **ApplicationManifest.xml** file of hello application package.</span></span> <span data-ttu-id="ec224-143">如果任何預設的服務定義 hello hello 目標應用程式類型應用程式資訊清單中，這些會建立在這個階段。</span><span class="sxs-lookup"><span data-stu-id="ec224-143">If any default services were defined in hello application manifest of hello target application type, then those are created at this time.</span></span>

```powershell
New-ServiceFabricApplication fabric:/WordCount WordCount 1.0.0
```

<span data-ttu-id="ec224-144">hello [Get ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication)命令會列出所有已成功建立，以及它們的總體狀態的應用程式執行個體。</span><span class="sxs-lookup"><span data-stu-id="ec224-144">hello [Get-ServiceFabricApplication](/powershell/servicefabric/vlatest/get-servicefabricapplication) command lists all application instances that were successfully created, along with their overall status.</span></span> <span data-ttu-id="ec224-145">hello [Get ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps)命令會列出所有已成功建立指定的應用程式執行個體中的 hello 服務執行個體。</span><span class="sxs-lookup"><span data-stu-id="ec224-145">hello [Get-ServiceFabricService](/powershell/module/servicefabric/get-servicefabricservice?view=azureservicefabricps) command lists all of hello service instances that were successfully created within a given application instance.</span></span> <span data-ttu-id="ec224-146">會列出預設的服務 (若有的話)。</span><span class="sxs-lookup"><span data-stu-id="ec224-146">Default services (if any) are listed.</span></span>

```powershell
Get-ServiceFabricApplication

Get-ServiceFabricApplication | Get-ServiceFabricService
```

## <a name="task-upgrade-a-service-fabric-application"></a><span data-ttu-id="ec224-147">工作：升級 Service Fabric 應用程式</span><span class="sxs-lookup"><span data-stu-id="ec224-147">Task: Upgrade a Service Fabric application</span></span>
<span data-ttu-id="ec224-148">您可以使用已更新的應用程式封裝，升級先前部署的 Service Fabric 應用程式。</span><span class="sxs-lookup"><span data-stu-id="ec224-148">You can upgrade a previously deployed Service Fabric application with an updated application package.</span></span> <span data-ttu-id="ec224-149">這項工作會升級已部署的 hello WordCount 應用程式 」 工作： 部署 Service Fabric 應用程式。 」</span><span class="sxs-lookup"><span data-stu-id="ec224-149">This task upgrades hello WordCount application that was deployed in "Task: Deploy a Service Fabric application."</span></span> <span data-ttu-id="ec224-150">如需詳細資訊，請參閱 [Service Fabric 應用程式升級](service-fabric-application-upgrade.md) 。</span><span class="sxs-lookup"><span data-stu-id="ec224-150">Read through [Service Fabric application upgrade](service-fabric-application-upgrade.md) for more information.</span></span>

<span data-ttu-id="ec224-151">此範例中，只有 hello 應用程式版本號碼的 tookeep 事項簡單已更新 hello WordCountV2 hello 必要條件中建立的應用程式封裝中。</span><span class="sxs-lookup"><span data-stu-id="ec224-151">tookeep things simple for this example, only hello application version number was updated in hello WordCountV2 application package created in hello prerequisites.</span></span> <span data-ttu-id="ec224-152">更新您的服務程式碼、 組態或資料檔案然後重建，並封裝 hello 與更新的版本號碼的應用程式牽涉到更真實的案例。</span><span class="sxs-lookup"><span data-stu-id="ec224-152">A more realistic scenario would involve updating your service code, configuration, or data files and then rebuilding and packaging hello application with updated version numbers.</span></span>  

### <a name="step-1-upload-hello-updated-application-package"></a><span data-ttu-id="ec224-153">步驟 1: Hello 更新的應用程式套件上傳</span><span class="sxs-lookup"><span data-stu-id="ec224-153">Step 1: Upload hello updated application package</span></span>
<span data-ttu-id="ec224-154">hello WordCount v1 應用程式已準備好 toobe 升級。</span><span class="sxs-lookup"><span data-stu-id="ec224-154">hello WordCount v1 application is ready toobe upgraded.</span></span> <span data-ttu-id="ec224-155">如果您開啟 PowerShell 視窗當做系統管理員並使用 type [ **Get ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps)，您會看到 1.0.0 版的 hello WordCount 應用程式類型部署。</span><span class="sxs-lookup"><span data-stu-id="ec224-155">If you open up a PowerShell window as administrator and type [**Get-ServiceFabricApplication**](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), you see that version 1.0.0 of hello WordCount application type is deployed.</span></span>  

<span data-ttu-id="ec224-156">現在複製 hello 更新應用程式封裝 toohello Service Fabric 映像存放區 （hello 應用程式封裝會儲存由 Service Fabric）。</span><span class="sxs-lookup"><span data-stu-id="ec224-156">Now copy hello updated application package toohello Service Fabric image store (where hello application packages are stored by Service Fabric).</span></span> <span data-ttu-id="ec224-157">hello 參數**ApplicationPackagePathInImageStore**通知服務網狀架構，它可以在哪裡找到 hello 應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="ec224-157">hello parameter **ApplicationPackagePathInImageStore** informs Service Fabric where it can find hello application package.</span></span> <span data-ttu-id="ec224-158">下列命令複製太 hello 應用程式套件的 hello**WordCountV2** hello 映像存放區中：</span><span class="sxs-lookup"><span data-stu-id="ec224-158">hello following command copies hello application package too**WordCountV2** in hello image store:</span></span>  

```powershell
Copy-ServiceFabricApplicationPackage C:\Temp\WordCountV2\ -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCountV2

```
### <a name="step-2-register-hello-updated-application-type"></a><span data-ttu-id="ec224-159">步驟 2： 註冊 hello 更新應用程式類型</span><span class="sxs-lookup"><span data-stu-id="ec224-159">Step 2: Register hello updated application type</span></span>
<span data-ttu-id="ec224-160">hello 下一個步驟是 tooregister hello 新版 hello 應用程式與服務網狀架構，可以執行使用 hello[暫存器 ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ec224-160">hello next step is tooregister hello new version of hello application with Service Fabric, which can be performed by using hello [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Register-ServiceFabricApplicationType WordCountV2
```

### <a name="step-3-start-hello-upgrade"></a><span data-ttu-id="ec224-161">步驟 3： 啟動 hello 升級</span><span class="sxs-lookup"><span data-stu-id="ec224-161">Step 3: Start hello upgrade</span></span>
<span data-ttu-id="ec224-162">各種升級參數、 逾時和健全狀況準則會套用的 tooapplication 升級。</span><span class="sxs-lookup"><span data-stu-id="ec224-162">Various upgrade parameters, timeouts, and health criteria can be applied tooapplication upgrades.</span></span> <span data-ttu-id="ec224-163">閱讀 hello[應用程式升級參數](service-fabric-application-upgrade-parameters.md)和[升級程序](service-fabric-application-upgrade.md)toolearn 詳細文件。</span><span class="sxs-lookup"><span data-stu-id="ec224-163">Read through hello [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and [upgrade process](service-fabric-application-upgrade.md) documents toolearn more.</span></span> <span data-ttu-id="ec224-164">所有服務和執行個體都應該*狀況良好*hello 升級之後。</span><span class="sxs-lookup"><span data-stu-id="ec224-164">All services and instances should be *healthy* after hello upgrade.</span></span>  <span data-ttu-id="ec224-165">設定 hello **HealthCheckStableDuration** too60 的秒數 （以便 hello 服務至少 20 秒才 hello 升級會繼續執行 toohello 下一個升級網域是狀況良好）。</span><span class="sxs-lookup"><span data-stu-id="ec224-165">Set hello **HealthCheckStableDuration** too60 seconds (so that hello services are healthy for at least 20 seconds before hello upgrade proceeds toohello next upgrade domain).</span></span>  <span data-ttu-id="ec224-166">也組 hello **UpgradeDomainTimeout** too1200 的秒數和 hello **UpgradeTimeout** too3000 秒。</span><span class="sxs-lookup"><span data-stu-id="ec224-166">Also set hello **UpgradeDomainTimeout** too1200 seconds and hello **UpgradeTimeout** too3000 seconds.</span></span> <span data-ttu-id="ec224-167">最後，設定 hello **UpgradeFailureAction**太**復原**，Service Fabric 回復要求 hello toohello 舊版本時，應用程式，如果在升級期間發生失敗。</span><span class="sxs-lookup"><span data-stu-id="ec224-167">Finally, set hello **UpgradeFailureAction** too**rollback**, which requests that Service Fabric rolls back hello application toohello previous version if failures are encountered during upgrade.</span></span>

<span data-ttu-id="ec224-168">您現在可以啟動 hello 應用程式升級使用 hello[開始 ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ec224-168">You can now start hello application upgrade by using hello [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/WordCount -ApplicationTypeVersion 2.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000  -FailureAction Rollback -Monitored
```

<span data-ttu-id="ec224-169">注意 hello 先前部署 v1.0.0 應用程式名稱，該 hello 應用程式名稱是 hello 相同 (fabric: / WordCount)。</span><span class="sxs-lookup"><span data-stu-id="ec224-169">Note that hello application name is hello same as hello previously deployed v1.0.0 application name (fabric:/WordCount).</span></span> <span data-ttu-id="ec224-170">服務網狀架構會使用哪一個應用程式會取得升級這個名稱 tooidentify。</span><span class="sxs-lookup"><span data-stu-id="ec224-170">Service Fabric uses this name tooidentify which application is getting upgraded.</span></span> <span data-ttu-id="ec224-171">如果您設定 hello 逾時 toobe 太短，可能會遇到逾時失敗訊息狀態 hello 問題。</span><span class="sxs-lookup"><span data-stu-id="ec224-171">If you set hello time-outs toobe too short, you might encounter a time-out failure message that states hello problem.</span></span> <span data-ttu-id="ec224-172">請參閱太[疑難排解應用程式升級](service-fabric-application-upgrade-troubleshooting.md)，或增加 hello 逾時。</span><span class="sxs-lookup"><span data-stu-id="ec224-172">Refer too[Troubleshoot application upgrades](service-fabric-application-upgrade-troubleshooting.md), or increase hello time-outs.</span></span>

### <a name="step-4-check-upgrade-progress"></a><span data-ttu-id="ec224-173">步驟 4︰檢查升級進度</span><span class="sxs-lookup"><span data-stu-id="ec224-173">Step 4: Check upgrade progress</span></span>
<span data-ttu-id="ec224-174">您可以使用，以監視應用程式升級進度[Service Fabric 總管](service-fabric-visualizing-your-cluster.md)，或使用 hello [Get ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span><span class="sxs-lookup"><span data-stu-id="ec224-174">You can monitor application upgrade progress by using [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md), or by using hello [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet:</span></span>

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/WordCount
```

<span data-ttu-id="ec224-175">在幾分鐘的時間，hello [Get ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet 會顯示已升級所有的升級網域 （完成）。</span><span class="sxs-lookup"><span data-stu-id="ec224-175">In a few minutes, hello [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) cmdlet shows that all upgrade domains were upgraded (completed).</span></span>

## <a name="task-test-a-service-fabric-application"></a><span data-ttu-id="ec224-176">工作：測試 Service Fabric 應用程式</span><span class="sxs-lookup"><span data-stu-id="ec224-176">Task: Test a Service Fabric application</span></span>
<span data-ttu-id="ec224-177">toowrite 高品質的服務，開發人員需要 toobe 無法 tooinduce 不可靠的基礎結構錯誤 tootest hello 穩定性其服務。</span><span class="sxs-lookup"><span data-stu-id="ec224-177">toowrite high-quality services, developers need toobe able tooinduce unreliable infrastructure faults tootest hello stability of their services.</span></span> <span data-ttu-id="ec224-178">服務網狀架構可讓開發人員 hello 能力 tooinduce 錯誤動作和測試服務中使用失敗的 hello 與否 hello chaos 和容錯移轉的測試案例。</span><span class="sxs-lookup"><span data-stu-id="ec224-178">Service Fabric gives developers hello ability tooinduce fault actions and test services in hello presence of failures by using hello chaos and failover test scenarios.</span></span>  <span data-ttu-id="ec224-179">閱讀[簡介 toohello 錯誤 Analysis Service](service-fabric-testability-overview.md)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="ec224-179">Read through [Introduction toohello Fault Analysis Service](service-fabric-testability-overview.md) for additional information.</span></span>

### <a name="step-1-run-hello-chaos-test-scenario"></a><span data-ttu-id="ec224-180">步驟 1： 執行 hello chaos 測試案例</span><span class="sxs-lookup"><span data-stu-id="ec224-180">Step 1: Run hello chaos test scenario</span></span>
<span data-ttu-id="ec224-181">hello chaos 測試案例會產生錯誤，整個 hello 整個 Service Fabric 叢集。</span><span class="sxs-lookup"><span data-stu-id="ec224-181">hello chaos test scenario generates faults across hello entire Service Fabric cluster.</span></span> <span data-ttu-id="ec224-182">hello 案例壓縮通常透過月或年 tooa 看到幾個小時的錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec224-182">hello scenario compresses faults generally seen over months or years tooa few hours.</span></span> <span data-ttu-id="ec224-183">具有較高的錯誤速率交錯錯誤 hello 組合尋找會遺漏的極端案例。</span><span class="sxs-lookup"><span data-stu-id="ec224-183">hello combination of interleaved faults with a high fault rate finds corner cases that would otherwise be missed.</span></span> <span data-ttu-id="ec224-184">hello 下列範例會執行 hello chaos 測試案例的 60 分鐘的時間。</span><span class="sxs-lookup"><span data-stu-id="ec224-184">hello following example runs hello chaos test scenario for 60 minutes.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$concurrentFaults = 3
$waitTimeBetweenIterationsSec = 60

Invoke-ServiceFabricChaosTestScenario -TimeToRunMinute $timeToRun -MaxClusterStabilizationTimeoutSec $maxStabilizationTimeSecs -MaxConcurrentFaults $concurrentFaults -EnableMoveReplicaFaults -WaitTimeBetweenIterationsSec $waitTimeBetweenIterationsSec
```

### <a name="step-2-run-hello-failover-test-scenario"></a><span data-ttu-id="ec224-185">步驟 2： 執行 hello 容錯移轉的測試案例</span><span class="sxs-lookup"><span data-stu-id="ec224-185">Step 2: Run hello failover test scenario</span></span>
<span data-ttu-id="ec224-186">hello 容錯移轉測試案例的目標特定的服務資料分割，而不是 hello 整個叢集，而且它會離開其他服務不會受到影響。</span><span class="sxs-lookup"><span data-stu-id="ec224-186">hello failover test scenario targets a specific service partition instead of hello entire cluster, and it leaves other services unaffected.</span></span> <span data-ttu-id="ec224-187">hello 案例逐一一連串的模擬的錯誤的服務驗證您的商務邏輯執行時。</span><span class="sxs-lookup"><span data-stu-id="ec224-187">hello scenario iterates through a sequence of simulated faults in service validation while your business logic runs.</span></span> <span data-ttu-id="ec224-188">服務驗證中若有失敗，表示有需要進一步調查的問題。</span><span class="sxs-lookup"><span data-stu-id="ec224-188">A failure in service validation indicates an issue that needs further investigation.</span></span> <span data-ttu-id="ec224-189">hello 容錯移轉測試，會產生只有一個以上的錯誤，一次，但不要的 toohello chaos 測試案例，這會導致多個錯誤。</span><span class="sxs-lookup"><span data-stu-id="ec224-189">hello failover test induces only one fault at a time, as opposed toohello chaos test scenario, which can induce multiple faults.</span></span> <span data-ttu-id="ec224-190">hello 下列範例會執行 hello 容錯移轉測試 60 分鐘針對 hello fabric: / WordCount/WordCountService 服務。</span><span class="sxs-lookup"><span data-stu-id="ec224-190">hello following example runs hello failover test for 60 minutes against hello fabric:/WordCount/WordCountService service.</span></span>

```powershell
$timeToRun = 60
$maxStabilizationTimeSecs = 180
$waitTimeBetweenFaultsSec = 10
$serviceName = "fabric:/WordCount/WordCountService"

Invoke-ServiceFabricFailoverTestScenario -TimeToRunMinute $timeToRun -MaxServiceStabilizationTimeoutSec $maxStabilizationTimeSecs -WaitTimeBetweenFaultsSec $waitTimeBetweenFaultsSec -ServiceName $serviceName -PartitionKindUniformInt64 -PartitionKey 1
```

## <a name="task-remove-a-service-fabric-application"></a><span data-ttu-id="ec224-191">工作：移除 Service Fabric 應用程式</span><span class="sxs-lookup"><span data-stu-id="ec224-191">Task: Remove a Service Fabric application</span></span>
<span data-ttu-id="ec224-192">您可以刪除部署的應用程式的執行個體從 hello 叢集中，移除 hello 佈建應用程式類型，從 hello ImageStore 移除 hello 應用程式封裝。</span><span class="sxs-lookup"><span data-stu-id="ec224-192">You can delete an instance of a deployed application, remove hello provisioned application type from hello cluster, and remove hello application package from hello ImageStore.</span></span>

### <a name="step-1-remove-an-application-instance"></a><span data-ttu-id="ec224-193">步驟 1：移除應用程式執行個體</span><span class="sxs-lookup"><span data-stu-id="ec224-193">Step 1: Remove an application instance</span></span>
<span data-ttu-id="ec224-194">當不再需要應用程式執行個體時，您可以永久移除使用 hello[移除 ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ec224-194">When an application instance is no longer needed, you can permanently remove it by using hello [Remove-ServiceFabricApplication](/powershell/module/servicefabric/remove-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="ec224-195">這也會自動移除屬於 toohello 應用程式中，永久移除所有的服務狀態的所有服務。</span><span class="sxs-lookup"><span data-stu-id="ec224-195">This also automatically removes all services belonging toohello application, permanently removing all service state.</span></span> <span data-ttu-id="ec224-196">此作業無法回復，且應用程式狀態無法復原。</span><span class="sxs-lookup"><span data-stu-id="ec224-196">This operation cannot be reversed and application state cannot be recovered.</span></span>

```powershell
Remove-ServiceFabricApplication fabric:/WordCount
```

### <a name="step-2-unregister-hello-application-type"></a><span data-ttu-id="ec224-197">步驟 2： 取消註冊 hello 應用程式類型</span><span class="sxs-lookup"><span data-stu-id="ec224-197">Step 2: Unregister hello application type</span></span>
<span data-ttu-id="ec224-198">當您不再需要特定版本的應用程式類型時，將它移除註冊使用 hello[取消註冊 ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ec224-198">When you no longer need a particular version of an application type, unregister it by using hello [Unregister-ServiceFabricApplicationType](/powershell/module/servicefabric/unregister-servicefabricapplicationtype?view=azureservicefabricps) cmdlet.</span></span> <span data-ttu-id="ec224-199">取消登錄未使用的型別版本使用儲存空間 hello hello 映像存放區中的應用程式套件。</span><span class="sxs-lookup"><span data-stu-id="ec224-199">Unregistering unused types releases storage space used by hello application package in hello image store.</span></span> <span data-ttu-id="ec224-200">只要沒有對應的應用程式進行具現化，或擱置中的應用程式升級進行參考，則應用程式類型即可取消註冊。</span><span class="sxs-lookup"><span data-stu-id="ec224-200">An application type can be unregistered as long as there are no applications instantiated against it or pending application upgrades referencing it.</span></span>

```powershell
Unregister-ServiceFabricApplicationType WordCount 1.0.0
```

### <a name="step-3-remove-hello-application-package"></a><span data-ttu-id="ec224-201">步驟 3： 移除 hello 應用程式封裝</span><span class="sxs-lookup"><span data-stu-id="ec224-201">Step 3: Remove hello application package</span></span>
<span data-ttu-id="ec224-202">Hello 應用程式類型的註冊之後，hello 應用程式封裝可以從移除 hello 映像存放區使用 hello[移除 ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="ec224-202">After hello application type is unregistered, hello application package can be removed from hello image store by using hello [Remove-ServiceFabricApplicationPackage](/powershell/module/servicefabric/remove-servicefabricapplicationpackage?view=azureservicefabricps) cmdlet.</span></span>

```powershell
Remove-ServiceFabricApplicationPackage -ImageStoreConnectionString file:C:\SfDevCluster\Data\ImageStoreShare -ApplicationPackagePathInImageStore WordCount
```

## <a name="next-steps"></a><span data-ttu-id="ec224-203">後續步驟</span><span class="sxs-lookup"><span data-stu-id="ec224-203">Next steps</span></span>
[<span data-ttu-id="ec224-204">Service Fabric 應用程式生命週期</span><span class="sxs-lookup"><span data-stu-id="ec224-204">Service Fabric application lifecycle</span></span>](service-fabric-application-lifecycle.md)

[<span data-ttu-id="ec224-205">部署應用程式</span><span class="sxs-lookup"><span data-stu-id="ec224-205">Deploy an application</span></span>](service-fabric-deploy-remove-applications.md)

[<span data-ttu-id="ec224-206">應用程式升級</span><span class="sxs-lookup"><span data-stu-id="ec224-206">Application upgrade</span></span>](service-fabric-application-upgrade.md)

[<span data-ttu-id="ec224-207">Azure Service Fabric Cmdlet</span><span class="sxs-lookup"><span data-stu-id="ec224-207">Azure Service Fabric cmdlets</span></span>](/powershell/azure/overview?view=azureservicefabricps)

