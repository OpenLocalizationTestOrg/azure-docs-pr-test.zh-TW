---
title: "規劃 Service Fabric 應用程式的 aaaCapacity |Microsoft 文件"
description: "描述如何 tooidentify hello 的 Service Fabric 應用程式所需的運算節點數目"
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: markfuss
editor: 
ms.assetid: 9fa47be0-50a2-4a51-84a5-20992af94bea
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 44a69e9d8ec5efcc43122dc42e8f923ef37378f2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="capacity-planning-for-service-fabric-applications"></a><span data-ttu-id="76ef4-103">Service Fabric 應用程式的容量規劃</span><span class="sxs-lookup"><span data-stu-id="76ef4-103">Capacity planning for Service Fabric applications</span></span>
<span data-ttu-id="76ef4-104">這份文件教您如何 tooestimate hello 數量的資源 （Cpu、 RAM、 磁碟儲存體） 您需要 toorun Azure Service Fabric 應用程式。</span><span class="sxs-lookup"><span data-stu-id="76ef4-104">This document teaches you how tooestimate hello amount of resources (CPUs, RAM, disk storage) you need toorun your Azure Service Fabric applications.</span></span> <span data-ttu-id="76ef4-105">通常會為您的資源需求 toochange 經過一段時間。</span><span class="sxs-lookup"><span data-stu-id="76ef4-105">It is common for your resource requirements toochange over time.</span></span> <span data-ttu-id="76ef4-106">開發/測試您的服務時通常需要少數資源，之後進入生產環境且您的應用程式受歡迎度增長時會需要更多資源。</span><span class="sxs-lookup"><span data-stu-id="76ef4-106">You typically require few resources as you develop/test your service, and then require more resources as you go into production and your application grows in popularity.</span></span> <span data-ttu-id="76ef4-107">當您設計您的應用程式時，思考 hello 長期的需求，並做出選擇，並允許您服務 tooscale toomeet 高的客戶需求。</span><span class="sxs-lookup"><span data-stu-id="76ef4-107">When you design your application, think through hello long-term requirements and make choices that allow your service tooscale toomeet high customer demand.</span></span>

 <span data-ttu-id="76ef4-108">當您建立 Service Fabric 叢集時，您可以決定 hello 叢集進行的虛擬機器 (Vm) 的類型。</span><span class="sxs-lookup"><span data-stu-id="76ef4-108">When you create a Service Fabric cluster, you decide what kinds of virtual machines (VMs) make up hello cluster.</span></span> <span data-ttu-id="76ef4-109">每個 VM 會具有有限的 Cpu （核心和速度）、 網路頻寬、 RAM 和磁碟儲存體 hello 形式的資源。</span><span class="sxs-lookup"><span data-stu-id="76ef4-109">Each VM comes with a limited amount of resources in hello form of CPUs (cores and speed), network bandwidth, RAM, and disk storage.</span></span> <span data-ttu-id="76ef4-110">隨著您的服務增加一段時間，您可以升級 tooVMs 提供更高的資源和/或新增更多 Vm tooyour 叢集。</span><span class="sxs-lookup"><span data-stu-id="76ef4-110">As your service grows over time, you can upgrade tooVMs that offer greater resources and/or add more VMs tooyour cluster.</span></span> <span data-ttu-id="76ef4-111">toodo hello 後者，您必須設計架構，您的服務一開始讓其能夠運用以動態方式加入 toohello 叢集的新 Vm。</span><span class="sxs-lookup"><span data-stu-id="76ef4-111">toodo hello latter, you must architect your service initially so it can take advantage of new VMs that get dynamically added toohello cluster.</span></span>

<span data-ttu-id="76ef4-112">部分服務管理 hello Vm 本身很少 toono 資料。</span><span class="sxs-lookup"><span data-stu-id="76ef4-112">Some services manage little toono data on hello VMs themselves.</span></span> <span data-ttu-id="76ef4-113">因此，這些服務應該主要著重在效能，這表示選取 hello 規劃容量適當 hello Vm 的 Cpu （核心和速度）。</span><span class="sxs-lookup"><span data-stu-id="76ef4-113">Therefore, capacity planning for these services should focus primarily on performance, which means selecting hello appropriate CPUs (cores and speed) of hello VMs.</span></span> <span data-ttu-id="76ef4-114">此外，您應該考慮網路頻寬，包括發生網路傳輸的頻率特別以及要傳送的資料量。</span><span class="sxs-lookup"><span data-stu-id="76ef4-114">In addition, you should consider network bandwidth, including how frequently network transfers are occurring and how much data is being transferred.</span></span> <span data-ttu-id="76ef4-115">如果您的服務需要 tooperform 以及服務使用量增加，您可以新增多個 Vm toohello 叢集及所有 hello Vm 之間進行負載平衡 hello 網路要求。</span><span class="sxs-lookup"><span data-stu-id="76ef4-115">If your service needs tooperform well as service usage increases, you can add more VMs toohello cluster and load balance hello network requests across all hello VMs.</span></span>

<span data-ttu-id="76ef4-116">管理大量資料 hello Vm 上的服務，容量規劃應該主要著重在大小。</span><span class="sxs-lookup"><span data-stu-id="76ef4-116">For services that manage large amounts of data on hello VMs, capacity planning should focus primarily on size.</span></span> <span data-ttu-id="76ef4-117">因此，您應該仔細考量 hello hello VM 的 RAM 和磁碟儲存體容量。</span><span class="sxs-lookup"><span data-stu-id="76ef4-117">Thus, you should carefully consider hello capacity of hello VM's RAM and disk storage.</span></span> <span data-ttu-id="76ef4-118">在 Windows 中的 hello 虛擬記憶體管理系統可讓 RAM tooapplication 程式碼看起來的磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="76ef4-118">hello virtual memory management system in Windows makes disk space look like RAM tooapplication code.</span></span> <span data-ttu-id="76ef4-119">此外，hello Service Fabric 執行階段提供 「 智慧型分頁處理，讓只有熱資料保留在記憶體和移動 hello 冷資料 toodisk。</span><span class="sxs-lookup"><span data-stu-id="76ef4-119">In addition, hello Service Fabric runtime provides smart paging keeping only hot data in memory and moving hello cold data toodisk.</span></span> <span data-ttu-id="76ef4-120">因此，應用程式可以使用更多記憶體超出實際可用 hello VM 上。</span><span class="sxs-lookup"><span data-stu-id="76ef4-120">Applications can thus use more memory than is physically available on hello VM.</span></span> <span data-ttu-id="76ef4-121">需要更多 RAM 只會提高效能，因為 hello VM 可保留在 RAM 中的多個磁碟儲存體。</span><span class="sxs-lookup"><span data-stu-id="76ef4-121">Having more RAM simply increases performance, since hello VM can keep more disk storage in RAM.</span></span> <span data-ttu-id="76ef4-122">hello 您選取的 VM 應該 hello VM 您想要的磁碟夠大 toostore hello 資料。</span><span class="sxs-lookup"><span data-stu-id="76ef4-122">hello VM you select should have a disk large enough toostore hello data that you want on hello VM.</span></span> <span data-ttu-id="76ef4-123">同樣地，hello VM 應該有足夠的 RAM tooprovide 您與 hello 您想要的效能。</span><span class="sxs-lookup"><span data-stu-id="76ef4-123">Similarly, hello VM should have enough RAM tooprovide you with hello performance you desire.</span></span> <span data-ttu-id="76ef4-124">如果您的服務資料隨著時間而定，您可以加入更多 Vm toohello 叢集和磁碟分割 hello 資料跨所有 hello Vm。</span><span class="sxs-lookup"><span data-stu-id="76ef4-124">If your service's data grows over time, you can add more VMs toohello cluster and partition hello data across all hello VMs.</span></span>

## <a name="determine-how-many-nodes-you-need"></a><span data-ttu-id="76ef4-125">決定您需要多少個節點</span><span class="sxs-lookup"><span data-stu-id="76ef4-125">Determine how many nodes you need</span></span>
<span data-ttu-id="76ef4-126">資料分割您的服務可讓您 tooscale 出您的服務資料。</span><span class="sxs-lookup"><span data-stu-id="76ef4-126">Partitioning your service allows you tooscale out your service's data.</span></span> <span data-ttu-id="76ef4-127">如需有關分割的詳細資訊，請參閱 [分割 Service Fabric](service-fabric-concepts-partitioning.md)。</span><span class="sxs-lookup"><span data-stu-id="76ef4-127">For more information on partitioning, see [Partitioning Service Fabric](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="76ef4-128">必須將每個資料分割納入單一 VM，但是可以將多個 (小型) 資料分割放在單一 VM 上。</span><span class="sxs-lookup"><span data-stu-id="76ef4-128">Each partition must fit within a single VM, but multiple (small) partitions can be placed on a single VM.</span></span> <span data-ttu-id="76ef4-129">因此，如果有比較多的小型資料分割，比起有比較少的大型資料分割，可提供您更大的彈性。</span><span class="sxs-lookup"><span data-stu-id="76ef4-129">So, having more small partitions gives you greater flexibility than having a few larger partitions.</span></span> <span data-ttu-id="76ef4-130">hello 代價是，有很多分割區增加 Service Fabric 負擔，而且您無法跨磁碟分割執行的交易的作業數。</span><span class="sxs-lookup"><span data-stu-id="76ef4-130">hello trade-off is that having lots of partitions increases Service Fabric overhead and you cannot perform transacted operations across partitions.</span></span> <span data-ttu-id="76ef4-131">如果您的服務程式碼經常需要 tooaccess 存在於不同的資料分割的資料片段，也會產生更多潛在的網路流量。</span><span class="sxs-lookup"><span data-stu-id="76ef4-131">There is also more potential network traffic if your service code frequently needs tooaccess pieces of data that live in different partitions.</span></span> <span data-ttu-id="76ef4-132">在設計您的服務時，您應該仔細考量這些優缺點的 tooarrive 在有效的資料分割策略。</span><span class="sxs-lookup"><span data-stu-id="76ef4-132">When designing your service, you should carefully consider these pros and cons tooarrive at an effective partitioning strategy.</span></span>

<span data-ttu-id="76ef4-133">例如，假設您的應用程式已有您在一年中預期 toogrow tooDB_Size GB 的存放區大小的單一可設定狀態服務。</span><span class="sxs-lookup"><span data-stu-id="76ef4-133">Let's assume your application has a single stateful service that has a store size that you expect toogrow tooDB_Size GB in a year.</span></span> <span data-ttu-id="76ef4-134">您在多個應用程式 （和資料分割） 成是願意 tooadd 遇到超出該年度的成長。</span><span class="sxs-lookup"><span data-stu-id="76ef4-134">You are willing tooadd more applications (and partitions) as you experience growth beyond that year.</span></span>  <span data-ttu-id="76ef4-135">hello 複寫因數 (RF)，決定服務影響 hello 總 DB_Size hello 複本數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-135">hello replication factor (RF), which determines hello number of replicas for your service impacts hello total DB_Size.</span></span> <span data-ttu-id="76ef4-136">在所有複本上的總 DB_Size 為 hello 複寫因數乘以 DB_Size hello。</span><span class="sxs-lookup"><span data-stu-id="76ef4-136">hello total DB_Size across all replicas is hello Replication Factor multiplied by DB_Size.</span></span>  <span data-ttu-id="76ef4-137">Node_Size 代表 hello 磁碟空間/RAM 每個節點要 toouse 為您的服務。</span><span class="sxs-lookup"><span data-stu-id="76ef4-137">Node_Size represents hello disk space/RAM per node you want toouse for your service.</span></span> <span data-ttu-id="76ef4-138">為了達到最佳效能，hello DB_Size 應該跨 hello 叢集與周圍的 hello 應該選擇 VM 的 RAM hello Node_Size 放入記憶體中。</span><span class="sxs-lookup"><span data-stu-id="76ef4-138">For best performance, hello DB_Size should fit into memory across hello cluster, and a Node_Size that is around hello RAM of hello VM should be chosen.</span></span> <span data-ttu-id="76ef4-139">藉由配置大於 hello RAM 容量 Node_Size，您依賴在 hello Service Fabric 執行階段所提供的 hello 分頁。</span><span class="sxs-lookup"><span data-stu-id="76ef4-139">By allocating a Node_Size that is larger than hello RAM capacity, you are relying on hello paging provided by hello Service Fabric runtime.</span></span> <span data-ttu-id="76ef4-140">因此，您可能無法達到最佳效能如果整個資料被視為 toobe 熱 （從然後 hello 資料分頁/out)。</span><span class="sxs-lookup"><span data-stu-id="76ef4-140">Thus, your performance may not be optimal if your entire data is considered toobe hot (since then hello data is paged in/out).</span></span> <span data-ttu-id="76ef4-141">不過，對於許多服務，其中只有一小部份 hello 資料是作用，它是更符合成本效益。</span><span class="sxs-lookup"><span data-stu-id="76ef4-141">However, for many services where only a fraction of hello data is hot, it is more cost-effective.</span></span>

<span data-ttu-id="76ef4-142">節點所需的最大效能的 hello 數目的計算方式，如下所示：</span><span class="sxs-lookup"><span data-stu-id="76ef4-142">hello number of nodes required for maximum performance can be computed as follows:</span></span>

```
Number of Nodes = (DB_Size * RF)/Node_Size

```


## <a name="account-for-growth"></a><span data-ttu-id="76ef4-143">考慮成長</span><span class="sxs-lookup"><span data-stu-id="76ef4-143">Account for growth</span></span>
<span data-ttu-id="76ef4-144">您可能想要的節點 toocompute hello 數目根據 hello DB_Size 此外如預期，您服務 toogrow toohello DB_Size 您開始使用。</span><span class="sxs-lookup"><span data-stu-id="76ef4-144">You may want toocompute hello number of nodes based on hello DB_Size that you expect your service toogrow to, in addition toohello DB_Size that you began with.</span></span> <span data-ttu-id="76ef4-145">然後，成長 hello 節點數目，您的服務成長時，讓您要不過度佈建 hello 節點數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-145">Then, grow hello number of nodes as your service grows so that you are not over-provisioning hello number of nodes.</span></span> <span data-ttu-id="76ef4-146">但是資料分割的 hello 數目應該依據 hello 當您執行您的服務在最大成長時所需的節點數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-146">But hello number of partitions should be based on hello number of nodes that are needed when you're running your service at maximum growth.</span></span>

<span data-ttu-id="76ef4-147">它是好 toohave 一些額外的電腦可用在任何時間，如此可以處理任何非預期的尖峰或失敗 （例如，如果一些 Vm 都當機）。</span><span class="sxs-lookup"><span data-stu-id="76ef4-147">It is good toohave some extra machines available at any time so that you can handle any unexpected spikes or failure (for example, if a few VMs go down).</span></span>  <span data-ttu-id="76ef4-148">使用您預期的尖峰，應該判斷 hello 額外容量，而的起始點是 tooreserve 幾個額外的 Vm (5-10%額外)。</span><span class="sxs-lookup"><span data-stu-id="76ef4-148">While hello extra capacity should be determined by using your expected spikes, a starting point is tooreserve a few extra VMs (5-10 percent extra).</span></span>

<span data-ttu-id="76ef4-149">hello 上述假設單一的可設定狀態服務。</span><span class="sxs-lookup"><span data-stu-id="76ef4-149">hello preceding assumes a single stateful service.</span></span> <span data-ttu-id="76ef4-150">如果您有多個可設定狀態服務，您會有 tooadd hello 與相關聯的 DB_Size hello hello 方程式到其他服務。</span><span class="sxs-lookup"><span data-stu-id="76ef4-150">If you have more than one stateful service, you have tooadd hello DB_Size associated with hello other services into hello equation.</span></span> <span data-ttu-id="76ef4-151">或者，您可以計算 hello 分別為每個可設定狀態服務的節點數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-151">Alternatively, you can compute hello number of nodes separately for each stateful service.</span></span>  <span data-ttu-id="76ef4-152">您的服務的複本或資料分割可能不平衡。</span><span class="sxs-lookup"><span data-stu-id="76ef4-152">Your service may have replicas or partitions that aren't balanced.</span></span> <span data-ttu-id="76ef4-153">請記住，有些資料分割的資料可能比其他資料分割還多。</span><span class="sxs-lookup"><span data-stu-id="76ef4-153">Keep in mind that partitions may also have more data than others.</span></span> <span data-ttu-id="76ef4-154">如需有關分割的詳細資訊，請參閱 [最佳作法的分割文章](service-fabric-concepts-partitioning.md)。</span><span class="sxs-lookup"><span data-stu-id="76ef4-154">For more information on partitioning, see [partitioning article on best practices](service-fabric-concepts-partitioning.md).</span></span> <span data-ttu-id="76ef4-155">不過，hello 上述公式是資料分割和複本無關，因為 Service Fabric 可確保，hello 複本會散佈在 hello 節點之間以最佳方式。</span><span class="sxs-lookup"><span data-stu-id="76ef4-155">However, hello preceding equation is partition and replica agnostic, because Service Fabric ensures that hello replicas are spread out among hello nodes in an optimized manner.</span></span>

## <a name="use-a-spreadsheet-for-cost-calculation"></a><span data-ttu-id="76ef4-156">使用試算表進行成本計算</span><span class="sxs-lookup"><span data-stu-id="76ef4-156">Use a spreadsheet for cost calculation</span></span>
<span data-ttu-id="76ef4-157">現在讓我們將某些實際數字放在 hello 公式。</span><span class="sxs-lookup"><span data-stu-id="76ef4-157">Now let's put some real numbers in hello formula.</span></span> <span data-ttu-id="76ef4-158">[範例試算表](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx)示範如何 tooplan hello 的應用程式包含三種類型的資料物件的容量。</span><span class="sxs-lookup"><span data-stu-id="76ef4-158">An [example spreadsheet](https://servicefabricsdkstorage.blob.core.windows.net/publicrelease/SF%20VM%20Cost%20calculator-NEW.xlsx) shows how tooplan hello capacity for an application that contains three types of data objects.</span></span> <span data-ttu-id="76ef4-159">針對每個物件，我們的近似大小，我們預期 toohave 的物件數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-159">For each object, we approximate its size and how many objects we expect toohave.</span></span> <span data-ttu-id="76ef4-160">我們也選取對每個物件類型我們想要的複本數。</span><span class="sxs-lookup"><span data-stu-id="76ef4-160">We also select how many replicas we want of each object type.</span></span> <span data-ttu-id="76ef4-161">hello 試算表計算記憶體 toobe hello 叢集中儲存的 hello 總數。</span><span class="sxs-lookup"><span data-stu-id="76ef4-161">hello spreadsheet calculates hello total amount of memory toobe stored in hello cluster.</span></span>

<span data-ttu-id="76ef4-162">然後，我們輸入 VM 大小和每月成本。</span><span class="sxs-lookup"><span data-stu-id="76ef4-162">Then we enter a VM size and monthly cost.</span></span> <span data-ttu-id="76ef4-163">根據 hello VM 大小，hello 試算表會告知 hello 您必須使用符合資料 toophysically toosplit hello 節點的資料分割的最小數目。</span><span class="sxs-lookup"><span data-stu-id="76ef4-163">Based on hello VM size, hello spreadsheet tells you hello minimum number of partitions you must use toosplit your data toophysically fit on hello nodes.</span></span> <span data-ttu-id="76ef4-164">您可能想要更大量的資料分割 tooaccommodate 需要您的應用程式特定的計算和網路流量。</span><span class="sxs-lookup"><span data-stu-id="76ef4-164">You may desire a larger number of partitions tooaccommodate your application's specific computation and network traffic needs.</span></span> <span data-ttu-id="76ef4-165">hello 試算表會顯示 hello 管理 hello 使用者設定檔物件的資料分割數目已從一個 toosix 增加。</span><span class="sxs-lookup"><span data-stu-id="76ef4-165">hello spreadsheet shows hello number of partitions that are managing hello user profile objects has increased from one toosix.</span></span>

<span data-ttu-id="76ef4-166">現在，根據這項資訊，hello 試算表會顯示您實際上可以取得所有 hello 資料與預期的 hello 資料分割和複本 26 雙節點叢集上。</span><span class="sxs-lookup"><span data-stu-id="76ef4-166">Now, based on all this information, hello spreadsheet shows that you could physically get all hello data with hello desired partitions and replicas on a 26-node cluster.</span></span> <span data-ttu-id="76ef4-167">不過，此叢集會是緊密壓縮的因此您可能需要一些額外的節點 tooaccommodate 節點失敗和升級。</span><span class="sxs-lookup"><span data-stu-id="76ef4-167">However, this cluster would be densely packed, so you may want some additional nodes tooaccommodate node failures and upgrades.</span></span> <span data-ttu-id="76ef4-168">hello 試算表也會顯示，具有多個 57 節點提供任何其他值，因為您會有空白節點。</span><span class="sxs-lookup"><span data-stu-id="76ef4-168">hello spreadsheet also shows that having more than 57 nodes provides no additional value because you would have empty nodes.</span></span> <span data-ttu-id="76ef4-169">同樣地，您可能想 toogo 57 節點上方還是 tooaccommodate 節點失敗和升級。</span><span class="sxs-lookup"><span data-stu-id="76ef4-169">Again, you may want toogo above 57 nodes anyway tooaccommodate node failures and upgrades.</span></span> <span data-ttu-id="76ef4-170">您可以調整 hello 試算表 toomatch 應用程式的特定需求。</span><span class="sxs-lookup"><span data-stu-id="76ef4-170">You can tweak hello spreadsheet toomatch your application's specific needs.</span></span>   

![成本計算的試算表][Image1]

## <a name="next-steps"></a><span data-ttu-id="76ef4-172">後續步驟</span><span class="sxs-lookup"><span data-stu-id="76ef4-172">Next steps</span></span>
<span data-ttu-id="76ef4-173">簽出[分割 Service Fabric 服務][ 10] toolearn 深入了解您的服務資料分割。</span><span class="sxs-lookup"><span data-stu-id="76ef4-173">Check out [Partitioning Service Fabric services][10] toolearn more about partitioning your service.</span></span>

<!--Image references-->
[Image1]: ./media/SF-Cost.png

<!--Link references--In actual articles, you only need a single period before hello slash-->
[10]: service-fabric-concepts-partitioning.md
