---
title: "aaaPlanning 在 Azure 中的您 VM 備份基礎結構 |Microsoft 文件"
description: "規劃 tooback 註冊在 Azure 虛擬機器時的重要考量"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "備份 VM, 備份虛擬機器"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="59620-104">在 Azure 中規劃 VM 備份基礎結構</span><span class="sxs-lookup"><span data-stu-id="59620-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="59620-105">本文章提供效能和資源建議 toohelp 規劃 VM 備份基礎結構。</span><span class="sxs-lookup"><span data-stu-id="59620-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="59620-106">它也會定義 hello 備份服務的重要層面，含有這些層面可能很重要決定您的架構，容量規劃，和排程。</span><span class="sxs-lookup"><span data-stu-id="59620-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="59620-107">如果您已經[備妥您的環境](backup-azure-vms-prepare.md)，規劃是 hello 下一個步驟，在您開始前[啟動 Vm tooback](backup-azure-vms.md)。</span><span class="sxs-lookup"><span data-stu-id="59620-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="59620-108">如果您需要 Azure 虛擬機器的詳細資訊，請參閱 hello[虛擬機器文件](https://azure.microsoft.com/documentation/services/virtual-machines/)。</span><span class="sxs-lookup"><span data-stu-id="59620-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="59620-109">Azure 如何備份虛擬機器？</span><span class="sxs-lookup"><span data-stu-id="59620-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="59620-110">當 hello Azure 備份服務會啟動備份作業在 hello 排定的時間時，它就會觸發 hello 備用分機號碼 tootake 時間點快照集。</span><span class="sxs-lookup"><span data-stu-id="59620-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="59620-111">hello Azure 備份服務會使用 hello _VMSnapshot_延伸模組中 Windows 和 hello _VMSnapshotLinux_ Linux 中的擴充功能。</span><span class="sxs-lookup"><span data-stu-id="59620-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="59620-112">在第一個 VM 備份 hello 安裝 hello 擴充功能。</span><span class="sxs-lookup"><span data-stu-id="59620-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="59620-113">tooinstall hello 延伸模組，必須執行 hello VM。</span><span class="sxs-lookup"><span data-stu-id="59620-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="59620-114">如果 hello 未執行 VM，hello Backup service 的快照 hello 基礎儲存體 （因為 VM 已停止的 hello 時，會不發生任何應用程式寫入）。</span><span class="sxs-lookup"><span data-stu-id="59620-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="59620-115">建立 Windows Vm 快照，hello 備份服務協調一致的快照集的 hello 虛擬機器的磁碟與 hello 磁碟區陰影複製服務 (VSS) tooget。</span><span class="sxs-lookup"><span data-stu-id="59620-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="59620-116">如果您正在備份 Linux Vm，您可以撰寫您自己的自訂指令碼 tooensure 一致性時取得 VM 快照集。</span><span class="sxs-lookup"><span data-stu-id="59620-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="59620-117">本文稍後會提供叫用這些指令碼的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="59620-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="59620-118">一旦 hello Azure 備份服務會擷取 hello 快照，hello 資料就是傳送的 toohello 保存庫。</span><span class="sxs-lookup"><span data-stu-id="59620-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="59620-119">toomaximize 效率 hello 服務識別，以及傳輸只 hello 的 hello 上一次備份之後變更資料的區塊。</span><span class="sxs-lookup"><span data-stu-id="59620-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Azure 虛擬機器備份架構](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="59620-121">Hello 資料傳輸完成時，會移除 hello 快照集，並建立復原點。</span><span class="sxs-lookup"><span data-stu-id="59620-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="59620-122">在 hello 備份過程中，Azure 備份不包含 hello 附加的暫存磁碟 toohello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="59620-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="59620-123">如需詳細資訊，請參閱 hello 部落格上[暫存](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/)。</span><span class="sxs-lookup"><span data-stu-id="59620-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="59620-124">因為 Azure Backup 採用儲存層級的快照集和快照集 toovault 的傳輸，請勿變更 hello 儲存體帳戶金鑰，直到 hello 備份工作完成。</span><span class="sxs-lookup"><span data-stu-id="59620-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="59620-125">對於 premium 的 Vm，我們要複製 hello 快照集 toostorage 帳戶。</span><span class="sxs-lookup"><span data-stu-id="59620-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="59620-126">這是確定 Azure 備份服務取得足夠的 IOPS，傳送資料 toovault toomake。</span><span class="sxs-lookup"><span data-stu-id="59620-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="59620-127">此儲存體另一份負責根據 hello 已配置大小的 VM。</span><span class="sxs-lookup"><span data-stu-id="59620-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="59620-128">資料一致性</span><span class="sxs-lookup"><span data-stu-id="59620-128">Data consistency</span></span>
<span data-ttu-id="59620-129">備份和還原業務關鍵資料更為複雜，必須備份企業重要資料產生資料執行中的 hello 的 hello 應用程式時 hello 事實。</span><span class="sxs-lookup"><span data-stu-id="59620-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="59620-130">tooaddress Windows 和 Linux Vm，Azure Backup 支援應用程式一致備份</span><span class="sxs-lookup"><span data-stu-id="59620-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="59620-131">Windows VM</span><span class="sxs-lookup"><span data-stu-id="59620-131">Windows VM</span></span>
<span data-ttu-id="59620-132">Azure 備份會在 Windows VM 上執行 VSS 完整備份 (深入了解 [VSS 完整備份](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx))。</span><span class="sxs-lookup"><span data-stu-id="59620-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="59620-133">tooenable VSS 複製備份，遵循 hello VM 上的登錄金鑰需求 toobe 集中 hello。</span><span class="sxs-lookup"><span data-stu-id="59620-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="59620-134">Linux VM</span><span class="sxs-lookup"><span data-stu-id="59620-134">Linux VMs</span></span>
<span data-ttu-id="59620-135">Azure 備份提供指令碼架構。</span><span class="sxs-lookup"><span data-stu-id="59620-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="59620-136">tooensure 應用程式一致性 Linux Vm，在備份時建立自訂的前指令碼，以及控制 hello 備份工作流程和環境的後置指令碼。</span><span class="sxs-lookup"><span data-stu-id="59620-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="59620-137">Azure 備份會 hello 前指令碼叫用之前取得 hello VM 快照集和 hello VM 快照集作業完成之後，會叫用 hello 後指令碼。</span><span class="sxs-lookup"><span data-stu-id="59620-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="59620-138">如需詳細資訊，請參閱 [Azure Linux VM 的應用程式一致備份 (預覽)](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent)。</span><span class="sxs-lookup"><span data-stu-id="59620-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="59620-139">Azure 備份只會叫用的客戶所撰寫的 hello 前置和後置指令碼。</span><span class="sxs-lookup"><span data-stu-id="59620-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="59620-140">如果 hello 前指令碼和後置指令碼執行成功，Azure 備份將標示 hello 復原點為應用程式一致。</span><span class="sxs-lookup"><span data-stu-id="59620-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="59620-141">不過，hello 客戶而且主要負責 hello 應用程式一致性時使用自訂指令碼。</span><span class="sxs-lookup"><span data-stu-id="59620-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="59620-142">下表說明 hello 它們發生在 Azure VM 的備份和還原程序的一致性與 hello 條件類型。</span><span class="sxs-lookup"><span data-stu-id="59620-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="59620-143">一致性</span><span class="sxs-lookup"><span data-stu-id="59620-143">Consistency</span></span> | <span data-ttu-id="59620-144">以 VSS 基礎</span><span class="sxs-lookup"><span data-stu-id="59620-144">VSS-based</span></span> | <span data-ttu-id="59620-145">說明和詳細資料</span><span class="sxs-lookup"><span data-stu-id="59620-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="59620-146">應用程式一致性</span><span class="sxs-lookup"><span data-stu-id="59620-146">Application consistency</span></span> |<span data-ttu-id="59620-147">是 - 適用於 Windows</span><span class="sxs-lookup"><span data-stu-id="59620-147">Yes for Windows</span></span>|<span data-ttu-id="59620-148">對於工作負載而言，最理想的情況是應用程式一致性，因為它確保：</span><span class="sxs-lookup"><span data-stu-id="59620-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="59620-149">hello VM*開機*。</span><span class="sxs-lookup"><span data-stu-id="59620-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="59620-150">不會毀損。</span><span class="sxs-lookup"><span data-stu-id="59620-150">There is *no corruption*.</span></span> <li><span data-ttu-id="59620-151">不會遺失資料。</span><span class="sxs-lookup"><span data-stu-id="59620-151">There is *no data loss*.</span></span><li> <span data-ttu-id="59620-152">hello 資料是備份的使用 hello 資料涉及 hello 次-使用 VSS 或備份前/備份後指令碼的 hello 應用程式的一致 toohello 應用程式。</span><span class="sxs-lookup"><span data-stu-id="59620-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="59620-153">*Windows Vm*-最 Microsoft 工作負載具有執行工作負載的特定動作相關的 toodata 一致性的 VSS 寫入器。</span><span class="sxs-lookup"><span data-stu-id="59620-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="59620-154">例如，Microsoft SQL Server 具有 VSS 寫入器，以確保正確完成 hello 寫入 toohello 交易記錄檔和 hello 資料庫。</span><span class="sxs-lookup"><span data-stu-id="59620-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="59620-155">對於 Azure Windows VM 備份，toocreate 應用程式一致復原點，hello 備用分機號碼必須叫用 hello VSS 工作流程，並先完成它再取得 hello VM 快照集。</span><span class="sxs-lookup"><span data-stu-id="59620-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="59620-156">Hello Azure VM 的快照集 toobe 精確，必須也完成 hello VSS 寫入器的 Azure VM 的所有應用程式。</span><span class="sxs-lookup"><span data-stu-id="59620-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="59620-157">(深入了解 hello [VSS 的基本概念](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx)深入探討的 hello 詳細資料和[它的運作方式](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx))。</span><span class="sxs-lookup"><span data-stu-id="59620-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="59620-158">*Linux Vm*位客戶可以執行[自訂前指令碼和後置指令碼 tooensure 應用程式一致性](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent)。</span><span class="sxs-lookup"><span data-stu-id="59620-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="59620-159">檔案系統一致性</span><span class="sxs-lookup"><span data-stu-id="59620-159">File-system consistency</span></span> |<span data-ttu-id="59620-160">是 - 適用於 Windows 電腦</span><span class="sxs-lookup"><span data-stu-id="59620-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="59620-161">有兩種案例其中 hello 復原點可以是*檔案系統一致*:</span><span class="sxs-lookup"><span data-stu-id="59620-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="59620-162">Azure 中 Linux VM 的備份，沒有前指令碼/後指令碼，或是前指令碼/後指令碼失敗。</span><span class="sxs-lookup"><span data-stu-id="59620-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="59620-163">在 Azure 中備份 Windows VM 期間發生的 VSS 失敗。</span><span class="sxs-lookup"><span data-stu-id="59620-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="59620-164">這兩個這種情況，hello 最佳因應是 tooensure 的：</span><span class="sxs-lookup"><span data-stu-id="59620-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="59620-165">hello VM*開機*。</span><span class="sxs-lookup"><span data-stu-id="59620-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="59620-166">不會毀損。</span><span class="sxs-lookup"><span data-stu-id="59620-166">There is *no corruption*.</span></span><li><span data-ttu-id="59620-167">不會遺失資料。</span><span class="sxs-lookup"><span data-stu-id="59620-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="59620-168">應用程式需要 tooimplement 自己"v-table 修正"hello 還原資料的機制。</span><span class="sxs-lookup"><span data-stu-id="59620-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="59620-169">損毀一致性</span><span class="sxs-lookup"><span data-stu-id="59620-169">Crash consistency</span></span> |<span data-ttu-id="59620-170">否</span><span class="sxs-lookup"><span data-stu-id="59620-170">No</span></span> |<span data-ttu-id="59620-171">這種情況下都是相等 tooa 遇到 「 當機 」 的虛擬機器 （透過彈性或固定，重設）。</span><span class="sxs-lookup"><span data-stu-id="59620-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="59620-172">Hello Azure 虛擬機器關機時備份的 hello 時，通常會發生損毀一致性。</span><span class="sxs-lookup"><span data-stu-id="59620-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="59620-173">當機一致復原點提供 hello 儲存媒體-從的 hello 作業系統或 hello 應用程式的觀點來看 hello hello 資料一致性的 hello 周圍的任何保證。</span><span class="sxs-lookup"><span data-stu-id="59620-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="59620-174">只有 hello 磁碟已經有 hello 備份時的 hello 資料擷取及備份。</span><span class="sxs-lookup"><span data-stu-id="59620-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="59620-175">雖然通常不會有任何的保證，hello 作業系統開機時，後面接著檢查磁碟的程序，例如 chkdsk toofix 任何損毀錯誤。</span><span class="sxs-lookup"><span data-stu-id="59620-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="59620-176">任何記憶體中的資料或有尚未傳送的 toohello 磁碟的寫入都會遺失。</span><span class="sxs-lookup"><span data-stu-id="59620-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="59620-177">當資料復原需要完成的 toobe hello 應用程式通常遵循與它自己的驗證機制。</span><span class="sxs-lookup"><span data-stu-id="59620-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="59620-178">例如，如果 hello 交易記錄檔具有不存在 hello 資料庫中的項目然後 hello 資料庫軟體會執行回復直到 hello 資料是一致的。</span><span class="sxs-lookup"><span data-stu-id="59620-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="59620-179">時資料則會分散到多個虛擬磁碟，（例如跨距磁碟區），當機一致復原點會提供任何保證的 hello 正確性的 hello 資料。</span><span class="sxs-lookup"><span data-stu-id="59620-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="59620-180">效能與資源使用率</span><span class="sxs-lookup"><span data-stu-id="59620-180">Performance and resource utilization</span></span>
<span data-ttu-id="59620-181">和內部部署的備份軟體一樣，在 Azure 中備份 VM 時也應該規劃容量和資源使用率需求。</span><span class="sxs-lookup"><span data-stu-id="59620-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="59620-182">hello [Azure 儲存體限制](../azure-subscription-service-limits.md#storage-limits)定義 toostructure VM 部署 tooget 最大效能最少對 toorunning 工作負載的影響。</span><span class="sxs-lookup"><span data-stu-id="59620-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="59620-183">請特別注意 toohello 規劃備份效能時，會限制下列 Azure 儲存體：</span><span class="sxs-lookup"><span data-stu-id="59620-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="59620-184">每一儲存體帳戶的輸出上限</span><span class="sxs-lookup"><span data-stu-id="59620-184">Max egress per storage account</span></span>
* <span data-ttu-id="59620-185">每一儲存體帳戶的總要求率</span><span class="sxs-lookup"><span data-stu-id="59620-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="59620-186">儲存體帳戶限制</span><span class="sxs-lookup"><span data-stu-id="59620-186">Storage account limits</span></span>
<span data-ttu-id="59620-187">備份資料複製從儲存體帳戶、 加入 toohello 輸入/輸出作業 (iops) 與輸出 （或輸送量） hello 儲存體帳戶的度量。</span><span class="sxs-lookup"><span data-stu-id="59620-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="59620-188">在 hello 相同 IOPS 及輸送量，也會耗用時間、 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="59620-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="59620-189">hello 目標是 tooensure 備份，且虛擬機器流量不要超過您的儲存體帳戶限制。</span><span class="sxs-lookup"><span data-stu-id="59620-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="59620-190">磁碟數量</span><span class="sxs-lookup"><span data-stu-id="59620-190">Number of disks</span></span>
<span data-ttu-id="59620-191">hello 備份程序會盡快嘗試 toocomplete 備份工作。</span><span class="sxs-lookup"><span data-stu-id="59620-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="59620-192">過程中，它會竭盡所能地取用資源。</span><span class="sxs-lookup"><span data-stu-id="59620-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="59620-193">不過，所有的 I/O 作業都受到 hello*單一 Blob 的目標輸送量*，其中包含每秒 60 MB 的限制。</span><span class="sxs-lookup"><span data-stu-id="59620-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="59620-194">在嘗試 toomaximize 速度，hello 備份程序會嘗試在每個 hello VM 磁碟 tooback*平行*。</span><span class="sxs-lookup"><span data-stu-id="59620-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="59620-195">如果 VM 有四個磁碟，hello 服務會嘗試 tooback 平行中的所有四個磁碟上。</span><span class="sxs-lookup"><span data-stu-id="59620-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="59620-196">hello**的磁碟數目**進行備份，是決定儲存體帳戶的備份資料傳輸 hello 最重要因素。</span><span class="sxs-lookup"><span data-stu-id="59620-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="59620-197">備份排程</span><span class="sxs-lookup"><span data-stu-id="59620-197">Backup schedule</span></span>
<span data-ttu-id="59620-198">另一個因素會影響效能是 hello**備份排程**。</span><span class="sxs-lookup"><span data-stu-id="59620-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="59620-199">如果您設定 hello 原則讓所有 Vm 都備份是在 hello 相同時間，您已排定流量夾紙。</span><span class="sxs-lookup"><span data-stu-id="59620-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="59620-200">hello 備份程序會嘗試 tooback 平行中的所有磁碟上。</span><span class="sxs-lookup"><span data-stu-id="59620-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="59620-201">tooreduce hello 備份資料傳輸從儲存體帳戶，在不同時間 hello，無重疊的不同 Vm 備份。</span><span class="sxs-lookup"><span data-stu-id="59620-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="59620-202">容量規劃</span><span class="sxs-lookup"><span data-stu-id="59620-202">Capacity planning</span></span>
<span data-ttu-id="59620-203">您將 hello 先前因素拼湊在一起，需要 tooplan hello 儲存體帳戶的使用量需求。</span><span class="sxs-lookup"><span data-stu-id="59620-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="59620-204">下載 hello [VM 備份容量規劃 Excel 試算表](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33)toosee hello 影響您的磁碟和備份排程選項。</span><span class="sxs-lookup"><span data-stu-id="59620-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="59620-205">備份輸送量</span><span class="sxs-lookup"><span data-stu-id="59620-205">Backup throughput</span></span>
<span data-ttu-id="59620-206">每個磁碟備份，Azure Backup 讀取 hello 磁碟上的 hello 區塊並儲存區僅 hello 變更的資料 （增量備份）。</span><span class="sxs-lookup"><span data-stu-id="59620-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="59620-207">hello 下表顯示 hello 平均備份服務處理量值。</span><span class="sxs-lookup"><span data-stu-id="59620-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="59620-208">使用下列資料的 hello，您可以估計 hello 一段時間所需 tooback 設定大小的磁碟。</span><span class="sxs-lookup"><span data-stu-id="59620-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="59620-209">備份作業</span><span class="sxs-lookup"><span data-stu-id="59620-209">Backup operation</span></span> | <span data-ttu-id="59620-210">最佳輸送量</span><span class="sxs-lookup"><span data-stu-id="59620-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="59620-211">初始備份</span><span class="sxs-lookup"><span data-stu-id="59620-211">Initial backup</span></span> |<span data-ttu-id="59620-212">160 Mbps</span><span class="sxs-lookup"><span data-stu-id="59620-212">160 Mbps</span></span> |
| <span data-ttu-id="59620-213">增量備份 (DR)</span><span class="sxs-lookup"><span data-stu-id="59620-213">Incremental backup (DR)</span></span> |<span data-ttu-id="59620-214">640 Mbps </span><span class="sxs-lookup"><span data-stu-id="59620-214">640 Mbps</span></span> <br><br> <span data-ttu-id="59620-215">輸送量卸除大幅如果 hello 變更 （需要 toobe 備份） 的資料會散佈在 hello 磁碟。</span><span class="sxs-lookup"><span data-stu-id="59620-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="59620-216">VM 備份時間總計</span><span class="sxs-lookup"><span data-stu-id="59620-216">Total VM backup time</span></span>
<span data-ttu-id="59620-217">雖然讀取和複製資料，會花費大部分的 hello 備份時間，其他作業提供 toohello 所需的總時間 tooback 將 vm:</span><span class="sxs-lookup"><span data-stu-id="59620-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="59620-218">太所需時間[安裝或更新 hello 備用分機號碼](backup-azure-vms.md)。</span><span class="sxs-lookup"><span data-stu-id="59620-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="59620-219">快照集時間，也就是 hello 所花費時間 tootrigger 快照集。</span><span class="sxs-lookup"><span data-stu-id="59620-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="59620-220">快照集是觸發排程的關閉 toohello 備份時間。</span><span class="sxs-lookup"><span data-stu-id="59620-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="59620-221">佇列等候時間。</span><span class="sxs-lookup"><span data-stu-id="59620-221">Queue wait time.</span></span> <span data-ttu-id="59620-222">因為 hello 備份服務正在處理來自多個客戶的備份，備份資料複製快照集 toohello 備份或復原服務保存庫可能會立即啟動。</span><span class="sxs-lookup"><span data-stu-id="59620-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="59620-223">在尖峰負載的時間，hello 等候可以延伸 tooeight 到期的備份正在處理的 toohello 數的時數。</span><span class="sxs-lookup"><span data-stu-id="59620-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="59620-224">不過，hello VM 備份時間總計會是小於 24 小時內的每日備份原則。</span><span class="sxs-lookup"><span data-stu-id="59620-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="59620-225">資料傳輸時間，備份所需時間服務從先前的備份 toocompute hello 累加式變更和傳輸這些變更 toovault 儲存體。</span><span class="sxs-lookup"><span data-stu-id="59620-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="59620-226">為何我看到的備份時間比較長 (大於 12 小時)？</span><span class="sxs-lookup"><span data-stu-id="59620-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="59620-227">備份包含兩個階段： 建立快照集，以及傳送 hello 快照 toohello 保存庫。</span><span class="sxs-lookup"><span data-stu-id="59620-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="59620-228">對儲存體進行最佳化 hello 備份服務。</span><span class="sxs-lookup"><span data-stu-id="59620-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="59620-229">當傳送嗨快照集資料 tooa 保存庫，hello 服務只將累加變更從 hello 上一個快照。</span><span class="sxs-lookup"><span data-stu-id="59620-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="59620-230">toodetermine hello 累加變更，hello 服務計算 hello 區塊 hello 總和檢查的碼。</span><span class="sxs-lookup"><span data-stu-id="59620-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="59620-231">如果變更的區塊，hello 區塊會被視為區塊 toobe 傳送 toohello 保存庫。</span><span class="sxs-lookup"><span data-stu-id="59620-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="59620-232">然後 hello 服務向下切入進一步到每一個 hello 識別機會 toominimize hello 資料 tootransfer 尋找的區塊。</span><span class="sxs-lookup"><span data-stu-id="59620-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="59620-233">在評估所有已變更的區塊之後, hello 服務聯合 hello 變更，並將它們傳送 toohello 保存庫。</span><span class="sxs-lookup"><span data-stu-id="59620-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="59620-234">對部分舊版應用程式來說，小型的分散式寫入並非最適合用於儲存體。</span><span class="sxs-lookup"><span data-stu-id="59620-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="59620-235">如果 hello 快照集包含許多小型的分散寫入，hello 服務會花更多時間處理 hello hello 應用程式所寫入的資料。</span><span class="sxs-lookup"><span data-stu-id="59620-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="59620-236">hello 建議 hello VM 內執行的應用程式從 Azure 應用程式寫入區塊是最少為 8 KB。</span><span class="sxs-lookup"><span data-stu-id="59620-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="59620-237">如果您的應用程式使用小於 8 KB 的區塊，則備份效能會受到影響。</span><span class="sxs-lookup"><span data-stu-id="59620-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="59620-238">透過調整應用程式 tooimprove 備份效能的說明，請參閱[調整應用程式以獲得最佳效能與 Azure 儲存體](../storage/common/storage-premium-storage-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="59620-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="59620-239">雖然 hello 備份效能上的發行項使用 Premium 儲存體的範例，但是 hello 指引是適用於標準儲存體磁碟。</span><span class="sxs-lookup"><span data-stu-id="59620-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="59620-240">總計還原時間</span><span class="sxs-lookup"><span data-stu-id="59620-240">Total restore time</span></span>
<span data-ttu-id="59620-241">還原作業是由兩個主要子工作所組成： 將資料複製回從 hello 保存庫選擇 toohello 客戶儲存體帳戶，以及建立 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="59620-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="59620-242">複製回 hello 保存庫中的資料取決於 hello 備份儲存在內部在 Azure 中，以及 hello 客戶儲存體帳戶的儲存位置。</span><span class="sxs-lookup"><span data-stu-id="59620-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="59620-243">時間 toocopy 資料而定：</span><span class="sxs-lookup"><span data-stu-id="59620-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="59620-244">佇列會等待時間-因為 hello 服務處理程序從多個客戶在 hello 還原作業相同的時間還原要求會放在佇列中。</span><span class="sxs-lookup"><span data-stu-id="59620-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="59620-245">資料複製時間-從 hello 保存庫 toohello 客戶儲存體帳戶複製資料。</span><span class="sxs-lookup"><span data-stu-id="59620-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="59620-246">還原時間取決於 IOPS 及輸送量 Azure 備份服務取得 hello 選取客戶儲存體帳戶上。</span><span class="sxs-lookup"><span data-stu-id="59620-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="59620-247">tooreduce hello 複製 hello 還原程序期間，請選取未使用其他應用程式寫入與讀取載入儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="59620-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="59620-248">最佳作法</span><span class="sxs-lookup"><span data-stu-id="59620-248">Best practices</span></span>
<span data-ttu-id="59620-249">在設定虛擬機器的備份時，建議您遵循下列做法：</span><span class="sxs-lookup"><span data-stu-id="59620-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="59620-250">不要排程超過 10 個傳統的 Vm 從 hello 相同雲端服務 tooback hello 在相同的時間。</span><span class="sxs-lookup"><span data-stu-id="59620-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="59620-251">如果您想 tooback 啟動相同的雲端服務從多個 Vm，錯開 hello 備份開始時間一小時。</span><span class="sxs-lookup"><span data-stu-id="59620-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="59620-252">不要排程在 hello 向上 40 個以上的 Vm tooback 相同的時間。</span><span class="sxs-lookup"><span data-stu-id="59620-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="59620-253">安排 VM 備份在非尖峰時段進行。</span><span class="sxs-lookup"><span data-stu-id="59620-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="59620-254">此方式 hello 備份服務會使用 IOPS 從 hello 客戶儲存體帳戶 toohello 保存庫傳輸資料。</span><span class="sxs-lookup"><span data-stu-id="59620-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="59620-255">確定有原則套用至橫跨不同儲存體帳戶的 VM。</span><span class="sxs-lookup"><span data-stu-id="59620-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="59620-256">我們建議您不能超過 20 來自單一儲存體帳戶的總磁碟受 hello 相同的備份排程。</span><span class="sxs-lookup"><span data-stu-id="59620-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="59620-257">如果您有大於 20 磁碟儲存體帳戶中，散佈跨多個原則 tooget 這些 Vm 會 hello hello 傳輸程序階段 hello 備份所需的 IOPS。</span><span class="sxs-lookup"><span data-stu-id="59620-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="59620-258">請勿還原 Premium 儲存體 toosame 儲存體帳戶上執行的 VM。</span><span class="sxs-lookup"><span data-stu-id="59620-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="59620-259">如果 hello 還原作業的程序會伴隨 hello 備份作業，它會減少 hello 可用備份的 IOPS。</span><span class="sxs-lookup"><span data-stu-id="59620-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="59620-260">若要進行進階 VM 備份，請確定裝載進階磁碟的儲存體帳戶至少有 50% 的可用空間可供暫存快照集，以便能順利完成備份。</span><span class="sxs-lookup"><span data-stu-id="59620-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="59620-261">請確定為了進行備份而在 Linux VM 上啟用的 python 版本為 2.7</span><span class="sxs-lookup"><span data-stu-id="59620-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="59620-262">資料加密</span><span class="sxs-lookup"><span data-stu-id="59620-262">Data encryption</span></span>
<span data-ttu-id="59620-263">Azure Backup 不會加密資料 hello 備份程序的一部分。</span><span class="sxs-lookup"><span data-stu-id="59620-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="59620-264">不過，您可以在 hello VM 內的資料加密和備份 hello 受保護的資料緊密 (深入了解[加密資料的備份](backup-azure-vms-encryption.md))。</span><span class="sxs-lookup"><span data-stu-id="59620-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="59620-265">受保護的執行個體的計算 hello 成本</span><span class="sxs-lookup"><span data-stu-id="59620-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="59620-266">透過 Azure Backup 備份的 azure 虛擬機器也都是主體[Azure 備份定價](https://azure.microsoft.com/pricing/details/backup/)。</span><span class="sxs-lookup"><span data-stu-id="59620-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="59620-267">hello 受保護的執行個體計算根據 hello*實際*hello 虛擬機器，也就是 hello 總和的 hello 虛擬機器 – 排除 hello 「 資源磁碟 」 中的所有 hello 資料的大小</span><span class="sxs-lookup"><span data-stu-id="59620-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="59620-268">定價備份 Vm*不*根據 hello 最大支援為每個資料磁碟附加的 toohello 虛擬機器的大小。</span><span class="sxs-lookup"><span data-stu-id="59620-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="59620-269">定價會根據 hello hello 資料磁碟中所儲存的實際資料。</span><span class="sxs-lookup"><span data-stu-id="59620-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="59620-270">同樣地，hello 備份儲存體帳單根據 hello 會儲存在 Azure 備份，這是 hello 總和的每個復原點中的 hello 實際資料的資料量。</span><span class="sxs-lookup"><span data-stu-id="59620-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="59620-271">例如，A2 標準大小的虛擬機器擁有兩個額外資料磁碟，每個大小上限為 1 TB。</span><span class="sxs-lookup"><span data-stu-id="59620-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="59620-272">hello 下表提供每個這些磁碟上儲存的 hello 實際資料：</span><span class="sxs-lookup"><span data-stu-id="59620-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="59620-273">磁碟類型</span><span class="sxs-lookup"><span data-stu-id="59620-273">Disk type</span></span> | <span data-ttu-id="59620-274">大小上限</span><span class="sxs-lookup"><span data-stu-id="59620-274">Max size</span></span> | <span data-ttu-id="59620-275">實際儲存的資料</span><span class="sxs-lookup"><span data-stu-id="59620-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="59620-276">作業系統磁碟</span><span class="sxs-lookup"><span data-stu-id="59620-276">Operating system disk</span></span> |<span data-ttu-id="59620-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="59620-277">1023 GB</span></span> |<span data-ttu-id="59620-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="59620-278">17 GB</span></span> |
| <span data-ttu-id="59620-279">本機磁碟/資源磁碟</span><span class="sxs-lookup"><span data-stu-id="59620-279">Local disk / Resource disk</span></span> |<span data-ttu-id="59620-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="59620-280">135 GB</span></span> |<span data-ttu-id="59620-281">5 GB (未包含備份)</span><span class="sxs-lookup"><span data-stu-id="59620-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="59620-282">資料磁碟 1</span><span class="sxs-lookup"><span data-stu-id="59620-282">Data disk 1</span></span> |<span data-ttu-id="59620-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="59620-283">1023 GB</span></span> |<span data-ttu-id="59620-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="59620-284">30 GB</span></span> |
| <span data-ttu-id="59620-285">資料磁碟 2</span><span class="sxs-lookup"><span data-stu-id="59620-285">Data disk 2</span></span> |<span data-ttu-id="59620-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="59620-286">1023 GB</span></span> |<span data-ttu-id="59620-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="59620-287">0 GB</span></span> |

<span data-ttu-id="59620-288">hello*實際*hello 虛擬機器的大小，在此情況下為 17 GB + 30 GB + 0 GB = 47 GB。</span><span class="sxs-lookup"><span data-stu-id="59620-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="59620-289">此受保護執行個體大小 (47 GB) 會變成 hello 基礎 hello 每月帳單。</span><span class="sxs-lookup"><span data-stu-id="59620-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="59620-290">為 hello hello 虛擬機器中的資料量增加時，據此計費的變更所使用的 hello 受保護執行個體大小。</span><span class="sxs-lookup"><span data-stu-id="59620-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="59620-291">計費 hello 的第一個成功備份作業完成之前無法啟動。</span><span class="sxs-lookup"><span data-stu-id="59620-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="59620-292">此時，開始 hello 計費儲存體及受保護的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59620-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="59620-293">計費仍會繼續，因為沒有*任何備份保存庫中儲存資料*hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="59620-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="59620-294">如果您停止 hello 的虛擬機器的保護，但有保存庫中的虛擬機器備份資料，計費仍會繼續。</span><span class="sxs-lookup"><span data-stu-id="59620-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="59620-295">針對指定的虛擬機器停止才停止 hello 保護計費*和*刪除所有備份的資料。</span><span class="sxs-lookup"><span data-stu-id="59620-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="59620-296">當停止保護並沒有作用中的備份作業、 的 hello 上次成功 VM 備份的 hello 大小變得 hello hello 每月帳單所使用的受保護執行個體大小。</span><span class="sxs-lookup"><span data-stu-id="59620-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="59620-297">有疑問嗎？</span><span class="sxs-lookup"><span data-stu-id="59620-297">Questions?</span></span>
<span data-ttu-id="59620-298">如果您有任何問題，或如果沒有任何功能，您想要納入，toosee[傳送意見反應](http://aka.ms/azurebackup_feedback)。</span><span class="sxs-lookup"><span data-stu-id="59620-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="59620-299">後續步驟</span><span class="sxs-lookup"><span data-stu-id="59620-299">Next steps</span></span>
* [<span data-ttu-id="59620-300">備份虛擬機器</span><span class="sxs-lookup"><span data-stu-id="59620-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="59620-301">管理虛擬機器備份</span><span class="sxs-lookup"><span data-stu-id="59620-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="59620-302">還原虛擬機器</span><span class="sxs-lookup"><span data-stu-id="59620-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="59620-303">疑難排解 VM 備份問題</span><span class="sxs-lookup"><span data-stu-id="59620-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
