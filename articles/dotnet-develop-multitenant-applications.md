---
title: "多租用戶 Web 應用程式模式 | Microsoft Docs"
description: "找出說明如何在 Azure 實作多租用戶 Web 應用程式的結構概觀和設計模式。"
services: 
documentationcenter: .net
author: wadepickett
manager: wpickett
editor: 
ms.assetid: 4f0281d2-1555-42b0-a99d-1222fade0b0f
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/05/2015
ms.author: wpickett
ms.openlocfilehash: 57ba0e46139bda2d74c9f7db0ffab2f2122b0df2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="multitenant-applications-in-azure"></a>Azure 中的多租用戶應用程式
多租用戶應用程式是一種共用資源，可讓個別使用者 (或「租用戶」) 將應用程式視為其本身的應用程式。 適用多租用戶應用程式的常見情況，是應用程式的所有使用者都想自訂個人的使用性，但另一方面又有相同的基本商業需求時。 舉例來說，Office 365、Outlook.com 和 visualstudio.com 都屬於大型多租用戶應用程式。

就應用程式提供者的觀點而言，多租用戶的好處大多與營運和成本效益有關。 您的某個應用程式版本可能符合許多租用戶/客戶的需求，而促使監視、效能調整、軟體維護和資料備份等系統管理工作得以整合。

以下將以提供者的角度列舉最重要的目標和需求。

* **佈建**：您必須能夠為應用程式佈建新的租用戶。  就租用戶為數眾多的多租用戶應用程式而言，通常必須藉由啟用自助式佈建功能將此程序自動化。
* **可維護性**：您必須能夠在多名租用戶使用應用程式時，升級應用程式和執行其他維護工作。
* **監視**：您必須能夠不間斷地監視應用程式，以識別出所有問題並加以疑難排解。 監視每個租用戶使用應用程式的情形，也是其中一環。

適當實作的多租用戶應用程式，可為使用者提供下列好處。

* **隔離**：個別租用戶的活動不會影響其他租用戶使用應用程式。 租用戶之間無法相互存取資料。 對租用戶而言，應用程式就如同是他們專用的一般。
* **可用性**：個別租用戶希望應用程式能持續保有可用性，若能在 SLA 中明訂相關保證最好。 再次重申，其他租用戶的活動不會影響應用程式的可用性。
* **延展性**：應用程式可根據個別租用戶的需求調整。 其他租用戶的存在與動作不會影響應用程式的效能。
* **成本**：成本比執行專用的單一租用戶應用程式低廉，因為在多租用的環境下可共用資源。
* **自訂能力**。 能夠以各種方式為個別租用戶自訂應用程式，例如新增或移除功能、變更色彩或標誌，甚或新增自己的程式碼或指令碼。

簡言之，要提供具有高度延展性的服務，的確需要考量許多事項，但也有不少目標和需求是許多多租用戶應用程式所共有的。 有些可能與特定案例無關，且個別目標和需求的重要性也可能隨著案例而不同。 如果您是多租用戶應用程式的提供者，您也會有目標和需求，例如：達到租用戶的目標和需求、利潤、收費、多重服務層級、佈建、可維護性監視和自動化等。

若想進一步了解多租用戶應用程式的其他設計注意事項，請參閱[在 Azure 上裝載多租用戶應用程式][Hosting a Multi-Tenant Application on Azure] \(英文\)。 如需多租用戶型軟體即服務 (SaaS) 資料庫應用程式的常見資料架構模式的資訊，請參閱 [多租用戶 SaaS 應用程式與 Azure SQL Database 的設計模式](sql-database/sql-database-design-patterns-multi-tenancy-saas-applications.md)。 

Azure 有多項功能可讓您處理在設計多租用戶系統時遇到的重大問題。

**隔離**

* 依主機標頭區隔具有 (或沒有) SSL 通訊的網站租用戶
* 依查詢參數區隔網站租用戶
* 背景工作角色中的 Web 服務
  * 背景工作角色： 通常在應用程式後端處理資料。
  * 通常作為應用程式前端的 Web 角色。

**儲存體**

資料管理 (例如 Azure SQL Database) 或 Azure 儲存體服務 (例如為大量非結構化資料提供儲存服務的表格服務)，以及為大量非結構化文字或二進位資料 (例如視訊、音訊和影像) 提供儲存服務的 Blob 服務。

* 在 SQL Database 中保護多租用戶資料的安全：適當的個別租用戶 SQL Server 登入。
* 使用適用於應用程式資源的 Azure 資料表：指定容器層級存取原則，將使您能夠直接調整權限，而無須針對受到共用存取簽章保護的資源發出新的 URL。
* 適用於應用程式資源的 Azure 佇列：Azure 佇列通常用來協助租用戶執行處理，但也可用來配送佈建或管理所需的工作。
* 適用於應用程式資源的服務匯流排佇列可將工作發送至共用服務，因此您可以使用單一佇列，讓每個租用戶傳送者僅具有推送至該佇列的權限 (衍生自 ACS 所發出的宣告)，同時只讓服務的接收者有權從佇列中提取多個租用戶所傳來的資料。

**連接和安全性服務**

* Azure 服務匯流排是存在於應用程式之間的訊息基礎結構，可讓應用程式以鬆散耦合的方式交換訊息，以提升延展性與恢復能力。

**網路服務**

Azure 提供了幾項支援驗證、並且可讓受到代管的應用程式提升可管理性的網路服務。 這些服務包括：

* Azure 虛擬網路可讓您在 Azure 中佈建及管理虛擬私人網路 (VPN)，並使用內部部署 IT 基礎結構安全地連結這些網路。
* 虛擬網路流量管理員可讓您對多個代管 Azure 服務間的傳入流量進行負載平衡，無論這些服務是在相同的資料中心內執行，還是在世界各地不同的資料中心間執行。
* Azure Active Directory (Azure AD) 是以 REST 為基礎的新式服務，可為您的雲端應用程式提供身分識別管理和存取控制功能。 使用適用於應用程式資源的 Azure AD，可讓您輕鬆地對要存取您的 Web 應用程式和服務的使用者進行驗證和授權，並可讓您在程式碼中排除驗證和授權功能的考量。
* Azure 服務匯流排可為分散式和混合式應用程式提供安全訊息和資料流程功能 (例如 Azure 代管的應用程式與內部部署應用程式和服務之間的通訊)，而無須使用複雜的防火牆和安全性基礎結構。 使用適用於應用程式資源的服務匯流排轉送：公開為端點的服務可能是屬於租用戶的服務 (例如，在內部部署環境之類的系統外部受到代管的服務)，或者可能是明確針對租用戶佈建的服務 (因為敏感的租用戶特定資料會透過這些服務進行傳送)。

**佈建資源**

Azure 提供許多可為應用程式佈建新租用戶的方式。 就租用戶為數眾多的多租用戶應用程式而言，通常必須藉由啟用自助式佈建功能將此程序自動化。

* 背景工作角色可讓您佈建及取消佈建個別的租用戶資源 (例如在新租用戶註冊或取消時)、收集用於計量的度量，以及管理特定排程之後或超出關鍵效能指標臨界值時所做的因應調整。 此角色也可用來將更新和升級推送至方案。
* Azure Blob 可用來為新租用戶佈建計算或預先初始化的儲存資源，同時提供容器層級存取原則，以保護計算服務封裝、VHD 映像和其他資源。
* 為租用戶佈建 SQL Database 資源的選項包括：
  
  * 指令碼中的 DDL，或在組件中內嵌為資源的 DDL
  * 以程式設計方式部署的 SQL Server 2008 R2 DAC 封裝。
  * 從主要參考資料庫複製
  * 使用資料庫匯入和匯出功能，從檔案佈建新資料庫。

<!--links-->

[Hosting a Multi-Tenant Application on Azure]: http://msdn.microsoft.com/library/hh534480.aspx
[Designing Multitenant Applications on Azure]: http://msdn.microsoft.com/library/windowsazure/hh689716
