---
title: "Azure 虛擬機器規模集的考量 aaaDesign |Microsoft 文件"
description: "深入了解 Azure 虛擬機器擴展集的設計考量"
keywords: "linux 虛擬機器, 虛擬機器擴展集"
services: virtual-machine-scale-sets
documentationcenter: 
author: gatneil
manager: madhana
editor: tysonn
tags: azure-resource-manager
ms.assetid: c27c6a59-a0ab-4117-a01b-42b049464ca1
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 06/01/2017
ms.author: negat
ms.openlocfilehash: f8644d36fe5903bd4b74df26dca5dc3211ee3516
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="design-considerations-for-scale-sets"></a><span data-ttu-id="c04f0-104">擴展集的設計考量</span><span class="sxs-lookup"><span data-stu-id="c04f0-104">Design Considerations For Scale Sets</span></span>
<span data-ttu-id="c04f0-105">本主題會討論虛擬機器擴展集的設計考量。</span><span class="sxs-lookup"><span data-stu-id="c04f0-105">This topic discusses design considerations for Virtual Machine Scale Sets.</span></span> <span data-ttu-id="c04f0-106">如需虛擬機器擴展集為何，請參閱太[虛擬機器規模集概觀](virtual-machine-scale-sets-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-106">For information about what Virtual Machine Scale Sets are, refer too[Virtual Machine Scale Sets Overview](virtual-machine-scale-sets-overview.md).</span></span>

## <a name="when-toouse-scale-sets-instead-of-virtual-machines"></a><span data-ttu-id="c04f0-107">當 toouse 小數位數設定而不是虛擬機器嗎？</span><span class="sxs-lookup"><span data-stu-id="c04f0-107">When toouse scale sets instead of virtual machines?</span></span>
<span data-ttu-id="c04f0-108">一般而言，擴展集適用於部署高可用性的基礎結構，其中會有一組電腦具備類似的組態。</span><span class="sxs-lookup"><span data-stu-id="c04f0-108">Generally, scale sets are useful for deploying highly available infrastructure where a set of machines have similar configuration.</span></span> <span data-ttu-id="c04f0-109">不過，部分功能僅適用於擴展集，而其他功能僅適用於 VM。</span><span class="sxs-lookup"><span data-stu-id="c04f0-109">However, some features are only available in scale sets while other features are only available in VMs.</span></span> <span data-ttu-id="c04f0-110">若要 toomake 明智的決策時 toouse 每種技術，我們應該先看一下的一些常用的 hello 功能只能在擴展集而不是 Vm:</span><span class="sxs-lookup"><span data-stu-id="c04f0-110">In order toomake an informed decision about when toouse each technology, we should first take a look at some of hello commonly used features that are available in scale sets but not VMs:</span></span>

### <a name="scale-set-specific-features"></a><span data-ttu-id="c04f0-111">擴展集特定的功能</span><span class="sxs-lookup"><span data-stu-id="c04f0-111">Scale set-specific features</span></span>

- <span data-ttu-id="c04f0-112">一旦您指定 hello 小數位數組設定，您可以只更新 「 容量 」 屬性 toodeploy hello 平行的多個 Vm。</span><span class="sxs-lookup"><span data-stu-id="c04f0-112">Once you specify hello scale set configuration, you can simply update hello "capacity" property toodeploy more VMs in parallel.</span></span> <span data-ttu-id="c04f0-113">這是比撰寫指令碼 tooorchestrate 部署許多個別的 Vm，以平行方式更簡單。</span><span class="sxs-lookup"><span data-stu-id="c04f0-113">This is much simpler than writing a script tooorchestrate deploying many individual VMs in parallel.</span></span>
- <span data-ttu-id="c04f0-114">您可以[使用 Azure 自動調整規模 tooautomatically 調整規模集](./virtual-machine-scale-sets-autoscale-overview.md)但不是個別的 Vm。</span><span class="sxs-lookup"><span data-stu-id="c04f0-114">You can [use Azure Autoscale tooautomatically scale a scale set](./virtual-machine-scale-sets-autoscale-overview.md) but not individual VMs.</span></span>
- <span data-ttu-id="c04f0-115">您可以[重新安裝擴展集 VM 的映像](https://docs.microsoft.com/rest/api/virtualmachinescalesets/manage-a-vm)，但[無法針對個別 VM](https://docs.microsoft.com/rest/api/compute/virtualmachines) 執行。</span><span class="sxs-lookup"><span data-stu-id="c04f0-115">You can [reimage scale set VMs](https://docs.microsoft.com/rest/api/virtualmachinescalesets/manage-a-vm) but [not individual VMs](https://docs.microsoft.com/rest/api/compute/virtualmachines).</span></span>
- <span data-ttu-id="c04f0-116">您可以[過度佈建](./virtual-machine-scale-sets-design-overview.md)擴展集 VM，以提高可靠性並加快部署速度。</span><span class="sxs-lookup"><span data-stu-id="c04f0-116">You can [overprovision](./virtual-machine-scale-sets-design-overview.md) scale set VMs for increased reliability and quicker deployment times.</span></span> <span data-ttu-id="c04f0-117">您無法這樣做與個別 Vm 除非您撰寫自訂程式碼 toodo 這。</span><span class="sxs-lookup"><span data-stu-id="c04f0-117">You cannot do this with individual VMs unless you write custom code toodo this.</span></span>
- <span data-ttu-id="c04f0-118">您可以指定[升級原則](./virtual-machine-scale-sets-upgrade-scale-set.md)toomake 它輕鬆 tooroll 出在擴展集 Vm 之間的升級。</span><span class="sxs-lookup"><span data-stu-id="c04f0-118">You can specify an [upgrade policy](./virtual-machine-scale-sets-upgrade-scale-set.md) toomake it easy tooroll out upgrades across VMs in your scale set.</span></span> <span data-ttu-id="c04f0-119">使用個別的 VM，您必須自行協調更新。</span><span class="sxs-lookup"><span data-stu-id="c04f0-119">With individual VMs, you must orchestrate updates yourself.</span></span>

### <a name="vm-specific-features"></a><span data-ttu-id="c04f0-120">VM 特定的功能</span><span class="sxs-lookup"><span data-stu-id="c04f0-120">VM-specific features</span></span>

<span data-ttu-id="c04f0-121">在 hello 另一方面，某些功能僅可用於在 Vm 中 (至少的 hello 時間):</span><span class="sxs-lookup"><span data-stu-id="c04f0-121">On hello other hand, some features are only available in VMs (at least for hello time being):</span></span>

- <span data-ttu-id="c04f0-122">您可以將附加資料磁碟 toospecific 個別 Vm，但連接的資料磁碟的所有 Vm 規模集中的設定。</span><span class="sxs-lookup"><span data-stu-id="c04f0-122">You can attach data disks toospecific individual VMs, but attached data disks are configured for all VMs in a scale set.</span></span>
- <span data-ttu-id="c04f0-123">您可以將非空白的資料磁碟 tooindividual Vm 但不是 Vm 規模集中的附加。</span><span class="sxs-lookup"><span data-stu-id="c04f0-123">You can attach non-empty data disks tooindividual VMs but not VMs in a scale set.</span></span>
- <span data-ttu-id="c04f0-124">您可以擷取個別 VM 的快照集，但無法針對擴展集中的 VM 執行。</span><span class="sxs-lookup"><span data-stu-id="c04f0-124">You can snapshot an individual VM but not a VM in a scale set.</span></span>
- <span data-ttu-id="c04f0-125">您可以擷取個別 VM 的映像，但無法擴展集中的 VM 執行。</span><span class="sxs-lookup"><span data-stu-id="c04f0-125">You can capture an image from an individual VM but not from a VM in a scale set.</span></span>
- <span data-ttu-id="c04f0-126">您可以從原生磁碟 toomanaged 磁碟，來移轉個別的 VM，但您無法這樣做為 Vm 規模集中的。</span><span class="sxs-lookup"><span data-stu-id="c04f0-126">You can migrate an individual VM from native disks toomanaged disks, but you cannot do this for VMs in a scale set.</span></span>
- <span data-ttu-id="c04f0-127">您可以指派 tooindividual VM nic IPv6 公用 IP 位址，但無法完成這項工作 Vm 規模集中的。</span><span class="sxs-lookup"><span data-stu-id="c04f0-127">You can assign IPv6 public IP addresses tooindividual VM nics but cannot do so for VMs in a scale set.</span></span> <span data-ttu-id="c04f0-128">請注意，您可以將 IPv6 公用 IP 位址指派任一個別 Vm 前面 tooload 平衡器或擴展集 Vm。</span><span class="sxs-lookup"><span data-stu-id="c04f0-128">Note that you can assign IPv6 public IP addresses tooload balancers in front of either individual VMs or scale set VMs.</span></span>

## <a name="storage"></a><span data-ttu-id="c04f0-129">儲存體</span><span class="sxs-lookup"><span data-stu-id="c04f0-129">Storage</span></span>

### <a name="scale-sets-with-azure-managed-disks"></a><span data-ttu-id="c04f0-130">包含 Azure 受控磁碟的擴展集</span><span class="sxs-lookup"><span data-stu-id="c04f0-130">Scale sets with Azure Managed Disks</span></span>
<span data-ttu-id="c04f0-131">擴展集可以使用 [Azure 受控磁碟](../virtual-machines/windows/managed-disks-overview.md)來建立，而不是傳統的 Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="c04f0-131">Scale sets can be created with [Azure Managed Disks](../virtual-machines/windows/managed-disks-overview.md) instead of traditional Azure storage accounts.</span></span> <span data-ttu-id="c04f0-132">受管理的磁碟可提供下列優點 hello:</span><span class="sxs-lookup"><span data-stu-id="c04f0-132">Managed Disks provide hello following benefits:</span></span>
- <span data-ttu-id="c04f0-133">您不需要 toopre-hello 擴展集 Vm 建立一組 Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="c04f0-133">You do not have toopre-create a set of Azure storage accounts for hello scale set VMs.</span></span>
- <span data-ttu-id="c04f0-134">您可以定義[附加資料磁碟](virtual-machine-scale-sets-attached-disks.md)hello Vm 在您的標尺的設定。</span><span class="sxs-lookup"><span data-stu-id="c04f0-134">You can define [attached data disks](virtual-machine-scale-sets-attached-disks.md) for hello VMs in your scale set.</span></span>
- <span data-ttu-id="c04f0-135">您可以設定規模集太[支援註冊 too1，集中 000 Vm](virtual-machine-scale-sets-placement-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-135">Scale sets can be configured too[support up too1,000 VMs in a set](virtual-machine-scale-sets-placement-groups.md).</span></span> 

<span data-ttu-id="c04f0-136">如果您有現有的範本，您也可以[更新 hello 範本 toouse 受管理磁碟](virtual-machine-scale-sets-convert-template-to-md.md)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-136">If you have an existing template, you can also [update hello template toouse Managed Disks](virtual-machine-scale-sets-convert-template-to-md.md).</span></span>

### <a name="user-managed-storage"></a><span data-ttu-id="c04f0-137">使用者管理的儲存體</span><span class="sxs-lookup"><span data-stu-id="c04f0-137">User-managed Storage</span></span>
<span data-ttu-id="c04f0-138">Azure 受管理的磁碟未定義擴展集依賴使用者建立的儲存體帳戶 toostore hello OS 磁碟的 hello 集合中的 hello Vm。</span><span class="sxs-lookup"><span data-stu-id="c04f0-138">A scale set that is not defined with Azure Managed Disks relies on user-created storage accounts toostore hello OS disks of hello VMs in hello set.</span></span> <span data-ttu-id="c04f0-139">每個儲存體帳戶，或小於 20 的 Vm 的比例，建議使用 tooachieve 最大 IO 也利用_過度佈建_（請參閱下文）。</span><span class="sxs-lookup"><span data-stu-id="c04f0-139">A ratio of 20 VMs per storage account or less is recommended tooachieve maximum IO and also take advantage of _overprovisioning_ (see below).</span></span> <span data-ttu-id="c04f0-140">也建議 hello 字母分散 hello 起始字元的 hello 儲存體帳戶名稱。</span><span class="sxs-lookup"><span data-stu-id="c04f0-140">It is also recommended that you spread hello beginning characters of hello storage account names across hello alphabet.</span></span> <span data-ttu-id="c04f0-141">這樣做有助於將負載分散到不同的內部系統。</span><span class="sxs-lookup"><span data-stu-id="c04f0-141">Doing so helps spread load across different internal systems.</span></span> 


## <a name="overprovisioning"></a><span data-ttu-id="c04f0-142">過度佈建</span><span class="sxs-lookup"><span data-stu-id="c04f0-142">Overprovisioning</span></span>
<span data-ttu-id="c04f0-143">小數位數設定目前預設太 「 過度佈建 」 的 Vm。</span><span class="sxs-lookup"><span data-stu-id="c04f0-143">Scale sets currently default too"overprovisioning" VMs.</span></span> <span data-ttu-id="c04f0-144">與過度佈建為開啟，hello 小數位數會設定實際旋轉啟動比系統要求您提供，多個 Vm，然後刪除的 hello 成功佈建額外的 Vm，一旦 hello 要求的 Vm 數目。</span><span class="sxs-lookup"><span data-stu-id="c04f0-144">With overprovisioning turned on, hello scale set actually spins up more VMs than you asked for, then deletes hello extra VMs once hello requested number of VMs are successfully provisioned.</span></span> <span data-ttu-id="c04f0-145">過度佈建可改善佈建成功率並縮短部署時間。</span><span class="sxs-lookup"><span data-stu-id="c04f0-145">Overprovisioning improves provisioning success rates and reduces deployment time.</span></span> <span data-ttu-id="c04f0-146">您就不需付費的 hello 額外的 Vm，而且它們不會計配額限制。</span><span class="sxs-lookup"><span data-stu-id="c04f0-146">You are not billed for hello extra VMs, and they do not count toward your quota limits.</span></span>

<span data-ttu-id="c04f0-147">儘管過度佈建並改善佈建的成功率，它可能會導致應用程式產生混淆的行為，是不設計的 toohandle 額外的 Vm 出現，然後消失。</span><span class="sxs-lookup"><span data-stu-id="c04f0-147">While overprovisioning does improve provisioning success rates, it can cause confusing behavior for an application that is not designed toohandle extra VMs appearing and then disappearing.</span></span> <span data-ttu-id="c04f0-148">tooturn 過度佈建，請確定您有下列字串在範本中的 hello: `"overprovision": "false"`。</span><span class="sxs-lookup"><span data-stu-id="c04f0-148">tooturn overprovisioning off, ensure you have hello following string in your template: `"overprovision": "false"`.</span></span> <span data-ttu-id="c04f0-149">更多詳細資料位於 hello[小數位數設定的 REST API 文件](/rest/api/virtualmachinescalesets/create-or-update-a-set)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-149">More details can be found in hello [Scale Set REST API documentation](/rest/api/virtualmachinescalesets/create-or-update-a-set).</span></span>

<span data-ttu-id="c04f0-150">如果小數位數組會使用受使用者管理的存放裝置，而且您關閉過度佈建，您可以有 20 個以上的 Vm，每個儲存體帳戶，但不是建議 toogo 上方 40 的 IO 效能的考量。</span><span class="sxs-lookup"><span data-stu-id="c04f0-150">If your scale set uses user-managed storage, and you turn off overprovisioning, you can have more than 20 VMs per storage account, but it is not recommended toogo above 40 for IO performance reasons.</span></span> 

## <a name="limits"></a><span data-ttu-id="c04f0-151">限制</span><span class="sxs-lookup"><span data-stu-id="c04f0-151">Limits</span></span>
<span data-ttu-id="c04f0-152">擴展集建立 Marketplace 映像 （也稱為平台映像），並設定的 toouse Azure 受管理磁碟支援 too1，000 Vm 的總容量。</span><span class="sxs-lookup"><span data-stu-id="c04f0-152">A scale set built on a Marketplace image (also known as a platform image) and configured toouse Azure Managed Disks supports a capacity of up too1,000 VMs.</span></span> <span data-ttu-id="c04f0-153">如果您設定您的小數位數組 toosupport 100 個以上的 Vm，並非所有的情況下工作 hello 相同 （適用於負載平衡的範例）。</span><span class="sxs-lookup"><span data-stu-id="c04f0-153">If you configure your scale set toosupport more than 100 VMs, not all scenarios work hello same (for example load balancing).</span></span> <span data-ttu-id="c04f0-154">如需詳細資訊，請參閱[使用大型的虛擬機器擴展集](virtual-machine-scale-sets-placement-groups.md)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-154">For more information, see [Working with large virtual machine scale sets](virtual-machine-scale-sets-placement-groups.md).</span></span> 

<span data-ttu-id="c04f0-155">在擴展集與使用者管理的儲存體帳戶設定為目前限制的 too100 Vm （和這個標尺的建議使用 5 個儲存體帳戶）。</span><span class="sxs-lookup"><span data-stu-id="c04f0-155">A scale set configured with user-managed storage accounts is currently limited too100 VMs (and 5 storage accounts are recommended for this scale).</span></span>

<span data-ttu-id="c04f0-156">建置的自訂映像 （一個由您所建立） 上的小數位數集可以有啟動 too100 Vm 時設定了 Azure 受管理的磁碟容量。</span><span class="sxs-lookup"><span data-stu-id="c04f0-156">A scale set built on a custom image (one built by you) can have a capacity of up too100 VMs when configured with Azure Managed disks.</span></span> <span data-ttu-id="c04f0-157">如果 hello 規模集與使用者管理的儲存體帳戶設定，就必須建立一個儲存體帳戶內的所有作業系統磁碟 Vhd。</span><span class="sxs-lookup"><span data-stu-id="c04f0-157">If hello scale set is configured with user-managed storage accounts, it must create all OS disk VHDs within one storage account.</span></span> <span data-ttu-id="c04f0-158">如此一來，hello 最大建議數目的 Vm 規模集中的自訂映像上建置，使用者管理的儲存體是 20。</span><span class="sxs-lookup"><span data-stu-id="c04f0-158">As a result, hello maximum recommended number of VMs in a scale set built on a custom image and user-managed storage is 20.</span></span> <span data-ttu-id="c04f0-159">如果您關閉過度佈建，您可以向上 too40。</span><span class="sxs-lookup"><span data-stu-id="c04f0-159">If you turn off overprovisioning, you can go up too40.</span></span>

<span data-ttu-id="c04f0-160">適用於多個 Vm 超過這些限制允許，您需要多個小數位數設定中所示的 toodeploy[此範本](https://github.com/Azure/azure-quickstart-templates/tree/master/301-custom-images-at-scale)。</span><span class="sxs-lookup"><span data-stu-id="c04f0-160">For more VMs than these limits allow, you need toodeploy multiple scale sets as shown in [this template](https://github.com/Azure/azure-quickstart-templates/tree/master/301-custom-images-at-scale).</span></span>

