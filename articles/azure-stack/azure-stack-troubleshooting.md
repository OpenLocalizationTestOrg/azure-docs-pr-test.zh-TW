---
title: "aaaMicrosoft Azure 堆疊疑難排解 |Microsoft 文件"
description: "Azure Stack 疑難排解。"
services: azure-stack
documentationcenter: 
author: heathl17
manager: byronr
editor: 
ms.assetid: a20bea32-3705-45e8-9168-f198cfac51af
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/10/2017
ms.author: helaw
ms.openlocfilehash: e274e92bc12fd6b7a2594f2f21b69ff0b9de594b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="microsoft-azure-stack-troubleshooting"></a><span data-ttu-id="b363d-103">Microsoft Azure Stack 疑難排解</span><span class="sxs-lookup"><span data-stu-id="b363d-103">Microsoft Azure Stack troubleshooting</span></span>
<span data-ttu-id="b363d-104">此文件提供 Azure Stack 的常見疑難排解資訊。</span><span class="sxs-lookup"><span data-stu-id="b363d-104">This document provides common troubleshooting information for Azure Stack.</span></span> 

<span data-ttu-id="b363d-105">Hello Azure 堆疊技術開發套件提供做為評估環境，因為沒有官方支援在 Microsoft 客戶支援服務。</span><span class="sxs-lookup"><span data-stu-id="b363d-105">Because hello Azure Stack Technical Development Kit is offered as an evaluation environment, there is no official support from Microsoft Customer Support Services.</span></span>  <span data-ttu-id="b363d-106">如果您遇到未記載的問題，請確定 toocheck hello [Azure 堆疊 MSDN 論壇](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack)如需進一步協助和資訊。</span><span class="sxs-lookup"><span data-stu-id="b363d-106">If you are experiencing an issue not documented, make sure toocheck hello [Azure Stack MSDN Forum](https://social.msdn.microsoft.com/Forums/azure/home?forum=azurestack) for further assistance and information.</span></span>  

<span data-ttu-id="b363d-107">本章節所述的問題進行疑難排解的建議 hello 衍生自多個來源和可能或可能無法解決您特定的問題。</span><span class="sxs-lookup"><span data-stu-id="b363d-107">hello recommendations for troubleshooting issues that are described in this section are derived from several sources and may or may not resolve your particular issue.</span></span> <span data-ttu-id="b363d-108">程式碼範例係依現況提供，而且無法保證程式碼會產生預期結果。</span><span class="sxs-lookup"><span data-stu-id="b363d-108">Code examples are provided as is and expected results cannot be guaranteed.</span></span> <span data-ttu-id="b363d-109">這個區段是主體 toofrequent 編輯，以及改進 toohello 產品的更新中實作。</span><span class="sxs-lookup"><span data-stu-id="b363d-109">This section is subject toofrequent edits and updates as improvements toohello product are implemented.</span></span>

## <a name="deployment"></a><span data-ttu-id="b363d-110">部署</span><span class="sxs-lookup"><span data-stu-id="b363d-110">Deployment</span></span>
### <a name="deployment-failure"></a><span data-ttu-id="b363d-111">部署失敗</span><span class="sxs-lookup"><span data-stu-id="b363d-111">Deployment failure</span></span>
<span data-ttu-id="b363d-112">如果您在安裝期間遇到失敗，您可以使用 hello 部署指令碼 toorestart hello 部署的 hello 失敗的步驟從使用 hello 重新執行選項。</span><span class="sxs-lookup"><span data-stu-id="b363d-112">If you experience a failure during installation, you can use use hello rerun option of hello deployment script toorestart hello deployment from hello failed step.</span></span>  


### <a name="at-hello-end-of-hello-deployment-hello-powershell-session-is-still-open-and-doesnt-show-any-output"></a><span data-ttu-id="b363d-113">Hello 部署結束時的 hello，hello PowerShell 工作階段仍為開啟且未顯示任何輸出</span><span class="sxs-lookup"><span data-stu-id="b363d-113">At hello end of hello deployment, hello PowerShell session is still open and doesn’t show any output</span></span>
<span data-ttu-id="b363d-114">這種行為可能是只 hello 結果的 hello PowerShell 命令視窗中，預設行為，已選取時。</span><span class="sxs-lookup"><span data-stu-id="b363d-114">This behavior is probably just hello result of hello default behavior of a PowerShell command window, when it has been selected.</span></span> <span data-ttu-id="b363d-115">hello 開發套件部署實際上已成功，但選取 hello 視窗時，已暫停 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="b363d-115">hello development kit deployment has actually succeeded but hello script was paused when selecting hello window.</span></span> <span data-ttu-id="b363d-116">您可以確認這是尋找 hello word"select"hello 的 hello 命令視窗的標題列中的 hello 案例。</span><span class="sxs-lookup"><span data-stu-id="b363d-116">You can verify this is hello case by looking for hello word "select" in hello titlebar of hello command window.</span></span>  <span data-ttu-id="b363d-117">按下 esc 鍵 hello 金鑰 toounselect，且 hello 完成訊息應該會顯示它的後面。</span><span class="sxs-lookup"><span data-stu-id="b363d-117">Press hello ESC key toounselect it, and hello completion message should be shown after it.</span></span>

## <a name="templates"></a><span data-ttu-id="b363d-118">範本</span><span class="sxs-lookup"><span data-stu-id="b363d-118">Templates</span></span>
### <a name="azure-template-wont-deploy-tooazure-stack"></a><span data-ttu-id="b363d-119">Azure 範本不會將部署 tooAzure 堆疊</span><span class="sxs-lookup"><span data-stu-id="b363d-119">Azure template won't deploy tooAzure Stack</span></span>
<span data-ttu-id="b363d-120">請確定：</span><span class="sxs-lookup"><span data-stu-id="b363d-120">Make sure that:</span></span>

* <span data-ttu-id="b363d-121">hello 範本必須使用 Microsoft Azure 服務已使用或 Azure 堆疊中的預覽。</span><span class="sxs-lookup"><span data-stu-id="b363d-121">hello template must be using a Microsoft Azure service that is already available or in preview in Azure Stack.</span></span>
* <span data-ttu-id="b363d-122">hello 用於特定資源的 Api 都支援 hello 本機堆疊 Azure 執行個體，以及所設定的目標是有效的位置 （「 本機 」 在 Azure 堆疊開發套件，vs hello 「 美國東部"或"印度南部及印度 」 在 Azure 中）。</span><span class="sxs-lookup"><span data-stu-id="b363d-122">hello APIs used for a specific resource are supported by hello local Azure Stack instance, and that you are targeting a valid location (“local” in Azure Stack development kit, vs hello “East US” or “South India” in Azure).</span></span>
* <span data-ttu-id="b363d-123">您檢閱[本文](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md)hello 測試 AzureRmResourceGroupDeployment cmdlet 相關的攔截 Azure 資源管理員語法的小差異。</span><span class="sxs-lookup"><span data-stu-id="b363d-123">You review [this article](https://github.com/Azure/AzureStack-QuickStart-Templates/blob/master/README.md) about hello Test-AzureRmResourceGroupDeployment cmdlets, which catch small differences in Azure Resource Manager syntax.</span></span>

<span data-ttu-id="b363d-124">您也可以使用 hello 中已經提供的 hello Azure 堆疊範本[GitHub 儲存機制](http://aka.ms/AzureStackGitHub/)toohelp 您立即開始。</span><span class="sxs-lookup"><span data-stu-id="b363d-124">You can also use hello Azure Stack templates already provided in hello [GitHub repository](http://aka.ms/AzureStackGitHub/) toohelp you get started.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="b363d-125">虛擬機器</span><span class="sxs-lookup"><span data-stu-id="b363d-125">Virtual machines</span></span>
### <a name="default-image-and-gallery-item"></a><span data-ttu-id="b363d-126">預設映像與資源庫項目</span><span class="sxs-lookup"><span data-stu-id="b363d-126">Default image and gallery item</span></span>
<span data-ttu-id="b363d-127">在 Azure Stack 中部署 VM 之前，您必須先新增 Windows Server 映像與資源庫項目。</span><span class="sxs-lookup"><span data-stu-id="b363d-127">You must first add a Windows Server image and gallery item before deploying VMs in Azure Stack.</span></span>

### <a name="after-restarting-my-azure-stack-host-some-vms-may-not-automatically-start"></a><span data-ttu-id="b363d-128">重新啟動我的 Azure Stack 主機之後，某些 VM 可能不會自動啟動。</span><span class="sxs-lookup"><span data-stu-id="b363d-128">After restarting my Azure Stack host, some VMs may not automatically start.</span></span>
<span data-ttu-id="b363d-129">將您的主機重新開機之後，您可能會注意到 Azure Stack 服務並非立即可用。</span><span class="sxs-lookup"><span data-stu-id="b363d-129">After rebooting your host, you may notice Azure Stack services are not immediately available.</span></span>  <span data-ttu-id="b363d-130">這是因為 Azure 堆疊[基礎結構 Vm](azure-stack-architecture.md#virtual-machine-roles)和 RPs 採取有點 toocheck 一致性，但最終將會自動啟動。</span><span class="sxs-lookup"><span data-stu-id="b363d-130">This is because Azure Stack [infrastructure VMs](azure-stack-architecture.md#virtual-machine-roles) and RPs take a little bit toocheck consistency, but will eventually start automatically.</span></span>

<span data-ttu-id="b363d-131">您也可能會注意到 hello Azure 堆疊開發套件主應用程式的重新開機後自動啟動 Vm，不該租用戶。</span><span class="sxs-lookup"><span data-stu-id="b363d-131">You may also notice that tenant VMs don't automatically start after a reboot of hello Azure Stack development kit host.</span></span>  <span data-ttu-id="b363d-132">這是已知的問題，因此只需要幾個手動步驟 toobring 上線：</span><span class="sxs-lookup"><span data-stu-id="b363d-132">This is a known issue, and just requires a few manual steps toobring them online:</span></span>

1.  <span data-ttu-id="b363d-133">在 [hello Azure 堆疊開發套件主機上啟動**容錯移轉叢集管理員**從 hello 開始] 功能表。</span><span class="sxs-lookup"><span data-stu-id="b363d-133">On hello Azure Stack development kit host, start **Failover Cluster Manager** from hello Start Menu.</span></span>
2.  <span data-ttu-id="b363d-134">選取 hello 叢集**S Cluster.azurestack.local**。</span><span class="sxs-lookup"><span data-stu-id="b363d-134">Select hello cluster **S-Cluster.azurestack.local**.</span></span>
3.  <span data-ttu-id="b363d-135">選取 [角色]。</span><span class="sxs-lookup"><span data-stu-id="b363d-135">Select **Roles**.</span></span>
4.  <span data-ttu-id="b363d-136">租用戶 VM 將會顯示為「已儲存」狀態。</span><span class="sxs-lookup"><span data-stu-id="b363d-136">Tenant VMs will appear in a *saved* state.</span></span>  <span data-ttu-id="b363d-137">基礎結構的所有 Vm 正在都執行，以滑鼠右鍵按一下 hello 租用戶 Vm，並選取**啟動**tooresume hello VM。</span><span class="sxs-lookup"><span data-stu-id="b363d-137">Once all Infrastructure VMs are running, right-click hello tenant VMs and select **Start** tooresume hello VM.</span></span>

### <a name="i-have-deleted-some-virtual-machines-but-still-see-hello-vhd-files-on-disk-is-this-behavior-expected"></a><span data-ttu-id="b363d-138">我已刪除一些虛擬機器，但仍看見 hello 磁碟上的 VHD 檔案。</span><span class="sxs-lookup"><span data-stu-id="b363d-138">I have deleted some virtual machines, but still see hello VHD files on disk.</span></span> <span data-ttu-id="b363d-139">這是不是預期行為？</span><span class="sxs-lookup"><span data-stu-id="b363d-139">Is this behavior expected?</span></span>
<span data-ttu-id="b363d-140">是，這是預期行為。</span><span class="sxs-lookup"><span data-stu-id="b363d-140">Yes, this is behavior expected.</span></span> <span data-ttu-id="b363d-141">將它設計成這樣的原因是：</span><span class="sxs-lookup"><span data-stu-id="b363d-141">It was designed this way because:</span></span>

* <span data-ttu-id="b363d-142">當您刪除 VM 時，不會刪除 VHD。</span><span class="sxs-lookup"><span data-stu-id="b363d-142">When you delete a VM, VHDs are not deleted.</span></span> <span data-ttu-id="b363d-143">磁碟是 hello 資源群組中的個別資源。</span><span class="sxs-lookup"><span data-stu-id="b363d-143">Disks are separate resources in hello resource group.</span></span>
* <span data-ttu-id="b363d-144">取得刪除儲存體帳戶，hello 刪除會顯示立即透過 Azure 資源管理員 （網站、 PowerShell），但執行記憶體回收之前仍 hello 磁碟，它可能包含存放在儲存體。</span><span class="sxs-lookup"><span data-stu-id="b363d-144">When a storage account gets deleted, hello deletion is visible immediately through Azure Resource Manager (portal, PowerShell) but hello disks it may contain are still kept in storage until garbage collection runs.</span></span>

<span data-ttu-id="b363d-145">如果您看到 「 字串 」 Vhd 時，很重要 tooknow 如果它們是 hello 資料夾已刪除的儲存體帳戶的一部分。</span><span class="sxs-lookup"><span data-stu-id="b363d-145">If you see "orphan" VHDs, it is important tooknow if they are part of hello folder for a storage account that was deleted.</span></span> <span data-ttu-id="b363d-146">如果未刪除 hello 儲存體帳戶，這是正常它們仍然會有。</span><span class="sxs-lookup"><span data-stu-id="b363d-146">If hello storage account was not deleted, it's normal they are still there.</span></span>

<span data-ttu-id="b363d-147">閱讀更多有關設定 hello 保留臨界值和隨回收中的[管理儲存體帳戶](azure-stack-manage-storage-accounts.md)。</span><span class="sxs-lookup"><span data-stu-id="b363d-147">You can read more about configuring hello retention threshold and on-demand reclamation in [manage storage accounts](azure-stack-manage-storage-accounts.md).</span></span>

## <a name="storage"></a><span data-ttu-id="b363d-148">儲存體</span><span class="sxs-lookup"><span data-stu-id="b363d-148">Storage</span></span>
### <a name="storage-reclamation"></a><span data-ttu-id="b363d-149">儲存體回收</span><span class="sxs-lookup"><span data-stu-id="b363d-149">Storage reclamation</span></span>
<span data-ttu-id="b363d-150">它可能需要向上 hello 入口網站中的回收的容量 tooshow toofourteen 小時。</span><span class="sxs-lookup"><span data-stu-id="b363d-150">It may take up toofourteen hours for reclaimed capacity tooshow up in hello portal.</span></span> <span data-ttu-id="b363d-151">空間回收取決於各種因素，包括區塊 Blob 存放區中內部容器檔案的使用量百分比。</span><span class="sxs-lookup"><span data-stu-id="b363d-151">Space reclamation depends on various factors including usage percentage of internal container files in block blob store.</span></span> <span data-ttu-id="b363d-152">因此，根據多少資料都會刪除，並不保證 hello 記憶體回收行程執行時，無法回收的空間數量。</span><span class="sxs-lookup"><span data-stu-id="b363d-152">Therefore, depending on how much data is deleted, there is no guarantee on hello amount of space that could be reclaimed when garbage collector runs.</span></span>

## <a name="powershell"></a><span data-ttu-id="b363d-153">PowerShell</span><span class="sxs-lookup"><span data-stu-id="b363d-153">PowerShell</span></span>
### <a name="resource-providers-not-registered"></a><span data-ttu-id="b363d-154">資源提供者未註冊</span><span class="sxs-lookup"><span data-stu-id="b363d-154">Resource Providers not registered</span></span>
<span data-ttu-id="b363d-155">當使用 PowerShell 連線 tootenant 訂用帳戶，您會發現 hello 資源提供者不會自動註冊。</span><span class="sxs-lookup"><span data-stu-id="b363d-155">When connecting tootenant subscriptions with PowerShell, you will notice that hello resource providers are not automatically registered.</span></span> <span data-ttu-id="b363d-156">使用 hello [Connect 模組](https://github.com/Azure/AzureStack-Tools/tree/master/Connect)，或執行的 hello PowerShell 中的下列命令 (之後[安裝，而且連接](azure-stack-connect-powershell.md)租用戶身分):</span><span class="sxs-lookup"><span data-stu-id="b363d-156">Use hello [Connect module](https://github.com/Azure/AzureStack-Tools/tree/master/Connect), or run hello following command from PowerShell (after you [install and connect](azure-stack-connect-powershell.md) as a tenant):</span></span> 
  
       Get-AzureRMResourceProvider | Register-AzureRmResourceProvider

## <a name="cli"></a><span data-ttu-id="b363d-157">CLI</span><span class="sxs-lookup"><span data-stu-id="b363d-157">CLI</span></span>

* <span data-ttu-id="b363d-158">hello CLI 互動式模式也就是</span><span class="sxs-lookup"><span data-stu-id="b363d-158">hello CLI interactive mode i.e</span></span> <span data-ttu-id="b363d-159">hello `az interactive` Azure 堆疊中尚不支援命令。</span><span class="sxs-lookup"><span data-stu-id="b363d-159">hello `az interactive` command is not yet supported in Azure Stack.</span></span>
* <span data-ttu-id="b363d-160">提供使用 hello Azure 堆疊中的虛擬機器映像 tooget hello 清單`az vm images list --all`命令而不是 hello`az vm image list`命令。</span><span class="sxs-lookup"><span data-stu-id="b363d-160">tooget hello list of virtual machine images available in Azure Stack, use hello `az vm images list --all` command instead of hello `az vm image list` command.</span></span> <span data-ttu-id="b363d-161">指定 hello`--all`選項可確保回應會傳回提供 Azure 堆疊環境中的 hello 映像。</span><span class="sxs-lookup"><span data-stu-id="b363d-161">Specifying hello `--all` option makes sure that response returns only hello images that are available in your Azure Stack environment.</span></span> 
* <span data-ttu-id="b363d-162">Azure 提供的虛擬機器映像別名可能不適用 tooAzure 堆疊。</span><span class="sxs-lookup"><span data-stu-id="b363d-162">Virtual machine image aliases that are available in Azure may not be applicable tooAzure Stack.</span></span> <span data-ttu-id="b363d-163">當使用虛擬機器映像，您必須使用 hello 整個 URN 參數 (Canonical: UbuntuServer:14.04.3-LTS:1.0.0) 而不是 hello 映像的別名。</span><span class="sxs-lookup"><span data-stu-id="b363d-163">When using virtual machine images, you must use hello entire URN parameter (Canonical:UbuntuServer:14.04.3-LTS:1.0.0) instead of hello image alias.</span></span> <span data-ttu-id="b363d-164">與這個 URNmust 符合 hello 映像規格，為衍生自 hello`az vm images list`命令。</span><span class="sxs-lookup"><span data-stu-id="b363d-164">And this URNmust match hello image specifications as derived from hello `az vm images list` command.</span></span>
* <span data-ttu-id="b363d-165">根據預設，CLI 2.0 會使用"Standard_DS1_v2 」 為 hello 預設虛擬機器映像大小。</span><span class="sxs-lookup"><span data-stu-id="b363d-165">By default, CLI 2.0 uses “Standard_DS1_v2” as hello default virtual machine image size.</span></span> <span data-ttu-id="b363d-166">不過，這個大小尚無法使用 Azure 堆疊中，因此，您需要 toospecify hello`--size`建立虛擬機器時，明確的參數。</span><span class="sxs-lookup"><span data-stu-id="b363d-166">However, this size is not yet available in Azure Stack, so, you need toospecify hello `--size` parameter explicitly when creating a virtual machine.</span></span> <span data-ttu-id="b363d-167">您可以取得 hello 使用 hello 都可以在 Azure 堆疊中的虛擬機器大小清單`az vm list-sizes --location <locationName>`命令。</span><span class="sxs-lookup"><span data-stu-id="b363d-167">You can get hello list of virtual machine sizes that are available in Azure Stack by using hello `az vm list-sizes --location <locationName>` command.</span></span>


## <a name="windows-azure-pack-connector"></a><span data-ttu-id="b363d-168">Windows Azure 套件連接器</span><span class="sxs-lookup"><span data-stu-id="b363d-168">Windows Azure Pack Connector</span></span>
* <span data-ttu-id="b363d-169">如果您變更 hello hello azurestackadmin 帳戶密碼，在您部署 Azure 堆疊開發套件之後，您不再可以設定多個雲端模式。</span><span class="sxs-lookup"><span data-stu-id="b363d-169">If you change hello password of hello azurestackadmin account after you deploy Azure Stack development kit, you can no longer configure multi-cloud mode.</span></span> <span data-ttu-id="b363d-170">因此，不是可能 tooconnect toohello 目標 Windows Azure Pack 環境。</span><span class="sxs-lookup"><span data-stu-id="b363d-170">Therefore, it won't be possible tooconnect toohello target Windows Azure Pack environment.</span></span>
* <span data-ttu-id="b363d-171">當您設定多雲端模式之後：</span><span class="sxs-lookup"><span data-stu-id="b363d-171">After you set up multi-cloud mode:</span></span>
    * <span data-ttu-id="b363d-172">使用者可以看到 hello 儀表板，他們重設 hello 入口網站設定之後，才。</span><span class="sxs-lookup"><span data-stu-id="b363d-172">A user can see hello dashboard only after they reset hello portal settings.</span></span> <span data-ttu-id="b363d-173">（在 hello 使用者入口網站中，按一下 hello 入口網站設定圖示 （hello 右上角的齒輪圖示）。</span><span class="sxs-lookup"><span data-stu-id="b363d-173">(In hello user portal, click hello portal settings icon (gear icon in hello top-right corner).</span></span> <span data-ttu-id="b363d-174">在 [還原預設設定] 下，按一下 [套用])。</span><span class="sxs-lookup"><span data-stu-id="b363d-174">Under **Restore default settings**, click **Apply**.)</span></span>
    * <span data-ttu-id="b363d-175">hello 儀表板標題可能不會出現。</span><span class="sxs-lookup"><span data-stu-id="b363d-175">hello dashboard titles may not appear.</span></span> <span data-ttu-id="b363d-176">若發生此問題，您必須手動將它們新增回來。</span><span class="sxs-lookup"><span data-stu-id="b363d-176">If this issue occurs, you must manually add them back.</span></span>
    * <span data-ttu-id="b363d-177">有些方塊可能不會顯示正確當您初次加入它們 toohello 儀表板。</span><span class="sxs-lookup"><span data-stu-id="b363d-177">Some tiles may not show correctly when you first add them toohello dashboard.</span></span> <span data-ttu-id="b363d-178">toofix 這個問題，請重新整理 hello 瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="b363d-178">toofix this issue, refresh hello browser.</span></span>



