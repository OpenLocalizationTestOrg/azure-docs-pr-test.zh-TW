---
title: "Azure 虛擬機器 aaaEncrypt |Microsoft 文件"
description: "這份文件可協助您 tooencrypt Azure 虛擬機器從 Azure 資訊安全中心收到警示之後。"
services: security, security-center
documentationcenter: na
author: TomShinder
manager: swadhwa
editor: 
ms.assetid: f6c28bc4-1f79-4352-89d0-03659b2fa2f5
ms.service: security
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/15/2017
ms.author: tomsh
ms.openlocfilehash: 7c7c6eed39d16bde8a0dfaffe3a3331c58101634
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="encrypt-an-azure-virtual-machine"></a><span data-ttu-id="298af-103">加密 Azure 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="298af-103">Encrypt an Azure Virtual Machine</span></span>
<span data-ttu-id="298af-104">Azure 資訊安全中心會在您有未加密的虛擬機器時對您發出警示。</span><span class="sxs-lookup"><span data-stu-id="298af-104">Azure Security Center will alert you if you have virtual machines that are not encrypted.</span></span> <span data-ttu-id="298af-105">這些警示會顯示為高嚴重性和 hello 建議是 tooencrypt 這些虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-105">These alerts will show as High Severity and hello recommendation is tooencrypt these virtual machines.</span></span>

![磁碟加密建議](./media/security-center-disk-encryption/security-center-disk-encryption-fig1.png)

> [!NOTE]
> <span data-ttu-id="298af-107">本文件中的 hello 資訊適用於 tooencrypting 虛擬機器，而不使用金鑰的加密金鑰 （這是必要的備份使用 Azure 備份的虛擬機器）。</span><span class="sxs-lookup"><span data-stu-id="298af-107">hello information in this document applies tooencrypting virtual machines without using a Key Encryption Key (which is required for backing up virtual machines using Azure Backup).</span></span> <span data-ttu-id="298af-108">請參閱 hello 文章[Azure 磁碟加密用於 Windows 及 Linux 的 Azure 虛擬機器](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption)如需詳細資訊 toouse Key Encryption Key toosupport Azure 備份加密 Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-108">Please see hello article [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://docs.microsoft.com/en-us/azure/security/azure-security-disk-encryption) for information on how toouse a Key Encryption Key toosupport Azure Backup for encrypted Azure Virtual Machines.</span></span>
>
>

<span data-ttu-id="298af-109">tooencrypt 已由 Azure 資訊安全中心識別為需要加密的 Azure 虛擬機器，我們建議 hello 下列步驟：</span><span class="sxs-lookup"><span data-stu-id="298af-109">tooencrypt Azure Virtual Machines that have been identified by Azure Security Center as needing encryption, we recommend hello following steps:</span></span>

* <span data-ttu-id="298af-110">安裝並設定 Azure PowerShell。</span><span class="sxs-lookup"><span data-stu-id="298af-110">Install and configure Azure PowerShell.</span></span> <span data-ttu-id="298af-111">這可讓您 toorun hello PowerShell 命令需要的 tooset hello 必要條件需要 tooencrypt Azure 虛擬機器上。</span><span class="sxs-lookup"><span data-stu-id="298af-111">This will enable you toorun hello PowerShell commands required tooset up hello prerequisites required tooencrypt Azure Virtual Machines.</span></span>
* <span data-ttu-id="298af-112">取得並執行 hello Azure 磁碟加密必要條件 Azure PowerShell 指令碼</span><span class="sxs-lookup"><span data-stu-id="298af-112">Obtain and run hello Azure Disk Encryption Prerequisites Azure PowerShell script</span></span>
* <span data-ttu-id="298af-113">加密虛擬機器</span><span class="sxs-lookup"><span data-stu-id="298af-113">Encrypt your virtual machines</span></span>

<span data-ttu-id="298af-114">這份文件 hello 目標是 tooenable 您 tooencrypt 您的虛擬機器，即使您在 Azure PowerShell 中有少量或沒有背景。</span><span class="sxs-lookup"><span data-stu-id="298af-114">hello goal of this document is tooenable you tooencrypt your virtual machines, even if you have little or no background in Azure PowerShell.</span></span>
<span data-ttu-id="298af-115">本文件假設您使用 Windows 10 做 hello 用戶端電腦，您將會從此處設定 Azure 磁碟加密。</span><span class="sxs-lookup"><span data-stu-id="298af-115">This document assumes you are using Windows 10 as hello client machine from which you will configure Azure Disk Encryption.</span></span>

<span data-ttu-id="298af-116">有多種方法可以使用的 toosetup hello 必要條件和 tooconfigure 加密適用於 Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-116">There are many approaches that can be used toosetup hello prerequisites and tooconfigure encryption for Azure Virtual Machines.</span></span> <span data-ttu-id="298af-117">如果您已精通 Azure PowerShell 或 Azure CLI 中，您可能偏好 toouse 替代方式。</span><span class="sxs-lookup"><span data-stu-id="298af-117">If you are already well-versed in Azure PowerShell or Azure CLI, then you may prefer toouse alternate approaches.</span></span>

> [!NOTE]
> <span data-ttu-id="298af-118">toolearn 進一步了解替代方案 tooconfiguring 加密為 Azure 虛擬機器，請參閱[Azure 磁碟加密用於 Windows 及 Linux 的 Azure 虛擬機器](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0)。</span><span class="sxs-lookup"><span data-stu-id="298af-118">toolearn more about alternate approaches tooconfiguring encryption for Azure virtual machines, please see [Azure Disk Encryption for Windows and Linux Azure Virtual Machines](https://gallery.technet.microsoft.com/Azure-Disk-Encryption-for-a0018eb0).</span></span>
>
>

## <a name="install-and-configure-azure-powershell"></a><span data-ttu-id="298af-119">安裝並設定 Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="298af-119">Install and configure Azure PowerShell</span></span>
<span data-ttu-id="298af-120">您的電腦上需要安裝 Azure PowerShell 1.2.1 版或更新版本。</span><span class="sxs-lookup"><span data-stu-id="298af-120">You need Azure PowerShell version 1.2.1 or above installed on your computer.</span></span> <span data-ttu-id="298af-121">hello 文章[如何 tooinstall 和設定 Azure PowerShell](/powershell/azure/overview)包含所有需要您使用 Azure PowerShell 的電腦 toowork tooprovision 的 hello 步驟。</span><span class="sxs-lookup"><span data-stu-id="298af-121">hello article [How tooinstall and configure Azure PowerShell](/powershell/azure/overview) contains all hello steps you need tooprovision your computer toowork with Azure PowerShell.</span></span> <span data-ttu-id="298af-122">hello 最直接的方法是在該文件中所述的 toouse hello Web PI 安裝方法。</span><span class="sxs-lookup"><span data-stu-id="298af-122">hello most straightforward approach is toouse hello Web PI installation approach mentioned in that article.</span></span> <span data-ttu-id="298af-123">即使您已經安裝 Azure PowerShell，請安裝一次使用 hello Web PI 方法，讓您擁有 hello 最新版本的 Azure PowerShell。</span><span class="sxs-lookup"><span data-stu-id="298af-123">Even if you already have Azure PowerShell installed, install again using hello Web PI approach so that you have hello latest version of Azure PowerShell.</span></span>

## <a name="obtain-and-run-hello-azure-disk-encryption-prerequisites-configuration-script"></a><span data-ttu-id="298af-124">取得並設定指令碼執行 hello Azure 磁碟加密必要條件</span><span class="sxs-lookup"><span data-stu-id="298af-124">Obtain and run hello Azure disk encryption prerequisites configuration script</span></span>
<span data-ttu-id="298af-125">hello Azure 磁碟加密必要條件設定指令碼會設定所有加密的 Azure 虛擬機器所需的 hello 必要條件。</span><span class="sxs-lookup"><span data-stu-id="298af-125">hello Azure Disk Encryption Prerequisites Configuration Script will set up all hello prerequisites required for encrypting your Azure Virtual Machines.</span></span>

1. <span data-ttu-id="298af-126">移 toohello GitHub 頁面，其中包含 hello [Azure 磁碟加密必要條件安裝程式指令碼](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1)。</span><span class="sxs-lookup"><span data-stu-id="298af-126">Go toohello GitHub page that has hello [Azure Disk Encryption Prerequisite Setup Script](https://github.com/Azure/azure-powershell/blob/master/src/ResourceManager/Compute/Commands.Compute/Extension/AzureDiskEncryption/Scripts/AzureDiskEncryptionPreRequisiteSetup.ps1).</span></span>
2. <span data-ttu-id="298af-127">在 hello GibHub 頁面上，按一下 [hello **Raw** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="298af-127">On hello GibHub page, click hello **Raw** button.</span></span>
3. <span data-ttu-id="298af-128">使用**CTRL-A** tooselect 所有 hello hello 頁面上的文字，然後使用**CTRL-C** toocopy 所有 hello hello 頁面 toohello 剪貼簿上的文字。</span><span class="sxs-lookup"><span data-stu-id="298af-128">Use **CTRL-A** tooselect all hello text on hello page and then use **CTRL-C** toocopy all hello text on hello page toohello clipboard.</span></span>
4. <span data-ttu-id="298af-129">開啟**記事本**和複製的 hello 文字貼入 [記事本]。</span><span class="sxs-lookup"><span data-stu-id="298af-129">Open **Notepad** and paste hello copied text into Notepad.</span></span>
5. <span data-ttu-id="298af-130">在 C: 磁碟機上建立名為 **AzureADEScript**的新資料夾。</span><span class="sxs-lookup"><span data-stu-id="298af-130">Create a new folder on your C: drive named **AzureADEScript**.</span></span>
6. <span data-ttu-id="298af-131">儲存 hello 記事本 檔案 – 按一下**檔案**，然後按一下 **存**。</span><span class="sxs-lookup"><span data-stu-id="298af-131">Save hello Notepad file – click **File**, then click **Save As**.</span></span> <span data-ttu-id="298af-132">在 [hello 檔案名稱] 文字方塊中，輸入**"ADEPrereqScript.ps1"**按一下**儲存**。</span><span class="sxs-lookup"><span data-stu-id="298af-132">In hello File name textbox, enter **“ADEPrereqScript.ps1”** and click **Save**.</span></span> <span data-ttu-id="298af-133">（請確定您將 hello 引號括住 hello 名稱，否則它會儲存 hello 檔案副檔名為.txt 的檔案）。</span><span class="sxs-lookup"><span data-stu-id="298af-133">(make sure you put hello quotation marks around hello name, otherwise it will save hello file with a .txt file extension).</span></span>

<span data-ttu-id="298af-134">現在，儲存 hello 指令碼內容，請 hello PowerShell ISE 中開啟 hello 指令碼：</span><span class="sxs-lookup"><span data-stu-id="298af-134">Now that hello script content is saved, open hello script in hello PowerShell ISE:</span></span>

1. <span data-ttu-id="298af-135">在 hello 開始 功能表中，按一下  **Cortana**。</span><span class="sxs-lookup"><span data-stu-id="298af-135">In hello Start Menu, click **Cortana**.</span></span> <span data-ttu-id="298af-136">詢問**Cortana** "PowerShell"輸入**PowerShell** hello Cortana 搜尋文字方塊中。</span><span class="sxs-lookup"><span data-stu-id="298af-136">Ask **Cortana** “PowerShell” by typing **PowerShell** in hello Cortana search text box.</span></span>
2. <span data-ttu-id="298af-137">用滑鼠右鍵按一下 [Windows PowerShell ISE]，然後按一下 [以系統管理員身分執行]。</span><span class="sxs-lookup"><span data-stu-id="298af-137">Right click **Windows PowerShell ISE** and click **Run as administrator**.</span></span>
3. <span data-ttu-id="298af-138">在 hello**系統管理員： Windows PowerShell ISE**視窗中，按一下**檢視**，然後按一下**顯示指令碼窗格**。</span><span class="sxs-lookup"><span data-stu-id="298af-138">In hello **Administrator: Windows PowerShell ISE** window, click **View** and then click **Show Script Pane**.</span></span>
4. <span data-ttu-id="298af-139">如果您看到 hello**命令**窗格右邊 hello hello 視窗中，按一下 hello **"x"** hello 右上角的 hello 窗格 tooclose 中它。</span><span class="sxs-lookup"><span data-stu-id="298af-139">If you see hello **Commands** pane on hello right side of hello window, click hello **“x”** in hello top right corner of hello pane tooclose it.</span></span> <span data-ttu-id="298af-140">如果您 toosee 太小的 hello 文字，請使用**CTRL + 新增**（「 新增 」 為 hello"+"登入）。</span><span class="sxs-lookup"><span data-stu-id="298af-140">If hello text is too small for you toosee, use **CTRL+Add** (“Add” is hello “+” sign).</span></span> <span data-ttu-id="298af-141">如果 hello 文字而言太大，請使用**CTRL + 減號**(減去為 hello"-"號)。</span><span class="sxs-lookup"><span data-stu-id="298af-141">If hello text is too large, use **CTRL+Subtract** (Subtract is hello “-“ sign).</span></span>
5. <span data-ttu-id="298af-142">依序按一下 [檔案] 和 [開啟]。</span><span class="sxs-lookup"><span data-stu-id="298af-142">Click **File** and then click **Open**.</span></span> <span data-ttu-id="298af-143">瀏覽 toohello **C:\AzureADEScript**資料夾和 hello 按兩下 hello **ADEPrereqScript**。</span><span class="sxs-lookup"><span data-stu-id="298af-143">Navigate toohello **C:\AzureADEScript** folder and hello double-click on hello **ADEPrereqScript**.</span></span>
6. <span data-ttu-id="298af-144">hello **ADEPrereqScript**內容現在應該會出現在 hello PowerShell ISE 中，會以色彩標示的 toohelp 更容易看到各種元件，例如命令、 參數和變數。</span><span class="sxs-lookup"><span data-stu-id="298af-144">hello **ADEPrereqScript** contents should now appear in hello PowerShell ISE and is color-coded toohelp you see various components, such as commands, parameters and variables more easily.</span></span>

<span data-ttu-id="298af-145">您現在應該會看到 hello 下圖類似。</span><span class="sxs-lookup"><span data-stu-id="298af-145">You should now see something like hello figure below.</span></span>

![PowerShell ISE 視窗](./media/security-center-disk-encryption/security-center-disk-encryption-fig2.png)

<span data-ttu-id="298af-147">hello 上方窗格是參照的 tooas hello 「 指令碼窗格"而 hello 底部窗格是參照的 tooas hello 「 主控台 」。</span><span class="sxs-lookup"><span data-stu-id="298af-147">hello top pane is referred tooas hello “script pane” and hello bottom pane is referred tooas hello “console”.</span></span> <span data-ttu-id="298af-148">本文稍後將會使用這些詞彙。</span><span class="sxs-lookup"><span data-stu-id="298af-148">We will use these terms later in this article.</span></span>

## <a name="run-hello-azure-disk-encryption-prerequisites-powershell-command"></a><span data-ttu-id="298af-149">執行 hello Azure 磁碟加密必要條件 PowerShell 命令</span><span class="sxs-lookup"><span data-stu-id="298af-149">Run hello Azure disk encryption prerequisites PowerShell command</span></span>
<span data-ttu-id="298af-150">hello Azure 磁碟加密必要條件指令碼會要求您提供 hello 開始 hello 指令碼之後，下列資訊：</span><span class="sxs-lookup"><span data-stu-id="298af-150">hello Azure Disk Encryption Prerequisites script will ask you for hello following information after you start hello script:</span></span>

* <span data-ttu-id="298af-151">**資源群組名稱**-名稱的資源群組的 tooput hello hello 到金鑰保存庫。</span><span class="sxs-lookup"><span data-stu-id="298af-151">**Resource Group Name** - Name of hello Resource Group that you want tooput hello Key Vault into.</span></span>  <span data-ttu-id="298af-152">如果還沒有建立該名稱，將建立新的資源群組與 hello 您所輸入的名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-152">A new Resource Group with hello name you enter will be created if there isn’t already one with that name created.</span></span> <span data-ttu-id="298af-153">如果您已經有您想要此訂用帳戶中的 toouse 資源群組，然後輸入 hello 該資源群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-153">If you already have a Resource Group that you want toouse in this subscription, then enter hello name of that Resource Group.</span></span>
* <span data-ttu-id="298af-154">**金鑰保存庫名稱**-在哪種加密金鑰是放置 toobe hello 金鑰保存庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-154">**Key Vault Name** - Name of hello Key Vault in which encryption keys are toobe placed.</span></span> <span data-ttu-id="298af-155">如果您沒有此名稱的金鑰保存庫，則會以此名稱建立新的金鑰保存庫。</span><span class="sxs-lookup"><span data-stu-id="298af-155">A new Key Vault with this name will be created if you don’t already have a Key Vault with this name.</span></span> <span data-ttu-id="298af-156">如果您已經有您想 toouse 金鑰保存庫，輸入 hello hello 現有金鑰保存庫名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-156">If you already have a Key Vault that you want toouse, enter hello name of hello existing Key Vault.</span></span>
* <span data-ttu-id="298af-157">**位置**-hello 金鑰保存庫的位置。</span><span class="sxs-lookup"><span data-stu-id="298af-157">**Location** - Location of hello Key Vault.</span></span> <span data-ttu-id="298af-158">請確定在 hello hello 金鑰保存庫和 Vm toobe 加密相同的位置。</span><span class="sxs-lookup"><span data-stu-id="298af-158">Make sure hello Key Vault and VMs toobe encrypted are in hello same location.</span></span> <span data-ttu-id="298af-159">如果您不知道 hello 位置，將示範如何本文中稍後有步驟 toofind 出。</span><span class="sxs-lookup"><span data-stu-id="298af-159">If you don’t know hello location, there are steps later in this article that will show you how toofind out.</span></span>
* <span data-ttu-id="298af-160">**Azure Active Directory 應用程式名稱**-hello Azure Active Directory 應用程式將會使用的 toowrite 密碼 toohello 金鑰保存庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-160">**Azure Active Directory Application Name** - Name of hello Azure Active Directory application that will be used toowrite secrets toohello Key Vault.</span></span> <span data-ttu-id="298af-161">如果不存在此名稱的應用程式，將會以此名稱建立新的應用程式。</span><span class="sxs-lookup"><span data-stu-id="298af-161">A new application with this name will be created if one doesn't exist.</span></span> <span data-ttu-id="298af-162">如果您已經有您想 toouse 的 Azure Active Directory 應用程式，輸入 hello 的 Azure Active Directory 應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-162">If you already have an Azure Active Directory application that you want toouse, enter hello name of that Azure Active Directory application.</span></span>

> [!NOTE]
> <span data-ttu-id="298af-163">如果您想為 toowhy 知道您需要 toocreate Azure Active Directory 應用程式，請參閱*與 Azure Active Directory 註冊應用程式*hello 文件中的區段[開始使用 Azure 金鑰保存庫](../key-vault/key-vault-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="298af-163">If you’re curious as toowhy you need toocreate an Azure Active Directory application, please see *Register an application with Azure Active Directory* section in hello article [Getting Started with Azure Key Vault](../key-vault/key-vault-get-started.md).</span></span>
>
>

<span data-ttu-id="298af-164">執行下列步驟 tooencrypt Azure 虛擬機器中的 hello:</span><span class="sxs-lookup"><span data-stu-id="298af-164">Perform hello following steps tooencrypt an Azure Virtual Machine:</span></span>

1. <span data-ttu-id="298af-165">如果您關閉 hello PowerShell ISE，請開啟提升權限的 hello PowerShell ISE 的執行個體。</span><span class="sxs-lookup"><span data-stu-id="298af-165">If you closed hello PowerShell ISE, open an elevated instance of hello PowerShell ISE.</span></span> <span data-ttu-id="298af-166">如果 hello PowerShell ISE 尚未開啟，請依照本文稍早的 hello 指示。</span><span class="sxs-lookup"><span data-stu-id="298af-166">Follow hello instructions earlier in this article if hello PowerShell ISE is not already open.</span></span> <span data-ttu-id="298af-167">如果您關閉 hello 指令碼，然後開啟 hello **ADEPrereqScript.ps1**按一下**檔案**，然後**開啟**，然後選取 hello 指令碼從 hello **c:\AzureADEScript**資料夾。</span><span class="sxs-lookup"><span data-stu-id="298af-167">If you closed hello script, then open hello **ADEPrereqScript.ps1** clicking **File**, then **Open** and selecting hello script from hello **c:\AzureADEScript** folder.</span></span> <span data-ttu-id="298af-168">如果您已依照本文從 hello 開始，然後只移 toohello 下一個步驟。</span><span class="sxs-lookup"><span data-stu-id="298af-168">If you have followed this article from hello start, then just move on toohello next step.</span></span>
2. <span data-ttu-id="298af-169">在 hello 主控台中的 hello PowerShell ISE （hello hello PowerShell ISE 的下方窗格），請輸入，hello 焦點 toohello 本機 hello 指令碼的變更**cd c:\AzureADEScript**按**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-169">In hello console of hello PowerShell ISE (hello bottom pane of hello PowerShell ISE), change hello focus toohello local of hello script by typing **cd c:\AzureADEScript** and press **ENTER**.</span></span>
3. <span data-ttu-id="298af-170">因此，您可以執行 hello 指令碼，請在電腦上設定 hello 執行原則。</span><span class="sxs-lookup"><span data-stu-id="298af-170">Set hello execution policy on your machine so that you can run hello script.</span></span> <span data-ttu-id="298af-171">型別**Set-executionpolicy Unrestricted**在 hello 主控台，然後按 ENTER。</span><span class="sxs-lookup"><span data-stu-id="298af-171">Type **Set-ExecutionPolicy Unrestricted** in hello console and then press ENTER.</span></span> <span data-ttu-id="298af-172">如果您看到的對話方塊，告知 hello 的 hello 變更 tooexecution 原則的影響，請按一下 **是 tooall**或**是**(如果您看到**是 tooall**，如果選取該選項 –您不會看到**是 tooall**，然後按一下 **是**)。</span><span class="sxs-lookup"><span data-stu-id="298af-172">If you see a dialog box telling about hello effects of hello change tooexecution policy, click either **Yes tooall** or **Yes** (if you see **Yes tooall**, select that option – if you do not see **Yes tooall**, then click **Yes**).</span></span>
4. <span data-ttu-id="298af-173">登入 Azure 帳戶。</span><span class="sxs-lookup"><span data-stu-id="298af-173">Log into your Azure account.</span></span> <span data-ttu-id="298af-174">在 [hello] 主控台中，輸入**登入 AzureRmAccount**按**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-174">In hello console, type **Login-AzureRmAccount** and press **ENTER**.</span></span> <span data-ttu-id="298af-175">將會出現一個對話方塊，您可以在其中輸入您的認證 (請確定您有權限 toochange hello 虛擬機器 – 如果您沒有權限，就能 tooencrypt 它們。</span><span class="sxs-lookup"><span data-stu-id="298af-175">A dialog box will appear in which you enter your credentials (make sure you have rights toochange hello virtual machines – if you do not have rights, you will not be able tooencrypt them.</span></span> <span data-ttu-id="298af-176">如果不能確定，請詢問訂用帳戶擁有者或系統管理員)。</span><span class="sxs-lookup"><span data-stu-id="298af-176">If you are not sure, ask your subscription owner or administrator).</span></span> <span data-ttu-id="298af-177">您應該會看到您 **Environment**、**Account**、**TenantId**、**SubscriptionId** 和 **CurrentStorageAccount** 的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="298af-177">You should see information about your **Environment**, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span> <span data-ttu-id="298af-178">複製 hello **SubscriptionId** tooNotepad。</span><span class="sxs-lookup"><span data-stu-id="298af-178">Copy hello **SubscriptionId** tooNotepad.</span></span> <span data-ttu-id="298af-179">您將需要 toouse 這步驟 #6 中。</span><span class="sxs-lookup"><span data-stu-id="298af-179">You will need toouse this in step #6.</span></span>
5. <span data-ttu-id="298af-180">尋找您的虛擬機器什麼訂用帳戶所屬 tooand 其位置。</span><span class="sxs-lookup"><span data-stu-id="298af-180">Find what subscription your virtual machine belongs tooand its location.</span></span> <span data-ttu-id="298af-181">跳過[https://portal.azure.com](ttps://portal.azure.com)並登入。</span><span class="sxs-lookup"><span data-stu-id="298af-181">Go too[https://portal.azure.com](ttps://portal.azure.com) and log in.</span></span>  <span data-ttu-id="298af-182">在 hello hello 頁面的左側，按一下 **虛擬機器**。</span><span class="sxs-lookup"><span data-stu-id="298af-182">On hello left side of hello page, click **Virtual Machines**.</span></span> <span data-ttu-id="298af-183">您會看到一份您的虛擬機器和其所屬的 hello 訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="298af-183">You will see a list of your virtual machines and hello subscriptions they belong to.</span></span>

   ![虛擬機器](./media/security-center-disk-encryption/security-center-disk-encryption-fig3.png)
6. <span data-ttu-id="298af-185">傳回 toohello PowerShell ISE。</span><span class="sxs-lookup"><span data-stu-id="298af-185">Return toohello PowerShell ISE.</span></span> <span data-ttu-id="298af-186">設定將在其中執行 hello 指令碼 hello 訂用帳戶的內容。</span><span class="sxs-lookup"><span data-stu-id="298af-186">Set hello subscription context in which hello script will be run.</span></span> <span data-ttu-id="298af-187">在 [hello] 主控台中，輸入**選取 AzureRmSubscription – 訂用帳戶 Id < your_subscription_Id >** (取代**< your_subscription_Id >**與實際的訂用帳戶 ID) 按**輸入**。</span><span class="sxs-lookup"><span data-stu-id="298af-187">In hello console, type **Select-AzureRmSubscription –SubscriptionId <your_subscription_Id>** (replace **< your_subscription_Id >** with your actual Subscription ID) and press **ENTER**.</span></span> <span data-ttu-id="298af-188">您會看到 hello 環境中，資訊**帳戶**， **TenantId**， **SubscriptionId**和**CurrentStorageAccount**。</span><span class="sxs-lookup"><span data-stu-id="298af-188">You will see information about hello Environment, **Account**, **TenantId**, **SubscriptionId** and **CurrentStorageAccount**.</span></span>
7. <span data-ttu-id="298af-189">現在您已經準備就緒 toorun hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="298af-189">You are now ready toorun hello script.</span></span> <span data-ttu-id="298af-190">按一下 hello**執行指令碼**按鈕或按**F5** hello 鍵盤上。</span><span class="sxs-lookup"><span data-stu-id="298af-190">Click hello **Run Script** button or press **F5** on hello keyboard.</span></span>

   ![執行 PowerShell 指令碼](./media/security-center-disk-encryption/security-center-disk-encryption-fig4.png)
8. <span data-ttu-id="298af-192">hello 指令碼會要求**resourceGroupName:** -輸入 hello 名稱*資源群組*想 toouse，然後按下**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-192">hello script asks for **resourceGroupName:** - enter hello name of *Resource Group* you want toouse, then press **ENTER**.</span></span> <span data-ttu-id="298af-193">如果您沒有的話，請輸入您要 toouse 一個新名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-193">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="298af-194">如果您已經有*資源群組*您想 toouse （例如 hello 其中所用虛擬機器)、 輸入 hello hello 現有的資源群組名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-194">If you already have a *Resource Group* that you want toouse (such as hello one that your virtual machine is in), enter hello name of hello existing Resource Group.</span></span>
9. <span data-ttu-id="298af-195">hello 指令碼會要求**keyVaultName:** -輸入 hello hello 名稱*金鑰保存庫*toouse，然後按 ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="298af-195">hello script asks for **keyVaultName:** - enter hello name of hello *Key Vault* you want toouse, then press ENTER.</span></span> <span data-ttu-id="298af-196">如果您沒有的話，請輸入您要 toouse 一個新名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-196">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="298af-197">如果您已經有您想 toouse 金鑰保存庫，輸入 hello 名稱 hello 現有*金鑰保存庫*。</span><span class="sxs-lookup"><span data-stu-id="298af-197">If you already have a Key Vault that you want toouse, enter hello name of hello existing *Key Vault*.</span></span>
10. <span data-ttu-id="298af-198">hello 指令碼會要求**位置：** -輸入 hello 名稱 hello 位置中的 hello 想 tooencrypt VM 所在，然後按下**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-198">hello script asks for **location:** - enter hello name of hello location in which hello VM you want tooencrypt is located, then press **ENTER**.</span></span> <span data-ttu-id="298af-199">如果您不記得 hello 位置，請回到 toostep #5。</span><span class="sxs-lookup"><span data-stu-id="298af-199">If you don’t remember hello location, go back toostep #5.</span></span>
11. <span data-ttu-id="298af-200">hello 指令碼會要求**aadAppName:** -輸入 hello hello 名稱*Azure Active Directory*應用程式想 toouse，然後按下**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-200">hello script asks for **aadAppName:** - enter hello name of hello *Azure Active Directory* application you want toouse, then press **ENTER**.</span></span> <span data-ttu-id="298af-201">如果您沒有的話，請輸入您要 toouse 一個新名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-201">If you don’t have one, enter a name you want toouse for a new one.</span></span> <span data-ttu-id="298af-202">如果您已經有*Azure Active Directory 應用程式*您想 toouse、 輸入 hello 名稱 hello 現有*Azure Active Directory 應用程式*。</span><span class="sxs-lookup"><span data-stu-id="298af-202">If you already have an *Azure Active Directory application* that you want toouse, enter hello name of hello existing *Azure Active Directory application*.</span></span>
12. <span data-ttu-id="298af-203">此時會出現登入對話方塊。</span><span class="sxs-lookup"><span data-stu-id="298af-203">A log in dialog box will appear.</span></span> <span data-ttu-id="298af-204">提供您的認證 (是，您已登入一次，但現在您需要 toodo 再試一次)。</span><span class="sxs-lookup"><span data-stu-id="298af-204">Provide your credentials (yes, you have logged in once, but now you need toodo it again).</span></span>
13. <span data-ttu-id="298af-205">hello 指令碼執行和完成時它會要求您的 hello toocopy hello 值**aadClientID**， **aadClientSecret**， **diskEncryptionKeyVaultUrl**，和**keyVaultResourceId**。</span><span class="sxs-lookup"><span data-stu-id="298af-205">hello script runs and when complete it will ask you toocopy hello values of hello **aadClientID**, **aadClientSecret**, **diskEncryptionKeyVaultUrl**, and **keyVaultResourceId**.</span></span> <span data-ttu-id="298af-206">每個這些值 toohello 剪貼簿複製並貼入 [記事本]。</span><span class="sxs-lookup"><span data-stu-id="298af-206">Copy each of these values toohello clipboard and paste them into Notepad.</span></span>
14. <span data-ttu-id="298af-207">傳回 toohello PowerShell ISE，並將 hello 資料指標放在 hello 結尾 hello 最後一行，然後按**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-207">Return toohello PowerShell ISE and place hello cursor at hello end of hello last line, and press **ENTER**.</span></span>

<span data-ttu-id="298af-208">hello hello 指令碼的輸出看起來應該像囉 」 畫面下方：</span><span class="sxs-lookup"><span data-stu-id="298af-208">hello output of hello script should look something like hello screen below:</span></span>

![PowerShell 輸出](./media/security-center-disk-encryption/security-center-disk-encryption-fig5.png)

## <a name="encrypt-hello-azure-virtual-machine"></a><span data-ttu-id="298af-210">加密 hello Azure 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="298af-210">Encrypt hello Azure virtual machine</span></span>
<span data-ttu-id="298af-211">您會 tooencrypt 現在準備好您的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-211">You are now ready tooencrypt your virtual machine.</span></span> <span data-ttu-id="298af-212">如果您的虛擬機器位於 hello 相同的資源群組，為您金鑰保存庫中，您可以移 toohello 加密步驟一節。</span><span class="sxs-lookup"><span data-stu-id="298af-212">If your virtual machine is located in hello same Resource Group as your Key Vault, you can move on toohello encryption steps section.</span></span> <span data-ttu-id="298af-213">不過，如果您的虛擬機器不在 hello 相同資源群組為您金鑰保存庫，您必須在 hello PowerShell ISE 中的 hello 主控台 tooenter hello 下列：</span><span class="sxs-lookup"><span data-stu-id="298af-213">However, if your virtual machine is not in hello same Resource Group as your Key Vault, you will need tooenter hello following in hello console in hello PowerShell ISE:</span></span>

<span data-ttu-id="298af-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span><span class="sxs-lookup"><span data-stu-id="298af-214">**$resourceGroupName = <’Virtual_Machine_RG’>**</span></span>

<span data-ttu-id="298af-215">取代**< Virtual_Machine_RG >** hello hello 資源群組，其中會包含您的虛擬機器名稱，並以單引號括住。</span><span class="sxs-lookup"><span data-stu-id="298af-215">Replace **< Virtual_Machine_RG >** with hello name of hello Resource Group in which your virtual machines are contained, surrounded by a single quote.</span></span> <span data-ttu-id="298af-216">然後按 **ENTER**鍵。</span><span class="sxs-lookup"><span data-stu-id="298af-216">Then press **ENTER**.</span></span>
<span data-ttu-id="298af-217">hello 正確輸入資源群組名稱中，輸入 hello PowerShell ISE 主控台 hello 下列 tooconfirm:</span><span class="sxs-lookup"><span data-stu-id="298af-217">tooconfirm that hello correct Resource Group name was entered, type hello following in hello PowerShell ISE console:</span></span>

<span data-ttu-id="298af-218">**$resourceGroupName**</span><span class="sxs-lookup"><span data-stu-id="298af-218">**$resourceGroupName**</span></span>

<span data-ttu-id="298af-219">按 **ENTER**鍵。</span><span class="sxs-lookup"><span data-stu-id="298af-219">Press **ENTER**.</span></span> <span data-ttu-id="298af-220">您應該會看到 hello 位於您的虛擬機器的資源群組名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-220">You should see hello name of Resource Group that your virtual machines are located in.</span></span> <span data-ttu-id="298af-221">例如：</span><span class="sxs-lookup"><span data-stu-id="298af-221">For example:</span></span>

![PowerShell 輸出](./media/security-center-disk-encryption/security-center-disk-encryption-fig6.png)

### <a name="encryption-steps"></a><span data-ttu-id="298af-223">加密步驟</span><span class="sxs-lookup"><span data-stu-id="298af-223">Encryption steps</span></span>
<span data-ttu-id="298af-224">首先，您需要 tootell PowerShell hello 名稱要 tooencrypt 的 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-224">First, you need tootell PowerShell hello name of hello virtual machine you want tooencrypt.</span></span> <span data-ttu-id="298af-225">在 [hello] 主控台中，輸入：</span><span class="sxs-lookup"><span data-stu-id="298af-225">In hello console, type:</span></span>

<span data-ttu-id="298af-226">**$vmName = <’your_vm_name’>**</span><span class="sxs-lookup"><span data-stu-id="298af-226">**$vmName = <’your_vm_name’>**</span></span>

<span data-ttu-id="298af-227">取代**<'your_vm_name ' >** hello VM 名稱 （請確定 hello 名稱必須以括住的單引號），然後按**ENTER**。</span><span class="sxs-lookup"><span data-stu-id="298af-227">Replace **<’your_vm_name’>** with hello name of your VM (make sure hello name is surrounded by a single quote) and then press **ENTER**.</span></span>

<span data-ttu-id="298af-228">tooconfirm hello 正確輸入 VM 名稱，請輸入：</span><span class="sxs-lookup"><span data-stu-id="298af-228">tooconfirm that hello correct VM name was entered, type:</span></span>

<span data-ttu-id="298af-229">**$vmName**</span><span class="sxs-lookup"><span data-stu-id="298af-229">**$vmName**</span></span>

<span data-ttu-id="298af-230">按 **ENTER**鍵。</span><span class="sxs-lookup"><span data-stu-id="298af-230">Press **ENTER**.</span></span> <span data-ttu-id="298af-231">您應該會看到 hello 名稱要 tooencrypt 的 hello 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-231">You should see hello name of hello virtual machine you want tooencrypt.</span></span> <span data-ttu-id="298af-232">例如：</span><span class="sxs-lookup"><span data-stu-id="298af-232">For example:</span></span>

![PowerShell 輸出](./media/security-center-disk-encryption/security-center-disk-encryption-fig7.png)

<span data-ttu-id="298af-234">有兩個方法 toorun hello 加密命令 tooencrypt 所有磁碟機 hello 虛擬機器上。</span><span class="sxs-lookup"><span data-stu-id="298af-234">There are two methods toorun hello encryption command tooencrypt all drives on hello virtual machine.</span></span> <span data-ttu-id="298af-235">hello 第一種方法是下列命令在 PowerShell ISE 主控台 hello tootype hello:</span><span class="sxs-lookup"><span data-stu-id="298af-235">hello first method is tootype hello following command in hello PowerShell ISE console:</span></span>

~~~
Set-AzureRmVMDiskEncryptionExtension -ResourceGroupName $resourceGroupName -VMName $vmName -AadClientID $aadClientID -AadClientSecret $aadClientSecret -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl -DiskEncryptionKeyVaultId $keyVaultResourceId -VolumeType All
~~~

<span data-ttu-id="298af-236">在輸入此命令後，按 **ENTER**鍵。</span><span class="sxs-lookup"><span data-stu-id="298af-236">After typing this command press **ENTER**.</span></span>

<span data-ttu-id="298af-237">hello 第二種方法是 tooclick hello 指令碼窗格 （使用 hello PowerShell ISE 的 hello 上方窗格） 中，捲動 toohello hello 指令碼底部。</span><span class="sxs-lookup"><span data-stu-id="298af-237">hello second method is tooclick in hello script pane (hello top pane of hello PowerShell ISE) and scroll down toohello bottom of hello script.</span></span> <span data-ttu-id="298af-238">反白顯示 hello 上面所列的命令並再以滑鼠右鍵按一下它，然後按一下**執行選取項目**或按**F8** hello 鍵盤上。</span><span class="sxs-lookup"><span data-stu-id="298af-238">Highlight hello command listed above, and then right click it and then click **Run Selection** or press **F8** on hello keyboard.</span></span>

![PowerShell ISE](./media/security-center-disk-encryption/security-center-disk-encryption-fig8.png)

<span data-ttu-id="298af-240">不論 hello 方法使用，將會出現一個對話方塊通知您需要的 hello 作業 toocomplete 10-15 分鐘。</span><span class="sxs-lookup"><span data-stu-id="298af-240">Regardless of hello method you use, a dialog box will appear informing you that it will take 10-15 minutes for hello operation toocomplete.</span></span> <span data-ttu-id="298af-241">按一下 [是] 。</span><span class="sxs-lookup"><span data-stu-id="298af-241">Click **Yes**.</span></span>

<span data-ttu-id="298af-242">進行 hello 加密程序時，您可以傳回 toohello Azure 入口網站，並查看 hello hello 虛擬機器狀態。</span><span class="sxs-lookup"><span data-stu-id="298af-242">While hello encryption process is taking place, you can return toohello Azure Portal and see hello status of hello virtual machine.</span></span> <span data-ttu-id="298af-243">在 hello hello 頁面的左側，按一下 **虛擬機器**，然後在 hello**虛擬機器**刀鋒視窗中，按一下您要加密的 hello 虛擬機器的 hello 名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-243">On hello left side of hello page, click **Virtual Machines**, then in hello **Virtual Machines** blade, click hello name of hello virtual machine you’re encrypting.</span></span> <span data-ttu-id="298af-244">在出現的 hello 刀鋒視窗，您會發現該 hello**狀態**指出它是**更新**。</span><span class="sxs-lookup"><span data-stu-id="298af-244">In hello blade that appears, you’ll notice that hello **Status** says that it’s **Updating**.</span></span> <span data-ttu-id="298af-245">下圖展示進行中的加密。</span><span class="sxs-lookup"><span data-stu-id="298af-245">This demonstrates that encryption is in process.</span></span>

![更多詳細 hello VM](./media/security-center-disk-encryption/security-center-disk-encryption-fig9.png)

<span data-ttu-id="298af-247">傳回 toohello PowerShell ISE。</span><span class="sxs-lookup"><span data-stu-id="298af-247">Return toohello PowerShell ISE.</span></span> <span data-ttu-id="298af-248">Hello 指令碼完成時，您會看到在 hello 圖中顯示的內容。</span><span class="sxs-lookup"><span data-stu-id="298af-248">When hello script completes, you’ll see what appears in hello figure below.</span></span>

![PowerShell 輸出](./media/security-center-disk-encryption/security-center-disk-encryption-fig10.png)

<span data-ttu-id="298af-250">hello 虛擬機器的 toodemonstrate 現在會加密，傳回 toohello Azure 入口網站，然後按一下**虛擬機器**上 hello hello 頁面的左側。</span><span class="sxs-lookup"><span data-stu-id="298af-250">toodemonstrate that hello virtual machine is now encrypted, return toohello Azure Portal and click **Virtual Machines** on hello left side of hello page.</span></span> <span data-ttu-id="298af-251">按一下 hello 加密 hello 虛擬機器名稱。</span><span class="sxs-lookup"><span data-stu-id="298af-251">Click hello name of hello virtual machine you encrypted.</span></span> <span data-ttu-id="298af-252">在 hello**設定**刀鋒視窗中，按一下 **磁碟**。</span><span class="sxs-lookup"><span data-stu-id="298af-252">In hello **Settings** blade, click **Disks**.</span></span>

![設定選項](./media/security-center-disk-encryption/security-center-disk-encryption-fig11.png)

<span data-ttu-id="298af-254">在 hello**磁碟**刀鋒視窗中，您會看到**加密**是**啟用**。</span><span class="sxs-lookup"><span data-stu-id="298af-254">On hello **Disks** blade, you will see that **Encryption** is **Enabled**.</span></span>

![磁碟屬性](./media/security-center-disk-encryption/security-center-disk-encryption-fig12.png)

## <a name="next-steps"></a><span data-ttu-id="298af-256">後續步驟</span><span class="sxs-lookup"><span data-stu-id="298af-256">Next steps</span></span>
<span data-ttu-id="298af-257">在本文件中，您學到如何 tooencrypt Azure 虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="298af-257">In this document, you learned how tooencrypt an Azure Virtual Machine.</span></span> <span data-ttu-id="298af-258">toolearn 進一步了解 Azure 資訊安全中心，請參閱 hello 下列資訊：</span><span class="sxs-lookup"><span data-stu-id="298af-258">toolearn more about Azure Security Center, see hello following:</span></span>

* <span data-ttu-id="298af-259">[在 Azure 資訊安全中心中的安全性健全狀況監視](security-center-monitoring.md)– 了解如何 toomonitor hello 您的 Azure 資源的健全狀況</span><span class="sxs-lookup"><span data-stu-id="298af-259">[Security health monitoring in Azure Security Center](security-center-monitoring.md) – Learn how toomonitor hello health of your Azure resources</span></span>
* <span data-ttu-id="298af-260">[在 Azure 資訊安全中心警示管理，而且有回應 toosecurity](security-center-managing-and-responding-alerts.md) -了解如何 toomanage 和回應 toosecurity 警示</span><span class="sxs-lookup"><span data-stu-id="298af-260">[Managing and responding toosecurity alerts in Azure Security Center](security-center-managing-and-responding-alerts.md) - Learn how toomanage and respond toosecurity alerts</span></span>
* <span data-ttu-id="298af-261">[Azure 資訊安全中心常見問題集](security-center-faq.md)– 尋找使用 hello 服務相關的常見問題集</span><span class="sxs-lookup"><span data-stu-id="298af-261">[Azure Security Center FAQ](security-center-faq.md) – Find frequently asked questions about using hello service</span></span>
* <span data-ttu-id="298af-262">[Azure 安全性部落格](http://blogs.msdn.com/b/azuresecurity/) – 尋找有關 Azure 安全性與相容性的部落格文章</span><span class="sxs-lookup"><span data-stu-id="298af-262">[Azure Security Blog](http://blogs.msdn.com/b/azuresecurity/) – Find blog posts about Azure security and compliance</span></span>
