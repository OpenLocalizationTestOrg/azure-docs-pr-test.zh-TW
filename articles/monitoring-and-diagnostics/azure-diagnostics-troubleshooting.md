---
title: "Azure 診斷 aaaTroubleshooting |Microsoft 文件"
description: "針對在 Azure 虛擬機器、Service Fabric 或 雲端服務中使用 Azure 診斷時出現的問題進行疑難排解。"
services: monitoring-and-diagnostics
documentationcenter: .net
author: rboucher
manager: carmonm
editor: 
ms.assetid: 66469bce-d457-4d1e-b550-a08d2be4d28c
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 07/12/2017
ms.author: robb
ms.openlocfilehash: daaf9fa4c40982eb9ba04030d7e8ea1ad9fe085b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-diagnostics-troubleshooting"></a><span data-ttu-id="6501d-103">Azure 診斷疑難排解</span><span class="sxs-lookup"><span data-stu-id="6501d-103">Azure Diagnostics Troubleshooting</span></span>
<span data-ttu-id="6501d-104">疑難排解資訊相關 toousing Azure 診斷。</span><span class="sxs-lookup"><span data-stu-id="6501d-104">Troubleshooting information relevant toousing Azure Diagnostics.</span></span> <span data-ttu-id="6501d-105">如需有關 Azure 診斷的詳細資訊，請參閱 [Azure 診斷概觀](azure-diagnostics.md)。</span><span class="sxs-lookup"><span data-stu-id="6501d-105">For more information on Azure diagnostics, see [Azure Diagnostics Overview](azure-diagnostics.md).</span></span>

## <a name="logical-components"></a><span data-ttu-id="6501d-106">邏輯元件</span><span class="sxs-lookup"><span data-stu-id="6501d-106">Logical Components</span></span>
<span data-ttu-id="6501d-107">**診斷外掛程式啟動器 (DiagnosticsPluginLauncher.exe)**： 啟動 hello Azure 診斷擴充功能。</span><span class="sxs-lookup"><span data-stu-id="6501d-107">**Diagnostics Plugin Launcher (DiagnosticsPluginLauncher.exe)**: Launches hello Azure Diagnostics extension.</span></span> <span data-ttu-id="6501d-108">可做為 hello 進入點程序。</span><span class="sxs-lookup"><span data-stu-id="6501d-108">Serves as hello entry point process.</span></span>

<span data-ttu-id="6501d-109">**診斷外掛程式 (DiagnosticsPlugin.exe)**: hello 上述的啟動器所啟動並設定 hello 監視 」 代理程式、 啟動及管理其存留期的 Main 程序。</span><span class="sxs-lookup"><span data-stu-id="6501d-109">**Diagnostics Plugin (DiagnosticsPlugin.exe)**: Main process that is launched by hello launcher above and configures hello Monitoring Agent, launches it and manages its lifetime.</span></span> 

<span data-ttu-id="6501d-110">**監視代理程式 (MonAgent\*.exe 處理序)**： 這些處理程序執行 hello 大量 hello 工作; 也就是監視、 集合和傳送 hello 診斷資料。</span><span class="sxs-lookup"><span data-stu-id="6501d-110">**Monitoring Agent (MonAgent\*.exe processes)**: These processes do hello bulk of hello work; i.e., monitoring, collection and transfer of hello diagnostics data.</span></span>  

## <a name="logartifact-paths"></a><span data-ttu-id="6501d-111">記錄檔/構件路徑</span><span class="sxs-lookup"><span data-stu-id="6501d-111">Log/Artifact Paths</span></span>
<span data-ttu-id="6501d-112">以下是 hello 路徑 toosome 重要記錄檔和成品。</span><span class="sxs-lookup"><span data-stu-id="6501d-112">Here are hello paths toosome important logs and artifacts.</span></span> <span data-ttu-id="6501d-113">我們將參考 toothese 其餘 hello 文件的 hello:</span><span class="sxs-lookup"><span data-stu-id="6501d-113">We keep referring toothese throughout hello rest of hello document:</span></span>
### <a name="cloud-services"></a><span data-ttu-id="6501d-114">雲端服務</span><span class="sxs-lookup"><span data-stu-id="6501d-114">Cloud Services</span></span>
| <span data-ttu-id="6501d-115">構件</span><span class="sxs-lookup"><span data-stu-id="6501d-115">Artifact</span></span> | <span data-ttu-id="6501d-116">路徑</span><span class="sxs-lookup"><span data-stu-id="6501d-116">Path</span></span> |
| --- | --- |
| <span data-ttu-id="6501d-117">**Azure 診斷組態檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-117">**Azure Diagnostics configuration file**</span></span> | <span data-ttu-id="6501d-118">%SystemDrive%\Packages\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version>\Config.txt</span><span class="sxs-lookup"><span data-stu-id="6501d-118">%SystemDrive%\Packages\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version>\Config.txt</span></span> |
| <span data-ttu-id="6501d-119">**記錄檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-119">**Log files**</span></span> | <span data-ttu-id="6501d-120">C:\Logs\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version>\\</span><span class="sxs-lookup"><span data-stu-id="6501d-120">C:\Logs\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version>\\</span></span> |
| <span data-ttu-id="6501d-121">**診斷資料的本機存放區**</span><span class="sxs-lookup"><span data-stu-id="6501d-121">**Local store for diagnostics data**</span></span> | <span data-ttu-id="6501d-122">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Tables</span><span class="sxs-lookup"><span data-stu-id="6501d-122">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Tables</span></span> |
| <span data-ttu-id="6501d-123">**監視代理程式組態檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-123">**Monitoring Agent configuration file**</span></span> | <span data-ttu-id="6501d-124">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Configuration\MaConfig.xml</span><span class="sxs-lookup"><span data-stu-id="6501d-124">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Configuration\MaConfig.xml</span></span> |
| <span data-ttu-id="6501d-125">**Azure 診斷擴充功能套件**</span><span class="sxs-lookup"><span data-stu-id="6501d-125">**Azure diagnostics extension package**</span></span> | <span data-ttu-id="6501d-126">%SystemDrive%\Packages\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version></span><span class="sxs-lookup"><span data-stu-id="6501d-126">%SystemDrive%\Packages\Plugins\Microsoft.Azure.Diagnostics.PaaSDiagnostics\<version></span></span> |
| <span data-ttu-id="6501d-127">**記錄集合公用程式路徑**</span><span class="sxs-lookup"><span data-stu-id="6501d-127">**Log collection utility path**</span></span> | <span data-ttu-id="6501d-128">%SystemDrive%\Packages\GuestAgent\\</span><span class="sxs-lookup"><span data-stu-id="6501d-128">%SystemDrive%\Packages\GuestAgent\\</span></span> |
| <span data-ttu-id="6501d-129">**MonAgentHost 記錄檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-129">**MonAgentHost log file**</span></span> | <span data-ttu-id="6501d-130">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Configuration\MonAgentHost.<seq_num>.log</span><span class="sxs-lookup"><span data-stu-id="6501d-130">C:\Resources\Directory\<CloudServiceDeploymentID>.\<RoleName>.DiagnosticStore\WAD0107\Configuration\MonAgentHost.<seq_num>.log</span></span> |

### <a name="virtual-machines"></a><span data-ttu-id="6501d-131">虛擬機器</span><span class="sxs-lookup"><span data-stu-id="6501d-131">Virtual Machines</span></span>
| <span data-ttu-id="6501d-132">構件</span><span class="sxs-lookup"><span data-stu-id="6501d-132">Artifact</span></span> | <span data-ttu-id="6501d-133">路徑</span><span class="sxs-lookup"><span data-stu-id="6501d-133">Path</span></span> |
| --- | --- |
| <span data-ttu-id="6501d-134">**Azure 診斷組態檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-134">**Azure Diagnostics configuration file**</span></span> | <span data-ttu-id="6501d-135">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\RuntimeSettings</span><span class="sxs-lookup"><span data-stu-id="6501d-135">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\RuntimeSettings</span></span> |
| <span data-ttu-id="6501d-136">**記錄檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-136">**Log files**</span></span> | <span data-ttu-id="6501d-137">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\Logs\\</span><span class="sxs-lookup"><span data-stu-id="6501d-137">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\Logs\\</span></span> |
| <span data-ttu-id="6501d-138">**診斷資料的本機存放區**</span><span class="sxs-lookup"><span data-stu-id="6501d-138">**Local store for diagnostics data**</span></span> | <span data-ttu-id="6501d-139">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Tables</span><span class="sxs-lookup"><span data-stu-id="6501d-139">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Tables</span></span> |
| <span data-ttu-id="6501d-140">**監視代理程式組態檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-140">**Monitoring Agent configuration file**</span></span> | <span data-ttu-id="6501d-141">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Configuration\MaConfig.xml</span><span class="sxs-lookup"><span data-stu-id="6501d-141">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Configuration\MaConfig.xml</span></span> |
| <span data-ttu-id="6501d-142">**狀態檔案**</span><span class="sxs-lookup"><span data-stu-id="6501d-142">**Status file**</span></span> | <span data-ttu-id="6501d-143">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\Status</span><span class="sxs-lookup"><span data-stu-id="6501d-143">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<version>\Status</span></span> |
| <span data-ttu-id="6501d-144">**Azure 診斷擴充功能套件**</span><span class="sxs-lookup"><span data-stu-id="6501d-144">**Azure diagnostics extension package**</span></span> | <span data-ttu-id="6501d-145">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion></span><span class="sxs-lookup"><span data-stu-id="6501d-145">C:\Packages\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion></span></span>|
| <span data-ttu-id="6501d-146">**記錄集合公用程式路徑**</span><span class="sxs-lookup"><span data-stu-id="6501d-146">**Log collection utility path**</span></span> | <span data-ttu-id="6501d-147">C:\WindowsAzure\Packages</span><span class="sxs-lookup"><span data-stu-id="6501d-147">C:\WindowsAzure\Packages</span></span> |
| <span data-ttu-id="6501d-148">**MonAgentHost 記錄檔**</span><span class="sxs-lookup"><span data-stu-id="6501d-148">**MonAgentHost log file**</span></span> | <span data-ttu-id="6501d-149">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Configuration\MonAgentHost.<seq_num>.log</span><span class="sxs-lookup"><span data-stu-id="6501d-149">C:\WindowsAzure\Logs\Plugins\Microsoft.Azure.Diagnostics.IaaSDiagnostics\<DiagnosticsVersion>\WAD0107\Configuration\MonAgentHost.<seq_num>.log</span></span> |

## <a name="metric-data-doesnt-show-in-azure-portal"></a><span data-ttu-id="6501d-150">計量資料不會出現在 Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="6501d-150">Metric data doesn't show in Azure portal</span></span>
<span data-ttu-id="6501d-151">Azure 診斷會提供一些計量資料，這些資料可以在 Azure 入口網站中顯示。</span><span class="sxs-lookup"><span data-stu-id="6501d-151">Azure Diagnostics provides a bunch of metric data, which can be displayed in Azure portal.</span></span> <span data-ttu-id="6501d-152">如果您有看到這些資料在入口網站中的問題，請檢查 hello 診斷儲存體帳戶]-> [WADMetrics\* toosee hello 對應度量記錄是否有資料表。</span><span class="sxs-lookup"><span data-stu-id="6501d-152">If you have problems with seeing these data in portal, check hello diagnostics storage account -> WADMetrics\* table toosee if hello corresponding metric records are there.</span></span> <span data-ttu-id="6501d-153">在這裡，hello PartitionKey 的 hello 資料表是 hello 資源 ID 的虛擬機器或虛擬機器規模集，而 hello RowKey hello 衡量標準名稱也就是效能計數器名稱。</span><span class="sxs-lookup"><span data-stu-id="6501d-153">Here, hello PartitionKey of hello table is hello resource ID of virtual machine or virtual machine scale set, and hello RowKey is hello metric name i.e. performance counter name.</span></span>

<span data-ttu-id="6501d-154">如果 hello 資源識別碼不正確，請核取診斷組態]-> [度量]-> [ResourceId toosee 如果 hello 資源識別碼正確設定。</span><span class="sxs-lookup"><span data-stu-id="6501d-154">If hello resource ID is incorrect, check Diagnostics Configuration -> Metrics -> ResourceId toosee if hello resource ID is set correctly.</span></span>

<span data-ttu-id="6501d-155">如果沒有針對 hello 特定度量資料，核取診斷組態]-> [PerformanceCounter toosee 包含 hello 公制 （效能計數器） 時。</span><span class="sxs-lookup"><span data-stu-id="6501d-155">If there's no data for hello specific metric, check Diagnostics Configuration -> PerformanceCounter toosee if hello metric(performance counter) is included.</span></span> <span data-ttu-id="6501d-156">我們會啟用下列預設計數器 hello。</span><span class="sxs-lookup"><span data-stu-id="6501d-156">We enable hello following counters by default.</span></span>
- <span data-ttu-id="6501d-157">\Processor(_Total)\% Processor Time</span><span class="sxs-lookup"><span data-stu-id="6501d-157">\Processor(_Total)\% Processor Time</span></span>
- <span data-ttu-id="6501d-158">\Memory\Available Bytes</span><span class="sxs-lookup"><span data-stu-id="6501d-158">\Memory\Available Bytes</span></span>
- <span data-ttu-id="6501d-159">\ASP.NET Applications(__Total__)\Requests/Sec</span><span class="sxs-lookup"><span data-stu-id="6501d-159">\ASP.NET Applications(__Total__)\Requests/Sec</span></span>
- <span data-ttu-id="6501d-160">\ASP.NET Applications(__Total__)\Errors Total/Sec</span><span class="sxs-lookup"><span data-stu-id="6501d-160">\ASP.NET Applications(__Total__)\Errors Total/Sec</span></span>
- <span data-ttu-id="6501d-161">\ASP.NET\Requests Queued</span><span class="sxs-lookup"><span data-stu-id="6501d-161">\ASP.NET\Requests Queued</span></span>
- <span data-ttu-id="6501d-162">\ASP.NET\Requests Rejected</span><span class="sxs-lookup"><span data-stu-id="6501d-162">\ASP.NET\Requests Rejected</span></span>
- <span data-ttu-id="6501d-163">\Processor(w3wp)\% Processor Time</span><span class="sxs-lookup"><span data-stu-id="6501d-163">\Processor(w3wp)\% Processor Time</span></span>
- <span data-ttu-id="6501d-164">\Process(w3wp)\Private Bytes</span><span class="sxs-lookup"><span data-stu-id="6501d-164">\Process(w3wp)\Private Bytes</span></span>
- <span data-ttu-id="6501d-165">\Process(WaIISHost)\% Processor Time</span><span class="sxs-lookup"><span data-stu-id="6501d-165">\Process(WaIISHost)\% Processor Time</span></span>
- <span data-ttu-id="6501d-166">\Process(WaIISHost)\Private Bytes</span><span class="sxs-lookup"><span data-stu-id="6501d-166">\Process(WaIISHost)\Private Bytes</span></span>
- <span data-ttu-id="6501d-167">\Process(WaWorkerHost)\% Processor Time</span><span class="sxs-lookup"><span data-stu-id="6501d-167">\Process(WaWorkerHost)\% Processor Time</span></span>
- <span data-ttu-id="6501d-168">\Process(WaWorkerHost)\Private Bytes</span><span class="sxs-lookup"><span data-stu-id="6501d-168">\Process(WaWorkerHost)\Private Bytes</span></span>
- <span data-ttu-id="6501d-169">\Memory\Page Faults/sec</span><span class="sxs-lookup"><span data-stu-id="6501d-169">\Memory\Page Faults/sec</span></span>
- <span data-ttu-id="6501d-170">\.NET CLR Memory(_Global_)\% Time in GC</span><span class="sxs-lookup"><span data-stu-id="6501d-170">\.NET CLR Memory(_Global_)\% Time in GC</span></span>
- <span data-ttu-id="6501d-171">\LogicalDisk(C:)\Disk Write Bytes/sec</span><span class="sxs-lookup"><span data-stu-id="6501d-171">\LogicalDisk(C:)\Disk Write Bytes/sec</span></span>
- <span data-ttu-id="6501d-172">\LogicalDisk(C:)\Disk Read Bytes/sec</span><span class="sxs-lookup"><span data-stu-id="6501d-172">\LogicalDisk(C:)\Disk Read Bytes/sec</span></span>
- <span data-ttu-id="6501d-173">\LogicalDisk(D:)\Disk Write Bytes/sec</span><span class="sxs-lookup"><span data-stu-id="6501d-173">\LogicalDisk(D:)\Disk Write Bytes/sec</span></span>
- <span data-ttu-id="6501d-174">\LogicalDisk(D:)\Disk Read Bytes/sec</span><span class="sxs-lookup"><span data-stu-id="6501d-174">\LogicalDisk(D:)\Disk Read Bytes/sec</span></span>

<span data-ttu-id="6501d-175">如果 hello 組態已正確設定，但您仍然無法看到 hello 度量資料，請遵循下方的 hello 進一步調查的 hello 指導方針。</span><span class="sxs-lookup"><span data-stu-id="6501d-175">If hello configuration is set correctly but you still cannot see hello metric data, follow hello guidelines below for hello further investigation.</span></span>


## <a name="azure-diagnostics-is-not-starting"></a><span data-ttu-id="6501d-176">Azure 診斷未啟動</span><span class="sxs-lookup"><span data-stu-id="6501d-176">Azure Diagnostics is not Starting</span></span>
<span data-ttu-id="6501d-177">查看**DiagnosticsPluginLauncher.log**和**DiagnosticsPlugin.log** hello hello 位置的檔案在上方的原因的資訊診斷失敗 toostart 提供記錄檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-177">Look at **DiagnosticsPluginLauncher.log** and **DiagnosticsPlugin.log** files from hello location of hello log files provided above for information on why diagnostics failed toostart.</span></span> 

<span data-ttu-id="6501d-178">如果這些記錄指出 `Monitoring Agent not reporting success after launch`，則表示啟動 MonAgentHost.exe 失敗。</span><span class="sxs-lookup"><span data-stu-id="6501d-178">If these logs indicate `Monitoring Agent not reporting success after launch`, it means there was a failure launching MonAgentHost.exe.</span></span> <span data-ttu-id="6501d-179">查看 hello 記錄檔的 hello 位置替`MonAgentHost log file`上述 hello 區段中。</span><span class="sxs-lookup"><span data-stu-id="6501d-179">Look at hello logs for that in hello location indicated for `MonAgentHost log file` in hello section above.</span></span>

<span data-ttu-id="6501d-180">hello hello 記錄檔的最後一行包含 hello 結束代碼。</span><span class="sxs-lookup"><span data-stu-id="6501d-180">hello last line of hello log files contains hello exit code.</span></span>  

```
DiagnosticsPluginLauncher.exe Information: 0 : [4/16/2016 6:24:15 AM] DiagnosticPlugin exited with code 0
```
<span data-ttu-id="6501d-181">如果您發現**負數**結束代碼，請參閱 toohello[結束程式碼資料表](#azure-diagnostics-plugin-exit-codes)在 hello[參考](#references)。</span><span class="sxs-lookup"><span data-stu-id="6501d-181">If you find a **negative** exit code, refer toohello [exit code table](#azure-diagnostics-plugin-exit-codes) in hello [References](#references).</span></span>

## <a name="diagnostics-data-is-not-logged-tooazure-storage"></a><span data-ttu-id="6501d-182">診斷資料均不會記錄 tooAzure 儲存體</span><span class="sxs-lookup"><span data-stu-id="6501d-182">Diagnostics Data is Not Logged tooAzure Storage</span></span>
<span data-ttu-id="6501d-183">判斷顯示任何資料，或只是某些 hello 資料未顯示。</span><span class="sxs-lookup"><span data-stu-id="6501d-183">Determine if no data is showing up or only some of hello data is not showing up.</span></span>

### <a name="diagnostics-infrastructure-logs"></a><span data-ttu-id="6501d-184">診斷基礎結構記錄檔</span><span class="sxs-lookup"><span data-stu-id="6501d-184">Diagnostics Infrastructure Logs</span></span>
<span data-ttu-id="6501d-185">診斷基礎結構記錄檔是 Azure 診斷記錄任何所發生錯誤的所在位置。</span><span class="sxs-lookup"><span data-stu-id="6501d-185">Diagnostics Infrastructure Logs is where azure diagnostics logs any errors that it runs into.</span></span> <span data-ttu-id="6501d-186">請確定您已啟用 ([如何？](#how-to-check-diagnostics-extension-configuration)) 擷取診斷基礎結構記錄檔，您可以在組態和任何相關的錯誤顯示在 hello 中快速尋找`DiagnosticInfrastructureLogsTable`設定的儲存體帳戶中的資料表。</span><span class="sxs-lookup"><span data-stu-id="6501d-186">Make sure you have enabled ([how to?](#how-to-check-diagnostics-extension-configuration)) capturing of Diagnostics Infrastructure logs in your configuration and quickly look for any relevant errors that show up in hello `DiagnosticInfrastructureLogsTable` table in your configured storage account.</span></span>

### <a name="no-data-is-showing-up"></a><span data-ttu-id="6501d-187">未顯示任何資料</span><span class="sxs-lookup"><span data-stu-id="6501d-187">No data is showing up</span></span>
<span data-ttu-id="6501d-188">hello 完全遺失的事件資料的最常見的原因是未正確定義的儲存體帳戶資訊。</span><span class="sxs-lookup"><span data-stu-id="6501d-188">hello most common cause of event data entirely missing is incorrectly defined storage account information.</span></span>

<span data-ttu-id="6501d-189">解決方法：更正診斷組態，並重新安裝診斷。</span><span class="sxs-lookup"><span data-stu-id="6501d-189">Solution: Correct your Diagnostics configuration and reinstall Diagnostics.</span></span>

<span data-ttu-id="6501d-190">Hello 儲存體帳戶是否已正確設定的遠端桌面至 hello 機器，請確定 DiagnosticsPlugin.exe 且 MonAgentCore.exe 正在執行。</span><span class="sxs-lookup"><span data-stu-id="6501d-190">If hello storage account is configured correctly, remote desktop into hello machine and make sure DiagnosticsPlugin.exe and MonAgentCore.exe are running.</span></span> <span data-ttu-id="6501d-191">如果它們並未執行，請依照 [Azure 診斷未啟動](#azure-diagnostics-is-not-starting)中的說明進行作業。</span><span class="sxs-lookup"><span data-stu-id="6501d-191">If they are not running, follow [Azure Diagnostics is not Starting](#azure-diagnostics-is-not-starting).</span></span> <span data-ttu-id="6501d-192">如果 hello 處理序正在執行、 跳過[會取得在本機擷取資料](#is-data-getting-captured-locally)依本指南從該處。</span><span class="sxs-lookup"><span data-stu-id="6501d-192">If hello processes are running, jump too[Is data getting captured locally](#is-data-getting-captured-locally) and follow this guide from there on.</span></span>

### <a name="part-of-hello-data-is-missing"></a><span data-ttu-id="6501d-193">遺漏 hello 資料的一部分</span><span class="sxs-lookup"><span data-stu-id="6501d-193">Part of hello data is missing</span></span>
<span data-ttu-id="6501d-194">如果您正在取得某些資料，但沒有取得其他資料。</span><span class="sxs-lookup"><span data-stu-id="6501d-194">If you are getting some data but not other.</span></span> <span data-ttu-id="6501d-195">這表示 hello 資料收集/傳輸管線已正確設定。</span><span class="sxs-lookup"><span data-stu-id="6501d-195">This means hello data collection / transfer pipeline is set correctly.</span></span> <span data-ttu-id="6501d-196">請遵循 hello 小節 toonarrow 下有什麼 hello 問題如下：</span><span class="sxs-lookup"><span data-stu-id="6501d-196">Follow hello subsections here toonarrow down what hello issue is:</span></span>
#### <a name="is-collection-configured"></a><span data-ttu-id="6501d-197">是否已設定集合：</span><span class="sxs-lookup"><span data-stu-id="6501d-197">Is Collection Configured:</span></span> 
<span data-ttu-id="6501d-198">診斷組態包含 hello 指示資料 toobe 收集特定類型的組件。</span><span class="sxs-lookup"><span data-stu-id="6501d-198">Diagnostics Configuration contains hello part that instructs for a particular type of data toobe collected.</span></span> <span data-ttu-id="6501d-199">[檢閱您的設定](#how-to-check-diagnostics-extension-configuration)toomake 確定不想要資料您未設定的集合。</span><span class="sxs-lookup"><span data-stu-id="6501d-199">[Review your configuration](#how-to-check-diagnostics-extension-configuration) toomake sure you are not looking for data you have not configured for collection.</span></span>
#### <a name="is-hello-host-generating-data"></a><span data-ttu-id="6501d-200">Hello 主機會將產生的資料：</span><span class="sxs-lookup"><span data-stu-id="6501d-200">Is hello host generating data:</span></span>
- <span data-ttu-id="6501d-201">**效能計數器**： 開啟 perfmon，然後檢查 hello 計數器。</span><span class="sxs-lookup"><span data-stu-id="6501d-201">**Performance Counters**: open perfmon and check hello counter.</span></span>
- <span data-ttu-id="6501d-202">**追蹤記錄檔**： 遠端桌面連接到 hello VM，並加入 TextWriterTraceListener toohello 應用程式的組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-202">**Trace Logs**:  Remote desktop into hello VM and add a TextWriterTraceListener toohello app’s config file.</span></span>  <span data-ttu-id="6501d-203">請參閱 http://msdn.microsoft.com/library/sk36c28t.aspx tooset 向上 hello 文字接聽程式。</span><span class="sxs-lookup"><span data-stu-id="6501d-203">See http://msdn.microsoft.com/library/sk36c28t.aspx tooset up hello text listener.</span></span>  <span data-ttu-id="6501d-204">請確定 hello`<trace>`項目具有`<trace autoflush="true">`。</span><span class="sxs-lookup"><span data-stu-id="6501d-204">Make sure hello `<trace>` element has `<trace autoflush="true">`.</span></span><br />
<span data-ttu-id="6501d-205">如果您沒有看到系統正在產生追蹤記錄檔，請依照[關於遺漏追蹤記錄檔的詳細資訊](#more-about-trace-logs-missing)中的說明進行作業。</span><span class="sxs-lookup"><span data-stu-id="6501d-205">If you don't see trace logs getting generated, follow [More About Trace Logs Missing](#more-about-trace-logs-missing).</span></span>
- <span data-ttu-id="6501d-206">**ETW 追蹤**： 遠端桌面連接到 hello VM 並安裝 PerfView。</span><span class="sxs-lookup"><span data-stu-id="6501d-206">**ETW traces**: Remote desktop into hello VM and install PerfView.</span></span>  <span data-ttu-id="6501d-207">在 PerfView 中執行 [File] \(檔案\) -> [User Command] \(使用者命令\) -> Listen etwprovder1,etwprovider2,etc。請注意，hello 接聽命令會區分大小寫 hello 以逗號分隔清單中的 ETW 提供者之間不能有空格。</span><span class="sxs-lookup"><span data-stu-id="6501d-207">In PerfView run File -> User Command -> Listen etwprovder1, etwprovider2, etc.  Note that hello Listen command is case-sensitive and there cannot be spaces between hello comma-separated list of ETW providers.</span></span>  <span data-ttu-id="6501d-208">Toorun hello 命令時，您可以按一下 hello 右下方的 hello Perfview 工具 toosee 嘗試的 toorun 和哪些 hello 結果中的 hello 'Log' 按鈕。</span><span class="sxs-lookup"><span data-stu-id="6501d-208">If hello command fails toorun, you can click hello 'Log' button in hello bottom-right of hello Perfview tool toosee what was attempted toorun and what hello result was.</span></span>  <span data-ttu-id="6501d-209">假設 hello 輸入正確接著在新視窗會顯示在幾秒鐘的時間和您將開始看到 ETW 追蹤。</span><span class="sxs-lookup"><span data-stu-id="6501d-209">Assuming hello input is correct then a new window will pop up and in a few seconds you will begin seeing ETW traces.</span></span>
- <span data-ttu-id="6501d-210">**事件記錄檔**： 遠端桌面連接到 hello VM。</span><span class="sxs-lookup"><span data-stu-id="6501d-210">**Event Logs**: Remote desktop into hello VM.</span></span> <span data-ttu-id="6501d-211">開啟`Event Viewer`，並確定 hello 的事件。</span><span class="sxs-lookup"><span data-stu-id="6501d-211">Open `Event Viewer` and ensure hello events exist.</span></span>
#### <a name="is-data-getting-captured-locally"></a><span data-ttu-id="6501d-212">是否正在本機擷取資料：</span><span class="sxs-lookup"><span data-stu-id="6501d-212">Is data getting captured locally:</span></span>
<span data-ttu-id="6501d-213">接下來請確定取得在本機擷取 hello 資料。</span><span class="sxs-lookup"><span data-stu-id="6501d-213">Next make sure hello data is getting captured locally.</span></span>
<span data-ttu-id="6501d-214">hello 資料會在本機儲存在`*.tsf`檔案[hello 診斷資料的本機存放區](#log-artifacts-path)。</span><span class="sxs-lookup"><span data-stu-id="6501d-214">hello data is locally stored in `*.tsf` files in [hello local store for diagnostics data](#log-artifacts-path).</span></span> <span data-ttu-id="6501d-215">不同的 `.tsf` 檔案會收集不同類型的記錄。</span><span class="sxs-lookup"><span data-stu-id="6501d-215">Different kinds of logs get collected in different `.tsf` files.</span></span> <span data-ttu-id="6501d-216">hello 名稱會位於 azure 儲存體中的類似 toohello 資料表名稱。</span><span class="sxs-lookup"><span data-stu-id="6501d-216">hello names are similar toohello table names in azure storage.</span></span> <span data-ttu-id="6501d-217">例如，`PerformanceCountersTable.tsf`中會收集 `Performance Counters`，`WindowsEventLogsTable.tsf` 中會收集事件記錄檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-217">For example `Performance Counters` get collected in `PerformanceCountersTable.tsf`, Event Logs get collected in `WindowsEventLogsTable.tsf`.</span></span> <span data-ttu-id="6501d-218">使用中的 hello 指示[本機記錄檔擷取](#local-log-extraction)區段 tooopen hello 選本機收集檔案，並確定您會看到它們在磁碟上開始收集。</span><span class="sxs-lookup"><span data-stu-id="6501d-218">Use hello instructions in [Local Log Extraction](#local-log-extraction) section tooopen hello local collection files and make sure you see them getting collected on disk.</span></span>

<span data-ttu-id="6501d-219">如果您不要參閱記錄檔以取得在本機收集，並已經有確認 hello 主機會將產生的資料之後，您可能需要在組態問題。</span><span class="sxs-lookup"><span data-stu-id="6501d-219">If you don't see logs getting collected locally and have already verified that hello host is generating data, you likely have a configuration issue.</span></span> <span data-ttu-id="6501d-220">檢閱您仔細的 hello 適當章節的組態。</span><span class="sxs-lookup"><span data-stu-id="6501d-220">Review your configuration carefully for hello appropriate section.</span></span> <span data-ttu-id="6501d-221">同時檢閱 hello 組態產生 MonitoringAgent [MaConfig.xml](#log-artifacts-path) ，並確定沒有描述 hello 相關的記錄檔來源，並不會遺失在 azure 診斷組態之間的轉譯區段和監視的代理程式設定。</span><span class="sxs-lookup"><span data-stu-id="6501d-221">Also review hello configuration generated for MonitoringAgent [MaConfig.xml](#log-artifacts-path) and make sure there is some section describing hello relevant log source and that it is not lost in translation between azure diagnostics configuration and monitoring agent configuration.</span></span>
#### <a name="is-data-getting-transferred"></a><span data-ttu-id="6501d-222">是否正在傳輸資料：</span><span class="sxs-lookup"><span data-stu-id="6501d-222">Is data getting transferred:</span></span>
<span data-ttu-id="6501d-223">如果您已確認取得在本機擷取 hello 資料，但您仍然看它在儲存體帳戶：</span><span class="sxs-lookup"><span data-stu-id="6501d-223">If you have verified hello data is getting captured locally but you still don't see it in your storage account:</span></span> 
- <span data-ttu-id="6501d-224">首先和最重要，請確定您已提供正確的儲存體帳戶，而且您有不回復透過指定儲存體帳戶金鑰 etc.for hello。</span><span class="sxs-lookup"><span data-stu-id="6501d-224">First and foremost, make sure that you have provided a correct storage account and that you have not rolled over keys etc.for hello given storage account.</span></span> <span data-ttu-id="6501d-225">針對雲端服務，我們發現使用者有時候並未更新他們的 `useDevelopmentStorage=true`。</span><span class="sxs-lookup"><span data-stu-id="6501d-225">For cloud services, sometimes we see that people don't update their `useDevelopmentStorage=true`.</span></span>
- <span data-ttu-id="6501d-226">如果提供的儲存體帳戶正確。</span><span class="sxs-lookup"><span data-stu-id="6501d-226">If provided storage account is correct.</span></span> <span data-ttu-id="6501d-227">請確定您沒有不允許 hello 元件 tooreach 公用儲存體端點一些網路限制。</span><span class="sxs-lookup"><span data-stu-id="6501d-227">Make sure you do not have some network restrictions that do not allow hello components tooreach public storage endpoints.</span></span> <span data-ttu-id="6501d-228">其中一種方式是 tooremote 桌面連入 hello 的 toodo 電腦並再試一次 toowrite 一些 toohello 相同的儲存體帳戶自己。</span><span class="sxs-lookup"><span data-stu-id="6501d-228">One way toodo that is tooremote desktop into hello machine and try toowrite something toohello same storage account yourself.</span></span>
- <span data-ttu-id="6501d-229">最後，您可以嘗試及查看監視代理程式報告了哪些失敗項目。</span><span class="sxs-lookup"><span data-stu-id="6501d-229">Finally, you can try and see what failure are being reported by Monitoring Agent.</span></span> <span data-ttu-id="6501d-230">監視代理程式會將其記錄檔`maeventtable.tsf`位於[hello 診斷資料的本機存放區](#log-artifacts-path)。</span><span class="sxs-lookup"><span data-stu-id="6501d-230">Monitoring agent writes its logs in `maeventtable.tsf` located in [hello local store for diagnostics data](#log-artifacts-path).</span></span> <span data-ttu-id="6501d-231">遵循指示[本機記錄檔擷取](#local-log-extraction)區段 tooopen 這個檔案，再找出是否有`errors`指出失敗 tooread 本機檔案或寫入 toostorage。</span><span class="sxs-lookup"><span data-stu-id="6501d-231">Follow instructions in [Local Log Extraction](#local-log-extraction) section tooopen this file and try and figure out if there are `errors` indicating failures tooread local files or write toostorage.</span></span>

### <a name="capturing--archiving-logs"></a><span data-ttu-id="6501d-232">擷取/封存記錄檔</span><span class="sxs-lookup"><span data-stu-id="6501d-232">Capturing / Archiving logs</span></span>
<span data-ttu-id="6501d-233">您瀏覽 hello 上述步驟，但是無法了解什麼錯誤而且思考連絡支援人員。</span><span class="sxs-lookup"><span data-stu-id="6501d-233">You went through hello above steps but could not figure out what was wrong and are thinking about contacting support.</span></span> <span data-ttu-id="6501d-234">hello 可能會要求您的第一件事是 toocollect 記錄檔從您的電腦。</span><span class="sxs-lookup"><span data-stu-id="6501d-234">hello first thing they might ask you is toocollect logs from your machine.</span></span> <span data-ttu-id="6501d-235">您可以先自行執行該作業以節省時間。</span><span class="sxs-lookup"><span data-stu-id="6501d-235">You can save time by doing that yourself.</span></span> <span data-ttu-id="6501d-236">執行 hello`CollectGuestLogs.exe`公用程式在[記錄集合公用程式路徑](#log-artifacts-path)hello 中產生的所有相關的 azure 記錄檔的 zip 檔案相同的資料夾。</span><span class="sxs-lookup"><span data-stu-id="6501d-236">Run hello `CollectGuestLogs.exe` utility at  [Log Collection Utility path](#log-artifacts-path) and it generates a zip file with all relevant azure logs in hello same folder.</span></span>

## <a name="diagnostics-data-tables-not-found"></a><span data-ttu-id="6501d-237">找不到診斷資料資料表</span><span class="sxs-lookup"><span data-stu-id="6501d-237">Diagnostics data Tables not found</span></span>
<span data-ttu-id="6501d-238">使用下列程式碼的 hello 來命名保存 ETW 事件的 Azure 儲存體中的 hello 資料表：</span><span class="sxs-lookup"><span data-stu-id="6501d-238">hello tables in Azure storage holding ETW events are named using hello following code:</span></span>

```C#
        if (String.IsNullOrEmpty(eventDestination)) {
            if (e == "DefaultEvents")
                tableName = "WADDefault" + MD5(provider);
            else
                tableName = "WADEvent" + MD5(provider) + eventId;
        }
        else
            tableName = "WAD" + eventDestination;
```

<span data-ttu-id="6501d-239">下列是一個範例：</span><span class="sxs-lookup"><span data-stu-id="6501d-239">Here is an example:</span></span>

```XML
        <EtwEventSourceProviderConfiguration provider="prov1">
          <Event id="1" />
          <Event id="2" eventDestination="dest1" />
          <DefaultEvents />
        </EtwEventSourceProviderConfiguration>
        <EtwEventSourceProviderConfiguration provider="prov2">
          <DefaultEvents eventDestination="dest2" />
        </EtwEventSourceProviderConfiguration>
```
```JSON
"EtwEventSourceProviderConfiguration": [
    {
        "provider": "prov1",
        "Event": [
            {
                "id": 1
            },
            {
                "id": 2,
                "eventDestination": "dest1"
            }
        ],
        "DefaultEvents": {
            "eventDestination": "DefaultEventDestination",
            "sinks": ""
        }
    },
    {
        "provider": "prov2",
        "DefaultEvents": {
            "eventDestination": "dest2"
        }
    }
]
```
<span data-ttu-id="6501d-240">產生的 4 個資料表如下︰</span><span class="sxs-lookup"><span data-stu-id="6501d-240">That generates 4 tables:</span></span>

| <span data-ttu-id="6501d-241">Event</span><span class="sxs-lookup"><span data-stu-id="6501d-241">Event</span></span> | <span data-ttu-id="6501d-242">資料表名稱</span><span class="sxs-lookup"><span data-stu-id="6501d-242">Table Name</span></span> |
| --- | --- |
| <span data-ttu-id="6501d-243">provider=”prov1” &lt;Event id=”1” /&gt;</span><span class="sxs-lookup"><span data-stu-id="6501d-243">provider=”prov1” &lt;Event id=”1” /&gt;</span></span> |<span data-ttu-id="6501d-244">WADEvent+MD5(“prov1”)+”1”</span><span class="sxs-lookup"><span data-stu-id="6501d-244">WADEvent+MD5(“prov1”)+”1”</span></span> |
| <span data-ttu-id="6501d-245">provider=”prov1” &lt;Event id=”2” eventDestination=”dest1” /&gt;</span><span class="sxs-lookup"><span data-stu-id="6501d-245">provider=”prov1” &lt;Event id=”2” eventDestination=”dest1” /&gt;</span></span> |<span data-ttu-id="6501d-246">WADdest1</span><span class="sxs-lookup"><span data-stu-id="6501d-246">WADdest1</span></span> |
| <span data-ttu-id="6501d-247">provider=”prov1” &lt;DefaultEvents /&gt;</span><span class="sxs-lookup"><span data-stu-id="6501d-247">provider=”prov1” &lt;DefaultEvents /&gt;</span></span> |<span data-ttu-id="6501d-248">WADDefault+MD5(“prov1”)</span><span class="sxs-lookup"><span data-stu-id="6501d-248">WADDefault+MD5(“prov1”)</span></span> |
| <span data-ttu-id="6501d-249">provider=”prov2” &lt;DefaultEvents eventDestination=”dest2” /&gt;</span><span class="sxs-lookup"><span data-stu-id="6501d-249">provider=”prov2” &lt;DefaultEvents eventDestination=”dest2” /&gt;</span></span> |<span data-ttu-id="6501d-250">WADdest2</span><span class="sxs-lookup"><span data-stu-id="6501d-250">WADdest2</span></span> |

## <a name="references"></a><span data-ttu-id="6501d-251">參考</span><span class="sxs-lookup"><span data-stu-id="6501d-251">References</span></span>

### <a name="how-toocheck-diagnostics-extension-configuration"></a><span data-ttu-id="6501d-252">如何 toocheck 診斷延伸模組組態</span><span class="sxs-lookup"><span data-stu-id="6501d-252">How toocheck Diagnostics Extension Configuration</span></span>
<span data-ttu-id="6501d-253">hello 最簡單的方式 toocheck 延伸模組組態是 toonavigate toohttp://resources.azure.com，巡覽 toohello 虛擬機器或雲端服務上的 hello Azure 診斷擴充功能 (IaaSDiagnostics / PaaDiagnostics) 是有問題。</span><span class="sxs-lookup"><span data-stu-id="6501d-253">hello easiest way toocheck your extension configuration is toonavigate toohttp://resources.azure.com, navigate toohello virtual machine or cloud service on which hello Azure Diagnostics extension (IaaSDiagnostics / PaaDiagnostics) is in question.</span></span>

<span data-ttu-id="6501d-254">或者，遠端桌面連接到 hello 電腦並查看 hello Azure 診斷組態檔一節所述 hello 適當[這裡](#log-artifacts-path)。</span><span class="sxs-lookup"><span data-stu-id="6501d-254">Alternatively, remote desktop into hello machine and look at hello Azure Diagnostics Configuration file described in hello appropriate section [here](#log-artifacts-path).</span></span>

<span data-ttu-id="6501d-255">在任一案例搜尋**Microsoft.Azure.Diagnostics**然後 hello **xmlCfg**或**WadCfg**欄位。</span><span class="sxs-lookup"><span data-stu-id="6501d-255">In either case search for **Microsoft.Azure.Diagnostics** then for hello **xmlCfg** or **WadCfg** field.</span></span> 

<span data-ttu-id="6501d-256">發生虛擬機器，如果 hello WadCfg 欄位已存在，表示已在 JSON 中的 hello 組態。</span><span class="sxs-lookup"><span data-stu-id="6501d-256">In case of virtual machines, if hello WadCfg field is present, it means hello config is in JSON.</span></span> <span data-ttu-id="6501d-257">如果 hello xmlCfg 欄位存在時，它表示 hello 組態是以 XML 格式，而且會 base64 編碼。</span><span class="sxs-lookup"><span data-stu-id="6501d-257">If hello xmlCfg field is present, it means hello config is in XML and is base64 encoded.</span></span> <span data-ttu-id="6501d-258">您需要[將它解碼](http://www.bing.com/search?q=base64+decoder)toosee hello 診斷所載入的 XML。</span><span class="sxs-lookup"><span data-stu-id="6501d-258">You need too[decode it](http://www.bing.com/search?q=base64+decoder) toosee hello XML that was loaded by Diagnostics.</span></span>

<span data-ttu-id="6501d-259">雲端服務角色，如果挑選 hello 組態從磁碟 hello 資料是 base64 編碼，因此您需要太[將它解碼](http://www.bing.com/search?q=base64+decoder)toosee hello 診斷所載入的 XML。</span><span class="sxs-lookup"><span data-stu-id="6501d-259">For Cloud Service role, if you pick hello configuration from disk, hello data is base64 encoded so you’ll need too[decode it](http://www.bing.com/search?q=base64+decoder) toosee hello XML that was loaded by Diagnostics.</span></span>

### <a name="azure-diagnostics-plugin-exit-codes"></a><span data-ttu-id="6501d-260">Azure 診斷外掛程式結束代碼</span><span class="sxs-lookup"><span data-stu-id="6501d-260">Azure Diagnostics Plugin Exit Codes</span></span>
<span data-ttu-id="6501d-261">hello 外掛程式傳回下列結束代碼的 hello:</span><span class="sxs-lookup"><span data-stu-id="6501d-261">hello plugin returns hello following exit codes:</span></span>

| <span data-ttu-id="6501d-262">結束代碼</span><span class="sxs-lookup"><span data-stu-id="6501d-262">Exit Code</span></span> | <span data-ttu-id="6501d-263">說明</span><span class="sxs-lookup"><span data-stu-id="6501d-263">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6501d-264">0</span><span class="sxs-lookup"><span data-stu-id="6501d-264">0</span></span> |<span data-ttu-id="6501d-265">成功。</span><span class="sxs-lookup"><span data-stu-id="6501d-265">Success.</span></span> |
| <span data-ttu-id="6501d-266">-1</span><span class="sxs-lookup"><span data-stu-id="6501d-266">-1</span></span> |<span data-ttu-id="6501d-267">一般錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-267">Generic Error.</span></span> |
| <span data-ttu-id="6501d-268">-2</span><span class="sxs-lookup"><span data-stu-id="6501d-268">-2</span></span> |<span data-ttu-id="6501d-269">無法 tooload hello rcf 檔案。</span><span class="sxs-lookup"><span data-stu-id="6501d-269">Unable tooload hello rcf file.</span></span><p><span data-ttu-id="6501d-270">Hello 客體代理程式外掛程式啟動器手動叫用，不正確，hello VM 時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-270">This internal error should only happen if hello guest agent plugin launcher is manually invoked, incorrectly, on hello VM.</span></span> |
| <span data-ttu-id="6501d-271">-3</span><span class="sxs-lookup"><span data-stu-id="6501d-271">-3</span></span> |<span data-ttu-id="6501d-272">無法載入 hello 診斷組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-272">Cannot load hello Diagnostics configuration file.</span></span><p><p><span data-ttu-id="6501d-273">解決方法：因組態檔未通過結構描述驗證而造成。</span><span class="sxs-lookup"><span data-stu-id="6501d-273">Solution: Caused by a configuration file not passing schema validation.</span></span> <span data-ttu-id="6501d-274">hello 解決方案是 tooprovide 符合 hello 結構描述的組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-274">hello solution is tooprovide a configuration file that complies with hello schema.</span></span> |
| <span data-ttu-id="6501d-275">-4</span><span class="sxs-lookup"><span data-stu-id="6501d-275">-4</span></span> |<span data-ttu-id="6501d-276">監視代理程式診斷的 hello 的另一個執行個體已在使用 hello 本機資源目錄。</span><span class="sxs-lookup"><span data-stu-id="6501d-276">Another instance of hello monitoring agent Diagnostics is already using hello local resource directory.</span></span><p><p><span data-ttu-id="6501d-277">解決方法：為 **LocalResourceDirectory** 指定其他值。</span><span class="sxs-lookup"><span data-stu-id="6501d-277">Solution: Specify a different value for **LocalResourceDirectory**.</span></span> |
| <span data-ttu-id="6501d-278">-6</span><span class="sxs-lookup"><span data-stu-id="6501d-278">-6</span></span> |<span data-ttu-id="6501d-279">hello 客體代理程式外掛程式啟動器嘗試以無效的命令列 toolaunch 診斷。</span><span class="sxs-lookup"><span data-stu-id="6501d-279">hello guest agent plugin launcher attempted toolaunch Diagnostics with an invalid command line.</span></span><p><p><span data-ttu-id="6501d-280">Hello 客體代理程式外掛程式啟動器手動叫用，不正確，hello VM 時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-280">This internal error should only happen if hello guest agent plugin launcher is manually invoked, incorrectly, on hello VM.</span></span> |
| <span data-ttu-id="6501d-281">-10</span><span class="sxs-lookup"><span data-stu-id="6501d-281">-10</span></span> |<span data-ttu-id="6501d-282">hello 診斷外掛程式會結束並發生未處理的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="6501d-282">hello Diagnostics plugin exited with an unhandled exception.</span></span> |
| <span data-ttu-id="6501d-283">-11</span><span class="sxs-lookup"><span data-stu-id="6501d-283">-11</span></span> |<span data-ttu-id="6501d-284">hello 客體代理程式已無法 toocreate hello 程序負責啟動及監視 hello 監視代理程式。</span><span class="sxs-lookup"><span data-stu-id="6501d-284">hello guest agent was unable toocreate hello process responsible for launching and monitoring hello monitoring agent.</span></span><p><p><span data-ttu-id="6501d-285">解決方案： 確認系統資源不足，無法使用 toolaunch 新處理序。</span><span class="sxs-lookup"><span data-stu-id="6501d-285">Solution: Verify that sufficient system resources are available toolaunch new processes.</span></span><p> |
| <span data-ttu-id="6501d-286">-101</span><span class="sxs-lookup"><span data-stu-id="6501d-286">-101</span></span> |<span data-ttu-id="6501d-287">無效的引數呼叫 hello 診斷外掛程式時。</span><span class="sxs-lookup"><span data-stu-id="6501d-287">Invalid arguments when calling hello Diagnostics plugin.</span></span><p><p><span data-ttu-id="6501d-288">Hello 客體代理程式外掛程式啟動器手動叫用，不正確，hello VM 時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-288">This internal error should only happen if hello guest agent plugin launcher is manually invoked, incorrectly, on hello VM.</span></span> |
| <span data-ttu-id="6501d-289">-102</span><span class="sxs-lookup"><span data-stu-id="6501d-289">-102</span></span> |<span data-ttu-id="6501d-290">hello 外掛程式程序是無法 tooinitialize 本身。</span><span class="sxs-lookup"><span data-stu-id="6501d-290">hello plugin process is unable tooinitialize itself.</span></span><p><p><span data-ttu-id="6501d-291">解決方案： 確認系統資源不足，無法使用 toolaunch 新處理序。</span><span class="sxs-lookup"><span data-stu-id="6501d-291">Solution: Verify that sufficient system resources are available toolaunch new processes.</span></span> |
| <span data-ttu-id="6501d-292">-103</span><span class="sxs-lookup"><span data-stu-id="6501d-292">-103</span></span> |<span data-ttu-id="6501d-293">hello 外掛程式程序是無法 tooinitialize 本身。</span><span class="sxs-lookup"><span data-stu-id="6501d-293">hello plugin process is unable tooinitialize itself.</span></span> <span data-ttu-id="6501d-294">尤其，它是無法 toocreate hello 記錄器物件。</span><span class="sxs-lookup"><span data-stu-id="6501d-294">Specifically it is unable toocreate hello logger object.</span></span><p><p><span data-ttu-id="6501d-295">解決方案： 確認系統資源不足，無法使用 toolaunch 新處理序。</span><span class="sxs-lookup"><span data-stu-id="6501d-295">Solution: Verify that sufficient system resources are available toolaunch new processes.</span></span> |
| <span data-ttu-id="6501d-296">-104</span><span class="sxs-lookup"><span data-stu-id="6501d-296">-104</span></span> |<span data-ttu-id="6501d-297">提供的 hello 客體代理程式無法 tooload hello rcf 檔案。</span><span class="sxs-lookup"><span data-stu-id="6501d-297">Unable tooload hello rcf file provided by hello guest agent.</span></span><p><p><span data-ttu-id="6501d-298">Hello 客體代理程式外掛程式啟動器手動叫用，不正確，hello VM 時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-298">This internal error should only happen if hello guest agent plugin launcher is manually invoked, incorrectly, on hello VM.</span></span> |
| <span data-ttu-id="6501d-299">-105</span><span class="sxs-lookup"><span data-stu-id="6501d-299">-105</span></span> |<span data-ttu-id="6501d-300">hello 診斷外掛程式無法開啟 hello 診斷組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-300">hello Diagnostics plugin cannot open hello Diagnostics configuration file.</span></span><p><p><span data-ttu-id="6501d-301">Hello 診斷外掛程式手動叫用，不正確，hello VM 時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-301">This internal error should only happen if hello Diagnostics plugin is manually invoked, incorrectly, on hello VM.</span></span> |
| <span data-ttu-id="6501d-302">-106</span><span class="sxs-lookup"><span data-stu-id="6501d-302">-106</span></span> |<span data-ttu-id="6501d-303">無法讀取 hello 診斷組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-303">Cannot read hello Diagnostics configuration file.</span></span><p><p><span data-ttu-id="6501d-304">解決方法：因組態檔未通過結構描述驗證而造成。</span><span class="sxs-lookup"><span data-stu-id="6501d-304">Solution: Caused by a configuration file not passing schema validation.</span></span> <span data-ttu-id="6501d-305">Hello 方案是 tooprovide 符合 hello 結構描述的組態檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-305">So hello solution is tooprovide a configuration file that complies with hello schema.</span></span> <span data-ttu-id="6501d-306">請參閱[如何 toocheck 診斷延伸模組組態](#how-to-check-diagnostics-extension-configuration)。</span><span class="sxs-lookup"><span data-stu-id="6501d-306">See [How toocheck Diagnostics Extension Configuration](#how-to-check-diagnostics-extension-configuration).</span></span> |
| <span data-ttu-id="6501d-307">-107</span><span class="sxs-lookup"><span data-stu-id="6501d-307">-107</span></span> |<span data-ttu-id="6501d-308">監視代理程式的 hello 資源目錄傳遞 toohello 無效。</span><span class="sxs-lookup"><span data-stu-id="6501d-308">hello resource directory pass toohello monitoring agent is invalid.</span></span><p><p><span data-ttu-id="6501d-309">如果 hello 監視代理程式手動叫用時，不正確，hello VM 上，應該只會發生此內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-309">This internal error should only happen if hello monitoring agent is manually invoked, incorrectly, on hello VM.</span></span></p> |
| <span data-ttu-id="6501d-310">-108</span><span class="sxs-lookup"><span data-stu-id="6501d-310">-108</span></span> |<span data-ttu-id="6501d-311">無法 tooconvert hello 診斷組態檔至 hello 監視代理程式設定檔。</span><span class="sxs-lookup"><span data-stu-id="6501d-311">Unable tooconvert hello Diagnostics configuration file into hello monitoring agent configuration file.</span></span><p><p><span data-ttu-id="6501d-312">Hello 診斷外掛程式會使用無效的組態檔手動叫用時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-312">This internal error should only happen if hello Diagnostics plugin is manually invoked with an invalid configuration file.</span></span> |
| <span data-ttu-id="6501d-313">-110</span><span class="sxs-lookup"><span data-stu-id="6501d-313">-110</span></span> |<span data-ttu-id="6501d-314">一般診斷組態錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-314">General Diagnostics configuration error.</span></span><p><p><span data-ttu-id="6501d-315">Hello 診斷外掛程式會使用無效的組態檔手動叫用時，應該才會發生這個內部錯誤。</span><span class="sxs-lookup"><span data-stu-id="6501d-315">This internal error should only happen if hello Diagnostics plugin is manually invoked with an invalid configuration file.</span></span> |
| <span data-ttu-id="6501d-316">-111</span><span class="sxs-lookup"><span data-stu-id="6501d-316">-111</span></span> |<span data-ttu-id="6501d-317">無法 toostart hello 監視代理程式。</span><span class="sxs-lookup"><span data-stu-id="6501d-317">Unable toostart hello monitoring agent.</span></span><p><p><span data-ttu-id="6501d-318">解決方法：確認有足夠的系統資源可用。</span><span class="sxs-lookup"><span data-stu-id="6501d-318">Solution: Verify that sufficient system resources are available.</span></span> |
| <span data-ttu-id="6501d-319">-112</span><span class="sxs-lookup"><span data-stu-id="6501d-319">-112</span></span> |<span data-ttu-id="6501d-320">一般錯誤</span><span class="sxs-lookup"><span data-stu-id="6501d-320">General error</span></span> |

### <a name="local-log-extraction"></a><span data-ttu-id="6501d-321">本機記錄檔擷取</span><span class="sxs-lookup"><span data-stu-id="6501d-321">Local Log Extraction</span></span>
<span data-ttu-id="6501d-322">hello 監視代理程式收集記錄檔和成品為`.tsf`檔案。</span><span class="sxs-lookup"><span data-stu-id="6501d-322">hello monitoring agent collects logs and artifacts as `.tsf` files.</span></span> <span data-ttu-id="6501d-323">您無法讀取 `.tsf` 檔案，但可以將它轉換成 `.csv`，如下所示：</span><span class="sxs-lookup"><span data-stu-id="6501d-323">`.tsf` file is not readable but you can convert it into a `.csv` as follows:</span></span> 

```
<Azure diagnostics extension package>\Monitor\x64\table2csv.exe <relevantLogFile>.tsf
```
<span data-ttu-id="6501d-324">新的檔案稱為`<relevantLogFile>.csv`中就會建立 hello 相同路徑做為對應 hello`.tsf`檔案。</span><span class="sxs-lookup"><span data-stu-id="6501d-324">A new file called `<relevantLogFile>.csv` will be created in hello same path as hello corresponding `.tsf` file.</span></span>

<span data-ttu-id="6501d-325">**請注意**： 您只需要 toorun hello 主要 tsf 檔案 (例如 PerformanceCountersTable.tsf) 針對此公用程式。</span><span class="sxs-lookup"><span data-stu-id="6501d-325">**NOTE**: You only need toorun this utility against hello main tsf file (e.g., PerformanceCountersTable.tsf).</span></span> <span data-ttu-id="6501d-326">hello 隨附的檔案 (例如 PerformanceCountersTables_\*\*001.tsf，PerformanceCountersTables_\*\*002.tsf 等) 會自動處理。</span><span class="sxs-lookup"><span data-stu-id="6501d-326">hello accompanying files (e.g., PerformanceCountersTables_\*\*001.tsf, PerformanceCountersTables_\*\*002.tsf etc.) will automatically be processed.</span></span>

### <a name="more-about-trace-logs-missing"></a><span data-ttu-id="6501d-327">關於遺漏追蹤記錄檔的詳細資訊</span><span class="sxs-lookup"><span data-stu-id="6501d-327">More About Trace Logs Missing</span></span>

<span data-ttu-id="6501d-328">**注意：**這大部分也適用於 toocloud 服務只除非您已設定 hello DiagnosticsMonitorTraceListener IaaS VM 上執行的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6501d-328">**Note:** This mostly applies toocloud services only unless you have configured hello DiagnosticsMonitorTraceListener on an application running on your IaaS VM.</span></span> 

- <span data-ttu-id="6501d-329">請確定已設定 DiagnosticMonitorTraceListener hello web.config 或 app.config 中的 hello。這在雲端服務專案中，預設設定，但有些客戶註解它不足導致 hello 追蹤陳述式 toonot 收集的診斷。</span><span class="sxs-lookup"><span data-stu-id="6501d-329">Make sure hello DiagnosticMonitorTraceListener is configured in hello web.config or app.config.  This is configured by default in cloud service projects, but some customers comment it out which will cause hello trace statements toonot be collected by diagnostics.</span></span> 
- <span data-ttu-id="6501d-330">如果記錄檔不會從 hello OnStart] 或 [執行方法來取得寫入請確定 hello DiagnosticMonitorTraceListener 處於 hello app.config。根據預設，它會在 hello web.config 中，但僅適用於的 toocode w3wp.exe; 內執行因此您必須在 app.config toocapture 追蹤 WaIISHost.exe 中執行。</span><span class="sxs-lookup"><span data-stu-id="6501d-330">If logs are not getting written from hello OnStart or Run method make sure hello DiagnosticMonitorTraceListener is in hello app.config.  By default it is in hello web.config, but that only applies toocode running within w3wp.exe; so you need it in app.config toocapture traces running in WaIISHost.exe.</span></span>
- <span data-ttu-id="6501d-331">請確定您使用的是 Diagnostics.Trace.TraceXXX，而不是 Diagnostics.Debug.WriteXXX。</span><span class="sxs-lookup"><span data-stu-id="6501d-331">Make sure you are using Diagnostics.Trace.TraceXXX instead of Diagnostics.Debug.WriteXXX.</span></span>  <span data-ttu-id="6501d-332">hello 偵錯陳述式將會移除從發行的組建。</span><span class="sxs-lookup"><span data-stu-id="6501d-332">hello Debug statements will be removed from a Release build.</span></span>
- <span data-ttu-id="6501d-333">請確定 hello 編譯程式碼確實具有 hello Diagnostics.Trace 行 （使用 Reflector、 ildasm 或 ILSpy tooverify）。</span><span class="sxs-lookup"><span data-stu-id="6501d-333">Make sure hello compiled code actually has hello Diagnostics.Trace lines (use Reflector, ildasm or ILSpy tooverify).</span></span>  <span data-ttu-id="6501d-334">Diagnostics.Trace 命令會從 hello 編譯二進位檔中移除，除非您使用 hello 追蹤條件式編譯符號。</span><span class="sxs-lookup"><span data-stu-id="6501d-334">Diagnostics.Trace commands are removed from hello compiled binary unless you use hello TRACE conditional compilation symbol.</span></span>  <span data-ttu-id="6501d-335">如果使用 msbuild toobuild hello 專案這是常見的問題 toorun 到。</span><span class="sxs-lookup"><span data-stu-id="6501d-335">If using msbuild toobuild hello project then this is a common problem toorun into.</span></span>

## <a name="known-issues-and-mitigations"></a><span data-ttu-id="6501d-336">已知問題與緩解方式</span><span class="sxs-lookup"><span data-stu-id="6501d-336">Known Issues and Mitigations</span></span>
<span data-ttu-id="6501d-337">以下是已知問題和緩解方式的清單：</span><span class="sxs-lookup"><span data-stu-id="6501d-337">Here is a list of known issues with known mitigations:</span></span>

<span data-ttu-id="6501d-338">**1. .NET 4.5 相依性：**</span><span class="sxs-lookup"><span data-stu-id="6501d-338">**1. .NET 4.5 dependency:**</span></span>

<span data-ttu-id="6501d-339">WAD 在 .NET 4.5 Framework 或更新版本上具有執行階段相依性。</span><span class="sxs-lookup"><span data-stu-id="6501d-339">WAD has a runtime dependency on .NET 4.5 framework or above.</span></span> <span data-ttu-id="6501d-340">在撰寫這個 hello 時，佈建雲端服務，以及所有官方 azure 虛擬機器基底映像的所有機器具有.NET 4.5 或上面已安裝。</span><span class="sxs-lookup"><span data-stu-id="6501d-340">At hello time of writing this, all machines provisioned for cloud services as well as all official azure Virtual Machine base images have .NET 4.5 or above installed.</span></span> <span data-ttu-id="6501d-341">不過仍可能 tooland 您試著 toorun WAD 在的電腦不需要.NET 4.5 或更新版本的情況下它。</span><span class="sxs-lookup"><span data-stu-id="6501d-341">It is still however possible tooland in a situation where you try toorun WAD on a machine which does not have .NET 4.5 or above.</span></span> <span data-ttu-id="6501d-342">當您從舊映像或快照集建立電腦，或攜帶自己的自訂磁碟時，就可能會發生這個問題。</span><span class="sxs-lookup"><span data-stu-id="6501d-342">This happens when you create your machine off of an old image or snapshot; or bring your own custom disk.</span></span>

<span data-ttu-id="6501d-343">執行 DiagnosticsPluginLauncher.exe 時，這通常會以結束代碼 **255** 來表示。</span><span class="sxs-lookup"><span data-stu-id="6501d-343">This generally manifests as an exit code **255** when running DiagnosticsPluginLauncher.exe.</span></span> <span data-ttu-id="6501d-344">失敗發生因為 toohello 未處理的例外狀況：</span><span class="sxs-lookup"><span data-stu-id="6501d-344">Failure happens due toohello unhandled exception:</span></span> 
```
System.IO.FileLoadException: Could not load file or assembly 'System.Threading.Tasks, Version=1.5.11.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies
```

<span data-ttu-id="6501d-345">**緩解方式：**在電腦上安裝 .NET 4.5 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="6501d-345">**Mitigation:** Install .NET 4.5 or higher on your machine.</span></span>

<span data-ttu-id="6501d-346">**2.儲存體中有效能計數器資料，但入口網站中沒有顯示**</span><span class="sxs-lookup"><span data-stu-id="6501d-346">**2. Performance Counters data available in storage but not showing in portal**</span></span>

<span data-ttu-id="6501d-347">虛擬機器入口網站體驗預設會顯示特定效能計數器。</span><span class="sxs-lookup"><span data-stu-id="6501d-347">Virtual machines portal experience shows certain performance counters by default.</span></span> <span data-ttu-id="6501d-348">如果您沒有看到它們，而且您知道會取得產生 hello 資料，因為它是用於儲存體。</span><span class="sxs-lookup"><span data-stu-id="6501d-348">If you don't see them and you know hello data is getting generated because it is available in storage.</span></span> <span data-ttu-id="6501d-349">勾選：</span><span class="sxs-lookup"><span data-stu-id="6501d-349">Check:</span></span>
- <span data-ttu-id="6501d-350">如果儲存體中的 hello 資料以英文計數器名稱。</span><span class="sxs-lookup"><span data-stu-id="6501d-350">If hello data in storage has counter names in English.</span></span> <span data-ttu-id="6501d-351">如果 hello 計數器名稱不是英文，入口網站的度量圖表將不會無法 toorecognize 它。</span><span class="sxs-lookup"><span data-stu-id="6501d-351">If hello counter names are not in English, portal metric chart will not be able toorecognize it.</span></span>
- <span data-ttu-id="6501d-352">如果您使用萬用字元 (\*) 在您的效能計數器的名稱，hello 入口網站將無法能 toocorrelate hello 設定和收集計數器。</span><span class="sxs-lookup"><span data-stu-id="6501d-352">If you are using wild cards (\*) in your performance counter names, hello portal will not be able toocorrelate hello configured and collected counter.</span></span>

<span data-ttu-id="6501d-353">**風險降低**： 變更 hello 機器語言 tooEnglish 系統帳戶。</span><span class="sxs-lookup"><span data-stu-id="6501d-353">**Mitigation**: Change hello machine's language tooEnglish for system accounts.</span></span> <span data-ttu-id="6501d-354">控制台-> 地區-> 系統管理-> 複製設定-> 取消選取 「 歡迎畫面和系統帳戶 」，以便 hello 自訂語言不會套用 toosystem 帳戶。</span><span class="sxs-lookup"><span data-stu-id="6501d-354">Control Panel -> Region -> Administrative -> Copy Settings -> uncheck "Welcome screen and system accounts" so that hello custom language is not applied toosystem account.</span></span> <span data-ttu-id="6501d-355">也請確定您是否入口 toobe 您主要的耗用量的經驗不使用萬用字元。</span><span class="sxs-lookup"><span data-stu-id="6501d-355">Also make sure you do not use wild cards if you want portal toobe your primary consumption experience.</span></span>
