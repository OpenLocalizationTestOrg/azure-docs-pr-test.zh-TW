---
title: "hello Azure 活動記錄檔的 aaaOverview |Microsoft 文件"
description: "瞭解什麼是 Azure 活動記錄檔的 hello，以及如何使用它 toounderstand 您 Azure 訂用帳戶內發生的事件。"
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: c274782f-039d-4c28-9ddb-f89ce21052c7
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/02/2017
ms.author: johnkem
ms.openlocfilehash: cba79b7f6dc0833ef588382e763761fd77d43307
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-subscription-activity-with-hello-azure-activity-log"></a><span data-ttu-id="33472-103">監視訂閱活動與 hello Azure 活動記錄檔</span><span class="sxs-lookup"><span data-stu-id="33472-103">Monitor Subscription Activity with hello Azure Activity Log</span></span>
<span data-ttu-id="33472-104">hello **Azure 活動記錄檔**是提供深入了解發生在 Azure 中的訂用帳戶層級事件的訂閱記錄。</span><span class="sxs-lookup"><span data-stu-id="33472-104">hello **Azure Activity Log** is a subscription log that provides insight into subscription-level events that have occurred in Azure.</span></span> <span data-ttu-id="33472-105">這包括資料，從 Azure 資源管理員服務健全狀況事件的操作資料 tooupdates 的範圍。</span><span class="sxs-lookup"><span data-stu-id="33472-105">This includes a range of data, from Azure Resource Manager operational data tooupdates on Service Health events.</span></span> <span data-ttu-id="33472-106">hello 活動記錄檔先前稱為 「 稽核記錄檔 」 或 「 操作記錄檔 」，因為 hello 系統管理類別目錄報表訂用帳戶的控制平面事件。</span><span class="sxs-lookup"><span data-stu-id="33472-106">hello Activity Log was previously known as “Audit Logs” or “Operational Logs,” since hello Administrative category reports control-plane events for your subscriptions.</span></span> <span data-ttu-id="33472-107">使用 hello 活動記錄檔，您可以決定 hello '功能，對象、 及何時' 的任何寫入作業 (PUT、 POST、 DELETE) 在您的訂用帳戶中的 hello 資源。</span><span class="sxs-lookup"><span data-stu-id="33472-107">Using hello Activity Log, you can determine hello ‘what, who, and when’ for any write operations (PUT, POST, DELETE) taken on hello resources in your subscription.</span></span> <span data-ttu-id="33472-108">您也可以了解 hello 狀態 hello 作業以及其他相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="33472-108">You can also understand hello status of hello operation and other relevant properties.</span></span> <span data-ttu-id="33472-109">hello 活動記錄檔不包括讀取 (GET) 作業或使用 hello 傳統資源的作業 /"RDFE 」 模型。</span><span class="sxs-lookup"><span data-stu-id="33472-109">hello Activity Log does not include read (GET) operations or operations for resources that use hello Classic/"RDFE" model.</span></span>

![<span data-ttu-id="33472-110">活動記錄與其他類型的記錄</span><span class="sxs-lookup"><span data-stu-id="33472-110">Activity Logs vs other types of logs</span></span> ](./media/monitoring-overview-activity-logs/Activity_Log_vs_other_logs_v5.png)

<span data-ttu-id="33472-111">圖 1：活動記錄與其他類型的記錄</span><span class="sxs-lookup"><span data-stu-id="33472-111">Figure 1: Activity Logs vs other types of logs</span></span>

<span data-ttu-id="33472-112">hello 活動記錄檔不同於[診斷記錄檔](monitoring-overview-of-diagnostic-logs.md)。</span><span class="sxs-lookup"><span data-stu-id="33472-112">hello Activity Log differs from [Diagnostic Logs](monitoring-overview-of-diagnostic-logs.md).</span></span> <span data-ttu-id="33472-113">活動記錄檔提供 hello hello 之外 (hello"控制項的平面 」) 中的資源作業的相關資料。</span><span class="sxs-lookup"><span data-stu-id="33472-113">Activity Logs provide data about hello operations on a resource from hello outside (hello "control plane").</span></span> <span data-ttu-id="33472-114">診斷記錄檔所發出的資源，並提供該資源 (hello 」 資料平面 」) 的 hello 作業的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="33472-114">Diagnostics Logs are emitted by a resource and provide information about hello operation of that resource (hello "data plane").</span></span>

<span data-ttu-id="33472-115">您可以從您使用 hello Azure 入口網站，CLI、 PowerShell 指令程式的活動記錄檔擷取的事件和 Azure 監視 REST API。</span><span class="sxs-lookup"><span data-stu-id="33472-115">You can retrieve events from your Activity Log using hello Azure portal, CLI, PowerShell cmdlets, and Azure Monitor REST API.</span></span>


> [!WARNING]
> <span data-ttu-id="33472-116">hello Azure 活動記錄檔是主要發生之活動的 Azure 資源管理員中。</span><span class="sxs-lookup"><span data-stu-id="33472-116">hello Azure Activity Log is primarily for activities that occur in Azure Resource Manager.</span></span> <span data-ttu-id="33472-117">它不會追蹤資源使用 hello 傳統/RDFE 模型。</span><span class="sxs-lookup"><span data-stu-id="33472-117">It does not track resources using hello Classic/RDFE model.</span></span> <span data-ttu-id="33472-118">某些傳統資源類型在 Azure Resource Manager 中有 Proxy 資源提供者 (例如，Microsoft.ClassicCompute)。</span><span class="sxs-lookup"><span data-stu-id="33472-118">Some Classic resource types have a proxy resource provider in Azure Resource Manager (for example, Microsoft.ClassicCompute).</span></span> <span data-ttu-id="33472-119">如果您使用傳統資源類型透過 Azure 資源管理員使用這些 proxy 資源提供者互動時，請 hello 作業就會出現在 hello 活動記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="33472-119">If you interact with a Classic resource type through Azure Resource Manager using these proxy resource providers, hello operations appear in hello Activity Log.</span></span> <span data-ttu-id="33472-120">如果您互動傳統資源輸入 hello 傳統入口網站或否則之外 hello Azure 資源管理員的 proxy，您的動作只能記錄 hello 作業記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="33472-120">If you interact with a Classic resource type in hello Classic portal or otherwise outside of hello Azure Resource Manager proxies, your actions are only recorded in hello Operation Log.</span></span> <span data-ttu-id="33472-121">只有在 hello 傳統入口網站存取 hello 作業記錄檔。</span><span class="sxs-lookup"><span data-stu-id="33472-121">hello Operation Log is accessible only in hello Classic portal.</span></span>
>
>

<span data-ttu-id="33472-122">下列影片介紹 hello 活動記錄檔檢視 hello。</span><span class="sxs-lookup"><span data-stu-id="33472-122">View hello following video introducing hello Activity Log.</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Seth-Juarez/Logs-John-Kemnetz/player]
> 
>

## <a name="categories-in-hello-activity-log"></a><span data-ttu-id="33472-123">Hello 活動記錄檔中的類別</span><span class="sxs-lookup"><span data-stu-id="33472-123">Categories in hello Activity Log</span></span>
<span data-ttu-id="33472-124">hello 活動記錄檔包含數個分類的資料。</span><span class="sxs-lookup"><span data-stu-id="33472-124">hello Activity Log contains several categories of data.</span></span> <span data-ttu-id="33472-125">如需 hello 結構描述，這些類別目錄的完整細節[請參閱本文章](monitoring-activity-log-schema.md)。</span><span class="sxs-lookup"><span data-stu-id="33472-125">For full details on hello schemata of these categories, [see this article](monitoring-activity-log-schema.md).</span></span> <span data-ttu-id="33472-126">其中包含：</span><span class="sxs-lookup"><span data-stu-id="33472-126">These include:</span></span>
* <span data-ttu-id="33472-127">**系統管理**-這個類別所包含的所有 hello 記錄建立、 更新、 刪除和動作的作業執行透過資源管理員。</span><span class="sxs-lookup"><span data-stu-id="33472-127">**Administrative** - This category contains hello record of all create, update, delete, and action operations performed through Resource Manager.</span></span> <span data-ttu-id="33472-128">Hello 類型的事件，您會看到此類別中包含的範例 「 建立虛擬機器 」 和 「 刪除網路安全性群組 」 每個使用者所採取的動作，或使用資源管理員的應用程式會模型化為特定資源類型上的作業。</span><span class="sxs-lookup"><span data-stu-id="33472-128">Examples of hello types of events you would see in this category include "create virtual machine" and "delete network security group" Every action taken by a user or application using Resource Manager is modeled as an operation on a particular resource type.</span></span> <span data-ttu-id="33472-129">如果 hello 作業類型是寫入刪除或動作，hello 記錄 hello 開始和成功或失敗的作業都會記錄在 hello 系統管理類別。</span><span class="sxs-lookup"><span data-stu-id="33472-129">If hello operation type is Write, Delete, or Action, hello records of both hello start and success or fail of that operation are recorded in hello Administrative category.</span></span> <span data-ttu-id="33472-130">hello 系統管理類別也會包含在訂閱中的任何變更 toorole 型存取控制。</span><span class="sxs-lookup"><span data-stu-id="33472-130">hello Administrative category also includes any changes toorole-based access control in a subscription.</span></span>
* <span data-ttu-id="33472-131">**服務健全狀況**-這個類別所包含的任何服務健全狀況事件發生在 Azure 中的 hello 記錄。</span><span class="sxs-lookup"><span data-stu-id="33472-131">**Service Health** - This category contains hello record of any service health incidents that have occurred in Azure.</span></span> <span data-ttu-id="33472-132">舉例來說，hello 您將會看到此類別中類型是事件的"SQL Azure，在美國東部發生停機。 」</span><span class="sxs-lookup"><span data-stu-id="33472-132">An example of hello type of event you would see in this category is "SQL Azure in East US is experiencing downtime."</span></span> <span data-ttu-id="33472-133">服務健全狀況事件有五種： 所需的動作、 協助復原、 事件、 維護、 資訊或安全性，和，才會出現您擁有 hello 訂用帳戶會受到 hello 事件中的資源。</span><span class="sxs-lookup"><span data-stu-id="33472-133">Service health events come in five varieties: Action Required, Assisted Recovery, Incident, Maintenance, Information, or Security, and only appear if you have a resource in hello subscription that would be impacted by hello event.</span></span>
* <span data-ttu-id="33472-134">**警示**-這個類別所包含的所有啟用的 Azure 警示 hello 記錄。</span><span class="sxs-lookup"><span data-stu-id="33472-134">**Alert** - This category contains hello record of all activations of Azure alerts.</span></span> <span data-ttu-id="33472-135">Hello 您將會看到此類別中類型的範例是事件的"myVM 上的 CPU 百分比已超過 80 hello 過去 5 分鐘。 」</span><span class="sxs-lookup"><span data-stu-id="33472-135">An example of hello type of event you would see in this category is "CPU % on myVM has been over 80 for hello past 5 minutes."</span></span> <span data-ttu-id="33472-136">各種 Azure 系統都有警示概念，您可以定義某種類型的規則，並在條件符合該規則時接收通知。</span><span class="sxs-lookup"><span data-stu-id="33472-136">A variety of Azure systems have an alerting concept -- you can define a rule of some sort and receive a notification when conditions match that rule.</span></span> <span data-ttu-id="33472-137">每次支援 Azure 的警示類型 '啟動，' 或 hello 條件都符合的 toogenerate 通知，hello 啟用的記錄也會推入 toothis 類別目錄的 hello 活動記錄檔。</span><span class="sxs-lookup"><span data-stu-id="33472-137">Each time a supported Azure alert type 'activates,' or hello conditions are met toogenerate a notification, a record of hello activation is also pushed toothis category of hello Activity Log.</span></span>
* <span data-ttu-id="33472-138">**自動調整規模**-這個類別所包含 hello 作業的記錄任何事件相關的 toohello hello 自動調整引擎根據您定義您的訂用帳戶中的任何自動調整規模設定。</span><span class="sxs-lookup"><span data-stu-id="33472-138">**Autoscale** - This category contains hello record of any events related toohello operation of hello autoscale engine based on any autoscale settings you have defined in your subscription.</span></span> <span data-ttu-id="33472-139">Hello 您將會看到此類別中類型的範例是事件的 「 自動調整規模小數位數設定動作失敗。 」</span><span class="sxs-lookup"><span data-stu-id="33472-139">An example of hello type of event you would see in this category is "Autoscale scale up action failed."</span></span> <span data-ttu-id="33472-140">使用自動調整規模，您可以自動向外擴充或調整在 hello 中支援的資源類型的執行個體的數目會根據使用自動調整規模設定的日期和/或負載 （標準） 的資料的時間。</span><span class="sxs-lookup"><span data-stu-id="33472-140">Using autoscale, you can automatically scale out or scale in hello number of instances in a supported resource type based on time of day and/or load (metric) data using an autoscale setting.</span></span> <span data-ttu-id="33472-141">Hello 條件符合時 tooscale 向上或向下、 hello 開始與成功或失敗的事件都會記錄在此類別中。</span><span class="sxs-lookup"><span data-stu-id="33472-141">When hello conditions are met tooscale up or down, hello start and succeeded or failed events are recorded in this category.</span></span>
* <span data-ttu-id="33472-142">**建議** - 此類別包含來自特定資源類型 (如網站和 SQL 伺服器) 的建議事件。</span><span class="sxs-lookup"><span data-stu-id="33472-142">**Recommendation** - This category contains recommendation events from certain resource types, such as web sites and SQL servers.</span></span> <span data-ttu-id="33472-143">這些事件提供建議 toobetter 如何利用您的資源。</span><span class="sxs-lookup"><span data-stu-id="33472-143">These events offer recommendations for how toobetter utilize your resources.</span></span> <span data-ttu-id="33472-144">只有擁有會發出建議的資源時，您才會收到此類型的事件。</span><span class="sxs-lookup"><span data-stu-id="33472-144">You only receive events of this type if you have resources that emit recommendations.</span></span>
* <span data-ttu-id="33472-145">**原則、安全性及資源健康情況** - 這些類別不包含任何事件；僅保留以供未來使用。</span><span class="sxs-lookup"><span data-stu-id="33472-145">**Policy, Security, and Resource Health** - These categories do not contain any events; they are reserved for future use.</span></span>

## <a name="event-schema-per-category"></a><span data-ttu-id="33472-146">每個類別的事件結構描述</span><span class="sxs-lookup"><span data-stu-id="33472-146">Event schema per category</span></span>
[<span data-ttu-id="33472-147">請參閱此文章 toounderstand hello 活動記錄檔事件結構描述每個類別。</span><span class="sxs-lookup"><span data-stu-id="33472-147">See this article toounderstand hello Activity Log event schema per category.</span></span>](monitoring-activity-log-schema.md)

## <a name="what-you-can-do-with-hello-activity-log"></a><span data-ttu-id="33472-148">您可以執行以 hello 活動記錄檔</span><span class="sxs-lookup"><span data-stu-id="33472-148">What you can do with hello Activity Log</span></span>
<span data-ttu-id="33472-149">以下是一些您可以執行以 hello 活動記錄檔的 hello 事項：</span><span class="sxs-lookup"><span data-stu-id="33472-149">Here are some of hello things you can do with hello Activity Log:</span></span>

![Azure 活動記錄](./media/monitoring-overview-activity-logs/Activity_Log_Overview_v3.png)


* <span data-ttu-id="33472-151">查詢和檢視中 hello **Azure 入口網站**。</span><span class="sxs-lookup"><span data-stu-id="33472-151">Query and view it in hello **Azure portal**.</span></span>
* [<span data-ttu-id="33472-152">根據活動記錄事件建立警示。</span><span class="sxs-lookup"><span data-stu-id="33472-152">Create an alert on an Activity Log event.</span></span>](monitoring-activity-log-alerts.md)
* <span data-ttu-id="33472-153">[串流 tooan**事件中心**](monitoring-stream-activity-logs-event-hubs.md)來擷取第三方服務或自訂的分析解決方案，例如 power Bi。</span><span class="sxs-lookup"><span data-stu-id="33472-153">[Stream it tooan **Event Hub**](monitoring-stream-activity-logs-event-hubs.md) for ingestion by a third-party service or custom analytics solution such as PowerBI.</span></span>
* <span data-ttu-id="33472-154">分析中使用 hello PowerBI [ **power Bi 內容套件**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/)。</span><span class="sxs-lookup"><span data-stu-id="33472-154">Analyze it in PowerBI using hello [**PowerBI content pack**](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/).</span></span>
* <span data-ttu-id="33472-155">[將它儲存 tooa**儲存體帳戶**封存或手動檢查](monitoring-archive-activity-log.md)。</span><span class="sxs-lookup"><span data-stu-id="33472-155">[Save it tooa **Storage Account** for archival or manual inspection](monitoring-archive-activity-log.md).</span></span> <span data-ttu-id="33472-156">您可以指定 hello 保留時間 （以天為單位） 使用 hello**記錄檔的設定檔**。</span><span class="sxs-lookup"><span data-stu-id="33472-156">You can specify hello retention time (in days) using hello **Log Profile**.</span></span>
* <span data-ttu-id="33472-157">透過 PowerShell Cmdlet、CLI 或 REST API 查詢活動記錄。</span><span class="sxs-lookup"><span data-stu-id="33472-157">Query it via PowerShell Cmdlet, CLI, or REST API.</span></span>

## <a name="query-hello-activity-log-in-hello-azure-portal"></a><span data-ttu-id="33472-158">在 hello Azure 入口網站中的查詢 hello 活動記錄檔</span><span class="sxs-lookup"><span data-stu-id="33472-158">Query hello Activity Log in hello Azure portal</span></span>
<span data-ttu-id="33472-159">Hello Azure 入口網站中您可以檢視活動記錄在幾個地方：</span><span class="sxs-lookup"><span data-stu-id="33472-159">Within hello Azure portal you can view your Activity Log in several places:</span></span>
* <span data-ttu-id="33472-160">hello**活動記錄 刀鋒視窗**，您可以藉由搜尋 hello 左側導覽窗格中的 hello 活動記錄檔中 「 更多服務 」 存取。</span><span class="sxs-lookup"><span data-stu-id="33472-160">hello **Activity Log blade**, which you can access by searching for hello Activity Log under "More Services" in hello left-hand navigation pane.</span></span>
* <span data-ttu-id="33472-161">hello**監視器刀鋒視窗**，hello 左側導覽窗格中，預設會出現。</span><span class="sxs-lookup"><span data-stu-id="33472-161">hello **Monitor blade**, which appears by default in hello left-hand navigation pane.</span></span> <span data-ttu-id="33472-162">hello 活動記錄檔是一個區段的此 Azure 監視器刀鋒視窗。</span><span class="sxs-lookup"><span data-stu-id="33472-162">hello Activity Log is one section of this Azure Monitor blade.</span></span>
* <span data-ttu-id="33472-163">任何資源**資源刀鋒視窗**，例如 hello 組態刀鋒視窗中的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="33472-163">Any resource's **resource blade**, for example, hello configuration blade for a Virtual Machine.</span></span> <span data-ttu-id="33472-164">hello 活動記錄檔是其中一個 hello 章節於大部分的這些資源刀鋒視窗，並在其上按一下 自動篩選 hello 事件 toothose 相關 toothat 特定資源。</span><span class="sxs-lookup"><span data-stu-id="33472-164">hello Activity Log is be one of hello sections on most of these resource blades, and clicking on it automatically filters hello events toothose related toothat specific resource.</span></span>

<span data-ttu-id="33472-165">在 hello Azure 入口網站，您可以篩選您依這些欄位的活動記錄檔：</span><span class="sxs-lookup"><span data-stu-id="33472-165">In hello Azure portal, you can filter your Activity Log by these fields:</span></span>
* <span data-ttu-id="33472-166">Timespan-hello 開始和結束時間的事件。</span><span class="sxs-lookup"><span data-stu-id="33472-166">Timespan - hello start and end time for events.</span></span>
* <span data-ttu-id="33472-167">類別-hello 事件類別目錄 （如上所述）。</span><span class="sxs-lookup"><span data-stu-id="33472-167">Category - hello event category as described above.</span></span>
* <span data-ttu-id="33472-168">訂用帳戶 - 一或多個 Azure 訂用帳戶名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-168">Subscription - One or more Azure subscription names.</span></span>
* <span data-ttu-id="33472-169">資源群組 - 這些訂用帳戶中的一或多個資源群組。</span><span class="sxs-lookup"><span data-stu-id="33472-169">Resource group - One or more resource groups within those subscriptions.</span></span>
* <span data-ttu-id="33472-170">資源 （名稱）-hello 特定資源的名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-170">Resource (name) - hello name of a specific resource.</span></span>
* <span data-ttu-id="33472-171">資源類型資源，例如 Microsoft.Compute/virtualmachines hello 類型。</span><span class="sxs-lookup"><span data-stu-id="33472-171">Resource type - hello type of resource, for example, Microsoft.Compute/virtualmachines.</span></span>
* <span data-ttu-id="33472-172">作業名稱的 Azure 資源管理員作業，例如 Microsoft.SQL/servers/Write hello 名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-172">Operation name - hello name of an Azure Resource Manager operation, for example, Microsoft.SQL/servers/Write.</span></span>
* <span data-ttu-id="33472-173">嚴重性-hello 事件 (資訊、 警告、 錯誤、 Critical) hello 嚴重性層級。</span><span class="sxs-lookup"><span data-stu-id="33472-173">Severity - hello severity level of hello event (Informational, Warning, Error, Critical).</span></span>
* <span data-ttu-id="33472-174">由-hello 'caller，' 或執行 hello 作業的使用者啟動的事件。</span><span class="sxs-lookup"><span data-stu-id="33472-174">Event initiated by - hello 'caller,' or user who performed hello operation.</span></span>
* <span data-ttu-id="33472-175">開啟搜尋 - 這是開啟文字搜尋方塊，可在所有事件的所有欄位中搜尋該字串。</span><span class="sxs-lookup"><span data-stu-id="33472-175">Open search - This is an open text search box that searches for that string across all fields in all events.</span></span>

<span data-ttu-id="33472-176">一旦定義了一組篩選之後，您就可以將它儲存為查詢，如果您需要 tooperform，在工作階段之間保存的 hello 同樣的查詢與在未來的 hello 重新套用這些篩選。</span><span class="sxs-lookup"><span data-stu-id="33472-176">Once you have defined a set of filters, you can save it as a query that is persisted across sessions if you ever need tooperform hello same query with those filters applied again in hello future.</span></span> <span data-ttu-id="33472-177">您也可以釘選查詢 tooyour Azure 儀表板 tooalways 保持落在特定事件。</span><span class="sxs-lookup"><span data-stu-id="33472-177">You can also pin a query tooyour Azure dashboard tooalways keep an eye on specific events.</span></span>

<span data-ttu-id="33472-178">按一下 [套用] 執行您的查詢，並顯示所有相符的事件。</span><span class="sxs-lookup"><span data-stu-id="33472-178">Clicking "Apply" runs your query and show all matching events.</span></span> <span data-ttu-id="33472-179">按一下顯示 hello 該事件的摘要，以及 hello 該事件的完整原始 JSON hello 清單中的任何事件。</span><span class="sxs-lookup"><span data-stu-id="33472-179">Clicking on any event in hello list shows hello summary of that event as well as hello full raw JSON of that event.</span></span>

<span data-ttu-id="33472-180">取得更多電源，您可以按一下 hello**記錄搜尋**圖示，顯示活動記錄資料中 hello[記錄分析活動記錄分析解決方案](../log-analytics/log-analytics-activity.md)。</span><span class="sxs-lookup"><span data-stu-id="33472-180">For even more power, you can click hello **Log Search** icon, which displays your Activity Log data in hello [Log Analytics Activity Log Analytics solution](../log-analytics/log-analytics-activity.md).</span></span> <span data-ttu-id="33472-181">hello 活動記錄 刀鋒視窗會提供基本的篩選條件/瀏覽體驗上記錄檔，但記錄分析可讓您 toopivot 查詢，並將資料視覺化功能更強大的方式。</span><span class="sxs-lookup"><span data-stu-id="33472-181">hello Activity Log blade offers a basic filter/browse experience on logs, but Log Analytics enables you toopivot, query, and visualize your data in more powerful ways.</span></span>

## <a name="export-hello-activity-log-with-a-log-profile"></a><span data-ttu-id="33472-182">匯出 hello 活動記錄檔與記錄檔的設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-182">Export hello Activity Log with a Log Profile</span></span>
<span data-ttu-id="33472-183">**記錄檔設定檔** 控制活動記錄檔的匯出方式。</span><span class="sxs-lookup"><span data-stu-id="33472-183">A **Log Profile** controls how your Activity Log is exported.</span></span> <span data-ttu-id="33472-184">使用記錄檔設定檔，您可以設定︰</span><span class="sxs-lookup"><span data-stu-id="33472-184">Using a Log Profile, you can configure:</span></span>

* <span data-ttu-id="33472-185">（儲存體帳戶或事件中心） 其中傳送嗨活動記錄檔</span><span class="sxs-lookup"><span data-stu-id="33472-185">Where hello Activity Log should be sent (Storage Account or Event Hubs)</span></span>
* <span data-ttu-id="33472-186">應該要傳送何種事件分類 (Write、Delete、Action)。</span><span class="sxs-lookup"><span data-stu-id="33472-186">Which event categories (Write, Delete, Action) should be sent.</span></span> <span data-ttu-id="33472-187">*hello 意義的 「 類別目錄 」 中設定記錄檔和活動記錄檔事件會不同。Hello 記錄檔的設定檔，在 「 類別目錄 」 會代表 hello 作業類型 （寫入、 刪除、 動作）。活動記錄檔事件、 hello 「 類別目錄 」 屬性會代表 hello 來源或類型的事件 （例如，管理、 ServiceHealth、 警示及多個）。*</span><span class="sxs-lookup"><span data-stu-id="33472-187">*hello meaning of "category" in Log Profiles and Activity Log events is different. In hello Log Profile, "Category" represents hello operation type (Write, Delete, Action). In an Activity Log event, hello "category" property represents hello source or type of event (for example, Administration, ServiceHealth, Alert, and more).*</span></span>
* <span data-ttu-id="33472-188">應該要匯出哪一個區域 (位置)。</span><span class="sxs-lookup"><span data-stu-id="33472-188">Which regions (locations) should be exported.</span></span> <span data-ttu-id="33472-189">請確定 tooinclude 「 全域 」，因為 hello 活動記錄檔中的許多事件都是全域的事件。</span><span class="sxs-lookup"><span data-stu-id="33472-189">Make sure tooinclude "global," as many events in hello Activity Log are global events.</span></span>
* <span data-ttu-id="33472-190">多久 hello 活動記錄應保留在儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="33472-190">How long hello Activity Log should be retained in a Storage Account.</span></span>
    - <span data-ttu-id="33472-191">保留期為 0 天表示會永遠保留記錄。</span><span class="sxs-lookup"><span data-stu-id="33472-191">A retention of zero days means logs are kept forever.</span></span> <span data-ttu-id="33472-192">否則，hello 值可以是任意數目的 1 到 2147483647 之間的天數。</span><span class="sxs-lookup"><span data-stu-id="33472-192">Otherwise, hello value can be any number of days between 1 and 2147483647.</span></span>
    - <span data-ttu-id="33472-193">如果設定保留原則，但記錄檔儲存體帳戶中已停用儲存 （例如，如果只選取事件中心 或 OMS 選項），hello 保留原則會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="33472-193">If retention policies are set but storing logs in a Storage Account is disabled (for example, if only Event Hubs or OMS options are selected), hello retention policies have no effect.</span></span>
    - <span data-ttu-id="33472-194">保留原則套用的每日，因此在 hello 結束日 (UTC) 的記錄從 hello 天現在超出 hello 保留原則會刪除。</span><span class="sxs-lookup"><span data-stu-id="33472-194">Retention policies are applied per-day, so at hello end of a day (UTC), logs from hello day that is now beyond hello retention policy are deleted.</span></span> <span data-ttu-id="33472-195">例如，如果您在一天的保留原則，hello 從今天 hello 日開始時 hello hello 天前昨天的記錄檔會刪除。</span><span class="sxs-lookup"><span data-stu-id="33472-195">For example, if you had a retention policy of one day, at hello beginning of hello day today hello logs from hello day before yesterday would be deleted.</span></span>

<span data-ttu-id="33472-196">您可以使用儲存體帳戶，或未出現在事件中樞命名空間 hello 相同訂用帳戶，因為 hello 一個發出記錄檔。</span><span class="sxs-lookup"><span data-stu-id="33472-196">You can use a storage account or event hub namespace that is not in hello same subscription as hello one emitting logs.</span></span> <span data-ttu-id="33472-197">將設定 hello 設定的 hello 使用者必須擁有 hello 適當 RBAC 存取 tooboth 訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="33472-197">hello user who configures hello setting must have hello appropriate RBAC access tooboth subscriptions.</span></span>

<span data-ttu-id="33472-198">透過在 hello hello 入口網站中的活動記錄 刀鋒視窗的 hello 「 匯出 」 選項，可以設定這些設定。</span><span class="sxs-lookup"><span data-stu-id="33472-198">These settings can be configured via hello “Export” option in hello Activity Log blade in hello portal.</span></span> <span data-ttu-id="33472-199">它們也可以設定以程式設計方式[使用 hello Azure 監視 REST API](https://msdn.microsoft.com/library/azure/dn931927.aspx)，PowerShell cmdlet 或 CLI。</span><span class="sxs-lookup"><span data-stu-id="33472-199">They can also be configured programmatically [using hello Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931927.aspx), PowerShell cmdlets, or CLI.</span></span> <span data-ttu-id="33472-200">一個訂用帳戶只能有一個記錄檔的設定檔。</span><span class="sxs-lookup"><span data-stu-id="33472-200">A subscription can only have one log profile.</span></span>

### <a name="configure-log-profiles-using-hello-azure-portal"></a><span data-ttu-id="33472-201">設定記錄檔的設定檔使用 hello Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="33472-201">Configure log profiles using hello Azure portal</span></span>
<span data-ttu-id="33472-202">您可以串流處理 hello 活動記錄檔 tooan 事件中心，或將其儲存在儲存體帳戶中，利用 hello Azure 入口網站中的 hello 「 匯出 」 選項。</span><span class="sxs-lookup"><span data-stu-id="33472-202">You can stream hello Activity Log tooan Event Hub or store them in a Storage Account by using hello “Export” option in hello Azure portal.</span></span>

1. <span data-ttu-id="33472-203">瀏覽 toohello**活動記錄檔**刀鋒視窗上 hello hello 入口網站的左側使用 hello 功能表。</span><span class="sxs-lookup"><span data-stu-id="33472-203">Navigate toohello **Activity Log** blade using hello menu on hello left side of hello portal.</span></span>

    ![瀏覽 tooActivity 記錄在入口網站](./media/monitoring-overview-activity-logs/activity-logs-portal-navigate.png)
2. <span data-ttu-id="33472-205">按一下 hello**匯出**在 hello hello 刀鋒視窗頂端的按鈕。</span><span class="sxs-lookup"><span data-stu-id="33472-205">Click hello **Export** button at hello top of hello blade.</span></span>

    ![入口網站中的匯出按鈕](./media/monitoring-overview-activity-logs/activity-logs-portal-export.png)
3. <span data-ttu-id="33472-207">在 hello 刀鋒視窗中出現，您可以選取：</span><span class="sxs-lookup"><span data-stu-id="33472-207">In hello blade that appears, you can select:</span></span>  
  * <span data-ttu-id="33472-208">區域，您想要 tooexport 事件</span><span class="sxs-lookup"><span data-stu-id="33472-208">regions for which you would like tooexport events</span></span>
  * <span data-ttu-id="33472-209">hello 儲存體帳戶 toowhich 希望 toosave 事件</span><span class="sxs-lookup"><span data-stu-id="33472-209">hello Storage Account toowhich you would like toosave events</span></span>
  * <span data-ttu-id="33472-210">hello 要 tooretain 這些事件的儲存體中的日數。</span><span class="sxs-lookup"><span data-stu-id="33472-210">hello number of days you want tooretain these events in storage.</span></span> <span data-ttu-id="33472-211">如果設定為 0 天會永遠保留 hello 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="33472-211">A setting of 0 days retains hello logs forever.</span></span>
  * <span data-ttu-id="33472-212">hello 服務匯流排命名空間中，您想要串流處理這些事件建立事件中樞 toobe。</span><span class="sxs-lookup"><span data-stu-id="33472-212">hello Service Bus Namespace in which you would like an Event Hub toobe created for streaming these events.</span></span>

     ![匯出活動記錄檔刀鋒視窗](./media/monitoring-overview-activity-logs/activity-logs-portal-export-blade.png)
4. <span data-ttu-id="33472-214">按一下**儲存**toosave 這些設定。</span><span class="sxs-lookup"><span data-stu-id="33472-214">Click **Save** toosave these settings.</span></span> <span data-ttu-id="33472-215">hello 設定會立即會套用的 tooyour 訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="33472-215">hello settings are immediately be applied tooyour subscription.</span></span>

### <a name="configure-log-profiles-using-hello-azure-powershell-cmdlets"></a><span data-ttu-id="33472-216">設定記錄檔的設定檔使用 hello Azure PowerShell Cmdlet</span><span class="sxs-lookup"><span data-stu-id="33472-216">Configure log profiles using hello Azure PowerShell Cmdlets</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="33472-217">取得現有的記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-217">Get existing log profile</span></span>
```
Get-AzureRmLogProfile
```

#### <a name="add-a-log-profile"></a><span data-ttu-id="33472-218">新增記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-218">Add a log profile</span></span>
```
Add-AzureRmLogProfile -Name my_log_profile -StorageAccountId /subscriptions/s1/resourceGroups/myrg1/providers/Microsoft.Storage/storageAccounts/my_storage -serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey -Locations global,westus,eastus -RetentionInDays 90 -Categories Write,Delete,Action
```

| <span data-ttu-id="33472-219">屬性</span><span class="sxs-lookup"><span data-stu-id="33472-219">Property</span></span> | <span data-ttu-id="33472-220">必要</span><span class="sxs-lookup"><span data-stu-id="33472-220">Required</span></span> | <span data-ttu-id="33472-221">說明</span><span class="sxs-lookup"><span data-stu-id="33472-221">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="33472-222">Name</span><span class="sxs-lookup"><span data-stu-id="33472-222">Name</span></span> |<span data-ttu-id="33472-223">是</span><span class="sxs-lookup"><span data-stu-id="33472-223">Yes</span></span> |<span data-ttu-id="33472-224">記錄檔設定檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-224">Name of your log profile.</span></span> |
| <span data-ttu-id="33472-225">StorageAccountId</span><span class="sxs-lookup"><span data-stu-id="33472-225">StorageAccountId</span></span> |<span data-ttu-id="33472-226">否</span><span class="sxs-lookup"><span data-stu-id="33472-226">No</span></span> |<span data-ttu-id="33472-227">應該儲存 hello 儲存體帳戶 toowhich hello 活動記錄檔的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="33472-227">Resource ID of hello Storage Account toowhich hello Activity Log should be saved.</span></span> |
| <span data-ttu-id="33472-228">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="33472-228">serviceBusRuleId</span></span> |<span data-ttu-id="33472-229">否</span><span class="sxs-lookup"><span data-stu-id="33472-229">No</span></span> |<span data-ttu-id="33472-230">服務匯流排 hello 服務匯流排命名空間，您想要 toohave 事件中樞中建立的規則識別碼。</span><span class="sxs-lookup"><span data-stu-id="33472-230">Service Bus Rule ID for hello Service Bus namespace you would like toohave event hubs created in.</span></span> <span data-ttu-id="33472-231">將會是此格式的字串︰`{service bus resource ID}/authorizationrules/{key name}`。</span><span class="sxs-lookup"><span data-stu-id="33472-231">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="33472-232">位置</span><span class="sxs-lookup"><span data-stu-id="33472-232">Locations</span></span> |<span data-ttu-id="33472-233">是</span><span class="sxs-lookup"><span data-stu-id="33472-233">Yes</span></span> |<span data-ttu-id="33472-234">以逗號分隔清單的區域，您想要 toocollect 活動記錄檔事件。</span><span class="sxs-lookup"><span data-stu-id="33472-234">Comma-separated list of regions for which you would like toocollect Activity Log events.</span></span> |
| <span data-ttu-id="33472-235">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="33472-235">RetentionInDays</span></span> |<span data-ttu-id="33472-236">是</span><span class="sxs-lookup"><span data-stu-id="33472-236">Yes</span></span> |<span data-ttu-id="33472-237">事件應保留的天數，1 到 2147483647 之間。</span><span class="sxs-lookup"><span data-stu-id="33472-237">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="33472-238">值為 0 會無限期儲存 hello 記錄檔 （永久）。</span><span class="sxs-lookup"><span data-stu-id="33472-238">A value of zero stores hello logs indefinitely (forever).</span></span> |
| <span data-ttu-id="33472-239">類別</span><span class="sxs-lookup"><span data-stu-id="33472-239">Categories</span></span> |<span data-ttu-id="33472-240">否</span><span class="sxs-lookup"><span data-stu-id="33472-240">No</span></span> |<span data-ttu-id="33472-241">以逗號分隔的類別清單，其中列出應該收集的事件類別。</span><span class="sxs-lookup"><span data-stu-id="33472-241">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="33472-242">可能的值有 Write、Delete、Action。</span><span class="sxs-lookup"><span data-stu-id="33472-242">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="33472-243">移除記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-243">Remove a log profile</span></span>
```
Remove-AzureRmLogProfile -name my_log_profile
```

### <a name="configure-log-profiles-using-hello-azure-cross-platform-cli"></a><span data-ttu-id="33472-244">設定記錄檔的設定檔使用 hello Azure 跨平台 CLI</span><span class="sxs-lookup"><span data-stu-id="33472-244">Configure log profiles Using hello Azure Cross-Platform CLI</span></span>
#### <a name="get-existing-log-profile"></a><span data-ttu-id="33472-245">取得現有的記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-245">Get existing log profile</span></span>
```
azure insights logprofile list
```
```
azure insights logprofile get --name my_log_profile
```
<span data-ttu-id="33472-246">hello`name`屬性應該是 hello 您記錄檔的設定檔名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-246">hello `name` property should be hello name of your log profile.</span></span>

#### <a name="add-a-log-profile"></a><span data-ttu-id="33472-247">新增記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-247">Add a log profile</span></span>
```
azure insights logprofile add --name my_log_profile --storageId /subscriptions/s1/resourceGroups/insights-integration/providers/Microsoft.Storage/storageAccounts/my_storage --serviceBusRuleId /subscriptions/s1/resourceGroups/Default-ServiceBus-EastUS/providers/Microsoft.ServiceBus/namespaces/mytestSB/authorizationrules/RootManageSharedAccessKey --locations global,westus,eastus,northeurope --retentionInDays 90 –categories Write,Delete,Action
```

| <span data-ttu-id="33472-248">屬性</span><span class="sxs-lookup"><span data-stu-id="33472-248">Property</span></span> | <span data-ttu-id="33472-249">必要</span><span class="sxs-lookup"><span data-stu-id="33472-249">Required</span></span> | <span data-ttu-id="33472-250">說明</span><span class="sxs-lookup"><span data-stu-id="33472-250">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="33472-251">名稱</span><span class="sxs-lookup"><span data-stu-id="33472-251">name</span></span> |<span data-ttu-id="33472-252">是</span><span class="sxs-lookup"><span data-stu-id="33472-252">Yes</span></span> |<span data-ttu-id="33472-253">記錄檔設定檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="33472-253">Name of your log profile.</span></span> |
| <span data-ttu-id="33472-254">storageId</span><span class="sxs-lookup"><span data-stu-id="33472-254">storageId</span></span> |<span data-ttu-id="33472-255">否</span><span class="sxs-lookup"><span data-stu-id="33472-255">No</span></span> |<span data-ttu-id="33472-256">應該儲存 hello 儲存體帳戶 toowhich hello 活動記錄檔的資源識別碼。</span><span class="sxs-lookup"><span data-stu-id="33472-256">Resource ID of hello Storage Account toowhich hello Activity Log should be saved.</span></span> |
| <span data-ttu-id="33472-257">serviceBusRuleId</span><span class="sxs-lookup"><span data-stu-id="33472-257">serviceBusRuleId</span></span> |<span data-ttu-id="33472-258">否</span><span class="sxs-lookup"><span data-stu-id="33472-258">No</span></span> |<span data-ttu-id="33472-259">服務匯流排 hello 服務匯流排命名空間，您想要 toohave 事件中樞中建立的規則識別碼。</span><span class="sxs-lookup"><span data-stu-id="33472-259">Service Bus Rule ID for hello Service Bus namespace you would like toohave event hubs created in.</span></span> <span data-ttu-id="33472-260">將會是此格式的字串︰`{service bus resource ID}/authorizationrules/{key name}`。</span><span class="sxs-lookup"><span data-stu-id="33472-260">Is a string with this format: `{service bus resource ID}/authorizationrules/{key name}`.</span></span> |
| <span data-ttu-id="33472-261">位置</span><span class="sxs-lookup"><span data-stu-id="33472-261">locations</span></span> |<span data-ttu-id="33472-262">是</span><span class="sxs-lookup"><span data-stu-id="33472-262">Yes</span></span> |<span data-ttu-id="33472-263">以逗號分隔清單的區域，您想要 toocollect 活動記錄檔事件。</span><span class="sxs-lookup"><span data-stu-id="33472-263">Comma-separated list of regions for which you would like toocollect Activity Log events.</span></span> |
| <span data-ttu-id="33472-264">RetentionInDays</span><span class="sxs-lookup"><span data-stu-id="33472-264">retentionInDays</span></span> |<span data-ttu-id="33472-265">是</span><span class="sxs-lookup"><span data-stu-id="33472-265">Yes</span></span> |<span data-ttu-id="33472-266">事件應保留的天數，1 到 2147483647 之間。</span><span class="sxs-lookup"><span data-stu-id="33472-266">Number of days for which events should be retained, between 1 and 2147483647.</span></span> <span data-ttu-id="33472-267">值為 0 會無限期儲存 hello 記錄檔 （永久）。</span><span class="sxs-lookup"><span data-stu-id="33472-267">A value of zero stores hello logs indefinitely (forever).</span></span> |
| <span data-ttu-id="33472-268">類別</span><span class="sxs-lookup"><span data-stu-id="33472-268">categories</span></span> |<span data-ttu-id="33472-269">否</span><span class="sxs-lookup"><span data-stu-id="33472-269">No</span></span> |<span data-ttu-id="33472-270">以逗號分隔的類別清單，其中列出應該收集的事件類別。</span><span class="sxs-lookup"><span data-stu-id="33472-270">Comma-separated list of event categories that should be collected.</span></span> <span data-ttu-id="33472-271">可能的值有 Write、Delete、Action。</span><span class="sxs-lookup"><span data-stu-id="33472-271">Possible values are Write, Delete, and Action.</span></span> |

#### <a name="remove-a-log-profile"></a><span data-ttu-id="33472-272">移除記錄檔設定檔</span><span class="sxs-lookup"><span data-stu-id="33472-272">Remove a log profile</span></span>
```
azure insights logprofile delete --name my_log_profile
```

## <a name="next-steps"></a><span data-ttu-id="33472-273">後續步驟</span><span class="sxs-lookup"><span data-stu-id="33472-273">Next Steps</span></span>
* [<span data-ttu-id="33472-274">深入了解 hello 活動記錄檔 （先前稱為稽核記錄檔）</span><span class="sxs-lookup"><span data-stu-id="33472-274">Learn more about hello Activity Log (formerly Audit Logs)</span></span>](../azure-resource-manager/resource-group-audit.md)
* [<span data-ttu-id="33472-275">資料流 hello Azure 活動記錄檔 tooEvent 集線器</span><span class="sxs-lookup"><span data-stu-id="33472-275">Stream hello Azure Activity Log tooEvent Hubs</span></span>](monitoring-stream-activity-logs-event-hubs.md)
