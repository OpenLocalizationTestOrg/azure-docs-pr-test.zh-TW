---
title: "使用 OpenID Connect 的 Web 登入 - Azure AD B2C | Microsoft Docs"
description: "藉由使用 hello Azure Active Directory 實作 hello OpenID Connect 的驗證通訊協定建置 web 應用程式"
services: active-directory-b2c
documentationcenter: 
author: saeedakhter-msft
manager: krassk
editor: parakhj
ms.assetid: 21d420c8-3c10-4319-b681-adf2e89e7ede
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/16/2017
ms.author: saeedakhter-msft
ms.openlocfilehash: 89e9cfa28e4e5c34304aea355cca2dd0c4b42abc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-active-directory-b2c-web-sign-in-with-openid-connect"></a><span data-ttu-id="9e2cb-103">Azure Active Directory B2C：利用 OpenID Connect 的 Web 登入</span><span class="sxs-lookup"><span data-stu-id="9e2cb-103">Azure Active Directory B2C: Web sign-in with OpenID Connect</span></span>
<span data-ttu-id="9e2cb-104">OpenID Connect 是之上 OAuth 2.0，可以使用的 toosecurely 登入 tooweb 應用程式使用者的驗證通訊協定。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-104">OpenID Connect is an authentication protocol, built on top of OAuth 2.0, that can be used toosecurely sign users in tooweb applications.</span></span> <span data-ttu-id="9e2cb-105">藉由使用 Azure Active Directory B2C hello OpenID Connect (Azure AD B2C) 實作，您可以將外包註冊、 登入和您的 web 應用程式 tooAzure Active Directory (Azure AD) 中的其他身分識別管理體驗。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-105">By using hello Azure Active Directory B2C (Azure AD B2C) implementation of OpenID Connect, you can outsource sign-up, sign-in, and other identity management experiences in your web applications tooAzure Active Directory (Azure AD).</span></span> <span data-ttu-id="9e2cb-106">本指南也說明如何 toodo 因此語言無關的方式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-106">This guide shows you how toodo so in a language-independent manner.</span></span> <span data-ttu-id="9e2cb-107">它會描述如何 toosend 和接收 HTTP 訊息，而不使用任何我們開放原始碼程式庫。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-107">It describes how toosend and receive HTTP messages without using any of our open-source libraries.</span></span>

<span data-ttu-id="9e2cb-108">[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html)擴充 hello OAuth 2.0*授權*通訊協定，用來做*驗證*通訊協定。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-108">[OpenID Connect](http://openid.net/specs/openid-connect-core-1_0.html) extends hello OAuth 2.0 *authorization* protocol for use as an *authentication* protocol.</span></span> <span data-ttu-id="9e2cb-109">這可讓您 tooperform 單一登入使用 OAuth。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-109">This allows you tooperform single sign-on by using OAuth.</span></span> <span data-ttu-id="9e2cb-110">它引進 hello 概念*ID 語彙基元*，這是安全性權杖，可讓 hello 用戶端 tooverify hello hello 使用者的身分識別，並取得 hello 使用者的基本設定檔資訊。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-110">It introduces hello concept of an *ID token*, which is a security token that allows hello client tooverify hello identity of hello user and obtain basic profile information about hello user.</span></span>

<span data-ttu-id="9e2cb-111">因為它可延伸 OAuth 2.0，它也可讓應用程式取得 toosecurely*存取權杖*。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-111">Because it extends OAuth 2.0, it also enables apps toosecurely acquire *access tokens*.</span></span> <span data-ttu-id="9e2cb-112">您可以使用受保護的 access_tokens tooaccess 資源[授權伺服器](active-directory-b2c-reference-protocols.md#the-basics)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-112">You can use access_tokens tooaccess resources that are secured by an [authorization server](active-directory-b2c-reference-protocols.md#the-basics).</span></span> <span data-ttu-id="9e2cb-113">如果您要建置的 Web 應用程式是裝載在伺服器上，且必須透過瀏覽器來存取，我們建議您使用 OpenID Connect。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-113">We recommend OpenID Connect if you're building a web application that is hosted on a server and accessed through a browser.</span></span> <span data-ttu-id="9e2cb-114">如果您使用 Azure AD B2C 想 tooadd 身分識別管理 tooyour 行動或桌面應用程式，您應該使用[OAuth 2.0](active-directory-b2c-reference-oauth-code.md)而不是 OpenID Connect。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-114">If you want tooadd identity management tooyour mobile or desktop applications by using Azure AD B2C, you should use [OAuth 2.0](active-directory-b2c-reference-oauth-code.md) rather than OpenID Connect.</span></span>

<span data-ttu-id="9e2cb-115">Azure AD B2C 擴充 hello 標準 OpenID Connect 通訊協定 toodo 多個簡單驗證及授權。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-115">Azure AD B2C extends hello standard OpenID Connect protocol toodo more than simple authentication and authorization.</span></span> <span data-ttu-id="9e2cb-116">它會導致 hello[原則參數](active-directory-b2c-reference-policies.md)，可讓您 toouse OpenID Connect tooadd 使用者體驗-例如註冊、 登入及管理設定檔-tooyour 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-116">It introduces hello [policy parameter](active-directory-b2c-reference-policies.md), which enables you toouse OpenID Connect tooadd user experiences--such as sign-up, sign-in, and profile management--tooyour app.</span></span> <span data-ttu-id="9e2cb-117">在這裡，我們為您示範如何 toouse OpenID Connect 和原則 tooimplement 每一種 web 應用程式中發生。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-117">Here, we show you how toouse OpenID Connect and policies tooimplement each of these experiences in your web applications.</span></span> <span data-ttu-id="9e2cb-118">我們也會顯示您如何 tooget 存取權杖來存取 web 應用程式開發介面。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-118">We'll also show you how tooget access tokens for accessing web APIs.</span></span>

<span data-ttu-id="9e2cb-119">hello 下一節中的 hello 範例 HTTP 要求會使用我們的範例 B2C 目錄、 fabrikamb2c.onmicrosoft.com，以及我們的範例應用程式、 https://aadb2cplayground.azurewebsites.net 和原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-119">hello example HTTP requests in hello next section use our sample B2C directory, fabrikamb2c.onmicrosoft.com, as well as our sample application, https://aadb2cplayground.azurewebsites.net, and policies.</span></span> <span data-ttu-id="9e2cb-120">您可以隨意 tootry 出 hello，要求您自己使用這些值，或您可以使用您自己取代它們。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-120">You're free tootry out hello requests yourself by using these values, or you can replace them with your own.</span></span>
<span data-ttu-id="9e2cb-121">了解如何太[取得自己 B2C 租用戶、 應用程式，以及原則](#use-your-own-b2c-directory)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-121">Learn how too[get your own B2C tenant, application, and policies](#use-your-own-b2c-directory).</span></span>

## <a name="send-authentication-requests"></a><span data-ttu-id="9e2cb-122">傳送驗證要求</span><span class="sxs-lookup"><span data-stu-id="9e2cb-122">Send authentication requests</span></span>
<span data-ttu-id="9e2cb-123">當您的 web 應用程式需要 tooauthenticate hello 使用者，並執行原則時，它可以直接 hello 使用者 toohello`/authorize`端點。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-123">When your web app needs tooauthenticate hello user and execute a policy, it can direct hello user toohello `/authorize` endpoint.</span></span> <span data-ttu-id="9e2cb-124">這是 hello 互動式部份 hello 流程其中 hello 使用者採取動作，視 hello 原則而定。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-124">This is hello interactive portion of hello flow, where hello user takes action, depending on hello policy.</span></span>

<span data-ttu-id="9e2cb-125">在此要求中，hello 用戶端指出它需要 hello hello 使用者 tooacquire hello 權限`scope`hello 中的參數和 hello 原則 tooexecute`p`參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-125">In this request, hello client indicates hello permissions that it needs tooacquire from hello user in hello `scope` parameter and hello policy tooexecute in hello `p` parameter.</span></span> <span data-ttu-id="9e2cb-126">三個範例會提供在 hello 下列各節 （使用分行符號來提高可讀性），每個使用不同的原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-126">Three examples are provided in hello following sections (with line breaks for readability), each using a different policy.</span></span> <span data-ttu-id="9e2cb-127">tooget 的風格的每個要求的運作方式，然後嘗試貼上 hello 要求，到瀏覽器，並執行它。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-127">tooget a feel for how each request works, try pasting hello request into a browser and running it.</span></span>

#### <a name="use-a-sign-in-policy"></a><span data-ttu-id="9e2cb-128">使用登入原則</span><span class="sxs-lookup"><span data-stu-id="9e2cb-128">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_in
```

#### <a name="use-a-sign-up-policy"></a><span data-ttu-id="9e2cb-129">使用註冊原則</span><span class="sxs-lookup"><span data-stu-id="9e2cb-129">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_up
```

#### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="9e2cb-130">使用編輯設定檔原則</span><span class="sxs-lookup"><span data-stu-id="9e2cb-130">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_edit_profile
```

| <span data-ttu-id="9e2cb-131">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-131">Parameter</span></span> | <span data-ttu-id="9e2cb-132">必要？</span><span class="sxs-lookup"><span data-stu-id="9e2cb-132">Required?</span></span> | <span data-ttu-id="9e2cb-133">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-133">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9e2cb-134">client_id</span><span class="sxs-lookup"><span data-stu-id="9e2cb-134">client_id</span></span> |<span data-ttu-id="9e2cb-135">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-135">Required</span></span> |<span data-ttu-id="9e2cb-136">hello 應用程式識別碼的 hello [Azure 入口網站](https://portal.azure.com/)指派 tooyour 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-136">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="9e2cb-137">response_type</span><span class="sxs-lookup"><span data-stu-id="9e2cb-137">response_type</span></span> |<span data-ttu-id="9e2cb-138">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-138">Required</span></span> |<span data-ttu-id="9e2cb-139">hello 回應類型，其中必須包括 OpenID connect 的 ID 語彙基元。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-139">hello response type, which must include an ID token for OpenID Connect.</span></span> <span data-ttu-id="9e2cb-140">如果您的 Web 應用程式也需要權杖來呼叫 Web API，則可以使用 `code+id_token`，如同這裡的作法。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-140">If your web app also needs tokens for calling a web API, you can use `code+id_token`, as we've done here.</span></span> |
| <span data-ttu-id="9e2cb-141">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="9e2cb-141">redirect_uri</span></span> |<span data-ttu-id="9e2cb-142">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-142">Recommended</span></span> |<span data-ttu-id="9e2cb-143">hello`redirect_uri`應用程式，可以傳送及接收您的應用程式驗證回應的參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-143">hello `redirect_uri` parameter of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="9e2cb-144">它必須完全符合其中一個 hello`redirect_uri`您註冊 hello 入口網站中，不同之處在於它必須是 URL 編碼的參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-144">It must exactly match one of hello `redirect_uri` parameters that you registered in hello portal, except that it must be URL encoded.</span></span> |
| <span data-ttu-id="9e2cb-145">scope</span><span class="sxs-lookup"><span data-stu-id="9e2cb-145">scope</span></span> |<span data-ttu-id="9e2cb-146">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-146">Required</span></span> |<span data-ttu-id="9e2cb-147">範圍的空格分隔清單。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-147">A space-separated list of scopes.</span></span> <span data-ttu-id="9e2cb-148">單一領域值會指出 tooAzure AD 要求這兩個權限。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-148">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="9e2cb-149">hello`openid`範圍表示權限 toosign hello hello 表單的 ID 語彙基元 (詳細 toocome 這在本文稍後 hello) 中的 hello 使用者相關的使用者，以及如何取得資料中。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-149">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of ID tokens (more toocome on this later in hello article).</span></span> <span data-ttu-id="9e2cb-150">hello`offline_access`範圍都是選擇性的 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-150">hello `offline_access` scope is optional for web apps.</span></span> <span data-ttu-id="9e2cb-151">它會指出您的應用程式將需要*重新整理權杖*如 tooresources 長時間執行的存取。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-151">It indicates that your app will need a *refresh token* for long-lived access tooresources.</span></span> |
| <span data-ttu-id="9e2cb-152">response_mode</span><span class="sxs-lookup"><span data-stu-id="9e2cb-152">response_mode</span></span> |<span data-ttu-id="9e2cb-153">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-153">Recommended</span></span> |<span data-ttu-id="9e2cb-154">hello 應該使用的 toosend hello 產生授權程式碼後 tooyour 應用程式的方法。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-154">hello method that should be used toosend hello resulting authorization code back tooyour app.</span></span> <span data-ttu-id="9e2cb-155">它可以是 `query`、`form_post` 或 `fragment`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-155">It can be either `query`, `form_post`, or `fragment`.</span></span>  <span data-ttu-id="9e2cb-156">hello`form_post`最佳安全性的建議回應模式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-156">hello `form_post` response mode is recommended for best security.</span></span> |
| <span data-ttu-id="9e2cb-157">state</span><span class="sxs-lookup"><span data-stu-id="9e2cb-157">state</span></span> |<span data-ttu-id="9e2cb-158">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-158">Recommended</span></span> |<span data-ttu-id="9e2cb-159">也會傳回 hello 權杖回應中的 hello 要求中包含一個值。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-159">A value included in hello request that is also returned in hello token response.</span></span> <span data-ttu-id="9e2cb-160">它可以是您所想要內容中的字串。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-160">It can be a string of any content that you want.</span></span> <span data-ttu-id="9e2cb-161">隨機產生的唯一值通常用於防止跨站台要求偽造攻擊。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-161">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span> <span data-ttu-id="9e2cb-162">之前發生 hello 驗證要求，例如 hello 頁上 hello 狀態也會使用的 tooencode hello 應用程式中的 hello 使用者狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-162">hello state is also used tooencode information about hello user's state in hello app before hello authentication request occurred, such as hello page they were on.</span></span> |
| <span data-ttu-id="9e2cb-163">nonce</span><span class="sxs-lookup"><span data-stu-id="9e2cb-163">nonce</span></span> |<span data-ttu-id="9e2cb-164">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-164">Required</span></span> |<span data-ttu-id="9e2cb-165">值，包含在資料將會包含在 hello 產生的 ID 語彙基元宣告的形式 hello 要求 （由 hello 應用程式所產生）。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-165">A value included in hello request (generated by hello app) that will be included in hello resulting ID token as a claim.</span></span> <span data-ttu-id="9e2cb-166">hello 應用程式然後確認此值 toomitigate 權杖重新執行攻擊。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-166">hello app can then verify this value toomitigate token replay attacks.</span></span> <span data-ttu-id="9e2cb-167">hello 值通常是隨機的唯一字串可能是使用的 tooidentify hello 原點的 hello 要求。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-167">hello value is typically a randomized unique string that can be used tooidentify hello origin of hello request.</span></span> |
| <span data-ttu-id="9e2cb-168">p</span><span class="sxs-lookup"><span data-stu-id="9e2cb-168">p</span></span> |<span data-ttu-id="9e2cb-169">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-169">Required</span></span> |<span data-ttu-id="9e2cb-170">將執行的 hello 原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-170">hello policy that will be executed.</span></span> <span data-ttu-id="9e2cb-171">它是原則的 hello 的名稱 B2C 租用戶中建立。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-171">It is hello name of a policy that is created in your B2C tenant.</span></span> <span data-ttu-id="9e2cb-172">hello 原則名稱值開頭應該是`b2c\_1\_`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-172">hello policy name value should begin with `b2c\_1\_`.</span></span> <span data-ttu-id="9e2cb-173">了解原則與 hello[可延伸原則架構](active-directory-b2c-reference-policies.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-173">Learn more about policies and hello [extensible policy framework](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="9e2cb-174">prompt</span><span class="sxs-lookup"><span data-stu-id="9e2cb-174">prompt</span></span> |<span data-ttu-id="9e2cb-175">選用</span><span class="sxs-lookup"><span data-stu-id="9e2cb-175">Optional</span></span> |<span data-ttu-id="9e2cb-176">使用者互動所需的 hello 型別。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-176">hello type of user interaction that is required.</span></span> <span data-ttu-id="9e2cb-177">hello 唯一有效的值，這次是`login`，強制 hello 使用者 tooenter 他們在該要求的認證。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-177">hello only valid value at this time is `login`, which forces hello user tooenter their credentials on that request.</span></span> <span data-ttu-id="9e2cb-178">單一登入將沒有作用。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-178">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="9e2cb-179">此時，會要求 hello 使用者 toocomplete hello 原則的工作流程。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-179">At this point, hello user is asked toocomplete hello policy's workflow.</span></span> <span data-ttu-id="9e2cb-180">這可能涉及 hello 使用者輸入使用者名稱和密碼，登入社交身分識別，註冊 hello 目錄或其他任何數字的步驟，根據 hello 原則的定義方式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-180">This might involve hello user entering their username and password, signing in with a social identity, signing up for hello directory, or any other number of steps, depending on how hello policy is defined.</span></span>

<span data-ttu-id="9e2cb-181">Hello 使用者完成 hello 原則之後，Azure AD 會傳回回應 tooyour 應用程式，在指出的 hello`redirect_uri`參數，藉由指定 hello 中的 hello 方法`response_mode`參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-181">After hello user completes hello policy, Azure AD returns a response tooyour app at hello indicated `redirect_uri` parameter, by using hello method that is specified in hello `response_mode` parameter.</span></span> <span data-ttu-id="9e2cb-182">hello 回應 hello 上述情況下，獨立於 hello 原則執行的每個 hello 相同。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-182">hello response is hello same for each of hello preceding cases, independent of hello policy that is executed.</span></span>

<span data-ttu-id="9e2cb-183">使用 `response_mode=fragment` 的成功回應如下所示：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-183">A successful response using `response_mode=fragment` would look like:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="9e2cb-184">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-184">Parameter</span></span> | <span data-ttu-id="9e2cb-185">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-185">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-186">id_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-186">id_token</span></span> |<span data-ttu-id="9e2cb-187">hello hello 應用程式要求的 ID 語彙基元。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-187">hello ID token that hello app requested.</span></span> <span data-ttu-id="9e2cb-188">您可以使用 hello ID 語彙基元 tooverify hello 使用者的身分識別，並開始與 hello 使用者工作階段。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-188">You can use hello ID token tooverify hello user's identity and begin a session with hello user.</span></span> <span data-ttu-id="9e2cb-189">ID 語彙基元和其內容的更多詳細資料會包含在 hello [Azure AD B2C 權杖參照](active-directory-b2c-reference-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-189">More details on ID tokens and their contents are included in hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |
| <span data-ttu-id="9e2cb-190">code</span><span class="sxs-lookup"><span data-stu-id="9e2cb-190">code</span></span> |<span data-ttu-id="9e2cb-191">hello 授權碼 hello 應用程式要求，如果您使用`response_type=code+id_token`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-191">hello authorization code that hello app requested, if you used `response_type=code+id_token`.</span></span> <span data-ttu-id="9e2cb-192">hello 應用程式可用於目標資源的 hello 授權程式碼 toorequest 存取權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-192">hello app can use hello authorization code toorequest an access token for a target resource.</span></span> <span data-ttu-id="9e2cb-193">授權碼的存留期很短。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-193">Authorization codes are very short-lived.</span></span> <span data-ttu-id="9e2cb-194">通常會在大約 10 分鐘後過期。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-194">Typically, they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="9e2cb-195">state</span><span class="sxs-lookup"><span data-stu-id="9e2cb-195">state</span></span> |<span data-ttu-id="9e2cb-196">如果`state`參數包含在 hello 要求 hello 相同的值應該會出現在 hello 回應。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-196">If a `state` parameter is included in hello request, hello same value should appear in hello response.</span></span> <span data-ttu-id="9e2cb-197">hello 應用程式應該確認該 hello `state` hello 要求和回應中的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-197">hello app should verify that hello `state` values in hello request and response are identical.</span></span> |

<span data-ttu-id="9e2cb-198">錯誤回應也可以傳送 toohello`redirect_uri`參數，該 hello 應用程式可以適當地處理：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-198">Error responses can also be sent toohello `redirect_uri` parameter so that hello app can handle them appropriately:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="9e2cb-199">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-199">Parameter</span></span> | <span data-ttu-id="9e2cb-200">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-201">錯誤</span><span class="sxs-lookup"><span data-stu-id="9e2cb-201">error</span></span> |<span data-ttu-id="9e2cb-202">錯誤發生，而它可以是使用的 tooreact tooerrors 使用的 tooclassify 類型可能會錯誤程式碼字串。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-202">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="9e2cb-203">error_description</span><span class="sxs-lookup"><span data-stu-id="9e2cb-203">error_description</span></span> |<span data-ttu-id="9e2cb-204">特定的錯誤訊息，可協助開發人員會識別 hello 的驗證錯誤的根本原因。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-204">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |
| <span data-ttu-id="9e2cb-205">state</span><span class="sxs-lookup"><span data-stu-id="9e2cb-205">state</span></span> |<span data-ttu-id="9e2cb-206">請參閱本節中的 hello 第一個資料表中的 hello 完整描述。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-206">See hello full description in hello first table in this section.</span></span> <span data-ttu-id="9e2cb-207">如果`state`參數包含在 hello 要求 hello 相同的值應該會出現在 hello 回應。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-207">If a `state` parameter is included in hello request, hello same value should appear in hello response.</span></span> <span data-ttu-id="9e2cb-208">hello 應用程式應該確認該 hello `state` hello 要求和回應中的值完全相同。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-208">hello app should verify that hello `state` values in hello request and response are identical.</span></span> |

## <a name="validate-hello-id-token"></a><span data-ttu-id="9e2cb-209">驗證 hello 的 ID 語彙基元</span><span class="sxs-lookup"><span data-stu-id="9e2cb-209">Validate hello ID token</span></span>
<span data-ttu-id="9e2cb-210">只接收 ID 語彙基元不足夠 tooauthenticate hello 使用者。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-210">Just receiving an ID token is not enough tooauthenticate hello user.</span></span> <span data-ttu-id="9e2cb-211">您必須驗證 hello 識別碼權杖之簽章，並確認每個應用程式需求的 hello 權杖中的 hello 宣告。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-211">You must validate hello ID token's signature and verify hello claims in hello token per your app's requirements.</span></span> <span data-ttu-id="9e2cb-212">使用 azure AD B2C [JSON Web 權杖 (Jwt)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html)和公用金鑰密碼編譯 toosign 語彙基元，並確認都有效。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-212">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography toosign tokens and verify that they are valid.</span></span>

<span data-ttu-id="9e2cb-213">視您偏好的語言而定，有許多針對驗證 JWT 的開放原始碼程式庫可用。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-213">There are many open-source libraries that are available for validating JWTs, depending on your language of preference.</span></span> <span data-ttu-id="9e2cb-214">我們建議您探索這些程式庫，而不是實作您自己的驗證邏輯。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-214">We recommend exploring those options rather than implementing your own validation logic.</span></span> <span data-ttu-id="9e2cb-215">這裡 hello 資訊將有助於釐清 tooproperly 如何使用這些程式庫。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-215">hello information here will be useful in figuring out how tooproperly use those libraries.</span></span>

<span data-ttu-id="9e2cb-216">Azure AD B2C 所擁有的 OpenID Connect 中繼資料端點，可讓應用程式 toofetch 資訊需 Azure AD B2C 在執行階段。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-216">Azure AD B2C has an OpenID Connect metadata endpoint, which allows an app toofetch information about Azure AD B2C at runtime.</span></span> <span data-ttu-id="9e2cb-217">這項資訊包括端點、權杖內容和權杖簽署金鑰。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-217">This information includes endpoints, token contents, and token signing keys.</span></span> <span data-ttu-id="9e2cb-218">您的 B2C 租用戶中的每個原則都有一份 JSON 中繼資料文件。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-218">There is a JSON metadata document for each policy in your B2C tenant.</span></span> <span data-ttu-id="9e2cb-219">例如，hello 中繼資料文件以 hello`b2c_1_sign_in`中的原則`fabrikamb2c.onmicrosoft.com`位於：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-219">For example, hello metadata document for hello `b2c_1_sign_in` policy in `fabrikamb2c.onmicrosoft.com` is located at:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=b2c_1_sign_in`

<span data-ttu-id="9e2cb-220">此設定文件的 hello 屬性的其中一個是`jwks_uri`，其值會是相同的原則中的 hello:</span><span class="sxs-lookup"><span data-stu-id="9e2cb-220">One of hello properties of this configuration document is `jwks_uri`, whose value for hello same policy would be:</span></span>

<span data-ttu-id="9e2cb-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-221">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span></span>

<span data-ttu-id="9e2cb-222">toodetermine 哪些原則已用 ID 權杖簽章 （以及從 toofetch hello 中繼資料的位置），您有兩個選項。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-222">toodetermine which policy was used in signing an ID token (and from where toofetch hello metadata), you have two options.</span></span> <span data-ttu-id="9e2cb-223">首先，hello 原則名稱包含在 hello `acr` hello 識別碼權杖中宣告。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-223">First, hello policy name is included in hello `acr` claim in hello ID token.</span></span> <span data-ttu-id="9e2cb-224">如需 tooparse hello 從 ID 權杖的宣告資訊，請參閱 hello [Azure AD B2C 權杖參照](active-directory-b2c-reference-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-224">For information on how tooparse hello claims from an ID token, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="9e2cb-225">另一個選擇是 tooencode hello hello 值中的 hello 原則`state`時發出 hello 要求然後解碼的 toodetermine 哪些原則已使用的參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-225">Your other option is tooencode hello policy in hello value of hello `state` parameter when you issue hello request, and then decode it toodetermine which policy was used.</span></span> <span data-ttu-id="9e2cb-226">任一種方法都有效。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-226">Either method is valid.</span></span>

<span data-ttu-id="9e2cb-227">您已取得 hello 從 hello OpenID Connect 的中繼資料端點的中繼資料文件之後，您可以使用 hello RSA 256 公用金鑰 （也就是位於此端點） 的 hello 的 ID 語彙基元 toovalidate hello 簽章。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-227">After you've acquired hello metadata document from hello OpenID Connect metadata endpoint, you can use hello RSA 256 public keys (which are located at this endpoint) toovalidate hello signature of hello ID token.</span></span> <span data-ttu-id="9e2cb-228">此端點隨時都可能列出多個金鑰，每個金鑰都由 `kid` 宣告所識別。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-228">There might be multiple keys listed at this endpoint at any given point in time, each identified by a `kid` claim.</span></span> <span data-ttu-id="9e2cb-229">hello hello 的 ID 語彙基元的標頭也包含`kid`宣告，表示已使用的 toosign hello ID 語彙基元的這些索引鍵。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-229">hello header of hello ID token also contains a `kid` claim, which indicates which of these keys was used toosign hello ID token.</span></span> <span data-ttu-id="9e2cb-230">如需詳細資訊，請參閱 hello [Azure AD B2C 權杖參照](active-directory-b2c-reference-tokens.md)(hello 區段上[驗證權杖](active-directory-b2c-reference-tokens.md#token-validation)，尤其)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-230">For more information, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md) (hello section on [validating tokens](active-directory-b2c-reference-tokens.md#token-validation), in particular).</span></span>
<!--TODO: Improve hello information on this-->

<span data-ttu-id="9e2cb-231">您已驗證的 hello 的 ID 語彙基元的 hello 簽章之後，有數個您需要 tooverify 的宣告。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-231">After you've validated hello signature of hello ID token, there are several claims that you need tooverify.</span></span> <span data-ttu-id="9e2cb-232">例如：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-232">For instance:</span></span>

* <span data-ttu-id="9e2cb-233">您應該驗證 hello`nonce`宣告 tooprevent 權杖重新執行攻擊。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-233">You should validate hello `nonce` claim tooprevent token replay attacks.</span></span> <span data-ttu-id="9e2cb-234">其值必須為 hello 登入要求中指定的內容。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-234">Its value should be what you specified in hello sign-in request.</span></span>
* <span data-ttu-id="9e2cb-235">您應該驗證 hello`aud`宣告 hello 的 ID 語彙基元的 tooensure 發行的應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-235">You should validate hello `aud` claim tooensure that hello ID token was issued for your app.</span></span> <span data-ttu-id="9e2cb-236">其值必須為您的應用程式的 hello 應用程式識別碼。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-236">Its value should be hello application ID of your app.</span></span>
* <span data-ttu-id="9e2cb-237">您應該驗證 hello`iat`和`exp`hello 的 ID 語彙基元的 tooensure 尚未過期的宣告。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-237">You should validate hello `iat` and `exp` claims tooensure that hello ID token has not expired.</span></span>

<span data-ttu-id="9e2cb-238">另外還有數個您應該執行的驗證。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-238">There are also several more validations that you should perform.</span></span> <span data-ttu-id="9e2cb-239">在 hello 詳細說明這些[OpenID 連線核心規格](http://openid.net/specs/openid-connect-core-1_0.html)。Toovalidate 額外的宣告，也可以根據您的案例。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-239">These are described in detail in hello [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  You might also want toovalidate additional claims, depending on your scenario.</span></span> <span data-ttu-id="9e2cb-240">一些常見的驗證包括：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-240">Some common validations include:</span></span>

* <span data-ttu-id="9e2cb-241">確保的 hello 使用者組織已註冊 hello 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-241">Ensuring that hello user/organization has signed up for hello app.</span></span>
* <span data-ttu-id="9e2cb-242">確保該 hello 使用者具有適當的授權/權限。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-242">Ensuring that hello user has proper authorization/privileges.</span></span>
* <span data-ttu-id="9e2cb-243">確保驗證方式有一定的強度，例如 Azure Multi-Factor Authentication。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-243">Ensuring that a certain strength of authentication has occurred, such as Azure Multi-Factor Authentication.</span></span>

<span data-ttu-id="9e2cb-244">如需有關識別碼權杖中的 hello 宣告的詳細資訊，請參閱 hello [Azure AD B2C 權杖參照](active-directory-b2c-reference-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-244">For more information on hello claims in an ID token, see hello [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>

<span data-ttu-id="9e2cb-245">您已驗證 hello 的 ID 語彙基元之後，您可以開始工作階段與 hello 使用者。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-245">After you have validated hello ID token, you can begin a session with hello user.</span></span> <span data-ttu-id="9e2cb-246">您可以在 hello ID 語彙基元 tooobtain hello 使用者資訊，您的應用程式中使用 hello 宣告。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-246">You can use hello claims in hello ID token tooobtain information about hello user in your app.</span></span> <span data-ttu-id="9e2cb-247">這項資訊的用途包括顯示、記錄和授權。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-247">Uses for this information include display, records, and authorization.</span></span>

## <a name="get-a-token"></a><span data-ttu-id="9e2cb-248">取得權杖</span><span class="sxs-lookup"><span data-stu-id="9e2cb-248">Get a token</span></span>
<span data-ttu-id="9e2cb-249">如果您需要您的 web 應用程式 tooonly 執行原則，您可以略過 hello 接下來的章節。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-249">If you need your web app tooonly execute policies, you can skip hello next few sections.</span></span> <span data-ttu-id="9e2cb-250">這些區段分別是需要 toomake 驗證呼叫 tooa web API，也會受 Azure AD B2C 適用的唯一 tooweb 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-250">These sections are applicable only tooweb apps that need toomake authenticated calls tooa web API and are also protected by Azure AD B2C.</span></span>

<span data-ttu-id="9e2cb-251">您可以兌換 hello 貴用戶取得的授權碼 (使用`response_type=code+id_token`) 權杖 toohello 所需資源，藉由傳送`POST`要求 toohello`/token`端點。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-251">You can redeem hello authorization code that you acquired (by using `response_type=code+id_token`) for a token toohello desired resource by sending a `POST` request toohello `/token` endpoint.</span></span> <span data-ttu-id="9e2cb-252">目前，hello 您可以要求的語彙基元的資源是您的應用程式本身的後端 web 應用程式開發介面。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-252">Currently, hello only resource that you can request a token for is your app's own back-end web API.</span></span> <span data-ttu-id="9e2cb-253">要求語彙基元 tooyourself hello 慣例是的 toouse 應用程式的用戶端識別碼 hello 範圍為：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-253">hello convention for requesting a token tooyourself is toouse your app's client ID as hello scope:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>

```

| <span data-ttu-id="9e2cb-254">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-254">Parameter</span></span> | <span data-ttu-id="9e2cb-255">必要？</span><span class="sxs-lookup"><span data-stu-id="9e2cb-255">Required?</span></span> | <span data-ttu-id="9e2cb-256">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-256">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9e2cb-257">p</span><span class="sxs-lookup"><span data-stu-id="9e2cb-257">p</span></span> |<span data-ttu-id="9e2cb-258">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-258">Required</span></span> |<span data-ttu-id="9e2cb-259">hello 原則來使用的 tooacquire hello 授權程式碼。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-259">hello policy that was used tooacquire hello authorization code.</span></span> <span data-ttu-id="9e2cb-260">您無法在此要求中使用不同的原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-260">You cannot use a different policy in this request.</span></span> <span data-ttu-id="9e2cb-261">請注意，您會加入這個參數 toohello 查詢字串，不 toohello`POST`主體。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-261">Note that you add this parameter toohello query string, not toohello `POST` body.</span></span> |
| <span data-ttu-id="9e2cb-262">client_id</span><span class="sxs-lookup"><span data-stu-id="9e2cb-262">client_id</span></span> |<span data-ttu-id="9e2cb-263">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-263">Required</span></span> |<span data-ttu-id="9e2cb-264">hello 應用程式識別碼的 hello [Azure 入口網站](https://portal.azure.com/)指派 tooyour 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-264">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="9e2cb-265">grant_type</span><span class="sxs-lookup"><span data-stu-id="9e2cb-265">grant_type</span></span> |<span data-ttu-id="9e2cb-266">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-266">Required</span></span> |<span data-ttu-id="9e2cb-267">hello 的授與，必須是類型`authorization_code`的 hello 授權碼流程。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-267">hello type of grant, which must be `authorization_code` for hello authorization code flow.</span></span> |
| <span data-ttu-id="9e2cb-268">scope</span><span class="sxs-lookup"><span data-stu-id="9e2cb-268">scope</span></span> |<span data-ttu-id="9e2cb-269">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-269">Recommended</span></span> |<span data-ttu-id="9e2cb-270">範圍的空格分隔清單。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-270">A space-separated list of scopes.</span></span> <span data-ttu-id="9e2cb-271">單一領域值會指出 tooAzure AD 要求這兩個權限。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-271">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="9e2cb-272">hello`openid`範圍表示權限 toosign hello hello id_token 參數形式的 hello 使用者相關的使用者，以及如何取得資料中。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-272">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of id_token parameters.</span></span> <span data-ttu-id="9e2cb-273">它可以是使用的 tooget 語彙基元 tooyour 應用程式本身的後端 web 應用程式開發介面，由 hello 表示相同的應用程式識別碼 hello 用戶端。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-273">It can be used tooget tokens tooyour app's own back-end web API, which is represented by hello same application ID as hello client.</span></span> <span data-ttu-id="9e2cb-274">hello`offline_access`範圍表示您的應用程式，將會需要長時間執行的存取 tooresources 重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-274">hello `offline_access` scope indicates that your app will need a refresh token for long-lived access tooresources.</span></span> |
| <span data-ttu-id="9e2cb-275">code</span><span class="sxs-lookup"><span data-stu-id="9e2cb-275">code</span></span> |<span data-ttu-id="9e2cb-276">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-276">Required</span></span> |<span data-ttu-id="9e2cb-277">貴用戶取得 hello 流程 hello 第一個階段中的 hello 授權碼。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-277">hello authorization code that you acquired in hello first leg of hello flow.</span></span> |
| <span data-ttu-id="9e2cb-278">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="9e2cb-278">redirect_uri</span></span> |<span data-ttu-id="9e2cb-279">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-279">Required</span></span> |<span data-ttu-id="9e2cb-280">hello `redirect_uri` hello 應用程式，您收到 hello 授權程式碼的參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-280">hello `redirect_uri` parameter of hello application where you received hello authorization code.</span></span> |
| <span data-ttu-id="9e2cb-281">client_secret</span><span class="sxs-lookup"><span data-stu-id="9e2cb-281">client_secret</span></span> |<span data-ttu-id="9e2cb-282">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-282">Required</span></span> |<span data-ttu-id="9e2cb-283">您在 hello 中產生的 hello 應用程式密碼[Azure 入口網站](https://portal.azure.com/)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-283">hello application secret that you generated in hello [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="9e2cb-284">這個應用程式密碼是重要的安全性構件，</span><span class="sxs-lookup"><span data-stu-id="9e2cb-284">This application secret is an important security artifact.</span></span> <span data-ttu-id="9e2cb-285">您應該要用安全的方法把它儲存在您的伺服器上。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-285">You should store it securely on your server.</span></span> <span data-ttu-id="9e2cb-286">您也應該定期輪換此用戶端祕密。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-286">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="9e2cb-287">成功的權杖回應看起來如下：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-287">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="9e2cb-288">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-288">Parameter</span></span> | <span data-ttu-id="9e2cb-289">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-289">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-290">not_before</span><span class="sxs-lookup"><span data-stu-id="9e2cb-290">not_before</span></span> |<span data-ttu-id="9e2cb-291">hello 時間在哪一個 hello 語彙基元會被視為有效的在 epoch 時間。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-291">hello time at which hello token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="9e2cb-292">token_type</span><span class="sxs-lookup"><span data-stu-id="9e2cb-292">token_type</span></span> |<span data-ttu-id="9e2cb-293">hello 語彙基元型別值。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-293">hello token type value.</span></span> <span data-ttu-id="9e2cb-294">hello Azure AD 支援的類型`Bearer`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-294">hello only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="9e2cb-295">access_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-295">access_token</span></span> |<span data-ttu-id="9e2cb-296">hello 簽署 JWT 權杖要求。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-296">hello signed JWT token that you requested.</span></span> |
| <span data-ttu-id="9e2cb-297">scope</span><span class="sxs-lookup"><span data-stu-id="9e2cb-297">scope</span></span> |<span data-ttu-id="9e2cb-298">hello 的 hello 權杖是有效的範圍。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-298">hello scopes for which hello token is valid.</span></span> <span data-ttu-id="9e2cb-299">這些可用來快取權杖，供以後使用。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-299">These can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="9e2cb-300">expires_in</span><span class="sxs-lookup"><span data-stu-id="9e2cb-300">expires_in</span></span> |<span data-ttu-id="9e2cb-301">hello hello 存取權杖的時間長度 （以秒為單位） 無效。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-301">hello length of time that hello access token is valid (in seconds).</span></span> |
| <span data-ttu-id="9e2cb-302">refresh_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-302">refresh_token</span></span> |<span data-ttu-id="9e2cb-303">OAuth 2.0 重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-303">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="9e2cb-304">hello 目前的語彙基元過期之後，hello 應用程式可以使用這個語彙基元 tooacquire 其他語彙基元。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-304">hello app can use this token tooacquire additional tokens after hello current token expires.</span></span> <span data-ttu-id="9e2cb-305">重新整理權杖存留較久，而且可以是使用的 tooretain 存取 tooresources 很長的時間。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-305">Refresh tokens are long-lived and can be used tooretain access tooresources for extended periods of time.</span></span> <span data-ttu-id="9e2cb-306">如需詳細資訊，請參閱 toohello [B2C 權杖參照](active-directory-b2c-reference-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-306">For more details, refer toohello [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="9e2cb-307">請注意，您必須擁有使用 hello 範圍`offline_access`在 hello 授權和語彙基元要求順序 tooreceive 中重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-307">Note that you must have used hello scope `offline_access` in both hello authorization and token requests in order tooreceive a refresh token.</span></span> |

<span data-ttu-id="9e2cb-308">錯誤回應看起來如下：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-308">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "hello user revoked access toohello app.",
}
```

| <span data-ttu-id="9e2cb-309">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-309">Parameter</span></span> | <span data-ttu-id="9e2cb-310">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-310">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-311">錯誤</span><span class="sxs-lookup"><span data-stu-id="9e2cb-311">error</span></span> |<span data-ttu-id="9e2cb-312">錯誤發生，而它可以是使用的 tooreact tooerrors 使用的 tooclassify 類型可能會錯誤程式碼字串。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-312">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="9e2cb-313">error_description</span><span class="sxs-lookup"><span data-stu-id="9e2cb-313">error_description</span></span> |<span data-ttu-id="9e2cb-314">特定的錯誤訊息，可協助開發人員會識別 hello 的驗證錯誤的根本原因。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-314">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |

## <a name="use-hello-token"></a><span data-ttu-id="9e2cb-315">使用 hello 語彙基元</span><span class="sxs-lookup"><span data-stu-id="9e2cb-315">Use hello token</span></span>
<span data-ttu-id="9e2cb-316">既然您已成功取得存取權杖，您可以使用要求 tooyour 後端 web 應用程式開發介面的 hello 語彙基元併入 hello`Authorization`標頭：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-316">Now that you've successfully acquired an access token, you can use hello token in requests tooyour back-end web APIs by including it in hello `Authorization` header:</span></span>

```
GET /tasks
Host: https://mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="refresh-hello-token"></a><span data-ttu-id="9e2cb-317">重新整理 hello 語彙基元</span><span class="sxs-lookup"><span data-stu-id="9e2cb-317">Refresh hello token</span></span>
<span data-ttu-id="9e2cb-318">識別碼權杖只會短暫存在。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-318">ID tokens are short-lived.</span></span> <span data-ttu-id="9e2cb-319">在到期 toocontinue 所能 tooaccess 資源之後，您必須更新它們。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-319">You must refresh them after they expire toocontinue being able tooaccess resources.</span></span> <span data-ttu-id="9e2cb-320">您可以藉由送出另一個`POST`要求 toohello`/token`端點。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-320">You can do so by submitting another `POST` request toohello `/token` endpoint.</span></span> <span data-ttu-id="9e2cb-321">此時，提供 hello`refresh_token`參數而 hello`code`參數：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-321">This time, provide hello `refresh_token` parameter instead of hello `code` parameter:</span></span>

```
POST fabrikamb2c.onmicrosoft.com/oauth2/v2.0/token?p=b2c_1_sign_in HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=openid offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob&client_secret=<your-application-secret>
```

| <span data-ttu-id="9e2cb-322">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-322">Parameter</span></span> | <span data-ttu-id="9e2cb-323">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-323">Required</span></span> | <span data-ttu-id="9e2cb-324">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-324">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9e2cb-325">p</span><span class="sxs-lookup"><span data-stu-id="9e2cb-325">p</span></span> |<span data-ttu-id="9e2cb-326">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-326">Required</span></span> |<span data-ttu-id="9e2cb-327">已使用的 tooacquire hello 原始重新整理權杖的 hello 原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-327">hello policy that was used tooacquire hello original refresh token.</span></span> <span data-ttu-id="9e2cb-328">您無法在此要求中使用不同的原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-328">You cannot use a different policy in this request.</span></span> <span data-ttu-id="9e2cb-329">請注意，您會加入這個參數 toohello 查詢字串、 toohello POST 本文。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-329">Note that you add this parameter toohello query string, not toohello POST body.</span></span> |
| <span data-ttu-id="9e2cb-330">client_id</span><span class="sxs-lookup"><span data-stu-id="9e2cb-330">client_id</span></span> |<span data-ttu-id="9e2cb-331">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-331">Required</span></span> |<span data-ttu-id="9e2cb-332">hello 應用程式識別碼的 hello [Azure 入口網站](https://portal.azure.com/)指派 tooyour 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-332">hello application ID that hello [Azure portal](https://portal.azure.com/) assigned tooyour app.</span></span> |
| <span data-ttu-id="9e2cb-333">grant_type</span><span class="sxs-lookup"><span data-stu-id="9e2cb-333">grant_type</span></span> |<span data-ttu-id="9e2cb-334">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-334">Required</span></span> |<span data-ttu-id="9e2cb-335">授與，必須重新整理權杖的此階段的 hello 授權碼流程 hello 型別。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-335">hello type of grant, which must be a refresh token for this leg of hello authorization code flow.</span></span> |
| <span data-ttu-id="9e2cb-336">scope</span><span class="sxs-lookup"><span data-stu-id="9e2cb-336">scope</span></span> |<span data-ttu-id="9e2cb-337">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-337">Recommended</span></span> |<span data-ttu-id="9e2cb-338">範圍的空格分隔清單。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-338">A space-separated list of scopes.</span></span> <span data-ttu-id="9e2cb-339">單一領域值會指出 tooAzure AD 要求這兩個權限。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-339">A single scope value indicates tooAzure AD both permissions that are being requested.</span></span> <span data-ttu-id="9e2cb-340">hello`openid`範圍表示權限 toosign hello hello 表單的 ID 語彙基元中的 hello 使用者相關的使用者，以及如何取得資料中。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-340">hello `openid` scope indicates a permission toosign in hello user and get data about hello user in hello form of ID tokens.</span></span> <span data-ttu-id="9e2cb-341">它可以是使用的 tooget 語彙基元 tooyour 應用程式本身的後端 web 應用程式開發介面，由 hello 表示相同的應用程式識別碼 hello 用戶端。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-341">It can be used tooget tokens tooyour app's own back-end web API, which is represented by hello same application ID as hello client.</span></span> <span data-ttu-id="9e2cb-342">hello`offline_access`範圍表示您的應用程式，將會需要長時間執行的存取 tooresources 重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-342">hello `offline_access` scope indicates that your app will need a refresh token for long-lived access tooresources.</span></span> |
| <span data-ttu-id="9e2cb-343">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="9e2cb-343">redirect_uri</span></span> |<span data-ttu-id="9e2cb-344">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-344">Recommended</span></span> |<span data-ttu-id="9e2cb-345">hello `redirect_uri` hello 應用程式，您收到 hello 授權程式碼的參數。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-345">hello `redirect_uri` parameter of hello application where you received hello authorization code.</span></span> |
| <span data-ttu-id="9e2cb-346">refresh_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-346">refresh_token</span></span> |<span data-ttu-id="9e2cb-347">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-347">Required</span></span> |<span data-ttu-id="9e2cb-348">hello 原始重新整理語彙基元，貴用戶取得 hello 流程 hello 第二個階段中。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-348">hello original refresh token that you acquired in hello second leg of hello flow.</span></span> <span data-ttu-id="9e2cb-349">請注意，您必須擁有使用 hello 範圍`offline_access`在 hello 授權和語彙基元要求順序 tooreceive 中重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-349">Note that you must have used hello scope `offline_access` in both hello authorization and token requests in order tooreceive a refresh token.</span></span> |
| <span data-ttu-id="9e2cb-350">client_secret</span><span class="sxs-lookup"><span data-stu-id="9e2cb-350">client_secret</span></span> |<span data-ttu-id="9e2cb-351">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-351">Required</span></span> |<span data-ttu-id="9e2cb-352">您在 hello 中產生的 hello 應用程式密碼[Azure 入口網站](https://portal.azure.com/)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-352">hello application secret that you generated in hello [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="9e2cb-353">這個應用程式密碼是重要的安全性構件，</span><span class="sxs-lookup"><span data-stu-id="9e2cb-353">This application secret is an important security artifact.</span></span> <span data-ttu-id="9e2cb-354">您應該要用安全的方法把它儲存在您的伺服器上。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-354">You should store it securely on your server.</span></span> <span data-ttu-id="9e2cb-355">您也應該定期輪換此用戶端祕密。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-355">You should also rotate this client secret on a periodic basis.</span></span> |

<span data-ttu-id="9e2cb-356">成功的權杖回應看起來如下：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-356">A successful token response looks like:</span></span>

```
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```
| <span data-ttu-id="9e2cb-357">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-357">Parameter</span></span> | <span data-ttu-id="9e2cb-358">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-358">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-359">not_before</span><span class="sxs-lookup"><span data-stu-id="9e2cb-359">not_before</span></span> |<span data-ttu-id="9e2cb-360">hello 時間在哪一個 hello 語彙基元會被視為有效的在 epoch 時間。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-360">hello time at which hello token is considered valid, in epoch time.</span></span> |
| <span data-ttu-id="9e2cb-361">token_type</span><span class="sxs-lookup"><span data-stu-id="9e2cb-361">token_type</span></span> |<span data-ttu-id="9e2cb-362">hello 語彙基元型別值。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-362">hello token type value.</span></span> <span data-ttu-id="9e2cb-363">hello Azure AD 支援的類型`Bearer`。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-363">hello only type that Azure AD supports is `Bearer`.</span></span> |
| <span data-ttu-id="9e2cb-364">access_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-364">access_token</span></span> |<span data-ttu-id="9e2cb-365">hello 簽署 JWT 權杖要求。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-365">hello signed JWT token that you requested.</span></span> |
| <span data-ttu-id="9e2cb-366">scope</span><span class="sxs-lookup"><span data-stu-id="9e2cb-366">scope</span></span> |<span data-ttu-id="9e2cb-367">hello 語彙基元的 hello 範圍是有效的它可以用來快取權杖供以後使用。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-367">hello scope that hello token is valid for, which can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="9e2cb-368">expires_in</span><span class="sxs-lookup"><span data-stu-id="9e2cb-368">expires_in</span></span> |<span data-ttu-id="9e2cb-369">hello hello 存取權杖的時間長度 （以秒為單位） 無效。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-369">hello length of time that hello access token is valid (in seconds).</span></span> |
| <span data-ttu-id="9e2cb-370">refresh_token</span><span class="sxs-lookup"><span data-stu-id="9e2cb-370">refresh_token</span></span> |<span data-ttu-id="9e2cb-371">OAuth 2.0 重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-371">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="9e2cb-372">hello 目前的語彙基元過期之後，hello 應用程式可以使用這個語彙基元 tooacquire 其他語彙基元。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-372">hello app can use this token tooacquire additional tokens after hello current token expires.</span></span>  <span data-ttu-id="9e2cb-373">重新整理權杖存留較久，而且可以是使用的 tooretain 存取 tooresources 很長的時間。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-373">Refresh tokens are long-lived and can be used tooretain access tooresources for extended periods of time.</span></span> <span data-ttu-id="9e2cb-374">如需詳細資訊，請參閱 toohello [B2C 權杖參照](active-directory-b2c-reference-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-374">For more detail, refer toohello [B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |

<span data-ttu-id="9e2cb-375">錯誤回應看起來如下：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-375">Error responses look like:</span></span>

```
{
    "error": "access_denied",
    "error_description": "hello user revoked access toohello app.",
}
```

| <span data-ttu-id="9e2cb-376">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-376">Parameter</span></span> | <span data-ttu-id="9e2cb-377">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-377">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9e2cb-378">錯誤</span><span class="sxs-lookup"><span data-stu-id="9e2cb-378">error</span></span> |<span data-ttu-id="9e2cb-379">錯誤發生，而它可以是使用的 tooreact tooerrors 使用的 tooclassify 類型可能會錯誤程式碼字串。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-379">An error-code string that can be used tooclassify types of errors that occur and that can be used tooreact tooerrors.</span></span> |
| <span data-ttu-id="9e2cb-380">error_description</span><span class="sxs-lookup"><span data-stu-id="9e2cb-380">error_description</span></span> |<span data-ttu-id="9e2cb-381">特定的錯誤訊息，可協助開發人員會識別 hello 的驗證錯誤的根本原因。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-381">A specific error message that can help a developer identify hello root cause of an authentication error.</span></span> |

## <a name="send-a-sign-out-request"></a><span data-ttu-id="9e2cb-382">傳送登出要求</span><span class="sxs-lookup"><span data-stu-id="9e2cb-382">Send a sign-out request</span></span>
<span data-ttu-id="9e2cb-383">當您想 toosign hello 使用者登出 hello 應用程式時，您的應用程式 cookie 是不足 tooclear 或否則結束 hello 與 hello 使用者的工作階段。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-383">When you want toosign hello user out of hello app, it is not enough tooclear your app's cookies or otherwise end hello session with hello user.</span></span> <span data-ttu-id="9e2cb-384">您也必須重新導向 hello 使用者 tooAzure AD toosign 出。如果您讓容錯 toodo，hello 使用者可能無法 tooreauthenticate tooyour 應用程式，而不需重新輸入其認證。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-384">You must also redirect hello user tooAzure AD toosign out. If you fail toodo so, hello user might be able tooreauthenticate tooyour app without entering their credentials again.</span></span> <span data-ttu-id="9e2cb-385">這是因為使用者將擁有有效的 Azure AD 單一登入工作階段。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-385">This is because they will have a valid single sign-on session with Azure AD.</span></span>

<span data-ttu-id="9e2cb-386">您可以只是重新導向 hello 使用者 toohello `end_session` hello OpenID Connect 的中繼資料文件中所列的端點稍早所述 hello 「 驗證 hello 的 ID 語彙基元 」 一節：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-386">You can simply redirect hello user toohello `end_session` endpoint that is listed in hello OpenID Connect metadata document described earlier in hello "Validate hello ID token" section:</span></span>

```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?
p=b2c_1_sign_in
&post_logout_redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
```

| <span data-ttu-id="9e2cb-387">參數</span><span class="sxs-lookup"><span data-stu-id="9e2cb-387">Parameter</span></span> | <span data-ttu-id="9e2cb-388">必要？</span><span class="sxs-lookup"><span data-stu-id="9e2cb-388">Required?</span></span> | <span data-ttu-id="9e2cb-389">說明</span><span class="sxs-lookup"><span data-stu-id="9e2cb-389">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9e2cb-390">p</span><span class="sxs-lookup"><span data-stu-id="9e2cb-390">p</span></span> |<span data-ttu-id="9e2cb-391">必要</span><span class="sxs-lookup"><span data-stu-id="9e2cb-391">Required</span></span> |<span data-ttu-id="9e2cb-392">您要從您的應用程式的 toouse toosign hello 使用者 hello 原則。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-392">hello policy that you want toouse toosign hello user out of your application.</span></span> |
| <span data-ttu-id="9e2cb-393">post_logout_redirect_uri</span><span class="sxs-lookup"><span data-stu-id="9e2cb-393">post_logout_redirect_uri</span></span> |<span data-ttu-id="9e2cb-394">建議</span><span class="sxs-lookup"><span data-stu-id="9e2cb-394">Recommended</span></span> |<span data-ttu-id="9e2cb-395">hello URL hello 使用者應重新導向的 tooafter 成功登出。如果您未包含，Azure AD B2C 顯示 hello 使用者一般訊息。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-395">hello URL that hello user should be redirected tooafter successful sign-out. If it is not included, Azure AD B2C shows hello user a generic message.</span></span> |

> [!NOTE]
> <span data-ttu-id="9e2cb-396">雖然導向 hello 使用者 toohello`end_session`端點將會清除某些 hello 使用者單一登入狀態與 Azure AD B2C，它都不會簽署 hello 使用者登出其社交身分識別提供者 (IDP) 工作階段。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-396">Although directing hello user toohello `end_session` endpoint will clear some of hello user's single sign-on state with Azure AD B2C, it will not sign hello user out of their social identity provider (IDP) session.</span></span> <span data-ttu-id="9e2cb-397">如果 hello 使用者選取相同的 IDP hello 在後續登入時，他們將會重新驗證，而不需輸入他們的認證。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-397">If hello user selects hello same IDP during a subsequent sign-in, they will be reauthenticated, without entering their credentials.</span></span> <span data-ttu-id="9e2cb-398">如果使用者想 toosign B2C 應用程式時，它不一定表示他們想 toosign 超出其 Facebook 帳戶。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-398">If a user wants toosign out of your B2C application, it does not necessarily mean they want toosign out of their Facebook account.</span></span> <span data-ttu-id="9e2cb-399">不過，在 hello 案例中的本機帳戶，hello 使用者工作階段即將結束正確。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-399">However, in hello case of local accounts, hello user's session will be ended properly.</span></span>
> 
> 

## <a name="use-your-own-b2c-tenant"></a><span data-ttu-id="9e2cb-400">使用您自己的 B2C 租用戶</span><span class="sxs-lookup"><span data-stu-id="9e2cb-400">Use your own B2C tenant</span></span>
<span data-ttu-id="9e2cb-401">如果您想 tootry 這些要求自行，您必須先執行這三個步驟，並接著取代稍早所述，使用您自己的 hello 範例值：</span><span class="sxs-lookup"><span data-stu-id="9e2cb-401">If you want tootry these requests for yourself, you must first perform these three steps, and then replace hello example values described earlier with your own:</span></span>

1. <span data-ttu-id="9e2cb-402">[建立 B2C 租用戶](active-directory-b2c-get-started.md)，並使用您的租用戶的 hello 名稱 hello 要求中。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-402">[Create a B2C tenant](active-directory-b2c-get-started.md), and use hello name of your tenant in hello requests.</span></span>
2. <span data-ttu-id="9e2cb-403">[建立應用程式](active-directory-b2c-app-registration.md)tooobtain 應用程式識別碼。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-403">[Create an application](active-directory-b2c-app-registration.md) tooobtain an application ID.</span></span> <span data-ttu-id="9e2cb-404">在應用程式中加入 Web 應用程式/Web API。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-404">Include a web app/web API in your app.</span></span> <span data-ttu-id="9e2cb-405">也可以選擇建立應用程式祕密。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-405">Optionally, create an application secret.</span></span>
3. <span data-ttu-id="9e2cb-406">[建立您的原則](active-directory-b2c-reference-policies.md)tooobtain 原則名稱。</span><span class="sxs-lookup"><span data-stu-id="9e2cb-406">[Create your policies](active-directory-b2c-reference-policies.md) tooobtain your policy names.</span></span>

