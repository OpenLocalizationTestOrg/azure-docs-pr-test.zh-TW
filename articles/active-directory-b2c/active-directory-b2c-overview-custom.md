---
title: "Azure Active Directory B2C：自訂原則 | Microsoft Docs"
description: "Azure Active Directory B2C 自訂原則的主題"
services: active-directory-b2c
documentationcenter: 
author: parakhj
manager: krassk
editor: parakhj
ms.assetid: 1ff398a4-2079-4615-94f1-57de22c0aad6
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.topic: article
ms.devlang: na
ms.date: 04/04/2017
ms.author: parakhj
ms.openlocfilehash: 33f62a33ea7a3fadb6e7b045de10df25f5edbe83
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="azure-active-directory-b2c-custom-policies"></a><span data-ttu-id="285d7-103">Azure Active Directory B2C：自訂原則</span><span class="sxs-lookup"><span data-stu-id="285d7-103">Azure Active Directory B2C: Custom policies</span></span>

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

## <a name="what-are-custom-policies"></a><span data-ttu-id="285d7-104">何謂自訂原則？</span><span class="sxs-lookup"><span data-stu-id="285d7-104">What are custom policies?</span></span>

<span data-ttu-id="285d7-105">自訂原則是定義 Azure AD B2C 租用戶行為的組態檔。</span><span class="sxs-lookup"><span data-stu-id="285d7-105">Custom policies are configuration files that define the behavior of your Azure AD B2C tenant.</span></span> <span data-ttu-id="285d7-106">Azure AD B2C 入口網站已經為最常用的身分識別工作預先定義**內建原則**，而自訂原則完全可以由身分識別開發人員編輯，可完成的工作數量幾乎沒有限制。</span><span class="sxs-lookup"><span data-stu-id="285d7-106">Whereas **built-in policies** are predefined in the Azure AD B2C portal for the most common identity tasks, custom policies can be fully edited by an identity developer to complete a near unlimited number of tasks.</span></span> <span data-ttu-id="285d7-107">請繼續閱讀，以判斷自訂原則否是適合您和您的身分識別案例。</span><span class="sxs-lookup"><span data-stu-id="285d7-107">Read on to determine if custom policies are right for you and your identity scenario.</span></span>

<span data-ttu-id="285d7-108">**編輯自訂原則並不適合每個人。**</span><span class="sxs-lookup"><span data-stu-id="285d7-108">**Custom policy editing is not for everyone.**</span></span> <span data-ttu-id="285d7-109">學習曲線較辛苦、剛開始的摸索時間較長，未來對自訂原則的變更也需要類似的專業知識來維護。</span><span class="sxs-lookup"><span data-stu-id="285d7-109">The learning curve is demanding, the startup time is longer, and future changes to custom policies will require similar expertise to maintain.</span></span> <span data-ttu-id="285d7-110">使用自訂原則之前，應該謹慎考量優先在您的案例中使用內建原則。</span><span class="sxs-lookup"><span data-stu-id="285d7-110">Built-in policies should be carefully considered first for your scenario before using custom policies.</span></span>

## <a name="comparing-built-in-policies-and-custom-policies"></a><span data-ttu-id="285d7-111">比較內建原則和自訂原則</span><span class="sxs-lookup"><span data-stu-id="285d7-111">Comparing built-in policies and custom policies</span></span>

| | <span data-ttu-id="285d7-112">內建原則</span><span class="sxs-lookup"><span data-stu-id="285d7-112">Built-in policies</span></span> | <span data-ttu-id="285d7-113">自訂原則</span><span class="sxs-lookup"><span data-stu-id="285d7-113">Custom policies</span></span> |
|-|-------------------|-----------------|
|<span data-ttu-id="285d7-114">目標使用者</span><span class="sxs-lookup"><span data-stu-id="285d7-114">Target users</span></span> | <span data-ttu-id="285d7-115">所有具備或不具備身分識別專業知識的應用程式開發人員</span><span class="sxs-lookup"><span data-stu-id="285d7-115">All app developers with or without identity expertise</span></span> | <span data-ttu-id="285d7-116">身分識別專業人員︰系統整合人員、顧問和內部身分識別小組。</span><span class="sxs-lookup"><span data-stu-id="285d7-116">Identity pros: systems integrators, consultants and in-house identity teams.</span></span> <span data-ttu-id="285d7-117">他們熟悉 OpenIDConnect 流程，也了解身分識別提供者和宣告型驗證</span><span class="sxs-lookup"><span data-stu-id="285d7-117">They are comfortable with OpenIDConnect flows, and understand identity providers and claims-based authentication</span></span> |
|<span data-ttu-id="285d7-118">設定方法</span><span class="sxs-lookup"><span data-stu-id="285d7-118">Configuration method</span></span> | <span data-ttu-id="285d7-119">有 UI 方便使用的 Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="285d7-119">Azure portal with a user-friendly UI</span></span> | <span data-ttu-id="285d7-120">直接編輯 XML 檔案，然後上傳至 Azure 入口網站</span><span class="sxs-lookup"><span data-stu-id="285d7-120">Directly editing XML files and then uploading to the Azure portal</span></span> |
|<span data-ttu-id="285d7-121">UI 自訂</span><span class="sxs-lookup"><span data-stu-id="285d7-121">UI customization</span></span> | <span data-ttu-id="285d7-122">完整的 UI 自訂，包括 HTML、CSS 和 jscript 支援 (需要自訂網域)</span><span class="sxs-lookup"><span data-stu-id="285d7-122">Full UI customization, including HTML, CSS, and jscript support(requires custom domain)</span></span><br><br><span data-ttu-id="285d7-123">使用自訂字串支援多語言</span><span class="sxs-lookup"><span data-stu-id="285d7-123">Multilanguage support with Custom strings</span></span> | <span data-ttu-id="285d7-124">相同</span><span class="sxs-lookup"><span data-stu-id="285d7-124">Same</span></span> |
| <span data-ttu-id="285d7-125">屬性自訂</span><span class="sxs-lookup"><span data-stu-id="285d7-125">Attribute customization</span></span> | <span data-ttu-id="285d7-126">標準和自訂屬性</span><span class="sxs-lookup"><span data-stu-id="285d7-126">Standard and custom attributes</span></span> | <span data-ttu-id="285d7-127">相同</span><span class="sxs-lookup"><span data-stu-id="285d7-127">Same</span></span> |
|<span data-ttu-id="285d7-128">權杖和工作階段管理</span><span class="sxs-lookup"><span data-stu-id="285d7-128">Token and session management</span></span> | <span data-ttu-id="285d7-129">自訂權杖和多個工作階段選項</span><span class="sxs-lookup"><span data-stu-id="285d7-129">Custom token and multiple session options</span></span> | <span data-ttu-id="285d7-130">相同</span><span class="sxs-lookup"><span data-stu-id="285d7-130">Same</span></span> |
|<span data-ttu-id="285d7-131">識別提供者</span><span class="sxs-lookup"><span data-stu-id="285d7-131">Identity Providers</span></span>| <span data-ttu-id="285d7-132">**目前**︰預先定義的本機、社交提供者</span><span class="sxs-lookup"><span data-stu-id="285d7-132">**Today**: predefined local, social provider</span></span><br><br><span data-ttu-id="285d7-133">**未來**︰標準式 OIDC、SAML、OAuth</span><span class="sxs-lookup"><span data-stu-id="285d7-133">**Future**: Standards-based OIDC, SAML, OAuth</span></span> | <span data-ttu-id="285d7-134">**目前**：標準式 OIDC、OAUTH、SAML</span><span class="sxs-lookup"><span data-stu-id="285d7-134">**Today**: Standards-based OIDC, OAUTH, SAML</span></span><br><br><span data-ttu-id="285d7-135">**未來**：WsFed</span><span class="sxs-lookup"><span data-stu-id="285d7-135">**Future**: WsFed</span></span> |
|<span data-ttu-id="285d7-136">身分識別工作 (範例)</span><span class="sxs-lookup"><span data-stu-id="285d7-136">Identity Tasks (examples)</span></span> | <span data-ttu-id="285d7-137">使用本機和許多社交帳戶註冊或登入</span><span class="sxs-lookup"><span data-stu-id="285d7-137">Signup or SignIn with local and many social accounts</span></span><br><br><span data-ttu-id="285d7-138">自助式密碼重設</span><span class="sxs-lookup"><span data-stu-id="285d7-138">Self-Service Password Reset</span></span><br><br><span data-ttu-id="285d7-139">設定檔編輯</span><span class="sxs-lookup"><span data-stu-id="285d7-139">Profile Edit</span></span><br><br><span data-ttu-id="285d7-140">Multi-Factor Auth 案例</span><span class="sxs-lookup"><span data-stu-id="285d7-140">Multi-Factor Auth scenarios</span></span><br><br><span data-ttu-id="285d7-141">自訂權杖和工作階段</span><span class="sxs-lookup"><span data-stu-id="285d7-141">Customize Tokens and sessions</span></span><br><br><span data-ttu-id="285d7-142">存取權杖流程</span><span class="sxs-lookup"><span data-stu-id="285d7-142">Access Token flows</span></span> | <span data-ttu-id="285d7-143">使用自訂識別提供者完成與內建原則相同的工作，或使用自訂範圍</span><span class="sxs-lookup"><span data-stu-id="285d7-143">Complete the same tasks as built-in policies using custom identity providers or use custom scopes</span></span><br><br><span data-ttu-id="285d7-144">註冊時將使用者佈建在另一個系統中</span><span class="sxs-lookup"><span data-stu-id="285d7-144">Provision user in another system at the time of registration</span></span><br><br><span data-ttu-id="285d7-145">使用您自己的電子郵件服務提供者傳送歡迎電子郵件</span><span class="sxs-lookup"><span data-stu-id="285d7-145">Send a welcome email using your own email service provider</span></span><br><br><span data-ttu-id="285d7-146">使用 B2C 外部的使用者存放區</span><span class="sxs-lookup"><span data-stu-id="285d7-146">Use a user store outside B2C</span></span><br><br><span data-ttu-id="285d7-147">透過 API 向受信任的系統驗證使用者所提供的資訊</span><span class="sxs-lookup"><span data-stu-id="285d7-147">Validate user provided information with a trusted system via API</span></span> |

## <a name="policy-files"></a><span data-ttu-id="285d7-148">原則檔</span><span class="sxs-lookup"><span data-stu-id="285d7-148">Policy files</span></span>

<span data-ttu-id="285d7-149">自訂原則以一或多個 XML 格式的檔案表示，各檔案在階層鏈中彼此參考。</span><span class="sxs-lookup"><span data-stu-id="285d7-149">A custom policy is represented as one or several XML-formatted files which refer to each other in a hierarchical chain.</span></span> <span data-ttu-id="285d7-150">XML 元素定義︰宣告結構描述、宣告轉換、內容定義、宣告提供者/技術設定檔和 Userjourney 協調流程步驟等元素。</span><span class="sxs-lookup"><span data-stu-id="285d7-150">The XML elements define: Claims schema, claims transformations, content definitions, claims providers/technical profiles, and Userjourney orchestration steps, among other elements.</span></span>

<span data-ttu-id="285d7-151">我們建議使用三種類型的原則檔︰</span><span class="sxs-lookup"><span data-stu-id="285d7-151">We recommend the use of three types of policy files:</span></span>

- <span data-ttu-id="285d7-152">**基底檔案**，其中包含大部分的定義，Azure 有提供完整的範例。</span><span class="sxs-lookup"><span data-stu-id="285d7-152">**A BASE file**, which contains most of the definitions and for which Azure provides a complete sample.</span></span>  <span data-ttu-id="285d7-153">建議您儘可能不要變更這個檔案，才有利於原則的疑難排解和長期維護</span><span class="sxs-lookup"><span data-stu-id="285d7-153">We recommend you make a minimum number of changes to this file to help with troubleshooting, and long-term maintenance of your policies</span></span>
- <span data-ttu-id="285d7-154">**擴充檔案**，其中保存租用戶的唯一組態變更</span><span class="sxs-lookup"><span data-stu-id="285d7-154">**an EXTensions file** that holds the unique configuration changes for your tenant</span></span>
- <span data-ttu-id="285d7-155">**信賴憑證者 (RP) 檔案**，這是以單一工作為主的檔案，直接由應用程式或服務 (也稱為信賴憑證者) 叫用。</span><span class="sxs-lookup"><span data-stu-id="285d7-155">**a Relying Party (RP) file** which is the single task-focused file that is invoked directly by the application or service (aka Relying Party).</span></span>  <span data-ttu-id="285d7-156">如需詳細資訊，請參閱原則檔案定義的相關文件。</span><span class="sxs-lookup"><span data-stu-id="285d7-156">Read the article on Policy file definitions for more information.</span></span>  <span data-ttu-id="285d7-157">每個唯一的工作需要自己的 RP，而根據品牌需求而定，數目可能是「應用程式總數 x 使用案例總數」。</span><span class="sxs-lookup"><span data-stu-id="285d7-157">Each unique task requires its own RP and depending on branding requirements the number might be "total of applications x total number of use cases".</span></span>


<span data-ttu-id="285d7-158">Azure AD B2C 中的內建原則依照上述的 3 檔案模式，但開發人員只能看到信賴憑證者 (RP) 檔案，而入口網站是在背景中變更擴充檔案。</span><span class="sxs-lookup"><span data-stu-id="285d7-158">Built-in policies in Azure AD B2C follow the 3-file pattern depicted above, but the developer only sees the Relying Party (RP) file, while the portal makes changes in the background to the EXTenstions file.</span></span>

## <a name="core-concepts-you-should-know-when-using-custom-policies"></a><span data-ttu-id="285d7-159">使用自訂原則時應該知道的核心概念</span><span class="sxs-lookup"><span data-stu-id="285d7-159">Core concepts you should know when using custom policies</span></span>

### <a name="azure-active-directory-b2c"></a><span data-ttu-id="285d7-160">Azure Active Directory B2C</span><span class="sxs-lookup"><span data-stu-id="285d7-160">Azure Active Directory B2C</span></span>

<span data-ttu-id="285d7-161">Azure 的客戶身分識別和存取管理 (CIAM) 服務。</span><span class="sxs-lookup"><span data-stu-id="285d7-161">Azure’s customer identity and access management (CIAM) service.</span></span> <span data-ttu-id="285d7-162">服務包括︰</span><span class="sxs-lookup"><span data-stu-id="285d7-162">The service includes:</span></span>

1. <span data-ttu-id="285d7-163">特殊用途 Azure Active Directory 形式的使用者目錄，可透過 Microsoft Graph 存取，保存本機帳戶和同盟帳戶的使用者資料</span><span class="sxs-lookup"><span data-stu-id="285d7-163">A user directory in the form of a special-purpose Azure Active Directory accessible via Microsoft Graph and which holds user data for both local accounts and federated accounts</span></span> 
2. <span data-ttu-id="285d7-164">存取**識別體驗架構**，協調使用者與實體之間的信任，並在它們之間傳遞宣告，以完成身分識別/存取權管理工作</span><span class="sxs-lookup"><span data-stu-id="285d7-164">Access to the **Identity Experience Framework** which orchestrates trust between users and entities and passes claims between them to complete an identity/access management task</span></span> 
3. <span data-ttu-id="285d7-165">Security Token Service (STS)，發出識別碼權杖、重新整理權杖和存取權杖 (及對等的 SAML 判斷提示)，並驗證它們以保護資源。</span><span class="sxs-lookup"><span data-stu-id="285d7-165">A security token service (STS) issuing id tokens, refresh tokens, and access tokens (and equivalent SAML assertions) and validating them to protect resources.</span></span>

<span data-ttu-id="285d7-166">Azure AD B2C 依序與身分識別提供者、使用者、其他系統和本機使用者目錄互動，以達成身分識別工作 (例如登入使用者、註冊新的使用者、重設密碼)。</span><span class="sxs-lookup"><span data-stu-id="285d7-166">Azure AD B2C interacts with identity providers, users, other systems, and with the local user directory in sequence to achieve an identity task (e.g. login a user, register a new user, reset a password).</span></span> <span data-ttu-id="285d7-167">建立多方信任和執行這些步驟的基礎平台稱為識別體驗架構，而原則 (也稱為使用者旅程圖或信任架構原則) 會明確定義動作項目、動作、通訊協定及完成的步驟順序。</span><span class="sxs-lookup"><span data-stu-id="285d7-167">The underlying platform which establishes multi-party trust and executes these steps is called the Identity Experience Framework and a policy (also called an user journey or a Trust framework policy) explicitly defines the actors, the actions, the protocols, and the sequence of steps to complete.</span></span>

### <a name="identity-experience-framework"></a><span data-ttu-id="285d7-168">身分識別體驗架構</span><span class="sxs-lookup"><span data-stu-id="285d7-168">Identity Experience Framework</span></span>

<span data-ttu-id="285d7-169">完全可設定、原則導向、雲端式的 Azure 平台，協調標準通訊協定格式 (例如 OpenIDConnect、OAuth、SAML、WSFed) 實體 (大致上是宣告提供者) 和少數非標準格式 (例如以 REST API 為基礎的系統對系統宣告交換) 實體之間的信任。</span><span class="sxs-lookup"><span data-stu-id="285d7-169">A fully configurable, policy-driven, cloud-based Azure platform that orchestrates trust between entities (broadly Claims Providers) in standard protocol formats such as OpenIDConnect, OAuth, SAML, WSFed, and a few non-standard ones (e.g. REST API-based system-to-system claims exchanges).</span></span> <span data-ttu-id="285d7-170">I2E 建立方便使用、白標籤的體驗，支援 HTML、CSS 和 jscript。</span><span class="sxs-lookup"><span data-stu-id="285d7-170">The I2E creates user-friendly, whitelabelled experiences that support HTML, CSS, and jscript.</span></span>  <span data-ttu-id="285d7-171">識別體驗架構目前僅適用於 Azure AD B2C 服務的情況，且優先用於 CIAM 相關的工作。</span><span class="sxs-lookup"><span data-stu-id="285d7-171">Today, the Identity Experience Framework is available only in the context of the Azure AD B2C service and prioritized for tasks related to CIAM.</span></span>

### <a name="built-in-policies"></a><span data-ttu-id="285d7-172">內建原則</span><span class="sxs-lookup"><span data-stu-id="285d7-172">Built-in policies</span></span>

<span data-ttu-id="285d7-173">預先定義的組態檔，指揮 Azure AD B2C 的行為來執行最常用的身分識別工作 (也就是</span><span class="sxs-lookup"><span data-stu-id="285d7-173">Predefined configuration files that direct the behavior of Azure AD B2C to perform the most commonly used identity tasks (i.e.</span></span> <span data-ttu-id="285d7-174">使用者註冊、登入、密碼重設)，並與也在 Azure AD B2C 中預先定義受信任關係的受信任方 (例如 Facebook 識別提供者、LinkedIn、Microsoft 帳戶、Google 帳戶) 互動。</span><span class="sxs-lookup"><span data-stu-id="285d7-174">user registration, signin, password reset) and interact with trusted parties whose relationship is also predefined in Azure AD B2C (e.g. Facebook identity provider, LinkedIn, Microsoft Account, Google accounts).</span></span>  <span data-ttu-id="285d7-175">未來，內建原則也可能支援自訂企業領域內常用的識別提供者，例如 Azure Active Directory Premium、Active Directory ADFS、Salesforce 識別碼提供者等。</span><span class="sxs-lookup"><span data-stu-id="285d7-175">In the future, built-in policies may also provide for customization of identity providers which are typically in the enterprise realm such as Azure Active Directory Premium, Active Directory/ADFS, Salesforce ID Provider etc.</span></span>


### <a name="custom-policies"></a><span data-ttu-id="285d7-176">自訂原則</span><span class="sxs-lookup"><span data-stu-id="285d7-176">Custom policies</span></span>

<span data-ttu-id="285d7-177">組態檔，定義 Azure AD B2C 租用戶中識別體驗架構的行為。</span><span class="sxs-lookup"><span data-stu-id="285d7-177">Configuration files that define the behavior of Identity Experience Framework in your Azure AD B2C tenant.</span></span> <span data-ttu-id="285d7-178">自訂原則可以一或多個 XML 檔案的形式存取 (請參閱原則檔案定義)，當信賴憑證者 (例如應用程式) 叫用時，會由識別體驗架構執行這些檔案。</span><span class="sxs-lookup"><span data-stu-id="285d7-178">A custom policy is accessible as one or several XML files (see Policy Files definitions) which are executed by the Identity Experience Framework when invoked by a relying party (e.g. an application).</span></span> <span data-ttu-id="285d7-179">身分識別開發人員可以直接編輯自訂原則，可完成的工作數量幾乎沒有限制。</span><span class="sxs-lookup"><span data-stu-id="285d7-179">Custom policies can be directly edited by an identity developer to complete a near unlimited number of tasks.</span></span> <span data-ttu-id="285d7-180">設定自訂原則的開發人員必須仔細定義信任關係，以包含中繼資料端點、精確的宣告交換定義，並設定每個識別提供者所需的祕密、金鑰和憑證。</span><span class="sxs-lookup"><span data-stu-id="285d7-180">Developers configuring custom policies must define the trusted relationships in careful detail to include metadata endpoints, exact claims exchange definitions, and configure secrets, keys and certificates as needed by each identity provider.</span></span>

## <a name="policy-file-definitions-for-identity-experience-framework-trustframeworks"></a><span data-ttu-id="285d7-181">識別體驗架構 Trustframeworks 的原則檔案定義</span><span class="sxs-lookup"><span data-stu-id="285d7-181">Policy File Definitions for Identity Experience Framework Trustframeworks</span></span>

### <a name="policy-files"></a><span data-ttu-id="285d7-182">原則檔</span><span class="sxs-lookup"><span data-stu-id="285d7-182">Policy Files</span></span>

<span data-ttu-id="285d7-183">自訂原則以一或多個 XML 格式的檔案表示，各檔案在階層鏈中彼此參考。</span><span class="sxs-lookup"><span data-stu-id="285d7-183">A custom policy is represented as one or several XML-formatted files which refer to each other in a hierarchical chain.</span></span> <span data-ttu-id="285d7-184">XML 元素定義︰宣告結構描述、宣告轉換、內容定義、宣告提供者/技術設定檔和 Userjourney 協調流程步驟等元素。</span><span class="sxs-lookup"><span data-stu-id="285d7-184">The XML elements define: Claims schema, claims transformations, content definitions, claims providers/technical profiles, and Userjourney orchestration steps, among other elements.</span></span>  <span data-ttu-id="285d7-185">我們建議使用三種類型的原則檔︰</span><span class="sxs-lookup"><span data-stu-id="285d7-185">We recommend the use of three types of policy files:</span></span>

- <span data-ttu-id="285d7-186">**基底檔案**，其中包含大部分的定義，Azure 有提供完整的範例。</span><span class="sxs-lookup"><span data-stu-id="285d7-186">**A BASE file**, which contains most of the definitions and for which Azure provides a complete sample.</span></span>  <span data-ttu-id="285d7-187">建議您儘可能不要變更這個檔案，才有利於原則的疑難排解和長期維護</span><span class="sxs-lookup"><span data-stu-id="285d7-187">We recommend you make a minimum number of changes to this file to help with troubleshooting, and long-term maintenance of your policies</span></span>
- <span data-ttu-id="285d7-188">**擴充檔案**，其中保存租用戶的唯一組態變更</span><span class="sxs-lookup"><span data-stu-id="285d7-188">**an EXTensions file** that holds the unique configuration changes for your tenant</span></span>
- <span data-ttu-id="285d7-189">**信賴憑證者 (RP) 檔案**，這是以單一工作為主的檔案，直接由應用程式或服務 (也稱為信賴憑證者) 叫用。</span><span class="sxs-lookup"><span data-stu-id="285d7-189">**a Relying Party (RP) file** which is the single task-focused file that is invoked directly by the application or service (aka Relying Party).</span></span>  <span data-ttu-id="285d7-190">如需詳細資訊，請參閱原則檔案定義的相關文件。</span><span class="sxs-lookup"><span data-stu-id="285d7-190">Read the article on Policy file definitions for more information.</span></span>  <span data-ttu-id="285d7-191">每個唯一的工作需要自己的 RP，而根據品牌需求而定，數目可能是「應用程式總數 x 使用案例總數」。</span><span class="sxs-lookup"><span data-stu-id="285d7-191">Each unique task requires its own RP and depending on branding requirements the number might be "total of applications x total number of use cases".</span></span>

![原則檔類型](media/active-directory-b2c-overview-custom/active-directory-b2c-overview-custom-policy-files.png)

| <span data-ttu-id="285d7-193">原則檔類型</span><span class="sxs-lookup"><span data-stu-id="285d7-193">Type of policy file</span></span> | <span data-ttu-id="285d7-194">範例檔案名稱</span><span class="sxs-lookup"><span data-stu-id="285d7-194">Examples file name</span></span> | <span data-ttu-id="285d7-195">建議使用</span><span class="sxs-lookup"><span data-stu-id="285d7-195">Recommended use</span></span> | <span data-ttu-id="285d7-196">繼承自</span><span class="sxs-lookup"><span data-stu-id="285d7-196">Inherits from</span></span> |
|---------------------|--------------------|-----------------|---------------|
| <span data-ttu-id="285d7-197">基底</span><span class="sxs-lookup"><span data-stu-id="285d7-197">BASE</span></span> |<span data-ttu-id="285d7-198">TrustFrameworkBase.xml</span><span class="sxs-lookup"><span data-stu-id="285d7-198">TrustFrameworkBase.xml</span></span><br><br><span data-ttu-id="285d7-199">Mytenant.onmicrosoft.com-B2C-1A_BASE1.xml</span><span class="sxs-lookup"><span data-stu-id="285d7-199">Mytenant.onmicrosoft.com-B2C-1A_BASE1.xml</span></span> | <span data-ttu-id="285d7-200">包括核心宣告結構描述、宣告轉換、宣告提供者，以及 Microsoft 所設定的使用者旅程圖</span><span class="sxs-lookup"><span data-stu-id="285d7-200">Includes the core claims schema, claims transformations, claims providers, and user journeys configured by Microsoft</span></span><br><br><span data-ttu-id="285d7-201">儘可能不要變更此檔案</span><span class="sxs-lookup"><span data-stu-id="285d7-201">Make minimal changes to this file</span></span> | <span data-ttu-id="285d7-202">None</span><span class="sxs-lookup"><span data-stu-id="285d7-202">None</span></span> |
| <span data-ttu-id="285d7-203">擴充 (EXT)</span><span class="sxs-lookup"><span data-stu-id="285d7-203">Extension (EXT)</span></span> | <span data-ttu-id="285d7-204">TrustFrameworkExtensions.xml</span><span class="sxs-lookup"><span data-stu-id="285d7-204">TrustFrameworkExtensions.xml</span></span><br><br><span data-ttu-id="285d7-205">Mytenant.onmicrosoft.com-B2C-1A_EXT.xml</span><span class="sxs-lookup"><span data-stu-id="285d7-205">Mytenant.onmicrosoft.com-B2C-1A_EXT.xml</span></span> | <span data-ttu-id="285d7-206">在此彙總基底檔案的變更</span><span class="sxs-lookup"><span data-stu-id="285d7-206">Consolidate your changes to the BASE file here</span></span><br><br><span data-ttu-id="285d7-207">已修改的宣告提供者</span><span class="sxs-lookup"><span data-stu-id="285d7-207">Modified claims providers</span></span><br><br><span data-ttu-id="285d7-208">已修改的使用者旅程圖</span><span class="sxs-lookup"><span data-stu-id="285d7-208">Modified user journeys</span></span><br><br><span data-ttu-id="285d7-209">您自己的自訂結構描述定義</span><span class="sxs-lookup"><span data-stu-id="285d7-209">Your own custom schema definitions</span></span> | <span data-ttu-id="285d7-210">基底檔案</span><span class="sxs-lookup"><span data-stu-id="285d7-210">BASE file</span></span> |
| <span data-ttu-id="285d7-211">信賴憑證者 (RP)</span><span class="sxs-lookup"><span data-stu-id="285d7-211">Relying Party (RP)</span></span> | <span data-ttu-id="285d7-212">B2C_1A_sign_up_sign_in.xml</span><span class="sxs-lookup"><span data-stu-id="285d7-212">B2C_1A_sign_up_sign_in.xml</span></span>| <span data-ttu-id="285d7-213">在此變更權杖圖形和工作階段設定</span><span class="sxs-lookup"><span data-stu-id="285d7-213">Change token shape and session settings here</span></span>| <span data-ttu-id="285d7-214">Extensions(EXT) 檔案</span><span class="sxs-lookup"><span data-stu-id="285d7-214">Extensions(EXT) file</span></span> |

### <a name="inheritance-model"></a><span data-ttu-id="285d7-215">繼承模型</span><span class="sxs-lookup"><span data-stu-id="285d7-215">Inheritance model</span></span>

<span data-ttu-id="285d7-216">當應用程式呼叫 RP 原則檔時，B2C 中的識別體驗架構將先從基底原則檔、再從擴充原則檔、最後從 RP 原則檔，新增所有元素，以組合目前生效的原則。</span><span class="sxs-lookup"><span data-stu-id="285d7-216">When an application calls the RP Policy file, the Identity Experience Framework in B2C will add all the elements from BASE, then from EXTENSIONS, and lastly from the RP policy file to assemble the current policy in effect.</span></span>  <span data-ttu-id="285d7-217">RP 檔案會覆寫擴充原則檔中相同類型和名稱的元素，而擴充原則檔會覆寫基底原則檔。</span><span class="sxs-lookup"><span data-stu-id="285d7-217">Elements of the same type and name in the RP file will override those in the EXTENSIONS, and EXTENSIONS overrides BASE.</span></span>

<span data-ttu-id="285d7-218">Azure AD B2C 中的**內建原則**依照上述的 3 檔案模式，但開發人員只能看到信賴憑證者 (RP) 檔案，而入口網站是在背景中變更擴充檔案。</span><span class="sxs-lookup"><span data-stu-id="285d7-218">**Built-in policies** in Azure AD B2C follow the 3-file pattern depicted above, but the developer only sees the Relying Party (RP) file, while the portal makes changes in the background to the EXTenstions file.</span></span>  <span data-ttu-id="285d7-219">整個 Azure AD B2C 共用一個基底原則檔，此檔案由 Azure B2C 小組控制，且經常更新。</span><span class="sxs-lookup"><span data-stu-id="285d7-219">All of Azure AD B2C shares a BASE policy file that is under the control of the Azure B2C team and is updated frequently.</span></span>
