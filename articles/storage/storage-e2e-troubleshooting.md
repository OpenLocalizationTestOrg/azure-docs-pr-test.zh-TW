---
title: "使用診斷與 Message Analyzer 進行 Azure 儲存體的疑難排解 | Microsoft Docs"
description: "示範使用 Azure Storage Analytics、AzCopy 和 Microsoft Message Analyzer 進行端對端疑難排解的教學課程"
services: storage
documentationcenter: dotnet
author: robinsh
manager: timlt
ms.assetid: 643372a3-1c07-4e88-b4ef-042512a43086
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/15/2017
ms.author: robinsh
ms.openlocfilehash: e2b739772f98a9c23253c58bb2bbd3560814ccaa
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="end-to-end-troubleshooting-using-azure-storage-metrics-and-logging-azcopy-and-message-analyzer"></a><span data-ttu-id="d98be-103">使用 Azure 儲存體計量和記錄、AzCopy 及 Message Analyzer 進行端對端疑難排解</span><span class="sxs-lookup"><span data-stu-id="d98be-103">End-to-End Troubleshooting using Azure Storage metrics and logging, AzCopy, and Message Analyzer</span></span>
[!INCLUDE [storage-selector-portal-e2e-troubleshooting](../../includes/storage-selector-portal-e2e-troubleshooting.md)]

<span data-ttu-id="d98be-104">診斷與疑難排解是透過 Microsoft Azure 儲存體建置和支援用戶端應用程式的關鍵技術。</span><span class="sxs-lookup"><span data-stu-id="d98be-104">Diagnosing and troubleshooting is a key skill for building and supporting client applications with Microsoft Azure Storage.</span></span> <span data-ttu-id="d98be-105">由於 Azure 應用程式的分散式本質，診斷和疑難排解錯誤和效能問題可能會比在傳統環境中更為複雜。</span><span class="sxs-lookup"><span data-stu-id="d98be-105">Due to the distributed nature of an Azure application, diagnosing and troubleshooting errors and performance issues may be more complex than in traditional environments.</span></span>

<span data-ttu-id="d98be-106">在本教學課程中，我們將示範如何使用 Microsoft 提供的工具和 Azure 儲存體，識別可能會影響效能的錯誤，以及針對這些錯誤進行疑難排解的完整步驟，以便最佳化用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="d98be-106">In this tutorial, we demonstrate how to identify certain errors that may affect performance, and troubleshoot those errors from end-to-end using tools provided by Microsoft and Azure Storage, in order to optimize the client application.</span></span>

<span data-ttu-id="d98be-107">本教學課程提供端對端疑難排解案例的實際操作探勘。</span><span class="sxs-lookup"><span data-stu-id="d98be-107">This tutorial provides a hands-on exploration of an end-to-end troubleshooting scenario.</span></span> <span data-ttu-id="d98be-108">如需針對 Azure 儲存體應用程式進行疑難排解的深度概念性指南，請參閱 [監控、診斷和疑難排解 Microsoft Azure 儲存體](storage-monitoring-diagnosing-troubleshooting.md)。</span><span class="sxs-lookup"><span data-stu-id="d98be-108">For an in-depth conceptual guide to troubleshooting Azure storage applications, see [Monitor, diagnose, and troubleshoot Microsoft Azure Storage](storage-monitoring-diagnosing-troubleshooting.md).</span></span>

## <a name="tools-for-troubleshooting-azure-storage-applications"></a><span data-ttu-id="d98be-109">對 Azure 儲存體應用程式進行疑難排解的工具</span><span class="sxs-lookup"><span data-stu-id="d98be-109">Tools for troubleshooting Azure Storage applications</span></span>
<span data-ttu-id="d98be-110">若要使用 Microsoft Azure 儲存體進行用戶端應用程式的疑難排解，您可以使用一些工具組合來判斷何時發生問題和問題的可能原因。</span><span class="sxs-lookup"><span data-stu-id="d98be-110">To troubleshoot client applications using Microsoft Azure Storage, you can use a combination of tools to determine when an issue has occurred and what the cause of the problem may be.</span></span> <span data-ttu-id="d98be-111">這些工具包括：</span><span class="sxs-lookup"><span data-stu-id="d98be-111">These tools include:</span></span>

* <span data-ttu-id="d98be-112">**Azure Storage Analytics**。</span><span class="sxs-lookup"><span data-stu-id="d98be-112">**Azure Storage Analytics**.</span></span> <span data-ttu-id="d98be-113">[Azure Storage Analytics](/rest/api/storageservices/Storage-Analytics) 提供 Azure 儲存體的度量和記錄。</span><span class="sxs-lookup"><span data-stu-id="d98be-113">[Azure Storage Analytics](/rest/api/storageservices/Storage-Analytics) provides metrics and logging for Azure Storage.</span></span>
  
  * <span data-ttu-id="d98be-114">**儲存體度量** 可追蹤儲存體帳戶的交易度量和容量度量。</span><span class="sxs-lookup"><span data-stu-id="d98be-114">**Storage metrics** tracks transaction metrics and capacity metrics for your storage account.</span></span> <span data-ttu-id="d98be-115">您可以使用度量，判斷如何根據各種不同的量值來執行您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d98be-115">Using metrics, you can determine how your application is performing according to a variety of different measures.</span></span> <span data-ttu-id="d98be-116">如需 Storage Analytics 追蹤的度量類型詳細資訊，請參閱 [Storage Analytics 度量資料表結構描述](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-116">See [Storage Analytics Metrics Table Schema](/rest/api/storageservices/Storage-Analytics-Metrics-Table-Schema) for more information about the types of metrics tracked by Storage Analytics.</span></span>
  * <span data-ttu-id="d98be-117">**儲存體記錄** 可將對 Azure 儲存體服務的每項要求記錄至伺服器端記錄檔。</span><span class="sxs-lookup"><span data-stu-id="d98be-117">**Storage logging** logs each request to the Azure Storage services to a server-side log.</span></span> <span data-ttu-id="d98be-118">記錄檔可追蹤每項要求的詳細資料，包括執行的作業、作業的狀態及延遲資訊。</span><span class="sxs-lookup"><span data-stu-id="d98be-118">The log tracks detailed data for each request, including the operation performed, the status of the operation, and latency information.</span></span> <span data-ttu-id="d98be-119">如需 Storage Analytics 寫入記錄檔的要求和回應資料詳細資訊，請參閱 [Storage Analytics 記錄檔格式](/rest/api/storageservices/Storage-Analytics-Log-Format) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-119">See [Storage Analytics Log Format](/rest/api/storageservices/Storage-Analytics-Log-Format) for more information about the request and response data that is written to the logs by Storage Analytics.</span></span>

> [!NOTE]
> <span data-ttu-id="d98be-120">複寫類型為區域備援儲存體 (ZRS) 的儲存體帳戶目前未啟用度量或記錄功能。</span><span class="sxs-lookup"><span data-stu-id="d98be-120">Storage accounts with a replication type of Zone-Redundant Storage (ZRS) do not have the metrics or logging capability enabled at this time.</span></span> 
> 
> 

* <span data-ttu-id="d98be-121">**Azure 入口網站**。</span><span class="sxs-lookup"><span data-stu-id="d98be-121">**Azure portal**.</span></span> <span data-ttu-id="d98be-122">您可以在 [Azure 入口網站](https://portal.azure.com)中設定儲存體帳戶的計量和記錄。</span><span class="sxs-lookup"><span data-stu-id="d98be-122">You can configure metrics and logging for your storage account in the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="d98be-123">您也可以檢視圖表和圖形 (其中顯示應用程式在一段時間內的執行狀況)，並設定警示，通知應用程式是否對指定的度量以超乎預期的方式執行。</span><span class="sxs-lookup"><span data-stu-id="d98be-123">You can also view charts and graphs that show how your application is performing over time, and configure alerts to notify you if your application performs differently than expected for a specified metric.</span></span>
  
    <span data-ttu-id="d98be-124">如需在 Azure 入口網站中設定監視的相關資訊，請參閱[在 Azure 入口網站中監視儲存體帳戶](storage-monitor-storage-account.md)。</span><span class="sxs-lookup"><span data-stu-id="d98be-124">See [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md) for information about configuring monitoring in the Azure portal.</span></span>
* <span data-ttu-id="d98be-125">**AzCopy**。</span><span class="sxs-lookup"><span data-stu-id="d98be-125">**AzCopy**.</span></span> <span data-ttu-id="d98be-126">Azure 儲存體的伺服器記錄檔會儲存為 Blob，因此您可以使用 AzCopy，將記錄檔 Blob 複製到本機目錄，以便使用 Microsoft Message Analyzer 分析。</span><span class="sxs-lookup"><span data-stu-id="d98be-126">Server logs for Azure Storage are stored as blobs, so you can use AzCopy to copy the log blobs to a local directory for analysis using Microsoft Message Analyzer.</span></span> <span data-ttu-id="d98be-127">如需 AzCopy 的詳細資訊，請參閱[使用 AzCopy 命令列公用程式傳輸資料](storage-use-azcopy.md)。</span><span class="sxs-lookup"><span data-stu-id="d98be-127">See [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md) for more information about AzCopy.</span></span>
* <span data-ttu-id="d98be-128">**Microsoft Message Analyzer**。</span><span class="sxs-lookup"><span data-stu-id="d98be-128">**Microsoft Message Analyzer**.</span></span> <span data-ttu-id="d98be-129">Message Analyzer 是一種可取用記錄檔並以視覺化格式顯示記錄檔資料的工具，讓您輕鬆地篩選、搜尋記錄檔資料並分組為實用的資料集，以便用來分析錯誤和效能問題。</span><span class="sxs-lookup"><span data-stu-id="d98be-129">Message Analyzer is a tool that consumes log files and displays log data in a visual format that makes it easy to filter, search, and group log data into useful sets that you can use to analyze errors and performance issues.</span></span> <span data-ttu-id="d98be-130">如需 Message Analyzer 的詳細資訊，請參閱 [Microsoft Message Analyzer 操作指南](http://technet.microsoft.com/library/jj649776.aspx)。</span><span class="sxs-lookup"><span data-stu-id="d98be-130">See [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx) for more information about Message Analyzer.</span></span>

## <a name="about-the-sample-scenario"></a><span data-ttu-id="d98be-131">關於範例案例</span><span class="sxs-lookup"><span data-stu-id="d98be-131">About the sample scenario</span></span>
<span data-ttu-id="d98be-132">在本教學課程中，我們將檢驗一個案例，其中的 Azure 儲存體度量表示應用程式呼叫 Azure 儲存體的成功率很低。</span><span class="sxs-lookup"><span data-stu-id="d98be-132">For this tutorial, we'll examine a scenario where Azure Storage metrics indicates a low percent success rate for an application that calls Azure storage.</span></span> <span data-ttu-id="d98be-133">低百分比成功速率計量 (在 [Azure 入口網站](https://portal.azure.com)和計量資料表中顯示為 **PercentSuccess**) 會追蹤成功的作業，但是會傳回大於 299 的 HTTP 狀態碼。</span><span class="sxs-lookup"><span data-stu-id="d98be-133">The low percent success rate metric (shown as **PercentSuccess** in the [Azure portal](https://portal.azure.com) and in the metrics tables) tracks operations that succeed, but that return an HTTP status code that is greater than 299.</span></span> <span data-ttu-id="d98be-134">在伺服器端的儲存體記錄檔中，這些作業會加上 **ClientOtherErrors**的交易狀態記錄下來。</span><span class="sxs-lookup"><span data-stu-id="d98be-134">In the server-side storage log files, these operations are recorded with a transaction status of **ClientOtherErrors**.</span></span> <span data-ttu-id="d98be-135">如需低成功百分比度量的詳細資訊，請參閱 [度量顯示低 PercentSuccess 或分析記錄檔項目的交易狀態為 ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success)。</span><span class="sxs-lookup"><span data-stu-id="d98be-135">For more details about the low percent success metric, see [Metrics show low PercentSuccess or analytics log entries have operations with transaction status of ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).</span></span>

<span data-ttu-id="d98be-136">Azure 儲存體作業可能會傳回大於 299 的 HTTP 狀態碼為其正常功能的一部分。</span><span class="sxs-lookup"><span data-stu-id="d98be-136">Azure Storage operations may return HTTP status codes greater than 299 as part of their normal functionality.</span></span> <span data-ttu-id="d98be-137">但是在某些情況下，這些錯誤表示您可能可以最佳化您的用戶端應用程式，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="d98be-137">But these errors in some cases indicate that you may be able to optimize your client application for improved performance.</span></span>

<span data-ttu-id="d98be-138">在此案例中，我們會將低百分比成功率視為任何低於 100%的項目。</span><span class="sxs-lookup"><span data-stu-id="d98be-138">In this scenario, we'll consider a low percent success rate to be anything below 100%.</span></span> <span data-ttu-id="d98be-139">不過，您可以根據自己的需求，選擇不同的度量層級。</span><span class="sxs-lookup"><span data-stu-id="d98be-139">You can choose a different metric level, however, according to your needs.</span></span> <span data-ttu-id="d98be-140">我們建議您在應用程式的測試期間，建立關鍵效能指標的基準容錯。</span><span class="sxs-lookup"><span data-stu-id="d98be-140">We recommend that during testing of your application, you establish a baseline tolerance for your key performance metrics.</span></span> <span data-ttu-id="d98be-141">例如，您可能會根據測試，決定您的應用程式應具有 90% 或 85% 的穩定成功率。</span><span class="sxs-lookup"><span data-stu-id="d98be-141">For example, you might determine, based on testing, that your application should have a consistent percent success rate of 90%, or 85%.</span></span> <span data-ttu-id="d98be-142">如果度量資料顯示應用程式偏離該數字，您可以調查造成增加的可能原因。</span><span class="sxs-lookup"><span data-stu-id="d98be-142">If your metrics data shows that the application is deviating from that number, then you can investigate what may be causing the increase.</span></span>

<span data-ttu-id="d98be-143">在我們的範例案例中，一旦建立了低於 100% 的百分比成功率度量，我們就會檢查記錄檔，以找出度量相關的錯誤，並利用它們來找出造成較低百分比成功率的原因。</span><span class="sxs-lookup"><span data-stu-id="d98be-143">For our sample scenario, once we've established that the percent success rate metric is below 100%, we will examine the logs to find the errors that correlate to the metrics, and use them to figure out what is causing the lower percent success rate.</span></span> <span data-ttu-id="d98be-144">我們會特別關注 400 範圍中的錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-144">We'll look specifically at errors in the 400 range.</span></span> <span data-ttu-id="d98be-145">然後我們將更仔細調查 404 (找不到) 錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-145">Then we'll more closely investigate 404 (Not Found) errors.</span></span>

### <a name="some-causes-of-400-range-errors"></a><span data-ttu-id="d98be-146">400 範圍錯誤的某些原因</span><span class="sxs-lookup"><span data-stu-id="d98be-146">Some causes of 400-range errors</span></span>
<span data-ttu-id="d98be-147">下列範例顯示 Azure Blob 儲存體要求的某些 400 範圍錯誤的取樣，以及其可能原因。</span><span class="sxs-lookup"><span data-stu-id="d98be-147">The examples below shows a sampling of some 400-range errors for requests against Azure Blob Storage, and their possible causes.</span></span> <span data-ttu-id="d98be-148">任何這些錯誤，以及 300 範圍和 500 範圍中的錯誤，都可能導致低百分比成功率。</span><span class="sxs-lookup"><span data-stu-id="d98be-148">Any of these errors, as well as errors in the 300 range and the 500 range, can contribute to a low percent success rate.</span></span>

<span data-ttu-id="d98be-149">請注意，下面所列並不完整。</span><span class="sxs-lookup"><span data-stu-id="d98be-149">Note that the lists below are far from complete.</span></span> <span data-ttu-id="d98be-150">如需一般 Azure 儲存體錯誤和每項儲存體服務特定錯誤的詳細資料，請參閱 MSDN 上的 [狀態和錯誤碼](http://msdn.microsoft.com/library/azure/dd179382.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-150">See [Status and Error Codes](http://msdn.microsoft.com/library/azure/dd179382.aspx) on MSDN for details about general Azure Storage errors and about errors specific to each of the storage services.</span></span>

<span data-ttu-id="d98be-151">**狀態碼 404 (找不到) 範例**</span><span class="sxs-lookup"><span data-stu-id="d98be-151">**Status Code 404 (Not Found) Examples**</span></span>

<span data-ttu-id="d98be-152">發生於因為找不到 Blob 或容器而使對容器或 Blob 的讀取作業失敗時。</span><span class="sxs-lookup"><span data-stu-id="d98be-152">Occurs when a read operation against a container or blob fails because the blob or container is not found.</span></span>

* <span data-ttu-id="d98be-153">如果在其他用戶端此要求前刪除了容器或 Blob，就會發生。</span><span class="sxs-lookup"><span data-stu-id="d98be-153">Occurs if a container or blob has been deleted by another client before this request.</span></span>
* <span data-ttu-id="d98be-154">如果您在檢查容器或 Blob 是否存在之後，使用可建立容器或 Blob 的 API 呼叫，就會發生。</span><span class="sxs-lookup"><span data-stu-id="d98be-154">Occurs if you are using an API call that creates the container or blob after checking whether it exists.</span></span> <span data-ttu-id="d98be-155">CreateIfNotExists API 會先進行 HEAD 呼叫，以檢查容器或 Blob 是否存在；如果不存在，寔會傳回 404 錯誤，然後進行第二次 PUT 呼叫，以寫入容器或 Blob。</span><span class="sxs-lookup"><span data-stu-id="d98be-155">The CreateIfNotExists APIs make a HEAD call first to check for the existence of the container or blob; if it does not exist, a 404 error is returned, and then a second PUT call is made to write the container or blob.</span></span>

<span data-ttu-id="d98be-156">**狀態碼 409 (衝突) 範例**</span><span class="sxs-lookup"><span data-stu-id="d98be-156">**Status Code 409 (Conflict) Examples**</span></span>

* <span data-ttu-id="d98be-157">如果您使用建立 API 來建立新的容器或 Blob，但未先檢查其存在與否，而且已存在具有該名稱的容器或 Blob，就會發生。</span><span class="sxs-lookup"><span data-stu-id="d98be-157">Occurs if you use a Create API to create a new container or blob, without checking for existence first, and a container or blob with that name already exists.</span></span>
* <span data-ttu-id="d98be-158">如果正在刪除容器，而您嘗試在刪除作業完成之前，使用相同名稱建立新的容器，就會發生。</span><span class="sxs-lookup"><span data-stu-id="d98be-158">Occurs if a container is being deleted, and you attempt to create a new container with the same name before the deletion operation is complete.</span></span>
* <span data-ttu-id="d98be-159">如果您在容器或 Blob 上指定租用，而且已經有租用存在，就會發生。</span><span class="sxs-lookup"><span data-stu-id="d98be-159">Occurs if you specify a lease on a container or blob, and there is already a lease present.</span></span>

<span data-ttu-id="d98be-160">**狀態碼 412 (先決條件失敗) 範例**</span><span class="sxs-lookup"><span data-stu-id="d98be-160">**Status Code 412 (Precondition Failed) Examples**</span></span>

* <span data-ttu-id="d98be-161">發生於不符合條件式標頭指定的條件時。</span><span class="sxs-lookup"><span data-stu-id="d98be-161">Occurs when the condition specified by a conditional header has not been met.</span></span>
* <span data-ttu-id="d98be-162">發生於指定的租用識別碼與容器或 Blob 上的租用識別碼不相符時。</span><span class="sxs-lookup"><span data-stu-id="d98be-162">Occurs when the lease ID specified does not match the lease ID on the container or blob.</span></span>

## <a name="generate-log-files-for-analysis"></a><span data-ttu-id="d98be-163">產生記錄檔以供分析</span><span class="sxs-lookup"><span data-stu-id="d98be-163">Generate log files for analysis</span></span>
<span data-ttu-id="d98be-164">在本教學課程中，我們將使用 Message Analyzer 來處理三種不同類型的記錄檔，雖然您可以選擇使用任何其中一種：</span><span class="sxs-lookup"><span data-stu-id="d98be-164">In this tutorial, we'll use Message Analyzer to work with three different types of log files, although you could choose to work with any one of these:</span></span>

* <span data-ttu-id="d98be-165">當您啟用 Azure 儲存體記錄時建立的 **伺服器記錄檔**。</span><span class="sxs-lookup"><span data-stu-id="d98be-165">The **server log**, which is created when you enable Azure Storage logging.</span></span> <span data-ttu-id="d98be-166">伺服器記錄檔包含對其中一項 Azure 儲存體服務 (Blob、佇列、資料表和檔案) 呼叫的每項作業的相關資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-166">The server log contains data about each operation called against one of the Azure Storage services - blob, queue, table, and file.</span></span> <span data-ttu-id="d98be-167">伺服器記錄檔指出已呼叫的作業和傳回的狀態碼，以及有關要求和回應的其他詳細資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-167">The server log indicates which operation was called and what status code was returned, as well as other details about the request and response.</span></span>
* <span data-ttu-id="d98be-168">當您在 .NET 應用程式中啟用用戶端記錄時建立的 **.NET 用戶端記錄檔**。</span><span class="sxs-lookup"><span data-stu-id="d98be-168">The **.NET client log**, which is created when you enable client-side logging from within your .NET application.</span></span> <span data-ttu-id="d98be-169">用戶端記錄檔包含用戶端如何準備要求及如何接收和處理回應的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="d98be-169">The client log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>
* <span data-ttu-id="d98be-170">**HTTP 網路追蹤記錄檔**，用以收集 HTTP/HTTPS 要求和回應資料，包括對 Azure 儲存體的作業。</span><span class="sxs-lookup"><span data-stu-id="d98be-170">The **HTTP network trace log**, which collects data on HTTP/HTTPS request and response data, including for operations against Azure Storage.</span></span> <span data-ttu-id="d98be-171">在本教學課程中，我們將透過 Message Analyzer 產生網路追蹤。</span><span class="sxs-lookup"><span data-stu-id="d98be-171">In this tutorial, we'll generate the network trace via Message Analyzer.</span></span>

### <a name="configure-server-side-logging-and-metrics"></a><span data-ttu-id="d98be-172">設定伺服器端記錄和度量</span><span class="sxs-lookup"><span data-stu-id="d98be-172">Configure server-side logging and metrics</span></span>
<span data-ttu-id="d98be-173">首先，我們必須設定 Azure 儲存體記錄和度量，如此我們才有用戶端應用程式提供的資料可分析。</span><span class="sxs-lookup"><span data-stu-id="d98be-173">First, we'll need to configure Azure Storage logging and metrics, so that we have data from the client application to analyze.</span></span> <span data-ttu-id="d98be-174">您可以用各種方式設定記錄和計量 - 透過 [Azure 入口網站](https://portal.azure.com)，或使用 PowerShell，或以程式設計的方式。</span><span class="sxs-lookup"><span data-stu-id="d98be-174">You can configure logging and metrics in a variety of ways - via the [Azure portal](https://portal.azure.com), by using PowerShell, or programmatically.</span></span> <span data-ttu-id="d98be-175">如需設定記錄和度量的詳細資訊，請參閱 MSDN 上的[啟用儲存體度量和檢視度量資料](http://msdn.microsoft.com/library/azure/dn782843.aspx)和[啟用儲存體記錄和存取記錄檔資料](http://msdn.microsoft.com/library/azure/dn782840.aspx)。</span><span class="sxs-lookup"><span data-stu-id="d98be-175">See [Enabling Storage Metrics and Viewing Metrics Data](http://msdn.microsoft.com/library/azure/dn782843.aspx) and [Enabling Storage Logging and Accessing Log Data](http://msdn.microsoft.com/library/azure/dn782840.aspx) on MSDN for details about configuring logging and metrics.</span></span>

<span data-ttu-id="d98be-176">**透過 Azure 入口網站**</span><span class="sxs-lookup"><span data-stu-id="d98be-176">**Via the Azure portal**</span></span>

<span data-ttu-id="d98be-177">若要使用 [Azure 入口網站](https://portal.azure.com)設定儲存體帳戶的記錄和計量，請遵循[在 Azure 入口網站中監視儲存體帳戶](storage-monitor-storage-account.md)上的指示執行。</span><span class="sxs-lookup"><span data-stu-id="d98be-177">To configure logging and metrics for your storage account using the [Azure portal](https://portal.azure.com), follow the instructions at [Monitor a storage account in the Azure portal](storage-monitor-storage-account.md).</span></span>

> [!NOTE]
> <span data-ttu-id="d98be-178">使用 Azure 入口網站無法設定分鐘計量。</span><span class="sxs-lookup"><span data-stu-id="d98be-178">It's not possible to set minute metrics using the Azure portal.</span></span> <span data-ttu-id="d98be-179">不過，我們建議您不要為了本教學課程的目的，以及為了調查您的應用程式的效能問題，而設定這類度量。</span><span class="sxs-lookup"><span data-stu-id="d98be-179">However, we recommend that you do set them for the purposes of this tutorial, and for investigating performance issues with your application.</span></span> <span data-ttu-id="d98be-180">您可以使用 PowerShell (如下所示)，或以程式設計方式使用儲存體用戶端程式庫，來設定分鐘度量。</span><span class="sxs-lookup"><span data-stu-id="d98be-180">You can set minute metrics using PowerShell as shown below, or programmatically using the storage client library.</span></span>
> 
> <span data-ttu-id="d98be-181">請注意，Azure 入口網站無法顯示分鐘計量，只能顯示每小時計量。</span><span class="sxs-lookup"><span data-stu-id="d98be-181">Note that the Azure portal cannot display minute metrics, only hourly metrics.</span></span>
> 
> 

<span data-ttu-id="d98be-182">**透過 PowerShell**</span><span class="sxs-lookup"><span data-stu-id="d98be-182">**Via PowerShell**</span></span>

<span data-ttu-id="d98be-183">若要開始使用 Azure PowerShell，請參閱 [如何安裝及設定 Azure PowerShell](/powershell/azure/overview)。</span><span class="sxs-lookup"><span data-stu-id="d98be-183">To get started with PowerShell for Azure, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

1. <span data-ttu-id="d98be-184">使用 [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) Cmdlet 將您的 Azure 使用者帳戶新增至 PowerShell 視窗：</span><span class="sxs-lookup"><span data-stu-id="d98be-184">Use the [Add-AzureAccount](/powershell/module/azure/add-azureaccount?view=azuresmps-3.7.0) cmdlet to add your Azure user account to the PowerShell window:</span></span>
   
    ```powershell
    Add-AzureAccount
    ```

2. <span data-ttu-id="d98be-185">在 [登入 Microsoft Azure]  視窗中，輸入電子郵件地址以及與您的帳戶相關聯的密碼。</span><span class="sxs-lookup"><span data-stu-id="d98be-185">In the **Sign in to Microsoft Azure** window, type the email address and password associated with your account.</span></span> <span data-ttu-id="d98be-186">Azure 會驗證並儲存認證資訊，然後關閉視窗。</span><span class="sxs-lookup"><span data-stu-id="d98be-186">Azure authenticates and saves the credential information, and then closes the window.</span></span>
3. <span data-ttu-id="d98be-187">在 PowerShell 視窗中執行下列命令，將預設儲存體帳戶設定為您在本教學課程中使用的儲存體帳戶：</span><span class="sxs-lookup"><span data-stu-id="d98be-187">Set the default storage account to the storage account you are using for the tutorial by executing these commands in the PowerShell window:</span></span>
   
    ```powershell
    $SubscriptionName = 'Your subscription name'
    $StorageAccountName = 'yourstorageaccount'
    Set-AzureSubscription -CurrentStorageAccountName $StorageAccountName -SubscriptionName $SubscriptionName
    ```

4. <span data-ttu-id="d98be-188">啟用 Blob 服務的儲存體記錄：</span><span class="sxs-lookup"><span data-stu-id="d98be-188">Enable storage logging for the Blob service:</span></span>
   
    ```powershell
    Set-AzureStorageServiceLoggingProperty -ServiceType Blob -LoggingOperations Read,Write,Delete -PassThru -RetentionDays 7 -Version 1.0
    ```

5. <span data-ttu-id="d98be-189">啟用 Blob 服務的儲存體度量，並確定將 -**-MetricsType`Minute` 設定為** ：</span><span class="sxs-lookup"><span data-stu-id="d98be-189">Enable storage metrics for the Blob service, making sure to set **-MetricsType** to `Minute`:</span></span>
   
    ```powershell
    Set-AzureStorageServiceMetricsProperty -ServiceType Blob -MetricsType Minute -MetricsLevel ServiceAndApi -PassThru -RetentionDays 7 -Version 1.0
    ```

### <a name="configure-net-client-side-logging"></a><span data-ttu-id="d98be-190">設定 .NET 用戶端記錄</span><span class="sxs-lookup"><span data-stu-id="d98be-190">Configure .NET client-side logging</span></span>
<span data-ttu-id="d98be-191">若要設定 .NET 應用程式的用戶端的記錄，請在應用程式的組態檔 (web.config 或 app.config) 中啟用 .NET 診斷。</span><span class="sxs-lookup"><span data-stu-id="d98be-191">To configure client-side logging for a .NET application, enable .NET diagnostics in the application's configuration file (web.config or app.config).</span></span> <span data-ttu-id="d98be-192">如需詳細資訊，請參閱 MSDN 上的[使用 .NET Storage Client Library 的用戶端記錄](http://msdn.microsoft.com/library/azure/dn782839.aspx)和[使用 Microsoft Azure Storage SDK for Java 的用戶端記錄](http://msdn.microsoft.com/library/azure/dn782844.aspx)。</span><span class="sxs-lookup"><span data-stu-id="d98be-192">See [Client-side Logging with the .NET Storage Client Library](http://msdn.microsoft.com/library/azure/dn782839.aspx) and [Client-side Logging with the Microsoft Azure Storage SDK for Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) on MSDN for details.</span></span>

<span data-ttu-id="d98be-193">用戶端記錄檔包含用戶端如何準備要求及如何接收和處理回應的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="d98be-193">The client-side log includes detailed information about how the client prepares the request and receives and processes the response.</span></span>

<span data-ttu-id="d98be-194">儲存體用戶端程式庫會將用戶端記錄檔資料儲存在應用程式的組態檔 (web.config 或 app.config) 中指定的位置。</span><span class="sxs-lookup"><span data-stu-id="d98be-194">The Storage Client Library stores client-side log data in the location specified in the application's configuration file (web.config or app.config).</span></span>

### <a name="collect-a-network-trace"></a><span data-ttu-id="d98be-195">收集網路追蹤</span><span class="sxs-lookup"><span data-stu-id="d98be-195">Collect a network trace</span></span>
<span data-ttu-id="d98be-196">您可以使用 Message Analyzer，在用戶端應用程式執行時收集 HTTP/HTTPS 網路追蹤。</span><span class="sxs-lookup"><span data-stu-id="d98be-196">You can use Message Analyzer to collect an HTTP/HTTPS network trace while your client application is running.</span></span> <span data-ttu-id="d98be-197">Message Analyzer 會在後端使用 [Fiddler](http://www.telerik.com/fiddler) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-197">Message Analyzer uses [Fiddler](http://www.telerik.com/fiddler) on the back end.</span></span> <span data-ttu-id="d98be-198">收集網路追蹤之前，我們建議您設定 Fiddler 以記錄未加密的 HTTPS 流量：</span><span class="sxs-lookup"><span data-stu-id="d98be-198">Before you collect the network trace, we recommend that you configure Fiddler to record unencrypted HTTPS traffic:</span></span>

1. <span data-ttu-id="d98be-199">安裝 [Fiddler](http://www.telerik.com/download/fiddler)。</span><span class="sxs-lookup"><span data-stu-id="d98be-199">Install [Fiddler](http://www.telerik.com/download/fiddler).</span></span>
2. <span data-ttu-id="d98be-200">啟動 Fiddler。</span><span class="sxs-lookup"><span data-stu-id="d98be-200">Launch Fiddler.</span></span>
3. <span data-ttu-id="d98be-201">選取 [工具] | [Fiddler 選項]。</span><span class="sxs-lookup"><span data-stu-id="d98be-201">Select **Tools | Fiddler Options**.</span></span>
4. <span data-ttu-id="d98be-202">在 [選項] 對話方塊中，確定 [擷取 HTTPS CONNECT] 和 [解密 HTTPS 流量] 都已選取，如下所示。</span><span class="sxs-lookup"><span data-stu-id="d98be-202">In the Options dialog, ensure that **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** are both selected, as shown below.</span></span>

![設定 Fiddler 選項](./media/storage-e2e-troubleshooting/fiddler-options-1.png)

<span data-ttu-id="d98be-204">在本教學課程中，先在 Message Analyzer 中收集並儲存網路追蹤，然後建立分析工作階段以分析追蹤和記錄檔。</span><span class="sxs-lookup"><span data-stu-id="d98be-204">For the tutorial, collect and save a network trace first in Message Analyzer, then create an analysis session to analyze the trace and the logs.</span></span> <span data-ttu-id="d98be-205">若要在 Message Analyzer 中收集網路追蹤：</span><span class="sxs-lookup"><span data-stu-id="d98be-205">To collect a network trace in Message Analyzer:</span></span>

1. <span data-ttu-id="d98be-206">在 Message Analyzer 中，選取 [檔案] | [快速追蹤] | [未加密的 HTTPS]。</span><span class="sxs-lookup"><span data-stu-id="d98be-206">In Message Analyzer, select **File | Quick Trace | Unencrypted HTTPS**.</span></span>
2. <span data-ttu-id="d98be-207">追蹤會立即開始。</span><span class="sxs-lookup"><span data-stu-id="d98be-207">The trace will begin immediately.</span></span> <span data-ttu-id="d98be-208">選取 [停止]  以停止追蹤，我們即可將它設定為只追蹤儲存體流量。</span><span class="sxs-lookup"><span data-stu-id="d98be-208">Select **Stop** to stop the trace so that we can configure it to trace storage traffic only.</span></span>
3. <span data-ttu-id="d98be-209">選取 [編輯]  以編輯追蹤工作階段。</span><span class="sxs-lookup"><span data-stu-id="d98be-209">Select **Edit** to edit the tracing session.</span></span>
4. <span data-ttu-id="d98be-210">選取 [Microsoft-Pef-WebProxy] ETW 提供者右邊的 [設定] 連結。</span><span class="sxs-lookup"><span data-stu-id="d98be-210">Select the **Configure** link to the right of the **Microsoft-Pef-WebProxy** ETW provider.</span></span>
5. <span data-ttu-id="d98be-211">在 [進階設定] 對話方塊中，按一下 [提供者] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="d98be-211">In the **Advanced Settings** dialog, click the **Provider** tab.</span></span>
6. <span data-ttu-id="d98be-212">在 [主機名稱篩選條件]  欄位中，指定您的儲存體端點 (以空格分隔)。</span><span class="sxs-lookup"><span data-stu-id="d98be-212">In the **Hostname Filter** field, specify your storage endpoints, separated by spaces.</span></span> <span data-ttu-id="d98be-213">例如，您可以如下指定您的端點；將 `storagesample` 變更為儲存體帳戶的名稱：</span><span class="sxs-lookup"><span data-stu-id="d98be-213">For example, you can specify your endpoints as follows; change `storagesample` to the name of your storage account:</span></span>

    ```   
    storagesample.blob.core.windows.net storagesample.queue.core.windows.net storagesample.table.core.windows.net
    ```

7. <span data-ttu-id="d98be-214">結束對話方塊，然後按一下 [重新啟動]  以開始使用主機名稱篩選條件來收集追蹤，以便追蹤中只包含 Azure 儲存體網路流量。</span><span class="sxs-lookup"><span data-stu-id="d98be-214">Exit the dialog, and click **Restart** to begin collecting the trace with the hostname filter in place, so that only Azure Storage network traffic is included in the trace.</span></span>

> [!NOTE]
> <span data-ttu-id="d98be-215">完成網路追蹤收集之後，強烈建議您還原您在 Fiddler 中變更的設定，以解密 HTTPS 流量。</span><span class="sxs-lookup"><span data-stu-id="d98be-215">After you have finished collecting your network trace, we strongly recommend that you revert the settings that you may have changed in Fiddler to decrypt HTTPS traffic.</span></span> <span data-ttu-id="d98be-216">在 [Fiddler 選項] 對話方塊中，取消選取 [擷取 HTTPS CONNECT] 和 [解密 HTTPS 流量] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="d98be-216">In the Fiddler Options dialog, deselect the **Capture HTTPS CONNECTs** and **Decrypt HTTPS Traffic** checkboxes.</span></span>
> 
> 

<span data-ttu-id="d98be-217">如需詳細資訊，請參閱 Technet 上的 [使用網路追蹤功能](http://technet.microsoft.com/library/jj674819.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-217">See [Using the Network Tracing Features](http://technet.microsoft.com/library/jj674819.aspx) on Technet for more details.</span></span>

## <a name="review-metrics-data-in-the-azure-portal"></a><span data-ttu-id="d98be-218">在 Azure 入口網站中檢閱計量資料</span><span class="sxs-lookup"><span data-stu-id="d98be-218">Review metrics data in the Azure portal</span></span>
<span data-ttu-id="d98be-219">一旦您的應用程式執行了一段時間，您即可檢閱 [Azure 入口網站](https://portal.azure.com)中顯示的計量圖表，以觀察服務的執行狀況。</span><span class="sxs-lookup"><span data-stu-id="d98be-219">Once your application has been running for a period of time, you can review the metrics charts that appear in the [Azure portal](https://portal.azure.com) to observe how your service has been performing.</span></span>

<span data-ttu-id="d98be-220">首先，在 Azure 入口網站中瀏覽至您的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="d98be-220">First, navigate to your storage account in the Azure portal.</span></span> <span data-ttu-id="d98be-221">根據預設，包含 [成功百分比] 計量的監視圖表會顯示在 [帳戶] 刀鋒視窗上。</span><span class="sxs-lookup"><span data-stu-id="d98be-221">By default, a monitoring chart with the **Success percentage** metric is displayed on the account blade.</span></span> <span data-ttu-id="d98be-222">如果您之前曾修改圖表以顯示不同的計量，請新增 [成功百分比] 計量。</span><span class="sxs-lookup"><span data-stu-id="d98be-222">If you've previously modified the chart to display different metrics, add the **Success percentage** metric.</span></span>

<span data-ttu-id="d98be-223">您會立即在監控圖表中看到 [成功百分比]，以及您所新增的其他計量。</span><span class="sxs-lookup"><span data-stu-id="d98be-223">You'll now see **Success percentage** in the monitoring chart, along with any other metrics you may have added.</span></span> <span data-ttu-id="d98be-224">在接著要調查的案例中，藉由分析 Message Analyzer 中的記錄檔，百分比成功率稍微低於 100%。</span><span class="sxs-lookup"><span data-stu-id="d98be-224">In the scenario we'll investigate next by analyzing the logs in Message Analyzer, the percent success rate is somewhat below 100%.</span></span>

<span data-ttu-id="d98be-225">如需新增與自訂計量圖表的詳細資訊，請參閱[自訂計量圖表](storage-monitor-storage-account.md#customize-metrics-charts)。</span><span class="sxs-lookup"><span data-stu-id="d98be-225">For more details on adding and customizing metrics charts, see [Customize metrics charts](storage-monitor-storage-account.md#customize-metrics-charts).</span></span>

> [!NOTE]
> <span data-ttu-id="d98be-226">在您啟用儲存體計量之後，計量資料可能需要一些時間才會出現在 Azure 入口網站中。</span><span class="sxs-lookup"><span data-stu-id="d98be-226">It may take some time for your metrics data to appear in the Azure portal after you enable storage metrics.</span></span> <span data-ttu-id="d98be-227">這是因為過了目前這個小時之後，前一個小時的每小時計量才會顯示在 Azure 入口網站中。</span><span class="sxs-lookup"><span data-stu-id="d98be-227">This is because hourly metrics for the previous hour are not displayed in the Azure portal until the current hour has elapsed.</span></span> <span data-ttu-id="d98be-228">此外，分鐘計量目前不會顯示在 Azure 入口網站中。</span><span class="sxs-lookup"><span data-stu-id="d98be-228">Also, minute metrics are not currently displayed in the Azure portal.</span></span> <span data-ttu-id="d98be-229">因此視您啟用度量的時間而定，有可能需要兩個小時才看得見度量資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-229">So depending on when you enable metrics, it may take up to two hours to see metrics data.</span></span>
> 
> 

## <a name="use-azcopy-to-copy-server-logs-to-a-local-directory"></a><span data-ttu-id="d98be-230">使用 AzCopy 將伺服器記錄檔複製到本機目錄</span><span class="sxs-lookup"><span data-stu-id="d98be-230">Use AzCopy to copy server logs to a local directory</span></span>
<span data-ttu-id="d98be-231">Azure 儲存體會將伺服器記錄檔資料寫入至 Blob，而度量會寫入至資料表。</span><span class="sxs-lookup"><span data-stu-id="d98be-231">Azure Storage writes server log data to blobs, while metrics are written to tables.</span></span> <span data-ttu-id="d98be-232">記錄檔 Blob 位於您儲存體帳戶已知名稱的 `$logs` 容器中。</span><span class="sxs-lookup"><span data-stu-id="d98be-232">Log blobs are available in the well-known `$logs` container for your storage account.</span></span> <span data-ttu-id="d98be-233">記錄檔 Blob 會以階層方式依照年、月、日和小時命名，讓您輕鬆地找出您要調查的時間範圍。</span><span class="sxs-lookup"><span data-stu-id="d98be-233">Log blobs are named hierarchically by year, month, day, and hour, so that you can easily locate the range of time you wish to investigate.</span></span> <span data-ttu-id="d98be-234">例如，在 `storagesample` 帳戶中，01/02/2015 上午 8-9 點的記錄檔 Blob 容器為 `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`。</span><span class="sxs-lookup"><span data-stu-id="d98be-234">For example, in the `storagesample` account, the container for the log blobs for 01/02/2015, from 8-9 am, is `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`.</span></span> <span data-ttu-id="d98be-235">此容器中的個別 Blob 會循序命名，並以 `000000.log`開頭。</span><span class="sxs-lookup"><span data-stu-id="d98be-235">The individual blobs in this container are named sequentially, beginning with `000000.log`.</span></span>

<span data-ttu-id="d98be-236">您可以使用 AzCopy 命令列工具，將這些伺服器端記錄檔下載至您在本機電腦上選擇的位置。</span><span class="sxs-lookup"><span data-stu-id="d98be-236">You can use the AzCopy command-line tool to download these server-side log files to a location of your choice on your local machine.</span></span> <span data-ttu-id="d98be-237">例如，您可以使用下列命令，將發生於 2015 年 1 月 2 日的 Blob 作業的記錄檔下載至 `C:\Temp\Logs\Server` 資料夾；以您的儲存體帳戶名稱取代 `<storageaccountname>`，並以您的帳戶存取金鑰取代 `<storageaccountkey>`：</span><span class="sxs-lookup"><span data-stu-id="d98be-237">For example, you can use the following command to download the log files for blob operations that took place on January 2, 2015 to the folder `C:\Temp\Logs\Server`; replace `<storageaccountname>` with the name of your storage account, and `<storageaccountkey>` with your account access key:</span></span>

```azcopy
AzCopy.exe /Source:http://<storageaccountname>.blob.core.windows.net/$logs /Dest:C:\Temp\Logs\Server /Pattern:"blob/2015/01/02" /SourceKey:<storageaccountkey> /S /V
```
<span data-ttu-id="d98be-238">在 [Azure 下載](https://azure.microsoft.com/downloads/) 頁面可以下載 AzCopy。</span><span class="sxs-lookup"><span data-stu-id="d98be-238">AzCopy is available for download on the [Azure Downloads](https://azure.microsoft.com/downloads/) page.</span></span> <span data-ttu-id="d98be-239">如需使用 AzCopy 的詳細資訊，請參閱 [使用 AzCopy 命令列公用程式傳輸資料](storage-use-azcopy.md)。</span><span class="sxs-lookup"><span data-stu-id="d98be-239">For details about using AzCopy, see [Transfer data with the AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="d98be-240">如需下載伺服器端記錄檔的詳細資訊，請參閱 [下載儲存體記錄記錄檔資料](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata)。</span><span class="sxs-lookup"><span data-stu-id="d98be-240">For additional information about downloading server-side logs, see [Download Storage Logging log data](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata).</span></span>

## <a name="use-microsoft-message-analyzer-to-analyze-log-data"></a><span data-ttu-id="d98be-241">使用 Microsoft Message Analyzer 來分析記錄檔資料</span><span class="sxs-lookup"><span data-stu-id="d98be-241">Use Microsoft Message Analyzer to analyze log data</span></span>
<span data-ttu-id="d98be-242">Microsoft Message Analyzer 是在疑難排解與診斷案例中用於擷取、顯示及分析通訊協定訊息流量、事件和其他系統或應用程式訊息的工具。</span><span class="sxs-lookup"><span data-stu-id="d98be-242">Microsoft Message Analyzer is a tool for capturing, displaying, and analyzing protocol messaging traffic, events, and other system or application messages in troubleshooting and diagnostic scenarios.</span></span> <span data-ttu-id="d98be-243">Message Analyzer 也可讓您載入、彙總和分析記錄檔和儲存的追蹤檔案中的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-243">Message Analyzer also enables you to load, aggregate, and analyze data from log and saved trace files.</span></span> <span data-ttu-id="d98be-244">如需 Message Analyzer 的詳細資訊，請參閱 [Microsoft Message Analyzer 操作指南](http://technet.microsoft.com/library/jj649776.aspx)。</span><span class="sxs-lookup"><span data-stu-id="d98be-244">For more information about Message Analyzer, see [Microsoft Message Analyzer Operating Guide](http://technet.microsoft.com/library/jj649776.aspx).</span></span>

<span data-ttu-id="d98be-245">Message Analyzer 包含 Azure 儲存體資產，可協助您分析伺服器、用戶端和網路記錄檔。</span><span class="sxs-lookup"><span data-stu-id="d98be-245">Message Analyzer includes assets for Azure Storage that help you to analyze server, client, and network logs.</span></span> <span data-ttu-id="d98be-246">在本節中，我們將討論如何使用這些工具來解決儲存記錄檔中低成功百分比的問題。</span><span class="sxs-lookup"><span data-stu-id="d98be-246">In this section, we'll discuss how to use those tools to address the issue of low percent success in the storage logs.</span></span>

### <a name="download-and-install-message-analyzer-and-the-azure-storage-assets"></a><span data-ttu-id="d98be-247">下載並安裝 Message Analyzer 和 Azure 儲存體資產</span><span class="sxs-lookup"><span data-stu-id="d98be-247">Download and install Message Analyzer and the Azure Storage Assets</span></span>
1. <span data-ttu-id="d98be-248">從 Microsoft 下載中心下載 [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) ，並執行安裝程式。</span><span class="sxs-lookup"><span data-stu-id="d98be-248">Download [Message Analyzer](http://www.microsoft.com/download/details.aspx?id=44226) from the Microsoft Download Center, and run the installer.</span></span>
2. <span data-ttu-id="d98be-249">啟動 Message Analyzer。</span><span class="sxs-lookup"><span data-stu-id="d98be-249">Launch Message Analyzer.</span></span>
3. <span data-ttu-id="d98be-250">從 [工具] 功能表，選取 [資產管理員]。</span><span class="sxs-lookup"><span data-stu-id="d98be-250">From the **Tools** menu, select **Asset Manager**.</span></span> <span data-ttu-id="d98be-251">在 [資產管理員] 對話方塊中，選取 [下載]，然後依據 [Azure 儲存體] 篩選。</span><span class="sxs-lookup"><span data-stu-id="d98be-251">In the **Asset Manager** dialog, select **Downloads**, then filter on **Azure Storage**.</span></span> <span data-ttu-id="d98be-252">您會看到 Azure 儲存體資產，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="d98be-252">You will see the Azure Storage Assets, as shown in the picture below.</span></span>
4. <span data-ttu-id="d98be-253">按一下 [同步處理所有顯示的項目]  以安裝 Azure 儲存體資產。</span><span class="sxs-lookup"><span data-stu-id="d98be-253">Click **Sync All Displayed Items** to install the Azure Storage Assets.</span></span> <span data-ttu-id="d98be-254">可用的資產包括：</span><span class="sxs-lookup"><span data-stu-id="d98be-254">The available assets include:</span></span>
   * <span data-ttu-id="d98be-255">**Azure 儲存體色彩規則** ：Azure 儲存體色彩規則可讓您定義特殊篩選條件，以使用色彩、文字和字型樣式來反白顯示在追蹤中包含特定資訊的訊息。</span><span class="sxs-lookup"><span data-stu-id="d98be-255">**Azure Storage Color Rules:** Azure Storage color rules enable you to define special filters that use color, text, and font styles to highlight messages that contain specific information in a trace.</span></span>
   * <span data-ttu-id="d98be-256">**Azure 儲存體圖表** ：Azure 儲存體圖表是圖形伺服器記錄資料的預先定義的圖表。</span><span class="sxs-lookup"><span data-stu-id="d98be-256">**Azure Storage Charts:** Azure Storage charts are predefined charts that graph server log data.</span></span> <span data-ttu-id="d98be-257">請注意，若要在此時使用 Azure 儲存體圖表，您可能只要將伺服器記錄檔載入到 [分析方格]。</span><span class="sxs-lookup"><span data-stu-id="d98be-257">Note that to use Azure Storage charts at this time, you may only load the server log into the Analysis Grid.</span></span>
   * <span data-ttu-id="d98be-258">**Azure 儲存體剖析器** ：Azure 儲存體剖析器可剖析 Azure 儲存體用戶端、伺服器和 HTTP 記錄檔，以便顯示在 [分析方格] 中。</span><span class="sxs-lookup"><span data-stu-id="d98be-258">**Azure Storage Parsers:** The Azure Storage parsers parse the Azure Storage client, server, and HTTP logs in order to display them in the Analysis Grid.</span></span>
   * <span data-ttu-id="d98be-259">**Azure 儲存體篩選條件** ：Azure 儲存體篩選條件是預先定義的準則，您可以在 [分析方格] 中用來查詢資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-259">**Azure Storage Filters:** Azure Storage filters are predefined criteria that you can use to query your data in the Analysis Grid.</span></span>
   * <span data-ttu-id="d98be-260">**Azure 儲存體檢視版面配置** ：Azure 儲存體檢視版面配置是 [分析方格] 中預先定義的資料行版本配置和群組。</span><span class="sxs-lookup"><span data-stu-id="d98be-260">**Azure Storage View Layouts:** Azure Storage view layouts are predefined column layouts and groupings in the Analysis Grid.</span></span>
5. <span data-ttu-id="d98be-261">在您安裝資產之後，請重新啟動 Message Analyzer。</span><span class="sxs-lookup"><span data-stu-id="d98be-261">Restart Message Analyzer after you've installed the assets.</span></span>

![訊息分析器資產管理員](./media/storage-e2e-troubleshooting/mma-start-page-1.png)

> [!NOTE]
> <span data-ttu-id="d98be-263">安裝針對此教學課程的目的而顯示的所有 Azure 儲存體資產。</span><span class="sxs-lookup"><span data-stu-id="d98be-263">Install all of the Azure Storage assets shown for the purposes of this tutorial.</span></span>
> 
> 

### <a name="import-your-log-files-into-message-analyzer"></a><span data-ttu-id="d98be-264">將記錄檔匯入 Message Analyzer 中</span><span class="sxs-lookup"><span data-stu-id="d98be-264">Import your log files into Message Analyzer</span></span>
<span data-ttu-id="d98be-265">您可以將所有已儲存的記錄檔 (伺服器端、用戶端和網路) 匯入 Microsoft Message Analyzer 的單一工作階段中進行分析。</span><span class="sxs-lookup"><span data-stu-id="d98be-265">You can import all of your saved log files (server-side, client-side, and network) into a single session in Microsoft Message Analyzer for analysis.</span></span>

1. <span data-ttu-id="d98be-266">在 Microsoft Message Analyzer 的 [檔案] 功能表中，按一下 [新增工作階段]，然後按一下 [空白工作階段]。</span><span class="sxs-lookup"><span data-stu-id="d98be-266">On the **File** menu in Microsoft Message Analyzer, click **New Session**, and then click **Blank Session**.</span></span> <span data-ttu-id="d98be-267">在 [新增工作階段]  對話方塊中，輸入您的分析工作階段名稱。</span><span class="sxs-lookup"><span data-stu-id="d98be-267">In the **New Session** dialog, enter a name for your analysis session.</span></span> <span data-ttu-id="d98be-268">在 [工作階段詳細資料] 面板中，按一下 [檔案] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="d98be-268">In the **Session Details** panel, click on the **Files** button.</span></span>
2. <span data-ttu-id="d98be-269">若要載入 Message Analyzer 所產生的網路追蹤資料，請按一下 [新增檔案]，瀏覽至您從 Web 追蹤工作階段儲存的 .matp 檔案所在位置，選取 .matp 檔案，然後按一下 [開啟]。</span><span class="sxs-lookup"><span data-stu-id="d98be-269">To load the network trace data generated by Message Analyzer, click on **Add Files**, browse to the location where you saved your .matp file from your web tracing session, select the .matp file, and click **Open**.</span></span>
3. <span data-ttu-id="d98be-270">若要載入伺服器端記錄檔資料，請按一下 [新增檔案]，瀏覽至您下載伺服器端記錄檔的位置，選取您要分析的時間範圍內的記錄檔，然後按一下 [開啟]。</span><span class="sxs-lookup"><span data-stu-id="d98be-270">To load the server-side log data, click on **Add Files**, browse to the location where you downloaded your server-side logs, select the log files for the time range you want to analyze, and click **Open**.</span></span> <span data-ttu-id="d98be-271">然後，在 [工作階段詳細資料] 面板中，將每個伺服器端記錄檔的 [文字記錄檔設定] 下拉式清單設定為 [AzureStorageLog]，以確保 Microsoft Message Analyzer 可以正確剖析記錄檔。</span><span class="sxs-lookup"><span data-stu-id="d98be-271">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each server-side log file to **AzureStorageLog** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
4. <span data-ttu-id="d98be-272">若要載入用戶端記錄檔資料，請按一下 [新增檔案]，瀏覽至您儲存用戶端記錄檔的位置，選取您要分析的記錄檔，然後按一下 [開啟]。</span><span class="sxs-lookup"><span data-stu-id="d98be-272">To load the client-side log data, click on **Add Files**, browse to the location where you saved your client-side logs, select the log files you want to analyze, and click **Open**.</span></span> <span data-ttu-id="d98be-273">然後，在 [工作階段詳細資料] 面板中，將每個用戶端記錄檔的 [文字記錄檔設定] 下拉式清單設定為 [AzureStorageClientDotNetV4]，以確保 Microsoft Message Analyzer 可以正確剖析記錄檔。</span><span class="sxs-lookup"><span data-stu-id="d98be-273">Then, in the **Session Details** panel, set the **Text Log Configuration** drop-down for each client-side log file to **AzureStorageClientDotNetV4** to ensure that Microsoft Message Analyzer can parse the log file correctly.</span></span>
5. <span data-ttu-id="d98be-274">按一下 [新增工作階段] 對話方塊中的 [開始]，以載入和剖析記錄檔資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-274">Click **Start** in the **New Session** dialog to load and parse the log data.</span></span> <span data-ttu-id="d98be-275">記錄檔資料會顯示在 Message Analyzer 分析方格中。</span><span class="sxs-lookup"><span data-stu-id="d98be-275">The log data displays in the Message Analyzer Analysis Grid.</span></span>

<span data-ttu-id="d98be-276">下圖顯示使用伺服器、用戶端與網路追蹤記錄檔設定的範例工作階段。</span><span class="sxs-lookup"><span data-stu-id="d98be-276">The picture below shows an example session configured with server, client, and network trace log files.</span></span>

![設定 Message Analyzer 工作階段](./media/storage-e2e-troubleshooting/configure-mma-session-1.png)

<span data-ttu-id="d98be-278">請注意，Message Analyzer 會將記錄檔載入記憶體中。</span><span class="sxs-lookup"><span data-stu-id="d98be-278">Note that Message Analyzer loads log files into memory.</span></span> <span data-ttu-id="d98be-279">如果您有大量記錄檔資料，您會想要進行篩選，以便 Message Analyzer 發揮最佳效能。</span><span class="sxs-lookup"><span data-stu-id="d98be-279">If you have a large set of log data, you will want to filter it in order to get the best performance from Message Analyzer.</span></span>

<span data-ttu-id="d98be-280">首先，判斷您有興趣檢閱的時間範圍，而此時間範圍越小越好。</span><span class="sxs-lookup"><span data-stu-id="d98be-280">First, determine the time frame that you are interested in reviewing, and keep this time frame as small as possible.</span></span> <span data-ttu-id="d98be-281">在許多情況下，您會想檢閱數分鐘或數小時 (最多) 的期間。</span><span class="sxs-lookup"><span data-stu-id="d98be-281">In many cases you will want to review a period of minutes or hours at most.</span></span> <span data-ttu-id="d98be-282">匯入可符合您需求的最小記錄檔集合。</span><span class="sxs-lookup"><span data-stu-id="d98be-282">Import the smallest set of logs that can meet your needs.</span></span>

<span data-ttu-id="d98be-283">如果您仍有大量的記錄檔資料，您可能會想要指定工作階段篩選條件，以在載入記錄檔資料前進行篩選。</span><span class="sxs-lookup"><span data-stu-id="d98be-283">If you still have a large amount of log data, then you may want to specify a session filter to filter your log data before you load it.</span></span> <span data-ttu-id="d98be-284">在 [工作階段篩選條件] 方塊中，選取 [程式庫] 按鈕來選擇預先定義的篩選條件。例如，從 Azure 儲存體篩選條件中選擇 [全域時間篩選 I]，以篩選時間間隔。</span><span class="sxs-lookup"><span data-stu-id="d98be-284">In the **Session Filter** box, select the **Library** button to choose a predefined filter; for example, choose **Global Time Filter I** from the Azure Storage filters to filter on a time interval.</span></span> <span data-ttu-id="d98be-285">然後，您可以編輯篩選準則，針對您要查看的間隔指定開始和結束時間戳記。</span><span class="sxs-lookup"><span data-stu-id="d98be-285">You can then edit the filter criteria to specify the starting and ending timestamp for the interval you want to see.</span></span> <span data-ttu-id="d98be-286">您也可以篩選特定狀態碼 ；例如，您可以選擇只載入狀態碼為 404 的記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="d98be-286">You can also filter on a particular status code; for example, you can choose to load only log entries where the status code is 404.</span></span>

<span data-ttu-id="d98be-287">如需將記錄檔資料匯入 Microsoft Message Analyzer 的詳細資訊，請參閱 TechNet 上的 [擷取訊息資料](http://technet.microsoft.com/library/dn772437.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-287">For more information about importing log data into Microsoft Message Analyzer, see [Retrieving Message Data](http://technet.microsoft.com/library/dn772437.aspx) on TechNet.</span></span>

### <a name="use-the-client-request-id-to-correlate-log-file-data"></a><span data-ttu-id="d98be-288">使用用戶端要求識別碼讓記錄檔資料相互關聯</span><span class="sxs-lookup"><span data-stu-id="d98be-288">Use the client request ID to correlate log file data</span></span>
<span data-ttu-id="d98be-289">Azure 儲存體用戶端程式庫會自動為每一項要求產生唯一的用戶端要求識別碼。</span><span class="sxs-lookup"><span data-stu-id="d98be-289">The Azure Storage Client Library automatically generates a unique client request ID for every request.</span></span> <span data-ttu-id="d98be-290">這個值會寫入至用戶端記錄檔、伺服器記錄檔和網路追蹤，以便您使用它讓 Message Analyzer 內全部三個記錄檔的資料相互關聯。</span><span class="sxs-lookup"><span data-stu-id="d98be-290">This value is written to the client log, the server log, and the network trace, so you can use it to correlate data across all three logs within Message Analyzer.</span></span> <span data-ttu-id="d98be-291">如需用戶端要求識別碼的其他資訊，請參閱 [用戶端要求識別碼](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) 。</span><span class="sxs-lookup"><span data-stu-id="d98be-291">See [Client request ID](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) for additional information about the client request ID.</span></span>

<span data-ttu-id="d98be-292">下列各節說明如何使用預先設定和自訂的版面配置檢視，根據用戶端要求識別碼讓資料相互關聯和分組。</span><span class="sxs-lookup"><span data-stu-id="d98be-292">The sections below describe how to use pre-configured and custom layout views to correlate and group data based on the client request ID.</span></span>

### <a name="select-a-view-layout-to-display-in-the-analysis-grid"></a><span data-ttu-id="d98be-293">選取要顯示在分析方格中的檢視版本配置</span><span class="sxs-lookup"><span data-stu-id="d98be-293">Select a view layout to display in the Analysis Grid</span></span>
<span data-ttu-id="d98be-294">適用於 Message Analyzer 的儲存體資產包括 Azure 儲存體檢視版面配置，這些是預先設定的檢視，可用來顯示在不同案例中具有實用群組和資料行的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-294">The Storage Assets for Message Analyzer include Azure Storage View Layouts, which are pre-configured views that you can use to display your data with useful groupings and columns for different scenarios.</span></span> <span data-ttu-id="d98be-295">您也可以建立自訂檢視版面配置並儲存起來以便重複使用。</span><span class="sxs-lookup"><span data-stu-id="d98be-295">You can also create custom view layouts and save them for reuse.</span></span>

<span data-ttu-id="d98be-296">下圖顯示 [檢視版面配置] 功能表，此功能表可從工具列功能區選取 [檢視版本配置] 取得。</span><span class="sxs-lookup"><span data-stu-id="d98be-296">The picture below shows the **View Layout** menu, available by selecting **View Layout** from the toolbar ribbon.</span></span> <span data-ttu-id="d98be-297">Azure 儲存體的檢視版本配置位於功能表的 [Azure 儲存體]  節點之下。</span><span class="sxs-lookup"><span data-stu-id="d98be-297">The view layouts for Azure Storage are grouped under the **Azure Storage** node in the menu.</span></span> <span data-ttu-id="d98be-298">您可以在 [搜尋] 方塊中搜尋 `Azure Storage` ，只篩選 Azure 儲存體檢視版面配置。</span><span class="sxs-lookup"><span data-stu-id="d98be-298">You can search for `Azure Storage` in the search box to filter on Azure Storage view layouts only.</span></span> <span data-ttu-id="d98be-299">您也可以選取檢視版面配置旁邊的星號，使其成為我的最愛並顯示在功能表的頂端。</span><span class="sxs-lookup"><span data-stu-id="d98be-299">You can also select the star next to a view layout to make it a favorite and display it at the top of the menu.</span></span>

![檢視版面配置功能表](./media/storage-e2e-troubleshooting/view-layout-menu.png)

<span data-ttu-id="d98be-301">首先選取 [ **依 ClientRequestID 和模組分組**]。</span><span class="sxs-lookup"><span data-stu-id="d98be-301">To begin with, select **Grouped by ClientRequestID and Module**.</span></span> <span data-ttu-id="d98be-302">此檢視版面配置會先依用戶端要求識別碼，再依來源記錄檔 (或 Message Analyzer 中的 [模組]  )，將全部三個記錄檔中的記錄檔資料分組。</span><span class="sxs-lookup"><span data-stu-id="d98be-302">This view layout groups log data from all three logs first by client request ID, then by source log file (or **Module** in Message Analyzer).</span></span> <span data-ttu-id="d98be-303">與此檢視中，您可以向下切入到特定用戶端要求識別碼，並查看所有三個記錄檔中該用戶端要求識別碼的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-303">With this view, you can drill down into a particular client request ID, and see data from all three log files for that client request ID.</span></span>

<span data-ttu-id="d98be-304">下圖顯示套用至範例記錄檔資料的這個版面配置檢視，其中顯示部分的資料行。</span><span class="sxs-lookup"><span data-stu-id="d98be-304">The picture below shows this layout view applied to the sample log data, with a subset of columns displayed.</span></span> <span data-ttu-id="d98be-305">您可以看見針對特定用戶端要求識別碼，分析方格會顯示來自用戶端記錄檔、伺服器記錄檔和網路追蹤的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-305">You can see that for a particular client request ID, the Analysis Grid displays data from the client log, server log, and network trace.</span></span>

![Azure 儲存體檢視版面配置](./media/storage-e2e-troubleshooting/view-layout-client-request-id-module.png)

> [!NOTE]
> <span data-ttu-id="d98be-307">不同的記錄檔有不同的資料行，因此當分析方格中顯示來自多個記錄檔的資料時，某些資料行可能不會包含指定資料列的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-307">Different log files have different columns, so when data from multiple log files is displayed in the Analysis Grid, some columns may not contain any data for a given row.</span></span> <span data-ttu-id="d98be-308">例如，在上圖中，用戶端記錄檔資料列不會顯示 **Timestamp**、**TimeElapsed**、**Source** 和 **Destination** 資料行的任何資料，因為這些資料行不存在於用戶端記錄檔中，但存在於網路追蹤中。</span><span class="sxs-lookup"><span data-stu-id="d98be-308">For example, in the picture above, the client log rows do not show any data for the **Timestamp**, **TimeElapsed**, **Source**, and **Destination** columns, because these columns do not exist in the client log, but do exist in the network trace.</span></span> <span data-ttu-id="d98be-309">同樣地，**Timestamp** 資料行會顯示伺服器記錄檔中的時間戳記資料，但不會顯示 **TimeElapsed**、**Source** 和 **Destination** 資料行 (不屬於伺服器記錄檔) 的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-309">Similarly, the **Timestamp** column displays timestamp data from the server log, but no data is displayed for the **TimeElapsed**, **Source**, and **Destination** columns, which are not part of the server log.</span></span>
> 
> 

<span data-ttu-id="d98be-310">除了使用 Azure 儲存體檢視版面配置，您也可以定義和儲存自己的檢視版面配置。</span><span class="sxs-lookup"><span data-stu-id="d98be-310">In addition to using the Azure Storage view layouts, you can also define and save your own view layouts.</span></span> <span data-ttu-id="d98be-311">您可以選取其他所需的欄位來進行資料分組，並將群組儲存在您自訂的版面配置中。</span><span class="sxs-lookup"><span data-stu-id="d98be-311">You can select other desired fields for grouping data and save the grouping as part of your custom layout as well.</span></span>

### <a name="apply-color-rules-to-the-analysis-grid"></a><span data-ttu-id="d98be-312">將色彩規則套用至分析方格</span><span class="sxs-lookup"><span data-stu-id="d98be-312">Apply color rules to the Analysis Grid</span></span>
<span data-ttu-id="d98be-313">儲存體資產也包含色彩規則，以便以視覺化方式識別分析方格中不同類型的的錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-313">The Storage Assets also include color rules, which offer a visual means to identify different types of errors in the Analysis Grid.</span></span> <span data-ttu-id="d98be-314">預先定義的色彩規則會套用至 HTTP 錯誤，所以只會針對伺服器記錄檔和網路追蹤顯示。</span><span class="sxs-lookup"><span data-stu-id="d98be-314">The predefined color rules apply to HTTP errors, so they appear only for the server log and network trace.</span></span>

<span data-ttu-id="d98be-315">若要套用色彩規則，請從工具列功能區中選取 [色彩規則]  。</span><span class="sxs-lookup"><span data-stu-id="d98be-315">To apply color rules, select **Color Rules** from the toolbar ribbon.</span></span> <span data-ttu-id="d98be-316">您會在功能表中看到 Azure 儲存體色彩規則。</span><span class="sxs-lookup"><span data-stu-id="d98be-316">You'll see the Azure Storage color rules in the menu.</span></span> <span data-ttu-id="d98be-317">針對本教學課程，選取 [用戶端錯誤 (400 與 499 之間的 StatusCode)] ，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="d98be-317">For the tutorial, select **Client Errors (StatusCode between 400 and 499)**, as shown in the picture below.</span></span>

![Azure 儲存體檢視版面配置](./media/storage-e2e-troubleshooting/color-rules-menu.png)

<span data-ttu-id="d98be-319">除了使用 Azure 儲存體色彩規則，您也可以定義並儲存自己的色彩規則。</span><span class="sxs-lookup"><span data-stu-id="d98be-319">In addition to using the Azure Storage color rules, you can also define and save your own color rules.</span></span>

### <a name="group-and-filter-log-data-to-find-400-range-errors"></a><span data-ttu-id="d98be-320">群組及篩選記錄檔資料以尋找 400 範圍的錯誤</span><span class="sxs-lookup"><span data-stu-id="d98be-320">Group and filter log data to find 400-range errors</span></span>
<span data-ttu-id="d98be-321">接下來，我們將群組及篩選記錄檔資料，以找出 400 範圍內的所有錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-321">Next, we'll group and filter the log data to find all errors in the 400 range.</span></span>

1. <span data-ttu-id="d98be-322">找出 [分析方格] 中的 **StatusCode** 資料行，以滑鼠右鍵按一下資料行標題，並選取 [群組]。</span><span class="sxs-lookup"><span data-stu-id="d98be-322">Locate the **StatusCode** column in the Analysis Grid, right-click the column heading, and select **Group**.</span></span>
2. <span data-ttu-id="d98be-323">接著，在 **ClientRequestId** 資料行上進行分組。</span><span class="sxs-lookup"><span data-stu-id="d98be-323">Next, group on the **ClientRequestId** column.</span></span> <span data-ttu-id="d98be-324">您會看到分析方格中的資料現在依狀態碼和用戶端要求識別碼排列。</span><span class="sxs-lookup"><span data-stu-id="d98be-324">You'll see that the data in the Analysis Grid is now organized by status code and by client request ID.</span></span>
3. <span data-ttu-id="d98be-325">如果 [檢視篩選條件] 工具視窗尚未顯示，請予以顯示 。</span><span class="sxs-lookup"><span data-stu-id="d98be-325">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="d98be-326">在工具列功能區中，選取 [工具視窗]，然後選取 [檢視篩選條件]。</span><span class="sxs-lookup"><span data-stu-id="d98be-326">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
4. <span data-ttu-id="d98be-327">若要篩選記錄檔資料而僅顯示 400 範圍的錯誤，請將下列篩選準則加入至 [檢視篩選條件] 視窗，然後按一下 [套用]：</span><span class="sxs-lookup"><span data-stu-id="d98be-327">To filter the log data to display only 400-range errors, add the following filter criteria to the **View Filter** window, and click **Apply**:</span></span>

    ```   
    (AzureStorageLog.StatusCode >= 400 && AzureStorageLog.StatusCode <=499) || (HTTP.StatusCode >= 400 && HTTP.StatusCode <= 499)
    ```

<span data-ttu-id="d98be-328">下圖顯示這個群組和篩選的結果。</span><span class="sxs-lookup"><span data-stu-id="d98be-328">The picture below shows the results of this grouping and filter.</span></span> <span data-ttu-id="d98be-329">展開狀態碼 409 的群組下方的 **ClientRequestID** 欄位，例如，顯示導致該狀態碼的作業。</span><span class="sxs-lookup"><span data-stu-id="d98be-329">Expanding the **ClientRequestID** field beneath the grouping for status code 409, for example, shows an operation that resulted in that status code.</span></span>

![Azure 儲存體檢視版面配置](./media/storage-e2e-troubleshooting/400-range-errors1.png)

<span data-ttu-id="d98be-331">套用此篩選條件之後，您會看到用戶端記錄檔中的資料列遭到排除，因為用戶端記錄檔不包含 **StatusCode** 資料行。</span><span class="sxs-lookup"><span data-stu-id="d98be-331">After applying this filter, you'll see that rows from the client log are excluded, as the client log does not include a **StatusCode** column.</span></span> <span data-ttu-id="d98be-332">首先，我們會檢閱伺服器和網路追蹤記錄檔以找出 404 錯誤，然後我們會返回用戶端記錄檔，以檢查導致這些錯誤的用戶端作業。</span><span class="sxs-lookup"><span data-stu-id="d98be-332">To begin with, we'll review the server and network trace logs to locate 404 errors, and then we'll return to the client log to examine the client operations that led to them.</span></span>

> [!NOTE]
> <span data-ttu-id="d98be-333">您可以篩選 **StatusCode** 資料行，而如果將運算式加入至可納入狀態碼為 null 之記錄檔項目的篩選條件，則仍會顯示來自所有三個記錄檔 (包括用戶端記錄檔) 的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-333">You can filter on the **StatusCode** column and still display data from all three logs, including the client log, if you add an expression to the filter that includes log entries where the status code is null.</span></span> <span data-ttu-id="d98be-334">若要建構此篩選運算式，請使用：</span><span class="sxs-lookup"><span data-stu-id="d98be-334">To construct this filter expression, use:</span></span>
> 
> <code>&#42;StatusCode >= 400 or !&#42;StatusCode</code>
> 
> <span data-ttu-id="d98be-335">此篩選條件會傳回用戶端記錄檔的所有資料列，以及僅限狀態碼大於 400 之伺服器記錄檔和 HTTP 記錄檔的資料列。</span><span class="sxs-lookup"><span data-stu-id="d98be-335">This filter returns all rows from the client log and only rows from the server log and HTTP log where the status code is greater than 400.</span></span> <span data-ttu-id="d98be-336">如果您將此篩選條件套用到依用戶端要求識別碼和模組分組的檢視版面配置，即可搜尋或捲視所有記錄檔項目，以尋找所有三個記錄檔表示的地方。</span><span class="sxs-lookup"><span data-stu-id="d98be-336">If you apply it to the view layout grouped by client request ID and module, you can search or scroll through the log entries to find ones where all three logs are represented.</span></span>   
> 
> 

### <a name="filter-log-data-to-find-404-errors"></a><span data-ttu-id="d98be-337">篩選記錄檔資料以尋找 404 錯誤</span><span class="sxs-lookup"><span data-stu-id="d98be-337">Filter log data to find 404 errors</span></span>
<span data-ttu-id="d98be-338">儲存體資產包括預先定義的篩選條件，您可用來縮小記錄檔資料的範圍，以尋找您所尋找的錯誤或趨勢。</span><span class="sxs-lookup"><span data-stu-id="d98be-338">The Storage Assets include predefined filters that you can use to narrow log data to find the errors or trends you are looking for.</span></span> <span data-ttu-id="d98be-339">接下來，我們將會套用兩個預先定義的篩選條件：一個篩選 404 錯誤的伺服器和網路追蹤記錄檔，一個篩選指定時間範圍內的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-339">Next, we'll apply two predefined filters: one that filters the server and network trace logs for 404 errors, and one that filters the data on a specified time range.</span></span>

1. <span data-ttu-id="d98be-340">如果 [檢視篩選條件] 工具視窗尚未顯示，請予以顯示 。</span><span class="sxs-lookup"><span data-stu-id="d98be-340">Display the View Filter tool window if it is not already displayed.</span></span> <span data-ttu-id="d98be-341">在工具列功能區中，選取 [工具視窗]，然後選取 [檢視篩選條件]。</span><span class="sxs-lookup"><span data-stu-id="d98be-341">On the toolbar ribbon, select **Tool Windows**, then **View Filter**.</span></span>
2. <span data-ttu-id="d98be-342">在 [檢視篩選條件] 視窗中，選取 [程式庫]，然後搜尋 `Azure Storage` 以尋找 Azure 儲存體篩條件。</span><span class="sxs-lookup"><span data-stu-id="d98be-342">In the View Filter window, select **Library**, and search on `Azure Storage` to find the Azure Storage filters.</span></span> <span data-ttu-id="d98be-343">選取**所有記錄檔中的 404 (找不到) 訊息**的篩選條件。</span><span class="sxs-lookup"><span data-stu-id="d98be-343">Select the filter for **404 (Not Found) messages in all logs**.</span></span>
3. <span data-ttu-id="d98be-344">再次顯示 [程式庫] 功能表，然後找出並選取 [全域時間篩選條件]。</span><span class="sxs-lookup"><span data-stu-id="d98be-344">Display the **Library** menu again, and locate and select the **Global Time Filter**.</span></span>
4. <span data-ttu-id="d98be-345">將篩選條件中顯示的時間戳記編輯成您想要檢視的範圍。</span><span class="sxs-lookup"><span data-stu-id="d98be-345">Edit the timestamps shown in the filter to the range you wish to view.</span></span> <span data-ttu-id="d98be-346">這有助於縮小要分析的資料範圍。</span><span class="sxs-lookup"><span data-stu-id="d98be-346">This will help to narrow the range of data to analyze.</span></span>
5. <span data-ttu-id="d98be-347">您的篩選條件看起來應類似下列範例。</span><span class="sxs-lookup"><span data-stu-id="d98be-347">Your filter should appear similar to the example below.</span></span> <span data-ttu-id="d98be-348">按一下 [套用]  將篩選條件套用到 [分析方格]。</span><span class="sxs-lookup"><span data-stu-id="d98be-348">Click **Apply** to apply the filter to the Analysis Grid.</span></span>

    ```   
    ((AzureStorageLog.StatusCode == 404 || HTTP.StatusCode == 404)) And
    (#Timestamp >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39)
    ```

    ![Azure 儲存體檢視版面配置](./media/storage-e2e-troubleshooting/404-filtered-errors1.png)

### <a name="analyze-your-log-data"></a><span data-ttu-id="d98be-350">分析記錄檔資料</span><span class="sxs-lookup"><span data-stu-id="d98be-350">Analyze your log data</span></span>
<span data-ttu-id="d98be-351">您現已將資料分組並進行篩選，即可檢查產生 404 錯誤的個別要求詳細資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-351">Now that you have grouped and filtered your data, you can examine the details of individual requests that generated 404 errors.</span></span> <span data-ttu-id="d98be-352">在目前的檢視版面配置中，資料會依用戶端要求識別碼分組，再依記錄檔來源分組。</span><span class="sxs-lookup"><span data-stu-id="d98be-352">In the current view layout, the data is grouped by client request ID, then by log source.</span></span> <span data-ttu-id="d98be-353">因為我們是在篩選 StatusCode 欄位包含 404 的要求，所以只會看到伺服器和網路追蹤資料，而不會看到用戶端記錄檔資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-353">Since we are filtering on requests where the StatusCode field contains 404, we'll see only the server and network trace data, not the client log data.</span></span>

<span data-ttu-id="d98be-354">下圖顯示「取得 Blob」作業因為 Blob 不存在而產生 404 的特定要求。</span><span class="sxs-lookup"><span data-stu-id="d98be-354">The picture below shows a specific request where a Get Blob operation yielded a 404 because the blob did not exist.</span></span> <span data-ttu-id="d98be-355">請注意，某些資料行已從標準檢視中移除，以便顯示相關資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-355">Note that some columns have been removed from the standard view in order to display the relevant data.</span></span>

![已篩選的伺服器和網路追蹤記錄檔](./media/storage-e2e-troubleshooting/server-filtered-404-error.png)

<span data-ttu-id="d98be-357">接下來，我們會讓此用戶端要求識別碼與用戶端記錄檔資料相互關聯，以查看用戶端在錯誤發生時所採取的動作。</span><span class="sxs-lookup"><span data-stu-id="d98be-357">Next, we'll correlate this client request ID with the client log data to see what actions the client was taking when the error happened.</span></span> <span data-ttu-id="d98be-358">您可以顯示此工作階段的新分析方格檢視，以檢視在第二個索引標籤中開啟的用戶端記錄檔資料：</span><span class="sxs-lookup"><span data-stu-id="d98be-358">You can display a new Analysis Grid view for this session to view the client log data, which opens in a second tab:</span></span>

1. <span data-ttu-id="d98be-359">首先，將 **ClientRequestId** 欄位的值複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="d98be-359">First, copy the value of the **ClientRequestId** field to the clipboard.</span></span> <span data-ttu-id="d98be-360">您可以選取任一個資料列、找出 **ClientRequestId** 欄位，以滑鼠右鍵按一下資料值，然後選擇 [複製 'ClientRequestId']。</span><span class="sxs-lookup"><span data-stu-id="d98be-360">You can do this by selecting either row, locating the **ClientRequestId** field, right-clicking on the data value, and choosing **Copy 'ClientRequestId'**.</span></span>
2. <span data-ttu-id="d98be-361">在工具列功能區中，選取 [新增檢視器]，然後選取 [分析方格] 以開啟新的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="d98be-361">On the toolbar ribbon, select **New Viewer**, then select **Analysis Grid** to open a new tab.</span></span> <span data-ttu-id="d98be-362">新索引標籤會顯示您記錄檔中的所有資料，而不分組、篩選或套用色彩規則。</span><span class="sxs-lookup"><span data-stu-id="d98be-362">The new tab shows all data in your log files, without grouping, filtering, or color rules.</span></span>
3. <span data-ttu-id="d98be-363">在工具列功能區中，選取 [檢視版面配置]，然後選取 [Azure 儲存體] 區段下的 [所有 .NET 用戶端資料行]。</span><span class="sxs-lookup"><span data-stu-id="d98be-363">On the toolbar ribbon, select **View Layout**, then select **All .NET Client Columns** under the **Azure Storage** section.</span></span> <span data-ttu-id="d98be-364">此檢視版面配置會顯示用戶端記錄檔中的資料，以及伺服器和網路追蹤記錄檔中的資料。</span><span class="sxs-lookup"><span data-stu-id="d98be-364">This view layout shows data from the client log as well as the server and network trace logs.</span></span> <span data-ttu-id="d98be-365">預設會依 **MessageNumber** 資料行排序。</span><span class="sxs-lookup"><span data-stu-id="d98be-365">By default it is sorted on the **MessageNumber** column.</span></span>
4. <span data-ttu-id="d98be-366">接下來，搜尋用戶端記錄檔中的用戶端要求識別碼。</span><span class="sxs-lookup"><span data-stu-id="d98be-366">Next, search the client log for the client request ID.</span></span> <span data-ttu-id="d98be-367">在工具列功能區中，選取 [尋找訊息]，然後在 [尋找] 欄位中指定用戶端要求識別碼的自訂篩選條件。</span><span class="sxs-lookup"><span data-stu-id="d98be-367">On the toolbar ribbon, select **Find Messages**, then specify a custom filter on the client request ID in the **Find** field.</span></span> <span data-ttu-id="d98be-368">將此語法用於篩選，並指定自己的用戶端要求識別碼：</span><span class="sxs-lookup"><span data-stu-id="d98be-368">Use this syntax for the filter, specifying your own client request ID:</span></span>

    ```
    *ClientRequestId == "398bac41-7725-484b-8a69-2a9e48fc669a"
    ```

<span data-ttu-id="d98be-369">Message Analyzer 會找出並選取搜尋準則符合用戶端要求識別碼的第一個記錄檔項目。</span><span class="sxs-lookup"><span data-stu-id="d98be-369">Message Analyzer locates and selects the first log entry where the search criteria matches the client request ID.</span></span> <span data-ttu-id="d98be-370">在用戶端記錄檔中，每個用戶端要求識別碼都有數個項目，您可以依照 **ClientRequestId** 欄位加以分組，以便輕鬆地一起查看這些項目。</span><span class="sxs-lookup"><span data-stu-id="d98be-370">In the client log, there are several entries for each client request ID, so you may want to group them on the **ClientRequestId** field to make it easier to see them all together.</span></span> <span data-ttu-id="d98be-371">下圖顯示用戶端記錄檔中指定之用戶端要求識別碼的所有訊息。</span><span class="sxs-lookup"><span data-stu-id="d98be-371">The picture below shows all of the messages in the client log for the specified client request ID.</span></span>

![顯示 404 錯誤的用戶端記錄檔](./media/storage-e2e-troubleshooting/client-log-analysis-grid1.png)

<span data-ttu-id="d98be-373">使用這兩個索引標籤的檢視版面配置中顯示的資料，即可分析要求資料，以判斷造成錯誤的可能原因。</span><span class="sxs-lookup"><span data-stu-id="d98be-373">Using the data shown in the view layouts in these two tabs, you can analyze the request data to determine what may have caused the error.</span></span> <span data-ttu-id="d98be-374">您也可以查看這一個要求之前的要求，看看前一個事件是否可能造成 404 錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-374">You can also look at requests that preceded this one to see if a previous event may have led to the 404 error.</span></span> <span data-ttu-id="d98be-375">例如，您可以檢閱此用戶端要求識別碼之前的用戶端記錄檔項目，以判斷是否可能已刪除 Blob，或是否因為用戶端應用程式在容器或 Blob 上呼叫 CreateIfNotExists API 而造成。</span><span class="sxs-lookup"><span data-stu-id="d98be-375">For example, you can review the client log entries preceding this client request ID to determine whether the blob may have been deleted, or if the error was due to the client application calling a CreateIfNotExists API on a container or blob.</span></span> <span data-ttu-id="d98be-376">在用戶端記錄檔中，您可以在 [描述] 欄位中找到 Blob 的位址；在伺服器和網路追蹤記錄檔中，此資訊會出現在 [摘要] 欄位中。</span><span class="sxs-lookup"><span data-stu-id="d98be-376">In the client log, you can find the blob's address in the **Description** field; in the server and network trace logs, this information appears in the **Summary** field.</span></span>

<span data-ttu-id="d98be-377">一旦知道造成 404 錯誤之 Blob 的位址，即可進一步調查。</span><span class="sxs-lookup"><span data-stu-id="d98be-377">Once you know the address of the blob that yielded the 404 error, you can investigate further.</span></span> <span data-ttu-id="d98be-378">如果您在記錄檔項目中搜尋其他與相同 Blob 上的作業相關聯的訊息，您可以檢查用戶端先前是否刪除了實體。</span><span class="sxs-lookup"><span data-stu-id="d98be-378">If you search the log entries for other messages associated with operations on the same blob, you can check whether the client previously deleted the entity.</span></span>

## <a name="analyze-other-types-of-storage-errors"></a><span data-ttu-id="d98be-379">分析其他類型的儲存體錯誤</span><span class="sxs-lookup"><span data-stu-id="d98be-379">Analyze other types of storage errors</span></span>
<span data-ttu-id="d98be-380">您現已熟悉使用 Message Analyzer 來分析記錄檔資料，便可利用檢視版面配置、色彩規則及搜尋/篩選功能，分析其他類型的錯誤。</span><span class="sxs-lookup"><span data-stu-id="d98be-380">Now that you are familiar with using Message Analyzer to analyze your log data, you can analyze other types of errors using view layouts, color rules, and searching/filtering.</span></span> <span data-ttu-id="d98be-381">下表列出一些您可能會遇到的問題以及您可用來尋找問題的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="d98be-381">The tables below lists some issues you may encounter and the filter criteria you can use to locate them.</span></span> <span data-ttu-id="d98be-382">如需建構篩選條件與 Message Analyzer 篩選語言的詳細資訊，請參閱 [篩選訊息資料](http://technet.microsoft.com/library/jj819365.aspx)。</span><span class="sxs-lookup"><span data-stu-id="d98be-382">For more information on constructing filters and the Message Analyzer filtering language, see [Filtering Message Data](http://technet.microsoft.com/library/jj819365.aspx).</span></span>

| <span data-ttu-id="d98be-383">若要調查...</span><span class="sxs-lookup"><span data-stu-id="d98be-383">To Investigate…</span></span> | <span data-ttu-id="d98be-384">使用篩選運算式…</span><span class="sxs-lookup"><span data-stu-id="d98be-384">Use Filter Expression…</span></span> | <span data-ttu-id="d98be-385">運算式套用到記錄檔 (用戶端、伺服器、網路、全部)</span><span class="sxs-lookup"><span data-stu-id="d98be-385">Expression Applies to Log (Client, Server,   Network, All)</span></span> |
| --- | --- | --- |
| <span data-ttu-id="d98be-386">佇列上未預期的訊息傳遞延遲</span><span class="sxs-lookup"><span data-stu-id="d98be-386">Unexpected delays in message delivery on a queue</span></span> |<span data-ttu-id="d98be-387">AzureStorageClientDotNetV4.Description 包含「正在重試失敗的作業」。</span><span class="sxs-lookup"><span data-stu-id="d98be-387">AzureStorageClientDotNetV4.Description   contains "Retrying failed operation."</span></span> |<span data-ttu-id="d98be-388">用戶端</span><span class="sxs-lookup"><span data-stu-id="d98be-388">Client</span></span> |
| <span data-ttu-id="d98be-389">PercentThrottlingError 的 HTTP 增加</span><span class="sxs-lookup"><span data-stu-id="d98be-389">HTTP Increase in PercentThrottlingError</span></span> |<span data-ttu-id="d98be-390">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span><span class="sxs-lookup"><span data-stu-id="d98be-390">HTTP.Response.StatusCode   == 500 &#124;&#124; HTTP.Response.StatusCode == 503</span></span> |<span data-ttu-id="d98be-391">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-391">Network</span></span> |
| <span data-ttu-id="d98be-392">PercentTimeoutError 增加</span><span class="sxs-lookup"><span data-stu-id="d98be-392">Increase in PercentTimeoutError</span></span> |<span data-ttu-id="d98be-393">HTTP.Response.StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="d98be-393">HTTP.Response.StatusCode   == 500</span></span> |<span data-ttu-id="d98be-394">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-394">Network</span></span> |
| <span data-ttu-id="d98be-395">PercentTimeoutError 增加 (全部)</span><span class="sxs-lookup"><span data-stu-id="d98be-395">Increase in PercentTimeoutError (all)</span></span> |<span data-ttu-id="d98be-396">*StatusCode   == 500</span><span class="sxs-lookup"><span data-stu-id="d98be-396">*StatusCode   == 500</span></span> |<span data-ttu-id="d98be-397">全部</span><span class="sxs-lookup"><span data-stu-id="d98be-397">All</span></span> |
| <span data-ttu-id="d98be-398">PercentNetworkError 增加</span><span class="sxs-lookup"><span data-stu-id="d98be-398">Increase in PercentNetworkError</span></span> |<span data-ttu-id="d98be-399">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span><span class="sxs-lookup"><span data-stu-id="d98be-399">AzureStorageClientDotNetV4.EventLogEntry.Level   < 2</span></span> |<span data-ttu-id="d98be-400">用戶端</span><span class="sxs-lookup"><span data-stu-id="d98be-400">Client</span></span> |
| <span data-ttu-id="d98be-401">HTTP 403 (禁止) 訊息</span><span class="sxs-lookup"><span data-stu-id="d98be-401">HTTP 403 (Forbidden) messages</span></span> |<span data-ttu-id="d98be-402">HTTP.Response.StatusCode   == 403</span><span class="sxs-lookup"><span data-stu-id="d98be-402">HTTP.Response.StatusCode   == 403</span></span> |<span data-ttu-id="d98be-403">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-403">Network</span></span> |
| <span data-ttu-id="d98be-404">HTTP 404 (找不到) 訊息</span><span class="sxs-lookup"><span data-stu-id="d98be-404">HTTP 404 (Not found) messages</span></span> |<span data-ttu-id="d98be-405">HTTP.Response.StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="d98be-405">HTTP.Response.StatusCode   == 404</span></span> |<span data-ttu-id="d98be-406">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-406">Network</span></span> |
| <span data-ttu-id="d98be-407">404 (全部)</span><span class="sxs-lookup"><span data-stu-id="d98be-407">404 (all)</span></span> |<span data-ttu-id="d98be-408">*StatusCode   == 404</span><span class="sxs-lookup"><span data-stu-id="d98be-408">*StatusCode   == 404</span></span> |<span data-ttu-id="d98be-409">全部</span><span class="sxs-lookup"><span data-stu-id="d98be-409">All</span></span> |
| <span data-ttu-id="d98be-410">共用存取簽章 (SAS) 授權問題</span><span class="sxs-lookup"><span data-stu-id="d98be-410">Shared Access Signature (SAS) authorization issue</span></span> |<span data-ttu-id="d98be-411">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span><span class="sxs-lookup"><span data-stu-id="d98be-411">AzureStorageLog.RequestStatus ==  "SASAuthorizationError"</span></span> |<span data-ttu-id="d98be-412">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-412">Network</span></span> |
| <span data-ttu-id="d98be-413">HTTP 409 (衝突) 訊息</span><span class="sxs-lookup"><span data-stu-id="d98be-413">HTTP 409 (Conflict) messages</span></span> |<span data-ttu-id="d98be-414">HTTP.Response.StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="d98be-414">HTTP.Response.StatusCode   == 409</span></span> |<span data-ttu-id="d98be-415">網路</span><span class="sxs-lookup"><span data-stu-id="d98be-415">Network</span></span> |
| <span data-ttu-id="d98be-416">409 (全部)</span><span class="sxs-lookup"><span data-stu-id="d98be-416">409 (all)</span></span> |<span data-ttu-id="d98be-417">*StatusCode   == 409</span><span class="sxs-lookup"><span data-stu-id="d98be-417">*StatusCode   == 409</span></span> |<span data-ttu-id="d98be-418">全部</span><span class="sxs-lookup"><span data-stu-id="d98be-418">All</span></span> |
| <span data-ttu-id="d98be-419">低 PercentSuccess，或是分析記錄項目內含具有 ClientOtherErrors 交易狀態的作業</span><span class="sxs-lookup"><span data-stu-id="d98be-419">Low PercentSuccess or analytics log entries have   operations with transaction status of ClientOtherErrors</span></span> |<span data-ttu-id="d98be-420">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span><span class="sxs-lookup"><span data-stu-id="d98be-420">AzureStorageLog.RequestStatus ==   "ClientOtherError"</span></span> |<span data-ttu-id="d98be-421">伺服器</span><span class="sxs-lookup"><span data-stu-id="d98be-421">Server</span></span> |
| <span data-ttu-id="d98be-422">Nagle 警告</span><span class="sxs-lookup"><span data-stu-id="d98be-422">Nagle   Warning</span></span> |<span data-ttu-id="d98be-423">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) 和 (AzureStorageLog.RequestPacketSize <1460) 和 (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span><span class="sxs-lookup"><span data-stu-id="d98be-423">((AzureStorageLog.EndToEndLatencyMS   - AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS *   1.5)) and (AzureStorageLog.RequestPacketSize <1460) and (AzureStorageLog.EndToEndLatencyMS -   AzureStorageLog.ServerLatencyMS >= 200)</span></span> |<span data-ttu-id="d98be-424">伺服器</span><span class="sxs-lookup"><span data-stu-id="d98be-424">Server</span></span> |
| <span data-ttu-id="d98be-425">伺服器和網路記錄檔中的時間範圍</span><span class="sxs-lookup"><span data-stu-id="d98be-425">Range of   time in Server and Network logs</span></span> |<span data-ttu-id="d98be-426">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="d98be-426">#Timestamp   >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39</span></span> |<span data-ttu-id="d98be-427">伺服器、網路</span><span class="sxs-lookup"><span data-stu-id="d98be-427">Server, Network</span></span> |
| <span data-ttu-id="d98be-428">伺服器記錄檔中的時間範圍</span><span class="sxs-lookup"><span data-stu-id="d98be-428">Range of   time in Server logs</span></span> |<span data-ttu-id="d98be-429">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 和 AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span><span class="sxs-lookup"><span data-stu-id="d98be-429">AzureStorageLog.Timestamp   >= 2014-10-20T16:36:38 and AzureStorageLog.Timestamp <=   2014-10-20T16:36:39</span></span> |<span data-ttu-id="d98be-430">伺服器</span><span class="sxs-lookup"><span data-stu-id="d98be-430">Server</span></span> |

## <a name="next-steps"></a><span data-ttu-id="d98be-431">後續步驟</span><span class="sxs-lookup"><span data-stu-id="d98be-431">Next steps</span></span>
<span data-ttu-id="d98be-432">如需在 Azure 儲存體中進行端對端案例疑難排解的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="d98be-432">For more information about troubleshooting end-to-end scenarios in Azure Storage, see these resources:</span></span>

* [<span data-ttu-id="d98be-433">監視、診斷與疑難排解 Microsoft Azure 儲存體</span><span class="sxs-lookup"><span data-stu-id="d98be-433">Monitor, diagnose, and troubleshoot Microsoft Azure Storage</span></span>](storage-monitoring-diagnosing-troubleshooting.md)
* [<span data-ttu-id="d98be-434">Storage Analytics</span><span class="sxs-lookup"><span data-stu-id="d98be-434">Storage Analytics</span></span>](http://msdn.microsoft.com/library/azure/hh343270.aspx)
* [<span data-ttu-id="d98be-435">在 Azure 入口網站中監視儲存體帳戶</span><span class="sxs-lookup"><span data-stu-id="d98be-435">Monitor a storage account in the Azure portal</span></span>](storage-monitor-storage-account.md)
* [<span data-ttu-id="d98be-436">使用 AzCopy 命令列公用程式傳輸資料</span><span class="sxs-lookup"><span data-stu-id="d98be-436">Transfer data with the AzCopy Command-Line Utility</span></span>](storage-use-azcopy.md)
* [<span data-ttu-id="d98be-437">Microsoft Message Analyzer 操作指南</span><span class="sxs-lookup"><span data-stu-id="d98be-437">Microsoft Message Analyzer Operating Guide</span></span>](http://technet.microsoft.com/library/jj649776.aspx)
