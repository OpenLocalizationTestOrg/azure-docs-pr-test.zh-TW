---
title: "Web 應用程式效能監視 - Azure Application Insights | Microsoft Docs"
description: "Application Insights 如何融入 DevOps 循環"
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.assetid: 479522a9-ff5c-471e-a405-b8fa221aedb3
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: multiple
ms.topic: article
ms.date: 03/14/2017
ms.author: bwren
ms.openlocfilehash: de94633cabaa7a1562a5a4839a8a8924da91a283
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/18/2017
---
# <a name="deep-diagnostics-for-web-apps-and-services-with-application-insights"></a><span data-ttu-id="50728-103">使用 Application Insights 深入診斷 Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="50728-103">Deep diagnostics for web apps and services with Application Insights</span></span>
## <a name="why-do-i-need-application-insights"></a><span data-ttu-id="50728-104">我為什麼需要 Application Insights 呢？</span><span class="sxs-lookup"><span data-stu-id="50728-104">Why do I need Application Insights?</span></span>
<span data-ttu-id="50728-105">Application Insights 會監視您正在執行的 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="50728-105">Application Insights monitors your running web app.</span></span> <span data-ttu-id="50728-106">它會告訴您有關失敗和效能的問題，並協助您分析客戶如何使用您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="50728-106">It tells you about failures and performance issues, and helps you analyze how customers use your app.</span></span> <span data-ttu-id="50728-107">它適用於在許多平台 (ASP.NET、J2EE、Node.js ...) 上執行的應用程式，並可裝載於雲端或內部部署。</span><span class="sxs-lookup"><span data-stu-id="50728-107">It works for apps running on many platforms (ASP.NET, J2EE, Node.js, ...) and is hosted either in the Cloud or on-premises.</span></span> 

![傳遞 Web 應用程式的複雜度層面](./media/app-insights-devops/010.png)

<span data-ttu-id="50728-109">在執行時現代應用程式加以監視十分重要。</span><span class="sxs-lookup"><span data-stu-id="50728-109">It's essential to monitor a modern application while it is running.</span></span> <span data-ttu-id="50728-110">最重要的是，您想要在大部分客戶之前偵測到失敗。</span><span class="sxs-lookup"><span data-stu-id="50728-110">Most importantly, you want to detect failures before most of your customers do.</span></span> <span data-ttu-id="50728-111">您也會想要找出並修正效能問題，儘管這並不嚴重，但或許有某些動作速度變慢，或對您的使用者造成些許不便。</span><span class="sxs-lookup"><span data-stu-id="50728-111">You also want to discover and fix performance issues that, while not catastrophic, perhaps slow things down or cause some inconvenience to your users.</span></span> <span data-ttu-id="50728-112">當您滿意系統的執行時，會想要知道使用者正利用它來執行哪些動作︰他們正在使用最新功能嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-112">And when the system is performing to your satisfaction, you want to know what the users are doing with it: Are they using the latest feature?</span></span> <span data-ttu-id="50728-113">是否已成功使用它？</span><span class="sxs-lookup"><span data-stu-id="50728-113">Are they succeeding with it?</span></span>

<span data-ttu-id="50728-114">現代 Web 應用程式是以持續傳遞週期來開發的︰發行新功能或改進功能；觀察其對於使用者的適用程度；根據該知識來規劃下一個增量開發。</span><span class="sxs-lookup"><span data-stu-id="50728-114">Modern web applications are developed in a cycle of continuous delivery: release a new feature or improvement; observe how well it works for the users; plan the next increment of development based on that knowledge.</span></span> <span data-ttu-id="50728-115">此週期的關鍵部分是觀察階段。</span><span class="sxs-lookup"><span data-stu-id="50728-115">A key part of this cycle is the observation phase.</span></span> <span data-ttu-id="50728-116">Application Insights 提供工具來監視 Web 應用程式的效能和使用方式。</span><span class="sxs-lookup"><span data-stu-id="50728-116">Application Insights provides the tools to monitor a web application for performance and usage.</span></span>

<span data-ttu-id="50728-117">此程序最重要的方面是診斷和判斷。</span><span class="sxs-lookup"><span data-stu-id="50728-117">The most important aspect of this process is diagnostics and diagnosis.</span></span> <span data-ttu-id="50728-118">如果應用程式失敗，則會造成商務損失。</span><span class="sxs-lookup"><span data-stu-id="50728-118">If the application fails, then business is being lost.</span></span> <span data-ttu-id="50728-119">因此，監視架構的主要角色是以可靠的方式偵測失敗、立即通知您，並為您呈現診斷問題所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="50728-119">The prime role of a monitoring framework is therefore to detect failures reliably, notify you immediately, and to present you with the information needed to diagnose the problem.</span></span> <span data-ttu-id="50728-120">這就是 Application Insights 的確實功用。</span><span class="sxs-lookup"><span data-stu-id="50728-120">This is exactly what Application Insights does.</span></span>

### <a name="where-do-bugs-come-from"></a><span data-ttu-id="50728-121">Bug 來自何處？</span><span class="sxs-lookup"><span data-stu-id="50728-121">Where do bugs come from?</span></span>
<span data-ttu-id="50728-122">Web 系統中的失敗通常是由組態問題或其許多元件之間的互動不良所引起。</span><span class="sxs-lookup"><span data-stu-id="50728-122">Failures in web systems typically arise from configuration issues or bad interactions between their many components.</span></span> <span data-ttu-id="50728-123">因此，處理即時網站事件時的首要任務就是找出問題所在︰原因出自於哪些元件或關聯性？</span><span class="sxs-lookup"><span data-stu-id="50728-123">The first task when tackling a live site incident is therefore to identify the locus of the problem: which component or relationship is the cause?</span></span>

<span data-ttu-id="50728-124">我們之中有些人 (灰白頭髮的那些人) 可能還記得那個電腦程式只在一部電腦中執行的單純年代。</span><span class="sxs-lookup"><span data-stu-id="50728-124">Some of us, those with gray hair, can remember a simpler era in which a computer program ran in one computer.</span></span> <span data-ttu-id="50728-125">開發人員會在交付之前徹底地測試該程式；但交付之後，就很少會再看見或聽到任何有關該程式的事。</span><span class="sxs-lookup"><span data-stu-id="50728-125">The developers would test it thoroughly before shipping it; and having shipped it, would rarely see or think about it again.</span></span> <span data-ttu-id="50728-126">使用者必須忍受殘留的 Bug 長達數年之久。</span><span class="sxs-lookup"><span data-stu-id="50728-126">The users would have to put up with the residual bugs for many years.</span></span> 

<span data-ttu-id="50728-127">但現在的情況已變得非常不同。</span><span class="sxs-lookup"><span data-stu-id="50728-127">Things are so very different now.</span></span> <span data-ttu-id="50728-128">您的應用程式要在眾多不同的裝置上執行，而且很難保證在每一個裝置上都會有完全相同的行為。</span><span class="sxs-lookup"><span data-stu-id="50728-128">Your app has a plethora of different devices to run on, and it can be difficult to guarantee the exact same behavior on each one.</span></span> <span data-ttu-id="50728-129">在雲端中裝載應用程式，表示 Bug 可以快速修正，但這也表示競賽持續進行，並預期新功能會以更頻繁的間隔出現。</span><span class="sxs-lookup"><span data-stu-id="50728-129">Hosting apps in the cloud means bugs can be fixed fast, but it also means continuous competition and the expectation of new features at frequent intervals.</span></span> 

<span data-ttu-id="50728-130">在這些情況下，確實控制 Bug 計數的唯一方式是將單位測試自動化。</span><span class="sxs-lookup"><span data-stu-id="50728-130">In these conditions, the only way to keep a firm control on the bug count is automated unit testing.</span></span> <span data-ttu-id="50728-131">您無法在每次交付時手動重新測試一切。</span><span class="sxs-lookup"><span data-stu-id="50728-131">It would be impossible to manually re-test everything on every delivery.</span></span> <span data-ttu-id="50728-132">單元測試現在是建置程序中常見的一部分。</span><span class="sxs-lookup"><span data-stu-id="50728-132">Unit test is now a commonplace part of the build process.</span></span> <span data-ttu-id="50728-133">像是 Xamarin Test Cloud 的工具可藉由在多個瀏覽器版本中提供自動化 UI 測試來提供協助。</span><span class="sxs-lookup"><span data-stu-id="50728-133">Tools such as the Xamarin Test Cloud help by providing automated UI testing on multiple browser versions.</span></span> <span data-ttu-id="50728-134">這些測試制度讓我們能夠期望在應用程式內發現 Bug 的速度可以保持在最低限度。</span><span class="sxs-lookup"><span data-stu-id="50728-134">These testing regimes allow us to hope that the rate of bugs found inside an app can be kept to a minimum.</span></span>

<span data-ttu-id="50728-135">典型的 Web 應用程式有許多即時元件。</span><span class="sxs-lookup"><span data-stu-id="50728-135">Typical web applications have many live components.</span></span> <span data-ttu-id="50728-136">除了用戶端 (在瀏覽器或裝置應用程式中) 和 Web 伺服器以外，還可能是實質的後端處理。</span><span class="sxs-lookup"><span data-stu-id="50728-136">In addition to the client (in a browser or device app) and the web server, there's likely to be substantial backend processing.</span></span> <span data-ttu-id="50728-137">後端或許是元件的管線，或是鬆散的共同作業項目集合。</span><span class="sxs-lookup"><span data-stu-id="50728-137">Perhaps the backend is a pipeline of components, or a looser collection of collaborating pieces.</span></span> <span data-ttu-id="50728-138">此外，它們其中有許多都不在您的控制內 - 它們是您所需的外部服務。</span><span class="sxs-lookup"><span data-stu-id="50728-138">And many of them won't be in your control - they're external services on which you depend.</span></span>

<span data-ttu-id="50728-139">在這類組態中，很難以經濟實惠的方式測試或預見每個可能的失敗模式 (除了即時系統本身)。</span><span class="sxs-lookup"><span data-stu-id="50728-139">In configurations like these, it can be difficult and uneconomical to test for, or foresee, every possible failure mode, other than in the live system itself.</span></span> 

### <a name="questions-"></a><span data-ttu-id="50728-140">問題 ...</span><span class="sxs-lookup"><span data-stu-id="50728-140">Questions ...</span></span>
<span data-ttu-id="50728-141">當我們開發 Web 系統時，會自問數個問題：</span><span class="sxs-lookup"><span data-stu-id="50728-141">Some questions we ask when we're developing a web system:</span></span>

* <span data-ttu-id="50728-142">我的應用程式會當機嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-142">Is my app crashing?</span></span> 
* <span data-ttu-id="50728-143">實際發生什麼事？</span><span class="sxs-lookup"><span data-stu-id="50728-143">What exactly happened?</span></span> <span data-ttu-id="50728-144">- 如果要求失敗，我想要知道問題出在哪裡。</span><span class="sxs-lookup"><span data-stu-id="50728-144">- If it failed a request, I want to know how it got there.</span></span> <span data-ttu-id="50728-145">我們需要追蹤事件 ...</span><span class="sxs-lookup"><span data-stu-id="50728-145">We need a trace of events...</span></span>
* <span data-ttu-id="50728-146">我的應用程式速度夠快嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-146">Is my app fast enough?</span></span> <span data-ttu-id="50728-147">回應典型的要求需要多久的時間？</span><span class="sxs-lookup"><span data-stu-id="50728-147">How long does it take to respond to typical requests?</span></span>
* <span data-ttu-id="50728-148">伺服器可以處理負載嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-148">Can the server handle the load?</span></span> <span data-ttu-id="50728-149">當要求的速率增加時，可以維持穩定的回應時間嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-149">When the rate of requests rises, does the response time hold steady?</span></span>
* <span data-ttu-id="50728-150">如何回應是我的相依性 - REST API、資料庫，以及我的應用程式呼叫的其他元件。</span><span class="sxs-lookup"><span data-stu-id="50728-150">How responsive are my dependencies - the REST APIs, databases and other components that my app calls.</span></span> <span data-ttu-id="50728-151">尤其當系統變慢時，是我的元件所造成，還是我正在接收來自其他人的慢速回應？</span><span class="sxs-lookup"><span data-stu-id="50728-151">In particular, if the system is slow, is it my component, or am I getting slow responses from someone else?</span></span>
* <span data-ttu-id="50728-152">我的應用程式是否正在運作？</span><span class="sxs-lookup"><span data-stu-id="50728-152">Is my app Up or Down?</span></span> <span data-ttu-id="50728-153">全世界都可以看到它嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-153">Can it be seen from around the world?</span></span> <span data-ttu-id="50728-154">讓我知道它是否會停止...</span><span class="sxs-lookup"><span data-stu-id="50728-154">Let me know if it stops....</span></span>
* <span data-ttu-id="50728-155">根本原因為何？</span><span class="sxs-lookup"><span data-stu-id="50728-155">What is the root cause?</span></span> <span data-ttu-id="50728-156">失敗是在我的元件中，還是相依性的問題？</span><span class="sxs-lookup"><span data-stu-id="50728-156">Was the failure in my component or a dependency?</span></span> <span data-ttu-id="50728-157">是通訊問題嗎？</span><span class="sxs-lookup"><span data-stu-id="50728-157">Is it a communication issue?</span></span>
* <span data-ttu-id="50728-158">有多少使用者受到影響？</span><span class="sxs-lookup"><span data-stu-id="50728-158">How many users are impacted?</span></span> <span data-ttu-id="50728-159">如果我有一個以上要解決的問題，哪一個問題最重要？</span><span class="sxs-lookup"><span data-stu-id="50728-159">If I have more than one issue to tackle, which is the most important?</span></span>

## <a name="what-is-application-insights"></a><span data-ttu-id="50728-160">什麼是 Application Insights？</span><span class="sxs-lookup"><span data-stu-id="50728-160">What is Application Insights?</span></span>
![Application Insights 的基本工作流程](./media/app-insights-devops/020.png)

1. <span data-ttu-id="50728-162">Application Insights 會檢測您的應用程式，並在應用程式執行時，傳送相關的遙測。</span><span class="sxs-lookup"><span data-stu-id="50728-162">Application Insights instruments your app and sends telemetry about it while the app is running.</span></span> <span data-ttu-id="50728-163">您可以在應用程式中建置 Application Insights SDK，或者可以在執行階段運用檢測。</span><span class="sxs-lookup"><span data-stu-id="50728-163">Either you can build the Application Insights SDK into the app, or you can apply instrumentation at runtime.</span></span> <span data-ttu-id="50728-164">前者是更有彈性的方法，因為您可以將自己的遙測新增到一般模組。</span><span class="sxs-lookup"><span data-stu-id="50728-164">The former method is more flexible, as you can add your own telemetry to the regular modules.</span></span>
2. <span data-ttu-id="50728-165">遙測會傳送到 Application Insights 入口網站，且在其中儲存並處理它</span><span class="sxs-lookup"><span data-stu-id="50728-165">The telemetry is sent to the Application Insights portal, where it is stored and processed.</span></span> <span data-ttu-id="50728-166">(雖然 Application Insights 裝載於 Microsoft Azure 中，但是它可以監視任何 Web 應用程式，而不只是 Azure 應用程式)。</span><span class="sxs-lookup"><span data-stu-id="50728-166">(Although Application Insights is hosted in Microsoft Azure, it can monitor any web apps - not just Azure apps.)</span></span>
3. <span data-ttu-id="50728-167">遙測會以事件的圖表和表格形式來呈現。</span><span class="sxs-lookup"><span data-stu-id="50728-167">The telemetry is presented to you in the form of charts and tables of events.</span></span>

<span data-ttu-id="50728-168">遙測有兩種主要類型︰彙總與原始執行個體。</span><span class="sxs-lookup"><span data-stu-id="50728-168">There are two main types of telemetry: aggregated and raw instances.</span></span> 

* <span data-ttu-id="50728-169">例如，執行個體資料包含您的 Web 應用程式所收到的要求報告。</span><span class="sxs-lookup"><span data-stu-id="50728-169">Instance data includes, for example, a report of a request that has been received by your web app.</span></span> <span data-ttu-id="50728-170">您可以使用 Application Insights 入口網站中的搜尋工具，尋找並檢查要求的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="50728-170">You can find for and inspect the details of a request using the Search tool in the Application Insights portal.</span></span> <span data-ttu-id="50728-171">執行個體所包含的資料如下：您的應用程式要花費多少時間來回應要求，以及要求的 URL、用戶端的大約位置和其他資料。</span><span class="sxs-lookup"><span data-stu-id="50728-171">The instance would include data such as how long your app took to respond to the request, as well as the requested URL, approximate location of the client, and other data.</span></span>
* <span data-ttu-id="50728-172">彙總的資料包含每個單位時間的事件計數，因此您可以將要求速率與回應時間進行比較。</span><span class="sxs-lookup"><span data-stu-id="50728-172">Aggregated data includes counts of events per unit time, so that you can compare the rate of requests with the response times.</span></span> <span data-ttu-id="50728-173">它也包含像是要求回應時間的計量資訊。</span><span class="sxs-lookup"><span data-stu-id="50728-173">It also includes averages of metrics such as request response times.</span></span>

<span data-ttu-id="50728-174">資料的主要類別如下：</span><span class="sxs-lookup"><span data-stu-id="50728-174">The main categories of data are:</span></span>

* <span data-ttu-id="50728-175">對您應用程式的要求 (通常是 HTTP 要求)，其中含有 URL 上的資料、回應時間，以及成功或失敗。</span><span class="sxs-lookup"><span data-stu-id="50728-175">Requests to your app (usually HTTP requests), with data on URL, response time, and success or failure.</span></span>
* <span data-ttu-id="50728-176">相依性 - 您的應用程式所進行的 REST 和 SQL 呼叫，也包含 URI、回應時間和成功</span><span class="sxs-lookup"><span data-stu-id="50728-176">Dependencies - REST and SQL calls made by your app, also with URI, response times and success</span></span>
* <span data-ttu-id="50728-177">例外狀況，包括堆疊追蹤。</span><span class="sxs-lookup"><span data-stu-id="50728-177">Exceptions, including stack traces.</span></span>
* <span data-ttu-id="50728-178">頁面檢視資料，此資料來自使用者的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="50728-178">Page view data, which come from the users' browsers.</span></span>
* <span data-ttu-id="50728-179">計量資訊 (例如效能計數器)，以及您自行撰寫的計量。</span><span class="sxs-lookup"><span data-stu-id="50728-179">Metrics such as performance counters, as well as metrics you write yourself.</span></span> 
* <span data-ttu-id="50728-180">您可以用來追蹤商務事件的自訂事件</span><span class="sxs-lookup"><span data-stu-id="50728-180">Custom events that you can use to track business events</span></span>
* <span data-ttu-id="50728-181">用來偵錯的記錄追蹤。</span><span class="sxs-lookup"><span data-stu-id="50728-181">Log traces used for debugging.</span></span>

## <a name="case-study-real-madrid-fc"></a><span data-ttu-id="50728-182">案例研究：西班牙皇家馬德里隊</span><span class="sxs-lookup"><span data-stu-id="50728-182">Case Study: Real Madrid F.C.</span></span>
<span data-ttu-id="50728-183">[皇家馬德里足球俱樂部](http://www.realmadrid.com/) 的 Web 服務可服務世界各地大約 450 百萬名球迷。</span><span class="sxs-lookup"><span data-stu-id="50728-183">The web service of [Real Madrid Football Club](http://www.realmadrid.com/) serves about 450 million fans around the world.</span></span> <span data-ttu-id="50728-184">球迷可透過 Web 瀏覽器和俱樂部的行動應用程式來存取此服務。</span><span class="sxs-lookup"><span data-stu-id="50728-184">Fans access it both through web browsers and the Club's mobile apps.</span></span> <span data-ttu-id="50728-185">球迷不只可預約門票，也能存取比賽結果、選手及即將舉行的比賽相關資訊和影片剪輯。</span><span class="sxs-lookup"><span data-stu-id="50728-185">Fans can not only book tickets, but also access information and video clips on results, players and upcoming games.</span></span> <span data-ttu-id="50728-186">他們會使用像是得分進球數等篩選條件進行搜尋。</span><span class="sxs-lookup"><span data-stu-id="50728-186">They can search with filters such as numbers of goals scored.</span></span> <span data-ttu-id="50728-187">另外還提供社交媒體的連結。</span><span class="sxs-lookup"><span data-stu-id="50728-187">There are also links to social media.</span></span> <span data-ttu-id="50728-188">使用者體驗已高度個人化，並設計為可讓球迷參與的雙向溝通。</span><span class="sxs-lookup"><span data-stu-id="50728-188">The user experience is highly personalized, and is designed as a two-way communication to engage fans.</span></span>

<span data-ttu-id="50728-189">此解決方案[是一個 Microsoft Azure 上應用程式和服務的系統](https://www.microsoft.com/en-us/enterprise/microsoftcloud/realmadrid.aspx)。</span><span class="sxs-lookup"><span data-stu-id="50728-189">The solution [is a system of services and applications on Microsoft Azure](https://www.microsoft.com/en-us/enterprise/microsoftcloud/realmadrid.aspx).</span></span> <span data-ttu-id="50728-190">延展性是關鍵需求︰流量變化無常，而且可在比賽期間和接近比賽時達到非常高的量。</span><span class="sxs-lookup"><span data-stu-id="50728-190">Scalability is a key requirement: traffic is variable and can reach very high volumes during and around matches.</span></span>

<span data-ttu-id="50728-191">對於皇家馬德里而言，監視系統效能是非常重要的。</span><span class="sxs-lookup"><span data-stu-id="50728-191">For Real Madrid, it's vital to monitor the system's performance.</span></span> <span data-ttu-id="50728-192">Azure Application Insights 能夠提供整個系統的完整檢視，確保提供既可靠又高等級的服務。</span><span class="sxs-lookup"><span data-stu-id="50728-192">Azure Application Insights provides a comprehensive view across the system, ensuring a reliable and high level of service.</span></span> 

<span data-ttu-id="50728-193">俱樂部也能對球迷進行深入了解︰他們的所在位置 (只有 3% 在西班牙)、他們對於球員、歷史記錄和即將舉行的比賽感興趣的程度為何，以及他們如何回應每場比賽結果。</span><span class="sxs-lookup"><span data-stu-id="50728-193">The Club also gets in-depth understanding of its fans: where they are (only 3% are in Spain), what interest they have in players, historical results, and upcoming games, and how they respond to match outcomes.</span></span>

<span data-ttu-id="50728-194">此遙測資料中大多數都會自動收集，而不需要新增任何程式碼，這可簡化解決方案並降低操作複雜度。</span><span class="sxs-lookup"><span data-stu-id="50728-194">Most of this telemetry data is automatically collected with no added code, which  simplified the solution and reduced operational complexity.</span></span>  <span data-ttu-id="50728-195">對於皇家馬德里而言，Application Insights 每個月可處理 38 億個遙測點。</span><span class="sxs-lookup"><span data-stu-id="50728-195">For Real Madrid, Application Insights deals with 3.8 billion telemetry points each month.</span></span>

<span data-ttu-id="50728-196">皇家馬德里會使用 Power BI 模組來檢視其遙測。</span><span class="sxs-lookup"><span data-stu-id="50728-196">Real Madrid uses the Power BI module to view their telemetry.</span></span>

![Application Insights 遙測的 Power BI 檢視](./media/app-insights-devops/080.png)

## <a name="smart-detection"></a><span data-ttu-id="50728-198">智慧型偵測</span><span class="sxs-lookup"><span data-stu-id="50728-198">Smart detection</span></span>
<span data-ttu-id="50728-199">[主動診斷](app-insights-proactive-diagnostics.md)是一項最新功能。</span><span class="sxs-lookup"><span data-stu-id="50728-199">[Proactive diagnostics](app-insights-proactive-diagnostics.md) is a recent feature.</span></span> <span data-ttu-id="50728-200">您不需提供任何特殊組態，Application Insights 就會自動偵測並警示您，關於您應用程式中異常提高的失敗率。</span><span class="sxs-lookup"><span data-stu-id="50728-200">Without any special configuration by you, Application Insights automatically detects and alerts you about unusual rises in failure rates in your app.</span></span> <span data-ttu-id="50728-201">它的智慧型功能足以忽略偶爾失敗的背景，而且也只會依要求中的增加比率按比例提高。</span><span class="sxs-lookup"><span data-stu-id="50728-201">It's smart enough to ignore a background of occasional failures, and also rises that are simply proportionate to a rise in requests.</span></span> <span data-ttu-id="50728-202">例如，如果您依存的其中一個服務中發生失敗，或者如果您剛部署的新組建並沒有運作得很好，則當您查看電子郵件之後立即就能了解相關資訊</span><span class="sxs-lookup"><span data-stu-id="50728-202">So for example, if there's a failure in one of the services you depend on, or if the new build you just deployed isn't working so well, then you'll know about it as soon as you look at your email.</span></span> <span data-ttu-id="50728-203">(而且會提供 Webhook，讓您能夠觸發其他應用程式)。</span><span class="sxs-lookup"><span data-stu-id="50728-203">(And there are webhooks so that you can trigger other apps.)</span></span>

<span data-ttu-id="50728-204">這項功能的另一個層面會針對遙測執行每日的深入分析，以找出很難發現的異常效能模式。</span><span class="sxs-lookup"><span data-stu-id="50728-204">Another aspect of this feature performs a daily in-depth analysis of your telemetry, looking for unusual patterns of performance that are hard to discover.</span></span> <span data-ttu-id="50728-205">例如，它會找到與特定地理區域或特定瀏覽器版本相關聯的慢速效能。</span><span class="sxs-lookup"><span data-stu-id="50728-205">For example, it can find slow performance associated with a particular geographical area, or with a particular browser version.</span></span>

<span data-ttu-id="50728-206">在這兩種情況下，警示不只會通知您它發現的徵兆，還會為您提供有助於診斷問題所需的資料，例如相關的例外狀況報告。</span><span class="sxs-lookup"><span data-stu-id="50728-206">In both cases, the alert not only tells you the symptoms it's discovered, but also gives you data you need to help diagnose the problem, such as relevant exception reports.</span></span>

![來自主動診斷的電子郵件](./media/app-insights-devops/030.png)

<span data-ttu-id="50728-208">客戶 Samtec 說：「在最近的功能快速轉換期間，我們發現低於調整規模的資料庫已到達它的資源限制並導致逾時。</span><span class="sxs-lookup"><span data-stu-id="50728-208">Customer Samtec said: "During a recent feature cutover, we found an under-scaled database that was hitting its resource limits and causing timeouts.</span></span> <span data-ttu-id="50728-209">主動偵測警示會在我們分類問題時逐字顯現，非常接近即時公告。</span><span class="sxs-lookup"><span data-stu-id="50728-209">Proactive detection alerts came through literally as we were triaging the issue, very near real time as advertised.</span></span> <span data-ttu-id="50728-210">這個與 Azure 平台相結合的警示，幾乎可協助我們即時修正問題。</span><span class="sxs-lookup"><span data-stu-id="50728-210">This alert coupled with the Azure platform alerts helped us almost instantly fix the issue.</span></span> <span data-ttu-id="50728-211">總停機時間 < 10 分鐘。」</span><span class="sxs-lookup"><span data-stu-id="50728-211">Total downtime < 10 minutes."</span></span>

## <a name="live-metrics-stream"></a><span data-ttu-id="50728-212">即時計量串流</span><span class="sxs-lookup"><span data-stu-id="50728-212">Live Metrics Stream</span></span>
<span data-ttu-id="50728-213">部署最新組建是令人焦慮的體驗。</span><span class="sxs-lookup"><span data-stu-id="50728-213">Deploying the latest build can be an anxious experience.</span></span> <span data-ttu-id="50728-214">如果有任何問題，您會希望立即了解它們，讓您能夠在必要時取消部署。</span><span class="sxs-lookup"><span data-stu-id="50728-214">If there are any problems, you want to know about them right away, so that you can back out if necessary.</span></span> <span data-ttu-id="50728-215">即時計量串流可為您提供大約 1 秒延遲的關鍵計量。</span><span class="sxs-lookup"><span data-stu-id="50728-215">Live Metrics Stream gives you key metrics with a latency of about one second.</span></span>

![即時計量](./media/app-insights-devops/040.png)

<span data-ttu-id="50728-217">並可讓您立即檢查任何失敗或例外狀況的樣本。</span><span class="sxs-lookup"><span data-stu-id="50728-217">And lets you immediately inspect a sample of any failures or exceptions.</span></span>

![即時失敗事件](./media/app-insights-devops/live-stream-failures.png)

## <a name="application-map"></a><span data-ttu-id="50728-219">應用程式對應</span><span class="sxs-lookup"><span data-stu-id="50728-219">Application Map</span></span>
<span data-ttu-id="50728-220">應用程式對應會自動探索您的應用程式拓撲 (在其上方放置效能資訊)，讓您能夠輕易地在整個分散式環境中識別出效能瓶頸和有問題的流程。</span><span class="sxs-lookup"><span data-stu-id="50728-220">Application Map automatically discovers your application topology, laying the performance information on top of it, to let you easily identify performance bottlenecks and problematic flows across your distributed environment.</span></span> <span data-ttu-id="50728-221">它可讓您探索 Azure 服務上的應用程式相依性。</span><span class="sxs-lookup"><span data-stu-id="50728-221">It allows you to discover application dependencies on Azure Services.</span></span> <span data-ttu-id="50728-222">您可以藉由了解問題是否與程式碼相關或與相依性相關，並從單一位置向內切入到相關診斷體驗，來將問題分類。</span><span class="sxs-lookup"><span data-stu-id="50728-222">You can triage the problem by understanding if it is code-related or dependency related and from a single place drill into related diagnostics experience.</span></span> <span data-ttu-id="50728-223">例如，您的應用程式可能會因為 SQL 層的效能降低而失敗。</span><span class="sxs-lookup"><span data-stu-id="50728-223">For example, your application may be failing due to performance degradation in SQL tier.</span></span> <span data-ttu-id="50728-224">利用應用程式對應，您可以立即看見它並鑽研 SQL 索引建議程式或 Query Insights 體驗。</span><span class="sxs-lookup"><span data-stu-id="50728-224">With application map, you can see it immediately and drill into the SQL Index Advisor or Query Insights experience.</span></span>

![應用程式對應](./media/app-insights-devops/050.png)

## <a name="application-insights-analytics"></a><span data-ttu-id="50728-226">Application Insights 分析</span><span class="sxs-lookup"><span data-stu-id="50728-226">Application Insights Analytics</span></span>
<span data-ttu-id="50728-227">使用 [分析](app-insights-analytics.md)，您就能利用功能強大的 SQL 式語言撰寫任意查詢。</span><span class="sxs-lookup"><span data-stu-id="50728-227">With [Analytics](app-insights-analytics.md), you can write arbitrary queries in a powerful SQL-like language.</span></span>  <span data-ttu-id="50728-228">將各種不同的觀點連結在一起時，跨整個應用程式堆疊的診斷就會變得很容易，而您可以詢問正確的問題，以便將服務效能與商務計量和客戶體驗相互關聯。</span><span class="sxs-lookup"><span data-stu-id="50728-228">Diagnosing across the entire app stack becomes easy as various perspectives get connected and you can ask the right questions to correlate Service Performance with Business Metrics and Customer Experience.</span></span> 

<span data-ttu-id="50728-229">您可以查詢您儲存在入口網站中的所有遙測執行個體和未經處理的計量資料。</span><span class="sxs-lookup"><span data-stu-id="50728-229">You can query all your telemetry instance and metric raw data stored in the portal.</span></span> <span data-ttu-id="50728-230">語言包括篩選、聯結、彙總及其他作業。</span><span class="sxs-lookup"><span data-stu-id="50728-230">The language includes filter, join, aggregation, and other operations.</span></span> <span data-ttu-id="50728-231">您可以計算欄位並執行統計分析。</span><span class="sxs-lookup"><span data-stu-id="50728-231">You can calculate fields and perform statistical analysis.</span></span> <span data-ttu-id="50728-232">目前提供表格式和圖形視覺效果。</span><span class="sxs-lookup"><span data-stu-id="50728-232">There are both tabular and graphical visualizations.</span></span>

![分析查詢和結果圖表](./media/app-insights-devops/025.png)

<span data-ttu-id="50728-234">例如，很容易：</span><span class="sxs-lookup"><span data-stu-id="50728-234">For example, it's easy to:</span></span>

* <span data-ttu-id="50728-235">依客戶層區隔應用程式的要求效能資來了解他們的體驗。</span><span class="sxs-lookup"><span data-stu-id="50728-235">Segment your application’s request performance data by customer tiers to understand their experience.</span></span>
* <span data-ttu-id="50728-236">在即時網站調查期間，搜尋特定錯誤碼或自訂的事件名稱。</span><span class="sxs-lookup"><span data-stu-id="50728-236">Search for specific error codes or custom event names during live site investigations.</span></span>
* <span data-ttu-id="50728-237">向下切入特定客戶的應用程式使用方式，以了解需要和採用哪些功能。</span><span class="sxs-lookup"><span data-stu-id="50728-237">Drill down into the app usage of specific customers to understand how features are acquired and adopted.</span></span>
* <span data-ttu-id="50728-238">針對特定使用者追蹤工作階段與回應時間，讓支援和營運團隊能夠提供即時客戶支援。</span><span class="sxs-lookup"><span data-stu-id="50728-238">Track sessions and response times for specific users to enable support and operations teams to provide instant customer support.</span></span>
* <span data-ttu-id="50728-239">判斷常用的應用程式功能來回答應優先考慮的功能問題。</span><span class="sxs-lookup"><span data-stu-id="50728-239">Determine frequently used app features to answer feature prioritization questions.</span></span>

<span data-ttu-id="50728-240">客戶 DNN 說：「Application Insights 為我們提供了方程式中遺漏的部分，以便我們能夠視需要結合、排序、查詢及篩選資料。</span><span class="sxs-lookup"><span data-stu-id="50728-240">Customer DNN said: "Application Insights has provided us with the missing part of the equation for being able to combine, sort, query, and filter data as needed.</span></span> <span data-ttu-id="50728-241">讓我們的團隊可以使用他們自己的創意和體驗，利用功能強大的查詢語言來尋找資料，讓我們能夠得到相關見解，並解決我們甚至不曾知道我們發生的問題。</span><span class="sxs-lookup"><span data-stu-id="50728-241">Allowing our team to use their own ingenuity and experience to find data with a powerful query language has allowed us to find insights and solve problems we didn't even know we had.</span></span> <span data-ttu-id="50728-242">許多有趣的答案都是來自開頭為『我想知道如果...』的問題。」</span><span class="sxs-lookup"><span data-stu-id="50728-242">A lot of interesting answers come from the questions starting with *'I wonder if...'.*"</span></span>

## <a name="development-tools-integration"></a><span data-ttu-id="50728-243">開發工具整合</span><span class="sxs-lookup"><span data-stu-id="50728-243">Development tools integration</span></span>
### <a name="configuring-application-insights"></a><span data-ttu-id="50728-244">設定 Application Insights</span><span class="sxs-lookup"><span data-stu-id="50728-244">Configuring Application Insights</span></span>
<span data-ttu-id="50728-245">Visual Studio 和 Eclipse 提供工具，可為您正在開發的專案設定正確的 SDK 封裝。</span><span class="sxs-lookup"><span data-stu-id="50728-245">Visual Studio and Eclipse have tools to configure the correct SDK packages for the project you are developing.</span></span> <span data-ttu-id="50728-246">有一個功能表命令可新增 Application Insights。</span><span class="sxs-lookup"><span data-stu-id="50728-246">There's a menu command to add Application Insights.</span></span>

<span data-ttu-id="50728-247">如果您需要使用追蹤紀錄架構 (例如 Log4N、NLog 或 System.Diagnostics.Trace)，則您可以選擇將記錄傳送到 Application Insights 以及另一個遙測，因此可輕鬆地將追蹤與要求、相依性呼叫及例外狀況相互關聯。</span><span class="sxs-lookup"><span data-stu-id="50728-247">If you happen to be using a trace logging framework such as Log4N, NLog, or System.Diagnostics.Trace, then you get the option to send the logs to Application Insights along with the other telemetry, so that you can easily correlate the traces with requests, dependency calls, and exceptions.</span></span>

### <a name="search-telemetry-in-visual-studio"></a><span data-ttu-id="50728-248">在 Visual Studio 中搜尋遙測</span><span class="sxs-lookup"><span data-stu-id="50728-248">Search telemetry in Visual Studio</span></span>
<span data-ttu-id="50728-249">開發並偵錯功能時，您可以使用 Web 入口網站中的相同搜尋功能，在 Visual Studio 中直接搜尋遙測。</span><span class="sxs-lookup"><span data-stu-id="50728-249">While developing and debugging a feature, you can view and search the telemetry directly in Visual Studio, using the same search facilities as in the web portal.</span></span>

<span data-ttu-id="50728-250">此外，當 Application Insights 記錄例外狀況時，您可以在 Visual Studio 中檢視資料點，並直接跳到相關的程式碼。</span><span class="sxs-lookup"><span data-stu-id="50728-250">And when Application Insights logs an exception, you can view the data point in Visual Studio and jump straight to the relevant code.</span></span>

![Visual Studio 搜尋](./media/app-insights-devops/060.png)

<span data-ttu-id="50728-252">偵錯期間，您可以選擇將遙測保留於開發電腦中，在 Visual Studio 中加以檢視，但不會將它傳送到入口網站。</span><span class="sxs-lookup"><span data-stu-id="50728-252">During debugging, you have the option to keep the telemetry in your development machine, viewing it in Visual Studio but without sending it to the portal.</span></span> <span data-ttu-id="50728-253">此本機選項可避免與生產環境的遙測偵錯混合在一起。</span><span class="sxs-lookup"><span data-stu-id="50728-253">This local option avoids mixing debugging with production telemetry.</span></span>

### <a name="build-annotations"></a><span data-ttu-id="50728-254">建置註解</span><span class="sxs-lookup"><span data-stu-id="50728-254">Build annotations</span></span>
<span data-ttu-id="50728-255">如果您使用 Visual Studio Team Services 來建置和部署應用程式，則部署註解會出現在入口網站的圖表中。</span><span class="sxs-lookup"><span data-stu-id="50728-255">If you use Visual Studio Team Services to build and deploy your app, deployment annotations show up on charts in the portal.</span></span> <span data-ttu-id="50728-256">如果您的最新版本會在計量上產生任何效果，則會變得很明顯。</span><span class="sxs-lookup"><span data-stu-id="50728-256">If your latest release had any effect on the metrics, it becomes obvious.</span></span>

![建置註解](./media/app-insights-devops/070.png)

### <a name="work-items"></a><span data-ttu-id="50728-258">工作項目</span><span class="sxs-lookup"><span data-stu-id="50728-258">Work items</span></span>
<span data-ttu-id="50728-259">產生警示時，Application Insights 可以在您的工作追蹤系統中自動建立工作項目。</span><span class="sxs-lookup"><span data-stu-id="50728-259">When an alert is raised, Application Insights can automatically create a work item in your work tracking system.</span></span>

## <a name="but-what-about"></a><span data-ttu-id="50728-260">但是，您認為...？</span><span class="sxs-lookup"><span data-stu-id="50728-260">But what about...?</span></span>
* <span data-ttu-id="50728-261">[隱私權和儲存體](app-insights-data-retention-privacy.md) - 您的遙測會保留於 Azure 安全伺服器上。</span><span class="sxs-lookup"><span data-stu-id="50728-261">[Privacy and storage](app-insights-data-retention-privacy.md) - Your telemetry is kept on Azure secure servers.</span></span>
* <span data-ttu-id="50728-262">效能 - 影響很低。</span><span class="sxs-lookup"><span data-stu-id="50728-262">Performance - the impact is very low.</span></span> <span data-ttu-id="50728-263">遙測會進行批次處理。</span><span class="sxs-lookup"><span data-stu-id="50728-263">Telemetry is batched.</span></span>
* <span data-ttu-id="50728-264">[價格](app-insights-pricing.md) - 您可以開始免費使用，當您處於低用量期間可繼續使用。</span><span class="sxs-lookup"><span data-stu-id="50728-264">[Pricing](app-insights-pricing.md) - You can get started for free, and that continues while you're in low volume.</span></span>


## <a name="video"></a><span data-ttu-id="50728-265">影片</span><span class="sxs-lookup"><span data-stu-id="50728-265">Video</span></span>

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="next-steps"></a><span data-ttu-id="50728-266">後續步驟</span><span class="sxs-lookup"><span data-stu-id="50728-266">Next steps</span></span>
<span data-ttu-id="50728-267">開始使用 Application Insights 很簡單。</span><span class="sxs-lookup"><span data-stu-id="50728-267">Getting started with Application Insights is easy.</span></span> <span data-ttu-id="50728-268">主要選項包括：</span><span class="sxs-lookup"><span data-stu-id="50728-268">The main options are:</span></span>

* <span data-ttu-id="50728-269">檢測已在執行的 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="50728-269">Instrument an already-running web app.</span></span> <span data-ttu-id="50728-270">這可為您提供所有內建的效能遙測。</span><span class="sxs-lookup"><span data-stu-id="50728-270">This gives you all the built-in performance telemetry.</span></span> <span data-ttu-id="50728-271">其適用於 [Java](app-insights-java-live.md) 和 [IIS 伺服器](app-insights-monitor-performance-live-website-now.md)，以及 [Azure Web 應用程式](app-insights-azure.md)。</span><span class="sxs-lookup"><span data-stu-id="50728-271">It's available for [Java](app-insights-java-live.md) and [IIS servers](app-insights-monitor-performance-live-website-now.md), and also for [Azure web apps](app-insights-azure.md).</span></span>
* <span data-ttu-id="50728-272">在開發期間檢測您的專案。</span><span class="sxs-lookup"><span data-stu-id="50728-272">Instrument your project during development.</span></span> <span data-ttu-id="50728-273">您可以針對 [ASP.NET](app-insights-asp-net.md) 或 [Java](app-insights-java-get-started.md) 應用程式，以及 [Node.js](app-insights-nodejs.md) 和許多[其他類型](app-insights-platforms.md)執行此動作。</span><span class="sxs-lookup"><span data-stu-id="50728-273">You can do this for [ASP.NET](app-insights-asp-net.md) or [Java](app-insights-java-get-started.md) apps, as well as [Node.js](app-insights-nodejs.md) and a host of [other types](app-insights-platforms.md).</span></span> 
* <span data-ttu-id="50728-274">藉由新增簡短的程式碼片段來檢測 [任何網頁](app-insights-javascript.md) 。</span><span class="sxs-lookup"><span data-stu-id="50728-274">Instrument [any web page](app-insights-javascript.md) by adding a short code snippet.</span></span>

