---
title: "適用於 Azure 應用程式閘道的 Web 應用程式防火牆 (WAF) 簡介 | Microsoft Docs"
description: "本頁面提供適用於應用程式閘道的 Web 應用程式防火牆 (WAF) 的概觀。"
documentationcenter: na
services: application-gateway
author: amsriva
manager: rossort
editor: amsriva
ms.assetid: 04b362bc-6653-4765-86f6-55ee8ec2a0ff
ms.service: application-gateway
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/03/2017
ms.author: amsriva
ms.openlocfilehash: 50863b60f2843f033bdb07f4564d937cd6f0b7be
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="web-application-firewall-waf"></a><span data-ttu-id="3bd7b-103">Web 應用程式防火牆 (WAF)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-103">Web application firewall (WAF)</span></span>

<span data-ttu-id="3bd7b-104">Web 應用程式防火牆 (WAF) 是一項應用程式閘道功能，可提供 Web 應用程式的集中式保護，免於遭遇常見的攻擊和弱點。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-104">Web application firewall (WAF) is a feature of Application Gateway that provides centralized protection of your web applications from common exploits and vulnerabilities.</span></span> 

<span data-ttu-id="3bd7b-105">Web 應用程式防火牆會根據 [OWASP 核心規則集](https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project) 3.0 或 2.2.9 中的規則提供保護。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-105">Web application firewall is based on rules from the [OWASP core rule sets](https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project) 3.0 or 2.2.9.</span></span> <span data-ttu-id="3bd7b-106">Web 應用程式已逐漸成為利用常見已知弱點的惡意攻擊目標。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-106">Web applications are increasingly targets of malicious attacks that exploit common known vulnerabilities.</span></span> <span data-ttu-id="3bd7b-107">這些攻擊中最常見的是 SQL 插入式攻擊、跨網站指令碼攻擊等等。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-107">Common among these exploits are SQL injection attacks, cross site scripting attacks to name a few.</span></span> <span data-ttu-id="3bd7b-108">想要防止應用程式的程式碼受到這類攻擊會非常困難，而且可能需要對多層次的應用程式拓撲執行嚴格的維護、修補和監視工作。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-108">Preventing such attacks in application code can be challenging and may require rigorous maintenance, patching and monitoring at multiple layers of the application topology.</span></span> <span data-ttu-id="3bd7b-109">集中式 Web 應用程式防火牆有助於簡化安全性管理作業，且更加確保應用程式管理員能夠對抗威脅或入侵。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-109">A centralized web application firewall helps make security management much simpler and gives better assurance to application administrators against threats or intrusions.</span></span> <span data-ttu-id="3bd7b-110">相較於保護每個個別的 Web 應用程式，WAF 方案還可透過在中央位置修補已知弱點，更快地因應安全性威脅。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-110">A WAF solution can also react to a security threat faster by patching a known vulnerability at a central location versus securing each of individual web applications.</span></span> <span data-ttu-id="3bd7b-111">現有的應用程式閘道可以輕易地轉換成已啟用 Web 應用程式防火牆的應用程式閘道。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-111">Existing application gateways can be converted to a web application firewall enabled application gateway easily.</span></span>

![imageURLroute](./media/application-gateway-web-application-firewall-overview/WAF1.png)

<span data-ttu-id="3bd7b-113">應用程式閘道可做為應用程式傳遞控制器來運作，並提供 SSL 終止、Cookie 型工作階段同質、循環配置資源負載分配、內容型路由，以及裝載多個網站和安全性增強功能的能力。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-113">Application Gateway operates as an application delivery controller and offers SSL termination, cookie-based session affinity, round-robin load distribution, content-based routing, ability to host multiple websites and security enhancements.</span></span> <span data-ttu-id="3bd7b-114">應用程式閘道提供的安全性增強功能包括 SSL 原則管理和端對端 SSL 支援。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-114">Security enhancements offered by Application Gateway include SSL policy management, end to end SSL support.</span></span> <span data-ttu-id="3bd7b-115">直接整合到 ADC 供應項目的 WAF (Web 應用程式防火牆) 現已增強應用程式安全性。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-115">Application security is now strengthened by WAF (web application firewall) being directly integrated into the ADC offering.</span></span> <span data-ttu-id="3bd7b-116">這可讓您輕鬆地設定要管理的中央位置，並保護 Web 應用程式來對抗常見的 Web 弱點。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-116">This provides an easy to configure central location to manage and protect your web applications against common web vulnerabilities.</span></span>

## <a name="benefits"></a><span data-ttu-id="3bd7b-117">優點</span><span class="sxs-lookup"><span data-stu-id="3bd7b-117">Benefits</span></span>

<span data-ttu-id="3bd7b-118">應用程式閘道和 Web 應用程式防火牆提供的核心優勢如下︰</span><span class="sxs-lookup"><span data-stu-id="3bd7b-118">The following are the core benefits that Application Gateway and web application firewall provide:</span></span>

### <a name="protection"></a><span data-ttu-id="3bd7b-119">保護</span><span class="sxs-lookup"><span data-stu-id="3bd7b-119">Protection</span></span>

* <span data-ttu-id="3bd7b-120">不需修改後端程式碼就能保護 Web 應用程式不受 Web 弱點和攻擊的威脅。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-120">Protect your web application from web vulnerabilities and attacks without modification to backend code.</span></span>

* <span data-ttu-id="3bd7b-121">在應用程式閘道背後同時保護多個 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-121">Protect multiple web applications at the same time behind an application gateway.</span></span> <span data-ttu-id="3bd7b-122">應用程式閘道可在單一閘道背後支援裝載最多 20 個網站，而且全都利用 WAF 受到免於 Web 攻擊的保護。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-122">Application gateway supports hosting up to 20 websites behind a single gateway that could all be protected against web attacks with WAF.</span></span>

### <a name="monitoring"></a><span data-ttu-id="3bd7b-123">監視</span><span class="sxs-lookup"><span data-stu-id="3bd7b-123">Monitoring</span></span>

* <span data-ttu-id="3bd7b-124">使用即時 WAF 記錄來監視 Web 應用程式對抗攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-124">Monitor your web application against attacks using a real-time WAF log.</span></span> <span data-ttu-id="3bd7b-125">此記錄已經與 [Azure 監視器](../monitoring-and-diagnostics/monitoring-overview.md)整合，可追蹤 WAF 警示和記錄並輕鬆地監視趨勢。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-125">This log is integrated with [Azure Monitor](../monitoring-and-diagnostics/monitoring-overview.md) to track WAF alerts and logs and easily monitor trends.</span></span>

* <span data-ttu-id="3bd7b-126">WAF 即將與 Azure 資訊安全中心整合。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-126">WAF will be integrated with Azure Security Center soon.</span></span> <span data-ttu-id="3bd7b-127">Azure 資訊安全中心可供集中檢閱所有 Azure 資源的安全性狀態。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-127">Azure Security Center allows for a central view of the security state of all your Azure resources.</span></span>

### <a name="customization"></a><span data-ttu-id="3bd7b-128">自訂</span><span class="sxs-lookup"><span data-stu-id="3bd7b-128">Customization</span></span>

* <span data-ttu-id="3bd7b-129">能夠自訂 WAF 規則和規則群組，以符合您的應用程式需求並消除誤判。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-129">The ability to customize WAF rules and rule groups to suit your application requirements and eliminate false positives.</span></span>

## <a name="features"></a><span data-ttu-id="3bd7b-130">特性</span><span class="sxs-lookup"><span data-stu-id="3bd7b-130">Features</span></span>

<span data-ttu-id="3bd7b-131">Web 應用程式防火牆已預先設定為使用 CRS 3.0，或者您可以選擇使用 2.2.9。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-131">Web application firewall comes preconfigured with CRS 3.0 by default or you can choose to use 2.2.9.</span></span> <span data-ttu-id="3bd7b-132">CRS 3.0 的誤判情形低於 2.2.9。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-132">CRS 3.0 offers reduced false positives over 2.2.9.</span></span> <span data-ttu-id="3bd7b-133">能夠[自訂規則以符合您需求](application-gateway-customize-waf-rules-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-133">The ability to [customize rules to suit your needs](application-gateway-customize-waf-rules-portal.md) is provided.</span></span> <span data-ttu-id="3bd7b-134">Web 應用程式防火牆防禦的一些常見 Web 弱點包括︰</span><span class="sxs-lookup"><span data-stu-id="3bd7b-134">Some of the common web vulnerabilities which web application firewall protects against includes:</span></span>

* <span data-ttu-id="3bd7b-135">SQL 插入式攻擊保護</span><span class="sxs-lookup"><span data-stu-id="3bd7b-135">SQL injection protection</span></span>
* <span data-ttu-id="3bd7b-136">跨網站指令碼保護</span><span class="sxs-lookup"><span data-stu-id="3bd7b-136">Cross site scripting protection</span></span>
* <span data-ttu-id="3bd7b-137">常見 Web 攻擊保護，例如命令插入式攻擊、HTTP 要求走私、HTTP 回應分割和遠端檔案包含攻擊</span><span class="sxs-lookup"><span data-stu-id="3bd7b-137">Common Web Attacks Protection such as command injection, HTTP request smuggling, HTTP response splitting, and remote file inclusion attack</span></span>
* <span data-ttu-id="3bd7b-138">防範 HTTP 通訊協定違規</span><span class="sxs-lookup"><span data-stu-id="3bd7b-138">Protection against HTTP protocol violations</span></span>
* <span data-ttu-id="3bd7b-139">防範 HTTP 通訊協定異常行為，例如遺漏主機使用者代理程式和接受標頭</span><span class="sxs-lookup"><span data-stu-id="3bd7b-139">Protection against HTTP protocol anomalies such as missing host user-agent and accept headers</span></span>
* <span data-ttu-id="3bd7b-140">防範 Bot、編目程式和掃描器</span><span class="sxs-lookup"><span data-stu-id="3bd7b-140">Prevention against bots, crawlers, and scanners</span></span>
* <span data-ttu-id="3bd7b-141">偵測一般應用程式錯誤組態 (也就是 Apache、IIS 等)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-141">Detection of common application misconfigurations (i.e. Apache, IIS, etc.)</span></span>

<span data-ttu-id="3bd7b-142">如需更詳細的規則清單及其保護功能，請參閱下列[核心規則集](#core-rule-sets)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-142">For a more detailed list of rules and their protections see the following [Core rule sets](#core-rule-sets).</span></span>

### <a name="core-rule-sets"></a><span data-ttu-id="3bd7b-143">核心規則集</span><span class="sxs-lookup"><span data-stu-id="3bd7b-143">Core rule sets</span></span>

<span data-ttu-id="3bd7b-144">應用程式閘道支援兩個規則集：CRS 3.0 和 CRS 2.2.9。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-144">Application Gateway supports two rule sets, CRS 3.0, and CRS 2.2.9.</span></span> <span data-ttu-id="3bd7b-145">這些核心規則集是可保護 Web 應用程式免於遭遇惡意活動的規則集合。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-145">These core rules sets are collections of rules that protect your web applications for malicious activity.</span></span>

#### <a name="owasp30"></a><span data-ttu-id="3bd7b-146">OWASP_3.0</span><span class="sxs-lookup"><span data-stu-id="3bd7b-146">OWASP_3.0</span></span>

<span data-ttu-id="3bd7b-147">所提供的 3.0 核心規則集有 13 個規則群組，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-147">The 3.0 core rule set provided has 13 rule groups as shown in the following table.</span></span> <span data-ttu-id="3bd7b-148">每個規則群組包含多個規則 (可加以停用)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-148">Each of these rule groups contains multiple rules, which can be disabled.</span></span>

|<span data-ttu-id="3bd7b-149">RuleGroup</span><span class="sxs-lookup"><span data-stu-id="3bd7b-149">RuleGroup</span></span>|<span data-ttu-id="3bd7b-150">說明</span><span class="sxs-lookup"><span data-stu-id="3bd7b-150">Description</span></span>|
|---|---|
|<span data-ttu-id="3bd7b-151">**[REQUEST-910-IP-REPUTATION](application-gateway-crs-rulegroups-rules.md#crs910)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-151">**[REQUEST-910-IP-REPUTATION](application-gateway-crs-rulegroups-rules.md#crs910)**</span></span>|<span data-ttu-id="3bd7b-152">包含規則，可防範已知的濫發垃圾郵件者或惡意活動。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-152">Contains rules to protect against known spammers or malicious activity.</span></span>|
|<span data-ttu-id="3bd7b-153">**[REQUEST-911-METHOD-ENFORCEMENT](application-gateway-crs-rulegroups-rules.md#crs911)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-153">**[REQUEST-911-METHOD-ENFORCEMENT](application-gateway-crs-rulegroups-rules.md#crs911)**</span></span>|<span data-ttu-id="3bd7b-154">包含規則，可鎖定方法 (PUT、PPATCH< ..)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-154">Contains rules to lock down methods (PUT, PATCH< ..)</span></span>|
|<span data-ttu-id="3bd7b-155">**[REQUEST-912-DOS-PROTECTION](application-gateway-crs-rulegroups-rules.md#crs912)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-155">**[REQUEST-912-DOS-PROTECTION](application-gateway-crs-rulegroups-rules.md#crs912)**</span></span>| <span data-ttu-id="3bd7b-156">包含規則，可防禦阻絕服務 (DoS) 攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-156">Contains rules to protect against Denial of Service (DoS) attacks.</span></span>|
|<span data-ttu-id="3bd7b-157">**[REQUEST-913-SCANNER-DETECTION](application-gateway-crs-rulegroups-rules.md#crs913)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-157">**[REQUEST-913-SCANNER-DETECTION](application-gateway-crs-rulegroups-rules.md#crs913)**</span></span>| <span data-ttu-id="3bd7b-158">包含規則，可防禦連接埠和環境掃描器。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-158">Contains rules to protect against port and environment scanners.</span></span>|
|<span data-ttu-id="3bd7b-159">**[REQUEST-920-PROTOCOL-ENFORCEMENT](application-gateway-crs-rulegroups-rules.md#crs920)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-159">**[REQUEST-920-PROTOCOL-ENFORCEMENT](application-gateway-crs-rulegroups-rules.md#crs920)**</span></span>|<span data-ttu-id="3bd7b-160">包含規則，可防範通訊協定和編碼問題。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-160">Contains rules to protect against protocol and encoding issues.</span></span>|
|<span data-ttu-id="3bd7b-161">**[REQUEST-921-PROTOCOL-ATTACK](application-gateway-crs-rulegroups-rules.md#crs921)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-161">**[REQUEST-921-PROTOCOL-ATTACK](application-gateway-crs-rulegroups-rules.md#crs921)**</span></span>|<span data-ttu-id="3bd7b-162">包含規則，可防止標頭插入、要求走私和回應分割</span><span class="sxs-lookup"><span data-stu-id="3bd7b-162">Contains rules to protect against header injection, request smuggling, and response splitting</span></span>|
|<span data-ttu-id="3bd7b-163">**[REQUEST-930-APPLICATION-ATTACK-LFI](application-gateway-crs-rulegroups-rules.md#crs930)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-163">**[REQUEST-930-APPLICATION-ATTACK-LFI](application-gateway-crs-rulegroups-rules.md#crs930)**</span></span>|<span data-ttu-id="3bd7b-164">包含規則，可防禦檔案和路徑攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-164">Contains rules to protect against file and path attacks.</span></span>|
|<span data-ttu-id="3bd7b-165">**[REQUEST-931-APPLICATION-ATTACK-RFI](application-gateway-crs-rulegroups-rules.md#crs931)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-165">**[REQUEST-931-APPLICATION-ATTACK-RFI](application-gateway-crs-rulegroups-rules.md#crs931)**</span></span>|<span data-ttu-id="3bd7b-166">包含規則，可防範遠端檔案引入 (RFI)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-166">Contains rules to protect against Remote File Inclusion (RFI)</span></span>|
|<span data-ttu-id="3bd7b-167">**[REQUEST-932-APPLICATION-ATTACK-RCE](application-gateway-crs-rulegroups-rules.md#crs932)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-167">**[REQUEST-932-APPLICATION-ATTACK-RCE](application-gateway-crs-rulegroups-rules.md#crs932)**</span></span>|<span data-ttu-id="3bd7b-168">包含規則，可防止遠端執行程式碼。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-168">Contains rules to protect again Remote Code Execution.</span></span>|
|<span data-ttu-id="3bd7b-169">**[REQUEST-933-APPLICATION-ATTACK-PHP](application-gateway-crs-rulegroups-rules.md#crs933)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-169">**[REQUEST-933-APPLICATION-ATTACK-PHP](application-gateway-crs-rulegroups-rules.md#crs933)**</span></span>|<span data-ttu-id="3bd7b-170">包含規則，可防禦 PHP 插入式攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-170">Contains rules to protect against PHP injection attacks.</span></span>|
|<span data-ttu-id="3bd7b-171">**[REQUEST-941-APPLICATION-ATTACK-XSS](application-gateway-crs-rulegroups-rules.md#crs941)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-171">**[REQUEST-941-APPLICATION-ATTACK-XSS](application-gateway-crs-rulegroups-rules.md#crs941)**</span></span>|<span data-ttu-id="3bd7b-172">包含規則，可防範跨網站指令碼。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-172">Contains rules for protecting against cross site scripting.</span></span>|
|<span data-ttu-id="3bd7b-173">**[REQUEST-942-APPLICATION-ATTACK-SQLI](application-gateway-crs-rulegroups-rules.md#crs942)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-173">**[REQUEST-942-APPLICATION-ATTACK-SQLI](application-gateway-crs-rulegroups-rules.md#crs942)**</span></span>|<span data-ttu-id="3bd7b-174">包含規則，可防禦 SQL 插入式攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-174">Contains rules for protecting against SQL injection attacks.</span></span>|
|<span data-ttu-id="3bd7b-175">**[REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION](application-gateway-crs-rulegroups-rules.md#crs943)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-175">**[REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION](application-gateway-crs-rulegroups-rules.md#crs943)**</span></span>|<span data-ttu-id="3bd7b-176">包含規則，可防禦工作階段固定攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-176">Contains rules to protect against Session Fixation Attacks.</span></span>|

#### <a name="owasp229"></a><span data-ttu-id="3bd7b-177">OWASP_2.2.9</span><span class="sxs-lookup"><span data-stu-id="3bd7b-177">OWASP_2.2.9</span></span>

<span data-ttu-id="3bd7b-178">所提供的 2.2.9 核心規則集有 10 個規則群組，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-178">The 2.2.9 core rule set provided has 10 rule groups as shown in the following table.</span></span> <span data-ttu-id="3bd7b-179">每個規則群組包含多個規則 (可加以停用)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-179">Each of these rule groups contains multiple rules, which can be disabled.</span></span>

|<span data-ttu-id="3bd7b-180">RuleGroup</span><span class="sxs-lookup"><span data-stu-id="3bd7b-180">RuleGroup</span></span>|<span data-ttu-id="3bd7b-181">說明</span><span class="sxs-lookup"><span data-stu-id="3bd7b-181">Description</span></span>|
|---|---|
|<span data-ttu-id="3bd7b-182">**[crs_20_protocol_violations](application-gateway-crs-rulegroups-rules.md#crs20)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-182">**[crs_20_protocol_violations](application-gateway-crs-rulegroups-rules.md#crs20)**</span></span>|<span data-ttu-id="3bd7b-183">包含規則，可防範通訊協定違規 (無效的字元，使用 GET 搭配要求本文等等)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-183">Contains rules to protect against protocol violations (invalid characters, GET with a request body, etc.)</span></span>|
|<span data-ttu-id="3bd7b-184">**[crs_21_protocol_anomalies](application-gateway-crs-rulegroups-rules.md#crs21)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-184">**[crs_21_protocol_anomalies](application-gateway-crs-rulegroups-rules.md#crs21)**</span></span>|<span data-ttu-id="3bd7b-185">包含規則，可防範不正確的標頭資訊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-185">Contains rules to protect against incorrect header information.</span></span>|
|<span data-ttu-id="3bd7b-186">**[crs_23_request_limits](application-gateway-crs-rulegroups-rules.md#crs23)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-186">**[crs_23_request_limits](application-gateway-crs-rulegroups-rules.md#crs23)**</span></span>|<span data-ttu-id="3bd7b-187">包含規則，可防範超出限制的引數或檔案。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-187">Contains rules to protect against arguments or files that exceed limitations.</span></span>|
|<span data-ttu-id="3bd7b-188">**[crs_30_http_policy](application-gateway-crs-rulegroups-rules.md#crs30)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-188">**[crs_30_http_policy](application-gateway-crs-rulegroups-rules.md#crs30)**</span></span>|<span data-ttu-id="3bd7b-189">包含規則，可防範限制的方法、標頭和檔案類型。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-189">Contains rules to protect against restricted methods, headers, and file types.</span></span> |
|<span data-ttu-id="3bd7b-190">**[crs_35_bad_robots](application-gateway-crs-rulegroups-rules.md#crs35)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-190">**[crs_35_bad_robots](application-gateway-crs-rulegroups-rules.md#crs35)**</span></span>|<span data-ttu-id="3bd7b-191">包含規則，可防禦 Web 編目程式和掃描器。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-191">Contains rules to protect against web crawlers and scanners.</span></span>|
|<span data-ttu-id="3bd7b-192">**[crs_40_generic_attacks](application-gateway-crs-rulegroups-rules.md#crs40)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-192">**[crs_40_generic_attacks](application-gateway-crs-rulegroups-rules.md#crs40)**</span></span>|<span data-ttu-id="3bd7b-193">包含規則，可防禦一般攻擊 (工作階段固定、遠端檔案引入、PHP 插入等等)</span><span class="sxs-lookup"><span data-stu-id="3bd7b-193">Contains rules to protect against generic attacks (session fixation, remote file inclusion, PHP injection, etc.)</span></span>|
|<span data-ttu-id="3bd7b-194">**[crs_41_sql_injection_attacks](application-gateway-crs-rulegroups-rules.md#crs41sql)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-194">**[crs_41_sql_injection_attacks](application-gateway-crs-rulegroups-rules.md#crs41sql)**</span></span>|<span data-ttu-id="3bd7b-195">包含規則，可防禦 SQL 插入式攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-195">Contains rules to protect against SQL injection attacks</span></span>|
|<span data-ttu-id="3bd7b-196">**[crs_41_xss_attacks](application-gateway-crs-rulegroups-rules.md#crs41xss)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-196">**[crs_41_xss_attacks](application-gateway-crs-rulegroups-rules.md#crs41xss)**</span></span>|<span data-ttu-id="3bd7b-197">包含規則，可防範跨網站指令碼。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-197">Contains rules to protect against cross site scripting.</span></span>|
|<span data-ttu-id="3bd7b-198">**[crs_42_tight_security](application-gateway-crs-rulegroups-rules.md#crs42)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-198">**[crs_42_tight_security](application-gateway-crs-rulegroups-rules.md#crs42)**</span></span>|<span data-ttu-id="3bd7b-199">包含規則，可防禦路徑周遊攻擊</span><span class="sxs-lookup"><span data-stu-id="3bd7b-199">Contains a rule to protect against path traversal attacks</span></span>|
|<span data-ttu-id="3bd7b-200">**[crs_45_trojans](application-gateway-crs-rulegroups-rules.md#crs45)**</span><span class="sxs-lookup"><span data-stu-id="3bd7b-200">**[crs_45_trojans](application-gateway-crs-rulegroups-rules.md#crs45)**</span></span>|<span data-ttu-id="3bd7b-201">包含規則，可防禦特洛伊木馬後門程式。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-201">Contains rules to protect against backdoor Trojans.</span></span>|

### <a name="waf-modes"></a><span data-ttu-id="3bd7b-202">WAF 模式</span><span class="sxs-lookup"><span data-stu-id="3bd7b-202">WAF Modes</span></span>

<span data-ttu-id="3bd7b-203">應用程式閘道 WAF 可以設定為在下列兩種模式中執行︰</span><span class="sxs-lookup"><span data-stu-id="3bd7b-203">Application Gateway WAF can be configured to run in the following two modes:</span></span>

* <span data-ttu-id="3bd7b-204">**偵測模式** – 當設定為在偵測模式中執行時，應用程式閘道 WAF 會監視所有威脅警示並記錄到記錄檔。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-204">**Detection mode** – When configured to run in detection mode, Application Gateway WAF monitors and logs all threat alerts in to a log file.</span></span> <span data-ttu-id="3bd7b-205">應使用 [診斷] 區段開啟應用程式閘道的記錄診斷。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-205">Logging diagnostics for Application Gateway should be turned on using the **Diagnostics** section.</span></span> <span data-ttu-id="3bd7b-206">您也必須確保已選取並開啟 WAF 記錄檔。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-206">You also need to ensure that the WAF log is selected and turned on.</span></span> <span data-ttu-id="3bd7b-207">在偵測模式執行的 Web 應用程式防火牆不會封鎖連入要求。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-207">When running in detection mode web application firewall does not block incoming requests.</span></span>
* <span data-ttu-id="3bd7b-208">**防止模式** – 當設定為在防止模式中執行時，應用程式閘道會主動封鎖其規則偵測到的入侵和攻擊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-208">**Prevention mode** – When configured to run in prevention mode, Application Gateway actively blocks intrusions and attacks detected by its rules.</span></span> <span data-ttu-id="3bd7b-209">攻擊者會收到 403 未經授權存取例外狀況，且連線會終止。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-209">The attacker receives a 403 unauthorized access exception and the connection is terminated.</span></span> <span data-ttu-id="3bd7b-210">防止模式會繼續將這類攻擊記錄在 WAF 記錄檔中。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-210">Prevention mode continues to log such attacks in the WAF logs.</span></span>

### <span data-ttu-id="3bd7b-211"><a name="application-gateway-waf-reports"></a>WAF 監視</span><span class="sxs-lookup"><span data-stu-id="3bd7b-211"><a name="application-gateway-waf-reports"></a>WAF Monitoring</span></span>

<span data-ttu-id="3bd7b-212">監視您應用程式閘道的健康狀態非常重要。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-212">Monitoring the health of your application gateway is important.</span></span> <span data-ttu-id="3bd7b-213">透過記錄並與 Azure 監視器、Azure 資訊安全中心 (即將推出) 和 Log Analytics 整合，以監視 Web 應用程式防火牆及其保護之應用程式的健康狀態。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-213">Monitoring the health of your web application firewall and the applications that it protects are provided through logging and integration with Azure Monitor, Azure Security Center (coming soon), and Log Analytics.</span></span>

![診斷](./media/application-gateway-web-application-firewall-overview/diagnostics.png)

#### <a name="azure-monitor"></a><span data-ttu-id="3bd7b-215">Azure 監視器</span><span class="sxs-lookup"><span data-stu-id="3bd7b-215">Azure Monitor</span></span>

<span data-ttu-id="3bd7b-216">每個應用程式閘道記錄都會與 [Azure 監視器](../monitoring-and-diagnostics/monitoring-overview.md)整合。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-216">Each application gateway log is integrated with [Azure Monitor](../monitoring-and-diagnostics/monitoring-overview.md).</span></span>  <span data-ttu-id="3bd7b-217">這可讓您追蹤包括 WAF 警示和記錄的診斷資訊。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-217">This allows you to track diagnostic information including WAF alerts and logs.</span></span>  <span data-ttu-id="3bd7b-218">這項功能提供於入口網站的 [診斷] 索引標籤之下的應用程式閘道資源內，或直接透過 Azure 監視器服務提供。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-218">This capability is provided within the Application Gateway resource in the portal under the **Diagnostics** tab or through the Azure Monitor service directly.</span></span> <span data-ttu-id="3bd7b-219">若要深入了解如何啟用應用程式閘道的診斷記錄，請瀏覽[應用程式閘道診斷](application-gateway-diagnostics.md)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-219">To learn more about enabling diagnostic logs for application gateway visit [Application Gateway diagnostics](application-gateway-diagnostics.md)</span></span>

#### <a name="azure-security-center"></a><span data-ttu-id="3bd7b-220">Azure 資訊安全中心</span><span class="sxs-lookup"><span data-stu-id="3bd7b-220">Azure Security Center</span></span>

<span data-ttu-id="3bd7b-221">[Azure 資訊安全中心](../security-center/security-center-intro.md)利用加強對您 Azure 資源的能見度及安全性控制權，來協助您預防、偵測及回應威脅。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-221">[Azure Security Center](../security-center/security-center-intro.md) helps you prevent, detect, and respond to threats with increased visibility into and control over the security of your Azure resources.</span></span> <span data-ttu-id="3bd7b-222">應用程式閘道現在會[整合到 Azure 資訊安全中心](application-gateway-integration-security-center.md)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-222">Application gateway now [integrates into Azure Security Center](application-gateway-integration-security-center.md).</span></span> <span data-ttu-id="3bd7b-223">Azure 資訊安全中心會掃描您的環境，以偵測未受保護的 Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-223">Azure Security Center scans your environment to detect unprotected web applications.</span></span> <span data-ttu-id="3bd7b-224">它現在可以建議應用程式閘道 WAF 保護這些易受攻擊的資源。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-224">It can now recommend application gateway WAF to protect these vulnerable resources.</span></span> <span data-ttu-id="3bd7b-225">您可以直接從 Azure 資訊安全中心建立應用程式閘道 WAF。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-225">You can directly create application gateway WAF from the Azure Security Center.</span></span>  <span data-ttu-id="3bd7b-226">這些 WAF 執行個體已與 Azure 資訊安全中心整合，並且會將警示和健康情況資訊傳回 Azure 資訊安全中心進行報告。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-226">These WAF instances are integrated with Azure Security Center and will send alerts and health information back to Azure Security Center for reporting.</span></span>

![圖 1](./media/application-gateway-web-application-firewall-overview/figure1.png)

#### <a name="logging"></a><span data-ttu-id="3bd7b-228">記錄</span><span class="sxs-lookup"><span data-stu-id="3bd7b-228">Logging</span></span>

<span data-ttu-id="3bd7b-229">應用程式閘道 WAF 提供其偵測到之每個威脅的詳細報告。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-229">Application Gateway WAF provides detailed reporting on each threat it detects.</span></span> <span data-ttu-id="3bd7b-230">記錄會與 Azure 診斷記錄整合，而且警示會以 JSON 格式來記錄。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-230">Logging is integrated with Azure Diagnostics logs and alerts are recorded in a json format.</span></span> <span data-ttu-id="3bd7b-231">這些記錄可以與 [Log Analytics](../log-analytics/log-analytics-azure-networking-analytics.md) 整合。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-231">These logs can be integrated with [Log Analytics](../log-analytics/log-analytics-azure-networking-analytics.md).</span></span>

![imageURLroute](./media/application-gateway-web-application-firewall-overview/waf2.png)

```json
{
  "resourceId": "/SUBSCRIPTIONS/{subscriptionId}/RESOURCEGROUPS/{resourceGroupId}/PROVIDERS/MICROSOFT.NETWORK/APPLICATIONGATEWAYS/{appGatewayName}",
  "operationName": "ApplicationGatewayFirewall",
  "time": "2017-03-20T15:52:09.1494499Z",
  "category": "ApplicationGatewayFirewallLog",
  "properties": {
    "instanceId": "ApplicationGatewayRole_IN_0",
    "clientIp": "104.210.252.3",
    "clientPort": "4835",
    "requestUri": "/?a=%3Cscript%3Ealert(%22Hello%22);%3C/script%3E",
    "ruleSetType": "OWASP",
    "ruleSetVersion": "3.0",
    "ruleId": "941320",
    "message": "Possible XSS Attack Detected - HTML Tag Handler",
    "action": "Blocked",
    "site": "Global",
    "details": {
      "message": "Warning. Pattern match \"<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h ...\" at ARGS:a.",
      "data": "Matched Data: <script> found within ARGS:a: <script>alert(\\x22hello\\x22);</script>",
      "file": "rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf",
      "line": "865"
    }
  }
} 

```

## <a name="application-gateway-waf-sku-pricing"></a><span data-ttu-id="3bd7b-233">應用程式閘道 WAF SKU 價格</span><span class="sxs-lookup"><span data-stu-id="3bd7b-233">Application Gateway WAF SKU pricing</span></span>

<span data-ttu-id="3bd7b-234">只有在新的 WAF SKU 之下才能使用 Web 應用程式防火牆。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-234">Web application firewall is available under a new a WAF SKU.</span></span> <span data-ttu-id="3bd7b-235">此 SKU 只適用於 Azure Resource Manager 佈建模型，而不適用於傳統部署模型。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-235">This SKU is available only in Azure Resource Manager provisioning model and not under the classic deployment model.</span></span> <span data-ttu-id="3bd7b-236">此外 WAF SKU 僅以中型和大型應用程式閘道執行個體大小提供。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-236">Additionally WAF SKU comes only in medium and large application gateway instance sizes.</span></span> <span data-ttu-id="3bd7b-237">應用程式閘道的所有限制也適用於 WAF SKU。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-237">All the limits for application gateway also apply to the WAF SKU.</span></span> <span data-ttu-id="3bd7b-238">價格是以每小時的閘道器執行個體費用和資料處理費用為基礎。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-238">Pricing is based on per hour gateway instance charge and data processing charge.</span></span> <span data-ttu-id="3bd7b-239">WAF SKU 的每小時閘道價格不同於標準 SKU 費用，您可在[應用程式閘道價格詳細資料](https://azure.microsoft.com/pricing/details/application-gateway/)找到。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-239">Per hour gateway pricing for WAF SKU is different from Standard SKU charges and can be found at [Application Gateway pricing details](https://azure.microsoft.com/pricing/details/application-gateway/).</span></span> <span data-ttu-id="3bd7b-240">資料處理費用維持不變。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-240">Data processing charges remain the same.</span></span> <span data-ttu-id="3bd7b-241">不會依照每個規則或規則群組計算費用。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-241">There is no per rule or rule group charges.</span></span> <span data-ttu-id="3bd7b-242">您可以保護相同 Web 應用程式防火牆後面的多個 Web 應用程式，因此支援多個應用程式不需額外付費。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-242">You can protect multiple web applications behind the same web application firewall and there are no additional charges for supporting multiple applications.</span></span> 

<span data-ttu-id="3bd7b-243">WAF 計費於 2017 年 5 月 5 日生效，直到 WAF SKU 閘道繼續以標準費率收費為止。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-243">Billing for WAF starts effectively 5/5/2017, until then the WAF SKU gateways continues to be charged at standard rates.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3bd7b-244">後續步驟</span><span class="sxs-lookup"><span data-stu-id="3bd7b-244">Next steps</span></span>

<span data-ttu-id="3bd7b-245">深入了解 WAF 的功能之後，請瀏覽[如何在應用程式閘道上設定 Web 應用程式防火牆](application-gateway-web-application-firewall-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="3bd7b-245">After learning more about the capabilities of WAF, visit [How to configure web application firewall on Application Gateway](application-gateway-web-application-firewall-portal.md).</span></span>

