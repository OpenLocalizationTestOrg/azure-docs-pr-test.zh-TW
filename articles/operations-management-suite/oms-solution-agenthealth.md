---
title: "OMS 中的代理程式健全狀況解決方案 | Microsoft Docs"
description: "本文旨在協助您了解如何使用這個解決方案來監視直接向 OMS 或 System Center Operations Manager 回報之代理程式的健全狀況。"
services: operations-management-suite
documentationcenter: 
author: MGoedtel
manager: carmonm
editor: 
ms.assetid: 
ms.service: operations-management-suite
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 07/17/2017
ms.author: magoedte
ms.openlocfilehash: b810e37e393ddab55500f636b72450789285a4f0
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
#  <a name="agent-health-solution-in-oms"></a><span data-ttu-id="f501d-103">OMS 中的代理程式健全狀況解決方案</span><span class="sxs-lookup"><span data-stu-id="f501d-103">Agent Health solution in OMS</span></span>
<span data-ttu-id="f501d-104">對於直接向 OMS 工作區或連線到 OMS 之 System Center Operations Manager 管理群組回報的所有代理程式，OMS 中的代理程式健全狀況解決方案可協助您了解哪些代理程式沒有回應且正在提交作業資料。</span><span class="sxs-lookup"><span data-stu-id="f501d-104">The Agent Health solution in OMS helps you understand, for all of the agents reporting directly to the OMS workspace or a System Center Operations Manager management group  connected to OMS, which are unresponsive and submitting operational data.</span></span>  <span data-ttu-id="f501d-105">您可以也追蹤已部署的代理程式數目，其散佈地區，並執行其他查詢，以留意 Azure、其他雲端環境或內部部署中部署之代理程式的散佈情形。</span><span class="sxs-lookup"><span data-stu-id="f501d-105">You can also keep track of how many agents are deployed, where they are distributed geographically, and perform other queries to maintain awareness of the distribution of agents deployed in Azure, other cloud environments, or on-premises.</span></span>    

## <a name="prerequisites"></a><span data-ttu-id="f501d-106">必要條件</span><span class="sxs-lookup"><span data-stu-id="f501d-106">Prerequisites</span></span>
<span data-ttu-id="f501d-107">部署這個解決方案之前，請確認您目前支援向 OMS 工作區回報或向與 OMS 工作區整合之 [Operations Manager 管理群組](../log-analytics/log-analytics-om-agents.md)回報的 [Windows 代理程式](../log-analytics/log-analytics-windows-agents.md)。</span><span class="sxs-lookup"><span data-stu-id="f501d-107">Before you deploy this solution, confirm you have currently supported [Windows agents](../log-analytics/log-analytics-windows-agents.md) reporting to the OMS workspace or reporting to an [Operations Manager management group](../log-analytics/log-analytics-om-agents.md) integrated with your OMS workspace.</span></span>    

## <a name="solution-components"></a><span data-ttu-id="f501d-108">方案元件</span><span class="sxs-lookup"><span data-stu-id="f501d-108">Solution components</span></span>
<span data-ttu-id="f501d-109">此解決方案包含下列已新增到您的工作區以及直接連線之代理程式或 Operations Manager 連線之管理群組的資源。</span><span class="sxs-lookup"><span data-stu-id="f501d-109">This solution consists of the following resources that are added to your workspace and directly connected agents or Operations Manager connected management group.</span></span>

### <a name="management-packs"></a><span data-ttu-id="f501d-110">管理組件</span><span class="sxs-lookup"><span data-stu-id="f501d-110">Management packs</span></span>
<span data-ttu-id="f501d-111">如果 System Center Operations Manager 管理群組已連線到 OMS 工作區，則下列管理組件會安裝在 Operations Manager 中。</span><span class="sxs-lookup"><span data-stu-id="f501d-111">If your System Center Operations Manager management group is connected to an OMS workspace,  the following management packs are installed in Operations Manager.</span></span>  <span data-ttu-id="f501d-112">新增此解決方案之後，這些管理組件也會安裝在直接連線的 Windows 電腦上。</span><span class="sxs-lookup"><span data-stu-id="f501d-112">These management packs are also installed on directly connected Windows computers after adding this solution.</span></span> <span data-ttu-id="f501d-113">這些管理組件不需要進行任何設定或管理。</span><span class="sxs-lookup"><span data-stu-id="f501d-113">There is nothing to configure or manage with these management packs.</span></span>

* <span data-ttu-id="f501d-114">Microsoft System Center Advisor HealthAssessment Direct Channel Intelligence Pack (Microsoft.IntelligencePacks.HealthAssessmentDirect)</span><span class="sxs-lookup"><span data-stu-id="f501d-114">Microsoft System Center Advisor HealthAssessment Direct Channel Intelligence Pack  (Microsoft.IntelligencePacks.HealthAssessmentDirect)</span></span>
* <span data-ttu-id="f501d-115">Microsoft System Center Advisor HealthAssessment Server Channel Intelligence Pack (Microsoft.IntelligencePacks.HealthAssessmentViaServer)。</span><span class="sxs-lookup"><span data-stu-id="f501d-115">Microsoft System Center Advisor HealthAssessment Server Channel Intelligence Pack (Microsoft.IntelligencePacks.HealthAssessmentViaServer).</span></span>  

<span data-ttu-id="f501d-116">如需有關方案管理組件如何更新的詳細資訊，請參閱 [將 Operations Manager 連接到 Log Analytics](../log-analytics/log-analytics-om-agents.md)。</span><span class="sxs-lookup"><span data-stu-id="f501d-116">For more information on how solution management packs are updated, see [Connect Operations Manager to Log Analytics](../log-analytics/log-analytics-om-agents.md).</span></span>

## <a name="configuration"></a><span data-ttu-id="f501d-117">組態</span><span class="sxs-lookup"><span data-stu-id="f501d-117">Configuration</span></span>
<span data-ttu-id="f501d-118">使用[新增解決方案](../log-analytics/log-analytics-add-solutions.md)中所述的程序，將代理程式健全狀況解決方案新增至您的 OMS 工作區。</span><span class="sxs-lookup"><span data-stu-id="f501d-118">Add the Agent Health solution to your OMS workspace using the process described in [Add solutions](../log-analytics/log-analytics-add-solutions.md).</span></span> <span data-ttu-id="f501d-119">不需要進一步的組態。</span><span class="sxs-lookup"><span data-stu-id="f501d-119">There is no further configuration required.</span></span>


## <a name="data-collection"></a><span data-ttu-id="f501d-120">資料收集</span><span class="sxs-lookup"><span data-stu-id="f501d-120">Data collection</span></span>
### <a name="supported-agents"></a><span data-ttu-id="f501d-121">支援的代理程式</span><span class="sxs-lookup"><span data-stu-id="f501d-121">Supported agents</span></span>
<span data-ttu-id="f501d-122">下表描述此方案支援的連接來源。</span><span class="sxs-lookup"><span data-stu-id="f501d-122">The following table describes the connected sources that are supported by this solution.</span></span>

| <span data-ttu-id="f501d-123">連接的來源</span><span class="sxs-lookup"><span data-stu-id="f501d-123">Connected Source</span></span> | <span data-ttu-id="f501d-124">支援</span><span class="sxs-lookup"><span data-stu-id="f501d-124">Supported</span></span> | <span data-ttu-id="f501d-125">說明</span><span class="sxs-lookup"><span data-stu-id="f501d-125">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f501d-126">Windows 代理程式</span><span class="sxs-lookup"><span data-stu-id="f501d-126">Windows agents</span></span> | <span data-ttu-id="f501d-127">是</span><span class="sxs-lookup"><span data-stu-id="f501d-127">Yes</span></span> | <span data-ttu-id="f501d-128">系統會從直接 Windows 代理程式收集活動訊號事件。</span><span class="sxs-lookup"><span data-stu-id="f501d-128">Heartbeat events are collected from direct Windows agents.</span></span>|
| <span data-ttu-id="f501d-129">System Center Operations Manager 管理群組</span><span class="sxs-lookup"><span data-stu-id="f501d-129">System Center Operations Manager management group</span></span> | <span data-ttu-id="f501d-130">是</span><span class="sxs-lookup"><span data-stu-id="f501d-130">Yes</span></span> | <span data-ttu-id="f501d-131">系統會每隔 60 秒從向管理群組回報之代理程式收集活動訊號事件，然後轉送到 Log Analytics。</span><span class="sxs-lookup"><span data-stu-id="f501d-131">Heartbeat events are collected from  agents reporting to the management group every 60 seconds and then forwarded to Log Analytics.</span></span> <span data-ttu-id="f501d-132">不需要直接從 Operations Manager 代理程式連線到 Log Analytics。</span><span class="sxs-lookup"><span data-stu-id="f501d-132">A direct connection from Operations Manager agents to Log Analytics is not required.</span></span> <span data-ttu-id="f501d-133">活動訊號事件資料會從管理群組轉送至 Log Analytics 存放庫。</span><span class="sxs-lookup"><span data-stu-id="f501d-133">Heartbeat event data is forwarded from the management group to the Log Analytics repository.</span></span>|

## <a name="using-the-solution"></a><span data-ttu-id="f501d-134">使用解決方案</span><span class="sxs-lookup"><span data-stu-id="f501d-134">Using the solution</span></span>
<span data-ttu-id="f501d-135">當您將解決方案新增至 OMS 工作區時，[代理程式健全狀況]  圖格會新增至 OMS 儀表板。</span><span class="sxs-lookup"><span data-stu-id="f501d-135">When you add the solution to your OMS workspace, the **Agent Health** tile will be added to your OMS dashboard.</span></span> <span data-ttu-id="f501d-136">此圖格會顯示過去 24 小時內的代理程式總數和沒有回應的代理程式數目。</span><span class="sxs-lookup"><span data-stu-id="f501d-136">This tile shows the total number of agents and the number of unresponsive agents in the last 24 hours.</span></span><br><br> <span data-ttu-id="f501d-137">![儀表板上的代理程式健全狀況圖格](./media/oms-solution-agenthealth/agenthealth-solution-tile-homepage.png)</span><span class="sxs-lookup"><span data-stu-id="f501d-137">![Agent Health Solution tile on dashboard](./media/oms-solution-agenthealth/agenthealth-solution-tile-homepage.png)</span></span>

<span data-ttu-id="f501d-138">按一下 [代理程式健全狀況] 圖格，以開啟 [代理程式健全狀況] 儀表板。</span><span class="sxs-lookup"><span data-stu-id="f501d-138">Click on the **Agent Health** tile to open the **Agent Health** dashboard.</span></span>  <span data-ttu-id="f501d-139">此儀表板包含下表中的資料行。</span><span class="sxs-lookup"><span data-stu-id="f501d-139">The dashboard includes the columns in the following table.</span></span> <span data-ttu-id="f501d-140">每個資料行依計數列出前十個事件，這幾個事件符合該資料行中指定時間範圍的準則。</span><span class="sxs-lookup"><span data-stu-id="f501d-140">Each column lists the top ten events by count that match that column’s criteria for the specified time range.</span></span> <span data-ttu-id="f501d-141">您可以選取每個資料行右下角的 [查看全部] ，或按一下資料行標頭，以執行記錄搜尋來提供完整清單。</span><span class="sxs-lookup"><span data-stu-id="f501d-141">You can run a log search that provides the entire list by selecting **See all** at the right bottom of each column, or by clicking the column header.</span></span>

| <span data-ttu-id="f501d-142">資料欄</span><span class="sxs-lookup"><span data-stu-id="f501d-142">Column</span></span> | <span data-ttu-id="f501d-143">說明</span><span class="sxs-lookup"><span data-stu-id="f501d-143">Description</span></span> |
|--------|-------------|
| <span data-ttu-id="f501d-144">不同時間的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-144">Agent count over time</span></span> | <span data-ttu-id="f501d-145">Linux 和 Windows 代理程式為期七天的代理程式計數趨勢。</span><span class="sxs-lookup"><span data-stu-id="f501d-145">A trend of your agent count over a period of seven days for both Linux and Windows agents.</span></span>|
| <span data-ttu-id="f501d-146">沒有回應的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-146">Count of unresponsive agents</span></span> | <span data-ttu-id="f501d-147">在過去 24 小時內尚未傳送活動訊號的代理程式清單。</span><span class="sxs-lookup"><span data-stu-id="f501d-147">A list of agents that haven’t sent a heartbeat in the past 24 hours.</span></span>|
| <span data-ttu-id="f501d-148">依 OS 類型分配</span><span class="sxs-lookup"><span data-stu-id="f501d-148">Distribution by OS Type</span></span> | <span data-ttu-id="f501d-149">劃分您的環境中有多少個 Windows 和 Linux 代理程式。</span><span class="sxs-lookup"><span data-stu-id="f501d-149">A partition of how many Windows and Linux agents you have in your environment.</span></span>|
| <span data-ttu-id="f501d-150">依代理程式版本分配</span><span class="sxs-lookup"><span data-stu-id="f501d-150">Distribution by Agent Version</span></span> | <span data-ttu-id="f501d-151">劃分您的環境中安裝的不同代理程式版本，以及每個版本的計數。</span><span class="sxs-lookup"><span data-stu-id="f501d-151">A partition of the different agent versions installed in your environment and a count of each one.</span></span>|
| <span data-ttu-id="f501d-152">依代理程式類別分配</span><span class="sxs-lookup"><span data-stu-id="f501d-152">Distribution by Agent Category</span></span> | <span data-ttu-id="f501d-153">劃分傳送活動訊號事件的不同代理程式類別：直接代理程式、OpsMgr 代理程式或 OpsMgr 管理伺服器。</span><span class="sxs-lookup"><span data-stu-id="f501d-153">A partition of the different categories of agents that are sending up heartbeat events: direct agents, OpsMgr agents, or the OpsMgr Management Server.</span></span>|
| <span data-ttu-id="f501d-154">依管理群組分配</span><span class="sxs-lookup"><span data-stu-id="f501d-154">Distribution by Management Group</span></span> | <span data-ttu-id="f501d-155">劃分您的環境中不同的 SCOM 管理群組。</span><span class="sxs-lookup"><span data-stu-id="f501d-155">A partition of the different SCOM Management groups in your environment.</span></span>|
| <span data-ttu-id="f501d-156">代理程式的地理位置</span><span class="sxs-lookup"><span data-stu-id="f501d-156">Geo-location of Agents</span></span> | <span data-ttu-id="f501d-157">劃分您擁有代理程式的不同國家/地區，以及在每個國家/地區安裝的代理程式總計數。</span><span class="sxs-lookup"><span data-stu-id="f501d-157">A partition of the different countries where you have agents and a total count of the number of agents that have been installed in each country.</span></span>|
| <span data-ttu-id="f501d-158">已安裝的閘道計數</span><span class="sxs-lookup"><span data-stu-id="f501d-158">Count of Gateways Installed</span></span> | <span data-ttu-id="f501d-159">已安裝 OMS 閘道的伺服器數目，以及這些伺服器的清單。</span><span class="sxs-lookup"><span data-stu-id="f501d-159">The number of servers that have the OMS Gateway installed, and a list of these servers.</span></span>|

![代理程式健全狀況儀表板範例](./media/oms-solution-agenthealth/agenthealth-solution-dashboard.png)  

## <a name="log-analytics-records"></a><span data-ttu-id="f501d-161">Log Analytics 記錄</span><span class="sxs-lookup"><span data-stu-id="f501d-161">Log Analytics records</span></span>
<span data-ttu-id="f501d-162">此解決方案會在 OMS 存放庫中建立一種類型的記錄。</span><span class="sxs-lookup"><span data-stu-id="f501d-162">The solution creates one type of record in the OMS repository.</span></span>  

### <a name="heartbeat-records"></a><span data-ttu-id="f501d-163">活動訊號記錄</span><span class="sxs-lookup"><span data-stu-id="f501d-163">Heartbeat records</span></span>
<span data-ttu-id="f501d-164">系統會建立類型為 [活動訊號] 的記錄。</span><span class="sxs-lookup"><span data-stu-id="f501d-164">A record with a type of **Heartbeat** is created.</span></span>  <span data-ttu-id="f501d-165">這些記錄具有下表中的屬性。</span><span class="sxs-lookup"><span data-stu-id="f501d-165">These records have the properties in the following table.</span></span>  

| <span data-ttu-id="f501d-166">屬性</span><span class="sxs-lookup"><span data-stu-id="f501d-166">Property</span></span> | <span data-ttu-id="f501d-167">說明</span><span class="sxs-lookup"><span data-stu-id="f501d-167">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f501d-168">類型</span><span class="sxs-lookup"><span data-stu-id="f501d-168">Type</span></span> | <span data-ttu-id="f501d-169">*活動訊號*</span><span class="sxs-lookup"><span data-stu-id="f501d-169">*Heartbeat*</span></span>|
| <span data-ttu-id="f501d-170">類別</span><span class="sxs-lookup"><span data-stu-id="f501d-170">Category</span></span> | <span data-ttu-id="f501d-171">值為 [直接代理程式]、[SCOM 代理程式] 或 [SCOM 管理伺服器]。</span><span class="sxs-lookup"><span data-stu-id="f501d-171">Value is *Direct Agent*, *SCOM Agent*, or *SCOM Management Server*.</span></span>|
| <span data-ttu-id="f501d-172">電腦</span><span class="sxs-lookup"><span data-stu-id="f501d-172">Computer</span></span> | <span data-ttu-id="f501d-173">電腦名稱。</span><span class="sxs-lookup"><span data-stu-id="f501d-173">Computer name.</span></span>|
| <span data-ttu-id="f501d-174">OSType</span><span class="sxs-lookup"><span data-stu-id="f501d-174">OSType</span></span> | <span data-ttu-id="f501d-175">Windows 或 Linux 作業系統。</span><span class="sxs-lookup"><span data-stu-id="f501d-175">Windows or Linux operating system.</span></span>|
| <span data-ttu-id="f501d-176">OSMajorVersion</span><span class="sxs-lookup"><span data-stu-id="f501d-176">OSMajorVersion</span></span> | <span data-ttu-id="f501d-177">作業系統主要版本。</span><span class="sxs-lookup"><span data-stu-id="f501d-177">Operating system major version.</span></span>|
| <span data-ttu-id="f501d-178">OSMinorVersion</span><span class="sxs-lookup"><span data-stu-id="f501d-178">OSMinorVersion</span></span> | <span data-ttu-id="f501d-179">作業系統次要版本。</span><span class="sxs-lookup"><span data-stu-id="f501d-179">Operating system minor version.</span></span>|
| <span data-ttu-id="f501d-180">版本</span><span class="sxs-lookup"><span data-stu-id="f501d-180">Version</span></span> | <span data-ttu-id="f501d-181">OMS 代理程式或 Operations Manager 代理程式版本。</span><span class="sxs-lookup"><span data-stu-id="f501d-181">OMS Agent or Operations Manager Agent version.</span></span>|
| <span data-ttu-id="f501d-182">SCAgentChannel</span><span class="sxs-lookup"><span data-stu-id="f501d-182">SCAgentChannel</span></span> | <span data-ttu-id="f501d-183">值為 [Direct] 和/或 [SCManagementServer]。</span><span class="sxs-lookup"><span data-stu-id="f501d-183">Value is *Direct* and/or *SCManagementServer*.</span></span>|
| <span data-ttu-id="f501d-184">IsGatewayInstalled</span><span class="sxs-lookup"><span data-stu-id="f501d-184">IsGatewayInstalled</span></span> | <span data-ttu-id="f501d-185">如果已安裝 OMS 閘道，值為 true，否則值為 false。</span><span class="sxs-lookup"><span data-stu-id="f501d-185">If OMS Gateway is installed, value is *true*, otherwise value is *false*.</span></span>|
| <span data-ttu-id="f501d-186">ComputerIP</span><span class="sxs-lookup"><span data-stu-id="f501d-186">ComputerIP</span></span> | <span data-ttu-id="f501d-187">電腦的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f501d-187">IP address of the computer.</span></span>|
| <span data-ttu-id="f501d-188">RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="f501d-188">RemoteIPCountry</span></span> | <span data-ttu-id="f501d-189">電腦部署所在的地理位置。</span><span class="sxs-lookup"><span data-stu-id="f501d-189">Geographic location where computer is deployed.</span></span>|
| <span data-ttu-id="f501d-190">ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="f501d-190">ManagementGroupName</span></span> | <span data-ttu-id="f501d-191">Operations Manager 管理群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="f501d-191">Name of Operations Manager management group.</span></span>|
| <span data-ttu-id="f501d-192">SourceComputerId</span><span class="sxs-lookup"><span data-stu-id="f501d-192">SourceComputerId</span></span> | <span data-ttu-id="f501d-193">電腦的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="f501d-193">Unique ID of computer.</span></span>|
| <span data-ttu-id="f501d-194">RemoteIPLongitude</span><span class="sxs-lookup"><span data-stu-id="f501d-194">RemoteIPLongitude</span></span> | <span data-ttu-id="f501d-195">電腦的地理位置經度。</span><span class="sxs-lookup"><span data-stu-id="f501d-195">Longitude of computer's geographic location.</span></span>|
| <span data-ttu-id="f501d-196">RemoteIPLatitude</span><span class="sxs-lookup"><span data-stu-id="f501d-196">RemoteIPLatitude</span></span> | <span data-ttu-id="f501d-197">電腦的地理位置緯度。</span><span class="sxs-lookup"><span data-stu-id="f501d-197">Latitude of computer's geographic location.</span></span>|

<span data-ttu-id="f501d-198">向 Operations Manager 管理伺服器回報的每個代理程式將會傳送兩個活動訊號，而 SCAgentChannel 屬性的值將同時包含 **Direct** 和 **SCManagementServer** (視您已在自己的 OMS 訂用帳戶中啟用哪些 Analytics 資料來源和解決方案而定)。</span><span class="sxs-lookup"><span data-stu-id="f501d-198">Each agent reporting to an Operations Manager management server will send two heartbeats, and SCAgentChannel property's value will include both **Direct** and **SCManagementServer** depending on what Log Analytics data sources and solutions you have enabled in your OMS subscription.</span></span> <span data-ttu-id="f501d-199">請回想一下，解決方案中的資料會從 Operations Manager 管理伺服器直接傳送至 OMS Web 服務，或者因為代理程式上收集的資料量，所以會從代理程式直接傳送至 OMS Web 服務。</span><span class="sxs-lookup"><span data-stu-id="f501d-199">If you recall, data from solutions are either sent directly from an Operations Manager management server to the OMS web service, or because of the volume of data collected on the agent, are sent directly from the agent to OMS web service.</span></span> <span data-ttu-id="f501d-200">若為具有 **SCManagementServer** 值的活動訊號事件，ComputerIP 值為管理伺服器的 IP 位址，因為資料實際上由它上傳。</span><span class="sxs-lookup"><span data-stu-id="f501d-200">For heartbeat events which have the value **SCManagementServer**, the ComputerIP value is the IP address of the management server since the data is actually uploaded by it.</span></span>  <span data-ttu-id="f501d-201">若為 SCAgentChannel 設為 [Direct] 的活動訊號，此值為代理程式的公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f501d-201">For heartbeats where SCAgentChannel is set to **Direct**, it is the public IP address of the agent.</span></span>  

## <a name="sample-log-searches"></a><span data-ttu-id="f501d-202">記錄搜尋範例</span><span class="sxs-lookup"><span data-stu-id="f501d-202">Sample log searches</span></span>
<span data-ttu-id="f501d-203">下表提供此解決方案所收集之記錄的記錄搜尋範例。</span><span class="sxs-lookup"><span data-stu-id="f501d-203">The following table provides sample log searches for records collected by this solution.</span></span>

| <span data-ttu-id="f501d-204">查詢</span><span class="sxs-lookup"><span data-stu-id="f501d-204">Query</span></span> | <span data-ttu-id="f501d-205">說明</span><span class="sxs-lookup"><span data-stu-id="f501d-205">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f501d-206">Type=Heartbeat &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-206">Type=Heartbeat &#124; distinct Computer</span></span> |<span data-ttu-id="f501d-207">代理程式總數</span><span class="sxs-lookup"><span data-stu-id="f501d-207">Total number of agents</span></span> |
| <span data-ttu-id="f501d-208">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-24HOURS</span><span class="sxs-lookup"><span data-stu-id="f501d-208">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-24HOURS</span></span> |<span data-ttu-id="f501d-209">過去 24 小時內沒有回應的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-209">Count of unresponsive agents in the last 24 hours</span></span> |
| <span data-ttu-id="f501d-210">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-15MINUTES</span><span class="sxs-lookup"><span data-stu-id="f501d-210">Type=Heartbeat &#124; measure max(TimeGenerated) as LastCall by Computer &#124; where LastCall < NOW-15MINUTES</span></span> |<span data-ttu-id="f501d-211">過去 15 分鐘內沒有回應的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-211">Count of unresponsive agents in the last 15 minutes</span></span> |
| <span data-ttu-id="f501d-212">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer IN {Type=Heartbeat TimeGenerated>NOW-24HOURS &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-212">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer IN {Type=Heartbeat TimeGenerated>NOW-24HOURS &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span></span> |<span data-ttu-id="f501d-213">在線上的電腦 (過去 24 小時內)</span><span class="sxs-lookup"><span data-stu-id="f501d-213">Computers online (in the last 24 hours)</span></span> |
| <span data-ttu-id="f501d-214">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer NOT IN {Type=Heartbeat TimeGenerated>NOW-30MINUTES &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-214">Type=Heartbeat TimeGenerated>NOW-24HOURS Computer NOT IN {Type=Heartbeat TimeGenerated>NOW-30MINUTES &#124; distinct Computer} &#124; measure max(TimeGenerated) as LastCall by Computer</span></span> |<span data-ttu-id="f501d-215">在過去 30 分鐘內離線的代理程式總數 (針對過去 24 小時)</span><span class="sxs-lookup"><span data-stu-id="f501d-215">Total Agents Offline in Last 30 minutes (for the last 24 hours)</span></span> |
| <span data-ttu-id="f501d-216">Type=Heartbeat &#124; measure countdistinct(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="f501d-216">Type=Heartbeat &#124; measure countdistinct(Computer) by OSType</span></span> |<span data-ttu-id="f501d-217">依 OSType 取得一段時間內的代理程式數目趨勢</span><span class="sxs-lookup"><span data-stu-id="f501d-217">Get a trend of number of agents over time by OSType</span></span>|
| <span data-ttu-id="f501d-218">Type=Heartbeat&#124;measure countdistinct(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="f501d-218">Type=Heartbeat&#124;measure countdistinct(Computer) by OSType</span></span> |<span data-ttu-id="f501d-219">依 OS 類型分配</span><span class="sxs-lookup"><span data-stu-id="f501d-219">Distribution by OS Type</span></span> |
| <span data-ttu-id="f501d-220">Type=Heartbeat&#124;measure countdistinct(Computer) by Version</span><span class="sxs-lookup"><span data-stu-id="f501d-220">Type=Heartbeat&#124;measure countdistinct(Computer) by Version</span></span> |<span data-ttu-id="f501d-221">依代理程式版本分配</span><span class="sxs-lookup"><span data-stu-id="f501d-221">Distribution by Agent Version</span></span> |
| <span data-ttu-id="f501d-222">Type=Heartbeat&#124;measure count() by Category</span><span class="sxs-lookup"><span data-stu-id="f501d-222">Type=Heartbeat&#124;measure count() by Category</span></span> |<span data-ttu-id="f501d-223">依代理程式類別分配</span><span class="sxs-lookup"><span data-stu-id="f501d-223">Distribution by Agent Category</span></span> |
| <span data-ttu-id="f501d-224">Type=Heartbeat&#124;measure countdistinct(Computer) by ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="f501d-224">Type=Heartbeat&#124;measure countdistinct(Computer) by ManagementGroupName</span></span> | <span data-ttu-id="f501d-225">依管理群組分配</span><span class="sxs-lookup"><span data-stu-id="f501d-225">Distribution by Management Group</span></span> |
| <span data-ttu-id="f501d-226">Type=Heartbeat&#124;measure countdistinct(Computer) by RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="f501d-226">Type=Heartbeat&#124;measure countdistinct(Computer) by RemoteIPCountry</span></span> |<span data-ttu-id="f501d-227">代理程式的地理位置</span><span class="sxs-lookup"><span data-stu-id="f501d-227">Geo-location of Agents</span></span> |
| <span data-ttu-id="f501d-228">Type=Heartbeat IsGatewayInstalled=true&#124;Distinct Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-228">Type=Heartbeat IsGatewayInstalled=true&#124;Distinct Computer</span></span> |<span data-ttu-id="f501d-229">已安裝的 OMS 閘道數目</span><span class="sxs-lookup"><span data-stu-id="f501d-229">Number of OMS Gateways Installed</span></span> |


>[!NOTE]
> <span data-ttu-id="f501d-230">如果您的工作區已升級為[新的 Log Analytics 查詢語言](../log-analytics/log-analytics-log-search-upgrade.md)，則以上查詢會變更如下。</span><span class="sxs-lookup"><span data-stu-id="f501d-230">If your workspace has been upgraded to the [new Log Analytics query language](../log-analytics/log-analytics-log-search-upgrade.md), then the above queries would change to the following.</span></span>
>
>| <span data-ttu-id="f501d-231">查詢</span><span class="sxs-lookup"><span data-stu-id="f501d-231">Query</span></span> | <span data-ttu-id="f501d-232">說明</span><span class="sxs-lookup"><span data-stu-id="f501d-232">Description</span></span> |
|:---|:---|
| <span data-ttu-id="f501d-233">Heartbeat &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-233">Heartbeat &#124; distinct Computer</span></span> |<span data-ttu-id="f501d-234">代理程式總數</span><span class="sxs-lookup"><span data-stu-id="f501d-234">Total number of agents</span></span> |
| <span data-ttu-id="f501d-235">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(24h)</span><span class="sxs-lookup"><span data-stu-id="f501d-235">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(24h)</span></span> |<span data-ttu-id="f501d-236">過去 24 小時內沒有回應的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-236">Count of unresponsive agents in the last 24 hours</span></span> |
| <span data-ttu-id="f501d-237">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(15m)</span><span class="sxs-lookup"><span data-stu-id="f501d-237">Heartbeat &#124; summarize LastCall = max(TimeGenerated) by Computer &#124; where LastCall < ago(15m)</span></span> |<span data-ttu-id="f501d-238">過去 15 分鐘內沒有回應的代理程式計數</span><span class="sxs-lookup"><span data-stu-id="f501d-238">Count of unresponsive agents in the last 15 minutes</span></span> |
| <span data-ttu-id="f501d-239">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer in ((Heartbeat &#124; where TimeGenerated > ago(24h) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-239">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer in ((Heartbeat &#124; where TimeGenerated > ago(24h) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span></span> |<span data-ttu-id="f501d-240">在線上的電腦 (過去 24 小時內)</span><span class="sxs-lookup"><span data-stu-id="f501d-240">Computers online (in the last 24 hours)</span></span> |
| <span data-ttu-id="f501d-241">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer !in ((Heartbeat &#124; where TimeGenerated > ago(30m) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-241">Heartbeat &#124; where TimeGenerated > ago(24h) and Computer !in ((Heartbeat &#124; where TimeGenerated > ago(30m) &#124; distinct Computer)) &#124; summarize LastCall = max(TimeGenerated) by Computer</span></span> |<span data-ttu-id="f501d-242">在過去 30 分鐘內離線的代理程式總數 (針對過去 24 小時)</span><span class="sxs-lookup"><span data-stu-id="f501d-242">Total Agents Offline in Last 30 minutes (for the last 24 hours)</span></span> |
| <span data-ttu-id="f501d-243">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="f501d-243">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span></span> |<span data-ttu-id="f501d-244">依 OSType 取得一段時間內的代理程式數目趨勢</span><span class="sxs-lookup"><span data-stu-id="f501d-244">Get a trend of number of agents over time by OSType</span></span>|
| <span data-ttu-id="f501d-245">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span><span class="sxs-lookup"><span data-stu-id="f501d-245">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by OSType</span></span> |<span data-ttu-id="f501d-246">依 OS 類型分配</span><span class="sxs-lookup"><span data-stu-id="f501d-246">Distribution by OS Type</span></span> |
| <span data-ttu-id="f501d-247">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by Version</span><span class="sxs-lookup"><span data-stu-id="f501d-247">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by Version</span></span> |<span data-ttu-id="f501d-248">依代理程式版本分配</span><span class="sxs-lookup"><span data-stu-id="f501d-248">Distribution by Agent Version</span></span> |
| <span data-ttu-id="f501d-249">Heartbeat &#124; summarize AggregatedValue = count() by Category</span><span class="sxs-lookup"><span data-stu-id="f501d-249">Heartbeat &#124; summarize AggregatedValue = count() by Category</span></span> |<span data-ttu-id="f501d-250">依代理程式類別分配</span><span class="sxs-lookup"><span data-stu-id="f501d-250">Distribution by Agent Category</span></span> |
| <span data-ttu-id="f501d-251">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by ManagementGroupName</span><span class="sxs-lookup"><span data-stu-id="f501d-251">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by ManagementGroupName</span></span> | <span data-ttu-id="f501d-252">依管理群組分配</span><span class="sxs-lookup"><span data-stu-id="f501d-252">Distribution by Management Group</span></span> |
| <span data-ttu-id="f501d-253">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by RemoteIPCountry</span><span class="sxs-lookup"><span data-stu-id="f501d-253">Heartbeat &#124; summarize AggregatedValue = dcount(Computer) by RemoteIPCountry</span></span> |<span data-ttu-id="f501d-254">代理程式的地理位置</span><span class="sxs-lookup"><span data-stu-id="f501d-254">Geo-location of Agents</span></span> |
| <span data-ttu-id="f501d-255">Heartbeat &#124; where iff(isnotnull(toint(IsGatewayInstalled)), IsGatewayInstalled == true, IsGatewayInstalled == "true") == true &#124; distinct Computer</span><span class="sxs-lookup"><span data-stu-id="f501d-255">Heartbeat &#124; where iff(isnotnull(toint(IsGatewayInstalled)), IsGatewayInstalled == true, IsGatewayInstalled == "true") == true &#124; distinct Computer</span></span> |<span data-ttu-id="f501d-256">已安裝的 OMS 閘道數目</span><span class="sxs-lookup"><span data-stu-id="f501d-256">Number of OMS Gateways Installed</span></span> |

## <a name="next-steps"></a><span data-ttu-id="f501d-257">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f501d-257">Next steps</span></span>

* <span data-ttu-id="f501d-258">如需有關從 Log Analytics 產生的警示的詳細資料，請深入了解 [Log Analytics 中的警示](../log-analytics/log-analytics-alerts.md) 。</span><span class="sxs-lookup"><span data-stu-id="f501d-258">Learn about [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md) for details on generating alerts from Log Analytics.</span></span>
