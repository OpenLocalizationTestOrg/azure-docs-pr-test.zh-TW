---
title: "在 OMS 中建置管理解決方案 | Microsoft Docs"
description: "管理解決方案會藉由提供客戶可新增至他們 OMS 工作區的套件管理案例，以擴充 Operations Management Suite (OMS) 的功能。  這篇文章提供詳細資料，說明如何建立要用於自己的環境中或可供客戶使用的管理解決方案。"
services: operations-management-suite
documentationcenter: 
author: bwren
manager: carmonm
editor: tysonn
ms.assetid: 1915e204-ba7e-431b-9718-9eb6b4213ad8
ms.service: operations-management-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/20/2017
ms.author: bwren
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 6ea959f1e95ea46c07eec3afa9d46bfeb72ca3e4
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2017
---
# <a name="design-and-build-a-management-solution-in-operations-management-suite-oms-preview"></a><span data-ttu-id="94ed8-104">在 Operations Management Suite (OMS) 中設計和建置管理解決方案 (預覽)</span><span class="sxs-lookup"><span data-stu-id="94ed8-104">Design and build a management solution in Operations Management Suite (OMS) (Preview)</span></span>
> [!NOTE]
> <span data-ttu-id="94ed8-105">這是在 OMS 中建立管理解決方案 (目前處於預覽狀態) 的預備文件。</span><span class="sxs-lookup"><span data-stu-id="94ed8-105">This is preliminary documentation for creating management solutions in OMS which are currently in preview.</span></span> <span data-ttu-id="94ed8-106">以下所述的任何結構描述可能會有所變更。</span><span class="sxs-lookup"><span data-stu-id="94ed8-106">Any schema described below is subject to change.</span></span>

<span data-ttu-id="94ed8-107">[管理解決方案](operations-management-suite-solutions.md)會藉由提供客戶可新增至他們 OMS 工作區的套件管理案例，以擴充 Operations Management Suite (OMS) 的功能。</span><span class="sxs-lookup"><span data-stu-id="94ed8-107">[Management solutions](operations-management-suite-solutions.md) extend the functionality of Operations Management Suite (OMS) by providing packaged management scenarios that customers can add to their OMS workspace.</span></span>  <span data-ttu-id="94ed8-108">本文介紹的基本程序，可用來設計和建置適用於最常見需求的管理解決方案。</span><span class="sxs-lookup"><span data-stu-id="94ed8-108">This article presents a basic process to design and build a management solution that is suitable for most common requirements.</span></span>  <span data-ttu-id="94ed8-109">如果您不了解如何建置管理解決方案，則可以先使用此程序，之後再隨著需求的發展，運用相關概念來建置更複雜的解決方案。</span><span class="sxs-lookup"><span data-stu-id="94ed8-109">If you are new to building management solutions then you can use this process as a starting point and then leverage the concepts for more complex solutions as your requirements evolve.</span></span>

## <a name="what-is-a-management-solution"></a><span data-ttu-id="94ed8-110">何謂管理解決方案？</span><span class="sxs-lookup"><span data-stu-id="94ed8-110">What is a management solution?</span></span>

<span data-ttu-id="94ed8-111">管理解決方案包含 OMS 和 Azure 資源，共同運作以實現特別的監視案例。</span><span class="sxs-lookup"><span data-stu-id="94ed8-111">Management solutions contain OMS and Azure resources that work together to achieve a particular monitoring scenario.</span></span>  <span data-ttu-id="94ed8-112">解決方案會實作為[資源管理範本](../azure-resource-manager/resource-manager-template-walkthrough.md)，範本中包含如何在安裝解決方案時安裝及設定其內含資源的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-112">They are implemented as [Resource Management templates](../azure-resource-manager/resource-manager-template-walkthrough.md) that contain details of how to install and configure their contained resources when the solution is installed.</span></span>

<span data-ttu-id="94ed8-113">基本策略是藉由在 Azure 環境中建置個別元件來開始您的管理解決方案。</span><span class="sxs-lookup"><span data-stu-id="94ed8-113">The basic strategy is to start your management solution by building the individual components in your Azure environment.</span></span>  <span data-ttu-id="94ed8-114">當功能正常運作後，您就可以開始將這些元件封裝到[管理解決方案檔](operations-management-suite-solutions-solution-file.md)。</span><span class="sxs-lookup"><span data-stu-id="94ed8-114">Once you have the functionality working properly, then you can start packaging them into a [management solution file](operations-management-suite-solutions-solution-file.md).</span></span> 


## <a name="design-your-solution"></a><span data-ttu-id="94ed8-115">設計您的解決方案</span><span class="sxs-lookup"><span data-stu-id="94ed8-115">Design your solution</span></span>
<span data-ttu-id="94ed8-116">下圖所示的是最常見的管理解決方案模式。</span><span class="sxs-lookup"><span data-stu-id="94ed8-116">The most common pattern for a management solution is shown in the following diagram.</span></span>  <span data-ttu-id="94ed8-117">下面會討論此模式的不同元件。</span><span class="sxs-lookup"><span data-stu-id="94ed8-117">The different components in this pattern are discussed in the below.</span></span>

![OMS 解決方案概觀](media/operations-management-suite-solutions/solution-overview.png)


### <a name="data-sources"></a><span data-ttu-id="94ed8-119">資料來源</span><span class="sxs-lookup"><span data-stu-id="94ed8-119">Data sources</span></span>
<span data-ttu-id="94ed8-120">設計解決方案時的第一個步驟，是決定您需要從 Log Analytics 存放庫取得的資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-120">The first step in designing a solution is determining the data that you require from the Log Analytics repository.</span></span>  <span data-ttu-id="94ed8-121">這項資料可由[資料來源](../log-analytics/log-analytics-data-sources.md)或[另一個解決方案](operations-management-suite-solutions.md)所收集，否則您的解決方案就可能需要提供資料收集程序。</span><span class="sxs-lookup"><span data-stu-id="94ed8-121">This data may be collected by a [data source](../log-analytics/log-analytics-data-sources.md) or [another solution](operations-management-suite-solutions.md), or your solution may need to provide the process to collect it.</span></span>

<span data-ttu-id="94ed8-122">有數種方式可以將資料來源收集在 Log Analytics 存放庫中，您可以在 [Log Analytics 中的資料來源](../log-analytics/log-analytics-data-sources.md)中看到其說明。</span><span class="sxs-lookup"><span data-stu-id="94ed8-122">There are a number of ways data sources that can be collected in the Log Analytics repository as described in [Data sources in Log Analytics](../log-analytics/log-analytics-data-sources.md).</span></span>  <span data-ttu-id="94ed8-123">這包括 Windows 事件記錄中的事件或 Syslog 所產生的事件，以及 Windows 和 Linux 用戶端的效能計數器。</span><span class="sxs-lookup"><span data-stu-id="94ed8-123">This includes events in the Windows Event Log or generated by Syslog in addition to performance counters for both Windows and Linux clients.</span></span>  <span data-ttu-id="94ed8-124">您也可以從 Azure 監視器所收集的 Azure 資源來收集資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-124">You can also gather data from Azure resources collected by Azure Monitor.</span></span>  

<span data-ttu-id="94ed8-125">如果您需要的資料無法透過任何可用的資料來源取得，可以使用 [HTTP 資料收集器 API](../log-analytics/log-analytics-data-collector-api.md)，這個 API 可讓您從任何可以呼叫 REST API 的用戶端，將資料寫入 Log Analytics 存放庫。</span><span class="sxs-lookup"><span data-stu-id="94ed8-125">If you require data that's not accessible through any of the available data sources, then you can use the [HTTP Data Collector API](../log-analytics/log-analytics-data-collector-api.md) which allows you to write data to the Log Analytics repository from any client that can call a REST API.</span></span>  <span data-ttu-id="94ed8-126">若要在管理解決方案中自訂資料收集，最常見的方法是建立 [Azure 自動化中的 Runbook](../automation/automation-runbook-types.md)，以從 Azure 或外部資源收集所需的資料，並使用資料收集器 API 將資料寫入存放庫中。</span><span class="sxs-lookup"><span data-stu-id="94ed8-126">The most common means of custom data collection in a management solution is to create a [runbook in Azure Automation](../automation/automation-runbook-types.md) that collects the required data from Azure or external resources and uses the Data Collector API to write to the repository.</span></span>  

### <a name="log-searches"></a><span data-ttu-id="94ed8-127">記錄檔搜尋</span><span class="sxs-lookup"><span data-stu-id="94ed8-127">Log searches</span></span>
<span data-ttu-id="94ed8-128">[記錄搜尋](../log-analytics/log-analytics-log-searches.md)可用來擷取和分析 Log Analytics 存放庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-128">[Log searches](../log-analytics/log-analytics-log-searches.md) are used to extract and analyze data in the Log Analytics repository.</span></span>  <span data-ttu-id="94ed8-129">除了讓使用者能夠對存放庫中的資料執行特定分析外，記錄搜尋也可供檢視和警示使用。</span><span class="sxs-lookup"><span data-stu-id="94ed8-129">They are used by views and alerts in addition to allowing the user to perform ad hoc analysis of data in the repository.</span></span>  

<span data-ttu-id="94ed8-130">您應該定義您認為會對使用者有幫助的任何查詢，即使沒有任何檢視或警示使用這些查詢也是如此。</span><span class="sxs-lookup"><span data-stu-id="94ed8-130">You should define any queries that you think will be helpful to the user even if they aren't used by any views or alerts.</span></span>  <span data-ttu-id="94ed8-131">在入口網站中，這些查詢會以「已儲存搜尋」的形式提供給使用者來使用，而您也可以將這些查詢包含在自訂檢視中的[查詢清單視覺效果部分](../log-analytics/log-analytics-view-designer-parts.md#list-of-queries-part)。</span><span class="sxs-lookup"><span data-stu-id="94ed8-131">These will be available to them as Saved Searches in the portal, and you can also include them in a [List of Queries visualization part](../log-analytics/log-analytics-view-designer-parts.md#list-of-queries-part) in your custom view.</span></span>

### <a name="alerts"></a><span data-ttu-id="94ed8-132">Alerts</span><span class="sxs-lookup"><span data-stu-id="94ed8-132">Alerts</span></span>
<span data-ttu-id="94ed8-133">[Log Analytics 中的警示](../log-analytics/log-analytics-alerts.md)可透過對存放庫中的資料進行[記錄搜尋](#log-searches)來識別問題。</span><span class="sxs-lookup"><span data-stu-id="94ed8-133">[Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md) identify issues through [log searches](#log-searches) against the data in the repository.</span></span>  <span data-ttu-id="94ed8-134">它們會通知使用者，或自動執行回應中的動作。</span><span class="sxs-lookup"><span data-stu-id="94ed8-134">They either notify the user or automatically run an action in response.</span></span> <span data-ttu-id="94ed8-135">您應該識別應用程式的不同警示條件，並在解決方案檔中包含對應的警示規則。</span><span class="sxs-lookup"><span data-stu-id="94ed8-135">You should identify different alert conditions for your application and include corresponding alert rules in your solution file.</span></span>

<span data-ttu-id="94ed8-136">如果問題有可能透過自動化程序加以修正，您通常會在 Azure 自動化中建立 Runbook 以執行此修復。</span><span class="sxs-lookup"><span data-stu-id="94ed8-136">If the issue can potentially be corrected with an automated process, then you'll typically create a runbook in Azure Automation to perform this remediation.</span></span>  <span data-ttu-id="94ed8-137">大部分 Azure 服務都可使用 [Cmdlet](/powershell/azure/overview) 來管理，Runbook 會運用這些 Cmdlet 來執行這類功能。</span><span class="sxs-lookup"><span data-stu-id="94ed8-137">Most Azure services can be managed with [cmdlets](/powershell/azure/overview) which the runbook would leverage to perform such functionality.</span></span>

<span data-ttu-id="94ed8-138">如果您的解決方案需要外部功能以對警示做出回應，您可以使用 [Webhook 回應](../log-analytics/log-analytics-alerts-actions.md)。</span><span class="sxs-lookup"><span data-stu-id="94ed8-138">If your solution requires external functionality in response to an alert, then you can use a [webhook response](../log-analytics/log-analytics-alerts-actions.md).</span></span>  <span data-ttu-id="94ed8-139">這可讓您呼叫外部 Web 服務，以從警示傳送資訊。</span><span class="sxs-lookup"><span data-stu-id="94ed8-139">This allows you to call an external web service sending information from the alert.</span></span>

### <a name="views"></a><span data-ttu-id="94ed8-140">Views</span><span class="sxs-lookup"><span data-stu-id="94ed8-140">Views</span></span>
<span data-ttu-id="94ed8-141">Log Analytics 中的檢視可以視覺方式呈現 Log Analytics 儲存機制中的資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-141">Views in Log Analytics are used to visualize data from the Log Analytics repository.</span></span>  <span data-ttu-id="94ed8-142">每個解決方案通常會有一個檢視，這個檢視具有[圖格](../log-analytics/log-analytics-view-designer-tiles.md)，並且會顯示在使用者的主要儀表板上。</span><span class="sxs-lookup"><span data-stu-id="94ed8-142">Each solution will typically contain a single view with a [tile](../log-analytics/log-analytics-view-designer-tiles.md) that is displayed on the user's main dashboard.</span></span>  <span data-ttu-id="94ed8-143">檢視可以包含任意數目的[視覺效果部分](../log-analytics/log-analytics-view-designer-parts.md)，以便為使用者提供不同的視覺效果來呈現收集到的資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-143">The view can contain any number of [visualization parts](../log-analytics/log-analytics-view-designer-parts.md) to provide different visualizations of the collected data to the user.</span></span>

<span data-ttu-id="94ed8-144">您可以[使用檢視設計工具來建立自訂檢視](../log-analytics/log-analytics-view-designer.md)，並於稍後匯出以納入解決方案檔中。</span><span class="sxs-lookup"><span data-stu-id="94ed8-144">You [create custom views using the View Designer](../log-analytics/log-analytics-view-designer.md) which you can later export for inclusion in your solution file.</span></span>  


## <a name="create-solution-file"></a><span data-ttu-id="94ed8-145">建立解決方案檔</span><span class="sxs-lookup"><span data-stu-id="94ed8-145">Create solution file</span></span>
<span data-ttu-id="94ed8-146">在設定並測試要成為解決方案一部分的元件後，您可以[建立解決方案檔](operations-management-suite-solutions-solution-file.md)。</span><span class="sxs-lookup"><span data-stu-id="94ed8-146">Once you've configured and tested the components that will be part of your solution, you can [create your solution file](operations-management-suite-solutions-solution-file.md).</span></span>  <span data-ttu-id="94ed8-147">您會將解決方案元件實作在 [Resource Manager 範本](../azure-resource-manager/resource-group-authoring-templates.md)中，此範本所包含的[解決方案資源](operations-management-suite-solutions-solution-file.md#solution-resource)會與檔案中的其他資源有所關聯。</span><span class="sxs-lookup"><span data-stu-id="94ed8-147">You will implement the solution components in a [Resource Manager template](../azure-resource-manager/resource-group-authoring-templates.md) that includes a [solution resource](operations-management-suite-solutions-solution-file.md#solution-resource) with relationships to the other resources in the file.</span></span>  


## <a name="test-your-solution"></a><span data-ttu-id="94ed8-148">測試解決方案</span><span class="sxs-lookup"><span data-stu-id="94ed8-148">Test your solution</span></span>
<span data-ttu-id="94ed8-149">在開發解決方案的同時，您必須將其安裝在工作區中並進行測試。</span><span class="sxs-lookup"><span data-stu-id="94ed8-149">While you are developing your solution, you will need to install and test it in your workspace.</span></span>  <span data-ttu-id="94ed8-150">您可以使用任何可用來[測試和安裝 Resource Manager 範本](../azure-resource-manager/resource-group-template-deploy.md)的方法來進行此操作。</span><span class="sxs-lookup"><span data-stu-id="94ed8-150">You can do this using any of the available methods to [test and install Resource Manager templates](../azure-resource-manager/resource-group-template-deploy.md).</span></span>

## <a name="publish-your-solution"></a><span data-ttu-id="94ed8-151">發佈您的解決方案</span><span class="sxs-lookup"><span data-stu-id="94ed8-151">Publish your solution</span></span>
<span data-ttu-id="94ed8-152">解決方案完成並通過測試後，您可以透過下列來源將它提供給客戶。</span><span class="sxs-lookup"><span data-stu-id="94ed8-152">Once you have completed and tested your solution, you can make it available to customers through either the following sources.</span></span>

- <span data-ttu-id="94ed8-153">**Azure 快速入門範本**。</span><span class="sxs-lookup"><span data-stu-id="94ed8-153">**Azure Quickstart templates**.</span></span>  <span data-ttu-id="94ed8-154">[Azure 快速入門範本](https://azure.microsoft.com/resources/templates/)是一組由社群成員透過 GitHub 所貢獻的 Resource Manager 範本。</span><span class="sxs-lookup"><span data-stu-id="94ed8-154">[Azure Quickstart templates](https://azure.microsoft.com/resources/templates/) is a set of Resource Manager templates contributed by the community through GitHub.</span></span>  <span data-ttu-id="94ed8-155">您可以藉由遵循[參與指南](https://github.com/Azure/azure-quickstart-templates/tree/master/1-CONTRIBUTION-GUIDE)中的資訊，來提供您的解決方案。</span><span class="sxs-lookup"><span data-stu-id="94ed8-155">You can make your solution available by following information in the [contribution guide](https://github.com/Azure/azure-quickstart-templates/tree/master/1-CONTRIBUTION-GUIDE).</span></span>
- <span data-ttu-id="94ed8-156">**Azure Marketplace**。</span><span class="sxs-lookup"><span data-stu-id="94ed8-156">**Azure Marketplace**.</span></span>  <span data-ttu-id="94ed8-157">[Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/) 可讓您將解決方案散發和販售給其他開發人員、ISV 和 IT 專業人員。</span><span class="sxs-lookup"><span data-stu-id="94ed8-157">The [Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/) allows you to distribute and sell your solution to other developers, ISVs, and IT professionals.</span></span>  <span data-ttu-id="94ed8-158">您可以在[如何在 Azure Marketplace 中發佈和管理供應項目](../marketplace-publishing/marketplace-publishing-getting-started.md)中，了解如何將解決方案發佈至 Azure Marketplace。</span><span class="sxs-lookup"><span data-stu-id="94ed8-158">You can learn how to publish your solution to Azure Marketplace at [How to publish and manage an offer in the Azure Marketplace](../marketplace-publishing/marketplace-publishing-getting-started.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="94ed8-159">後續步驟</span><span class="sxs-lookup"><span data-stu-id="94ed8-159">Next steps</span></span>
* <span data-ttu-id="94ed8-160">了解如何為您的管理解決方案[建立解決方案檔](operations-management-suite-solutions-solution-file.md)。</span><span class="sxs-lookup"><span data-stu-id="94ed8-160">Learn how to [create a solution file](operations-management-suite-solutions-solution-file.md) for your management solution.</span></span>
* <span data-ttu-id="94ed8-161">了解[編寫 Azure Resource Manager 範本](../azure-resource-manager/resource-group-authoring-templates.md)的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="94ed8-161">Learn the details of [Authoring Azure Resource Manager templates](../azure-resource-manager/resource-group-authoring-templates.md).</span></span>
* <span data-ttu-id="94ed8-162">搜尋 [Azure 快速入門範本](https://azure.microsoft.com/documentation/templates)不同 Resource Manager 範本的範例。</span><span class="sxs-lookup"><span data-stu-id="94ed8-162">Search [Azure Quickstart Templates](https://azure.microsoft.com/documentation/templates) for samples of different Resource Manager templates.</span></span>