---
title: "匯出 Azure Cosmos DB 模擬器憑證 | Microsoft Docs"
description: "以不使用 Windows 憑證存放區的語言和執行階段進行開發時，您必須匯出和管理 SSL 憑證。 這篇文章提供逐步指示。"
services: cosmos-db
documentationcenter: 
keywords: "Azure Cosmos DB 模擬器"
author: voellm
manager: jhubbard
editor: 
ms.assetid: ef43deda-c2e9-4193-99e2-7f6a88a0319f
ms.service: cosmos-db
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 06/06/2017
ms.author: tvoellm
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 4add5028d50972316902cecd8c399781c012cb77
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="export-the-azure-cosmos-db-emulator-certificates-for-use-with-java-python-and-nodejs"></a><span data-ttu-id="f7359-105">匯出 Azure Cosmos DB 模擬器憑證以與 Java、Python 和 Node.js 搭配使用</span><span class="sxs-lookup"><span data-stu-id="f7359-105">Export the Azure Cosmos DB Emulator certificates for use with Java, Python, and Node.js</span></span>

[<span data-ttu-id="f7359-106">**下載模擬器**</span><span class="sxs-lookup"><span data-stu-id="f7359-106">**Download the Emulator**</span></span>](https://aka.ms/cosmosdb-emulator)

<span data-ttu-id="f7359-107">Azure Cosmos DB 模擬器提供一個模擬 Azure Cosmos DB 服務的本機環境做為開發之用，當中也能使用 SSL 連線。</span><span class="sxs-lookup"><span data-stu-id="f7359-107">The Azure Cosmos DB Emulator provides a local environment that emulates the Azure Cosmos DB service for development purposes including its use of SSL connections.</span></span> <span data-ttu-id="f7359-108">這篇文章示範如何匯出 SSL 憑證以用於未整合 Windows 憑證存放區的語言和執行階段，例如使用它自己的[憑證存放區 (certificate store)](https://docs.oracle.com/cd/E19830-01/819-4712/ablqw/index.html) 的 Java，和使用[通訊端包裝函式 (socket wrappers)](https://docs.python.org/2/library/ssl.html) 的 Python 以及使用 [tlsSocket](https://nodejs.org/api/tls.html#tls_tls_connect_options_callback) 的 Node.js。</span><span class="sxs-lookup"><span data-stu-id="f7359-108">This post demonstrates how to export the SSL certificates for use in languages and runtimes that do not integrate with the Windows Certificate Store such as Java which uses its own [certificate store](https://docs.oracle.com/cd/E19830-01/819-4712/ablqw/index.html) and Python which uses [socket wrappers](https://docs.python.org/2/library/ssl.html) and Node.js which uses [tlsSocket](https://nodejs.org/api/tls.html#tls_tls_connect_options_callback).</span></span> <span data-ttu-id="f7359-109">您可以閱讀[使用 Azure Cosmos DB 模擬器進行開發和測試](./local-emulator.md)，瞭解更多有關模擬器的資訊。</span><span class="sxs-lookup"><span data-stu-id="f7359-109">You can read more about the emulator in [Use the Azure Cosmos DB Emulator for development and testing](./local-emulator.md).</span></span>

<span data-ttu-id="f7359-110">本教學課程涵蓋下列工作：</span><span class="sxs-lookup"><span data-stu-id="f7359-110">This tutorial covers the following tasks:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="f7359-111">輪替憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-111">Rotating certificates</span></span>
> * <span data-ttu-id="f7359-112">匯出 SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-112">Exporting SSL certificate</span></span>
> * <span data-ttu-id="f7359-113">了解如何使用 Java、Python 和 Node.js 中的憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-113">Learning how to use the certificate in Java, Python, and Node.js</span></span>

## <a name="certification-rotation"></a><span data-ttu-id="f7359-114">憑證旋轉</span><span class="sxs-lookup"><span data-stu-id="f7359-114">Certification rotation</span></span>

<span data-ttu-id="f7359-115">Azure Cosmos DB 本機模擬器中的憑證會在模擬器第一次執行時產生。</span><span class="sxs-lookup"><span data-stu-id="f7359-115">Certificates in the Azure Cosmos DB Local Emulator are generated the first time the emulator is run.</span></span> <span data-ttu-id="f7359-116">有兩個憑證。</span><span class="sxs-lookup"><span data-stu-id="f7359-116">There are two certificates.</span></span> <span data-ttu-id="f7359-117">一個用來連線到本機模擬器，一個用來管理模擬器中的機密資料。</span><span class="sxs-lookup"><span data-stu-id="f7359-117">One used for connecting to the local emulator and one for managing secrets within the emulator.</span></span> <span data-ttu-id="f7359-118">您要匯出的憑證是有 "DocumentDBEmulatorCertificate" 易記名稱的連線憑證。</span><span class="sxs-lookup"><span data-stu-id="f7359-118">The certificate you want to export is the connection certificate with the friendly name "DocumentDBEmulatorCertificate".</span></span>

<span data-ttu-id="f7359-119">您可以從 Windows 系統匣中執行的 Azure Cosmos DB 模擬器按一下 [重設資料] 來重新產生這兩個憑證，如下所示。</span><span class="sxs-lookup"><span data-stu-id="f7359-119">Both certificates can be regenerated by clicking **Reset Data** as shown below from Azure Cosmos DB Emulator running in the Windows Tray.</span></span> <span data-ttu-id="f7359-120">如果您重新產生憑證並將這些憑證安裝到 Java 憑證存放區或在其他地方使用它們，則必須更新這些憑證，否則您的應用程式將無法再連線到本機模擬器。</span><span class="sxs-lookup"><span data-stu-id="f7359-120">If you regenerate the certificates and have installed them into the Java certificate store or used them elsewhere you will need to update them, otherwise your application will no longer connect to the local emulator.</span></span>

![Azure Cosmos DB 本機模擬器的重設資料](./media/local-emulator-export-ssl-certificates/database-local-emulator-reset-data.png)

## <a name="how-to-export-the-azure-cosmos-db-ssl-certificate"></a><span data-ttu-id="f7359-122">如何匯出 Azure Cosmos DB SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-122">How to export the Azure Cosmos DB SSL certificate</span></span>

1. <span data-ttu-id="f7359-123">執行 certlm.msc 啟動 Windows 憑證管理員，瀏覽至 [個人 -> 憑證] 資料夾並開啟有 **DocumentDbEmulatorCertificate** 易記名稱的憑證。</span><span class="sxs-lookup"><span data-stu-id="f7359-123">Start the Windows Certificate manager by running certlm.msc and navigate to the Personal->Certificates folder and open the certificate with the friendly name **DocumentDbEmulatorCertificate**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 1](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-1.png)

2. <span data-ttu-id="f7359-125">按一下 [詳細資料]，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="f7359-125">Click on **Details** then **OK**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 2](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-2.png)

3. <span data-ttu-id="f7359-127">按一下 [複製到檔案...]。</span><span class="sxs-lookup"><span data-stu-id="f7359-127">Click **Copy to File...**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 3](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-3.png)

4. <span data-ttu-id="f7359-129">按一下 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="f7359-129">Click **Next**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 4](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-4.png)

5. <span data-ttu-id="f7359-131">按一下 [否，不要匯出私密金鑰 ]，然後按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="f7359-131">Click **No, do not export private key**, then click **Next**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 5](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-5.png)

6. <span data-ttu-id="f7359-133">按一下 [Base-64 編碼的 X.509 (.CER)]，然後按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="f7359-133">Click on **Base-64 encoded X.509 (.CER)** and then **Next**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 6](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-6.png)

7. <span data-ttu-id="f7359-135">指定憑證的名稱。</span><span class="sxs-lookup"><span data-stu-id="f7359-135">Give the certificate a name.</span></span> <span data-ttu-id="f7359-136">此案例中為 **documentdbemulatorcert**，然後按 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="f7359-136">In this case **documentdbemulatorcert** and then click **Next**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 7](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-7.png)

8. <span data-ttu-id="f7359-138">按一下 [完成] 。</span><span class="sxs-lookup"><span data-stu-id="f7359-138">Click **Finish**.</span></span>

    ![Azure Cosmos DB 本機模擬器的匯出步驟 8](./media/local-emulator-export-ssl-certificates/database-local-emulator-export-step-8.png)

## <a name="how-to-use-the-certificate-in-java"></a><span data-ttu-id="f7359-140">如何在 Java 中使用憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-140">How to use the certificate in Java</span></span>

<span data-ttu-id="f7359-141">執行 Java 應用程式或執行使用 Java 用戶端的 MongoDB 應用程式時，將憑證安裝到 Java 預設憑證存放區比傳遞 "-Djavax.net.ssl.trustStore=<keystore> -Djavax.net.ssl.trustStorePassword="<password>" 旗標更簡單。</span><span class="sxs-lookup"><span data-stu-id="f7359-141">When running Java applications or MongoDB applications that use the Java client it is easier to install the certificate into the Java default certificate store than passing the "-Djavax.net.ssl.trustStore=<keystore> -Djavax.net.ssl.trustStorePassword="<password>" flags.</span></span> <span data-ttu-id="f7359-142">例如包含的 [Java 示範應用程式](https://localhost:8081/_explorer/index.html)會根據預設的憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="f7359-142">For example the included [Java Demo application](https://localhost:8081/_explorer/index.html) depends on the default certificate store.</span></span>

<span data-ttu-id="f7359-143">遵循[新增憑證至 Java CA 憑證存放區](https://docs.microsoft.com/azure/java-add-certificate-ca-store)中的指示，將 X.509 憑證匯入預設的 Java 憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="f7359-143">Follow the instructions in the [Adding a Certificate to the Java CA Certificates Store](https://docs.microsoft.com/azure/java-add-certificate-ca-store) to import the X.509 certificate into the default Java certificate store.</span></span> <span data-ttu-id="f7359-144">請記住，執行 keytool 時您會在 %JAVA_HOME% 目錄中工作。</span><span class="sxs-lookup"><span data-stu-id="f7359-144">Keep in mind you will be working in the %JAVA_HOME% directory when running keytool.</span></span>

<span data-ttu-id="f7359-145">"CosmosDBEmulatorCertificate" SSL 憑證安裝好之後，應用程式應該就能夠連線，並使用本機 Azure Cosmos DB 模擬器。</span><span class="sxs-lookup"><span data-stu-id="f7359-145">Once the "CosmosDBEmulatorCertificate" SSL certificate is installed your application should be able to connect and use the local Azure Cosmos DB Emulator.</span></span> <span data-ttu-id="f7359-146">如果您仍然遇到問題，可以遵循[為 SSL/TLS 連線進行偵錯](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/ReadDebug.html) (英文) 文章。</span><span class="sxs-lookup"><span data-stu-id="f7359-146">If you continue to have trouble you may want to follow the [Debugging SSL/TLS Connections](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/ReadDebug.html) article.</span></span> <span data-ttu-id="f7359-147">很有可能是憑證未安裝至 %JAVA_HOME%/jre/lib/security/cacerts 存放區。</span><span class="sxs-lookup"><span data-stu-id="f7359-147">It is very likely the certificate is not installed into the %JAVA_HOME%/jre/lib/security/cacerts store.</span></span> <span data-ttu-id="f7359-148">例如，如果您安裝多個 Java 版本，您的應用程式使用的 cacerts 存放區可能與您更新的不同。</span><span class="sxs-lookup"><span data-stu-id="f7359-148">For example if you have multiple installed versions of Java your application may be using a different cacerts store than the one you updated.</span></span>

## <a name="how-to-use-the-certificate-in-python"></a><span data-ttu-id="f7359-149">如何在 Python 中使用憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-149">How to use the certificate in Python</span></span>

<span data-ttu-id="f7359-150">適用於 DocumentDB API 的 [Python SDK (2.0.0 版或更新版本)](documentdb-sdk-python.md) 在連線到本機模擬器時，預設不會嘗試和使用 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="f7359-150">By default the [Python SDK(version 2.0.0 or higher)](documentdb-sdk-python.md) for the DocumentDB API will not try and use the SSL certificate when connecting to the local emulator.</span></span> <span data-ttu-id="f7359-151">不過如果您想要使用 SSL 驗證，可以依照 [Python 通訊端包裝函式](https://docs.python.org/2/library/ssl.html) (英文) 文件中的範例。</span><span class="sxs-lookup"><span data-stu-id="f7359-151">If however you want to use SSL validation you can follow the examples in the [Python socket wrappers](https://docs.python.org/2/library/ssl.html) documentation.</span></span>

## <a name="how-to-use-the-certificate-in-nodejs"></a><span data-ttu-id="f7359-152">如何在 Node.js 中使用憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-152">How to use the certificate in Node.js</span></span>

<span data-ttu-id="f7359-153">適用於 DocumentDB API 的 [ (1.10.1 版或更新版本)](documentdb-sdk-node.md) 在連線到本機模擬器時，預設不會嘗試和使用 SSL 憑證。</span><span class="sxs-lookup"><span data-stu-id="f7359-153">By default the [Node.js SDK(version 1.10.1 or higher)](documentdb-sdk-node.md) for the DocumentDB API will not try and use the SSL certificate when connecting to the local emulator.</span></span> <span data-ttu-id="f7359-154">不過如果您想要使用 SSL 驗證，可以依照 [Node.js 文件 (Node.js documentation)](https://nodejs.org/api/tls.html#tls_tls_connect_options_callback) 文件中的範例。</span><span class="sxs-lookup"><span data-stu-id="f7359-154">If however you want to use SSL validation you can follow the examples in the [Node.js documentation](https://nodejs.org/api/tls.html#tls_tls_connect_options_callback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f7359-155">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f7359-155">Next steps</span></span>

<span data-ttu-id="f7359-156">在本教學課程中，您已完成下列操作：</span><span class="sxs-lookup"><span data-stu-id="f7359-156">In this tutorial, you've done the following:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="f7359-157">輪替憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-157">Rotated certificates</span></span>
> * <span data-ttu-id="f7359-158">匯出 SSL 憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-158">Exported the SSL certificate</span></span>
> * <span data-ttu-id="f7359-159">了解如何使用 Java、Python 和 Node.js 中的憑證</span><span class="sxs-lookup"><span data-stu-id="f7359-159">Learned how to use the certificate in Java, Python and Node.js</span></span>

<span data-ttu-id="f7359-160">您現在可以繼續進行＜概念＞一節了解有關 Cosmos DB 的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f7359-160">You can now proceed to the Concepts section for more information about Cosmos DB.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="f7359-161">全球發佈</span><span class="sxs-lookup"><span data-stu-id="f7359-161">Global distribution</span></span>](distribute-data-globally.md) 
