---
title: "使用 BI 分析工具連線到 Azure Cosmos DB | Microsoft Docs"
description: "了解如何使用 Azure Cosmos DB ODBC 驅動程式建立資料表和檢視，使標準化資料可以在 BI 以及資料分析軟體中檢視。"
keywords: "odbc, odbc 驅動程式"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 9967f4e5-4b71-4cd7-8324-221a8c789e6b
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: rest-api
ms.topic: article
ms.date: 05/24/2017
ms.author: mimig
ms.openlocfilehash: 2df792c00b7a789dbefa64bfe0245f1ad73c3faa
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="connect-to-azure-cosmos-db-using-bi-analytics-tools-with-the-odbc-driver"></a><span data-ttu-id="c9a86-104">使用 BI 分析工具搭配 ODBC 驅動程式連線到 Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="c9a86-104">Connect to Azure Cosmos DB using BI analytics tools with the ODBC driver</span></span>

<span data-ttu-id="c9a86-105">Azure Cosmos DB ODBC 驅動程式可讓您使用 BI 分析工具 (例如 SQL Server 整合服務、Power BI Desktop 和 Tableau) 連線到 Azure Cosmos DB，讓您可以在那些解決方案中分析和建立您的 Azure Cosmos DB 資料視覺效果。</span><span class="sxs-lookup"><span data-stu-id="c9a86-105">The Azure Cosmos DB ODBC driver enables you to connect to Azure Cosmos DB using BI analytics tools such as SQL Server Integration Services, Power BI Desktop, and Tableau so that you can analyze and create visualizations of your Azure Cosmos DB data in those solutions.</span></span>

<span data-ttu-id="c9a86-106">Azure Cosmos DB ODBC 驅動程式符合 ODBC 3.8 規範，且支援 ANSI SQL-92 語法。</span><span class="sxs-lookup"><span data-stu-id="c9a86-106">The Azure Cosmos DB ODBC driver is ODBC 3.8 compliant and supports ANSI SQL-92 syntax.</span></span> <span data-ttu-id="c9a86-107">該驅動程式提供豐富的功能，可協助您重新標準化 Azure Cosmos DB 中的資料。</span><span class="sxs-lookup"><span data-stu-id="c9a86-107">The driver offers rich features to help you renormalize data in Azure Cosmos DB.</span></span> <span data-ttu-id="c9a86-108">您可以使用驅動程式將 Azure Cosmos DB 中的資料以資料表或檢視來表示。</span><span class="sxs-lookup"><span data-stu-id="c9a86-108">Using the driver, you can represent data in Azure Cosmos DB as tables and views.</span></span> <span data-ttu-id="c9a86-109">該驅動程式可讓您針對資料表和檢視執行 SQL 作業，包括依查詢、插入、更新和刪除分組。</span><span class="sxs-lookup"><span data-stu-id="c9a86-109">The driver enables you to perform SQL operations against the tables and views including group by queries, inserts, updates, and deletes.</span></span>

## <a name="why-do-i-need-to-normalize-my-data"></a><span data-ttu-id="c9a86-110">為什麼需要將我的資料標準化？</span><span class="sxs-lookup"><span data-stu-id="c9a86-110">Why do I need to normalize my data?</span></span>
<span data-ttu-id="c9a86-111">Azure Cosmos DB 是一種無結構描述的資料庫，因此它會透過讓應用程式即時逐一查看其資料模型，且不以嚴格的結構描述限制應用程式，來快速開發應用程式。</span><span class="sxs-lookup"><span data-stu-id="c9a86-111">Azure Cosmos DB is a schemaless database, so it enables rapid development of apps by enabling applications to iterate their data model on the fly and not confine them to a strict schema.</span></span> <span data-ttu-id="c9a86-112">單一 Azure Cosmos DB 資料庫可以包含各種結構的 JSON 文件。</span><span class="sxs-lookup"><span data-stu-id="c9a86-112">A single Azure Cosmos DB database can contain JSON documents of various structures.</span></span> <span data-ttu-id="c9a86-113">這非常適合快速應用程式開發，但是當您想要使用資料分析和 BI 工具分析和建立資料報告時，資料通常都需要壓平合併，並遵循特定的結構描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-113">This is great for rapid application development, but when you want to analyze and create reports of your data using data analytics and BI tools, the data often needs to be flattened and adhere to a specific schema.</span></span>

<span data-ttu-id="c9a86-114">這時就需要 ODBC 驅動程式。</span><span class="sxs-lookup"><span data-stu-id="c9a86-114">This is where the ODBC driver comes in.</span></span> <span data-ttu-id="c9a86-115">透過使用 ODBC 驅動程式，您現在可以將 Azure Cosmos DB 中的資料重新標準化為符合您資料分析與報告需求的資料表和檢視。</span><span class="sxs-lookup"><span data-stu-id="c9a86-115">By using the ODBC driver, you can now renormalized data in Azure Cosmos DB into tables and views fitting to your data analytic and reporting needs.</span></span> <span data-ttu-id="c9a86-116">重新標準化的結構描述不會對基礎資料造成影響，也不會限制開發人員必須遵循它們，它們只是可讓您利用符合 ODBC 規範的工具來存取資料。</span><span class="sxs-lookup"><span data-stu-id="c9a86-116">The renormalized schemas have no impact on the underlying data and do not confine developers to adhere to them, they simply enable you to leverage ODBC-compliant tools to access the data.</span></span> <span data-ttu-id="c9a86-117">因此，現在您的 Azure Cosmos DB 資料庫不會只是開發小組的最愛，也會是資料分析師的最愛。</span><span class="sxs-lookup"><span data-stu-id="c9a86-117">So now your Azure Cosmos DB database will not only be a favorite for your development team, but your data analysts will love it too.</span></span>

<span data-ttu-id="c9a86-118">現在讓我們開始使用 ODBC 驅動程式。</span><span class="sxs-lookup"><span data-stu-id="c9a86-118">Now lets get started with the ODBC driver.</span></span>

## <span data-ttu-id="c9a86-119"><a id="install"></a>步驟 1︰安裝 Azure Cosmos DB ODBC 驅動程式</span><span class="sxs-lookup"><span data-stu-id="c9a86-119"><a id="install"></a>Step 1: Install the Azure Cosmos DB ODBC driver</span></span>

1. <span data-ttu-id="c9a86-120">下載適用於您的環境的驅動程式：</span><span class="sxs-lookup"><span data-stu-id="c9a86-120">Download the drivers for your environment:</span></span>

    * <span data-ttu-id="c9a86-121">適用於 64 位元 Windows 的 [Microsoft Azure Cosmos DB ODBC 64-bit.msi](https://aka.ms/documentdb-odbc-64x64)</span><span class="sxs-lookup"><span data-stu-id="c9a86-121">[Microsoft Azure Cosmos DB ODBC 64-bit.msi](https://aka.ms/documentdb-odbc-64x64) for 64-bit Windows</span></span>
    * <span data-ttu-id="c9a86-122">適用於 32 位元和 64 位元 Windows 的 [Microsoft Azure Cosmos DB ODBC 32x64-bit.msi](https://aka.ms/documentdb-odbc-32x64)</span><span class="sxs-lookup"><span data-stu-id="c9a86-122">[Microsoft Azure Cosmos DB ODBC 32x64-bit.msi](https://aka.ms/documentdb-odbc-32x64) for 32-bit on 64-bit Windows</span></span>
    * <span data-ttu-id="c9a86-123">適用於 32 位元 Windows 的 [Microsoft Azure Cosmos DB ODBC 32-bit.msi](https://aka.ms/documentdb-odbc-32x32)</span><span class="sxs-lookup"><span data-stu-id="c9a86-123">[Microsoft Azure Cosmos DB ODBC 32-bit.msi](https://aka.ms/documentdb-odbc-32x32) for 32-bit Windows</span></span>

    <span data-ttu-id="c9a86-124">在本機執行 msi 檔案，它會啟動 **Microsoft Azure Cosmos DB ODBC 驅動程式安裝精靈**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-124">Run the msi file locally, which starts the **Microsoft Azure Cosmos DB ODBC Driver Installation Wizard**.</span></span> 
2. <span data-ttu-id="c9a86-125">使用預設的輸入安裝 ODBC 驅動程式，以完成安裝精靈。</span><span class="sxs-lookup"><span data-stu-id="c9a86-125">Complete the installation wizard using the default input to install the ODBC driver.</span></span>
3. <span data-ttu-id="c9a86-126">開啟您電腦上的 [ODBC 資料來源管理員] App。您可以在 Windows 搜尋方塊中輸入 [ODBC 資料來源] 來開啟它。</span><span class="sxs-lookup"><span data-stu-id="c9a86-126">Open the **ODBC Data source Administrator** app on your computer, you can do this by typing **ODBC Data sources** in the Windows search box.</span></span> 
    <span data-ttu-id="c9a86-127">您可以按一下 [驅動程式] 索引標籤來確認驅動程式已安裝，並確定已列出 **Microsoft Azure Cosmos DB ODBC 驅動程式**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-127">You can confirm the driver was installed by clicking the **Drivers** tab and ensuring **Microsoft Azure Cosmos DB ODBC Driver** is listed.</span></span>

    ![Azure Cosmos DB ODBC 資料來源管理員](./media/odbc-driver/odbc-driver.png)

## <span data-ttu-id="c9a86-129"><a id="connect"></a>步驟 2：連線至 Azure Cosmos DB 資料庫</span><span class="sxs-lookup"><span data-stu-id="c9a86-129"><a id="connect"></a>Step 2: Connect to your Azure Cosmos DB database</span></span>

1. <span data-ttu-id="c9a86-130">[安裝 Azure Cosmos DB ODBC 驅動程式](#install)之後，在 [ODBC 資料來源管理員] 視窗中，按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-130">After [Installing the Azure Cosmos DB ODBC driver](#install), in the **ODBC Data Source Administrator** window, click **Add**.</span></span> <span data-ttu-id="c9a86-131">您可以建立「使用者 DSN」或「系統 DSN」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-131">You can create a User or System DSN.</span></span> <span data-ttu-id="c9a86-132">在此範例中，我們會建立「使用者 DSN」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-132">In this example, we are creating a User DSN.</span></span>
2. <span data-ttu-id="c9a86-133">在 [建立新的資料來源] 視窗中，選取 [Microsoft Azure Cosmos DB ODBC 驅動程式]，然後按一下 [完成]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-133">In the **Create New Data Source** window, select **Microsoft Azure Cosmos DB ODBC Driver**, and then click **Finish**.</span></span>
3. <span data-ttu-id="c9a86-134">在 [Azure Cosmos DB ODBC 驅動程式 SDN 設定] 視窗中，填寫下列項目︰</span><span class="sxs-lookup"><span data-stu-id="c9a86-134">In the **Azure Cosmos DB ODBC Driver SDN Setup** window, fill in the following:</span></span> 

    ![Azure Cosmos DB ODBC 驅動程式 DSN 設定視窗](./media/odbc-driver/odbc-driver-dsn-setup.png)
    - <span data-ttu-id="c9a86-136">**資料來源名稱**：您的 ODBC DSN 易記名稱。</span><span class="sxs-lookup"><span data-stu-id="c9a86-136">**Data Source Name**: Your own friendly name for the ODBC DSN.</span></span> <span data-ttu-id="c9a86-137">此名稱專屬於您的 Azure Cosmos DB 帳戶，因此如果您有多個帳戶，請適當命名。</span><span class="sxs-lookup"><span data-stu-id="c9a86-137">This name is unique to your Azure Cosmos DB account, so name it appropriately if you have multiple accounts.</span></span>
    - <span data-ttu-id="c9a86-138">**描述**：資料來源的簡短描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-138">**Description**: A brief description of the data source.</span></span>
    - <span data-ttu-id="c9a86-139">**主機**：Azure Cosmos DB 帳戶的 URI。</span><span class="sxs-lookup"><span data-stu-id="c9a86-139">**Host**: URI for your Azure Cosmos DB account.</span></span> <span data-ttu-id="c9a86-140">您可以從 Azure 入口網站中的 [Azure Cosmos DB 金鑰] 刀鋒視窗擷取此資訊，如下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="c9a86-140">You can retrieve this from the Azure Cosmos DB Keys blade in the Azure portal, as shown in the following screenshot.</span></span> 
    - <span data-ttu-id="c9a86-141">**存取金鑰**︰來自 Azure 入口網站中 [Azure Cosmos DB 金鑰] 刀鋒視窗的金鑰，分為主要或次要、讀寫或唯讀金鑰，如下列螢幕擷取畫面所示。</span><span class="sxs-lookup"><span data-stu-id="c9a86-141">**Access Key**: The primary or secondary, read-write or read-only key from the Azure Cosmos DB Keys blade in the Azure portal as shown in the following screenshot.</span></span> <span data-ttu-id="c9a86-142">如果 DSN 是針對唯讀資料處理和報告使用，建議您使用唯讀金鑰。</span><span class="sxs-lookup"><span data-stu-id="c9a86-142">We recommend you use the read-only key if the DSN is used for read-only data processing and reporting.</span></span>
    <span data-ttu-id="c9a86-143">![Azure Cosmos DB 金鑰刀鋒視窗](./media/odbc-driver/odbc-driver-keys.png)</span><span class="sxs-lookup"><span data-stu-id="c9a86-143">![Azure Cosmos DB Keys blade](./media/odbc-driver/odbc-driver-keys.png)</span></span>
    - <span data-ttu-id="c9a86-144">**加密存取金鑰**：根據此電腦的使用者選取最佳選項。</span><span class="sxs-lookup"><span data-stu-id="c9a86-144">**Encrypt Access Key for**: Select the best choice based on the users of this machine.</span></span> 
4. <span data-ttu-id="c9a86-145">按一下 [測試] 按鈕，確定您可以連線到您的 Azure Cosmos DB 帳戶。</span><span class="sxs-lookup"><span data-stu-id="c9a86-145">Click the **Test** button to make sure you can connect to your Azure Cosmos DB account.</span></span> 
5. <span data-ttu-id="c9a86-146">按一下 [進階選項] 並設定下列值︰</span><span class="sxs-lookup"><span data-stu-id="c9a86-146">Click **Advanced Options** and set the following values:</span></span>
    - <span data-ttu-id="c9a86-147">**查詢一致性**︰選取適用於您的作業的[一致性層級](consistency-levels.md)。</span><span class="sxs-lookup"><span data-stu-id="c9a86-147">**Query Consistency**: Select the [consistency level](consistency-levels.md) for your operations.</span></span> <span data-ttu-id="c9a86-148">預設為 [工作階段]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-148">The default is Session.</span></span>
    - <span data-ttu-id="c9a86-149">**重試次數**：輸入初始要求因為服務節流而未完成時，重試作業的次數。</span><span class="sxs-lookup"><span data-stu-id="c9a86-149">**Number of Retries**: Enter the number of times to retry an operation if the initial request does not complete due to service throttling.</span></span>
    - <span data-ttu-id="c9a86-150">**結構描述檔案**：您在這裡有一些選項。</span><span class="sxs-lookup"><span data-stu-id="c9a86-150">**Schema File**: You have a number of options here.</span></span>
        - <span data-ttu-id="c9a86-151">此項目預設為空白，此時驅動程式會掃描所有集合的第一個頁面資料，以判斷每個集合的結構描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-151">By default, leaving this entry as is (blank), the driver scans the first page data for all collections to determine the schema of each collection.</span></span> <span data-ttu-id="c9a86-152">這就是所謂的「集合對應」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-152">This is known as Collection Mapping.</span></span> <span data-ttu-id="c9a86-153">如果沒有定義結構描述檔案，驅動程式必須掃描每一個驅動程式工作階段，而可能導致使用 DSN 的應用程式啟動時間過長。</span><span class="sxs-lookup"><span data-stu-id="c9a86-153">Without a schema file defined, the driver has to perform the scan for each driver session and could result in a higher start up time of an application using the DSN.</span></span> <span data-ttu-id="c9a86-154">建議您一律將結構描述檔案與 DSN 產生關連。</span><span class="sxs-lookup"><span data-stu-id="c9a86-154">We recommend that you always associate a schema file for a DSN.</span></span>
        - <span data-ttu-id="c9a86-155">如果您已經有結構描述檔案 (可能是您使用 [結構描述編輯器](#schema-editor) 建立的)，您可以按一下 [瀏覽]並瀏覽至您的檔案，按一下 [儲存]，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-155">If you already have a schema file (possibly one that you created using the [Schema Editor](#schema-editor)), you can click **Browse**, navigate to your file, click **Save**, and then click **OK**.</span></span>
        - <span data-ttu-id="c9a86-156">如果您想要建立新的結構描述，請按一下 [確定]，然後按一下主視窗中的 [結構描述編輯器]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-156">If you want to create a new schema, click **OK**, and then click **Schema Editor** in the main window.</span></span> <span data-ttu-id="c9a86-157">然後移至[結構描述編輯器](#schema-editor)資訊。</span><span class="sxs-lookup"><span data-stu-id="c9a86-157">Then proceed to the [Schema Editor](#schema-editor) information.</span></span> <span data-ttu-id="c9a86-158">建立新的結構描述檔案時，請記得返回 [進階選項] 視窗，以包含新建立的結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="c9a86-158">Upon creating the new schema file, please remember to go back to the **Advanced Options** window to include the newly created schema file.</span></span>

6. <span data-ttu-id="c9a86-159">一旦您完成 [Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗並關閉，新的使用者 DSN 會加入到 [使用者 DSN] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="c9a86-159">Once you complete and close the **Azure Cosmos DB ODBC Driver DSN Setup** window, the new User DSN is added to the User DSN tab.</span></span>

    ![[使用者 DSN] 索引標籤上的新 Azure Cosmos DB ODBC DSN](./media/odbc-driver/odbc-driver-user-dsn.png)

## <span data-ttu-id="c9a86-161"><a id="#collection-mapping"></a>步驟 3︰使用集合對應方法建立結構描述定義</span><span class="sxs-lookup"><span data-stu-id="c9a86-161"><a id="#collection-mapping"></a>Step 3: Create a schema definition using the collection mapping method</span></span>

<span data-ttu-id="c9a86-162">您可以使用的取樣方法有兩種：**集合對應**或**資料表分隔符號**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-162">There are two types of sampling methods that you can use: **collection mapping** or **table-delimiters**.</span></span> <span data-ttu-id="c9a86-163">取樣工作階段可以利用這兩種取樣方法，但是每個集合僅可以使用特定的取樣方法。</span><span class="sxs-lookup"><span data-stu-id="c9a86-163">A sampling session can utilize both sampling methods, but each collection can only use a specific sampling method.</span></span> <span data-ttu-id="c9a86-164">下列步驟將使用集合對應方法建立一或多個集合中之資料的結構描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-164">The steps below create a schema for the data in one or more collections using the collection mapping method.</span></span> <span data-ttu-id="c9a86-165">此取樣方法會擷取集合的頁面資料，以判斷資料的結構。</span><span class="sxs-lookup"><span data-stu-id="c9a86-165">This sampling method retrieves the data in the page of a collection to determine the structure of the data.</span></span> <span data-ttu-id="c9a86-166">它會將集合轉置到 ODBC 端上的資料表。</span><span class="sxs-lookup"><span data-stu-id="c9a86-166">It transposes a collection to a table on the ODBC side.</span></span> <span data-ttu-id="c9a86-167">當集合中的資料屬同質性，使用此取樣方法便會相當有效率且快速。</span><span class="sxs-lookup"><span data-stu-id="c9a86-167">This sampling method is efficient and fast when the data in a collection is homogenous.</span></span> <span data-ttu-id="c9a86-168">如果集合包含異質性的資料類型，建議您使用[資料表分隔符號對應方法](#table-mapping)，因為它提供了更強固的取樣方法，以判斷集合中的資料結構。</span><span class="sxs-lookup"><span data-stu-id="c9a86-168">If a collection contains heterogenous type of data, we recommend you use the [table-delimiters mapping method](#table-mapping) as it provides a more robust sampling method to determine the data structures in the collection.</span></span> 

1. <span data-ttu-id="c9a86-169">在完成[連線到您的 Azure Cosmos DB 資料庫](#connect)中的步驟 1-4 之後，按一下 [Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗中的 [結構描述編輯器]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-169">After completing steps 1-4 in [Connect to your Azure Cosmos DB database](#connect), click **Schema Editor** in the **Azure Cosmos DB ODBC Driver DSN Setup** window.</span></span>

    ![[Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗中的 [結構描述編輯器] 按鈕](./media/odbc-driver/odbc-driver-schema-editor.png)
2. <span data-ttu-id="c9a86-171">在 [結構描述編輯器] 視窗中，按一下 [新建]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-171">In the **Schema Editor** window, click **Create New**.</span></span>
    <span data-ttu-id="c9a86-172">[產生結構描述] 視窗會顯示 Azure Cosmos DB 帳戶中的所有集合。</span><span class="sxs-lookup"><span data-stu-id="c9a86-172">The **Generate Schema** window displays all the collections in the Azure Cosmos DB account.</span></span> 
3. <span data-ttu-id="c9a86-173">選取一或多個集合來採樣，然後按一下 [樣本]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-173">Select one or more collections to sample, and then click **Sample**.</span></span> 
4. <span data-ttu-id="c9a86-174">在 [設計檢視] 索引標籤中，會顯示資料庫、結構描述和資料表。</span><span class="sxs-lookup"><span data-stu-id="c9a86-174">In the **Design View** tab, the database, schema, and table are represented.</span></span> <span data-ttu-id="c9a86-175">在資料表檢視中，掃描會顯示與資料行名稱 (SQL 名稱、來源名稱等) 相關聯的屬性集。</span><span class="sxs-lookup"><span data-stu-id="c9a86-175">In the table view, the scan displays the set of properties associated with the column names (SQL Name, Source Name, etc.).</span></span>
    <span data-ttu-id="c9a86-176">針對每個資料行，您可以修改資料行「SQL 名稱」、「SQL 類型」、「SQL 長度」(如果適用的話)、「小數位數」(如果適用的話)、「精確度」(如果適用的話)，以及「可為 Null」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-176">For each column, you can modify the column SQL name, the SQL type, SQL length (if applicable), Scale (if applicable), Precision (if applicable) and Nullable.</span></span>
    - <span data-ttu-id="c9a86-177">如果您想要將該資料行從查詢結果中排除，您可以將 [隱藏資料行] 設為 **true**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-177">You can set **Hide Column** to **true** if you want to exclude that column from query results.</span></span> <span data-ttu-id="c9a86-178">雖然 [隱藏資料行] 標註為 true 的資料行仍屬於結構描述的一部份，它並不會針對選取和投影傳回。</span><span class="sxs-lookup"><span data-stu-id="c9a86-178">Columns marked Hide Column = true are not returned for selection and projection, although they are still part of the schema.</span></span> <span data-ttu-id="c9a86-179">例如，您可以隱藏開頭為 “_” 的所有 Azure Cosmos DB 系統必要屬性。</span><span class="sxs-lookup"><span data-stu-id="c9a86-179">For example, you can hide all of the Azure Cosmos DB system required properties starting with “_”.</span></span>
    - <span data-ttu-id="c9a86-180">[識別碼] 資料行是唯一無法隱藏的欄位，因為它會在標準化結構描述中作為主索引鍵使用。</span><span class="sxs-lookup"><span data-stu-id="c9a86-180">The **id** column is the only field that cannot be hidden as it is used as the primary key in the normalized schema.</span></span> 
5. <span data-ttu-id="c9a86-181">當您完成定義結構描述時，按一下 [檔案]  |  [儲存]，瀏覽到要儲存結構描述的目錄，然後按一下 [儲存]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-181">Once you have finished defining the schema, click **File** | **Save**, navigate to the directory to save the schema, and then click **Save**.</span></span>

    <span data-ttu-id="c9a86-182">如果未來您想要使用此結構描述搭配 DSN，請開啟 [Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗 (透過 ODBC 資料來源管理員)，按一下 [進階選項]，然後在 [結構描述檔案] 方塊中瀏覽至已儲存的結構描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-182">If in the future you want to use this schema with a DSN, open the Azure Cosmos DB ODBC Driver DSN Setup window (via the ODBC Data Source Administrator), click Advanced Options, and then in the Schema File box, navigate to the saved schema.</span></span> <span data-ttu-id="c9a86-183">將結構描述檔案儲存至現有的 DSN，會修改 DSN 連線，將範圍設定為由結構描述定義的資料和結構。</span><span class="sxs-lookup"><span data-stu-id="c9a86-183">Saving a schema file to an existing DSN modifies the DSN connection to scope to the data and structure defined by schema.</span></span>

## <span data-ttu-id="c9a86-184"><a id="table-mapping"></a>步驟 4︰使用資料表分隔符號對應方法建立結構描述定義</span><span class="sxs-lookup"><span data-stu-id="c9a86-184"><a id="table-mapping"></a>Step 4: Create a schema definition using the table-delimiters mapping method</span></span>

<span data-ttu-id="c9a86-185">您可以使用的取樣方法有兩種：**集合對應**或**資料表分隔符號**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-185">There are two types of sampling methods that you can use: **collection mapping** or **table-delimiters**.</span></span> <span data-ttu-id="c9a86-186">取樣工作階段可以利用這兩種取樣方法，但是每個集合僅可以使用特定的取樣方法。</span><span class="sxs-lookup"><span data-stu-id="c9a86-186">A sampling session can utilize both sampling methods, but each collection can only use a specific sampling method.</span></span> 

<span data-ttu-id="c9a86-187">下列步驟使用**資料表分隔符號**對應方法，針對一或多個集合中的資料建立結構描述。</span><span class="sxs-lookup"><span data-stu-id="c9a86-187">The following steps create a schema for the data in one or more collections using the **table-delimiters** mapping method.</span></span> <span data-ttu-id="c9a86-188">當您的集合包含異質資料類型時，建議您使用這個取樣方法。</span><span class="sxs-lookup"><span data-stu-id="c9a86-188">We recommend that you use this sampling method when your collections contain heterogeneous type of data.</span></span> <span data-ttu-id="c9a86-189">您可以使用這個方法將取樣範圍設定為一組屬性和其對應值。</span><span class="sxs-lookup"><span data-stu-id="c9a86-189">You can use this method to scope the sampling to a set of attributes and its corresponding values.</span></span> <span data-ttu-id="c9a86-190">比方說，如果文件包含「類型」屬性，您可以將取樣範圍設定為此屬性的值。</span><span class="sxs-lookup"><span data-stu-id="c9a86-190">For example, if a document contains a “Type” property, you can scope the sampling to the values of this property.</span></span> <span data-ttu-id="c9a86-191">取樣的最終結果會是一組針對每一個您所指定之類型值的資料表。</span><span class="sxs-lookup"><span data-stu-id="c9a86-191">The end result of the sampling would be a set of tables for each of the values for Type you have specified.</span></span> <span data-ttu-id="c9a86-192">例如，類型 = Car 會產生「汽車」資料表，而類型 = Plane 會產生「飛機」資料表。</span><span class="sxs-lookup"><span data-stu-id="c9a86-192">For example, Type = Car will produce a Car table while Type = Plane would produce a Plane table.</span></span>

1. <span data-ttu-id="c9a86-193">在完成[連線到您的 Azure Cosmos DB 資料庫](#connect)中的步驟 1-4 之後，按一下 [Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗中的 [結構描述編輯器]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-193">After completing steps 1-4 in [Connect to your Azure Cosmos DB database](#connect), click **Schema Editor** in the Azure Cosmos DB ODBC Driver DSN Setup window.</span></span>
2. <span data-ttu-id="c9a86-194">在 [結構描述編輯器] 視窗中，按一下 [新建]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-194">In the **Schema Editor** window, click **Create New**.</span></span>
    <span data-ttu-id="c9a86-195">[產生結構描述] 視窗會顯示 Azure Cosmos DB 帳戶中的所有集合。</span><span class="sxs-lookup"><span data-stu-id="c9a86-195">The **Generate Schema** window displays all the collections in the Azure Cosmos DB account.</span></span> 
3. <span data-ttu-id="c9a86-196">在 [範例檢視] 索引標籤中選取一個集合，在該集合的 [對應定義] 資料行中按一下 [編輯]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-196">Select a collection on the **Sample View** tab, in the **Mapping Definition** column for the collection, click **Edit**.</span></span> <span data-ttu-id="c9a86-197">接著在 [對應定義] 視窗中，選取 [資料表分隔符號] 方法。</span><span class="sxs-lookup"><span data-stu-id="c9a86-197">Then in the **Mapping Definition** window, select **Table Delimiters** method.</span></span> <span data-ttu-id="c9a86-198">然後執行以下動作：</span><span class="sxs-lookup"><span data-stu-id="c9a86-198">Then do the following:</span></span>

    <span data-ttu-id="c9a86-199">a.</span><span class="sxs-lookup"><span data-stu-id="c9a86-199">a.</span></span> <span data-ttu-id="c9a86-200">在 [屬性] 方塊中，輸入分隔符號屬性的名稱。</span><span class="sxs-lookup"><span data-stu-id="c9a86-200">In the **Attributes** box, type the name of a delimiter property.</span></span> <span data-ttu-id="c9a86-201">這是您在文件中希望設定取樣範圍的屬性 (例如「City」)，然後按一下 Enter 鍵。</span><span class="sxs-lookup"><span data-stu-id="c9a86-201">This is a property in your document that you want to scope the sampling to, for instance, City and press enter.</span></span> 

    <span data-ttu-id="c9a86-202">b.</span><span class="sxs-lookup"><span data-stu-id="c9a86-202">b.</span></span> <span data-ttu-id="c9a86-203">如果您只想將取樣範圍設定為您剛才輸入的特定屬性值，請在選取方塊中選取該屬性，然後在 [值] 方塊中輸入值，例如「Seattle」，然後按一下 Enter 鍵。</span><span class="sxs-lookup"><span data-stu-id="c9a86-203">If you only want to scope the sampling to certain values for the attribute you just entered, select the attribute in the selection box, then enter a value in the **Value** box, for example, Seattle and press enter.</span></span> <span data-ttu-id="c9a86-204">您可以繼續加入多個屬性的值。</span><span class="sxs-lookup"><span data-stu-id="c9a86-204">You can continue to add multiple values for attributes.</span></span> <span data-ttu-id="c9a86-205">只要確定您輸入值時，已選取正確的屬性。</span><span class="sxs-lookup"><span data-stu-id="c9a86-205">Just ensure that the correct attribute is selected when you're entering values.</span></span>

    <span data-ttu-id="c9a86-206">例如，如果您包含「City」的**屬性**值，而您想要限制資料表只包含含有「New York」和「Dubai」之城市值的資料列，可在 [屬性] 方塊中輸入「City」，而在 [值] 方塊中輸入「New York」和「Dubai」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-206">For example, if you include an **Attributes** value of City, and you want to limit your table to only include rows with a city value of New York and Dubai, you would enter City in the Attributes box, and New York and then Dubai in the **Values** box.</span></span>
4. <span data-ttu-id="c9a86-207">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="c9a86-207">Click **OK**.</span></span> 
5. <span data-ttu-id="c9a86-208">在完成您想要取樣之集合的對應定義之後，在 [結構描述編輯器] 視窗中按一下 [取樣]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-208">After completing the mapping definitions for the collections you want to sample, in the **Schema Editor** window, click **Sample**.</span></span>
     <span data-ttu-id="c9a86-209">針對每個資料行，您可以修改資料行「SQL 名稱」、「SQL 類型」、「SQL 長度」(如果適用的話)、「小數位數」(如果適用的話)、「精確度」(如果適用的話)，以及「可為 Null」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-209">For each column, you can modify the column SQL name, the SQL type, SQL length (if applicable), Scale (if applicable), Precision (if applicable) and Nullable.</span></span>
    - <span data-ttu-id="c9a86-210">如果您想要將該資料行從查詢結果中排除，您可以將 [隱藏資料行] 設為 **true**。</span><span class="sxs-lookup"><span data-stu-id="c9a86-210">You can set **Hide Column** to **true** if you want to exclude that column from query results.</span></span> <span data-ttu-id="c9a86-211">雖然 [隱藏資料行] 標註為 true 的資料行仍屬於結構描述的一部份，它並不會針對選取和投影傳回。</span><span class="sxs-lookup"><span data-stu-id="c9a86-211">Columns marked Hide Column = true are not returned for selection and projection, although they are still part of the schema.</span></span> <span data-ttu-id="c9a86-212">例如，您可以隱藏開頭為 “_” 的所有 Azure Cosmos DB 系統必要屬性。</span><span class="sxs-lookup"><span data-stu-id="c9a86-212">For example, you can hide all the Azure Cosmos DB system required properties starting with “_”.</span></span>
    - <span data-ttu-id="c9a86-213">[識別碼] 資料行是唯一無法隱藏的欄位，因為它會在標準化結構描述中作為主索引鍵使用。</span><span class="sxs-lookup"><span data-stu-id="c9a86-213">The **id** column is the only field that cannot be hidden as it is used as the primary key in the normalized schema.</span></span> 
6. <span data-ttu-id="c9a86-214">當您完成定義結構描述時，按一下 [檔案]  |  [儲存]，瀏覽到要儲存結構描述的目錄，然後按一下 [儲存]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-214">Once you have finished defining the schema, click **File** | **Save**, navigate to the directory to save the schema, and then click **Save**.</span></span>
7. <span data-ttu-id="c9a86-215">返回 [Azure Cosmos DB ODBC 驅動程式 DSN 設定] 視窗，按一下 [進階選項]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-215">Back in the **Azure Cosmos DB ODBC Driver DSN Setup** window, click ** Advanced Options**.</span></span> <span data-ttu-id="c9a86-216">然後，在 [結構描述檔案] 方塊中，瀏覽至已儲存的結構描述檔案並按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-216">Then, in the **Schema File** box, navigate to the saved schema file and click **OK**.</span></span> <span data-ttu-id="c9a86-217">再按一下 [確定] 以儲存 DSN。</span><span class="sxs-lookup"><span data-stu-id="c9a86-217">Click **OK** again to save the DSN.</span></span> <span data-ttu-id="c9a86-218">這會將您建立的結構描述儲存到 DSN。</span><span class="sxs-lookup"><span data-stu-id="c9a86-218">This saves the schema you created to the DSN.</span></span> 

## <a name="optional-creating-views"></a><span data-ttu-id="c9a86-219">(選擇性) 建立檢視</span><span class="sxs-lookup"><span data-stu-id="c9a86-219">(Optional) Creating views</span></span>
<span data-ttu-id="c9a86-220">您可以將檢視定義並建立為取樣程序的一部分。</span><span class="sxs-lookup"><span data-stu-id="c9a86-220">You can define and create views as part of the sampling process.</span></span> <span data-ttu-id="c9a86-221">這些檢視相當於 SQL 檢視。</span><span class="sxs-lookup"><span data-stu-id="c9a86-221">These views are equivalent to SQL views.</span></span> <span data-ttu-id="c9a86-222">它們都是唯讀，且以定義的 Azure Cosmos DB SQL 的選取項目與投影為範圍。</span><span class="sxs-lookup"><span data-stu-id="c9a86-222">They are read-only and are scope the selections and projections of the Azure Cosmos DB SQL defined.</span></span> 

<span data-ttu-id="c9a86-223">若要建立您的資料檢視，在 [結構描述編輯器] 視窗的 [檢視定義] 資料行中，在要取樣之集合的資料列上按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-223">To create a view for your data, in the **Schema Editor** window, in the **View Definitions** column, click **Add** on the row of the collection to sample.</span></span> <span data-ttu-id="c9a86-224">接著在 [檢視定義] 視窗中，執行下列動作︰</span><span class="sxs-lookup"><span data-stu-id="c9a86-224">Then in the **View Definitions** window, do the following:</span></span>
1. <span data-ttu-id="c9a86-225">按一下 [新增]，輸入檢視的名稱 (例如 EmployeesfromSeattleView)，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-225">Click **New**, enter a name for the view, for example, EmployeesfromSeattleView and then click **OK**.</span></span>
2. <span data-ttu-id="c9a86-226">在 [編輯檢視] 視窗中，輸入 Azure Cosmos DB 查詢。</span><span class="sxs-lookup"><span data-stu-id="c9a86-226">In the **Edit view** window, enter an Azure Cosmos DB query.</span></span> <span data-ttu-id="c9a86-227">這必須是 Azure Cosmos DB SQL 查詢 (例如 `SELECT c.City, c.EmployeeName, c.Level, c.Age, c.Gender, c.Manager FROM c WHERE c.City = “Seattle”`)，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-227">This must be an Azure Cosmos DB SQL query, for example`SELECT c.City, c.EmployeeName, c.Level, c.Age, c.Gender, c.Manager FROM c WHERE c.City = “Seattle”`, and then click **OK**.</span></span>

<span data-ttu-id="c9a86-228">您可以依需求建立多個檢視。</span><span class="sxs-lookup"><span data-stu-id="c9a86-228">You can create a many views as you like.</span></span> <span data-ttu-id="c9a86-229">在您完成定義檢視後，您可以接著取樣資料。</span><span class="sxs-lookup"><span data-stu-id="c9a86-229">Once you are done defining the views, you can then sample the data.</span></span> 

## <a name="step-5-view-your-data-in-bi-tools-such-as-power-bi-desktop"></a><span data-ttu-id="c9a86-230">步驟 5：在 BI 工具 (例如 Power BI Desktop) 中檢視資料</span><span class="sxs-lookup"><span data-stu-id="c9a86-230">Step 5: View your data in BI tools such as Power BI Desktop</span></span>

<span data-ttu-id="c9a86-231">您可以使用您新的 DSN 將 DocumentADB 與任何符合 ODBC 規範的工具連線 - 此步驟只會顯示如何連線至 Power BI Desktop 並建立 Power BI 視覺效果。</span><span class="sxs-lookup"><span data-stu-id="c9a86-231">You can use your new DSN to connect DocumentADB with any ODBC-compliant tools - this step simply shows you how to connect to Power BI Desktop and create a Power BI visualization.</span></span>

1. <span data-ttu-id="c9a86-232">開啟 Power BI Desktop。</span><span class="sxs-lookup"><span data-stu-id="c9a86-232">Open Power BI Desktop.</span></span>
2. <span data-ttu-id="c9a86-233">按一下 [取得資料]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-233">Click **Get Data**.</span></span>
3. <span data-ttu-id="c9a86-234">在 [取得資料] 視窗中，按一下 [其他]  |  [ODBC]  |  [連線]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-234">In the **Get Data** window, click **Other** | **ODBC** | **Connect**.</span></span>
4. <span data-ttu-id="c9a86-235">在 [從 ODBC] 視窗中，選取您建立的資料來源名稱，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-235">In the **From ODBC** window, select the data source name you created, and then click **OK**.</span></span> <span data-ttu-id="c9a86-236">您可以將 [進階選項] 項目保留空白。</span><span class="sxs-lookup"><span data-stu-id="c9a86-236">You can leave the **Advanced Options** entries blank.</span></span>
5. <span data-ttu-id="c9a86-237">在 [使用 ODBC 驅動程式存取資料來源] 視窗中，選取 [預設或自訂]，然後按一下 [連線]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-237">In the **Access a data source using an ODBC driver** window, select **Default or Custom** and then click **Connect**.</span></span> <span data-ttu-id="c9a86-238">您不需要包含「認證連接字串屬性」。</span><span class="sxs-lookup"><span data-stu-id="c9a86-238">You do not need to include the **Credential connection string properties**.</span></span>
6. <span data-ttu-id="c9a86-239">在 [導覽器] 視窗的左窗格中，展開資料庫，展開結構描述，然後選取資料表。</span><span class="sxs-lookup"><span data-stu-id="c9a86-239">In the **Navigator** window, in the left pane, expand the database, the schema, and then select the table.</span></span> <span data-ttu-id="c9a86-240">結果窗格會包含使用您所建立之結構描述的資料。</span><span class="sxs-lookup"><span data-stu-id="c9a86-240">The results pane includes the data using the schema you created.</span></span>
7. <span data-ttu-id="c9a86-241">若要視覺化 Power BI Desktop 中的資料，請選取資料表名稱前的方塊，然後按一下 [載入]。</span><span class="sxs-lookup"><span data-stu-id="c9a86-241">To visualize the data in Power BI desktop, check the box in front of the table name, and then click **Load**.</span></span>
8. <span data-ttu-id="c9a86-242">在 Power BI Desktop 中最左側，選取 [資料] 索引標籤</span><span class="sxs-lookup"><span data-stu-id="c9a86-242">In Power BI Desktop, on the far left, select the Data tab</span></span> ![Power BI Desktop 中的 [資料] 索引標籤](./media/odbc-driver/odbc-driver-data-tab.png) <span data-ttu-id="c9a86-244">以確認已匯入您的資料。</span><span class="sxs-lookup"><span data-stu-id="c9a86-244">to confirm your data was imported.</span></span>
9. <span data-ttu-id="c9a86-245">您現在可以使用 Power BI 建立視覺效果，方法是按一下 [報告] 索引標籤 (![Power BI Desktop 中的 [報告] 索引標籤](./media/odbc-driver/odbc-driver-report-tab.png))，按一下 [新增視覺效果]，然後自訂您的磚。</span><span class="sxs-lookup"><span data-stu-id="c9a86-245">You can now create visuals using Power BI by clicking on the Report tab ![Report tab in Power BI Desktop](./media/odbc-driver/odbc-driver-report-tab.png), clicking **New Visual**, and then customizing your tile.</span></span> <span data-ttu-id="c9a86-246">如需有關在 Power BI Desktop 中建立視覺效果的詳細資訊，請參閱 [Power BI 中的視覺效果類型](https://powerbi.microsoft.com/documentation/powerbi-service-visualization-types-for-reports-and-q-and-a/)。</span><span class="sxs-lookup"><span data-stu-id="c9a86-246">For more information about creating visualizations in Power BI Desktop, see [Visualization types in Power BI](https://powerbi.microsoft.com/documentation/powerbi-service-visualization-types-for-reports-and-q-and-a/).</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="c9a86-247">疑難排解</span><span class="sxs-lookup"><span data-stu-id="c9a86-247">Troubleshooting</span></span>

<span data-ttu-id="c9a86-248">如果您收到下列錯誤，請確定您在[步驟 2](#connect) 於 Azure 入口網站複製的「主機」與「存取金鑰」值正確，然後再試一次。</span><span class="sxs-lookup"><span data-stu-id="c9a86-248">If you receive the following error, ensure the **Host** and **Access Key** values you copied the Azure portal in [Step 2](#connect) are correct and then retry.</span></span> <span data-ttu-id="c9a86-249">使用 Azure 入口網站中「主機」與「存取金鑰」值右側的 [複製] 按鈕來複製正確的值。</span><span class="sxs-lookup"><span data-stu-id="c9a86-249">Use the copy buttons to the right of the **Host** and **Access Key** values in the Azure portal to copy the values error free.</span></span>

    [HY000]: [Microsoft][Azure Cosmos DB] (401) HTTP 401 Authentication Error: {"code":"Unauthorized","message":"The input authorization token can't serve the request. Please check that the expected payload is built as per the protocol, and check the key being used. Server used the following payload to sign: 'get\ndbs\n\nfri, 20 jan 2017 03:43:55 gmt\n\n'\r\nActivityId: 9acb3c0d-cb31-4b78-ac0a-413c8d33e373"}`

## <a name="next-steps"></a><span data-ttu-id="c9a86-250">後續步驟</span><span class="sxs-lookup"><span data-stu-id="c9a86-250">Next steps</span></span>

<span data-ttu-id="c9a86-251">若要深入了解 Azure Cosmos DB，請參閱[什麼是 Azure Cosmos DB？](introduction.md)。</span><span class="sxs-lookup"><span data-stu-id="c9a86-251">To learn more about Azure Cosmos DB, see [What is Azure Cosmos DB?](introduction.md).</span></span>
