---
title: "Azure AD Connect 同步：在 Azure AD Connect 同步中進行組態變更 | Microsoft Docs"
description: "逐步解說如何 toomake 變更 toohello 設定在 Azure AD Connect 同步處理。"
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 7b9df836-e8a5-4228-97da-2faec9238b31
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 78e96d9166831a668439c2b8aa6a0022bc472da4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-sync-how-toomake-a-change-toohello-default-configuration"></a><span data-ttu-id="8db88-103">Azure AD Connect 同步： 如何變更 toohello toomake 預設組態</span><span class="sxs-lookup"><span data-stu-id="8db88-103">Azure AD Connect sync: How toomake a change toohello default configuration</span></span>
<span data-ttu-id="8db88-104">本主題的 hello 目的是 toowalk 您透過 toomake 如何變更 toohello 預設組態，在 Azure AD Connect 同步處理。其中提供一些常見案例的步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-104">hello purpose of this topic is toowalk you through how toomake changes toohello default configuration in Azure AD Connect sync. It provides steps for some common scenarios.</span></span> <span data-ttu-id="8db88-105">這項知識，您應該能夠 toomake 一些簡單的變更 tooyour 擁有自己的商務規則為基礎的組態。</span><span class="sxs-lookup"><span data-stu-id="8db88-105">With this knowledge, you should be able toomake some simple changes tooyour own configuration based on your own business rules.</span></span>

## <a name="synchronization-rules-editor"></a><span data-ttu-id="8db88-106">同步處理規則編輯器</span><span class="sxs-lookup"><span data-stu-id="8db88-106">Synchronization Rules Editor</span></span>
<span data-ttu-id="8db88-107">hello 同步處理規則編輯器是使用的 toosee 和變更 hello 預設組態。</span><span class="sxs-lookup"><span data-stu-id="8db88-107">hello Synchronization Rules Editor is used toosee and change hello default configuration.</span></span> <span data-ttu-id="8db88-108">您可以在 hello 開始 功能表底下 hello **Azure AD Connect**群組。</span><span class="sxs-lookup"><span data-stu-id="8db88-108">You can find it in hello Start Menu under hello **Azure AD Connect** group.</span></span>  
<span data-ttu-id="8db88-109">![內含同步處理規則編輯器的開始功能表](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-109">![Start Menu with Sync Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span></span>

<span data-ttu-id="8db88-110">當您開啟它時，您會看到 hello 預設鶈蜪規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-110">When you open it, you see hello default out-of-box rules.</span></span>

![同步處理規則編輯器](./media/active-directory-aadconnectsync-change-the-configuration/sre2.png)

### <a name="navigating-in-hello-editor"></a><span data-ttu-id="8db88-112">在 hello 編輯器中巡覽</span><span class="sxs-lookup"><span data-stu-id="8db88-112">Navigating in hello editor</span></span>
<span data-ttu-id="8db88-113">hello 下拉式清單頂端 hello hello 編輯器可讓您 tooquickly 尋找特定的規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-113">hello drop-downs at hello top of hello editor allow you tooquickly find a particular rule.</span></span> <span data-ttu-id="8db88-114">例如，如果您想 hello 屬性 proxyAddresses 隨附的其中 toosee hello 規則時，會變更 hello 下拉式清單 toohello 下列：</span><span class="sxs-lookup"><span data-stu-id="8db88-114">For example, if you want toosee hello rules where hello attribute proxyAddresses is included, you would change hello drop-downs toohello following:</span></span>  
<span data-ttu-id="8db88-115">![SRE 篩選](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-115">![SRE filtering](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)</span></span>  
<span data-ttu-id="8db88-116">tooreset 篩選和載入全新的組態，請按**F5** hello 鍵盤上。</span><span class="sxs-lookup"><span data-stu-id="8db88-116">tooreset filtering and load a fresh configuration, press **F5** on hello keyboard.</span></span>

<span data-ttu-id="8db88-117">有按鈕 toohello 右上方，**加入新規則**。</span><span class="sxs-lookup"><span data-stu-id="8db88-117">toohello top right, you have a button **Add new rule**.</span></span> <span data-ttu-id="8db88-118">這個按鈕會使用的 toocreate 您自己自訂的規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-118">This button is used toocreate your own custom rule.</span></span>

<span data-ttu-id="8db88-119">Hello 底部中，您會有作用的按鈕上選取的同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-119">At hello bottom, you have buttons for acting on a selected sync rule.</span></span> <span data-ttu-id="8db88-120">[編輯] 和 [刪除] 會如您預期般執行。</span><span class="sxs-lookup"><span data-stu-id="8db88-120">**Edit** and **Delete** do what you expect them to.</span></span> <span data-ttu-id="8db88-121">**匯出**產生的 PowerShell 指令碼重新建立 hello 同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-121">**Export** produces a PowerShell script for recreating hello sync rule.</span></span> <span data-ttu-id="8db88-122">此程序可讓您 toomove 從一個伺服器 tooanother 的同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-122">This procedure allows you toomove a sync rule from one server tooanother.</span></span>

## <a name="create-your-first-custom-rule"></a><span data-ttu-id="8db88-123">建立您的第一個自訂規則</span><span class="sxs-lookup"><span data-stu-id="8db88-123">Create your first custom rule</span></span>
<span data-ttu-id="8db88-124">hello 最常見的變更是變更 toohello 屬性流程。</span><span class="sxs-lookup"><span data-stu-id="8db88-124">hello most common change is changes toohello attribute flows.</span></span> <span data-ttu-id="8db88-125">來源目錄中的 hello 資料可能無法如 Azure AD 所示。</span><span class="sxs-lookup"><span data-stu-id="8db88-125">hello data in your source directory might not be as in Azure AD.</span></span> <span data-ttu-id="8db88-126">在本節中的 hello 範例，您想確定 hello 指定名稱的使用者一律會處於 toomake**適當的大小寫**。</span><span class="sxs-lookup"><span data-stu-id="8db88-126">In hello example in this section, you want toomake sure hello given name of a user is always in **Proper case**.</span></span>

### <a name="disable-hello-scheduler"></a><span data-ttu-id="8db88-127">停用 hello 排程器</span><span class="sxs-lookup"><span data-stu-id="8db88-127">Disable hello scheduler</span></span>
<span data-ttu-id="8db88-128">hello[排程器](active-directory-aadconnectsync-feature-scheduler.md)預設會每隔 30 分鐘執行。</span><span class="sxs-lookup"><span data-stu-id="8db88-128">hello [scheduler](active-directory-aadconnectsync-feature-scheduler.md) runs every 30 minutes by default.</span></span> <span data-ttu-id="8db88-129">您想 toomake 確定無法啟動時要進行變更，以及疑難排解您的新規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-129">You want toomake sure it is not starting while you are making changes and troubleshoot your new rules.</span></span> <span data-ttu-id="8db88-130">tootemporarily 停用 hello 排程器，啟動 PowerShell 並執行`Set-ADSyncScheduler -SyncCycleEnabled $false`</span><span class="sxs-lookup"><span data-stu-id="8db88-130">tootemporarily disable hello scheduler, start PowerShell, and run `Set-ADSyncScheduler -SyncCycleEnabled $false`</span></span>

![停用 hello 排程器](./media/active-directory-aadconnectsync-change-the-configuration/schedulerdisable.png)  

### <a name="create-hello-rule"></a><span data-ttu-id="8db88-132">建立 hello 規則</span><span class="sxs-lookup"><span data-stu-id="8db88-132">Create hello rule</span></span>
1. <span data-ttu-id="8db88-133">按一下 [新增規則] 。</span><span class="sxs-lookup"><span data-stu-id="8db88-133">Click **Add new rule**.</span></span>
2. <span data-ttu-id="8db88-134">在 hello**描述**頁面上，輸入 hello 下列：</span><span class="sxs-lookup"><span data-stu-id="8db88-134">On hello **Description** page enter hello following:</span></span>  
   <span data-ttu-id="8db88-135">![輸入規則篩選](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-135">![Inbound rule filtering](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span></span>  
   * <span data-ttu-id="8db88-136">名稱： 授與 hello 規則的描述性名稱。</span><span class="sxs-lookup"><span data-stu-id="8db88-136">Name: Give hello rule a descriptive name.</span></span>
   * <span data-ttu-id="8db88-137">描述： 適用於某些釐清，讓其他人可以了解哪些 hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-137">Description: Some clarification so someone else can understand what hello rule is for.</span></span>
   * <span data-ttu-id="8db88-138">連線系統： 位於 hello 系統 hello 物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-138">Connected system: hello system hello object can be found in.</span></span> <span data-ttu-id="8db88-139">在此情況下，選取 hello Active Directory 連接器。</span><span class="sxs-lookup"><span data-stu-id="8db88-139">In this case, select hello Active Directory Connector.</span></span>
   * <span data-ttu-id="8db88-140">已連線的系統/Metaverse 物件類型︰分別選取 [使用者] 和 [人員]。</span><span class="sxs-lookup"><span data-stu-id="8db88-140">Connected System/Metaverse Object Type: Select **User** and **Person** respectively.</span></span>
   * <span data-ttu-id="8db88-141">連結類型： 變更此值太**聯結**。</span><span class="sxs-lookup"><span data-stu-id="8db88-141">Link Type: Change this value too**Join**.</span></span>
   * <span data-ttu-id="8db88-142">優先順序： 提供在 hello 系統中是唯一的值。</span><span class="sxs-lookup"><span data-stu-id="8db88-142">Precedence: Provide a value that is unique in hello system.</span></span> <span data-ttu-id="8db88-143">較低的數值表示優先順序較高。</span><span class="sxs-lookup"><span data-stu-id="8db88-143">A lower numeric value indicates higher precedence.</span></span>
   * <span data-ttu-id="8db88-144">標籤︰保留空白。</span><span class="sxs-lookup"><span data-stu-id="8db88-144">Tag: Leave empty.</span></span> <span data-ttu-id="8db88-145">只有 Microsoft 提供的現成可用規則應該在此方塊中填入值。</span><span class="sxs-lookup"><span data-stu-id="8db88-145">Only out-of-box rules from Microsoft should have this box populated with a value.</span></span>
3. <span data-ttu-id="8db88-146">在 hello**範圍篩選**頁面上，輸入**givenName ISNOTNULL**。</span><span class="sxs-lookup"><span data-stu-id="8db88-146">On hello **Scoping filter** page, enter **givenName ISNOTNULL**.</span></span>  
   <span data-ttu-id="8db88-147">![輸入規則範圍篩選器](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-147">![Inbound rule scoping filter](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span></span>  
   <span data-ttu-id="8db88-148">此區段是哪些物件 hello 規則應該套用至使用的 toodefine。</span><span class="sxs-lookup"><span data-stu-id="8db88-148">This section is used toodefine which objects hello rule should apply to.</span></span> <span data-ttu-id="8db88-149">如果空白，hello 規則將會套用 tooall 使用者物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-149">If left empty, hello rule would apply tooall user objects.</span></span> <span data-ttu-id="8db88-150">但會包括會議室、服務帳戶，以及其他非人員的使用者物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-150">But that would include conference rooms, service accounts, and other non-people user objects.</span></span>
4. <span data-ttu-id="8db88-151">在 hello**聯結規則**，保持空白。</span><span class="sxs-lookup"><span data-stu-id="8db88-151">On hello **Join rules**, leave it empty.</span></span>
5. <span data-ttu-id="8db88-152">在 hello**轉換**頁面上，也變更 hello FlowType**運算式**。</span><span class="sxs-lookup"><span data-stu-id="8db88-152">On hello **Transformations** page, change hello FlowType too**Expression**.</span></span> <span data-ttu-id="8db88-153">選取 hello 目標屬性**givenName**，在來源輸入`PCase([givenName])`。</span><span class="sxs-lookup"><span data-stu-id="8db88-153">Select hello Target Attribute **givenName**, and in Source enter `PCase([givenName])`.</span></span>
   <span data-ttu-id="8db88-154">![輸入規則轉換](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-154">![Inbound rule transformations](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span></span>  
   <span data-ttu-id="8db88-155">hello 同步處理引擎會同時在 hello 函式名稱與 hello hello 屬性名稱區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="8db88-155">hello sync engine is case-sensitive both on hello function name and hello name of hello attribute.</span></span> <span data-ttu-id="8db88-156">如果您輸入錯誤，當您將加入 hello 規則看到警告。</span><span class="sxs-lookup"><span data-stu-id="8db88-156">If you type something wrong, you see a warning when you add hello rule.</span></span> <span data-ttu-id="8db88-157">hello 編輯器可讓您 toosave，並繼續進行，因此，您必須 tooreopen hello 規則與正確的 hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-157">hello editor allows you toosave and continue, so you would have tooreopen hello rule and correct hello rule.</span></span>
6. <span data-ttu-id="8db88-158">按一下**新增**toosave hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-158">Click **Add** toosave hello rule.</span></span>

<span data-ttu-id="8db88-159">新的自訂規則應該顯示以 hello 其他同步 hello 系統中的規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-159">Your new custom rule should be visible with hello other sync rules in hello system.</span></span>

### <a name="verify-hello-change"></a><span data-ttu-id="8db88-160">確認 hello 變更</span><span class="sxs-lookup"><span data-stu-id="8db88-160">Verify hello change</span></span>
<span data-ttu-id="8db88-161">這個新的變更，您會想 toomake 確定它正常運作，而且不會擲回任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="8db88-161">With this new change, you want toomake sure it is working as expected and is not throwing any errors.</span></span> <span data-ttu-id="8db88-162">根據 hello 您擁有的物件數目，有兩個不同的方式 toodo 此步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-162">Depending on hello number of objects you have, there are two different ways toodo this step.</span></span>

1. <span data-ttu-id="8db88-163">在所有物件上執行完整同步處理</span><span class="sxs-lookup"><span data-stu-id="8db88-163">Run a full sync on all objects</span></span>
2. <span data-ttu-id="8db88-164">在單一物件上執行預覽和完整同步處理</span><span class="sxs-lookup"><span data-stu-id="8db88-164">Run a preview and full sync on a single object</span></span>

<span data-ttu-id="8db88-165">啟動**同步處理服務**從 hello [開始] 功能表。</span><span class="sxs-lookup"><span data-stu-id="8db88-165">Start **Synchronization Service** from hello start menu.</span></span> <span data-ttu-id="8db88-166">本節中的 hello 步驟都位於這項工具。</span><span class="sxs-lookup"><span data-stu-id="8db88-166">hello steps in this section are all in this tool.</span></span>

1. <span data-ttu-id="8db88-167">**所有物件的完整同步處理**</span><span class="sxs-lookup"><span data-stu-id="8db88-167">**Full sync on all objects**</span></span>  
   <span data-ttu-id="8db88-168">選取**連接器**hello 頂端。</span><span class="sxs-lookup"><span data-stu-id="8db88-168">Select **Connectors** at hello top.</span></span> <span data-ttu-id="8db88-169">識別 hello 連接器，您所做的變更 tooin hello 前一節，在此情況下 hello Active Directory 網域服務，並加以選取。</span><span class="sxs-lookup"><span data-stu-id="8db88-169">Identify hello Connector you made a change tooin hello previous section, in this case hello Active Directory Domain Services, and select it.</span></span> <span data-ttu-id="8db88-170">從 [動作] 中選取 [執行]，然後選取 [完整同步處理] 和 [確定]。</span><span class="sxs-lookup"><span data-stu-id="8db88-170">Select **Run** from Actions and select **Full Synchronization** and **OK**.</span></span>
   <span data-ttu-id="8db88-171">![完整同步處理](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-171">![Full sync](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span></span>  
   <span data-ttu-id="8db88-172">hello 物件現在會 hello metaverse 中更新。</span><span class="sxs-lookup"><span data-stu-id="8db88-172">hello objects are now updated in hello metaverse.</span></span> <span data-ttu-id="8db88-173">現在，您會想 toolook hello hello metaverse 中的物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-173">You now want toolook at hello object in hello metaverse.</span></span>
2. <span data-ttu-id="8db88-174">**單一物件的預覽和完整同步處理**</span><span class="sxs-lookup"><span data-stu-id="8db88-174">**Preview and full sync on a single object**</span></span>  
   <span data-ttu-id="8db88-175">選取**連接器**hello 頂端。</span><span class="sxs-lookup"><span data-stu-id="8db88-175">Select **Connectors** at hello top.</span></span> <span data-ttu-id="8db88-176">識別 hello 連接器，您所做的變更 tooin hello 前一節，在此情況下 hello Active Directory 網域服務，並加以選取。</span><span class="sxs-lookup"><span data-stu-id="8db88-176">Identify hello Connector you made a change tooin hello previous section, in this case hello Active Directory Domain Services, and select it.</span></span> <span data-ttu-id="8db88-177">選取 [搜尋連接器空間] 。</span><span class="sxs-lookup"><span data-stu-id="8db88-177">Select **Search Connector Space**.</span></span> <span data-ttu-id="8db88-178">使用範圍 toofind 想要 toouse tootest hello 變更的物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-178">Use scope toofind an object you want toouse tootest hello change.</span></span> <span data-ttu-id="8db88-179">選取 hello 物件，然後按一下 **預覽**。</span><span class="sxs-lookup"><span data-stu-id="8db88-179">Select hello object and click **Preview**.</span></span> <span data-ttu-id="8db88-180">在 hello 新畫面上，選取 **認可預覽**。</span><span class="sxs-lookup"><span data-stu-id="8db88-180">In hello new screen, select **Commit Preview**.</span></span>  
   <span data-ttu-id="8db88-181">![Commit preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-181">![Commit preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span></span>  
   <span data-ttu-id="8db88-182">hello 變更已認可的 toohello metaverse。</span><span class="sxs-lookup"><span data-stu-id="8db88-182">hello change is now committed toohello metaverse.</span></span>

<span data-ttu-id="8db88-183">**查看 hello metaverse 中的 hello 物件**</span><span class="sxs-lookup"><span data-stu-id="8db88-183">**Look at hello object in hello metaverse**</span></span>  
<span data-ttu-id="8db88-184">您現在想的 toopick 少數範例物件 toomake 確定 hello 預期值和套用該 hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-184">You now want toopick a few sample objects toomake sure hello value is expected and that hello rule applied.</span></span> <span data-ttu-id="8db88-185">選取**Metaverse 搜尋**從 hello。</span><span class="sxs-lookup"><span data-stu-id="8db88-185">Select **Metaverse Search** from hello top.</span></span> <span data-ttu-id="8db88-186">新增任何篩選，您必須 toofind hello 相關物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-186">Add any filter you need toofind hello relevant objects.</span></span> <span data-ttu-id="8db88-187">Hello 搜尋結果中，從開啟的物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-187">From hello search result, open an object.</span></span> <span data-ttu-id="8db88-188">查看 hello 屬性值，並也確認在 hello**同步處理規則**hello 如預期般套用規則的資料行。</span><span class="sxs-lookup"><span data-stu-id="8db88-188">Look at hello attribute values and also verify in hello **Sync Rules** column that hello rule applied as expected.</span></span>  
<span data-ttu-id="8db88-189">![Metaverse 搜尋](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-189">![Metaverse search](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span></span>  

### <a name="enable-hello-scheduler"></a><span data-ttu-id="8db88-190">啟用 hello 排程器</span><span class="sxs-lookup"><span data-stu-id="8db88-190">Enable hello scheduler</span></span>
<span data-ttu-id="8db88-191">如果一切如預期般，您可以再次啟用 hello 排程器。</span><span class="sxs-lookup"><span data-stu-id="8db88-191">If everything is as expected, you can enable hello scheduler again.</span></span> <span data-ttu-id="8db88-192">從 PowerShell，執行 `Set-ADSyncScheduler -SyncCycleEnabled $true`。</span><span class="sxs-lookup"><span data-stu-id="8db88-192">From PowerShell, run `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span></span>

## <a name="other-common-attribute-flow-changes"></a><span data-ttu-id="8db88-193">其他常見屬性流程變更</span><span class="sxs-lookup"><span data-stu-id="8db88-193">Other common attribute flow changes</span></span>
<span data-ttu-id="8db88-194">hello 上一節所述 toomake 如何變更 tooan 屬性流程。</span><span class="sxs-lookup"><span data-stu-id="8db88-194">hello previous section described how toomake changes tooan attribute flow.</span></span> <span data-ttu-id="8db88-195">本節提供了一些其他的範例。</span><span class="sxs-lookup"><span data-stu-id="8db88-195">In this section, some additional examples are provided.</span></span> <span data-ttu-id="8db88-196">hello 步驟縮寫 toocreate hello 同步處理規則的方式，但是您可以在 hello 上一節中找到 hello 完整步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-196">hello steps for how toocreate hello sync rule is abbreviated, but you can find hello full steps in hello previous section.</span></span>

### <a name="use-another-attribute-than-hello-default"></a><span data-ttu-id="8db88-197">使用其他比 hello 預設屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-197">Use another attribute than hello default</span></span>
<span data-ttu-id="8db88-198">Fabrikam，沒有其中 hello 本機字母用於名字、 姓氏和顯示名稱的樹系。</span><span class="sxs-lookup"><span data-stu-id="8db88-198">At Fabrikam, there is a forest where hello local alphabet is used for given name, surname, and display name.</span></span> <span data-ttu-id="8db88-199">hello 拉丁字元表示法，這些屬性可以找到 hello 延伸模組屬性中。</span><span class="sxs-lookup"><span data-stu-id="8db88-199">hello Latin character representation of these attributes can be found in hello extension attributes.</span></span> <span data-ttu-id="8db88-200">在 Azure AD 中建立 hello 全域通訊清單時，Office 365 hello 的組織想要改為使用這些屬性 toobe。</span><span class="sxs-lookup"><span data-stu-id="8db88-200">When building hello global address list in Azure AD and Office 365, hello organization wants these attributes toobe used instead.</span></span>

<span data-ttu-id="8db88-201">使用預設設定時，將物件從本機樹系 hello 看起來像這樣：</span><span class="sxs-lookup"><span data-stu-id="8db88-201">With a default configuration, an object from hello local forest looks like this:</span></span>  
![屬性流程 1](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp1.png)

<span data-ttu-id="8db88-203">toocreate 其他屬性，流量的規則 hello 遵循：</span><span class="sxs-lookup"><span data-stu-id="8db88-203">toocreate a rule with other attribute flows, do hello following:</span></span>

* <span data-ttu-id="8db88-204">啟動**同步處理規則編輯器**從 hello [開始] 功能表。</span><span class="sxs-lookup"><span data-stu-id="8db88-204">Start **Synchronization Rule Editor** from hello start menu.</span></span>
* <span data-ttu-id="8db88-205">與**輸入**仍然選取的 toohello hello 按鈕上按一下滑鼠左鍵，**加入新規則**。</span><span class="sxs-lookup"><span data-stu-id="8db88-205">With **Inbound** still selected toohello left, click hello button **Add new rule**.</span></span>
* <span data-ttu-id="8db88-206">為 hello 規則提供名稱和描述。</span><span class="sxs-lookup"><span data-stu-id="8db88-206">Give hello rule a name and description.</span></span> <span data-ttu-id="8db88-207">選取 hello 在內部部署 Active Directory 和 hello 相關的物件類型。</span><span class="sxs-lookup"><span data-stu-id="8db88-207">Select hello on-premises Active Directory and hello relevant object types.</span></span> <span data-ttu-id="8db88-208">在 [連結類型] 中，選取 [聯結]。</span><span class="sxs-lookup"><span data-stu-id="8db88-208">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="8db88-209">為優先順序挑選一個其他規則還沒使用的數字。</span><span class="sxs-lookup"><span data-stu-id="8db88-209">For precedence, pick a number that is not used by another rule.</span></span> <span data-ttu-id="8db88-210">hello 鶈蜪規則的開頭 100，因此在此範例中，就可以使用 hello 值 50。</span><span class="sxs-lookup"><span data-stu-id="8db88-210">hello out-of-box rules start with 100, so hello value 50 can be used in this example.</span></span>
  <span data-ttu-id="8db88-211">![屬性流程 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-211">![Attribute flow 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span></span>
* <span data-ttu-id="8db88-212">將領域保留空白 （也就是應該套用 tooall hello 樹系中的使用者物件）。</span><span class="sxs-lookup"><span data-stu-id="8db88-212">Leave scope empty (that is, should apply tooall user objects in hello forest).</span></span>
* <span data-ttu-id="8db88-213">保留 聯結規則空白 （也就，可讓任何聯結 hello 鶈蜪規則控制代碼）。</span><span class="sxs-lookup"><span data-stu-id="8db88-213">Leave join rules empty (that is, let hello out-of-box rule handle any joins).</span></span>
* <span data-ttu-id="8db88-214">在轉換、 建立 hello 下列流程：</span><span class="sxs-lookup"><span data-stu-id="8db88-214">In Transformations, create hello following flows:</span></span>  
  ![屬性流程 3](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp3.png)
* <span data-ttu-id="8db88-216">按一下**新增**toosave hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-216">Click **Add** toosave hello rule.</span></span>
* <span data-ttu-id="8db88-217">跳過**同步處理服務管理員**。</span><span class="sxs-lookup"><span data-stu-id="8db88-217">Go too**Synchronization Service Manager**.</span></span> <span data-ttu-id="8db88-218">在**連接器**，選取 hello 的連接器我們加入 hello 規則的位置。</span><span class="sxs-lookup"><span data-stu-id="8db88-218">On **Connectors**, select hello Connector where we added hello rule.</span></span> <span data-ttu-id="8db88-219">依序選取 [執行] 和 [完整同步處理]。</span><span class="sxs-lookup"><span data-stu-id="8db88-219">Select **Run**, and **Full Synchronization**.</span></span> <span data-ttu-id="8db88-220">完整同步處理重新計算使用 hello 目前規則的所有物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-220">A Full Synchronization recalculates all objects using hello current rules.</span></span>

<span data-ttu-id="8db88-221">以下是相同的物件與此自訂規則的 hello 的 hello 結果：</span><span class="sxs-lookup"><span data-stu-id="8db88-221">This is hello result for hello same object with this custom rule:</span></span>  
![屬性流程 4](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp4.png)

### <a name="length-of-attributes"></a><span data-ttu-id="8db88-223">屬性的長度</span><span class="sxs-lookup"><span data-stu-id="8db88-223">Length of attributes</span></span>
<span data-ttu-id="8db88-224">字串屬性可索引的預設集 toobe 並使用 hello 最大長度為 448 個字元。</span><span class="sxs-lookup"><span data-stu-id="8db88-224">String attributes are by default set toobe indexable and hello maximum length is 448 characters.</span></span> <span data-ttu-id="8db88-225">如果您正在使用可能包含多個字串屬性，然後在 hello 屬性流程中進行確定 tooinclude hello 下列：</span><span class="sxs-lookup"><span data-stu-id="8db88-225">If you are working with string attributes that might contain more, then make sure tooinclude hello following in hello attribute flow:</span></span>  
`attributeName` <- `Left([attributeName],448)`

### <a name="changing-hello-userprincipalsuffix"></a><span data-ttu-id="8db88-226">變更 hello userPrincipalSuffix</span><span class="sxs-lookup"><span data-stu-id="8db88-226">Changing hello userPrincipalSuffix</span></span>
<span data-ttu-id="8db88-227">Active Directory 中的 hello userPrincipalName 屬性永遠不知道 hello 使用者，且可能不適合 hello 登入識別碼。</span><span class="sxs-lookup"><span data-stu-id="8db88-227">hello userPrincipalName attribute in Active Directory is not always known by hello users and might not be suitable as hello sign-in ID.</span></span> <span data-ttu-id="8db88-228">hello Azure AD Connect 同步作業安裝精靈允許挑選不同的屬性，例如郵件。</span><span class="sxs-lookup"><span data-stu-id="8db88-228">hello Azure AD Connect sync installation wizard allows picking a different attribute, for example mail.</span></span> <span data-ttu-id="8db88-229">但在某些情況下 hello 必須計算屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-229">But in some cases hello attribute must be calculated.</span></span> <span data-ttu-id="8db88-230">例如，Contoso 的 hello 公司有兩個 Azure AD 目錄，一個用於生產環境，另一個用於測試。</span><span class="sxs-lookup"><span data-stu-id="8db88-230">For example, hello company Contoso has two Azure AD directories, one for production and one for testing.</span></span> <span data-ttu-id="8db88-231">他們想 hello 使用者在其測試租用戶 toouse 另一個後的置詞 hello 登入識別碼。</span><span class="sxs-lookup"><span data-stu-id="8db88-231">They want hello users in their test tenant toouse another suffix in hello sign-in ID.</span></span>  
`userPrincipalName` <- `Word([userPrincipalName],1,"@") & "@contosotest.com"`

<span data-ttu-id="8db88-232">在此運算式中，接受所有項目第一次方的 hello @-sign (Word) 和具有固定的字串串連。</span><span class="sxs-lookup"><span data-stu-id="8db88-232">In this expression, take everything left of hello first @-sign (Word) and concatenate with a fixed string.</span></span>

### <a name="convert-a-multi-value-tooa-single-value"></a><span data-ttu-id="8db88-233">將多重值 tooa 單一值的轉換</span><span class="sxs-lookup"><span data-stu-id="8db88-233">Convert a multi-value tooa single-value</span></span>
<span data-ttu-id="8db88-234">雖然看起來單一 Active Directory 使用者和電腦中的值，Active Directory 中的某些屬性是多重值 hello 結構描述中。</span><span class="sxs-lookup"><span data-stu-id="8db88-234">Some attributes in Active Directory are multi-valued in hello schema even though they look single valued in Active Directory Users and Computers.</span></span> <span data-ttu-id="8db88-235">例如，hello 描述屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-235">An example is hello description attribute.</span></span>  
`description` <- `IIF(IsNullOrEmpty([description]),NULL,Left(Trim(Item([description],1)),448))`

<span data-ttu-id="8db88-236">在此運算式以防 hello 屬性有值，需要 hello 屬性中的 hello 第一個項目 (Item) 移除開頭和尾端空白 (Trim)，然後再保留 hello 前 448 個字元 （左） hello 字串中。</span><span class="sxs-lookup"><span data-stu-id="8db88-236">In this expression in case hello attribute has a value, take hello first item (Item) in hello attribute, remove leading and trailing spaces (Trim), and then keep hello first 448 characters (Left) in hello string.</span></span>

### <a name="do-not-flow-an-attribute"></a><span data-ttu-id="8db88-237">請勿傳送屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-237">Do not flow an attribute</span></span>
<span data-ttu-id="8db88-238">如需有關本章節的 hello 案例的背景，請參閱[控制 hello 屬性流程程序](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process)。</span><span class="sxs-lookup"><span data-stu-id="8db88-238">For background on hello scenario for this section, see [Control hello attribute flow process](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).</span></span>

<span data-ttu-id="8db88-239">有兩種 toonot 流程屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-239">There are two ways toonot flow an attribute.</span></span> <span data-ttu-id="8db88-240">hello 第一次是 hello 安裝精靈 中，並可讓您太[移除選取的屬性](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering)。</span><span class="sxs-lookup"><span data-stu-id="8db88-240">hello first is available in hello installation wizard and allows you too[remove selected attributes](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering).</span></span> <span data-ttu-id="8db88-241">此選項適用於您永遠不會同步處理之前的 hello 屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-241">This option works if you have never synchronized hello attribute before.</span></span> <span data-ttu-id="8db88-242">不過，如果您已經啟動 toosynchronize 這個屬性，稍後又將它移除這項功能，然後 hello 同步處理引擎會停止管理 hello 屬性，而且 hello 現有的值也會保留在 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="8db88-242">However, if you have started toosynchronize this attribute and later remove it with this feature, then hello sync engine stops managing hello attribute and hello existing values are left in Azure AD.</span></span>

<span data-ttu-id="8db88-243">如果您想 tooremove hello 屬性值，請確定它不會在未來的 hello 流動時，您需要改為建立自訂規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-243">If you want tooremove hello value of an attribute and make sure it does not flow in hello future, you need create a custom rule instead.</span></span>

<span data-ttu-id="8db88-244">Fabrikam，我們知道的某些屬性我們同步 toohello 雲端的 hello 不應該有。</span><span class="sxs-lookup"><span data-stu-id="8db88-244">At Fabrikam, we have realized that some of hello attributes we synchronize toohello cloud should not be there.</span></span> <span data-ttu-id="8db88-245">我們想要 toomake 確定這些屬性會從 Azure AD 中移除。</span><span class="sxs-lookup"><span data-stu-id="8db88-245">We want toomake sure these attributes are removed from Azure AD.</span></span>  
![不正確的擴充屬性](./media/active-directory-aadconnectsync-change-the-configuration/badextensionattribute.png)

* <span data-ttu-id="8db88-247">建立新的輸入同步處理規則，並填入 hello 描述![描述](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-247">Create a new inbound Synchronization Rule and populate hello description ![Descriptions](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span></span>
* <span data-ttu-id="8db88-248">建立類型的屬性流程**運算式**與 hello 來源**AuthoritativeNull**。</span><span class="sxs-lookup"><span data-stu-id="8db88-248">Create attribute flows of type **Expression** and with hello source **AuthoritativeNull**.</span></span> <span data-ttu-id="8db88-249">常值的 hello **AuthoritativeNull**指出 hello 值應空白 hello MV 中，即使較低的優先順序同步處理規則會嘗試 toopopulate hello 值。</span><span class="sxs-lookup"><span data-stu-id="8db88-249">hello literal **AuthoritativeNull** indicates that hello value should be empty in hello MV even if a lower precedence sync rule tries toopopulate hello value.</span></span>
  <span data-ttu-id="8db88-250">![擴充屬性的轉換](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-250">![Transformation for Extension Attributes](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span></span>
* <span data-ttu-id="8db88-251">儲存 hello 的同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-251">Save hello Sync Rule.</span></span> <span data-ttu-id="8db88-252">啟動**同步處理服務**、 尋找 hello 連接器，請選擇**執行**，和**完整同步處理**。</span><span class="sxs-lookup"><span data-stu-id="8db88-252">Start **Synchronization Service**, find hello Connector, select **Run**, and **Full Synchronization**.</span></span> <span data-ttu-id="8db88-253">此步驟會重新計算所有屬性流程。</span><span class="sxs-lookup"><span data-stu-id="8db88-253">This step recalculates all attribute flows.</span></span>
* <span data-ttu-id="8db88-254">請確認該 hello 適合變更即將 toobe 匯出搜尋 hello 連接器空間。</span><span class="sxs-lookup"><span data-stu-id="8db88-254">Verify that hello intended changes are about toobe exported by searching hello connector space.</span></span>
  <span data-ttu-id="8db88-255">![分段刪除](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-255">![Staged delete](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span></span>

## <a name="create-rules-with-powershell"></a><span data-ttu-id="8db88-256">使用 PowerShell 建立規則</span><span class="sxs-lookup"><span data-stu-id="8db88-256">Create rules with PowerShell</span></span>
<span data-ttu-id="8db88-257">使用 hello 同步處理規則編輯器會正常運作時，您只需要少數變更 toomake。</span><span class="sxs-lookup"><span data-stu-id="8db88-257">Using hello sync rule editor works fine when you only have a few changes toomake.</span></span> <span data-ttu-id="8db88-258">如果您需要 toomake 許多變更，則 PowerShell 可能會更好的選項。</span><span class="sxs-lookup"><span data-stu-id="8db88-258">If you need toomake many changes, then PowerShell might be a better option.</span></span> <span data-ttu-id="8db88-259">某些進階功能只有 PowerShell 才提供。</span><span class="sxs-lookup"><span data-stu-id="8db88-259">Some advanced features are only available with PowerShell.</span></span>

### <a name="get-hello-powershell-script-for-an-out-of-box-rule"></a><span data-ttu-id="8db88-260">取得 hello PowerShell 指令碼的預設規則</span><span class="sxs-lookup"><span data-stu-id="8db88-260">Get hello PowerShell script for an out-of-box rule</span></span>
<span data-ttu-id="8db88-261">toosee hello hello 同步處理中建立的預設規則、 選取 hello 規則的 PowerShell 指令碼規則編輯器，然後按一下**匯出**。</span><span class="sxs-lookup"><span data-stu-id="8db88-261">toosee hello PowerShell script that created an out-of-box rule, select hello rule in hello sync rules editor and click **Export**.</span></span> <span data-ttu-id="8db88-262">這個動作可讓您 hello PowerShell 指令碼該建立的 hello 規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-262">This action gives you hello PowerShell script that created hello rule.</span></span>

### <a name="advanced-precedence"></a><span data-ttu-id="8db88-263">進階優先順序</span><span class="sxs-lookup"><span data-stu-id="8db88-263">Advanced precedence</span></span>
<span data-ttu-id="8db88-264">hello 現成的同步處理規則的優先順序值為 100 開頭。</span><span class="sxs-lookup"><span data-stu-id="8db88-264">hello out-of-box sync rules start with a precedence value of 100.</span></span> <span data-ttu-id="8db88-265">如果您有多個樹系，而且需要 toomake 許多自訂變更，然後 99 的同步處理規則可能不太夠。</span><span class="sxs-lookup"><span data-stu-id="8db88-265">If you have many forests and you need toomake many custom changes, then 99 sync rules might not be enough.</span></span>

<span data-ttu-id="8db88-266">您可以指示 hello hello 鶈蜪規則之前插入的其他規則的同步處理引擎。</span><span class="sxs-lookup"><span data-stu-id="8db88-266">You can instruct hello Sync Engine that you want additional rules inserted before hello out-of-box rules.</span></span> <span data-ttu-id="8db88-267">tooget 這種行為，請遵循下列步驟：</span><span class="sxs-lookup"><span data-stu-id="8db88-267">tooget this behavior, follow these steps:</span></span>

1. <span data-ttu-id="8db88-268">標記 hello 第一個現成的同步處理規則 (此規則為 hello**中從 AD 使用者將聯結**) 在 hello 同步處理規則編輯器，再選取**匯出**。</span><span class="sxs-lookup"><span data-stu-id="8db88-268">Mark hello first out-of-box sync rule (this rule is hello **In from AD-User Join**) in hello sync rule editor and select **Export**.</span></span> <span data-ttu-id="8db88-269">複製 hello SR 識別碼值。</span><span class="sxs-lookup"><span data-stu-id="8db88-269">Copy hello SR Identifier value.</span></span>  
<span data-ttu-id="8db88-270">![變更前的 PowerShell](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-270">![PowerShell before change](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span></span>  
2. <span data-ttu-id="8db88-271">建立 hello 新同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-271">Create hello new sync rule.</span></span> <span data-ttu-id="8db88-272">您可以使用 hello 同步處理規則編輯器 toocreate 它。</span><span class="sxs-lookup"><span data-stu-id="8db88-272">You can use hello sync rule editor toocreate it.</span></span> <span data-ttu-id="8db88-273">匯出 hello 規則 tooa PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="8db88-273">Export hello rule tooa PowerShell script.</span></span>
3. <span data-ttu-id="8db88-274">在 hello 屬性**PrecedenceBefore**，插入 hello 鶈蜪規則 hello 識別碼值。</span><span class="sxs-lookup"><span data-stu-id="8db88-274">In hello property **PrecedenceBefore**, insert hello identifier value from hello out-of-box rule.</span></span> <span data-ttu-id="8db88-275">設定 hello**優先順序**太**0**。</span><span class="sxs-lookup"><span data-stu-id="8db88-275">Set hello **Precedence** too**0**.</span></span> <span data-ttu-id="8db88-276">請確定 hello 識別碼屬性都是唯一而且不會重複使用另一項規則中的 GUID。</span><span class="sxs-lookup"><span data-stu-id="8db88-276">Make sure hello Identifier attribute is unique and you are not reusing a GUID from another rule.</span></span> <span data-ttu-id="8db88-277">同時確定該 hello **ImmutableTag**屬性未設定; 這個屬性只應設定的預設規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-277">Also make sure that hello **ImmutableTag** property is not set; this property should only be set for an out-of-box rule.</span></span> <span data-ttu-id="8db88-278">儲存 hello PowerShell 指令碼並執行它。</span><span class="sxs-lookup"><span data-stu-id="8db88-278">Save hello PowerShell script and run it.</span></span> <span data-ttu-id="8db88-279">100 hello 優先順序值指派給您的自訂規則，而所有其他預設的規則就會遞增 hello 結果。</span><span class="sxs-lookup"><span data-stu-id="8db88-279">hello result is that your custom rule is assigned hello precedence value of 100 and all other out-of-box rules are incremented.</span></span>  
<span data-ttu-id="8db88-280">![變更後的 PowerShell](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)</span><span class="sxs-lookup"><span data-stu-id="8db88-280">![PowerShell after change](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)</span></span>  

<span data-ttu-id="8db88-281">您可以有許多自訂同步處理規則使用相同的 hello **PrecedenceBefore**時所需的值。</span><span class="sxs-lookup"><span data-stu-id="8db88-281">You can have many custom sync rules using hello same **PrecedenceBefore** value when needed.</span></span>


## <a name="enable-synchronization-of-preferreddatalocation"></a><span data-ttu-id="8db88-282">啟用 PreferredDataLocation 的同步處理</span><span class="sxs-lookup"><span data-stu-id="8db88-282">Enable synchronization of PreferredDataLocation</span></span>
<span data-ttu-id="8db88-283">Azure AD Connect 可支援同步處理的 hello **PreferredDataLocation**屬性**使用者**1.1.524.0 版本和之後的物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-283">Azure AD Connect supports synchronization of hello **PreferredDataLocation** attribute for **User** objects in version 1.1.524.0 and after.</span></span> <span data-ttu-id="8db88-284">更具體地說，我們已導入下列變更︰</span><span class="sxs-lookup"><span data-stu-id="8db88-284">More specifically, following changes have been introduced:</span></span>

* <span data-ttu-id="8db88-285">hello hello 物件類型的結構描述**使用者**hello 在 Azure AD Connector 延伸 tooinclude PreferredDataLocation 屬性，這是字串類型的單一值。</span><span class="sxs-lookup"><span data-stu-id="8db88-285">hello schema of hello object type **User** in hello Azure AD Connector is extended tooinclude PreferredDataLocation attribute, which is of type string and is single-valued.</span></span>

* <span data-ttu-id="8db88-286">hello hello 物件類型的結構描述**人員**在 hello Metaverse 延伸 tooinclude PreferredDataLocation 屬性，這是字串類型的單一值。</span><span class="sxs-lookup"><span data-stu-id="8db88-286">hello schema of hello object type **Person** in hello Metaverse is extended tooinclude PreferredDataLocation attribute, which is of type string and is single-valued.</span></span>

<span data-ttu-id="8db88-287">根據預設，hello PreferredDataLocation 屬性不是啟用同步處理，因為在內部部署 Active Directory 中沒有對應的 PreferredDataLocation 屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-287">By default, hello PreferredDataLocation attribute is not enabled for synchronization because there is no corresponding PreferredDataLocation attribute in on-premises Active Directory.</span></span> <span data-ttu-id="8db88-288">您必須手動啟用同步處理。</span><span class="sxs-lookup"><span data-stu-id="8db88-288">You must manually enable synchronization.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8db88-289">目前，Azure AD 可讓已同步處理使用者物件和雲端使用者物件 toobe 直接使用 Azure AD PowerShell 來設定上的 hello PreferredDataLocation 屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-289">Currently, Azure AD allows hello PreferredDataLocation attribute on both synchronized User objects and cloud User objects toobe directly configured using Azure AD PowerShell.</span></span> <span data-ttu-id="8db88-290">一旦您啟用了 hello PreferredDataLocation 屬性的同步處理，您必須停止使用 Azure AD PowerShell tooconfigure hello 屬性上**同步處理使用者物件**為 Azure AD Connect 會覆寫根據在內部部署 Active Directory 中的 hello 來源屬性值。</span><span class="sxs-lookup"><span data-stu-id="8db88-290">Once you have enabled synchronization of hello PreferredDataLocation attribute, you must stop using Azure AD PowerShell tooconfigure hello attribute on **synchronized User objects** as Azure AD Connect will override them based on hello source attribute values in on-premises Active Directory.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8db88-291">在 1 2017 年 9 月，Azure AD 就不再允許 hello PreferredDataLocation 屬性上**同步處理使用者物件**toobe 直接使用 Azure AD PowerShell 來設定。</span><span class="sxs-lookup"><span data-stu-id="8db88-291">On September 1 2017, Azure AD will no longer allow hello PreferredDataLocation attribute on **synchronized User objects** toobe directly configured using Azure AD PowerShell.</span></span> <span data-ttu-id="8db88-292">tooconfigure PreferredLocation 屬性上的同步處理使用者物件，您必須使用 Azure AD Connect 只。</span><span class="sxs-lookup"><span data-stu-id="8db88-292">tooconfigure PreferredLocation attribute on synchronized User objects, you must use Azure AD Connect only.</span></span>

<span data-ttu-id="8db88-293">在啟用之前 hello PreferredDataLocation 屬性的同步處理，您必須：</span><span class="sxs-lookup"><span data-stu-id="8db88-293">Before enabling synchronization of hello PreferredDataLocation attribute, you must:</span></span>

 * <span data-ttu-id="8db88-294">首先，決定用來當做 hello 來源屬性的內部部署 Active Directory 屬性 toobe。</span><span class="sxs-lookup"><span data-stu-id="8db88-294">First, decide which on-premises Active Directory attribute toobe used as hello source attribute.</span></span> <span data-ttu-id="8db88-295">此屬性的類型必須是**字串**，且具備**單一值**。</span><span class="sxs-lookup"><span data-stu-id="8db88-295">It should be of type **string** and is **single-valued**.</span></span>

 * <span data-ttu-id="8db88-296">如果您先前已設定 hello PreferredDataLocation 屬性上現有的同步處理，使用 Azure AD PowerShell 的 Azure AD 使用者物件，您必須**backport** hello 屬性值 toohello 對應使用者物件在內部部署 Active Directory。</span><span class="sxs-lookup"><span data-stu-id="8db88-296">If you have previously configured hello PreferredDataLocation attribute on existing synchronized User objects in Azure AD using Azure AD PowerShell, you must **backport** hello attribute values toohello corresponding User objects in on-premises Active Directory.</span></span>
 
    > [!IMPORTANT]
    > <span data-ttu-id="8db88-297">如果您不要使用 backport hello 屬性值 toohello 對應使用者物件在內部部署 Active Directory 中的，Azure AD Connect 的 hello PreferredDataLocation 屬性同步處理時的 Azure AD 中將會移除 hello 現有屬性值啟用。</span><span class="sxs-lookup"><span data-stu-id="8db88-297">If you do not backport hello attribute values toohello corresponding User objects in on-premises Active Directory, Azure AD Connect will remove hello existing attribute values in Azure AD when synchronization for hello PreferredDataLocation attribute is enabled.</span></span>

 * <span data-ttu-id="8db88-298">建議您設定 hello 來源屬性上至少有幾個內部部署 AD 使用者物件，它可以用來驗證稍後。</span><span class="sxs-lookup"><span data-stu-id="8db88-298">It is recommended you configure hello source attribute on at least a couple of on-premises AD User objects now, which can be used for verification later.</span></span>
 
<span data-ttu-id="8db88-299">hello hello PreferredDataLocation 屬性的步驟 tooenable 同步處理可以摘要如下：</span><span class="sxs-lookup"><span data-stu-id="8db88-299">hello steps tooenable synchronization of hello PreferredDataLocation attribute can be summarized as:</span></span>

1. <span data-ttu-id="8db88-300">停用同步排程器，並確認沒有任何同步處理在進行中</span><span class="sxs-lookup"><span data-stu-id="8db88-300">Disable sync scheduler and verify there is no synchronization in progress</span></span>

2. <span data-ttu-id="8db88-301">新增 hello 來源屬性 toohello 內部部署 AD 連接器結構描述</span><span class="sxs-lookup"><span data-stu-id="8db88-301">Add hello source attribute toohello on-premises AD Connector schema</span></span>

3. <span data-ttu-id="8db88-302">新增 PreferredDataLocation toohello Azure AD Connector 結構描述</span><span class="sxs-lookup"><span data-stu-id="8db88-302">Add PreferredDataLocation toohello Azure AD Connector schema</span></span>

4. <span data-ttu-id="8db88-303">從內部部署 Active Directory 中建立輸入同步處理規則 tooflow hello 屬性值</span><span class="sxs-lookup"><span data-stu-id="8db88-303">Create an inbound synchronization rule tooflow hello attribute value from on-premises Active Directory</span></span>

5. <span data-ttu-id="8db88-304">建立輸出同步處理規則 tooflow hello 屬性值 tooAzure AD</span><span class="sxs-lookup"><span data-stu-id="8db88-304">Create an outbound synchronization rule tooflow hello attribute value tooAzure AD</span></span>

6. <span data-ttu-id="8db88-305">執行完整的同步處理週期</span><span class="sxs-lookup"><span data-stu-id="8db88-305">Run Full Synchronization cycle</span></span>

7. <span data-ttu-id="8db88-306">啟用同步排程器</span><span class="sxs-lookup"><span data-stu-id="8db88-306">Enable sync scheduler</span></span>

> [!NOTE]
> <span data-ttu-id="8db88-307">hello 本節其餘部分涵蓋這些詳細資料中的步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-307">hello rest of this section covers these steps in details.</span></span> <span data-ttu-id="8db88-308">Azure AD 部署單一樹系拓撲時或無自訂同步處理規則的 hello 內容將描述這些。</span><span class="sxs-lookup"><span data-stu-id="8db88-308">They are described in hello context of an Azure AD deployment with single-forest topology and without custom synchronization rules.</span></span> <span data-ttu-id="8db88-309">如果您有多樹系拓撲時，自訂同步處理規則設定，或已在臨時伺服器，您需要據此 tooadjust hello 步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-309">If you have multi-forest topology, custom synchronization rules configured or have a staging server, you need tooadjust hello steps accordingly.</span></span>

### <a name="step-1-disable-sync-scheduler-and-verify-there-is-no-synchronization-in-progress"></a><span data-ttu-id="8db88-310">步驟 1：停用同步排程器，並確認沒有任何同步處理在進行中</span><span class="sxs-lookup"><span data-stu-id="8db88-310">Step 1: Disable sync scheduler and verify there is no synchronization in progress</span></span>
<span data-ttu-id="8db88-311">請確定沒有同步處理的更新同步處理的 hello 中間時，會發生非預期的規則 tooavoid 變更正在執行匯出 tooAzure AD。</span><span class="sxs-lookup"><span data-stu-id="8db88-311">Ensure no synchronization takes place while you are in hello middle of updating synchronization rules tooavoid unintended changes being exported tooAzure AD.</span></span> <span data-ttu-id="8db88-312">toodisable hello 內建的同步處理排程器：</span><span class="sxs-lookup"><span data-stu-id="8db88-312">toodisable hello built-in sync scheduler:</span></span>

 1. <span data-ttu-id="8db88-313">Hello Azure AD Connect 的伺服器上啟動 PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="8db88-313">Start PowerShell session on hello Azure AD Connect server.</span></span>

 2. <span data-ttu-id="8db88-314">執行 Cmdlet 以停用排定的同步處理︰`Set-ADSyncScheduler -SyncCycleEnabled $false`</span><span class="sxs-lookup"><span data-stu-id="8db88-314">Disable scheduled synchronization by running cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $false`</span></span>
 
 3. <span data-ttu-id="8db88-315">啟動 hello**同步處理服務管理員**移 tooSTART → 所同步處理服務。</span><span class="sxs-lookup"><span data-stu-id="8db88-315">Start hello **Synchronization Service Manager** by going tooSTART → Synchronization Service.</span></span>
 
 4. <span data-ttu-id="8db88-316">移 toohello**作業**索引標籤上，並確認其狀態是沒有作業*「 進行中 」。*</span><span class="sxs-lookup"><span data-stu-id="8db88-316">Go toohello **Operations** tab and confirm there is no operation whose status is *“in progress.”*</span></span>

![同步處理服務管理員 - 確認沒有進行中的作業](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step1.png)

### <a name="step-2-add-hello-source-attribute-toohello-on-premises-ad-connector-schema"></a><span data-ttu-id="8db88-318">步驟 2： 新增 hello 來源屬性 toohello 內部部署 AD 連接器結構描述</span><span class="sxs-lookup"><span data-stu-id="8db88-318">Step 2: Add hello source attribute toohello on-premises AD Connector schema</span></span>
<span data-ttu-id="8db88-319">並非所有的 AD 屬性會匯入至 hello 內部部署 AD 連接器空間。</span><span class="sxs-lookup"><span data-stu-id="8db88-319">Not all AD attributes are imported into hello on-premises AD Connector Space.</span></span> <span data-ttu-id="8db88-320">tooadd hello 來源 toohello 的屬性清單 hello 匯入的屬性：</span><span class="sxs-lookup"><span data-stu-id="8db88-320">tooadd hello source attribute toohello list of hello imported attributes:</span></span>

 1. <span data-ttu-id="8db88-321">移 toohello**連接器**hello 同步處理服務管理員中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8db88-321">Go toohello **Connectors** tab in hello Synchronization Service Manager.</span></span>
 
 2. <span data-ttu-id="8db88-322">以滑鼠右鍵按一下 hello**在內部部署 AD 連接器**選取**屬性**。</span><span class="sxs-lookup"><span data-stu-id="8db88-322">Right-click on hello **on-premises AD Connector** and select **Properties**.</span></span>
 
 3. <span data-ttu-id="8db88-323">在 [hello 快顯對話方塊中，移 toohello**選取屬性**] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8db88-323">In hello pop-up dialog, go toohello **Select Attributes** tab.</span></span>
 
 4. <span data-ttu-id="8db88-324">請確定 hello 屬性清單中，核取 hello 來源屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-324">Make sure hello source attribute is checked in hello attribute list.</span></span>
 
 5. <span data-ttu-id="8db88-325">按一下**確定**toosave。</span><span class="sxs-lookup"><span data-stu-id="8db88-325">Click **OK** toosave.</span></span>

![新增來源屬性 tooon 內部部署 AD 連接器結構描述](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step2.png)

### <a name="step-3-add-preferreddatalocation-toohello-azure-ad-connector-schema"></a><span data-ttu-id="8db88-327">步驟 3： 加入 PreferredDataLocation toohello Azure AD Connector 結構描述</span><span class="sxs-lookup"><span data-stu-id="8db88-327">Step 3: Add PreferredDataLocation toohello Azure AD Connector schema</span></span>
<span data-ttu-id="8db88-328">根據預設，hello PreferredDataLocation 屬性不會匯入 hello Azure AD Connect 的空間。</span><span class="sxs-lookup"><span data-stu-id="8db88-328">By default, hello PreferredDataLocation attribute is not imported into hello Azure AD Connect Space.</span></span> <span data-ttu-id="8db88-329">tooadd hello PreferredDataLocation 屬性 toohello 清單匯入的屬性：</span><span class="sxs-lookup"><span data-stu-id="8db88-329">tooadd hello PreferredDataLocation attribute toohello list of imported attributes:</span></span>

 1. <span data-ttu-id="8db88-330">移 toohello**連接器**hello 同步處理服務管理員中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8db88-330">Go toohello **Connectors** tab in hello Synchronization Service Manager.</span></span>

 2. <span data-ttu-id="8db88-331">以滑鼠右鍵按一下 hello **Azure AD Connector**選取**屬性**。</span><span class="sxs-lookup"><span data-stu-id="8db88-331">Right-click on hello **Azure AD Connector** and select **Properties**.</span></span>

 3. <span data-ttu-id="8db88-332">在 [hello 快顯對話方塊中，移 toohello**選取屬性**] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8db88-332">In hello pop-up dialog, go toohello **Select Attributes** tab.</span></span>

 4. <span data-ttu-id="8db88-333">請確定 hello PreferredDataLocation 屬性已簽入 hello 屬性清單。</span><span class="sxs-lookup"><span data-stu-id="8db88-333">Make sure hello PreferredDataLocation attribute is checked in hello attribute list.</span></span>

 5. <span data-ttu-id="8db88-334">按一下**確定**toosave。</span><span class="sxs-lookup"><span data-stu-id="8db88-334">Click **OK** toosave.</span></span>

![新增來源屬性 tooAzure AD 連接器結構描述](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step3.png)

### <a name="step-4-create-an-inbound-synchronization-rule-tooflow-hello-attribute-value-from-on-premises-active-directory"></a><span data-ttu-id="8db88-336">步驟 4： 從內部部署 Active Directory 中建立輸入同步處理規則 tooflow hello 屬性值</span><span class="sxs-lookup"><span data-stu-id="8db88-336">Step 4: Create an inbound synchronization rule tooflow hello attribute value from on-premises Active Directory</span></span>
<span data-ttu-id="8db88-337">允許從內部部署 Active Directory toohello Metaverse hello 來源屬性 hello 屬性值 tooflow hello 輸入同步處理規則：</span><span class="sxs-lookup"><span data-stu-id="8db88-337">hello inbound synchronization rule permits hello attribute value tooflow from hello source attribute from on-premises Active Directory toohello Metaverse:</span></span>

1. <span data-ttu-id="8db88-338">啟動 hello**同步處理規則編輯器**移 tooSTART → 所同步處理規則編輯器。</span><span class="sxs-lookup"><span data-stu-id="8db88-338">Start hello **Synchronization Rules Editor** by going tooSTART → Synchronization Rules Editor.</span></span>

2. <span data-ttu-id="8db88-339">集 hello 搜尋篩選器**方向**toobe**輸入**。</span><span class="sxs-lookup"><span data-stu-id="8db88-339">Set hello search filter **Direction** toobe **Inbound**.</span></span>

3. <span data-ttu-id="8db88-340">按一下**加入新規則**按鈕 toocreate 新的輸入規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-340">Click **Add new rule** button toocreate a new inbound rule.</span></span>

4. <span data-ttu-id="8db88-341">在 hello**描述**索引標籤上，提供下列組態的 hello:</span><span class="sxs-lookup"><span data-stu-id="8db88-341">Under hello **Description** tab, provide hello following configuration:</span></span>
 
    | <span data-ttu-id="8db88-342">屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-342">Attribute</span></span> | <span data-ttu-id="8db88-343">值</span><span class="sxs-lookup"><span data-stu-id="8db88-343">Value</span></span> | <span data-ttu-id="8db88-344">詳細資料</span><span class="sxs-lookup"><span data-stu-id="8db88-344">Details</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="8db88-345">名稱</span><span class="sxs-lookup"><span data-stu-id="8db88-345">Name</span></span> | <span data-ttu-id="8db88-346">提供名稱</span><span class="sxs-lookup"><span data-stu-id="8db88-346">*Provide a name*</span></span> | <span data-ttu-id="8db88-347">例如，「In from AD – User PreferredDataLocation」</span><span class="sxs-lookup"><span data-stu-id="8db88-347">For example, *“In from AD – User PreferredDataLocation”*</span></span> |
    | <span data-ttu-id="8db88-348">說明</span><span class="sxs-lookup"><span data-stu-id="8db88-348">Description</span></span> | <span data-ttu-id="8db88-349">提供描述</span><span class="sxs-lookup"><span data-stu-id="8db88-349">*Provide a description*</span></span> |  |
    | <span data-ttu-id="8db88-350">連線系統</span><span class="sxs-lookup"><span data-stu-id="8db88-350">Connected System</span></span> | <span data-ttu-id="8db88-351">*挑選 hello 內部部署 AD 連接器*</span><span class="sxs-lookup"><span data-stu-id="8db88-351">*Pick hello on-premises AD connector*</span></span> |  |
    | <span data-ttu-id="8db88-352">連線系統物件類型</span><span class="sxs-lookup"><span data-stu-id="8db88-352">Connected System Object Type</span></span> | <span data-ttu-id="8db88-353">**使用者**</span><span class="sxs-lookup"><span data-stu-id="8db88-353">**User**</span></span> |  |
    | <span data-ttu-id="8db88-354">Metaverse 物件類型</span><span class="sxs-lookup"><span data-stu-id="8db88-354">Metaverse Object Type</span></span> | <span data-ttu-id="8db88-355">**人員**</span><span class="sxs-lookup"><span data-stu-id="8db88-355">**Person**</span></span> |  |
    | <span data-ttu-id="8db88-356">連結類型</span><span class="sxs-lookup"><span data-stu-id="8db88-356">Link Type</span></span> | <span data-ttu-id="8db88-357">**Join**</span><span class="sxs-lookup"><span data-stu-id="8db88-357">**Join**</span></span> |  |
    | <span data-ttu-id="8db88-358">優先順序</span><span class="sxs-lookup"><span data-stu-id="8db88-358">Precedence</span></span> | <span data-ttu-id="8db88-359">選擇 1 - 99 之間的數字</span><span class="sxs-lookup"><span data-stu-id="8db88-359">*Choose a number between 1 – 99*</span></span> | <span data-ttu-id="8db88-360">1 - 99 已保留供自訂同步處理規則使用。</span><span class="sxs-lookup"><span data-stu-id="8db88-360">1 – 99 is reserved for custom sync rules.</span></span> <span data-ttu-id="8db88-361">請勿挑選已由其他同步處理規則使用的值。</span><span class="sxs-lookup"><span data-stu-id="8db88-361">Do not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="8db88-362">移 toohello**範圍篩選**索引標籤和加入**以 hello 子句之後的單一範圍篩選群組**:</span><span class="sxs-lookup"><span data-stu-id="8db88-362">Go toohello **Scoping filter** tab and add a **single scoping filter group with hello following clause**:</span></span>
 
    | <span data-ttu-id="8db88-363">屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-363">Attribute</span></span> | <span data-ttu-id="8db88-364">運算子</span><span class="sxs-lookup"><span data-stu-id="8db88-364">Operator</span></span> | <span data-ttu-id="8db88-365">值</span><span class="sxs-lookup"><span data-stu-id="8db88-365">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="8db88-366">adminDescription</span><span class="sxs-lookup"><span data-stu-id="8db88-366">adminDescription</span></span> | <span data-ttu-id="8db88-367">NOTSTARTWITH</span><span class="sxs-lookup"><span data-stu-id="8db88-367">NOTSTARTWITH</span></span> | <span data-ttu-id="8db88-368">使用者\_</span><span class="sxs-lookup"><span data-stu-id="8db88-368">User\_</span></span> | 
 
    <span data-ttu-id="8db88-369">範圍篩選器會決定此輸入同步處理規則要套用至哪個內部部署 AD 物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-369">Scoping filter determines which on-premises AD objects this inbound synchronization rule is applied to.</span></span> <span data-ttu-id="8db88-370">在此範例中，我們會使用做為相同的範圍篩選器的 hello *」 在 from AD – 使用者一般"* OOB 同步處理規則，可以防止 hello 同步處理規則套用 tooUser 透過 Azure AD 使用者回寫所建立的物件功能。</span><span class="sxs-lookup"><span data-stu-id="8db88-370">In this example, we use hello same scoping filter used as *“In from AD – User Common”* OOB synchronization rule, which prevents hello synchronization rule from being applied tooUser objects created through Azure AD User writeback feature.</span></span> <span data-ttu-id="8db88-371">您可能需要根據 Azure AD Connect 部署 tooyour tootweak hello 範圍篩選。</span><span class="sxs-lookup"><span data-stu-id="8db88-371">You may need tootweak hello scoping filter according tooyour Azure AD Connect deployment.</span></span>

6. <span data-ttu-id="8db88-372">移 toohello**轉換索引標籤**並實作 hello 下列轉換規則：</span><span class="sxs-lookup"><span data-stu-id="8db88-372">Go toohello **Transformation tab** and implement hello following transformation rule:</span></span>
 
    | <span data-ttu-id="8db88-373">流程類型</span><span class="sxs-lookup"><span data-stu-id="8db88-373">Flow Type</span></span> | <span data-ttu-id="8db88-374">目標屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-374">Target Attribute</span></span> | <span data-ttu-id="8db88-375">來源</span><span class="sxs-lookup"><span data-stu-id="8db88-375">Source</span></span> | <span data-ttu-id="8db88-376">套用一次</span><span class="sxs-lookup"><span data-stu-id="8db88-376">Apply Once</span></span> | <span data-ttu-id="8db88-377">合併類型</span><span class="sxs-lookup"><span data-stu-id="8db88-377">Merge Type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="8db88-378">直接</span><span class="sxs-lookup"><span data-stu-id="8db88-378">Direct</span></span> | <span data-ttu-id="8db88-379">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="8db88-379">PreferredDataLocation</span></span> | <span data-ttu-id="8db88-380">挑選 hello 來源屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-380">Pick hello source attribute</span></span> | <span data-ttu-id="8db88-381">未核取</span><span class="sxs-lookup"><span data-stu-id="8db88-381">Unchecked</span></span> | <span data-ttu-id="8db88-382">更新</span><span class="sxs-lookup"><span data-stu-id="8db88-382">Update</span></span> |

7. <span data-ttu-id="8db88-383">按一下**新增**toocreate hello 輸入的規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-383">Click **Add** toocreate hello inbound rule.</span></span>

![建立輸入同步處理規則](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step4.png)

### <a name="step-5-create-an-outbound-synchronization-rule-tooflow-hello-attribute-value-tooazure-ad"></a><span data-ttu-id="8db88-385">步驟 5： 建立輸出同步處理規則 tooflow hello 屬性值 tooAzure AD</span><span class="sxs-lookup"><span data-stu-id="8db88-385">Step 5: Create an outbound synchronization rule tooflow hello attribute value tooAzure AD</span></span>
<span data-ttu-id="8db88-386">hello 輸出同步處理規則允許 hello Metaverse toohello PreferredDataLocation 屬性從 Azure AD 中的 hello 屬性值 tooflow:</span><span class="sxs-lookup"><span data-stu-id="8db88-386">hello outbound synchronization rule permits hello attribute value tooflow from hello Metaverse toohello PreferredDataLocation attribute in Azure AD:</span></span>

1. <span data-ttu-id="8db88-387">移 toohello**同步處理規則**編輯器。</span><span class="sxs-lookup"><span data-stu-id="8db88-387">Go toohello **Synchronization Rules** Editor.</span></span>

2. <span data-ttu-id="8db88-388">集 hello 搜尋篩選器**方向**toobe**輸出**。</span><span class="sxs-lookup"><span data-stu-id="8db88-388">Set hello search filter **Direction** toobe **Outbound**.</span></span>

3. <span data-ttu-id="8db88-389">按一下 [新增規則] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="8db88-389">Click **Add new rule** button.</span></span>

4. <span data-ttu-id="8db88-390">在 hello**描述**索引標籤上，提供下列組態的 hello:</span><span class="sxs-lookup"><span data-stu-id="8db88-390">Under hello **Description** tab, provide hello following configuration:</span></span>

    | <span data-ttu-id="8db88-391">屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-391">Attribute</span></span> | <span data-ttu-id="8db88-392">值</span><span class="sxs-lookup"><span data-stu-id="8db88-392">Value</span></span> | <span data-ttu-id="8db88-393">詳細資料</span><span class="sxs-lookup"><span data-stu-id="8db88-393">Details</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="8db88-394">名稱</span><span class="sxs-lookup"><span data-stu-id="8db88-394">Name</span></span> | <span data-ttu-id="8db88-395">提供名稱</span><span class="sxs-lookup"><span data-stu-id="8db88-395">*Provide a name*</span></span> | <span data-ttu-id="8db88-396">例如，「 出 tooAAD – 使用者 PreferredDataLocation"</span><span class="sxs-lookup"><span data-stu-id="8db88-396">For example, “Out tooAAD – User PreferredDataLocation”</span></span> |
    | <span data-ttu-id="8db88-397">說明</span><span class="sxs-lookup"><span data-stu-id="8db88-397">Description</span></span> | <span data-ttu-id="8db88-398">提供描述</span><span class="sxs-lookup"><span data-stu-id="8db88-398">*Provide a description*</span></span> |
    | <span data-ttu-id="8db88-399">連線系統</span><span class="sxs-lookup"><span data-stu-id="8db88-399">Connected System</span></span> | <span data-ttu-id="8db88-400">*選取 hello AAD 連接器*</span><span class="sxs-lookup"><span data-stu-id="8db88-400">*Select hello AAD connector*</span></span> |
    | <span data-ttu-id="8db88-401">連線系統物件類型</span><span class="sxs-lookup"><span data-stu-id="8db88-401">Connected System Object Type</span></span> | <span data-ttu-id="8db88-402">User</span><span class="sxs-lookup"><span data-stu-id="8db88-402">User</span></span> ||
    | <span data-ttu-id="8db88-403">Metaverse 物件類型</span><span class="sxs-lookup"><span data-stu-id="8db88-403">Metaverse Object Type</span></span> | <span data-ttu-id="8db88-404">**人員**</span><span class="sxs-lookup"><span data-stu-id="8db88-404">**Person**</span></span> ||
    | <span data-ttu-id="8db88-405">連結類型</span><span class="sxs-lookup"><span data-stu-id="8db88-405">Link Type</span></span> | <span data-ttu-id="8db88-406">**Join**</span><span class="sxs-lookup"><span data-stu-id="8db88-406">**Join**</span></span> ||
    | <span data-ttu-id="8db88-407">優先順序</span><span class="sxs-lookup"><span data-stu-id="8db88-407">Precedence</span></span> | <span data-ttu-id="8db88-408">選擇 1 - 99 之間的數字</span><span class="sxs-lookup"><span data-stu-id="8db88-408">*Choose a number between 1 – 99*</span></span> | <span data-ttu-id="8db88-409">1 - 99 已保留供自訂同步處理規則使用。</span><span class="sxs-lookup"><span data-stu-id="8db88-409">1 – 99 is reserved for custom sync rules.</span></span> <span data-ttu-id="8db88-410">請勿挑選已由其他同步處理規則使用的值。</span><span class="sxs-lookup"><span data-stu-id="8db88-410">YDo not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="8db88-411">移 toohello**範圍篩選**索引標籤和加入**單一範圍篩選群組與兩個子句**:</span><span class="sxs-lookup"><span data-stu-id="8db88-411">Go toohello **Scoping filter** tab and add a **single scoping filter group with two clauses**:</span></span>
 
    | <span data-ttu-id="8db88-412">屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-412">Attribute</span></span> | <span data-ttu-id="8db88-413">運算子</span><span class="sxs-lookup"><span data-stu-id="8db88-413">Operator</span></span> | <span data-ttu-id="8db88-414">值</span><span class="sxs-lookup"><span data-stu-id="8db88-414">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="8db88-415">sourceObjectType</span><span class="sxs-lookup"><span data-stu-id="8db88-415">sourceObjectType</span></span> | <span data-ttu-id="8db88-416">EQUAL</span><span class="sxs-lookup"><span data-stu-id="8db88-416">EQUAL</span></span> | <span data-ttu-id="8db88-417">User</span><span class="sxs-lookup"><span data-stu-id="8db88-417">User</span></span> |
    | <span data-ttu-id="8db88-418">cloudMastered</span><span class="sxs-lookup"><span data-stu-id="8db88-418">cloudMastered</span></span> | <span data-ttu-id="8db88-419">NOTEQUAL</span><span class="sxs-lookup"><span data-stu-id="8db88-419">NOTEQUAL</span></span> | <span data-ttu-id="8db88-420">True</span><span class="sxs-lookup"><span data-stu-id="8db88-420">True</span></span> |

    <span data-ttu-id="8db88-421">範圍篩選器會決定此輸出同步處理規則要套用至哪個 Azure AD 物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-421">Scoping filter determines which Azure AD objects this outbound synchronization rule is applied to.</span></span> <span data-ttu-id="8db88-422">在此範例中，我們使用 hello 相同的範圍篩選器，「 出 tooAD – 使用者身分識別 」 從 OOB 同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-422">In this example, we use hello same scoping filter from “Out tooAD – User Identity” OOB synchronization rule.</span></span> <span data-ttu-id="8db88-423">它會防止 hello 同步處理規則要套用的 tooUser 物件未從內部部署 Active Directory 同步處理。</span><span class="sxs-lookup"><span data-stu-id="8db88-423">It prevents hello synchronization rule from being applied tooUser objects which are not synchronized from on-premises Active Directory.</span></span> <span data-ttu-id="8db88-424">您可能需要根據 Azure AD Connect 部署 tooyour tootweak hello 範圍篩選。</span><span class="sxs-lookup"><span data-stu-id="8db88-424">You may need tootweak hello scoping filter according tooyour Azure AD Connect deployment.</span></span>
    
6. <span data-ttu-id="8db88-425">移 toohello**轉換**索引標籤上，並實作 hello 下列轉換規則：</span><span class="sxs-lookup"><span data-stu-id="8db88-425">Go toohello **Transformation** tab and implement hello following transformation rule:</span></span>

    | <span data-ttu-id="8db88-426">流程類型</span><span class="sxs-lookup"><span data-stu-id="8db88-426">Flow Type</span></span> | <span data-ttu-id="8db88-427">目標屬性</span><span class="sxs-lookup"><span data-stu-id="8db88-427">Target Attribute</span></span> | <span data-ttu-id="8db88-428">來源</span><span class="sxs-lookup"><span data-stu-id="8db88-428">Source</span></span> | <span data-ttu-id="8db88-429">套用一次</span><span class="sxs-lookup"><span data-stu-id="8db88-429">Apply Once</span></span> | <span data-ttu-id="8db88-430">合併類型</span><span class="sxs-lookup"><span data-stu-id="8db88-430">Merge Type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="8db88-431">直接</span><span class="sxs-lookup"><span data-stu-id="8db88-431">Direct</span></span> | <span data-ttu-id="8db88-432">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="8db88-432">PreferredDataLocation</span></span> | <span data-ttu-id="8db88-433">PreferredDataLocation</span><span class="sxs-lookup"><span data-stu-id="8db88-433">PreferredDataLocation</span></span> | <span data-ttu-id="8db88-434">未核取</span><span class="sxs-lookup"><span data-stu-id="8db88-434">Unchecked</span></span> | <span data-ttu-id="8db88-435">更新</span><span class="sxs-lookup"><span data-stu-id="8db88-435">Update</span></span> |

7. <span data-ttu-id="8db88-436">關閉**新增**toocreate hello 輸出規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-436">Close **Add** toocreate hello outbound rule.</span></span>

![建立輸出同步處理規則](./media/active-directory-aadconnectsync-change-the-configuration/preferredDataLocation-step5.png)

### <a name="step-6-run-full-synchronization-cycle"></a><span data-ttu-id="8db88-438">步驟 6：執行完整的同步處理週期</span><span class="sxs-lookup"><span data-stu-id="8db88-438">Step 6: Run Full Synchronization cycle</span></span>
<span data-ttu-id="8db88-439">一般情況下，完整的同步處理循環是必要，因為我們加入了新的屬性 tooboth hello AD 和 Azure AD Connector 結構描述，並導入了自訂同步處理規則。</span><span class="sxs-lookup"><span data-stu-id="8db88-439">In general, full synchronization cycle is required since we have added new attributes tooboth hello AD and Azure AD Connector schema, and introduced custom synchronization rules.</span></span> <span data-ttu-id="8db88-440">建議您之前匯出 tooAzure AD，驗證 hello 變更。</span><span class="sxs-lookup"><span data-stu-id="8db88-440">It is recommended that you verify hello changes before exporting them tooAzure AD.</span></span> <span data-ttu-id="8db88-441">您可以使用下列步驟 tooverify hello 變更時以手動方式執行 hello 步驟組成完整的同步處理循環的 hello。</span><span class="sxs-lookup"><span data-stu-id="8db88-441">You can use hello following steps tooverify hello changes while manually running hello steps that make up a full synchronization cycle.</span></span> 

1. <span data-ttu-id="8db88-442">執行**完整匯入**步驟 hello**在內部部署 AD 連接器**:</span><span class="sxs-lookup"><span data-stu-id="8db88-442">Run **Full import** step on hello **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="8db88-443">移 toohello**作業**hello 同步處理服務管理員中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="8db88-443">Go toohello **Operations** tab in hello Synchronization Service Manager.</span></span>

   2. <span data-ttu-id="8db88-444">以滑鼠右鍵按一下 hello**在內部部署 AD 連接器**選取**執行...**</span><span class="sxs-lookup"><span data-stu-id="8db88-444">Right-click on hello **on-premises AD Connector** and select **Run...**</span></span>

   3. <span data-ttu-id="8db88-445">在 hello 快顯對話方塊中，選取 **完整匯入**按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="8db88-445">In hello pop-up dialog, select **Full Import** and click **OK**.</span></span>
    
   4. <span data-ttu-id="8db88-446">等候作業 toocomplete。</span><span class="sxs-lookup"><span data-stu-id="8db88-446">Wait for operation toocomplete.</span></span>

    > [!NOTE]
    > <span data-ttu-id="8db88-447">您可以在略過完整匯入 hello 內部部署 AD 連接器如果 hello 來源屬性已包含在 hello 匯入的屬性清單中。</span><span class="sxs-lookup"><span data-stu-id="8db88-447">You can skip Full Import on hello on-premises AD Connector if hello source attribute is already included in hello list of imported attributes.</span></span> <span data-ttu-id="8db88-448">換句話說，您不需要 toomake 期間的任何變更[步驟 2： 新增 hello 來源屬性 toohello 內部部署 AD 連接器架構](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema)。</span><span class="sxs-lookup"><span data-stu-id="8db88-448">In other words, you did not have toomake any change during [Step 2: Add hello source attribute toohello on-premises AD Connector schema](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).</span></span>

2. <span data-ttu-id="8db88-449">執行**完整匯入**步驟 hello **Azure AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="8db88-449">Run **Full import** step on hello **Azure AD Connector**:</span></span>

   1. <span data-ttu-id="8db88-450">以滑鼠右鍵按一下 hello **Azure AD Connector**選取**執行...**</span><span class="sxs-lookup"><span data-stu-id="8db88-450">Right-click on hello **Azure AD Connector** and select **Run...**</span></span>

   2. <span data-ttu-id="8db88-451">在 hello 快顯對話方塊中，選取 **完整匯入**按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="8db88-451">In hello pop-up dialog, select **Full Import** and click **OK**.</span></span>
   
   3. <span data-ttu-id="8db88-452">等候作業 toocomplete。</span><span class="sxs-lookup"><span data-stu-id="8db88-452">Wait for operation toocomplete.</span></span>

3. <span data-ttu-id="8db88-453">請確認現有的使用者物件上的 hello 同步處理規則變更：</span><span class="sxs-lookup"><span data-stu-id="8db88-453">Verify hello synchronization rule changes on an existing User object:</span></span>

<span data-ttu-id="8db88-454">hello 來源屬性從內部部署 Active Directory 與 Azure AD 從 PreferredDataLocation 已匯入 hello 各自的連接器空間。</span><span class="sxs-lookup"><span data-stu-id="8db88-454">hello source attribute from on-premises Active Directory and PreferredDataLocation from Azure AD have been imported into hello respective Connecter Space.</span></span> <span data-ttu-id="8db88-455">完整同步處理步驟之前，建議您不要**預覽**上現有的使用者物件中 hello 內部部署 AD 連接器空間。</span><span class="sxs-lookup"><span data-stu-id="8db88-455">Before proceeding with Full Synchronization step, it is recommended that you do a **Preview** on an existing User object in hello on-premises AD Connector Space.</span></span> <span data-ttu-id="8db88-456">您挑選的 hello 物件應該填入 hello 來源屬性。</span><span class="sxs-lookup"><span data-stu-id="8db88-456">hello object you picked should have hello source attribute populated.</span></span> <span data-ttu-id="8db88-457">成功**預覽**以 hello PreferredDataLocation hello Metaverse 中填入是 hello 同步處理規則的設定正確的良好指標。</span><span class="sxs-lookup"><span data-stu-id="8db88-457">A successful **Preview** with hello PreferredDataLocation populated in hello Metaverse is a good indicator that you have configured hello synchronization rules correctly.</span></span> <span data-ttu-id="8db88-458">如需有關資訊 toodo**預覽**，請參閱 toosection[驗證 hello 變更](#verify-the-change)。</span><span class="sxs-lookup"><span data-stu-id="8db88-458">For information about how toodo a **Preview**, refer toosection [Verify hello change](#verify-the-change).</span></span>

4. <span data-ttu-id="8db88-459">執行**完整同步處理**步驟 hello**在內部部署 AD 連接器**:</span><span class="sxs-lookup"><span data-stu-id="8db88-459">Run **Full Synchronization** step on hello **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="8db88-460">以滑鼠右鍵按一下 hello**在內部部署 AD 連接器**選取**執行...**</span><span class="sxs-lookup"><span data-stu-id="8db88-460">Right-click on hello **on-premises AD Connector** and select **Run...**</span></span>
  
   2. <span data-ttu-id="8db88-461">在 hello 快顯對話方塊中，選取**完整同步處理**按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="8db88-461">In hello pop-up dialog, select **Full Synchronization** and click **OK**.</span></span>
   
   3. <span data-ttu-id="8db88-462">等候作業 toocomplete。</span><span class="sxs-lookup"><span data-stu-id="8db88-462">Wait for operation toocomplete.</span></span>

5. <span data-ttu-id="8db88-463">確認**暫停匯出**tooAzure AD:</span><span class="sxs-lookup"><span data-stu-id="8db88-463">Verify **Pending Exports** tooAzure AD:</span></span>

   1. <span data-ttu-id="8db88-464">以滑鼠右鍵按一下 hello **Azure AD Connector**選取**搜尋連接器空間**。</span><span class="sxs-lookup"><span data-stu-id="8db88-464">Right-click on hello **Azure AD Connector** and select **Search Connector Space**.</span></span>

   2. <span data-ttu-id="8db88-465">在 hello 搜尋連接器空間快顯對話方塊：</span><span class="sxs-lookup"><span data-stu-id="8db88-465">In hello Search Connector Space pop-up dialog:</span></span>

      1. <span data-ttu-id="8db88-466">設定**範圍**太**暫止匯出**。</span><span class="sxs-lookup"><span data-stu-id="8db88-466">Set **Scope** too**Pending Export**.</span></span>
      
      2. <span data-ttu-id="8db88-467">將 3 個核取方塊全部勾選，包括 [新增]、[修改] 和 [刪除]。</span><span class="sxs-lookup"><span data-stu-id="8db88-467">Check all three checkboxes, including **Add, Modify, and Delete**.</span></span>
      
      3. <span data-ttu-id="8db88-468">按一下 hello**搜尋**按鈕 tooget hello 清單具有變更 toobe 匯出的物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-468">Click hello **Search** button tooget hello list of objects with changes toobe exported.</span></span> <span data-ttu-id="8db88-469">tooexamine hello 變更之特定物件，連按兩下 hello 物件。</span><span class="sxs-lookup"><span data-stu-id="8db88-469">tooexamine hello changes for a given object, double-click hello object.</span></span>
      
      4. <span data-ttu-id="8db88-470">請確認預期 hello 變更。</span><span class="sxs-lookup"><span data-stu-id="8db88-470">Verify hello changes are expected.</span></span>

6. <span data-ttu-id="8db88-471">執行**匯出**步驟 hello **Azure AD Connector**</span><span class="sxs-lookup"><span data-stu-id="8db88-471">Run **Export** step on hello **Azure AD Connector**</span></span>
      
   1. <span data-ttu-id="8db88-472">以滑鼠右鍵按一下 hello **Azure AD Connector**選取**執行...**</span><span class="sxs-lookup"><span data-stu-id="8db88-472">Right-click hello **Azure AD Connector** and select **Run...**</span></span>
   
   2. <span data-ttu-id="8db88-473">在 hello 執行連接器快顯對話方塊中，選取 **匯出**按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="8db88-473">In hello Run Connector pop-up dialog, select **Export** and click **OK**.</span></span>
   
   3. <span data-ttu-id="8db88-474">等候匯出 tooAzure AD toocomplete。</span><span class="sxs-lookup"><span data-stu-id="8db88-474">Wait for Export tooAzure AD toocomplete.</span></span>

> [!NOTE]
> <span data-ttu-id="8db88-475">您可能會注意到 hello 步驟不包含 hello 完整同步處理步驟和 hello Azure AD Connector 的 「 匯出 」 步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-475">You may notice that hello steps do not include hello Full Synchronization step and Export step on hello Azure AD Connector.</span></span> <span data-ttu-id="8db88-476">因為從內部部署 Active Directory tooAzure AD 只傳送 hello 屬性值，則不需要 hello 步驟。</span><span class="sxs-lookup"><span data-stu-id="8db88-476">hello steps are not required since hello attribute values are flowing from on-premises Active Directory tooAzure AD only.</span></span>

### <a name="step-7-re-enable-sync-scheduler"></a><span data-ttu-id="8db88-477">步驟 7：重新啟用同步排程器</span><span class="sxs-lookup"><span data-stu-id="8db88-477">Step 7: Re-enable sync scheduler</span></span>
<span data-ttu-id="8db88-478">重新啟用 hello 內建的同步處理排程器：</span><span class="sxs-lookup"><span data-stu-id="8db88-478">Re-enable hello built-in sync scheduler:</span></span>

1. <span data-ttu-id="8db88-479">啟動 PowerShell 工作階段。</span><span class="sxs-lookup"><span data-stu-id="8db88-479">Start PowerShell session.</span></span>

2. <span data-ttu-id="8db88-480">執行 Cmdlet 以重新啟用排定的同步處理︰`Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="8db88-480">Re-enable scheduled synchronization by running cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>



## <a name="next-steps"></a><span data-ttu-id="8db88-481">後續步驟</span><span class="sxs-lookup"><span data-stu-id="8db88-481">Next steps</span></span>
* <span data-ttu-id="8db88-482">深入了解 hello 組態模型[了解宣告式佈建](active-directory-aadconnectsync-understanding-declarative-provisioning.md)。</span><span class="sxs-lookup"><span data-stu-id="8db88-482">Read more about hello configuration model in [Understanding Declarative Provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span></span>
* <span data-ttu-id="8db88-483">如需詳細資訊中的 hello 運算式語言[了解宣告式佈建運算式](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="8db88-483">Read more about hello expression language in [Understanding Declarative Provisioning Expressions](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).</span></span>

<span data-ttu-id="8db88-484">**概觀主題**</span><span class="sxs-lookup"><span data-stu-id="8db88-484">**Overview topics**</span></span>

* [<span data-ttu-id="8db88-485">Azure AD Connect 同步處理：了解及自訂同步處理</span><span class="sxs-lookup"><span data-stu-id="8db88-485">Azure AD Connect sync: Understand and customize synchronization</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="8db88-486">整合內部部署身分識別與 Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="8db88-486">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
