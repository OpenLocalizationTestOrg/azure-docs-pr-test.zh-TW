---
title: "PowerShell 連接器 | Microsoft Docs"
description: "本文說明如何設定 Microsoft 的 Windows PowerShell 連接器。"
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 6dba8e34-a874-4ff0-90bc-bd2b0a4199b5
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 0e5ccf5a38072e31d85bbc63eb0c608b0c34cfc2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="windows-powershell-connector-technical-reference"></a><span data-ttu-id="fee96-103">Windows PowerShell 連接器技術參考</span><span class="sxs-lookup"><span data-stu-id="fee96-103">Windows PowerShell Connector technical reference</span></span>
<span data-ttu-id="fee96-104">本文說明 Windows PowerShell 連接器。</span><span class="sxs-lookup"><span data-stu-id="fee96-104">This article describes the Windows PowerShell Connector.</span></span> <span data-ttu-id="fee96-105">本文適用於下列產品：</span><span class="sxs-lookup"><span data-stu-id="fee96-105">The article applies to the following products:</span></span>

* <span data-ttu-id="fee96-106">Microsoft Identity Manager 2016 (MIM2016)</span><span class="sxs-lookup"><span data-stu-id="fee96-106">Microsoft Identity Manager 2016 (MIM2016)</span></span>
* <span data-ttu-id="fee96-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span><span class="sxs-lookup"><span data-stu-id="fee96-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span></span>
  * <span data-ttu-id="fee96-108">必須使用 Hotfix 4.1.3671.0 或更新版本 [KB3092178](https://support.microsoft.com/kb/3092178)。</span><span class="sxs-lookup"><span data-stu-id="fee96-108">Must use hotfix 4.1.3671.0 or later [KB3092178](https://support.microsoft.com/kb/3092178).</span></span>

<span data-ttu-id="fee96-109">對於 MIM2016 和 FIM2010R2，可以從 [Microsoft 下載中心](http://go.microsoft.com/fwlink/?LinkId=717495)下載此連接器。</span><span class="sxs-lookup"><span data-stu-id="fee96-109">For MIM2016 and FIM2010R2, the Connector is available as a download from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495).</span></span>

## <a name="overview-of-the-powershell-connector"></a><span data-ttu-id="fee96-110">PowerShell 連接器概觀</span><span class="sxs-lookup"><span data-stu-id="fee96-110">Overview of the PowerShell Connector</span></span>
<span data-ttu-id="fee96-111">PowerShell 連接器可讓您整合同步處理服務與可提供 Windows PowerShell 型 API 的外部系統。</span><span class="sxs-lookup"><span data-stu-id="fee96-111">The PowerShell Connector enables you to integrate the synchronization service with external systems that offer Windows PowerShell based APIs.</span></span> <span data-ttu-id="fee96-112">此連接器會在呼叫型可延伸連線管理代理程式 2 (ECMA2) 架構和 Windows PowerShell 的功能之間提供橋樑。</span><span class="sxs-lookup"><span data-stu-id="fee96-112">The connector provides a bridge between the capabilities of the call-based extensible connectivity management agent 2 (ECMA2) framework and Windows PowerShell.</span></span> <span data-ttu-id="fee96-113">如需 ECMA 架構的詳細資訊，請參閱 [可延伸的連線 2.2 管理代理程式參考](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx)。</span><span class="sxs-lookup"><span data-stu-id="fee96-113">For more information about the ECMA framework, see the [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="fee96-114">必要條件</span><span class="sxs-lookup"><span data-stu-id="fee96-114">Prerequisites</span></span>
<span data-ttu-id="fee96-115">在您使用連接器之前，請確定同步處理伺服器上有下列項目：</span><span class="sxs-lookup"><span data-stu-id="fee96-115">Before you use the Connector, make sure you have the following on the synchronization server:</span></span>

* <span data-ttu-id="fee96-116">Microsoft .NET 4.5.2 Framework 或更新版本</span><span class="sxs-lookup"><span data-stu-id="fee96-116">Microsoft .NET 4.5.2 Framework or later</span></span>
* <span data-ttu-id="fee96-117">Windows PowerShell 2.0、3.0 或 4.0</span><span class="sxs-lookup"><span data-stu-id="fee96-117">Windows PowerShell 2.0, 3.0, or 4.0</span></span>

<span data-ttu-id="fee96-118">同步處理服務伺服器上的執行原則必須設定為允許連接器執行 Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-118">The execution policy on the Synchronization Service server must be configured to allow the connector to run Windows PowerShell scripts.</span></span> <span data-ttu-id="fee96-119">除非連接器執行的指令碼是經過數位簽署的，否則請執行下列命令來設定執行原則：</span><span class="sxs-lookup"><span data-stu-id="fee96-119">Unless the scripts the connector runs are digitally signed, configure the execution policy by running this command:</span></span>  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`

## <a name="create-a-new-connector"></a><span data-ttu-id="fee96-120">建立新的連接器</span><span class="sxs-lookup"><span data-stu-id="fee96-120">Create a new Connector</span></span>
<span data-ttu-id="fee96-121">若要在同步處理服務中建立 Windows PowerShell 連接器，您必須提供一系列 Windows PowerShell 指令碼來執行同步處理服務所要求的步驟。</span><span class="sxs-lookup"><span data-stu-id="fee96-121">To create a Windows PowerShell connector in the synchronization service, you must provide a series of Windows PowerShell scripts that execute the steps requested by the synchronization service.</span></span> <span data-ttu-id="fee96-122">根據您所連接的資料來源和所需的功能，您必須實作的指令碼會有所不同。</span><span class="sxs-lookup"><span data-stu-id="fee96-122">Depending on the data source you connect to and the functionality you require, the scripts you must implement varies.</span></span> <span data-ttu-id="fee96-123">本節概述可以實作的每個指令碼以及何時需要用到它們。</span><span class="sxs-lookup"><span data-stu-id="fee96-123">This section outlines each of the scripts that can be implemented and when they are required.</span></span>

<span data-ttu-id="fee96-124">Windows PowerShell 連接器是設計用來儲存同步處理服務資料庫內的每個指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-124">The Windows PowerShell connector is designed to store each of the scripts inside the Synchronization Service database.</span></span> <span data-ttu-id="fee96-125">雖然您可以執行儲存在檔案系統的指令碼，但將每個指令碼的主體直接插入連接器組態會更為容易。</span><span class="sxs-lookup"><span data-stu-id="fee96-125">While it is possible to run scripts that are stored on the file system, it is easier to insert the body of each script directly in to the connector’s configuration.</span></span>

<span data-ttu-id="fee96-126">若要建立 PowerShell 連接器，請在 [同步處理服務] 中選取 [管理代理程式] 和 [建立]。</span><span class="sxs-lookup"><span data-stu-id="fee96-126">To Create a PowerShell connector, in **Synchronization Service** select **Management Agent** and **Create**.</span></span> <span data-ttu-id="fee96-127">選取 [PowerShell (Microsoft)]  連接器。</span><span class="sxs-lookup"><span data-stu-id="fee96-127">Select the **PowerShell (Microsoft)** Connector.</span></span>

![建立連接器](./media/active-directory-aadconnectsync-connector-powershell/createconnector.png)

### <a name="connectivity"></a><span data-ttu-id="fee96-129">連線能力</span><span class="sxs-lookup"><span data-stu-id="fee96-129">Connectivity</span></span>
<span data-ttu-id="fee96-130">提供用來連接至遠端系統的組態參數。</span><span class="sxs-lookup"><span data-stu-id="fee96-130">Supply configuration parameters for connecting to a remote system.</span></span> <span data-ttu-id="fee96-131">這些值會由同步處理服務妥善保存，並在連接器執行時提供給 Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-131">These values are securely stored by the Synchronization Service and made available to your Windows PowerShell scripts when the connector is run.</span></span>

![連線能力](./media/active-directory-aadconnectsync-connector-powershell/connectivity.png)

<span data-ttu-id="fee96-133">您可以設定下列連線參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-133">You can configure the following Connectivity parameters:</span></span>

<span data-ttu-id="fee96-134">**連線能力**</span><span class="sxs-lookup"><span data-stu-id="fee96-134">**Connectivity**</span></span>

| <span data-ttu-id="fee96-135">參數</span><span class="sxs-lookup"><span data-stu-id="fee96-135">Parameter</span></span> | <span data-ttu-id="fee96-136">預設值</span><span class="sxs-lookup"><span data-stu-id="fee96-136">Default Value</span></span> | <span data-ttu-id="fee96-137">目的</span><span class="sxs-lookup"><span data-stu-id="fee96-137">Purpose</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-138">伺服器</span><span class="sxs-lookup"><span data-stu-id="fee96-138">Server</span></span> |<Blank> |<span data-ttu-id="fee96-139">連接器應該連接到的伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="fee96-139">Server name that the connector should connect to.</span></span> |
| <span data-ttu-id="fee96-140">網域</span><span class="sxs-lookup"><span data-stu-id="fee96-140">Domain</span></span> |<Blank> |<span data-ttu-id="fee96-141">連接器執行時，要儲存起來以供使用的認證網域。</span><span class="sxs-lookup"><span data-stu-id="fee96-141">Domain of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="fee96-142">User</span><span class="sxs-lookup"><span data-stu-id="fee96-142">User</span></span> |<Blank> |<span data-ttu-id="fee96-143">連接器執行時，要儲存起來以供使用的認證使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="fee96-143">Username of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="fee96-144">密碼</span><span class="sxs-lookup"><span data-stu-id="fee96-144">Password</span></span> |<Blank> |<span data-ttu-id="fee96-145">連接器執行時，要儲存起來以供使用的認證密碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-145">Password of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="fee96-146">模擬連接器帳戶</span><span class="sxs-lookup"><span data-stu-id="fee96-146">Impersonate Connector Account</span></span> |<span data-ttu-id="fee96-147">False</span><span class="sxs-lookup"><span data-stu-id="fee96-147">False</span></span> |<span data-ttu-id="fee96-148">如果為 true，同步處理服務會在所提供的認證內容中執行 Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-148">When true, the synchronization service runs the Windows PowerShell scripts in the context of the credentials supplied.</span></span> <span data-ttu-id="fee96-149">如果可能的話，建議使用傳遞至每個指令碼的 **$Credentials** 參數來代替模擬。</span><span class="sxs-lookup"><span data-stu-id="fee96-149">When possible, it is recommended that the **$Credentials** parameter is passed to each script is used instead of impersonation.</span></span> <span data-ttu-id="fee96-150">如需使用此選項時必須具備之其他權限的詳細資訊，請參閱 [模擬的其他組態](#additional-configuration-for-impersonation)。</span><span class="sxs-lookup"><span data-stu-id="fee96-150">For more information on additional permissions that are required to use this option, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="fee96-151">模擬時載入使用者設定檔</span><span class="sxs-lookup"><span data-stu-id="fee96-151">Load User Profile When Impersonating</span></span> |<span data-ttu-id="fee96-152">False</span><span class="sxs-lookup"><span data-stu-id="fee96-152">False</span></span> |<span data-ttu-id="fee96-153">指示 Windows 在模擬期間載入連接器認證的使用者設定檔。</span><span class="sxs-lookup"><span data-stu-id="fee96-153">Instructs Windows to load the user profile of the connector’s credentials during impersonation.</span></span> <span data-ttu-id="fee96-154">如果模擬的使用者具有漫遊設定檔，連接器就不會載入漫遊設定檔。</span><span class="sxs-lookup"><span data-stu-id="fee96-154">If the impersonated user has a roaming profile, the connector does not load the roaming profile.</span></span> <span data-ttu-id="fee96-155">如需使用此參數時必須具備之其他權限的詳細資訊，請參閱 [模擬的其他組態](#additional-configuration-for-impersonation)。</span><span class="sxs-lookup"><span data-stu-id="fee96-155">For more information on additional permissions that are required to use this parameter, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="fee96-156">模擬時的登入類型</span><span class="sxs-lookup"><span data-stu-id="fee96-156">Logon Type When Impersonating</span></span> |<span data-ttu-id="fee96-157">None</span><span class="sxs-lookup"><span data-stu-id="fee96-157">None</span></span> |<span data-ttu-id="fee96-158">模擬期間的登入類型。</span><span class="sxs-lookup"><span data-stu-id="fee96-158">Logon type during impersonation.</span></span> <span data-ttu-id="fee96-159">如需詳細資訊，請參閱 [dwLogonType][dw] 文件。</span><span class="sxs-lookup"><span data-stu-id="fee96-159">For more information, see the [dwLogonType][dw] documentation.</span></span> |
| <span data-ttu-id="fee96-160">僅限已簽署的指令碼</span><span class="sxs-lookup"><span data-stu-id="fee96-160">Signed Scripts Only</span></span> |<span data-ttu-id="fee96-161">False</span><span class="sxs-lookup"><span data-stu-id="fee96-161">False</span></span> |<span data-ttu-id="fee96-162">如果為 true，Windows PowerShell 連接器會驗證每個指令碼是否具有有效的數位簽章。</span><span class="sxs-lookup"><span data-stu-id="fee96-162">If true, the Windows PowerShell connector validates that each script has a valid digital signature.</span></span> <span data-ttu-id="fee96-163">如果為 false，請確定同步處理服務伺服器的 Windows PowerShell 執行原則是 RemoteSigned 或不受限制。</span><span class="sxs-lookup"><span data-stu-id="fee96-163">If false, ensure that the Synchronization Service server’s Windows PowerShell execution policy is RemoteSigned or Unrestricted.</span></span> |

<span data-ttu-id="fee96-164">**通用模組**</span><span class="sxs-lookup"><span data-stu-id="fee96-164">**Common Module**</span></span>  
<span data-ttu-id="fee96-165">連接器可讓您在組態中儲存共用的 Windows PowerShell 模組。</span><span class="sxs-lookup"><span data-stu-id="fee96-165">The connector allows you to store a shared Windows PowerShell module in the configuration.</span></span> <span data-ttu-id="fee96-166">連接器在執行指令碼時，會將 Windows PowerShell 模組擷取到檔案系統，使其可供每個指令碼匯入。</span><span class="sxs-lookup"><span data-stu-id="fee96-166">When the connector runs a script, the Windows PowerShell module is extracted to the file system so that it can be imported by each script.</span></span>

<span data-ttu-id="fee96-167">針對匯入、匯出和密碼同步處理指令碼，會將一般模組擷取到連接器的 MAData 資料夾。</span><span class="sxs-lookup"><span data-stu-id="fee96-167">For Import, Export, and Password Synchronization scripts, the common module is extracted to the connector’s MAData folder.</span></span> <span data-ttu-id="fee96-168">針對結構描述、驗證、階層和資料分割探索指令碼，則會將一般模組擷取到 %TEMP% 資料夾。</span><span class="sxs-lookup"><span data-stu-id="fee96-168">For Schema, Validation, Hierarchy, and Partition discovery scripts, the common module is extracted to the %TEMP% folder.</span></span> <span data-ttu-id="fee96-169">在這兩種情況下，所擷取的一般模組指令碼會根據一般模組指令碼名稱設定進行命名。</span><span class="sxs-lookup"><span data-stu-id="fee96-169">In both cases, the extracted Common Module script is named according to the Common Module Script Name setting.</span></span>

<span data-ttu-id="fee96-170">若要從 MAData 資料夾中載入名稱為 FIMPowerShellConnectorModule.psm1 的模組，請使用下列陳述式： `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="fee96-170">To load a module called FIMPowerShellConnectorModule.psm1 from the MAData folder, use the following statement: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="fee96-171">若要從 %TEMP% 資料夾中載入名稱為 FIMPowerShellConnectorModule.psm1 的模組，請使用下列陳述式： `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="fee96-171">To load a module called FIMPowerShellConnectorModule.psm1 from the %TEMP% folder, use the following statement: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="fee96-172">**參數驗證**</span><span class="sxs-lookup"><span data-stu-id="fee96-172">**Parameter Validation**</span></span>  
<span data-ttu-id="fee96-173">驗證指令碼是選擇性的 Windows PowerShell 指令碼，可用來確保系統管理員所提供的連接器組態參數有效。</span><span class="sxs-lookup"><span data-stu-id="fee96-173">The Validation Script is an optional Windows PowerShell script that can be used to ensure that connector configuration parameters supplied by the administrator are valid.</span></span> <span data-ttu-id="fee96-174">驗證伺服器、連接認證，以及連線參數是驗證指令碼的常見用途。</span><span class="sxs-lookup"><span data-stu-id="fee96-174">Validating server, connection credentials, and connectivity parameters are common usages of the validation script.</span></span> <span data-ttu-id="fee96-175">下列索引標籤和對話方塊若有修改，就會呼叫驗證指令碼：</span><span class="sxs-lookup"><span data-stu-id="fee96-175">The validation script is called after the following tabs and dialogs are modified:</span></span>

* <span data-ttu-id="fee96-176">連線能力</span><span class="sxs-lookup"><span data-stu-id="fee96-176">Connectivity</span></span>
* <span data-ttu-id="fee96-177">全域參數</span><span class="sxs-lookup"><span data-stu-id="fee96-177">Global Parameters</span></span>
* <span data-ttu-id="fee96-178">資料分割組態</span><span class="sxs-lookup"><span data-stu-id="fee96-178">Partition Configuration</span></span>

<span data-ttu-id="fee96-179">驗證指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-179">The validation script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-180">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-180">Name</span></span> | <span data-ttu-id="fee96-181">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-181">Data Type</span></span> | <span data-ttu-id="fee96-182">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-182">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-183">ConfigParameterPage</span><span class="sxs-lookup"><span data-stu-id="fee96-183">ConfigParameterPage</span></span> |<span data-ttu-id="fee96-184">[ConfigParameterPage][cpp]</span><span class="sxs-lookup"><span data-stu-id="fee96-184">[ConfigParameterPage][cpp]</span></span> |<span data-ttu-id="fee96-185">觸發驗證要求的組態索引標籤或對話方塊。</span><span class="sxs-lookup"><span data-stu-id="fee96-185">The configuration tab or dialog that triggered the validation request.</span></span> |
| <span data-ttu-id="fee96-186">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-186">ConfigParameters</span></span> |<span data-ttu-id="fee96-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-188">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-188">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-189">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-189">Credential</span></span> |<span data-ttu-id="fee96-190">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-190">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-191">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-191">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="fee96-192">驗證指令碼應該將單一 ParameterValidationResult 物件傳回至管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-192">The validation script should return a single ParameterValidationResult object to the pipeline.</span></span>

<span data-ttu-id="fee96-193">**結構描述探索**</span><span class="sxs-lookup"><span data-stu-id="fee96-193">**Schema Discovery**</span></span>  
<span data-ttu-id="fee96-194">結構描述探索指令碼是必要項目。</span><span class="sxs-lookup"><span data-stu-id="fee96-194">The Schema Discovery script is mandatory.</span></span> <span data-ttu-id="fee96-195">此指令碼會傳回物件類型、屬性，以及同步處理服務在設定屬性流程規則時使用的屬性條件約束。</span><span class="sxs-lookup"><span data-stu-id="fee96-195">This script returns the object types, attributes, and attribute constraints that the Synchronization Service uses when configuring attribute flow rules.</span></span> <span data-ttu-id="fee96-196">結構描述探索指令碼會在連接器建立期間執行，並填入連接器的結構描述。</span><span class="sxs-lookup"><span data-stu-id="fee96-196">The Schema Discovery script is run during connector creation and populates the connector’s schema.</span></span> <span data-ttu-id="fee96-197">同步處理服務管理員中的重新整理結構描述動作也會使用該指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-197">It is also used by the Refresh Schema action in the Synchronization Service Manager.</span></span>

<span data-ttu-id="fee96-198">結構描述探索指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-198">The schema discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-199">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-199">Name</span></span> | <span data-ttu-id="fee96-200">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-200">Data Type</span></span> | <span data-ttu-id="fee96-201">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-201">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-202">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-202">ConfigParameters</span></span> |<span data-ttu-id="fee96-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-204">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-204">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-205">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-205">Credential</span></span> |<span data-ttu-id="fee96-206">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-206">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-207">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-207">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="fee96-208">指令碼必須傳回單一[結構描述][schema]物件到管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-208">The script must return a single [Schema][schema] object to the pipeline.</span></span> <span data-ttu-id="fee96-209">結構描述物件是由代表物件類型 (例如：使用者和群組) 的 [SchemaType][schemaT] 物件所組成。</span><span class="sxs-lookup"><span data-stu-id="fee96-209">The Schema object is composed of [SchemaType][schemaT] objects that represent object types (for example: users and groups).</span></span> <span data-ttu-id="fee96-210">SchemaType 物件會保存代表該類型屬性 (例如：名字、姓氏和郵寄地址) 的 [SchemaAttribute][schemaA] 物件集合。</span><span class="sxs-lookup"><span data-stu-id="fee96-210">The SchemaType object holds a collection of [SchemaAttribute][schemaA] objects that represent the attributes (for example: given name, surname, and postal address) of the type.</span></span>

<span data-ttu-id="fee96-211">**其他參數**</span><span class="sxs-lookup"><span data-stu-id="fee96-211">**Additional Parameters**</span></span>  
<span data-ttu-id="fee96-212">除了標準組態設定以外，您還可以定義連接器執行個體特定的其他自訂組態設定。</span><span class="sxs-lookup"><span data-stu-id="fee96-212">In addition to the standard configuration settings, you can define additional custom configuration settings that are specific to the instance of the Connector.</span></span> <span data-ttu-id="fee96-213">這些參數可以指定於連接器、資料分割或執行步驟層級，並從相關的 Windows PowerShell 指令碼進行存取。</span><span class="sxs-lookup"><span data-stu-id="fee96-213">These parameters can be specified at the connector, partition, or run step levels and accessed from the relevant Windows PowerShell script.</span></span> <span data-ttu-id="fee96-214">自訂組態設定可以純文字格式儲存在同步處理服務資料庫中，或可以進行加密。</span><span class="sxs-lookup"><span data-stu-id="fee96-214">Custom configuration settings can be stored in the Synchronization Service database in plain text format or they may be encrypted.</span></span> <span data-ttu-id="fee96-215">同步處理服務會在必要時自動加密和解密安全的組態設定。</span><span class="sxs-lookup"><span data-stu-id="fee96-215">The Synchronization Service automatically encrypts and decrypts secure configuration settings when required.</span></span>

<span data-ttu-id="fee96-216">若要指定自訂組態設定，請使用逗號 (,) 分隔每個參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="fee96-216">To specify custom configuration settings, separate the name of each parameter with a comma ( , ).</span></span>

<span data-ttu-id="fee96-217">若要從指令碼中存取自訂組態設定，您必須在名稱後面加上底線 (\_) 和參數範圍 (全域、資料分割或 RunStep)。</span><span class="sxs-lookup"><span data-stu-id="fee96-217">To access custom configuration settings from a script, you must suffix the name with an underscore ( \_ ) and the scope of the parameter (Global, Partition, or RunStep).</span></span> <span data-ttu-id="fee96-218">例如，若要存取全域檔案名稱參數，請使用此程式碼片段： `$ConfigurationParameters["FileName_Global"].Value`</span><span class="sxs-lookup"><span data-stu-id="fee96-218">For example, to access the Global FileName parameter, use this code snippet: `$ConfigurationParameters["FileName_Global"].Value`</span></span>

### <a name="capabilities"></a><span data-ttu-id="fee96-219">功能</span><span class="sxs-lookup"><span data-stu-id="fee96-219">Capabilities</span></span>
<span data-ttu-id="fee96-220">Management Agent Designer 的 [功能] 索引標籤會定義連接器的行為和功能。</span><span class="sxs-lookup"><span data-stu-id="fee96-220">The capabilities tab of the Management Agent Designer defines the behavior and functionality of the connector.</span></span> <span data-ttu-id="fee96-221">建立連接器後，就無法修改在此索引標籤上所做的選擇。</span><span class="sxs-lookup"><span data-stu-id="fee96-221">The selections made on this tab cannot be modified when the connector has been created.</span></span> <span data-ttu-id="fee96-222">此表格列出功能設定。</span><span class="sxs-lookup"><span data-stu-id="fee96-222">This table lists the capability settings.</span></span>

![功能](./media/active-directory-aadconnectsync-connector-powershell/capabilities.png)

| <span data-ttu-id="fee96-224">功能</span><span class="sxs-lookup"><span data-stu-id="fee96-224">Capability</span></span> | <span data-ttu-id="fee96-225">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-225">Description</span></span> |
| --- | --- |
| <span data-ttu-id="fee96-226">[辨別名稱樣式][dnstyle]</span><span class="sxs-lookup"><span data-stu-id="fee96-226">[Distinguished Name Style][dnstyle]</span></span> |<span data-ttu-id="fee96-227">指出連接器是否支援辨別名稱，如果支援，其樣式為何。</span><span class="sxs-lookup"><span data-stu-id="fee96-227">Indicates if the connector supports distinguished names and if so, what style.</span></span> |
| <span data-ttu-id="fee96-228">[匯出類型][exportT]</span><span class="sxs-lookup"><span data-stu-id="fee96-228">[Export Type][exportT]</span></span> |<span data-ttu-id="fee96-229">決定要對匯出指令碼顯示的物件類型。</span><span class="sxs-lookup"><span data-stu-id="fee96-229">Determines the type of objects that are presented to the Export script.</span></span> <li><span data-ttu-id="fee96-230">AttributeReplace - 包含屬性變更時多重值屬性的完整值組。</span><span class="sxs-lookup"><span data-stu-id="fee96-230">AttributeReplace – includes the full set of values for a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="fee96-231">AttributeUpdate - 僅包含屬性變更時多重值屬性的差異。</span><span class="sxs-lookup"><span data-stu-id="fee96-231">AttributeUpdate – includes only the deltas to a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="fee96-232">MultivaluedReferenceAttributeUpdate - 包含非參考多重值屬性一組完整的值，以及僅多重值參考屬性的差異。</span><span class="sxs-lookup"><span data-stu-id="fee96-232">MultivaluedReferenceAttributeUpdate - includes a full set of values for non-reference multi-valued attributes and only deltas for multi-valued reference attributes.</span></span></li><li><span data-ttu-id="fee96-233">ObjectReplace - 包含屬性變更時物件的所有屬性</span><span class="sxs-lookup"><span data-stu-id="fee96-233">ObjectReplace – includes all attributes for an object when any attribute changes</span></span></li> |
| <span data-ttu-id="fee96-234">[資料正規化][DataNorm]</span><span class="sxs-lookup"><span data-stu-id="fee96-234">[Data Normalization][DataNorm]</span></span> |<span data-ttu-id="fee96-235">指示同步處理服務先將錨點屬性正規化再提供給指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-235">Instructs the Synchronization Service to normalize anchor attributes before they are provided to scripts.</span></span> |
| <span data-ttu-id="fee96-236">[物件確認][oconf]</span><span class="sxs-lookup"><span data-stu-id="fee96-236">[Object Confirmation][oconf]</span></span> |<span data-ttu-id="fee96-237">在同步處理服務中設定擱置匯入行為。</span><span class="sxs-lookup"><span data-stu-id="fee96-237">Configures the pending import behavior in the Synchronization Service.</span></span> <li><span data-ttu-id="fee96-238">Normal - 預設行為，預期會透過匯入來確認所有匯出的變更</span><span class="sxs-lookup"><span data-stu-id="fee96-238">Normal – default behavior that expects all exported changes to be confirmed via import</span></span></li><li><span data-ttu-id="fee96-239">NoDeleteConfirmation - 當物件被刪除，就不會產生任何擱置中匯入。</span><span class="sxs-lookup"><span data-stu-id="fee96-239">NoDeleteConfirmation – when an object is deleted, there is no pending import generated.</span></span></li><li><span data-ttu-id="fee96-240">NoAddAndDeleteConfirmation - 當物件建立或被刪除，就不會產生任何擱置中匯入。</span><span class="sxs-lookup"><span data-stu-id="fee96-240">NoAddAndDeleteConfirmation – when an object is created or deleted, there is no pending import generated.</span></span></li> |
| <span data-ttu-id="fee96-241">使用 DN 做為錨點</span><span class="sxs-lookup"><span data-stu-id="fee96-241">Use DN as Anchor</span></span> |<span data-ttu-id="fee96-242">如果 [辨別名稱樣式] 設定為 LDAP，則連接器空間的錨點屬性也是辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="fee96-242">If the Distinguished Name Style is set to LDAP, the anchor attribute for the connector space is also the distinguished name.</span></span> |
| <span data-ttu-id="fee96-243">數個連接器並行作業</span><span class="sxs-lookup"><span data-stu-id="fee96-243">Concurrent Operations of Several Connectors</span></span> |<span data-ttu-id="fee96-244">核取時，可以同時執行多個 Windows PowerShell 連接器。</span><span class="sxs-lookup"><span data-stu-id="fee96-244">When checked, multiple Windows PowerShell connectors can run simultaneously.</span></span> |
| <span data-ttu-id="fee96-245">分割數</span><span class="sxs-lookup"><span data-stu-id="fee96-245">Partitions</span></span> |<span data-ttu-id="fee96-246">核取時，連接器可支援多個資料分割和資料分割探索。</span><span class="sxs-lookup"><span data-stu-id="fee96-246">When checked, the connector supports multiple partitions and partition discovery.</span></span> |
| <span data-ttu-id="fee96-247">階層</span><span class="sxs-lookup"><span data-stu-id="fee96-247">Hierarchy</span></span> |<span data-ttu-id="fee96-248">核取時，連接器可支援 LDAP 樣式的階層結構。</span><span class="sxs-lookup"><span data-stu-id="fee96-248">When checked, the connector supports an LDAP style hierarchical structure.</span></span> |
| <span data-ttu-id="fee96-249">啟用匯入</span><span class="sxs-lookup"><span data-stu-id="fee96-249">Enable Import</span></span> |<span data-ttu-id="fee96-250">核取時，連接器會透過匯入指令碼匯入資料。</span><span class="sxs-lookup"><span data-stu-id="fee96-250">When checked, the connector imports data via import scripts.</span></span> |
| <span data-ttu-id="fee96-251">啟用差異匯入</span><span class="sxs-lookup"><span data-stu-id="fee96-251">Enable Delta Import</span></span> |<span data-ttu-id="fee96-252">核取時，連接器可以要求匯入指令碼的差異。</span><span class="sxs-lookup"><span data-stu-id="fee96-252">When checked, the connector can request deltas from the import scripts.</span></span> |
| <span data-ttu-id="fee96-253">啟用匯出</span><span class="sxs-lookup"><span data-stu-id="fee96-253">Enable Export</span></span> |<span data-ttu-id="fee96-254">核取時，連接器會透過匯出指令碼匯出資料。</span><span class="sxs-lookup"><span data-stu-id="fee96-254">When checked, the connector exports data via export scripts.</span></span> |
| <span data-ttu-id="fee96-255">啟用完整匯出</span><span class="sxs-lookup"><span data-stu-id="fee96-255">Enable Full Export</span></span> |<span data-ttu-id="fee96-256">核取時，匯出指令碼可支援匯出整個連接器空間。</span><span class="sxs-lookup"><span data-stu-id="fee96-256">When checked, the export scripts support exporting the entire connector space.</span></span> <span data-ttu-id="fee96-257">若要使用此選項，也必須核取 [啟用匯出]。</span><span class="sxs-lookup"><span data-stu-id="fee96-257">To use this option, Enable Export must also be checked.</span></span> |
| <span data-ttu-id="fee96-258">第一個匯出階段沒有參考值</span><span class="sxs-lookup"><span data-stu-id="fee96-258">No Reference Values In First Export Pass</span></span> |<span data-ttu-id="fee96-259">核取時，會在第二個匯出階段匯出參考屬性。</span><span class="sxs-lookup"><span data-stu-id="fee96-259">When checked, reference attributes are exported in a second export pass.</span></span> |
| <span data-ttu-id="fee96-260">啟用物件重新命名</span><span class="sxs-lookup"><span data-stu-id="fee96-260">Enable Object Rename</span></span> |<span data-ttu-id="fee96-261">核取時，您可以修改辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="fee96-261">When checked, distinguished names can be modified.</span></span> |
| <span data-ttu-id="fee96-262">以刪除新增做為取代</span><span class="sxs-lookup"><span data-stu-id="fee96-262">Delete-Add As Replace</span></span> |<span data-ttu-id="fee96-263">核取時，會將刪除新增作業匯出為單一取代。</span><span class="sxs-lookup"><span data-stu-id="fee96-263">When checked, delete-add operations are exported as a single replacement.</span></span> |
| <span data-ttu-id="fee96-264">啟用密碼作業</span><span class="sxs-lookup"><span data-stu-id="fee96-264">Enable Password Operations</span></span> |<span data-ttu-id="fee96-265">核取時，可支援密碼同步處理指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-265">When checked, password synchronization scripts are supported.</span></span> |
| <span data-ttu-id="fee96-266">在第一個階段啟用匯出密碼</span><span class="sxs-lookup"><span data-stu-id="fee96-266">Enable Export Password in First Pass</span></span> |<span data-ttu-id="fee96-267">核取時，會在建立物件時匯出佈建期間所設定的密碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-267">When checked, passwords set during provisioning are exported when the object is created.</span></span> |

### <a name="global-parameters"></a><span data-ttu-id="fee96-268">全域參數</span><span class="sxs-lookup"><span data-stu-id="fee96-268">Global Parameters</span></span>
<span data-ttu-id="fee96-269">[管理代理程式設計工具] 中的 [全域參數] 索引標籤可讓您設定連接器所執行的 Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-269">The Global Parameters tab in the Management Agent Designer enables you to configure the Windows PowerShell scripts that are run by the connector.</span></span> <span data-ttu-id="fee96-270">您也可以針對 [連線能力] 索引標籤上定義的自訂組態設定設定全域值。</span><span class="sxs-lookup"><span data-stu-id="fee96-270">You can also configure global values for custom configuration settings defined on the Connectivity tab.</span></span>

<span data-ttu-id="fee96-271">**資料分割探索**</span><span class="sxs-lookup"><span data-stu-id="fee96-271">**Partition Discovery**</span></span>  
<span data-ttu-id="fee96-272">資料分割是一個共用結構描述內的個別命名空間。</span><span class="sxs-lookup"><span data-stu-id="fee96-272">A partition is a separate namespace within one shared schema.</span></span> <span data-ttu-id="fee96-273">例如在 Active Directory 中，每個網域就是一個樹系內的資料分割。</span><span class="sxs-lookup"><span data-stu-id="fee96-273">For example, in Active Directory every domain is a partition within one forest.</span></span> <span data-ttu-id="fee96-274">資料分割是匯入和匯出作業的邏輯群組。</span><span class="sxs-lookup"><span data-stu-id="fee96-274">A partition is the logical grouping for import and export operations.</span></span> <span data-ttu-id="fee96-275">匯入和匯出將資料分割做為內容，而且所有作業會在此內容中發生。</span><span class="sxs-lookup"><span data-stu-id="fee96-275">Import and Export have partition as a context and all operations happens in this context.</span></span> <span data-ttu-id="fee96-276">資料分割應該代表 LDAP 中的階層。</span><span class="sxs-lookup"><span data-stu-id="fee96-276">Partitions are supposed to represent a hierarchy in LDAP.</span></span> <span data-ttu-id="fee96-277">匯入作業會使用資料分割的辨別名稱，以確認所有傳回的物件都在資料分割的範圍內。</span><span class="sxs-lookup"><span data-stu-id="fee96-277">The distinguished name of a partition is used in import to verify that all returned objects are within the scope of a partition.</span></span> <span data-ttu-id="fee96-278">在從 Metaverse 佈建到連接器空間的期間，也會使用資料分割辨別名稱來判斷物件應該在匯出期間相關聯的資料分割。</span><span class="sxs-lookup"><span data-stu-id="fee96-278">The partition distinguished name is also used during provisioning from the metaverse to the connector space to determine the partition an object should be associated with during export.</span></span>

<span data-ttu-id="fee96-279">資料分割探索指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-279">The partition discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-280">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-280">Name</span></span> | <span data-ttu-id="fee96-281">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-281">Data Type</span></span> | <span data-ttu-id="fee96-282">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-282">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-283">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-283">ConfigParameters</span></span> |<span data-ttu-id="fee96-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-285">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-285">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-286">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-286">Credential</span></span> |<span data-ttu-id="fee96-287">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-287">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-288">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-288">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="fee96-289">指令碼必須傳回單一[Partition][part]物件或資料分割物件的 List[T] 到管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-289">The script must return a either a single [Partition][part] object or a List[T] of Partition objects to the pipeline.</span></span>

<span data-ttu-id="fee96-290">**階層探索**</span><span class="sxs-lookup"><span data-stu-id="fee96-290">**Hierarchy Discovery**</span></span>  
<span data-ttu-id="fee96-291">只有在辨別名稱樣式功能是 LDAP 時，才會使用階層探索指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-291">The hierarchy discovery script is only used when the Distinguished Name Style capability is LDAP.</span></span> <span data-ttu-id="fee96-292">此指令碼可用來讓您瀏覽並選取一組被視為在匯入和匯出作業範圍之內或之外的容器。</span><span class="sxs-lookup"><span data-stu-id="fee96-292">The script is used to allow you to browse and select a set of containers that is considered in or out of scope for import and export operations.</span></span> <span data-ttu-id="fee96-293">此指令碼只應提供所提供給指令碼之根節點直接子系的節點清單。</span><span class="sxs-lookup"><span data-stu-id="fee96-293">The script should only provide a list of nodes that are direct children of the root node supplied to the script.</span></span>

<span data-ttu-id="fee96-294">階層探索指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-294">The hierarchy discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-295">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-295">Name</span></span> | <span data-ttu-id="fee96-296">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-296">Data Type</span></span> | <span data-ttu-id="fee96-297">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-297">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-298">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-298">ConfigParameters</span></span> |<span data-ttu-id="fee96-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-300">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-300">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-301">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-301">Credential</span></span> |<span data-ttu-id="fee96-302">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-302">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-303">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-303">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-304">ParentNode</span><span class="sxs-lookup"><span data-stu-id="fee96-304">ParentNode</span></span> |<span data-ttu-id="fee96-305">[HierarchyNode][hn]</span><span class="sxs-lookup"><span data-stu-id="fee96-305">[HierarchyNode][hn]</span></span> |<span data-ttu-id="fee96-306">指令碼應將直接子系傳回到之階層的根節點。</span><span class="sxs-lookup"><span data-stu-id="fee96-306">The root node of the hierarchy under which the script should return direct children.</span></span> |

<span data-ttu-id="fee96-307">指令碼必須傳回單一 HierarchyNode 子物件或 HierarchyNode 子物件 List[T] 至管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-307">The script must return a either a single child HierarchyNode object or a List[T] of child HierarchyNode objects to the pipeline.</span></span>

#### <a name="import"></a><span data-ttu-id="fee96-308">Import</span><span class="sxs-lookup"><span data-stu-id="fee96-308">Import</span></span>
<span data-ttu-id="fee96-309">支援匯入作業的連接器必須實作三個指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-309">Connectors that support import operations must implement three scripts.</span></span>

<span data-ttu-id="fee96-310">**開始匯入**</span><span class="sxs-lookup"><span data-stu-id="fee96-310">**Begin Import**</span></span>  
<span data-ttu-id="fee96-311">開始匯入指令碼會在匯入執行步驟開始時執行。</span><span class="sxs-lookup"><span data-stu-id="fee96-311">The begin import script is run at the beginning of an import run step.</span></span> <span data-ttu-id="fee96-312">在此步驟中，您可以建立對來源系統的連線，並進行預備步驟，再從連接的系統匯入資料。</span><span class="sxs-lookup"><span data-stu-id="fee96-312">During this step, you can establish a connection to the source system and do preparatory steps before importing data from the connected system.</span></span>

<span data-ttu-id="fee96-313">開始匯入指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-313">The begin import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-314">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-314">Name</span></span> | <span data-ttu-id="fee96-315">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-315">Data Type</span></span> | <span data-ttu-id="fee96-316">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-316">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-317">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-317">ConfigParameters</span></span> |<span data-ttu-id="fee96-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-319">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-319">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-320">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-320">Credential</span></span> |<span data-ttu-id="fee96-321">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-321">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-322">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-322">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-323">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-323">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="fee96-324">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-324">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="fee96-325">告知指令碼匯入執行的類型 (差異或完整)、資料分割、階層、浮水印及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-325">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="fee96-326">類型</span><span class="sxs-lookup"><span data-stu-id="fee96-326">Types</span></span> |<span data-ttu-id="fee96-327">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="fee96-327">[Schema][schema]</span></span> |<span data-ttu-id="fee96-328">所匯入連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="fee96-328">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="fee96-329">指令碼必須傳回單一 [OpenImportConnectionResults][oicres] 物件到管線中，例如：`Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="fee96-329">The script must return a single [OpenImportConnectionResults][oicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span></span>

<span data-ttu-id="fee96-330">**匯入資料**</span><span class="sxs-lookup"><span data-stu-id="fee96-330">**Import Data**</span></span>  
<span data-ttu-id="fee96-331">連接器會呼叫匯入資料指令碼，直到指令碼指出已沒有資料要匯入為止。</span><span class="sxs-lookup"><span data-stu-id="fee96-331">The import data script is called by the connector until the script indicates that there is no more data to import.</span></span> <span data-ttu-id="fee96-332">Windows PowerShell 連接器的頁面大小為 9,999 個物件。</span><span class="sxs-lookup"><span data-stu-id="fee96-332">The Windows PowerShell connector has a page size of 9,999 objects.</span></span> <span data-ttu-id="fee96-333">如果您的指令碼在匯入時傳回超過 9,999 個物件，您必須支援分頁功能。</span><span class="sxs-lookup"><span data-stu-id="fee96-333">If your script returns more than 9,999 objects for import, you must support paging.</span></span> <span data-ttu-id="fee96-334">連接器會公開自訂資料屬性供您用來儲存浮水印，以便在每次呼叫匯入資料指令碼時，指令碼會繼續從中斷處開始匯入物件。</span><span class="sxs-lookup"><span data-stu-id="fee96-334">The connector exposes a custom data property that you can use to a store a watermark so that each time the import data script is called, your script resumes importing objects where it left off.</span></span>

<span data-ttu-id="fee96-335">匯入資料指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-335">The import data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-336">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-336">Name</span></span> | <span data-ttu-id="fee96-337">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-337">Data Type</span></span> | <span data-ttu-id="fee96-338">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-338">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-339">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-339">ConfigParameters</span></span> |<span data-ttu-id="fee96-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-341">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-341">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-342">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-342">Credential</span></span> |<span data-ttu-id="fee96-343">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-343">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-344">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-344">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-345">GetImportEntriesRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-345">GetImportEntriesRunStep</span></span> |<span data-ttu-id="fee96-346">[ImportRunStep][irs]</span><span class="sxs-lookup"><span data-stu-id="fee96-346">[ImportRunStep][irs]</span></span> |<span data-ttu-id="fee96-347">保留可在分頁匯入與差異匯入期間使用的浮水印 (CustomData)。</span><span class="sxs-lookup"><span data-stu-id="fee96-347">Holds the watermark (CustomData) that can be used during paged imports and delta imports.</span></span> |
| <span data-ttu-id="fee96-348">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-348">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="fee96-349">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-349">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="fee96-350">告知指令碼匯入執行的類型 (差異或完整)、資料分割、階層、浮水印及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-350">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="fee96-351">類型</span><span class="sxs-lookup"><span data-stu-id="fee96-351">Types</span></span> |<span data-ttu-id="fee96-352">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="fee96-352">[Schema][schema]</span></span> |<span data-ttu-id="fee96-353">所匯入連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="fee96-353">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="fee96-354">匯入資料指令碼必須將 List[[CSEntryChange][csec]] 物件寫入到管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-354">The import data script must write a List[[CSEntryChange][csec]] object to the pipeline.</span></span> <span data-ttu-id="fee96-355">這個集合是由代表每個所匯入物件的 CSEntryChange 屬性所組成。</span><span class="sxs-lookup"><span data-stu-id="fee96-355">This collection is composed of CSEntryChange attributes that represent each object being imported.</span></span> <span data-ttu-id="fee96-356">在執行完整匯入時，這個集合應該有一組完整的 CSEntryChange 物件，而這些物件擁有每個物件的所有屬性。</span><span class="sxs-lookup"><span data-stu-id="fee96-356">During a Full Import run, this collection should have a full set of CSEntryChange objects that have all attributes for every object.</span></span> <span data-ttu-id="fee96-357">在差異匯入期間，CSEntryChange 物件應該包含要匯入之每個物件的屬性層級差異，或已變更之物件的完整表示 (取代模式)。</span><span class="sxs-lookup"><span data-stu-id="fee96-357">During a Delta Import, the CSEntryChange object should either contain the attribute level deltas for each object to import, or a complete representation of the objects that have changed (Replace mode).</span></span>

<span data-ttu-id="fee96-358">**結束匯入**</span><span class="sxs-lookup"><span data-stu-id="fee96-358">**End Import**</span></span>  
<span data-ttu-id="fee96-359">在匯入執行結束時，便會執行結束匯入指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-359">At the conclusion of the import run, the End Import script is run.</span></span> <span data-ttu-id="fee96-360">此指令碼應該會執行任何必要的清除工作 (例如中斷系統連線和回應失敗)。</span><span class="sxs-lookup"><span data-stu-id="fee96-360">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="fee96-361">結束匯入指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-361">The end import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-362">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-362">Name</span></span> | <span data-ttu-id="fee96-363">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-363">Data Type</span></span> | <span data-ttu-id="fee96-364">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-364">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-365">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-365">ConfigParameters</span></span> |<span data-ttu-id="fee96-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-367">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-367">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-368">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-368">Credential</span></span> |<span data-ttu-id="fee96-369">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-369">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-370">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-370">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-371">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-371">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="fee96-372">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-372">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="fee96-373">告知指令碼匯入執行的類型 (差異或完整)、資料分割、階層、浮水印及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-373">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="fee96-374">CloseImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-374">CloseImportConnectionRunStep</span></span> |<span data-ttu-id="fee96-375">[CloseImportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-375">[CloseImportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="fee96-376">告知指令碼匯入結束的原因。</span><span class="sxs-lookup"><span data-stu-id="fee96-376">Informs the script about the reason the import was ended.</span></span> |

<span data-ttu-id="fee96-377">指令碼必須傳回單一 [CloseImportConnectionResults][cicres] 物件到管線中，例如：`Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="fee96-377">The script must return a single [CloseImportConnectionResults][cicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span></span>

#### <a name="export"></a><span data-ttu-id="fee96-378">匯出</span><span class="sxs-lookup"><span data-stu-id="fee96-378">Export</span></span>
<span data-ttu-id="fee96-379">與連接器的匯入架構相同，支援匯出的連接器必須實作三個指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-379">Identical to the import architecture of the connector, connectors that support Export must implement three scripts.</span></span>

<span data-ttu-id="fee96-380">**開始匯出**</span><span class="sxs-lookup"><span data-stu-id="fee96-380">**Begin Export**</span></span>  
<span data-ttu-id="fee96-381">開始匯出指令碼會在匯出執行步驟開始時執行。</span><span class="sxs-lookup"><span data-stu-id="fee96-381">The begin export script is run at the beginning of an export run step.</span></span> <span data-ttu-id="fee96-382">在此步驟中，您可以建立對來源系統的連接，並進行預備步驟，再將資料匯出到連接的系統。</span><span class="sxs-lookup"><span data-stu-id="fee96-382">During this step, you can establish a connection to the source system and conduct any preparatory steps before exporting data to the connected system.</span></span>

<span data-ttu-id="fee96-383">開始匯出指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-383">The begin export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-384">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-384">Name</span></span> | <span data-ttu-id="fee96-385">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-385">Data Type</span></span> | <span data-ttu-id="fee96-386">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-386">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-387">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-387">ConfigParameters</span></span> |<span data-ttu-id="fee96-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-389">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-389">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-390">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-390">Credential</span></span> |<span data-ttu-id="fee96-391">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-391">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-392">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-392">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-393">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-393">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="fee96-394">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-394">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="fee96-395">告知指令碼匯出執行的類型 (差異或完整)、資料分割、階層及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-395">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="fee96-396">類型</span><span class="sxs-lookup"><span data-stu-id="fee96-396">Types</span></span> |<span data-ttu-id="fee96-397">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="fee96-397">[Schema][schema]</span></span> |<span data-ttu-id="fee96-398">所匯出連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="fee96-398">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="fee96-399">指令碼不應傳回任何輸出到管線。</span><span class="sxs-lookup"><span data-stu-id="fee96-399">The script should not return any output to the pipeline.</span></span>

<span data-ttu-id="fee96-400">**匯出資料**</span><span class="sxs-lookup"><span data-stu-id="fee96-400">**Export Data**</span></span>  
<span data-ttu-id="fee96-401">同步處理服務一直呼叫匯出資料指令碼，直到處理完所有擱置中的匯出為止。</span><span class="sxs-lookup"><span data-stu-id="fee96-401">The Synchronization Service calls the Export Data script as many times as is necessary to process all pending exports.</span></span> <span data-ttu-id="fee96-402">如果連接器空間有比連接器頁面大小還多的擱置中匯出，則可能會多次呼叫匯出資料指令碼，並可能針對相同的物件呼叫許多次。</span><span class="sxs-lookup"><span data-stu-id="fee96-402">If the connector space has more pending exports than the connector’s page size, the export data script may be called multiple times and possibly multiple times for the same object.</span></span>

<span data-ttu-id="fee96-403">匯出資料指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-403">The export data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-404">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-404">Name</span></span> | <span data-ttu-id="fee96-405">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-405">Data Type</span></span> | <span data-ttu-id="fee96-406">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-406">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-407">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-407">ConfigParameters</span></span> |<span data-ttu-id="fee96-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-409">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-409">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-410">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-410">Credential</span></span> |<span data-ttu-id="fee96-411">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-411">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-412">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-412">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-413">CSEntries</span><span class="sxs-lookup"><span data-stu-id="fee96-413">CSEntries</span></span> |<span data-ttu-id="fee96-414">IList[CSEntryChange][csec]</span><span class="sxs-lookup"><span data-stu-id="fee96-414">IList[CSEntryChange][csec]</span></span> |<span data-ttu-id="fee96-415">具有要在此階段期間處理之擱置中匯出的所有連接器空間物件清單。</span><span class="sxs-lookup"><span data-stu-id="fee96-415">List of all the connector space objects with pending exports to be processed during this pass.</span></span> |
| <span data-ttu-id="fee96-416">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-416">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="fee96-417">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-417">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="fee96-418">告知指令碼匯出執行的類型 (差異或完整)、資料分割、階層及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-418">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="fee96-419">類型</span><span class="sxs-lookup"><span data-stu-id="fee96-419">Types</span></span> |<span data-ttu-id="fee96-420">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="fee96-420">[Schema][schema]</span></span> |<span data-ttu-id="fee96-421">所匯出連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="fee96-421">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="fee96-422">匯出資料指令碼必須傳回 [PutExportEntriesResults][peeres] 物件到管線中。</span><span class="sxs-lookup"><span data-stu-id="fee96-422">The export data script must return a [PutExportEntriesResults][peeres] object to the pipeline.</span></span> <span data-ttu-id="fee96-423">此物件不需要包含每個匯出連接器的結果資訊，除非發生錨點屬性錯誤或變更。</span><span class="sxs-lookup"><span data-stu-id="fee96-423">This object does not need to include result information for each exported connector unless an error or a change to the anchor attribute occurs.</span></span> <span data-ttu-id="fee96-424">例如，將 PutExportEntriesResults 物件傳回至管線： `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span><span class="sxs-lookup"><span data-stu-id="fee96-424">For example, to return a PutExportEntriesResults object to the pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span></span>

<span data-ttu-id="fee96-425">**結束匯出**</span><span class="sxs-lookup"><span data-stu-id="fee96-425">**End Export**</span></span>  
<span data-ttu-id="fee96-426">在匯出執行結束時，便會執行結束匯出指令碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-426">At the conclusion of the export run, the End Export script to run.</span></span> <span data-ttu-id="fee96-427">此指令碼應該會執行任何必要的清除工作 (例如中斷系統連線和回應失敗)。</span><span class="sxs-lookup"><span data-stu-id="fee96-427">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="fee96-428">結束匯出指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-428">The end export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-429">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-429">Name</span></span> | <span data-ttu-id="fee96-430">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-430">Data Type</span></span> | <span data-ttu-id="fee96-431">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-431">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-432">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-432">ConfigParameters</span></span> |<span data-ttu-id="fee96-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-434">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-434">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-435">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-435">Credential</span></span> |<span data-ttu-id="fee96-436">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-436">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-437">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-437">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-438">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-438">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="fee96-439">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-439">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="fee96-440">告知指令碼匯出執行的類型 (差異或完整)、資料分割、階層及預期的頁面大小。</span><span class="sxs-lookup"><span data-stu-id="fee96-440">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="fee96-441">CloseExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="fee96-441">CloseExportConnectionRunStep</span></span> |<span data-ttu-id="fee96-442">[CloseExportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="fee96-442">[CloseExportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="fee96-443">告知指令碼匯出結束的原因。</span><span class="sxs-lookup"><span data-stu-id="fee96-443">Informs the script about the reason the export was ended.</span></span> |

<span data-ttu-id="fee96-444">指令碼不應傳回任何輸出到管線。</span><span class="sxs-lookup"><span data-stu-id="fee96-444">The script should not return any output to the pipeline.</span></span>

#### <a name="password-synchronization"></a><span data-ttu-id="fee96-445">密碼同步處理</span><span class="sxs-lookup"><span data-stu-id="fee96-445">Password Synchronization</span></span>
<span data-ttu-id="fee96-446">Windows PowerShell 連接器可以做為密碼變更/重設的目標。</span><span class="sxs-lookup"><span data-stu-id="fee96-446">Windows PowerShell connectors can be used as a target for password changes/resets.</span></span>

<span data-ttu-id="fee96-447">密碼指令碼會接收連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="fee96-447">The password script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="fee96-448">名稱</span><span class="sxs-lookup"><span data-stu-id="fee96-448">Name</span></span> | <span data-ttu-id="fee96-449">資料類型</span><span class="sxs-lookup"><span data-stu-id="fee96-449">Data Type</span></span> | <span data-ttu-id="fee96-450">說明</span><span class="sxs-lookup"><span data-stu-id="fee96-450">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fee96-451">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="fee96-451">ConfigParameters</span></span> |<span data-ttu-id="fee96-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="fee96-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="fee96-453">連接器組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="fee96-453">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="fee96-454">認證</span><span class="sxs-lookup"><span data-stu-id="fee96-454">Credential</span></span> |<span data-ttu-id="fee96-455">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="fee96-455">[PSCredential][pscred]</span></span> |<span data-ttu-id="fee96-456">包含系統管理員在 [連線] 索引標籤上輸入的任何認證。</span><span class="sxs-lookup"><span data-stu-id="fee96-456">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="fee96-457">資料分割</span><span class="sxs-lookup"><span data-stu-id="fee96-457">Partition</span></span> |<span data-ttu-id="fee96-458">[資料分割][part]</span><span class="sxs-lookup"><span data-stu-id="fee96-458">[Partition][part]</span></span> |<span data-ttu-id="fee96-459">CSEntry 所在的目錄資料分割。</span><span class="sxs-lookup"><span data-stu-id="fee96-459">Directory partition that the CSEntry is in.</span></span> |
| <span data-ttu-id="fee96-460">CSEntry</span><span class="sxs-lookup"><span data-stu-id="fee96-460">CSEntry</span></span> |<span data-ttu-id="fee96-461">[CSEntry][cse]</span><span class="sxs-lookup"><span data-stu-id="fee96-461">[CSEntry][cse]</span></span> |<span data-ttu-id="fee96-462">接收密碼變更或重設之物件的連接器空間項目。</span><span class="sxs-lookup"><span data-stu-id="fee96-462">Connector space entry for the object that is received a password change or reset.</span></span> |
| <span data-ttu-id="fee96-463">OperationType</span><span class="sxs-lookup"><span data-stu-id="fee96-463">OperationType</span></span> |<span data-ttu-id="fee96-464">String</span><span class="sxs-lookup"><span data-stu-id="fee96-464">String</span></span> |<span data-ttu-id="fee96-465">指出作業是重設 (**SetPassword**) 還是變更 (**ChangePassword**)。</span><span class="sxs-lookup"><span data-stu-id="fee96-465">Indicates if the operation is a reset (**SetPassword**) or a change (**ChangePassword**).</span></span> |
| <span data-ttu-id="fee96-466">PasswordOptions</span><span class="sxs-lookup"><span data-stu-id="fee96-466">PasswordOptions</span></span> |<span data-ttu-id="fee96-467">[PasswordOptions][pwdopt]</span><span class="sxs-lookup"><span data-stu-id="fee96-467">[PasswordOptions][pwdopt]</span></span> |<span data-ttu-id="fee96-468">指定想要之密碼重設行為的旗標。</span><span class="sxs-lookup"><span data-stu-id="fee96-468">Flags that specify the intended password reset behavior.</span></span> <span data-ttu-id="fee96-469">只有在 OperationType 是 **SetPassword**時才可以使用此參數。</span><span class="sxs-lookup"><span data-stu-id="fee96-469">This parameter is only available if OperationType is **SetPassword**.</span></span> |
| <span data-ttu-id="fee96-470">OldPassword</span><span class="sxs-lookup"><span data-stu-id="fee96-470">OldPassword</span></span> |<span data-ttu-id="fee96-471">String</span><span class="sxs-lookup"><span data-stu-id="fee96-471">String</span></span> |<span data-ttu-id="fee96-472">填入物件的舊密碼以進行密碼變更。</span><span class="sxs-lookup"><span data-stu-id="fee96-472">Populated with the object’s old password for password changes.</span></span> <span data-ttu-id="fee96-473">只有在 OperationType 是 **ChangePassword**時才可以使用此參數。</span><span class="sxs-lookup"><span data-stu-id="fee96-473">This parameter is only available if OperationType is **ChangePassword**.</span></span> |
| <span data-ttu-id="fee96-474">NewPassword</span><span class="sxs-lookup"><span data-stu-id="fee96-474">NewPassword</span></span> |<span data-ttu-id="fee96-475">String</span><span class="sxs-lookup"><span data-stu-id="fee96-475">String</span></span> |<span data-ttu-id="fee96-476">填入指令碼應該設定的物件新密碼。</span><span class="sxs-lookup"><span data-stu-id="fee96-476">Populated with the object’s new password that the script should set.</span></span> |

<span data-ttu-id="fee96-477">密碼指令碼預期不會傳回任何結果到 Windows PowerShell 管線。</span><span class="sxs-lookup"><span data-stu-id="fee96-477">The password script is not expected to return any results to the Windows PowerShell pipeline.</span></span> <span data-ttu-id="fee96-478">如果密碼指令碼中發生錯誤，指令碼應該會擲回下列其中一個例外狀況，以告知同步處理服務此問題：</span><span class="sxs-lookup"><span data-stu-id="fee96-478">If an error occurs in the password script, the script should throw one of the following exceptions to inform the Synchronization Service about the problem:</span></span>

* <span data-ttu-id="fee96-479">[PasswordPolicyViolationException][pwdex1] – 如果密碼不符合所連接系統中的密碼原則便會擲回。</span><span class="sxs-lookup"><span data-stu-id="fee96-479">[PasswordPolicyViolationException][pwdex1] – Thrown if the password does not meet the password policy in the connected system.</span></span>
* <span data-ttu-id="fee96-480">[PasswordIllFormedException][pwdex2] – 所連接系統不接受密碼時便會擲回。</span><span class="sxs-lookup"><span data-stu-id="fee96-480">[PasswordIllFormedException][pwdex2] – Thrown if the password is not acceptable for the connected system.</span></span>
* <span data-ttu-id="fee96-481">[PasswordExtension][pwdex3] – 密碼指令碼中發生其他所有錯誤時便會擲回。</span><span class="sxs-lookup"><span data-stu-id="fee96-481">[PasswordExtension][pwdex3] – Thrown for all other errors in the password script.</span></span>

## <a name="sample-connectors"></a><span data-ttu-id="fee96-482">範例連接器</span><span class="sxs-lookup"><span data-stu-id="fee96-482">Sample Connectors</span></span>
<span data-ttu-id="fee96-483">如需可用範例連接器的完整概觀，請參閱 [Windows PowerShell 連接器範例連接器集合][samp]。</span><span class="sxs-lookup"><span data-stu-id="fee96-483">For a complete overview of the available sample connectors, see [Windows PowerShell Connector Sample Connector Collection][samp].</span></span>

## <a name="other-notes"></a><span data-ttu-id="fee96-484">其他注意事項</span><span class="sxs-lookup"><span data-stu-id="fee96-484">Other notes</span></span>
### <a name="additional-configuration-for-impersonation"></a><span data-ttu-id="fee96-485">模擬的其他組態</span><span class="sxs-lookup"><span data-stu-id="fee96-485">Additional Configuration for Impersonation</span></span>
<span data-ttu-id="fee96-486">對模擬的使用者授與同步處理服務伺服器上的下列權限：</span><span class="sxs-lookup"><span data-stu-id="fee96-486">Grant the user that is impersonated the following permissions on the Synchronization Service server:</span></span>

<span data-ttu-id="fee96-487">下列登錄機碼的讀取權限：</span><span class="sxs-lookup"><span data-stu-id="fee96-487">Read access to the following registry keys:</span></span>

* <span data-ttu-id="fee96-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span><span class="sxs-lookup"><span data-stu-id="fee96-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span></span>
* <span data-ttu-id="fee96-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span><span class="sxs-lookup"><span data-stu-id="fee96-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span></span>

<span data-ttu-id="fee96-490">若要判斷同步處理服務之服務帳戶的安全性識別碼 (SID)，請執行下列 PowerShell 命令：</span><span class="sxs-lookup"><span data-stu-id="fee96-490">To determine the Security Identifier (SID) of the Synchronization Service service account, run the following PowerShell commands:</span></span>

```
$account = New-Object System.Security.Principal.NTAccount "<domain>\<username>"
$account.Translate([System.Security.Principal.SecurityIdentifier]).Value
```

<span data-ttu-id="fee96-491">下列檔案系統資料夾的讀取權限：</span><span class="sxs-lookup"><span data-stu-id="fee96-491">Read access to the following file system folders:</span></span>

* <span data-ttu-id="fee96-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span><span class="sxs-lookup"><span data-stu-id="fee96-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span></span>
* <span data-ttu-id="fee96-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span><span class="sxs-lookup"><span data-stu-id="fee96-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span></span>
* <span data-ttu-id="fee96-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span><span class="sxs-lookup"><span data-stu-id="fee96-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span></span>

<span data-ttu-id="fee96-495">用 Windows PowerShell 連接器的名稱替換 {ConnectorName} 預留位置。</span><span class="sxs-lookup"><span data-stu-id="fee96-495">Substitute the name of the Windows PowerShell connector for the {ConnectorName} placeholder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="fee96-496">疑難排解</span><span class="sxs-lookup"><span data-stu-id="fee96-496">Troubleshooting</span></span>
* <span data-ttu-id="fee96-497">如需如何啟用記錄來疑難排解連接器的資訊，請參閱 [如何啟用連接器的 ETW 追蹤](http://go.microsoft.com/fwlink/?LinkId=335731)。</span><span class="sxs-lookup"><span data-stu-id="fee96-497">For information on how to enable logging to troubleshoot the connector, see the [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span></span>

<!--Reference style links - using these makes the source content way more readable than using inline links-->
[cpp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameterpage.aspx
[keyk]: https://msdn.microsoft.com/library/ms132438.aspx
[cp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameter.aspx
[pscred]: https://msdn.microsoft.com/library/system.management.automation.pscredential.aspx
[schema]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schema.aspx
[schemaT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schematype.aspx
[schemaA]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schemaattribute.aspx
[dnstyle]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.madistinguishednamestyle.aspx
[exportT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maexporttype.aspx
[DataNorm]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.manormalizations.aspx
[oconf]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maobjectconfirmation.aspx
[dw]: https://msdn.microsoft.com/library/windows/desktop/aa378184.aspx
[part]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.partition.aspx
[hn]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.hierarchynode.aspx
[oicrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionrunstep.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[oicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionresults.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[cicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeimportconnectionresults.aspx
[oecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openexportconnectionrunstep.aspx
[irs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.importrunstep.aspx
[cse]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentry.aspx
[csec]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentrychange.aspx
[peeres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.putexportentriesresults.aspx
[pwdopt]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordoptions.aspx
[pwdex1]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordpolicyviolationexception.aspx
[pwdex2]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordillformedexception.aspx
[pwdex3]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordextensionexception.aspx
[samp]: http://go.microsoft.com/fwlink/?LinkId=394291
