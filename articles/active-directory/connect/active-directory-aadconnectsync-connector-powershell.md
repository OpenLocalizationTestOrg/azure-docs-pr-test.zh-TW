---
title: "aaaPowerShell 連接器 |Microsoft 文件"
description: "本文說明如何 tooconfigure Microsoft Windows PowerShell 連接器。"
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 6dba8e34-a874-4ff0-90bc-bd2b0a4199b5
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 44ff6b1f53283000b72e15f861e0f86c21afe12b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="windows-powershell-connector-technical-reference"></a><span data-ttu-id="6e077-103">Windows PowerShell 連接器技術參考</span><span class="sxs-lookup"><span data-stu-id="6e077-103">Windows PowerShell Connector technical reference</span></span>
<span data-ttu-id="6e077-104">本文描述 Windows PowerShell 連接器 hello。</span><span class="sxs-lookup"><span data-stu-id="6e077-104">This article describes hello Windows PowerShell Connector.</span></span> <span data-ttu-id="6e077-105">hello 文章適用 toohello 下列產品：</span><span class="sxs-lookup"><span data-stu-id="6e077-105">hello article applies toohello following products:</span></span>

* <span data-ttu-id="6e077-106">Microsoft Identity Manager 2016 (MIM2016)</span><span class="sxs-lookup"><span data-stu-id="6e077-106">Microsoft Identity Manager 2016 (MIM2016)</span></span>
* <span data-ttu-id="6e077-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span><span class="sxs-lookup"><span data-stu-id="6e077-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span></span>
  * <span data-ttu-id="6e077-108">必須使用 Hotfix 4.1.3671.0 或更新版本 [KB3092178](https://support.microsoft.com/kb/3092178)。</span><span class="sxs-lookup"><span data-stu-id="6e077-108">Must use hotfix 4.1.3671.0 or later [KB3092178](https://support.microsoft.com/kb/3092178).</span></span>

<span data-ttu-id="6e077-109">MIM2016 和 FIM2010R2，hello 連接器可做為從 hello 下載[Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495)。</span><span class="sxs-lookup"><span data-stu-id="6e077-109">For MIM2016 and FIM2010R2, hello Connector is available as a download from hello [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495).</span></span>

## <a name="overview-of-hello-powershell-connector"></a><span data-ttu-id="6e077-110">Hello PowerShell 連接器的概觀</span><span class="sxs-lookup"><span data-stu-id="6e077-110">Overview of hello PowerShell Connector</span></span>
<span data-ttu-id="6e077-111">hello PowerShell 連接器可讓您與外部系統提供 Windows PowerShell 型的應用程式開發介面 toointegrate hello 同步處理服務。</span><span class="sxs-lookup"><span data-stu-id="6e077-111">hello PowerShell Connector enables you toointegrate hello synchronization service with external systems that offer Windows PowerShell based APIs.</span></span> <span data-ttu-id="6e077-112">2 (ECMA2) framework 與 Windows PowerShell，hello 連接器提供的 hello 呼叫基礎可延伸的連線的管理代理程式的 hello 功能之間的橋樑。</span><span class="sxs-lookup"><span data-stu-id="6e077-112">hello connector provides a bridge between hello capabilities of hello call-based extensible connectivity management agent 2 (ECMA2) framework and Windows PowerShell.</span></span> <span data-ttu-id="6e077-113">如需 hello ECMA 架構的詳細資訊，請參閱 hello[可延伸的連線能力 2.2 管理代理程式參考](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e077-113">For more information about hello ECMA framework, see hello [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="6e077-114">必要條件</span><span class="sxs-lookup"><span data-stu-id="6e077-114">Prerequisites</span></span>
<span data-ttu-id="6e077-115">使用 hello 連接器之前，請確定您擁有 hello 同步處理伺服器 hello 下列項目：</span><span class="sxs-lookup"><span data-stu-id="6e077-115">Before you use hello Connector, make sure you have hello following on hello synchronization server:</span></span>

* <span data-ttu-id="6e077-116">Microsoft .NET 4.5.2 Framework 或更新版本</span><span class="sxs-lookup"><span data-stu-id="6e077-116">Microsoft .NET 4.5.2 Framework or later</span></span>
* <span data-ttu-id="6e077-117">Windows PowerShell 2.0、3.0 或 4.0</span><span class="sxs-lookup"><span data-stu-id="6e077-117">Windows PowerShell 2.0, 3.0, or 4.0</span></span>

<span data-ttu-id="6e077-118">hello hello 同步處理服務的伺服器上的執行原則必須設定的 tooallow hello 連接器 toorun Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-118">hello execution policy on hello Synchronization Service server must be configured tooallow hello connector toorun Windows PowerShell scripts.</span></span> <span data-ttu-id="6e077-119">除非 hello 指令碼 hello 連接器執行經過數位簽署，以執行此命令設定 hello 執行原則：</span><span class="sxs-lookup"><span data-stu-id="6e077-119">Unless hello scripts hello connector runs are digitally signed, configure hello execution policy by running this command:</span></span>  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`

## <a name="create-a-new-connector"></a><span data-ttu-id="6e077-120">建立新的連接器</span><span class="sxs-lookup"><span data-stu-id="6e077-120">Create a new Connector</span></span>
<span data-ttu-id="6e077-121">toocreate hello 同步處理服務中的 Windows PowerShell 連接器，您必須提供一系列的 Windows PowerShell 指令碼執行 hello hello 同步處理服務所要求的步驟。</span><span class="sxs-lookup"><span data-stu-id="6e077-121">toocreate a Windows PowerShell connector in hello synchronization service, you must provide a series of Windows PowerShell scripts that execute hello steps requested by hello synchronization service.</span></span> <span data-ttu-id="6e077-122">根據 hello 資料來源連接所需的 tooand hello 功能，您必須實作的 hello 指令碼而異。</span><span class="sxs-lookup"><span data-stu-id="6e077-122">Depending on hello data source you connect tooand hello functionality you require, hello scripts you must implement varies.</span></span> <span data-ttu-id="6e077-123">本節將概述 hello 指令碼，可以實作和它們所需的每個。</span><span class="sxs-lookup"><span data-stu-id="6e077-123">This section outlines each of hello scripts that can be implemented and when they are required.</span></span>

<span data-ttu-id="6e077-124">hello 連接器的 Windows PowerShell 設計 toostore 每個 hello hello 同步處理服務資料庫內的指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-124">hello Windows PowerShell connector is designed toostore each of hello scripts inside hello Synchronization Service database.</span></span> <span data-ttu-id="6e077-125">雖然可能 toorun 指令碼儲存在 hello 檔案系統上，它是直接在 toohello 連接器組態中的每個指令碼更容易 tooinsert hello 主體。</span><span class="sxs-lookup"><span data-stu-id="6e077-125">While it is possible toorun scripts that are stored on hello file system, it is easier tooinsert hello body of each script directly in toohello connector’s configuration.</span></span>

<span data-ttu-id="6e077-126">tooCreate PowerShell 連接器，請在**同步處理服務**選取**管理代理程式**和**建立**。</span><span class="sxs-lookup"><span data-stu-id="6e077-126">tooCreate a PowerShell connector, in **Synchronization Service** select **Management Agent** and **Create**.</span></span> <span data-ttu-id="6e077-127">選取 hello **PowerShell (Microsoft)**連接器。</span><span class="sxs-lookup"><span data-stu-id="6e077-127">Select hello **PowerShell (Microsoft)** Connector.</span></span>

![建立連接器](./media/active-directory-aadconnectsync-connector-powershell/createconnector.png)

### <a name="connectivity"></a><span data-ttu-id="6e077-129">連線能力</span><span class="sxs-lookup"><span data-stu-id="6e077-129">Connectivity</span></span>
<span data-ttu-id="6e077-130">提供用於連接 tooa 遠端系統的組態參數。</span><span class="sxs-lookup"><span data-stu-id="6e077-130">Supply configuration parameters for connecting tooa remote system.</span></span> <span data-ttu-id="6e077-131">這些值會安全地儲存由 hello 同步處理服務，並執行 hello 連接器時進行可用 tooyour Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-131">These values are securely stored by hello Synchronization Service and made available tooyour Windows PowerShell scripts when hello connector is run.</span></span>

![連線能力](./media/active-directory-aadconnectsync-connector-powershell/connectivity.png)

<span data-ttu-id="6e077-133">您可以設定下列連線參數的 hello:</span><span class="sxs-lookup"><span data-stu-id="6e077-133">You can configure hello following Connectivity parameters:</span></span>

<span data-ttu-id="6e077-134">**連線能力**</span><span class="sxs-lookup"><span data-stu-id="6e077-134">**Connectivity**</span></span>

| <span data-ttu-id="6e077-135">參數</span><span class="sxs-lookup"><span data-stu-id="6e077-135">Parameter</span></span> | <span data-ttu-id="6e077-136">預設值</span><span class="sxs-lookup"><span data-stu-id="6e077-136">Default Value</span></span> | <span data-ttu-id="6e077-137">目的</span><span class="sxs-lookup"><span data-stu-id="6e077-137">Purpose</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-138">伺服器</span><span class="sxs-lookup"><span data-stu-id="6e077-138">Server</span></span> |<Blank> |<span data-ttu-id="6e077-139">Hello 連接器的伺服器名稱應該連接到。</span><span class="sxs-lookup"><span data-stu-id="6e077-139">Server name that hello connector should connect to.</span></span> |
| <span data-ttu-id="6e077-140">網域</span><span class="sxs-lookup"><span data-stu-id="6e077-140">Domain</span></span> |<Blank> |<span data-ttu-id="6e077-141">Hello 認證 toostore hello 連接器執行時使用的網域。</span><span class="sxs-lookup"><span data-stu-id="6e077-141">Domain of hello credential toostore for use when hello connector is run.</span></span> |
| <span data-ttu-id="6e077-142">User</span><span class="sxs-lookup"><span data-stu-id="6e077-142">User</span></span> |<Blank> |<span data-ttu-id="6e077-143">Hello 認證 toostore hello 連接器執行時使用的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="6e077-143">Username of hello credential toostore for use when hello connector is run.</span></span> |
| <span data-ttu-id="6e077-144">密碼</span><span class="sxs-lookup"><span data-stu-id="6e077-144">Password</span></span> |<Blank> |<span data-ttu-id="6e077-145">Hello 認證 toostore hello 連接器執行時使用的密碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-145">Password of hello credential toostore for use when hello connector is run.</span></span> |
| <span data-ttu-id="6e077-146">模擬連接器帳戶</span><span class="sxs-lookup"><span data-stu-id="6e077-146">Impersonate Connector Account</span></span> |<span data-ttu-id="6e077-147">False</span><span class="sxs-lookup"><span data-stu-id="6e077-147">False</span></span> |<span data-ttu-id="6e077-148">若為 true，hello 同步處理服務會提供 hello 認證 hello 內容中執行 hello Windows PowerShell 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-148">When true, hello synchronization service runs hello Windows PowerShell scripts in hello context of hello credentials supplied.</span></span> <span data-ttu-id="6e077-149">如果可能的話，我們建議的 hello **$Credentials**參數會傳遞 tooeach 而不是模擬使用指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-149">When possible, it is recommended that hello **$Credentials** parameter is passed tooeach script is used instead of impersonation.</span></span> <span data-ttu-id="6e077-150">如需其他權限的詳細資訊所需 toouse 此選項，請參閱 <<c0> [ 額外的設定為模擬](#additional-configuration-for-impersonation)。</span><span class="sxs-lookup"><span data-stu-id="6e077-150">For more information on additional permissions that are required toouse this option, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="6e077-151">模擬時載入使用者設定檔</span><span class="sxs-lookup"><span data-stu-id="6e077-151">Load User Profile When Impersonating</span></span> |<span data-ttu-id="6e077-152">False</span><span class="sxs-lookup"><span data-stu-id="6e077-152">False</span></span> |<span data-ttu-id="6e077-153">模擬期間，會指示 Windows tooload hello 使用者設定檔的 hello 連接器的認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-153">Instructs Windows tooload hello user profile of hello connector’s credentials during impersonation.</span></span> <span data-ttu-id="6e077-154">如果 hello 模擬的使用者有漫遊設定檔，hello 連接器不載入 hello 漫遊設定檔。</span><span class="sxs-lookup"><span data-stu-id="6e077-154">If hello impersonated user has a roaming profile, hello connector does not load hello roaming profile.</span></span> <span data-ttu-id="6e077-155">如需其他權限的詳細資訊所需 toouse 這個參數，請參閱 <<c0> [ 額外的設定為模擬](#additional-configuration-for-impersonation)。</span><span class="sxs-lookup"><span data-stu-id="6e077-155">For more information on additional permissions that are required toouse this parameter, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="6e077-156">模擬時的登入類型</span><span class="sxs-lookup"><span data-stu-id="6e077-156">Logon Type When Impersonating</span></span> |<span data-ttu-id="6e077-157">None</span><span class="sxs-lookup"><span data-stu-id="6e077-157">None</span></span> |<span data-ttu-id="6e077-158">模擬期間的登入類型。</span><span class="sxs-lookup"><span data-stu-id="6e077-158">Logon type during impersonation.</span></span> <span data-ttu-id="6e077-159">如需詳細資訊，請參閱 hello [dwLogonType] [ dw]文件。</span><span class="sxs-lookup"><span data-stu-id="6e077-159">For more information, see hello [dwLogonType][dw] documentation.</span></span> |
| <span data-ttu-id="6e077-160">僅限已簽署的指令碼</span><span class="sxs-lookup"><span data-stu-id="6e077-160">Signed Scripts Only</span></span> |<span data-ttu-id="6e077-161">False</span><span class="sxs-lookup"><span data-stu-id="6e077-161">False</span></span> |<span data-ttu-id="6e077-162">如果為 true，hello Windows PowerShell 連接器會驗證每個指令碼具有有效的數位簽章。</span><span class="sxs-lookup"><span data-stu-id="6e077-162">If true, hello Windows PowerShell connector validates that each script has a valid digital signature.</span></span> <span data-ttu-id="6e077-163">如果為 false，請確定 hello 同步處理服務伺服器的 Windows PowerShell 執行原則 RemoteSigned 或不受限制。</span><span class="sxs-lookup"><span data-stu-id="6e077-163">If false, ensure that hello Synchronization Service server’s Windows PowerShell execution policy is RemoteSigned or Unrestricted.</span></span> |

<span data-ttu-id="6e077-164">**通用模組**</span><span class="sxs-lookup"><span data-stu-id="6e077-164">**Common Module**</span></span>  
<span data-ttu-id="6e077-165">hello 連接器可讓您共用的 Windows PowerShell 模組 toostore hello 組態中。</span><span class="sxs-lookup"><span data-stu-id="6e077-165">hello connector allows you toostore a shared Windows PowerShell module in hello configuration.</span></span> <span data-ttu-id="6e077-166">Hello 連接器執行的指令碼，hello 模組是 Windows PowerShell 擷取 toohello 檔案系統，可以根據每個指令碼匯入。</span><span class="sxs-lookup"><span data-stu-id="6e077-166">When hello connector runs a script, hello Windows PowerShell module is extracted toohello file system so that it can be imported by each script.</span></span>

<span data-ttu-id="6e077-167">匯入、 匯出和密碼同步處理的指令碼，hello 通用模組是會擷取的 toohello 連接器 MAData 資料夾。</span><span class="sxs-lookup"><span data-stu-id="6e077-167">For Import, Export, and Password Synchronization scripts, hello common module is extracted toohello connector’s MAData folder.</span></span> <span data-ttu-id="6e077-168">結構描述、 驗證、 階層和資料分割探索指令碼，hello 通用模組是擷取的 toohello %TEMP%資料夾。</span><span class="sxs-lookup"><span data-stu-id="6e077-168">For Schema, Validation, Hierarchy, and Partition discovery scripts, hello common module is extracted toohello %TEMP% folder.</span></span> <span data-ttu-id="6e077-169">在這兩種情況下，hello 擷取通用模組，根據 toohello 一般模組的指令碼名稱設定名為指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-169">In both cases, hello extracted Common Module script is named according toohello Common Module Script Name setting.</span></span>

<span data-ttu-id="6e077-170">tooload 模組呼叫 FIMPowerShellConnectorModule.psm1 hello MAData 資料夾，請使用下列陳述式的 hello:`Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="6e077-170">tooload a module called FIMPowerShellConnectorModule.psm1 from hello MAData folder, use hello following statement: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="6e077-171">tooload 模組呼叫 FIMPowerShellConnectorModule.psm1 從 hello %TEMP%資料夾，請使用下列陳述式的 hello:`Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="6e077-171">tooload a module called FIMPowerShellConnectorModule.psm1 from hello %TEMP% folder, use hello following statement: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="6e077-172">**參數驗證**</span><span class="sxs-lookup"><span data-stu-id="6e077-172">**Parameter Validation**</span></span>  
<span data-ttu-id="6e077-173">hello 驗證指令碼是選擇性的 Windows PowerShell 指令碼可以使用的 tooensure hello 系統管理員所提供的連接器組態參數都有效。</span><span class="sxs-lookup"><span data-stu-id="6e077-173">hello Validation Script is an optional Windows PowerShell script that can be used tooensure that connector configuration parameters supplied by hello administrator are valid.</span></span> <span data-ttu-id="6e077-174">驗證伺服器、 連接認證及連線參數 hello 驗證指令碼的常見使用方式。</span><span class="sxs-lookup"><span data-stu-id="6e077-174">Validating server, connection credentials, and connectivity parameters are common usages of hello validation script.</span></span> <span data-ttu-id="6e077-175">hello 驗證指令碼會呼叫 hello 下列索引標籤和對話方塊修改之後：</span><span class="sxs-lookup"><span data-stu-id="6e077-175">hello validation script is called after hello following tabs and dialogs are modified:</span></span>

* <span data-ttu-id="6e077-176">連線能力</span><span class="sxs-lookup"><span data-stu-id="6e077-176">Connectivity</span></span>
* <span data-ttu-id="6e077-177">全域參數</span><span class="sxs-lookup"><span data-stu-id="6e077-177">Global Parameters</span></span>
* <span data-ttu-id="6e077-178">資料分割組態</span><span class="sxs-lookup"><span data-stu-id="6e077-178">Partition Configuration</span></span>

<span data-ttu-id="6e077-179">hello 驗證指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-179">hello validation script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-180">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-180">Name</span></span> | <span data-ttu-id="6e077-181">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-181">Data Type</span></span> | <span data-ttu-id="6e077-182">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-182">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-183">ConfigParameterPage</span><span class="sxs-lookup"><span data-stu-id="6e077-183">ConfigParameterPage</span></span> |<span data-ttu-id="6e077-184">[ConfigParameterPage][cpp]</span><span class="sxs-lookup"><span data-stu-id="6e077-184">[ConfigParameterPage][cpp]</span></span> |<span data-ttu-id="6e077-185">hello 設定 索引標籤或對話方塊觸發 hello 驗證要求。</span><span class="sxs-lookup"><span data-stu-id="6e077-185">hello configuration tab or dialog that triggered hello validation request.</span></span> |
| <span data-ttu-id="6e077-186">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-186">ConfigParameters</span></span> |<span data-ttu-id="6e077-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-188">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-188">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-189">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-189">Credential</span></span> |<span data-ttu-id="6e077-190">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-190">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-191">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-191">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |

<span data-ttu-id="6e077-192">hello 驗證指令碼應該會傳回單一 ParameterValidationResult 物件 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-192">hello validation script should return a single ParameterValidationResult object toohello pipeline.</span></span>

<span data-ttu-id="6e077-193">**結構描述探索**</span><span class="sxs-lookup"><span data-stu-id="6e077-193">**Schema Discovery**</span></span>  
<span data-ttu-id="6e077-194">hello 結構描述探索指令碼是必要的。</span><span class="sxs-lookup"><span data-stu-id="6e077-194">hello Schema Discovery script is mandatory.</span></span> <span data-ttu-id="6e077-195">此指令碼傳回 hello 物件型別、 屬性和屬性條件約束設定屬性流程規則時，同步處理服務會使用該 hello。</span><span class="sxs-lookup"><span data-stu-id="6e077-195">This script returns hello object types, attributes, and attribute constraints that hello Synchronization Service uses when configuring attribute flow rules.</span></span> <span data-ttu-id="6e077-196">hello 結構描述探索指令碼執行連接器的建立期間，並於其中填入 hello 連接器的結構描述。</span><span class="sxs-lookup"><span data-stu-id="6e077-196">hello Schema Discovery script is run during connector creation and populates hello connector’s schema.</span></span> <span data-ttu-id="6e077-197">它也會使用 hello hello 同步處理服務管理員中的重新整理結構描述動作。</span><span class="sxs-lookup"><span data-stu-id="6e077-197">It is also used by hello Refresh Schema action in hello Synchronization Service Manager.</span></span>

<span data-ttu-id="6e077-198">hello 結構描述探索指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-198">hello schema discovery script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-199">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-199">Name</span></span> | <span data-ttu-id="6e077-200">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-200">Data Type</span></span> | <span data-ttu-id="6e077-201">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-201">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-202">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-202">ConfigParameters</span></span> |<span data-ttu-id="6e077-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-204">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-204">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-205">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-205">Credential</span></span> |<span data-ttu-id="6e077-206">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-206">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-207">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-207">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |

<span data-ttu-id="6e077-208">hello 指令碼必須傳回單一[結構描述][ schema]物件 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-208">hello script must return a single [Schema][schema] object toohello pipeline.</span></span> <span data-ttu-id="6e077-209">hello 結構描述物件組成[SchemaType] [ schemaT]代表物件類型的物件 (例如： 使用者和群組)。</span><span class="sxs-lookup"><span data-stu-id="6e077-209">hello Schema object is composed of [SchemaType][schemaT] objects that represent object types (for example: users and groups).</span></span> <span data-ttu-id="6e077-210">hello SchemaType 物件保存的集合[SchemaAttribute] [ schemaA]代表 hello 屬性的物件 (例如： 名字、 姓氏和郵寄地址) 的 hello 型別。</span><span class="sxs-lookup"><span data-stu-id="6e077-210">hello SchemaType object holds a collection of [SchemaAttribute][schemaA] objects that represent hello attributes (for example: given name, surname, and postal address) of hello type.</span></span>

<span data-ttu-id="6e077-211">**其他參數**</span><span class="sxs-lookup"><span data-stu-id="6e077-211">**Additional Parameters**</span></span>  
<span data-ttu-id="6e077-212">此外 toohello 標準組態設定，您可以定義額外的自訂組態設定的特定 toohello hello 連接器執行個體。</span><span class="sxs-lookup"><span data-stu-id="6e077-212">In addition toohello standard configuration settings, you can define additional custom configuration settings that are specific toohello instance of hello Connector.</span></span> <span data-ttu-id="6e077-213">您可以在 hello 連接器，分割區，指定這些參數或層級執行的步驟，並從 hello 相關的 Windows PowerShell 指令碼存取。</span><span class="sxs-lookup"><span data-stu-id="6e077-213">These parameters can be specified at hello connector, partition, or run step levels and accessed from hello relevant Windows PowerShell script.</span></span> <span data-ttu-id="6e077-214">自訂組態設定可以在 hello 同步處理服務資料庫中的純文字格式儲存，或可能會進行加密。</span><span class="sxs-lookup"><span data-stu-id="6e077-214">Custom configuration settings can be stored in hello Synchronization Service database in plain text format or they may be encrypted.</span></span> <span data-ttu-id="6e077-215">hello 同步處理服務會自動加密，並解密所需安全的組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e077-215">hello Synchronization Service automatically encrypts and decrypts secure configuration settings when required.</span></span>

<span data-ttu-id="6e077-216">每個參數以逗號 （，） 的個別 hello 名稱 toospecify 自訂組態設定。</span><span class="sxs-lookup"><span data-stu-id="6e077-216">toospecify custom configuration settings, separate hello name of each parameter with a comma ( , ).</span></span>

<span data-ttu-id="6e077-217">從指令碼 tooaccess 自訂組態設定，您必須尾碼 hello 名稱以底線 ( \_ ) 和 hello hello 參數 （Global、 資料分割或 RunStep） 範圍。</span><span class="sxs-lookup"><span data-stu-id="6e077-217">tooaccess custom configuration settings from a script, you must suffix hello name with an underscore ( \_ ) and hello scope of hello parameter (Global, Partition, or RunStep).</span></span> <span data-ttu-id="6e077-218">例如，tooaccess hello 全域的 FileName 參數，請使用此程式碼片段：`$ConfigurationParameters["FileName_Global"].Value`</span><span class="sxs-lookup"><span data-stu-id="6e077-218">For example, tooaccess hello Global FileName parameter, use this code snippet: `$ConfigurationParameters["FileName_Global"].Value`</span></span>

### <a name="capabilities"></a><span data-ttu-id="6e077-219">功能</span><span class="sxs-lookup"><span data-stu-id="6e077-219">Capabilities</span></span>
<span data-ttu-id="6e077-220">hello hello 管理代理程式的設計工具的 [功能] 索引標籤定義 hello 行為和 hello 連接器功能。</span><span class="sxs-lookup"><span data-stu-id="6e077-220">hello capabilities tab of hello Management Agent Designer defines hello behavior and functionality of hello connector.</span></span> <span data-ttu-id="6e077-221">建立 hello 連接器後，無法修改此索引標籤上所做的 hello 選擇。</span><span class="sxs-lookup"><span data-stu-id="6e077-221">hello selections made on this tab cannot be modified when hello connector has been created.</span></span> <span data-ttu-id="6e077-222">下表列出 hello 功能設定。</span><span class="sxs-lookup"><span data-stu-id="6e077-222">This table lists hello capability settings.</span></span>

![功能](./media/active-directory-aadconnectsync-connector-powershell/capabilities.png)

| <span data-ttu-id="6e077-224">功能</span><span class="sxs-lookup"><span data-stu-id="6e077-224">Capability</span></span> | <span data-ttu-id="6e077-225">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-225">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6e077-226">[辨別名稱樣式][dnstyle]</span><span class="sxs-lookup"><span data-stu-id="6e077-226">[Distinguished Name Style][dnstyle]</span></span> |<span data-ttu-id="6e077-227">指出如果 hello 連接器支援的辨別的名稱，並因此，項目設定樣式。</span><span class="sxs-lookup"><span data-stu-id="6e077-227">Indicates if hello connector supports distinguished names and if so, what style.</span></span> |
| <span data-ttu-id="6e077-228">[匯出類型][exportT]</span><span class="sxs-lookup"><span data-stu-id="6e077-228">[Export Type][exportT]</span></span> |<span data-ttu-id="6e077-229">判斷 hello 會呈現 toohello 匯出指令碼的物件類型。</span><span class="sxs-lookup"><span data-stu-id="6e077-229">Determines hello type of objects that are presented toohello Export script.</span></span> <li><span data-ttu-id="6e077-230">AttributeReplace – 包含 hello 多重值屬性的值一組完整 hello 屬性變更時。</span><span class="sxs-lookup"><span data-stu-id="6e077-230">AttributeReplace – includes hello full set of values for a multi-valued attribute when hello attribute changes.</span></span></li><li><span data-ttu-id="6e077-231">AttributeUpdate – 包括只有 hello 差異 tooa 多重值的屬性 hello 屬性變更時。</span><span class="sxs-lookup"><span data-stu-id="6e077-231">AttributeUpdate – includes only hello deltas tooa multi-valued attribute when hello attribute changes.</span></span></li><li><span data-ttu-id="6e077-232">MultivaluedReferenceAttributeUpdate - 包含非參考多重值屬性一組完整的值，以及僅多重值參考屬性的差異。</span><span class="sxs-lookup"><span data-stu-id="6e077-232">MultivaluedReferenceAttributeUpdate - includes a full set of values for non-reference multi-valued attributes and only deltas for multi-valued reference attributes.</span></span></li><li><span data-ttu-id="6e077-233">ObjectReplace - 包含屬性變更時物件的所有屬性</span><span class="sxs-lookup"><span data-stu-id="6e077-233">ObjectReplace – includes all attributes for an object when any attribute changes</span></span></li> |
| <span data-ttu-id="6e077-234">[資料正規化][DataNorm]</span><span class="sxs-lookup"><span data-stu-id="6e077-234">[Data Normalization][DataNorm]</span></span> |<span data-ttu-id="6e077-235">提供 tooscripts 之前，請指示 hello 同步處理服務 toonormalize 錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="6e077-235">Instructs hello Synchronization Service toonormalize anchor attributes before they are provided tooscripts.</span></span> |
| <span data-ttu-id="6e077-236">[物件確認][oconf]</span><span class="sxs-lookup"><span data-stu-id="6e077-236">[Object Confirmation][oconf]</span></span> |<span data-ttu-id="6e077-237">設定擱置匯入行為 hello hello 同步處理服務中。</span><span class="sxs-lookup"><span data-stu-id="6e077-237">Configures hello pending import behavior in hello Synchronization Service.</span></span> <li><span data-ttu-id="6e077-238">標準 – 需要所有的匯出的變更 toobe 確認透過匯入的預設行為</span><span class="sxs-lookup"><span data-stu-id="6e077-238">Normal – default behavior that expects all exported changes toobe confirmed via import</span></span></li><li><span data-ttu-id="6e077-239">NoDeleteConfirmation - 當物件被刪除，就不會產生任何擱置中匯入。</span><span class="sxs-lookup"><span data-stu-id="6e077-239">NoDeleteConfirmation – when an object is deleted, there is no pending import generated.</span></span></li><li><span data-ttu-id="6e077-240">NoAddAndDeleteConfirmation - 當物件建立或被刪除，就不會產生任何擱置中匯入。</span><span class="sxs-lookup"><span data-stu-id="6e077-240">NoAddAndDeleteConfirmation – when an object is created or deleted, there is no pending import generated.</span></span></li> |
| <span data-ttu-id="6e077-241">使用 DN 做為錨點</span><span class="sxs-lookup"><span data-stu-id="6e077-241">Use DN as Anchor</span></span> |<span data-ttu-id="6e077-242">如果 hello 辨別名稱樣式設定 tooLDAP，hello 連接器空間的 hello 錨點屬性也是 hello 辨別的名稱。</span><span class="sxs-lookup"><span data-stu-id="6e077-242">If hello Distinguished Name Style is set tooLDAP, hello anchor attribute for hello connector space is also hello distinguished name.</span></span> |
| <span data-ttu-id="6e077-243">數個連接器並行作業</span><span class="sxs-lookup"><span data-stu-id="6e077-243">Concurrent Operations of Several Connectors</span></span> |<span data-ttu-id="6e077-244">核取時，可以同時執行多個 Windows PowerShell 連接器。</span><span class="sxs-lookup"><span data-stu-id="6e077-244">When checked, multiple Windows PowerShell connectors can run simultaneously.</span></span> |
| <span data-ttu-id="6e077-245">分割數</span><span class="sxs-lookup"><span data-stu-id="6e077-245">Partitions</span></span> |<span data-ttu-id="6e077-246">有選取時，hello 連接器便可支援多個資料分割和磁碟分割探索。</span><span class="sxs-lookup"><span data-stu-id="6e077-246">When checked, hello connector supports multiple partitions and partition discovery.</span></span> |
| <span data-ttu-id="6e077-247">階層</span><span class="sxs-lookup"><span data-stu-id="6e077-247">Hierarchy</span></span> |<span data-ttu-id="6e077-248">有選取時，hello 連接器支援 LDAP 樣式的階層式結構。</span><span class="sxs-lookup"><span data-stu-id="6e077-248">When checked, hello connector supports an LDAP style hierarchical structure.</span></span> |
| <span data-ttu-id="6e077-249">啟用匯入</span><span class="sxs-lookup"><span data-stu-id="6e077-249">Enable Import</span></span> |<span data-ttu-id="6e077-250">有選取時，hello 連接器匯入資料透過匯入指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-250">When checked, hello connector imports data via import scripts.</span></span> |
| <span data-ttu-id="6e077-251">啟用差異匯入</span><span class="sxs-lookup"><span data-stu-id="6e077-251">Enable Delta Import</span></span> |<span data-ttu-id="6e077-252">有選取時，可以要求 hello 連接器，從 hello 差異匯入指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-252">When checked, hello connector can request deltas from hello import scripts.</span></span> |
| <span data-ttu-id="6e077-253">啟用匯出</span><span class="sxs-lookup"><span data-stu-id="6e077-253">Enable Export</span></span> |<span data-ttu-id="6e077-254">有選取時，hello 連接器匯出資料透過匯出指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-254">When checked, hello connector exports data via export scripts.</span></span> |
| <span data-ttu-id="6e077-255">啟用完整匯出</span><span class="sxs-lookup"><span data-stu-id="6e077-255">Enable Full Export</span></span> |<span data-ttu-id="6e077-256">有選取時，hello 匯出指令碼支援匯出 hello 整個連接器空間。</span><span class="sxs-lookup"><span data-stu-id="6e077-256">When checked, hello export scripts support exporting hello entire connector space.</span></span> <span data-ttu-id="6e077-257">此選項，啟用匯出也必須檢查 toouse。</span><span class="sxs-lookup"><span data-stu-id="6e077-257">toouse this option, Enable Export must also be checked.</span></span> |
| <span data-ttu-id="6e077-258">第一個匯出階段沒有參考值</span><span class="sxs-lookup"><span data-stu-id="6e077-258">No Reference Values In First Export Pass</span></span> |<span data-ttu-id="6e077-259">核取時，會在第二個匯出階段匯出參考屬性。</span><span class="sxs-lookup"><span data-stu-id="6e077-259">When checked, reference attributes are exported in a second export pass.</span></span> |
| <span data-ttu-id="6e077-260">啟用物件重新命名</span><span class="sxs-lookup"><span data-stu-id="6e077-260">Enable Object Rename</span></span> |<span data-ttu-id="6e077-261">核取時，您可以修改辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="6e077-261">When checked, distinguished names can be modified.</span></span> |
| <span data-ttu-id="6e077-262">以刪除新增做為取代</span><span class="sxs-lookup"><span data-stu-id="6e077-262">Delete-Add As Replace</span></span> |<span data-ttu-id="6e077-263">核取時，會將刪除新增作業匯出為單一取代。</span><span class="sxs-lookup"><span data-stu-id="6e077-263">When checked, delete-add operations are exported as a single replacement.</span></span> |
| <span data-ttu-id="6e077-264">啟用密碼作業</span><span class="sxs-lookup"><span data-stu-id="6e077-264">Enable Password Operations</span></span> |<span data-ttu-id="6e077-265">核取時，可支援密碼同步處理指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-265">When checked, password synchronization scripts are supported.</span></span> |
| <span data-ttu-id="6e077-266">在第一個階段啟用匯出密碼</span><span class="sxs-lookup"><span data-stu-id="6e077-266">Enable Export Password in First Pass</span></span> |<span data-ttu-id="6e077-267">有選取時，建立 hello 物件時，會匯出在佈建期間設定的密碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-267">When checked, passwords set during provisioning are exported when hello object is created.</span></span> |

### <a name="global-parameters"></a><span data-ttu-id="6e077-268">全域參數</span><span class="sxs-lookup"><span data-stu-id="6e077-268">Global Parameters</span></span>
<span data-ttu-id="6e077-269">hello 管理代理程式的設計工具中的 hello 通用參數 索引標籤可讓您 tooconfigure hello Windows PowerShell 指令碼所執行的 hello 連接器。</span><span class="sxs-lookup"><span data-stu-id="6e077-269">hello Global Parameters tab in hello Management Agent Designer enables you tooconfigure hello Windows PowerShell scripts that are run by hello connector.</span></span> <span data-ttu-id="6e077-270">您也可以設定在 hello 連線 索引標籤上定義的自訂組態設定的全域值。</span><span class="sxs-lookup"><span data-stu-id="6e077-270">You can also configure global values for custom configuration settings defined on hello Connectivity tab.</span></span>

<span data-ttu-id="6e077-271">**資料分割探索**</span><span class="sxs-lookup"><span data-stu-id="6e077-271">**Partition Discovery**</span></span>  
<span data-ttu-id="6e077-272">資料分割是一個共用結構描述內的個別命名空間。</span><span class="sxs-lookup"><span data-stu-id="6e077-272">A partition is a separate namespace within one shared schema.</span></span> <span data-ttu-id="6e077-273">例如在 Active Directory 中，每個網域就是一個樹系內的資料分割。</span><span class="sxs-lookup"><span data-stu-id="6e077-273">For example, in Active Directory every domain is a partition within one forest.</span></span> <span data-ttu-id="6e077-274">資料分割是 hello 邏輯群組，以便匯入和匯出作業。</span><span class="sxs-lookup"><span data-stu-id="6e077-274">A partition is hello logical grouping for import and export operations.</span></span> <span data-ttu-id="6e077-275">匯入和匯出將資料分割做為內容，而且所有作業會在此內容中發生。</span><span class="sxs-lookup"><span data-stu-id="6e077-275">Import and Export have partition as a context and all operations happens in this context.</span></span> <span data-ttu-id="6e077-276">資料分割在 LDAP 中應該 toorepresent 階層。</span><span class="sxs-lookup"><span data-stu-id="6e077-276">Partitions are supposed toorepresent a hierarchy in LDAP.</span></span> <span data-ttu-id="6e077-277">hello 資料分割的辨別的名稱會用於匯入 tooverify 所有傳回的物件是資料分割的 hello 範圍內。</span><span class="sxs-lookup"><span data-stu-id="6e077-277">hello distinguished name of a partition is used in import tooverify that all returned objects are within hello scope of a partition.</span></span> <span data-ttu-id="6e077-278">在 hello metaverse toohello 連接器空間 toodetermine hello 磁碟分割物件應與在匯出期間從佈建也會使用 hello 資料分割的辨別的名稱。</span><span class="sxs-lookup"><span data-stu-id="6e077-278">hello partition distinguished name is also used during provisioning from hello metaverse toohello connector space toodetermine hello partition an object should be associated with during export.</span></span>

<span data-ttu-id="6e077-279">hello 磁碟分割探索指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-279">hello partition discovery script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-280">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-280">Name</span></span> | <span data-ttu-id="6e077-281">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-281">Data Type</span></span> | <span data-ttu-id="6e077-282">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-282">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-283">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-283">ConfigParameters</span></span> |<span data-ttu-id="6e077-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-285">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-285">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-286">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-286">Credential</span></span> |<span data-ttu-id="6e077-287">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-287">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-288">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-288">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |

<span data-ttu-id="6e077-289">hello 指令碼必須傳回單一[分割][ part]物件或資料分割物件 toohello 管線的 [T] 清單。</span><span class="sxs-lookup"><span data-stu-id="6e077-289">hello script must return a either a single [Partition][part] object or a List[T] of Partition objects toohello pipeline.</span></span>

<span data-ttu-id="6e077-290">**階層探索**</span><span class="sxs-lookup"><span data-stu-id="6e077-290">**Hierarchy Discovery**</span></span>  
<span data-ttu-id="6e077-291">只有在 LDAP hello 辨別名稱的樣式功能時，會使用 hello 階層探索指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-291">hello hierarchy discovery script is only used when hello Distinguished Name Style capability is LDAP.</span></span> <span data-ttu-id="6e077-292">hello 指令碼是使用的 tooallow 您 toobrowse，然後選取一組的容器，在或的範圍會被視為匯入和匯出作業。</span><span class="sxs-lookup"><span data-stu-id="6e077-292">hello script is used tooallow you toobrowse and select a set of containers that is considered in or out of scope for import and export operations.</span></span> <span data-ttu-id="6e077-293">hello 指令碼應該只提供一份 hello 根節點提供 toohello 指令碼的直接子系的節點。</span><span class="sxs-lookup"><span data-stu-id="6e077-293">hello script should only provide a list of nodes that are direct children of hello root node supplied toohello script.</span></span>

<span data-ttu-id="6e077-294">hello 階層探索指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-294">hello hierarchy discovery script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-295">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-295">Name</span></span> | <span data-ttu-id="6e077-296">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-296">Data Type</span></span> | <span data-ttu-id="6e077-297">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-297">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-298">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-298">ConfigParameters</span></span> |<span data-ttu-id="6e077-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-300">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-300">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-301">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-301">Credential</span></span> |<span data-ttu-id="6e077-302">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-302">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-303">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-303">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-304">ParentNode</span><span class="sxs-lookup"><span data-stu-id="6e077-304">ParentNode</span></span> |<span data-ttu-id="6e077-305">[HierarchyNode][hn]</span><span class="sxs-lookup"><span data-stu-id="6e077-305">[HierarchyNode][hn]</span></span> |<span data-ttu-id="6e077-306">hello hello 階層下的 hello 指令碼應該會傳回直接子系的根節點。</span><span class="sxs-lookup"><span data-stu-id="6e077-306">hello root node of hello hierarchy under which hello script should return direct children.</span></span> |

<span data-ttu-id="6e077-307">hello 指令碼必須傳回單一子 HierarchyNode 物件或子 HierarchyNode 物件 toohello 管線的 [T] 清單。</span><span class="sxs-lookup"><span data-stu-id="6e077-307">hello script must return a either a single child HierarchyNode object or a List[T] of child HierarchyNode objects toohello pipeline.</span></span>

#### <a name="import"></a><span data-ttu-id="6e077-308">Import</span><span class="sxs-lookup"><span data-stu-id="6e077-308">Import</span></span>
<span data-ttu-id="6e077-309">支援匯入作業的連接器必須實作三個指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-309">Connectors that support import operations must implement three scripts.</span></span>

<span data-ttu-id="6e077-310">**開始匯入**</span><span class="sxs-lookup"><span data-stu-id="6e077-310">**Begin Import**</span></span>  
<span data-ttu-id="6e077-311">hello 開始匯入 hello 開頭執行匯入步驟執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-311">hello begin import script is run at hello beginning of an import run step.</span></span> <span data-ttu-id="6e077-312">在此步驟中，您可以設定連線 toohello 來源系統，並先匯入資料，從 hello 連線系統執行準備步驟。</span><span class="sxs-lookup"><span data-stu-id="6e077-312">During this step, you can establish a connection toohello source system and do preparatory steps before importing data from hello connected system.</span></span>

<span data-ttu-id="6e077-313">hello 開始匯入指令碼會接收 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-313">hello begin import script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-314">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-314">Name</span></span> | <span data-ttu-id="6e077-315">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-315">Data Type</span></span> | <span data-ttu-id="6e077-316">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-316">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-317">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-317">ConfigParameters</span></span> |<span data-ttu-id="6e077-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-319">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-319">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-320">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-320">Credential</span></span> |<span data-ttu-id="6e077-321">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-321">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-322">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-322">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-323">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-323">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="6e077-324">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-324">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="6e077-325">告知 hello 類型匯入執行 （差異或完整），資料分割、 階層、 浮水印，以及預期的頁面大小 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-325">Informs hello script about hello type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="6e077-326">類型</span><span class="sxs-lookup"><span data-stu-id="6e077-326">Types</span></span> |<span data-ttu-id="6e077-327">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="6e077-327">[Schema][schema]</span></span> |<span data-ttu-id="6e077-328">匯入的 hello 連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="6e077-328">Schema for hello connector space that is imported.</span></span> |

<span data-ttu-id="6e077-329">hello 指令碼必須傳回單一[OpenImportConnectionResults] [ oicres] toohello 管線的物件，例如：`Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="6e077-329">hello script must return a single [OpenImportConnectionResults][oicres] object toohello pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span></span>

<span data-ttu-id="6e077-330">**匯入資料**</span><span class="sxs-lookup"><span data-stu-id="6e077-330">**Import Data**</span></span>  
<span data-ttu-id="6e077-331">直到 hello 指令碼，表示沒有任何多個資料 tooimport hello 匯入資料的指令碼會呼叫 hello 連接器。</span><span class="sxs-lookup"><span data-stu-id="6e077-331">hello import data script is called by hello connector until hello script indicates that there is no more data tooimport.</span></span> <span data-ttu-id="6e077-332">hello Windows PowerShell 連接器具有 9,999 物件的頁面的大小。</span><span class="sxs-lookup"><span data-stu-id="6e077-332">hello Windows PowerShell connector has a page size of 9,999 objects.</span></span> <span data-ttu-id="6e077-333">如果您的指令碼在匯入時傳回超過 9,999 個物件，您必須支援分頁功能。</span><span class="sxs-lookup"><span data-stu-id="6e077-333">If your script returns more than 9,999 objects for import, you must support paging.</span></span> <span data-ttu-id="6e077-334">自訂資料的屬性，讓每個時間 hello 匯入資料的指令碼，您可以使用 tooa 存放區浮水印稱為 hello 連接器會公開，您的指令碼繼續匯入的物件中斷的位置。</span><span class="sxs-lookup"><span data-stu-id="6e077-334">hello connector exposes a custom data property that you can use tooa store a watermark so that each time hello import data script is called, your script resumes importing objects where it left off.</span></span>

<span data-ttu-id="6e077-335">hello 匯入資料的指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-335">hello import data script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-336">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-336">Name</span></span> | <span data-ttu-id="6e077-337">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-337">Data Type</span></span> | <span data-ttu-id="6e077-338">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-338">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-339">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-339">ConfigParameters</span></span> |<span data-ttu-id="6e077-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-341">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-341">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-342">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-342">Credential</span></span> |<span data-ttu-id="6e077-343">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-343">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-344">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-344">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-345">GetImportEntriesRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-345">GetImportEntriesRunStep</span></span> |<span data-ttu-id="6e077-346">[ImportRunStep][irs]</span><span class="sxs-lookup"><span data-stu-id="6e077-346">[ImportRunStep][irs]</span></span> |<span data-ttu-id="6e077-347">保留 hello 分頁匯入期間可以使用的浮水印 (CustomData) 和差異匯入。</span><span class="sxs-lookup"><span data-stu-id="6e077-347">Holds hello watermark (CustomData) that can be used during paged imports and delta imports.</span></span> |
| <span data-ttu-id="6e077-348">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-348">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="6e077-349">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-349">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="6e077-350">告知 hello 類型匯入執行 （差異或完整），資料分割、 階層、 浮水印，以及預期的頁面大小 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-350">Informs hello script about hello type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="6e077-351">類型</span><span class="sxs-lookup"><span data-stu-id="6e077-351">Types</span></span> |<span data-ttu-id="6e077-352">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="6e077-352">[Schema][schema]</span></span> |<span data-ttu-id="6e077-353">匯入的 hello 連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="6e077-353">Schema for hello connector space that is imported.</span></span> |

<span data-ttu-id="6e077-354">hello 匯入資料的指令碼必須撰寫清單 [[CSEntryChange][csec]] 物件 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-354">hello import data script must write a List[[CSEntryChange][csec]] object toohello pipeline.</span></span> <span data-ttu-id="6e077-355">這個集合是由代表每個所匯入物件的 CSEntryChange 屬性所組成。</span><span class="sxs-lookup"><span data-stu-id="6e077-355">This collection is composed of CSEntryChange attributes that represent each object being imported.</span></span> <span data-ttu-id="6e077-356">在執行完整匯入時，這個集合應該有一組完整的 CSEntryChange 物件，而這些物件擁有每個物件的所有屬性。</span><span class="sxs-lookup"><span data-stu-id="6e077-356">During a Full Import run, this collection should have a full set of CSEntryChange objects that have all attributes for every object.</span></span> <span data-ttu-id="6e077-357">差異匯入期間 hello CSEntryChange 物件應該包含每個物件 tooimport 或變更 （取代模式） 的 hello 物件的完整表示法的 hello 屬性層級差異。</span><span class="sxs-lookup"><span data-stu-id="6e077-357">During a Delta Import, hello CSEntryChange object should either contain hello attribute level deltas for each object tooimport, or a complete representation of hello objects that have changed (Replace mode).</span></span>

<span data-ttu-id="6e077-358">**結束匯入**</span><span class="sxs-lookup"><span data-stu-id="6e077-358">**End Import**</span></span>  
<span data-ttu-id="6e077-359">在執行的 hello 匯入的 hello 結束時，會執行 hello 結束匯入指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-359">At hello conclusion of hello import run, hello End Import script is run.</span></span> <span data-ttu-id="6e077-360">此指令碼應該執行任何清理必要工作 (例如，關閉連接 toosystems 和回應 toofailures)。</span><span class="sxs-lookup"><span data-stu-id="6e077-360">This script should perform any cleanup tasks necessary (for example, close connections toosystems and respond toofailures).</span></span>

<span data-ttu-id="6e077-361">hello 結束匯入的指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-361">hello end import script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-362">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-362">Name</span></span> | <span data-ttu-id="6e077-363">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-363">Data Type</span></span> | <span data-ttu-id="6e077-364">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-364">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-365">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-365">ConfigParameters</span></span> |<span data-ttu-id="6e077-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-367">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-367">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-368">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-368">Credential</span></span> |<span data-ttu-id="6e077-369">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-369">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-370">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-370">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-371">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-371">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="6e077-372">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-372">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="6e077-373">告知 hello 類型匯入執行 （差異或完整），資料分割、 階層、 浮水印，以及預期的頁面大小 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-373">Informs hello script about hello type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="6e077-374">CloseImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-374">CloseImportConnectionRunStep</span></span> |<span data-ttu-id="6e077-375">[CloseImportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-375">[CloseImportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="6e077-376">告知 hello 匯入已結束的 hello 原因 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-376">Informs hello script about hello reason hello import was ended.</span></span> |

<span data-ttu-id="6e077-377">hello 指令碼必須傳回單一[CloseImportConnectionResults] [ cicres] toohello 管線的物件，例如：`Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="6e077-377">hello script must return a single [CloseImportConnectionResults][cicres] object toohello pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span></span>

#### <a name="export"></a><span data-ttu-id="6e077-378">匯出</span><span class="sxs-lookup"><span data-stu-id="6e077-378">Export</span></span>
<span data-ttu-id="6e077-379">Hello 連接器相同 toohello 匯入架構，支援匯出的連接器必須實作三個指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-379">Identical toohello import architecture of hello connector, connectors that support Export must implement three scripts.</span></span>

<span data-ttu-id="6e077-380">**開始匯出**</span><span class="sxs-lookup"><span data-stu-id="6e077-380">**Begin Export**</span></span>  
<span data-ttu-id="6e077-381">hello 開始匯出 hello 開頭匯出執行步驟執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-381">hello begin export script is run at hello beginning of an export run step.</span></span> <span data-ttu-id="6e077-382">在此步驟中，您可以設定連線 toohello 來源系統，並匯出資料 toohello 連線系統之前，進行任何準備步驟。</span><span class="sxs-lookup"><span data-stu-id="6e077-382">During this step, you can establish a connection toohello source system and conduct any preparatory steps before exporting data toohello connected system.</span></span>

<span data-ttu-id="6e077-383">hello 開始匯出指令碼會接收 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-383">hello begin export script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-384">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-384">Name</span></span> | <span data-ttu-id="6e077-385">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-385">Data Type</span></span> | <span data-ttu-id="6e077-386">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-386">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-387">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-387">ConfigParameters</span></span> |<span data-ttu-id="6e077-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-389">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-389">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-390">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-390">Credential</span></span> |<span data-ttu-id="6e077-391">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-391">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-392">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-392">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-393">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-393">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="6e077-394">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-394">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="6e077-395">告知 hello 的匯出執行 （差異或完整），資料分割、 階層和預期的頁面大小的型別中的 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-395">Informs hello script about hello type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="6e077-396">類型</span><span class="sxs-lookup"><span data-stu-id="6e077-396">Types</span></span> |<span data-ttu-id="6e077-397">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="6e077-397">[Schema][schema]</span></span> |<span data-ttu-id="6e077-398">匯出的 hello 連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="6e077-398">Schema for hello connector space that is exported.</span></span> |

<span data-ttu-id="6e077-399">hello 指令碼不應傳回任何輸出 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-399">hello script should not return any output toohello pipeline.</span></span>

<span data-ttu-id="6e077-400">**匯出資料**</span><span class="sxs-lookup"><span data-stu-id="6e077-400">**Export Data**</span></span>  
<span data-ttu-id="6e077-401">hello 同步處理服務呼叫 hello 匯出資料的指令碼，是必要的 tooprocess 所有擱置中匯出的次數。</span><span class="sxs-lookup"><span data-stu-id="6e077-401">hello Synchronization Service calls hello Export Data script as many times as is necessary tooprocess all pending exports.</span></span> <span data-ttu-id="6e077-402">如果 hello 連接器空間有多個暫止匯出比 hello 連接器的頁面大小，hello 匯出資料的指令碼呼叫多次，可能是多次的 hello 相同的物件。</span><span class="sxs-lookup"><span data-stu-id="6e077-402">If hello connector space has more pending exports than hello connector’s page size, hello export data script may be called multiple times and possibly multiple times for hello same object.</span></span>

<span data-ttu-id="6e077-403">hello 匯出資料的指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-403">hello export data script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-404">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-404">Name</span></span> | <span data-ttu-id="6e077-405">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-405">Data Type</span></span> | <span data-ttu-id="6e077-406">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-406">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-407">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-407">ConfigParameters</span></span> |<span data-ttu-id="6e077-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-409">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-409">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-410">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-410">Credential</span></span> |<span data-ttu-id="6e077-411">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-411">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-412">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-412">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-413">CSEntries</span><span class="sxs-lookup"><span data-stu-id="6e077-413">CSEntries</span></span> |<span data-ttu-id="6e077-414">IList[CSEntryChange][csec]</span><span class="sxs-lookup"><span data-stu-id="6e077-414">IList[CSEntryChange][csec]</span></span> |<span data-ttu-id="6e077-415">所有 hello 連接器空間物件和暫止的匯出 toobe 在此階段期間處理的清單。</span><span class="sxs-lookup"><span data-stu-id="6e077-415">List of all hello connector space objects with pending exports toobe processed during this pass.</span></span> |
| <span data-ttu-id="6e077-416">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-416">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="6e077-417">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-417">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="6e077-418">告知 hello 的匯出執行 （差異或完整），資料分割、 階層和預期的頁面大小的型別中的 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-418">Informs hello script about hello type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="6e077-419">類型</span><span class="sxs-lookup"><span data-stu-id="6e077-419">Types</span></span> |<span data-ttu-id="6e077-420">[結構描述][schema]</span><span class="sxs-lookup"><span data-stu-id="6e077-420">[Schema][schema]</span></span> |<span data-ttu-id="6e077-421">匯出的 hello 連接器空間的結構描述。</span><span class="sxs-lookup"><span data-stu-id="6e077-421">Schema for hello connector space that is exported.</span></span> |

<span data-ttu-id="6e077-422">hello 匯出資料的指令碼必須傳回[PutExportEntriesResults] [ peeres]物件 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-422">hello export data script must return a [PutExportEntriesResults][peeres] object toohello pipeline.</span></span> <span data-ttu-id="6e077-423">此物件不針對每個匯出連接器需要 tooinclude 結果資訊，除非發生錯誤或變更 toohello 錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="6e077-423">This object does not need tooinclude result information for each exported connector unless an error or a change toohello anchor attribute occurs.</span></span> <span data-ttu-id="6e077-424">例如，tooreturn PutExportEntriesResults 物件 toohello 管線：`Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span><span class="sxs-lookup"><span data-stu-id="6e077-424">For example, tooreturn a PutExportEntriesResults object toohello pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span></span>

<span data-ttu-id="6e077-425">**結束匯出**</span><span class="sxs-lookup"><span data-stu-id="6e077-425">**End Export**</span></span>  
<span data-ttu-id="6e077-426">在 hello 匯出的 hello 結束時執行，hello 結束匯出指令碼 toorun。</span><span class="sxs-lookup"><span data-stu-id="6e077-426">At hello conclusion of hello export run, hello End Export script toorun.</span></span> <span data-ttu-id="6e077-427">此指令碼應該執行任何清理必要工作 (例如，關閉連接 toosystems 和回應 toofailures)。</span><span class="sxs-lookup"><span data-stu-id="6e077-427">This script should perform any cleanup tasks necessary (for example, close connections toosystems and respond toofailures).</span></span>

<span data-ttu-id="6e077-428">hello 結束匯出指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-428">hello end export script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-429">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-429">Name</span></span> | <span data-ttu-id="6e077-430">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-430">Data Type</span></span> | <span data-ttu-id="6e077-431">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-431">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-432">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-432">ConfigParameters</span></span> |<span data-ttu-id="6e077-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-434">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-434">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-435">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-435">Credential</span></span> |<span data-ttu-id="6e077-436">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-436">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-437">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-437">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-438">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-438">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="6e077-439">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-439">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="6e077-440">告知 hello 的匯出執行 （差異或完整），資料分割、 階層和預期的頁面大小的型別中的 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-440">Informs hello script about hello type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="6e077-441">CloseExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="6e077-441">CloseExportConnectionRunStep</span></span> |<span data-ttu-id="6e077-442">[CloseExportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="6e077-442">[CloseExportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="6e077-443">告知已結束，hello 匯出的 hello 原因 hello 指令碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-443">Informs hello script about hello reason hello export was ended.</span></span> |

<span data-ttu-id="6e077-444">hello 指令碼不應傳回任何輸出 toohello 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-444">hello script should not return any output toohello pipeline.</span></span>

#### <a name="password-synchronization"></a><span data-ttu-id="6e077-445">密碼同步處理</span><span class="sxs-lookup"><span data-stu-id="6e077-445">Password Synchronization</span></span>
<span data-ttu-id="6e077-446">Windows PowerShell 連接器可以做為密碼變更/重設的目標。</span><span class="sxs-lookup"><span data-stu-id="6e077-446">Windows PowerShell connectors can be used as a target for password changes/resets.</span></span>

<span data-ttu-id="6e077-447">hello 密碼指令碼會收到 hello hello 連接器中的下列參數：</span><span class="sxs-lookup"><span data-stu-id="6e077-447">hello password script receives hello following parameters from hello connector:</span></span>

| <span data-ttu-id="6e077-448">名稱</span><span class="sxs-lookup"><span data-stu-id="6e077-448">Name</span></span> | <span data-ttu-id="6e077-449">資料類型</span><span class="sxs-lookup"><span data-stu-id="6e077-449">Data Type</span></span> | <span data-ttu-id="6e077-450">說明</span><span class="sxs-lookup"><span data-stu-id="6e077-450">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6e077-451">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="6e077-451">ConfigParameters</span></span> |<span data-ttu-id="6e077-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="6e077-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="6e077-453">Hello 連接器的組態參數的資料表。</span><span class="sxs-lookup"><span data-stu-id="6e077-453">Table of configuration parameters for hello Connector.</span></span> |
| <span data-ttu-id="6e077-454">認證</span><span class="sxs-lookup"><span data-stu-id="6e077-454">Credential</span></span> |<span data-ttu-id="6e077-455">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="6e077-455">[PSCredential][pscred]</span></span> |<span data-ttu-id="6e077-456">包含輸入 hello 管理員 hello 連線 索引標籤上的任何認證。</span><span class="sxs-lookup"><span data-stu-id="6e077-456">Contains any credentials entered by hello administrator on hello Connectivity tab.</span></span> |
| <span data-ttu-id="6e077-457">資料分割</span><span class="sxs-lookup"><span data-stu-id="6e077-457">Partition</span></span> |<span data-ttu-id="6e077-458">[資料分割][part]</span><span class="sxs-lookup"><span data-stu-id="6e077-458">[Partition][part]</span></span> |<span data-ttu-id="6e077-459">Hello CSEntry 的目錄磁碟分割內。</span><span class="sxs-lookup"><span data-stu-id="6e077-459">Directory partition that hello CSEntry is in.</span></span> |
| <span data-ttu-id="6e077-460">CSEntry</span><span class="sxs-lookup"><span data-stu-id="6e077-460">CSEntry</span></span> |<span data-ttu-id="6e077-461">[CSEntry][cse]</span><span class="sxs-lookup"><span data-stu-id="6e077-461">[CSEntry][cse]</span></span> |<span data-ttu-id="6e077-462">連接器空間項目 hello 物件接收密碼變更或重設。</span><span class="sxs-lookup"><span data-stu-id="6e077-462">Connector space entry for hello object that is received a password change or reset.</span></span> |
| <span data-ttu-id="6e077-463">OperationType</span><span class="sxs-lookup"><span data-stu-id="6e077-463">OperationType</span></span> |<span data-ttu-id="6e077-464">String</span><span class="sxs-lookup"><span data-stu-id="6e077-464">String</span></span> |<span data-ttu-id="6e077-465">指出 hello 作業是否將其重設 (**SetPassword**) 或變更 (**ChangePassword**)。</span><span class="sxs-lookup"><span data-stu-id="6e077-465">Indicates if hello operation is a reset (**SetPassword**) or a change (**ChangePassword**).</span></span> |
| <span data-ttu-id="6e077-466">PasswordOptions</span><span class="sxs-lookup"><span data-stu-id="6e077-466">PasswordOptions</span></span> |<span data-ttu-id="6e077-467">[PasswordOptions][pwdopt]</span><span class="sxs-lookup"><span data-stu-id="6e077-467">[PasswordOptions][pwdopt]</span></span> |<span data-ttu-id="6e077-468">旗標，指定 hello 主要密碼重設行為。</span><span class="sxs-lookup"><span data-stu-id="6e077-468">Flags that specify hello intended password reset behavior.</span></span> <span data-ttu-id="6e077-469">只有在 OperationType 是 **SetPassword**時才可以使用此參數。</span><span class="sxs-lookup"><span data-stu-id="6e077-469">This parameter is only available if OperationType is **SetPassword**.</span></span> |
| <span data-ttu-id="6e077-470">OldPassword</span><span class="sxs-lookup"><span data-stu-id="6e077-470">OldPassword</span></span> |<span data-ttu-id="6e077-471">String</span><span class="sxs-lookup"><span data-stu-id="6e077-471">String</span></span> |<span data-ttu-id="6e077-472">填入 hello 物件的舊密碼，密碼變更。</span><span class="sxs-lookup"><span data-stu-id="6e077-472">Populated with hello object’s old password for password changes.</span></span> <span data-ttu-id="6e077-473">只有在 OperationType 是 **ChangePassword**時才可以使用此參數。</span><span class="sxs-lookup"><span data-stu-id="6e077-473">This parameter is only available if OperationType is **ChangePassword**.</span></span> |
| <span data-ttu-id="6e077-474">NewPassword</span><span class="sxs-lookup"><span data-stu-id="6e077-474">NewPassword</span></span> |<span data-ttu-id="6e077-475">String</span><span class="sxs-lookup"><span data-stu-id="6e077-475">String</span></span> |<span data-ttu-id="6e077-476">填入 hello 物件應該設定 hello 指令碼的新密碼。</span><span class="sxs-lookup"><span data-stu-id="6e077-476">Populated with hello object’s new password that hello script should set.</span></span> |

<span data-ttu-id="6e077-477">hello 密碼指令碼是不預期的 tooreturn 任何結果 toohello Windows PowerShell 管線。</span><span class="sxs-lookup"><span data-stu-id="6e077-477">hello password script is not expected tooreturn any results toohello Windows PowerShell pipeline.</span></span> <span data-ttu-id="6e077-478">如果 hello 密碼的指令碼中發生錯誤，hello 指令碼應該擲回下列 hello 問題相關的例外狀況 tooinform hello 同步處理服務的 hello 的其中一個：</span><span class="sxs-lookup"><span data-stu-id="6e077-478">If an error occurs in hello password script, hello script should throw one of hello following exceptions tooinform hello Synchronization Service about hello problem:</span></span>

* <span data-ttu-id="6e077-479">[PasswordPolicyViolationException] [ pwdex1] – 如果 hello 密碼不符合 hello 連線系統中的 hello 密碼原則會擲回。</span><span class="sxs-lookup"><span data-stu-id="6e077-479">[PasswordPolicyViolationException][pwdex1] – Thrown if hello password does not meet hello password policy in hello connected system.</span></span>
* <span data-ttu-id="6e077-480">[PasswordIllFormedException] [ pwdex2] – 如果 hello 密碼是無法接受連接的 hello 系統會擲回。</span><span class="sxs-lookup"><span data-stu-id="6e077-480">[PasswordIllFormedException][pwdex2] – Thrown if hello password is not acceptable for hello connected system.</span></span>
* <span data-ttu-id="6e077-481">[PasswordExtension] [ pwdex3] – hello 密碼的指令碼中的所有其他錯誤，會擲回。</span><span class="sxs-lookup"><span data-stu-id="6e077-481">[PasswordExtension][pwdex3] – Thrown for all other errors in hello password script.</span></span>

## <a name="sample-connectors"></a><span data-ttu-id="6e077-482">範例連接器</span><span class="sxs-lookup"><span data-stu-id="6e077-482">Sample Connectors</span></span>
<span data-ttu-id="6e077-483">Hello 可用的範例連接器的完整概觀，請參閱[Windows PowerShell 連接器範例連接器集合][samp]。</span><span class="sxs-lookup"><span data-stu-id="6e077-483">For a complete overview of hello available sample connectors, see [Windows PowerShell Connector Sample Connector Collection][samp].</span></span>

## <a name="other-notes"></a><span data-ttu-id="6e077-484">其他注意事項</span><span class="sxs-lookup"><span data-stu-id="6e077-484">Other notes</span></span>
### <a name="additional-configuration-for-impersonation"></a><span data-ttu-id="6e077-485">模擬的其他組態</span><span class="sxs-lookup"><span data-stu-id="6e077-485">Additional Configuration for Impersonation</span></span>
<span data-ttu-id="6e077-486">授與 hello 是模擬 hello 下列 hello 同步處理服務的伺服器上的權限的使用者：</span><span class="sxs-lookup"><span data-stu-id="6e077-486">Grant hello user that is impersonated hello following permissions on hello Synchronization Service server:</span></span>

<span data-ttu-id="6e077-487">下列登錄機碼的讀取權限 toohello:</span><span class="sxs-lookup"><span data-stu-id="6e077-487">Read access toohello following registry keys:</span></span>

* <span data-ttu-id="6e077-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span><span class="sxs-lookup"><span data-stu-id="6e077-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span></span>
* <span data-ttu-id="6e077-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span><span class="sxs-lookup"><span data-stu-id="6e077-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span></span>

<span data-ttu-id="6e077-490">toodetermine hello 安全性識別碼 (SID) 的 hello 同步處理服務服務帳戶，執行下列 PowerShell 命令的 hello:</span><span class="sxs-lookup"><span data-stu-id="6e077-490">toodetermine hello Security Identifier (SID) of hello Synchronization Service service account, run hello following PowerShell commands:</span></span>

```
$account = New-Object System.Security.Principal.NTAccount "<domain>\<username>"
$account.Translate([System.Security.Principal.SecurityIdentifier]).Value
```

<span data-ttu-id="6e077-491">下列檔案系統資料夾的讀取權限 toohello:</span><span class="sxs-lookup"><span data-stu-id="6e077-491">Read access toohello following file system folders:</span></span>

* <span data-ttu-id="6e077-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span><span class="sxs-lookup"><span data-stu-id="6e077-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span></span>
* <span data-ttu-id="6e077-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span><span class="sxs-lookup"><span data-stu-id="6e077-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span></span>
* <span data-ttu-id="6e077-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span><span class="sxs-lookup"><span data-stu-id="6e077-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span></span>

<span data-ttu-id="6e077-495">替換 hello {ConnectorName} 預留位置 hello hello Windows PowerShell 連接器名稱。</span><span class="sxs-lookup"><span data-stu-id="6e077-495">Substitute hello name of hello Windows PowerShell connector for hello {ConnectorName} placeholder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="6e077-496">疑難排解</span><span class="sxs-lookup"><span data-stu-id="6e077-496">Troubleshooting</span></span>
* <span data-ttu-id="6e077-497">如需如何 tooenable 記錄 tootroubleshoot hello 連接器資訊，請參閱 hello[如何 tooEnable ETW 追蹤連接器](http://go.microsoft.com/fwlink/?LinkId=335731)。</span><span class="sxs-lookup"><span data-stu-id="6e077-497">For information on how tooenable logging tootroubleshoot hello connector, see hello [How tooEnable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span></span>

<!--Reference style links - using these makes hello source content way more readable than using inline links-->
[cpp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameterpage.aspx
[keyk]: https://msdn.microsoft.com/library/ms132438.aspx
[cp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameter.aspx
[pscred]: https://msdn.microsoft.com/library/system.management.automation.pscredential.aspx
[schema]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schema.aspx
[schemaT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schematype.aspx
[schemaA]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schemaattribute.aspx
[dnstyle]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.madistinguishednamestyle.aspx
[exportT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maexporttype.aspx
[DataNorm]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.manormalizations.aspx
[oconf]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maobjectconfirmation.aspx
[dw]: https://msdn.microsoft.com/library/windows/desktop/aa378184.aspx
[part]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.partition.aspx
[hn]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.hierarchynode.aspx
[oicrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionrunstep.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[oicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionresults.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[cicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeimportconnectionresults.aspx
[oecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openexportconnectionrunstep.aspx
[irs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.importrunstep.aspx
[cse]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentry.aspx
[csec]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentrychange.aspx
[peeres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.putexportentriesresults.aspx
[pwdopt]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordoptions.aspx
[pwdex1]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordpolicyviolationexception.aspx
[pwdex2]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordillformedexception.aspx
[pwdex3]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordextensionexception.aspx
[samp]: http://go.microsoft.com/fwlink/?LinkId=394291
