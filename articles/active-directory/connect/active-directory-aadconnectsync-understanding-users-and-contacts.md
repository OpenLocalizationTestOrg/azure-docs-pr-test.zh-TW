---
title: "Azure AD Connect 同步：了解使用者和連絡人 | Microsoft Docs"
description: "說明 Azure AD Connect 同步處理中的使用者和連絡人。"
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
ms.assetid: 8d204647-213a-4519-bd62-49563c421602
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: markvi;andkjell
ms.openlocfilehash: 4d80648c53a2981eb2626338913ed2282423f183
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-sync-understanding-users-and-contacts"></a><span data-ttu-id="e0633-103">Azure AD Connect 同步處理：了解使用者和連絡人</span><span class="sxs-lookup"><span data-stu-id="e0633-103">Azure AD Connect sync: Understanding Users and Contacts</span></span>
<span data-ttu-id="e0633-104">您可能有幾種不同的原因，而擁有多個 Active Directory 樹系並且具有幾種不同的部署拓撲。</span><span class="sxs-lookup"><span data-stu-id="e0633-104">There are several different reasons why you would have multiple Active Directory forests and there are several different deployment topologies.</span></span> <span data-ttu-id="e0633-105">常見的模型包括合併與收購之後的帳戶-資源部署與 GAL 同步處理的樹系。</span><span class="sxs-lookup"><span data-stu-id="e0633-105">Common models include an account-resource deployment and GAL sync’ed forests after a merger & acquisition.</span></span> <span data-ttu-id="e0633-106">雖然有單純的模型，但混合模型也同樣常見。</span><span class="sxs-lookup"><span data-stu-id="e0633-106">But even if there are pure models, hybrid models are common as well.</span></span> <span data-ttu-id="e0633-107">Azure AD Connect 同步處理中的 hello 預設組態不採用任何特定的模型，但取決於如何比對使用者已選取 hello 安裝指南中，可以觀察到不同的行為。</span><span class="sxs-lookup"><span data-stu-id="e0633-107">hello default configuration in Azure AD Connect sync does not assume any particular model but depending on how user matching was selected in hello installation guide, different behaviors can be observed.</span></span>

<span data-ttu-id="e0633-108">本主題中，我們將探討 hello 預設組態在特定拓撲中的運作方式。</span><span class="sxs-lookup"><span data-stu-id="e0633-108">In this topic, we will go through how hello default configuration behaves in certain topologies.</span></span> <span data-ttu-id="e0633-109">我們將探討 hello 組態和 hello 同步處理規則編輯器可以是使用的 toolook 在 hello 組態。</span><span class="sxs-lookup"><span data-stu-id="e0633-109">We will go through hello configuration and hello Synchronization Rules Editor can be used toolook at hello configuration.</span></span>

<span data-ttu-id="e0633-110">有幾個 hello 設定會假設的一般規則：</span><span class="sxs-lookup"><span data-stu-id="e0633-110">There are a few general rules hello configuration assumes:</span></span>

* <span data-ttu-id="e0633-111">不論順序我們從 hello 來源 Active Directory 匯入，hello 最終結果應一律是 hello 相同。</span><span class="sxs-lookup"><span data-stu-id="e0633-111">Regardless of which order we import from hello source Active Directories, hello end result should always be hello same.</span></span>
* <span data-ttu-id="e0633-112">使用中的帳戶一律會提供登入資訊，包括 **userPrincipalName** 和 **sourceAnchor**。</span><span class="sxs-lookup"><span data-stu-id="e0633-112">An active account will always contribute sign-in information, including **userPrincipalName** and **sourceAnchor**.</span></span>
* <span data-ttu-id="e0633-113">停用的帳戶會提供 userPrincipalName 和 sourceAnchor，除非它是連結的信箱，如果不沒有找到任何使用中的帳戶 toobe。</span><span class="sxs-lookup"><span data-stu-id="e0633-113">A disabled account will contribute userPrincipalName and sourceAnchor, unless it is a linked mailbox, if there is no active account toobe found.</span></span>
* <span data-ttu-id="e0633-114">具有連結信箱的帳戶永遠不會用於 userPrincipalName 和 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="e0633-114">An account with a linked mailbox will never be used for userPrincipalName and sourceAnchor.</span></span> <span data-ttu-id="e0633-115">它假設稍後就會找到使用中的帳戶。</span><span class="sxs-lookup"><span data-stu-id="e0633-115">It is assumed that an active account will be found later.</span></span>
* <span data-ttu-id="e0633-116">連絡人物件可能佈建的 tooAzure AD 作為連絡人或使用者。</span><span class="sxs-lookup"><span data-stu-id="e0633-116">A contact object might be provisioned tooAzure AD as a contact or as a user.</span></span> <span data-ttu-id="e0633-117">一直要到處理了所有來源 Active Directory 樹系之後，您才會知道物件成為何者。</span><span class="sxs-lookup"><span data-stu-id="e0633-117">You don’t really know until all source Active Directory forests have been processed.</span></span>

## <a name="contacts"></a><span data-ttu-id="e0633-118">連絡人</span><span class="sxs-lookup"><span data-stu-id="e0633-118">Contacts</span></span>
<span data-ttu-id="e0633-119">在合併與收購時使用 GALSync 解決方案橋接兩個或多個 Exchange 樹系之後，常會有多個連絡人代表不同樹系中的某個使用者。</span><span class="sxs-lookup"><span data-stu-id="e0633-119">Having contacts representing a user in a different forest is common after a merger & acquisition where a GALSync solution is bridging two or more Exchange forests.</span></span> <span data-ttu-id="e0633-120">hello 連絡人物件一律要加入從 hello 連接器空間 toohello metaverse 使用 hello mail 屬性。</span><span class="sxs-lookup"><span data-stu-id="e0633-120">hello contact object is always joining from hello connector space toohello metaverse using hello mail attribute.</span></span> <span data-ttu-id="e0633-121">如果已經有相同的連絡人物件或使用者物件以 hello 郵件地址，hello 物件聯結在一起。</span><span class="sxs-lookup"><span data-stu-id="e0633-121">If there is already a contact object or user object with hello same mail address, hello objects are joined together.</span></span> <span data-ttu-id="e0633-122">這設定在 hello 規則**中 from AD – Contact Join**。</span><span class="sxs-lookup"><span data-stu-id="e0633-122">This is configured in hello rule **In from AD – Contact Join**.</span></span> <span data-ttu-id="e0633-123">另外還有名為的規則**中 from AD – Contact Common**屬性流程 toohello metaverse 屬性與**sourceObjectType**與 hello 常數**連絡人**。</span><span class="sxs-lookup"><span data-stu-id="e0633-123">There is also a rule named **In from AD – Contact Common** with an attribute flow toohello metaverse attribute **sourceObjectType** with hello constant **Contact**.</span></span> <span data-ttu-id="e0633-124">此規則的優先順序非常低，如果任何使用者物件聯結的 toohello 相同的 metaverse 物件，然後 hello 規則**中 from AD – User Common**會導致 hello value 使用者 toothis 屬性。</span><span class="sxs-lookup"><span data-stu-id="e0633-124">This rule has very low precedence so if any user object is joined toohello same metaverse object, then hello rule **In from AD – User Common** will contribute hello value User toothis attribute.</span></span> <span data-ttu-id="e0633-125">與這項規則，此屬性必須 hello 值，如果沒有使用者已經加入，請連絡 hello 使用者的值，如果至少一個使用者發現。</span><span class="sxs-lookup"><span data-stu-id="e0633-125">With this rule, this attribute will have hello value Contact if no user has been joined and hello value User if at least one user has been found.</span></span>

<span data-ttu-id="e0633-126">佈建物件 tooAzure AD，hello 輸出規則**出 tooAAD – Contact Join**會建立連絡人物件，如果 hello metaverse 屬性**sourceObjectType**設定得**連絡**.</span><span class="sxs-lookup"><span data-stu-id="e0633-126">For provisioning an object tooAzure AD, hello outbound rule **Out tooAAD – Contact Join** will create a contact object if hello metaverse attribute **sourceObjectType** is set too**Contact**.</span></span> <span data-ttu-id="e0633-127">如果此屬性設定太**使用者**，然後 hello 規則**出 tooAAD – User Join**改為建立使用者物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-127">If this attribute is set too**User**, then hello rule **Out tooAAD – User Join** will create a user object instead.</span></span>
<span data-ttu-id="e0633-128">很可能更多來源 Active Directory 會匯入和同步處理時，會從 Contact tooUser 升級物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-128">It is possible that an object is promoted from Contact tooUser when more source Active Directories are imported and synchronized.</span></span>

<span data-ttu-id="e0633-129">比方說，在 GALSync 拓撲中我們會發現連絡人物件的每個人都 hello 第二個樹系中當我們匯入 hello 第一個樹系。</span><span class="sxs-lookup"><span data-stu-id="e0633-129">For example, in a GALSync topology we will find contact objects for everyone in hello second forest when we import hello first forest.</span></span> <span data-ttu-id="e0633-130">這將暫存 hello AAD 連接器中新的連絡人物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-130">This will stage new contact objects in hello AAD Connector.</span></span> <span data-ttu-id="e0633-131">當我們稍後匯入和同步處理 hello 第二個樹系時，我們會尋找 hello 真正的使用者，並將其聯結 toohello 現有的 metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-131">When we later import and synchronize hello second forest, we will find hello real users and join them toohello existing metaverse objects.</span></span> <span data-ttu-id="e0633-132">然後我們將刪除 AAD 中的 hello 連絡人物件，並改為建立新的使用者物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-132">We will then delete hello contact object in AAD and create a new user object instead.</span></span>

<span data-ttu-id="e0633-133">如果您有的拓撲，其中使用者會顯示為連絡人，請確定您選取 toomatch hello mail 屬性上的使用者 hello 安裝指南中。</span><span class="sxs-lookup"><span data-stu-id="e0633-133">If you have a topology where users are represented as contacts, make sure you select toomatch users on hello mail attribute in hello installation guide.</span></span> <span data-ttu-id="e0633-134">如果您選取另一個選項，則您的組態就會與順序有關。</span><span class="sxs-lookup"><span data-stu-id="e0633-134">If you select another option, then you will have an order dependent configuration.</span></span> <span data-ttu-id="e0633-135">Hello mail 屬性上一律聯結連絡人物件，但使用者物件上聯結 hello mail 屬性如果 hello 安裝指南中已選取此選項。</span><span class="sxs-lookup"><span data-stu-id="e0633-135">Contact objects will always join on hello mail attribute, but user objects will only join on hello mail attribute if this option was selected in hello installation guide.</span></span> <span data-ttu-id="e0633-136">您可以再得到 hello 與 hello metaverse 中的兩個不同物件具有相同 mail 屬性如果 hello 連絡人物件已匯入之前 hello 使用者物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-136">You could then end up with two different objects in hello metaverse with hello same mail attribute if hello contact object was imported before hello user object.</span></span> <span data-ttu-id="e0633-137">在匯出 tooAzure AD，將會擲回錯誤。</span><span class="sxs-lookup"><span data-stu-id="e0633-137">During export tooAzure AD, an error will be thrown.</span></span> <span data-ttu-id="e0633-138">此行為是設計所致，表示不正確的資料，或在 hello 安裝期間未正確識別該 hello 拓撲。</span><span class="sxs-lookup"><span data-stu-id="e0633-138">This behavior is by design and would indicate bad data or that hello topology was not correctly identified during hello installation.</span></span>

## <a name="disabled-accounts"></a><span data-ttu-id="e0633-139">停用的帳戶</span><span class="sxs-lookup"><span data-stu-id="e0633-139">Disabled accounts</span></span>
<span data-ttu-id="e0633-140">停用的帳戶也會同步 tooAzure AD。</span><span class="sxs-lookup"><span data-stu-id="e0633-140">Disabled accounts are synchronized as well tooAzure AD.</span></span> <span data-ttu-id="e0633-141">停用的帳戶是交換，例如會議室中的常見 toorepresent 資源。</span><span class="sxs-lookup"><span data-stu-id="e0633-141">Disabled accounts are common toorepresent resources in Exchange, for example conference rooms.</span></span> <span data-ttu-id="e0633-142">hello 例外狀況是使用者具有連結信箱。如先前所述，這些將會永遠不會提供帳戶 tooAzure AD。</span><span class="sxs-lookup"><span data-stu-id="e0633-142">hello exception is users with a linked mailbox; as previously mentioned, these will never provision an account tooAzure AD.</span></span>

<span data-ttu-id="e0633-143">hello 假設是，如果找到停用的使用者帳戶，則稍後我們會不到另一個使用中的帳戶，而且 hello 物件是佈建的 tooAzure AD 與找到 hello userPrincipalName 和 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="e0633-143">hello assumption is that if a disabled user account is found, then we will not find another active account later and hello object is provisioned tooAzure AD with hello userPrincipalName and sourceAnchor found.</span></span> <span data-ttu-id="e0633-144">在案例中另一個使用中的帳戶將會加入的 toohello 將使用相同的 metaverse 物件，然後將其 userPrincipalName 和 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="e0633-144">In case another active account will join toohello same metaverse object, then its userPrincipalName and sourceAnchor will be used.</span></span>

## <a name="changing-sourceanchor"></a><span data-ttu-id="e0633-145">變更 sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="e0633-145">Changing sourceAnchor</span></span>
<span data-ttu-id="e0633-146">當物件已匯出 tooAzure AD，則不允許的 toochange hello sourceAnchor 不再。</span><span class="sxs-lookup"><span data-stu-id="e0633-146">When an object has been exported tooAzure AD then it is not allowed toochange hello sourceAnchor anymore.</span></span> <span data-ttu-id="e0633-147">當 hello 物件已匯出的 hello metaverse 屬性**cloudSourceAnchor**設定以 hello **sourceAnchor** Azure AD 所接受的值。</span><span class="sxs-lookup"><span data-stu-id="e0633-147">When hello object has been exported hello metaverse attribute **cloudSourceAnchor** is set with hello **sourceAnchor** value accepted by Azure AD.</span></span> <span data-ttu-id="e0633-148">如果**sourceAnchor**的變更，並不符合**cloudSourceAnchor**，hello 規則**出 tooAAD – User Join**會擲回 hello 錯誤**sourceAnchor 屬性已變更**。</span><span class="sxs-lookup"><span data-stu-id="e0633-148">If **sourceAnchor** is changed and not match **cloudSourceAnchor**, hello rule **Out tooAAD – User Join** will throw hello error **sourceAnchor attribute has changed**.</span></span> <span data-ttu-id="e0633-149">在此情況下，hello 組態或資料必須更正錯誤，因此 hello 相同 sourceAnchor 存在於試 hello metaverse 中才可以再次同步處理 hello 物件。</span><span class="sxs-lookup"><span data-stu-id="e0633-149">In this case, hello configuration or data must be corrected so hello same sourceAnchor is present in hello metaverse again before hello object can be synchronized again.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e0633-150">其他資源</span><span class="sxs-lookup"><span data-stu-id="e0633-150">Additional Resources</span></span>
* [<span data-ttu-id="e0633-151">Azure AD Connect 同步處理：自訂同步處理選項</span><span class="sxs-lookup"><span data-stu-id="e0633-151">Azure AD Connect Sync: Customizing Synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="e0633-152">整合內部部署身分識別與 Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="e0633-152">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)

