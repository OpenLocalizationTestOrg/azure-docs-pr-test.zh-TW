---
title: "Azure AD Connect 同步：了解架構 | Microsoft Docs"
description: "本主題描述 Azure AD Connect 同步處理的架構並說明所用的詞彙。"
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 465bcbe9-3bdd-4769-a8ca-f8905abf426d
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: 51082ad453d53f56f30f814b78578801c00f4827
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-sync-understanding-the-architecture"></a><span data-ttu-id="e2d67-103">Azure AD Connect 同步處理：了解架構</span><span class="sxs-lookup"><span data-stu-id="e2d67-103">Azure AD Connect sync: Understanding the architecture</span></span>
<span data-ttu-id="e2d67-104">本主題涵蓋 Azure AD Connect 同步處理的基本架構。</span><span class="sxs-lookup"><span data-stu-id="e2d67-104">This topic covers the basic architecture for Azure AD Connect sync.</span></span> <span data-ttu-id="e2d67-105">在許多方面，它類似於其前身產品 MIIS 2003、ILM 2007 和 FIM 2010。</span><span class="sxs-lookup"><span data-stu-id="e2d67-105">In many aspects, it is similar to its predecessors MIIS 2003, ILM 2007, and FIM 2010.</span></span> <span data-ttu-id="e2d67-106">Azure AD Connect 同步處理是這些技術的進化。</span><span class="sxs-lookup"><span data-stu-id="e2d67-106">Azure AD Connect sync is the evolution of these technologies.</span></span> <span data-ttu-id="e2d67-107">如果您很熟悉上述任何較早期的技術，也會對本主題的內容感到熟悉。</span><span class="sxs-lookup"><span data-stu-id="e2d67-107">If you are familiar with any of these earlier technologies, the content of this topic will be familiar to you as well.</span></span> <span data-ttu-id="e2d67-108">如果您是同步處理的新手，這個主題很適合您。</span><span class="sxs-lookup"><span data-stu-id="e2d67-108">If you are new to synchronization, then this topic is for you.</span></span> <span data-ttu-id="e2d67-109">但是，不一定需要了解本主題的詳細資料，才能成功地自訂 Azure AD Connect 同步處理 (在本主題中稱為「同步處理引擎」)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-109">It is however not a requirement to know the details of this topic to be successful in making customizations to Azure AD Connect sync (called sync engine in this topic).</span></span>

## <a name="architecture"></a><span data-ttu-id="e2d67-110">架構</span><span class="sxs-lookup"><span data-stu-id="e2d67-110">Architecture</span></span>
<span data-ttu-id="e2d67-111">同步處理引擎會為多個已連接的資料來源中儲存的物件建立整合式檢視，並管理這些資料來源中的身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-111">The sync engine creates an integrated view of objects that are stored in multiple connected data sources and manages identity information in those data sources.</span></span> <span data-ttu-id="e2d67-112">此整合式檢視取決於從連接的資料來源擷取的身分識別資訊，以及一組用來決定如何處理此資訊的規則。</span><span class="sxs-lookup"><span data-stu-id="e2d67-112">This integrated view is determined by the identity information retrieved from connected data sources and a set of rules that determine how to process this information.</span></span>

### <a name="connected-data-sources-and-connectors"></a><span data-ttu-id="e2d67-113">連接的資料來源和連接器</span><span class="sxs-lookup"><span data-stu-id="e2d67-113">Connected Data Sources and Connectors</span></span>
<span data-ttu-id="e2d67-114">同步處理引擎會處理來自不同資料儲存機制 (例如 Active Directory 或 SQL Server 資料庫) 的身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-114">The sync engine processes identity information from different data repositories, such as Active Directory or a SQL Server database.</span></span> <span data-ttu-id="e2d67-115">每個會將其資料組織成類似資料庫格式並提供標準資料存取方法的資料儲存機制，都是同步處理引擎的潛在資料來源候選項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-115">Every data repository that organizes its data in a database-like format and that provides standard data-access methods is a potential data source candidate for the sync engine.</span></span> <span data-ttu-id="e2d67-116">由同步處理引擎進行同步處理的資料儲存機制稱為**連接的資料來源**或**連接的目錄** (CD)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-116">The data repositories that are synchronized by sync engine are called **connected data sources** or **connected directories** (CD).</span></span>

<span data-ttu-id="e2d67-117">同步處理引擎會在稱為 **連接器**的模組中，對與連接之資料來源的互動進行封裝。</span><span class="sxs-lookup"><span data-stu-id="e2d67-117">The sync engine encapsulates interaction with a connected data source within a module called a **Connector**.</span></span> <span data-ttu-id="e2d67-118">每種類型的連接資料來源都有特定的連接器。</span><span class="sxs-lookup"><span data-stu-id="e2d67-118">Each type of connected data source has a specific Connector.</span></span> <span data-ttu-id="e2d67-119">連接器會將必要的作業轉譯成連接的資料來源所認識的格式。</span><span class="sxs-lookup"><span data-stu-id="e2d67-119">The Connector translates a required operation into the format that the connected data source understands.</span></span>

<span data-ttu-id="e2d67-120">連接器會進行 API 呼叫，以便與連接的資料來源交換身分識別資訊 (讀取和寫入)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-120">Connectors make API calls to exchange identity information (both read and write) with a connected data source.</span></span> <span data-ttu-id="e2d67-121">此外，也可以使用可延伸的連線架構來新增自訂連接器。</span><span class="sxs-lookup"><span data-stu-id="e2d67-121">It is also possible to add a custom Connector using the extensible connectivity framework.</span></span> <span data-ttu-id="e2d67-122">下圖顯示連接器如何將連接的資料來源連接至同步處理引擎。</span><span class="sxs-lookup"><span data-stu-id="e2d67-122">The following illustration shows how a Connector connects a connected data source to the sync engine.</span></span>

![Arch1](./media/active-directory-aadconnectsync-understanding-architecture/arch1.png)

<span data-ttu-id="e2d67-124">資料可以任一方向流動，但無法同時以兩個方向流動。</span><span class="sxs-lookup"><span data-stu-id="e2d67-124">Data can flow in either direction, but it cannot flow in both directions simultaneously.</span></span> <span data-ttu-id="e2d67-125">換句話說，連接器可以設定成允許資料從連接的資料來源流動至同步處理引擎，或從同步處理引擎流動至連接的資料來源，但是一個物件和屬性一次只能進行其中一項作業。</span><span class="sxs-lookup"><span data-stu-id="e2d67-125">In other words, a Connector can be configured to allow data to flow from the connected data source to sync engine or from sync engine to the connected data source, but only one of those operations can occur at any one time for one object and attribute.</span></span> <span data-ttu-id="e2d67-126">不同物件和不同屬性的方向可以不同。</span><span class="sxs-lookup"><span data-stu-id="e2d67-126">The direction can be different for different objects and for different attributes.</span></span>

<span data-ttu-id="e2d67-127">若要設定連接器，您可以指定要同步處理的物件類型。</span><span class="sxs-lookup"><span data-stu-id="e2d67-127">To configure a Connector, you specify the object types that you want to synchronize.</span></span> <span data-ttu-id="e2d67-128">指定物件類型，以定義同步處理程序中內含物件的範圍。</span><span class="sxs-lookup"><span data-stu-id="e2d67-128">Specifying the object types defines the scope of objects that are included in the synchronization process.</span></span> <span data-ttu-id="e2d67-129">下一個步驟是選取要同步處理的屬性，這就是所謂的屬性包含清單。</span><span class="sxs-lookup"><span data-stu-id="e2d67-129">The next step is to select the attributes to synchronize, which is known as an attribute inclusion list.</span></span> <span data-ttu-id="e2d67-130">您可以隨時變更這些設定，以回應您的商務規則變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-130">These settings can be changed any time in response to changes to your business rules.</span></span> <span data-ttu-id="e2d67-131">當您使用 Azure AD Connect 安裝精靈時，它會為您進行這些設定。</span><span class="sxs-lookup"><span data-stu-id="e2d67-131">When you use the Azure AD Connect installation wizard, these settings are configured for you.</span></span>

<span data-ttu-id="e2d67-132">若要將物件匯出到連接的資料來源，屬性包含清單必須至少包含在連接的資料來源中建立特定物件類型所需的最少屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-132">To export objects to a connected data source, the attribute inclusion list must include at least the minimum attributes required to create a specific object type in a connected data source.</span></span> <span data-ttu-id="e2d67-133">例如，**sAMAccountName** 屬性必須包含在屬性包含清單中，才能將使用者物件匯出到 Active Directory，因為 Active Directory 中的所有使用者物件都必須定義 **sAMAccountName** 屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-133">For example, the **sAMAccountName** attribute must be included in the attribute inclusion list to export a user object to Active Directory because all user objects in Active Directory must have a **sAMAccountName** attribute defined.</span></span> <span data-ttu-id="e2d67-134">同樣地，安裝精靈會為您進行此設定。</span><span class="sxs-lookup"><span data-stu-id="e2d67-134">Again, the installation wizard does this configuration for you.</span></span>

<span data-ttu-id="e2d67-135">如果連接的資料來源使用結構化元件 (例如資料分割或容器) 來組織物件，您可以限制連接的資料來源中用於特定解決方案的區域。</span><span class="sxs-lookup"><span data-stu-id="e2d67-135">If the connected data source uses structural components, such as partitions or containers to organize objects, you can limit the areas in the connected data source that are used for a given solution.</span></span>

### <a name="internal-structure-of-the-sync-engine-namespace"></a><span data-ttu-id="e2d67-136">同步處理引擎命名空間的內部結構</span><span class="sxs-lookup"><span data-stu-id="e2d67-136">Internal structure of the sync engine namespace</span></span>
<span data-ttu-id="e2d67-137">整個同步處理引擎命名空間是由用來儲存身分識別資訊的兩個命名空間所組成。</span><span class="sxs-lookup"><span data-stu-id="e2d67-137">The entire sync engine namespace consists of two namespaces that store the identity information.</span></span> <span data-ttu-id="e2d67-138">這兩個命名空間為：</span><span class="sxs-lookup"><span data-stu-id="e2d67-138">The two namespaces are:</span></span>

* <span data-ttu-id="e2d67-139">連接器空間 (CS)</span><span class="sxs-lookup"><span data-stu-id="e2d67-139">The connector space (CS)</span></span>
* <span data-ttu-id="e2d67-140">Metaverse (MV)</span><span class="sxs-lookup"><span data-stu-id="e2d67-140">The metaverse (MV)</span></span>

<span data-ttu-id="e2d67-141">**連接器空間** 是一個預備區域，其中包含連接的資料來源中指定物件的代表項目，以及在屬性包含清單中指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-141">The **connector space** is a staging area that contains representations of the designated objects from a connected data source and the attributes specified in the attribute inclusion list.</span></span> <span data-ttu-id="e2d67-142">同步處理引擎會使用連接器空間來判斷連接的資料來源有何變更，以及預備連入的變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-142">The sync engine uses the connector space to determine what has changed in the connected data source and to stage incoming changes.</span></span> <span data-ttu-id="e2d67-143">同步處理引擎也會使用連接器空間來預備連出的變更，以便匯出到連接的資料來源。</span><span class="sxs-lookup"><span data-stu-id="e2d67-143">The sync engine also uses the connector space to stage outgoing changes for export to the connected data source.</span></span> <span data-ttu-id="e2d67-144">同步處理引擎會維護個別的連接器空間，做為每個連接器的預備區域。</span><span class="sxs-lookup"><span data-stu-id="e2d67-144">The sync engine maintains a distinct connector space as a staging area for each Connector.</span></span>

<span data-ttu-id="e2d67-145">使用預備區域，同步處理引擎會與連接的資料來源保持獨立，而不受其可用性和存取能力影響。</span><span class="sxs-lookup"><span data-stu-id="e2d67-145">By using a staging area, the sync engine remains independent of the connected data sources and is not affected by their availability and accessibility.</span></span> <span data-ttu-id="e2d67-146">因此，您可以使用預備區域中的資料，隨時處理身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-146">As a result, you can process identity information at any time by using the data in the staging area.</span></span> <span data-ttu-id="e2d67-147">同步處理引擎只能要求最後一個通訊工作階段終止後在連接的資料來源內所做的變更，或只推送連接的資料來源尚未收到的身分識別資訊變更，以減少同步處理引擎與連接的資料來源之間的網路流量。</span><span class="sxs-lookup"><span data-stu-id="e2d67-147">The sync engine can request only the changes made inside the connected data source since the last communication session terminated or push out only the changes to identity information that the connected data source has not yet received, which reduces the network traffic between the sync engine and the connected data source.</span></span>

<span data-ttu-id="e2d67-148">此外，同步處理引擎會儲存它在連接器空間中預備的所有物件的相關狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-148">In addition, sync engine stores status information about all objects that it stages in the connector space.</span></span> <span data-ttu-id="e2d67-149">同步處理引擎收到新的資料時，一律會評估此資料是否已同步處理。</span><span class="sxs-lookup"><span data-stu-id="e2d67-149">When new data is received, sync engine always evaluates whether the data has already been synchronized.</span></span>

<span data-ttu-id="e2d67-150">**Metaverse** 是一個儲存區域，其中包含來自多個連接的資料來源的彙總身分識別資訊，並提供所有組合物件的單一全域、整合式檢視。</span><span class="sxs-lookup"><span data-stu-id="e2d67-150">The **metaverse** is a storage area that contains the aggregated identity information from multiple connected data sources, providing a single global, integrated view of all combined objects.</span></span> <span data-ttu-id="e2d67-151">根據從連接的資料來源擷取的身分識別資訊以及一組可讓您自訂同步處理程序的規則，建立 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-151">Metaverse objects are created based on the identity information that is retrieved from the connected data sources and a set of rules that allow you to customize the synchronization process.</span></span>

<span data-ttu-id="e2d67-152">下圖顯示同步處理引擎內的連接器空間命名空間和 Metaverse 命名空間。</span><span class="sxs-lookup"><span data-stu-id="e2d67-152">The following illustration shows the connector space namespace and the metaverse namespace within the sync engine.</span></span>

![Arch2](./media/active-directory-aadconnectsync-understanding-architecture/arch2.png)

## <a name="sync-engine-identity-objects"></a><span data-ttu-id="e2d67-154">同步處理引擎身分識別物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-154">Sync engine identity objects</span></span>
<span data-ttu-id="e2d67-155">同步處理引擎中的物件是連接的資料來源中任一個物件的代表項目，或同步處理引擎對於這些物件的整合式檢視。</span><span class="sxs-lookup"><span data-stu-id="e2d67-155">The objects in the sync engine are representations of either objects in the connected data source or the integrated view that sync engine has of those objects.</span></span> <span data-ttu-id="e2d67-156">每一個同步處理引擎物件都必須有全域唯一識別碼 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-156">Every sync engine object must have a globally unique identifier (GUID).</span></span> <span data-ttu-id="e2d67-157">Guid 可提供資料完整性以及物件之間的快速關聯性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-157">GUIDs provide data integrity and express relationships between objects.</span></span>

### <a name="connector-space-objects"></a><span data-ttu-id="e2d67-158">連接器空間物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-158">Connector space objects</span></span>
<span data-ttu-id="e2d67-159">當同步處理引擎與連接的資料來源通訊時，它會讀取連接的資料來源中的身分識別資訊，並使用該資訊在連接器空間中建立身分識別物件的代表項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-159">When sync engine communicates with a connected data source, it reads the identity information in the connected data source and uses that information to create a representation of the identity object in the connector space.</span></span> <span data-ttu-id="e2d67-160">您無法個別建立或刪除這些物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-160">You cannot create or delete these objects individually.</span></span> <span data-ttu-id="e2d67-161">不過，您可以手動刪除連接器空間中的所有物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-161">However, you can manually delete all objects in a connector space.</span></span>

<span data-ttu-id="e2d67-162">連接器空間中的所有物件都具有兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="e2d67-162">All objects in the connector space have two attributes:</span></span>

* <span data-ttu-id="e2d67-163">全域唯一識別碼 (GUID)</span><span class="sxs-lookup"><span data-stu-id="e2d67-163">A globally unique identifier (GUID)</span></span>
* <span data-ttu-id="e2d67-164">辨別名稱 (也稱為 DN)</span><span class="sxs-lookup"><span data-stu-id="e2d67-164">A distinguished name (also known as DN)</span></span>

<span data-ttu-id="e2d67-165">如果連接的資料來源將唯一屬性指派給物件，則連接器空間中的物件也可以有錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-165">If the connected data source assigns a unique attribute to the object, then objects in the connector space can also have an anchor attribute.</span></span> <span data-ttu-id="e2d67-166">錨點屬性可唯一識別連接的資料來源中的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-166">The anchor attribute uniquely identifies an object in the connected data source.</span></span> <span data-ttu-id="e2d67-167">同步處理引擎會使用錨點，在連接的資料來源中尋找此物件的對應代表項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-167">The sync engine uses the anchor to locate the corresponding representation of this object in the connected data source.</span></span> <span data-ttu-id="e2d67-168">同步處理引擎假設物件的錨點永遠不會在物件的存留期間內變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-168">Sync engine assumes that the anchor of an object never changes over the lifetime of the object.</span></span>

<span data-ttu-id="e2d67-169">許多連接器會在匯入每個物件時，使用已知的唯一識別碼自動為其產生錨點。</span><span class="sxs-lookup"><span data-stu-id="e2d67-169">Many of the Connectors use a known unique identifier to generate an anchor automatically for each object when it is imported.</span></span> <span data-ttu-id="e2d67-170">例如，Active Directory 連接器會使用錨點的 **objectGUID** 屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-170">For example, the Active Directory Connector uses the **objectGUID** attribute for an anchor.</span></span> <span data-ttu-id="e2d67-171">如果連接的資料來源未提供清楚定義的唯一識別碼，您可以指定在連接器設定期間產生錨點。</span><span class="sxs-lookup"><span data-stu-id="e2d67-171">For connected data sources that do not provide a clearly defined unique identifier, you can specify anchor generation as part of the Connector configuration.</span></span>

<span data-ttu-id="e2d67-172">在該情況下，會從物件類型的一或多個唯一屬性 (均未變更) 建置錨點，而該錨點可唯一識別連接器空間中的物件 (例如，員工編號或使用者識別碼)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-172">In that case, the anchor is built from one or more unique attributes of an object type, neither of which changes, and that uniquely identifies the object in the connector space (for example, an employee number or a user ID).</span></span>

<span data-ttu-id="e2d67-173">連接器空間物件可以是下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="e2d67-173">A connector space object can be one of the following:</span></span>

* <span data-ttu-id="e2d67-174">預備物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-174">A staging object</span></span>
* <span data-ttu-id="e2d67-175">預留位置</span><span class="sxs-lookup"><span data-stu-id="e2d67-175">A placeholder</span></span>

### <a name="staging-objects"></a><span data-ttu-id="e2d67-176">預備物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-176">Staging Objects</span></span>
<span data-ttu-id="e2d67-177">預備物件表示連接的資料來源中指定的物件類型執行個體。</span><span class="sxs-lookup"><span data-stu-id="e2d67-177">A staging object represents an instance of the designated object types from the connected data source.</span></span> <span data-ttu-id="e2d67-178">除了 GUID 和辨別名稱以外，預備物件一律有可指出物件類型的值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-178">In addition to the GUID and the distinguished name, a staging object always has a value that indicates the object type.</span></span>

<span data-ttu-id="e2d67-179">已匯入的預備物件一律有錨點屬性的值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-179">Staging objects that have been imported always have a value for the anchor attribute.</span></span> <span data-ttu-id="e2d67-180">同步處理引擎最近佈建且正在連接的資料來源中進行建立的預備物件，沒有錨點屬性的值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-180">Staging objects that have been newly provisioned by sync engine and are in the process of being created in the connected data source do not have a value for the anchor attribute.</span></span>

<span data-ttu-id="e2d67-181">預備物件也帶有商務屬性的目前值，以及同步處理引擎執行同步處理程序所需的作業資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-181">Staging objects also carry current values of business attributes, and operational information needed by sync engine to perform the synchronization process.</span></span> <span data-ttu-id="e2d67-182">作業資訊包括旗標，可指出在預備物件上預備的更新類型。</span><span class="sxs-lookup"><span data-stu-id="e2d67-182">Operational information includes flags that indicate the type of updates that are staged on the staging object.</span></span> <span data-ttu-id="e2d67-183">如果預備物件從連接的資料來源收到尚未處理的新身分識別資訊，則物件會標示為 [擱置匯入] 。</span><span class="sxs-lookup"><span data-stu-id="e2d67-183">If a staging object has received new identity information from the connected data source that has not yet been processed, the object is flagged as **pending import**.</span></span> <span data-ttu-id="e2d67-184">如果預備物件有新的身分識別資訊尚未匯出至連接的資料來源，則物件會標示為 [擱置匯出] 。</span><span class="sxs-lookup"><span data-stu-id="e2d67-184">If a staging object has new identity information that has not yet been exported to the connected data source, it is flagged as **pending export**.</span></span>

<span data-ttu-id="e2d67-185">預備物件可以是匯入物件或匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-185">A staging object can be an import object or an export object.</span></span> <span data-ttu-id="e2d67-186">同步處理引擎會使用從連接的資料來源接收的物件資訊建立匯入物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-186">The sync engine creates an import object by using object information received from the connected data source.</span></span> <span data-ttu-id="e2d67-187">當同步處理引擎收到的新物件存在相關資訊，符合在連接器中選取的其中一個物件類型時，它會在連接器空間中建立匯入物件，做為連接的資料來源中物件的代表項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-187">When sync engine receives information about the existence of a new object that matches one of the object types selected in the Connector, it creates an import object in the connector space as a representation of the object in the connected data source.</span></span>

<span data-ttu-id="e2d67-188">下圖顯示的匯入物件表示連接的資料來源中的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-188">The following illustration shows an import object that represents an object in the connected data source.</span></span>

![Arch3](./media/active-directory-aadconnectsync-understanding-architecture/arch3.png)

<span data-ttu-id="e2d67-190">同步處理引擎會使用 Metaverse 中的物件資訊建立匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-190">The sync engine creates an export object by using object information in the metaverse.</span></span> <span data-ttu-id="e2d67-191">在下一個通訊工作階段期間，匯出物件會匯出至連接的資料來源。</span><span class="sxs-lookup"><span data-stu-id="e2d67-191">Export objects are exported to the connected data source during the next communication session.</span></span> <span data-ttu-id="e2d67-192">從同步處理引擎的觀點來看，匯出物件尚未存在於連接的資料來源中。</span><span class="sxs-lookup"><span data-stu-id="e2d67-192">From the perspective of the sync engine, export objects do not exist in the connected data source yet.</span></span> <span data-ttu-id="e2d67-193">因此，無法使用匯出物件的錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-193">Therefore, the anchor attribute for an export object is not available.</span></span> <span data-ttu-id="e2d67-194">從同步處理引擎接收物件之後，連接的資料來源會為物件的錨點屬性建立唯一值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-194">After it receives the object from sync engine, the connected data source creates a unique value for the anchor attribute of the object.</span></span>

<span data-ttu-id="e2d67-195">下圖顯示如何匯出使用 Metaverse 中的身分識別資訊所建立的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-195">The following illustration shows how an export object is created by using identity information in the metaverse.</span></span>

![Arch4](./media/active-directory-aadconnectsync-understanding-architecture/arch4.png)

<span data-ttu-id="e2d67-197">同步處理引擎會從連接的資料來源重新匯入物件，以確認匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-197">The sync engine confirms the export of the object by reimporting the object from the connected data source.</span></span> <span data-ttu-id="e2d67-198">當同步處理引擎在下一次從該連接的資料來源匯入期間收到物件時，匯出物件就會變成匯入物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-198">Export objects become import objects when sync engine receives them during the next import from that connected data source.</span></span>

### <a name="placeholders"></a><span data-ttu-id="e2d67-199">預留位置</span><span class="sxs-lookup"><span data-stu-id="e2d67-199">Placeholders</span></span>
<span data-ttu-id="e2d67-200">同步處理引擎會使用一般命名空間來儲存物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-200">The sync engine uses a flat namespace to store objects.</span></span> <span data-ttu-id="e2d67-201">不過，有些連接的資料來源 (例如 Active Directory) 會使用階層式命名空間。</span><span class="sxs-lookup"><span data-stu-id="e2d67-201">However, some connected data sources such as Active Directory use a hierarchical namespace.</span></span> <span data-ttu-id="e2d67-202">若要將階層式命名空間中的資訊轉換成一般命名空間，同步處理引擎會使用預留位置來保留階層。</span><span class="sxs-lookup"><span data-stu-id="e2d67-202">To transform information from a hierarchical namespace into a flat namespace, sync engine uses placeholders to preserve the hierarchy.</span></span>

<span data-ttu-id="e2d67-203">每個預留位置均代表物件的階層名稱元件 (例如，組織單位)，而且該物件尚未匯入同步處理引擎，但需要建構階層式名稱。</span><span class="sxs-lookup"><span data-stu-id="e2d67-203">Each placeholder represents a component (for example, an organizational unit) of an object's hierarchical name that has not been imported into sync engine but is required to construct the hierarchical name.</span></span> <span data-ttu-id="e2d67-204">預留位置會填補在連接的資料來源中參考不是連接器空間中預備物件的物件所產生的間距。</span><span class="sxs-lookup"><span data-stu-id="e2d67-204">They fill gaps created by references in the connected data source to objects that are not staging objects in the connector space.</span></span>

<span data-ttu-id="e2d67-205">同步處理引擎也會使用預留位置來儲存尚未匯入的參考物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-205">The sync engine also uses placeholders to store referenced objects that have not yet been imported.</span></span> <span data-ttu-id="e2d67-206">例如，如果已設定同步處理要包含 *Abbie Spencer* 物件的管理員屬性，而且接收的值是尚未匯入的物件 (例如 *CN=Lee Sperry,CN=Users,DC=fabrikam,DC=com)*，則管理員資訊會儲存為連接器空間中的預留位置。</span><span class="sxs-lookup"><span data-stu-id="e2d67-206">For example, if sync is configured to include the manager attribute for the *Abbie Spencer* object and the received value is an object that has not been imported yet, such as *CN=Lee Sperry,CN=Users,DC=fabrikam,DC=com*, the manager information is stored as placeholders in the connector space.</span></span> <span data-ttu-id="e2d67-207">如果稍後匯入管理員物件，則代表此管理員的預備物件會覆寫預留位置物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-207">If the manager object is later imported, the placeholder object is overwritten by the staging object that represents the manager.</span></span>

### <a name="metaverse-objects"></a><span data-ttu-id="e2d67-208">Metaverse 物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-208">Metaverse objects</span></span>
<span data-ttu-id="e2d67-209">Metaverse 物件包含同步處理引擎具有的連接器空間中預備物件的彙總檢視。</span><span class="sxs-lookup"><span data-stu-id="e2d67-209">A metaverse object contains the aggregated view that sync engine has of the staging objects in the connector space.</span></span> <span data-ttu-id="e2d67-210">同步處理引擎會使用匯入物件中的資訊建立 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-210">Sync engine creates metaverse objects by using the information in import objects.</span></span> <span data-ttu-id="e2d67-211">數個連接器空間物件可以連結至單一 Metaverse 物件，但連接器空間物件無法連結到一個以上的 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-211">Several connector space objects can be linked to a single metaverse object, but a connector space object cannot be linked to more than one metaverse object.</span></span>

<span data-ttu-id="e2d67-212">無法以手動方式建立或刪除 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-212">Metaverse objects cannot be manually created or deleted.</span></span> <span data-ttu-id="e2d67-213">同步處理引擎會自動刪除沒有連接器空間中任何連接器空間物件之連結的 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-213">The sync engine automatically deletes metaverse objects that do not have a link to any connector space object in the connector space.</span></span>

<span data-ttu-id="e2d67-214">若要將連接的資料來源中的物件對應至 Metaverse 中對應的物件類型，同步處理引擎會提供可延伸的結構描述，其中包含一組預先定義的物件類型和相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-214">To map objects within a connected data source to a corresponding object type within the metaverse, sync engine provides an extensible schema with a predefined set of object types and associated attributes.</span></span> <span data-ttu-id="e2d67-215">您可以為 metaverse 物件建立新的物件類型和屬性。</span><span class="sxs-lookup"><span data-stu-id="e2d67-215">You can create new object types and attributes for metaverse objects.</span></span> <span data-ttu-id="e2d67-216">屬性可以有單一值或多個值，而屬性類型可以是字串、參考、數字和布林值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-216">Attributes can be single-valued or multivalued, and the attribute types can be strings, references, numbers, and Boolean values.</span></span>

### <a name="relationships-between-staging-objects-and-metaverse-objects"></a><span data-ttu-id="e2d67-217">預備物件和 Metaverse 物件之間的關聯性</span><span class="sxs-lookup"><span data-stu-id="e2d67-217">Relationships between staging objects and metaverse objects</span></span>
<span data-ttu-id="e2d67-218">在同步處理引擎命名空間內，預備物件和 Metaverse 物件之間的連結關聯性會啟用資料流。</span><span class="sxs-lookup"><span data-stu-id="e2d67-218">Within the sync engine namespace, the data flow is enabled by the link relationship between staging objects and metaverse objects.</span></span> <span data-ttu-id="e2d67-219">連結至 Metaverse 物件的預備物件稱為**聯結的物件** (或**連接器物件**)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-219">A staging object that is linked to a metaverse object is called a **joined object** (or **connector object**).</span></span> <span data-ttu-id="e2d67-220">未連結至 Metaverse 物件的預備物件稱為**分離的物件** (或**中斷器物件**)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-220">A staging object that is not linked to a metaverse object is called a **disjoined object** (or **disconnector object**).</span></span> <span data-ttu-id="e2d67-221">偏好使用聯結和分離詞彙，才不會與負責從連接的目錄匯入和匯出資料的連接器混淆。</span><span class="sxs-lookup"><span data-stu-id="e2d67-221">The terms joined and disjoined are preferred to not confuse with the Connectors responsible for importing and exporting data from a connected directory.</span></span>

<span data-ttu-id="e2d67-222">預留位置永遠不會連結至 Metaverse 物件</span><span class="sxs-lookup"><span data-stu-id="e2d67-222">Placeholders are never linked to a metaverse object</span></span>

<span data-ttu-id="e2d67-223">聯結的物件是由預備物件及其對單一 Metaverse 物件的連結關聯性所組成。</span><span class="sxs-lookup"><span data-stu-id="e2d67-223">A joined object comprises a staging object and its linked relationship to a single metaverse object.</span></span> <span data-ttu-id="e2d67-224">聯結的物件用來同步處理連接器空間物件與 Metaverse 物件之間的屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-224">Joined objects are used to synchronize attribute values between a connector space object and a metaverse object.</span></span>

<span data-ttu-id="e2d67-225">當預備物件在同步處理期間變成聯結的物件時，屬性可以在預備物件與 Metaverse 物件之間流動。</span><span class="sxs-lookup"><span data-stu-id="e2d67-225">When a staging object becomes a joined object during synchronization, attributes can flow between the staging object and the metaverse object.</span></span> <span data-ttu-id="e2d67-226">屬性流程是雙向的，並可使用匯入屬性規則和匯出屬性規則加以設定。</span><span class="sxs-lookup"><span data-stu-id="e2d67-226">Attribute flow is bidirectional and is configured by using import attribute rules and export attribute rules.</span></span>

<span data-ttu-id="e2d67-227">單一連接器空間物件只可以連結至一個 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-227">A single connector space object can be linked to only one metaverse object.</span></span> <span data-ttu-id="e2d67-228">不過，每個 Metaverse 物件可以連結至相同或不同連接器空間中的多個連接器空間物件，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="e2d67-228">However, each metaverse object can be linked to multiple connector space objects in the same or in different connector spaces, as shown in the following illustration.</span></span>

![Arch5](./media/active-directory-aadconnectsync-understanding-architecture/arch5.png)

<span data-ttu-id="e2d67-230">預備物件與 Metaverse 物件之間的連結關聯性持續存在，只能依據您指定的規則加以移除。</span><span class="sxs-lookup"><span data-stu-id="e2d67-230">The linked relationship between the staging object and a metaverse object is persistent and can be removed only by rules that you specify.</span></span>

<span data-ttu-id="e2d67-231">分離的物件式未連結至任何 Metaverse 物件的預備物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-231">A disjoined object is a staging object that is not linked to any metaverse object.</span></span> <span data-ttu-id="e2d67-232">在 Metaverse 中，分離物件的屬性值不會再做進一步的處理。</span><span class="sxs-lookup"><span data-stu-id="e2d67-232">The attribute values of a disjoined object are not processed any further within the metaverse.</span></span> <span data-ttu-id="e2d67-233">同步處理引擎不會更新連接的資料來源中對應物件的屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-233">The attribute values of the corresponding object in the connected data source are not updated by sync engine.</span></span>

<span data-ttu-id="e2d67-234">使用分離的物件，可以將身分識別資訊儲存在同步處理引擎，稍後進行處理。</span><span class="sxs-lookup"><span data-stu-id="e2d67-234">By using disjoined objects, you can store identity information in sync engine and process it later.</span></span> <span data-ttu-id="e2d67-235">將預備物件保持為連接器空間中的分離物件有許多好處。</span><span class="sxs-lookup"><span data-stu-id="e2d67-235">Keeping a staging object as a disjoined object in the connector space has many advantages.</span></span> <span data-ttu-id="e2d67-236">因為系統已預備此物件的必要資訊，所以不需要在下一次從連接的資料來源匯入期間建立此物件的代表項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-236">Because the system has already staged the required information about this object, it is not necessary to create a representation of this object again during the next import from the connected data source.</span></span> <span data-ttu-id="e2d67-237">如此一來，同步處理引擎一律有連接的資料來源完整快照，即使目前沒有連接的資料來源連線亦然。</span><span class="sxs-lookup"><span data-stu-id="e2d67-237">This way, sync engine always has a complete snapshot of the connected data source, even if there is no current connection to the connected data source.</span></span> <span data-ttu-id="e2d67-238">根據您指定的規則而定，分離物件可以轉換為聯結物件，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="e2d67-238">Disjoined objects can be converted into joined objects, and vice versa, depending on the rules that you specify.</span></span>

<span data-ttu-id="e2d67-239">匯入物件會建立為分離物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-239">An import object is created as a disjoined object.</span></span> <span data-ttu-id="e2d67-240">匯出物件必須是聯結物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-240">An export object must be a joined object.</span></span> <span data-ttu-id="e2d67-241">系統邏輯會強制執行這項規則，並刪除每一個不是聯結物件的匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-241">The system logic enforces this rule and deletes every export object that is not a joined object.</span></span>

## <a name="sync-engine-identity-management-process"></a><span data-ttu-id="e2d67-242">同步處理引擎身分識別管理程序</span><span class="sxs-lookup"><span data-stu-id="e2d67-242">Sync engine identity management process</span></span>
<span data-ttu-id="e2d67-243">身分識別管理程序可控制在不同的連接資料來源之間更新身分識別資訊的方式。</span><span class="sxs-lookup"><span data-stu-id="e2d67-243">The identity management process controls how identity information is updated between different connected data sources.</span></span> <span data-ttu-id="e2d67-244">身分識別管理可分為三個程序：</span><span class="sxs-lookup"><span data-stu-id="e2d67-244">Identity management occurs in three processes:</span></span>

* <span data-ttu-id="e2d67-245">Import</span><span class="sxs-lookup"><span data-stu-id="e2d67-245">Import</span></span>
* <span data-ttu-id="e2d67-246">同步處理</span><span class="sxs-lookup"><span data-stu-id="e2d67-246">Synchronization</span></span>
* <span data-ttu-id="e2d67-247">匯出</span><span class="sxs-lookup"><span data-stu-id="e2d67-247">Export</span></span>

<span data-ttu-id="e2d67-248">在匯入過程中，同步處理引擎會評估從連接的資料來源傳入的身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-248">During the import process, sync engine evaluates the incoming identity information from a connected data source.</span></span> <span data-ttu-id="e2d67-249">偵測到變更時，它會在連接器空間中建立新的預備物件或更新現有預備物件以便進行同步處理。</span><span class="sxs-lookup"><span data-stu-id="e2d67-249">When changes are detected, it either creates new staging objects or updates existing staging objects in the connector space for synchronization.</span></span>

<span data-ttu-id="e2d67-250">在同步處理過程中，同步處理引擎會更新 Metaverse 以反映連接器空間中所發生的變更，並更新連接器空間以反映 Metaverse 中所發生的變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-250">During the synchronization process, sync engine updates the metaverse to reflect changes that have occurred in the connector space and updates the connector space to reflect changes that have occurred in the metaverse.</span></span>

<span data-ttu-id="e2d67-251">在匯出過程中，同步處理引擎會推送預備物件上預備的變更以及標示為「擱置匯出」的變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-251">During the export process, sync engine pushes out changes that are staged on staging objects and that are flagged as pending export.</span></span>

<span data-ttu-id="e2d67-252">下圖顯示當身分識別資訊在兩個連接的資料來源之間流動時，發生每個程序的位置。</span><span class="sxs-lookup"><span data-stu-id="e2d67-252">The following illustration shows where each of the processes occurs as identity information flows from one connected data source to another.</span></span>

![Arch6](./media/active-directory-aadconnectsync-understanding-architecture/arch6.png)

### <a name="import-process"></a><span data-ttu-id="e2d67-254">匯入程序</span><span class="sxs-lookup"><span data-stu-id="e2d67-254">Import process</span></span>
<span data-ttu-id="e2d67-255">在匯入過程中，同步處理引擎會評估身分識別資訊的更新。</span><span class="sxs-lookup"><span data-stu-id="e2d67-255">During the import process, sync engine evaluates updates to identity information.</span></span> <span data-ttu-id="e2d67-256">同步處理引擎會比較從連接的資料來源收到的身分識別資訊與預備物件的身分識別資訊，以判斷預備物件是否需要更新。</span><span class="sxs-lookup"><span data-stu-id="e2d67-256">Sync engine compares the identity information received from the connected data source with the identity information about a staging object and determines whether the staging object requires updates.</span></span> <span data-ttu-id="e2d67-257">如果必須使用新資料更新預備物件，則預備物件會標示為「擱置匯入」。</span><span class="sxs-lookup"><span data-stu-id="e2d67-257">If it is necessary to update the staging object with new data, the staging object is flagged as pending import.</span></span>

<span data-ttu-id="e2d67-258">在同步處理之前預備連接器空間中的物件，同步處理引擎即可只處理已變更的身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-258">By staging objects in the connector space before synchronization, sync engine can process only the identity information that has changed.</span></span> <span data-ttu-id="e2d67-259">此處理可提供下列優點：</span><span class="sxs-lookup"><span data-stu-id="e2d67-259">This process provides the following benefits:</span></span>

* <span data-ttu-id="e2d67-260">**有效率的同步處理**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-260">**Efficient synchronization**.</span></span> <span data-ttu-id="e2d67-261">在同步處理期間處理的資料量降到最低。</span><span class="sxs-lookup"><span data-stu-id="e2d67-261">The amount of data processed during synchronization is minimized.</span></span>
* <span data-ttu-id="e2d67-262">**有效率的重新同步處理**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-262">**Efficient resynchronization**.</span></span> <span data-ttu-id="e2d67-263">您可以變更同步處理引擎處理身分識別資訊的方式，而不需要將同步處理引擎重新連接到資料來源。</span><span class="sxs-lookup"><span data-stu-id="e2d67-263">You can change how sync engine processes identity information without reconnecting the sync engine to the data source.</span></span>
* <span data-ttu-id="e2d67-264">**有機會預覽同步處理**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-264">**Opportunity to preview synchronization**.</span></span> <span data-ttu-id="e2d67-265">您可以預覽同步處理，以驗證您對於身分識別管理程序的相關假設是否正確。</span><span class="sxs-lookup"><span data-stu-id="e2d67-265">You can preview synchronization to verify that your assumptions about the identity management process are correct.</span></span>

<span data-ttu-id="e2d67-266">對於連接器中指定的每個物件，同步處理引擎會先試著在連接器的連接器空間中尋找該物件的代表項目。</span><span class="sxs-lookup"><span data-stu-id="e2d67-266">For each object specified in the Connector, the sync engine first tries to locate a representation of the object in the connector space of the Connector.</span></span> <span data-ttu-id="e2d67-267">同步處理引擎會檢查連接器空間中所有的預備物件，並嘗試尋找具有相符錨點屬性的對應預備物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-267">Sync engine examines all staging objects in the connector space and tries to find a corresponding staging object that has a matching anchor attribute.</span></span> <span data-ttu-id="e2d67-268">如果現有預備物件都沒有相符的錨點屬性，則同步處理引擎會嘗試尋找具有相同辨別名稱的對應預備物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-268">If no existing staging object has a matching anchor attribute, sync engine tries to find a corresponding staging object with the same distinguished name.</span></span>

<span data-ttu-id="e2d67-269">當同步處理引擎找到辨別名稱相符，但錨點不符的預備物件時，就會發生下列特殊行為：</span><span class="sxs-lookup"><span data-stu-id="e2d67-269">When sync engine finds a staging object that matches by distinguished name but not by anchor, the following special behavior occurs:</span></span>

* <span data-ttu-id="e2d67-270">如果連接器空間中找到的物件沒有錨點，則同步處理引擎會從連接器空間中移除此物件，並將其連結至的 Metaverse 物件標記為 [在下一次執行同步處理時重試佈建] 。</span><span class="sxs-lookup"><span data-stu-id="e2d67-270">If the object located in the connector space has no anchor, then sync engine removes this object from the connector space and marks the metaverse object it is linked to as **retry provisioning on next synchronization run**.</span></span> <span data-ttu-id="e2d67-271">它會接著建立新的匯入物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-271">Then it creates the new import object.</span></span>
* <span data-ttu-id="e2d67-272">如果連接器空間中找到的物件具有錨點，則同步處理引擎會假設此物件已在連接的目錄中重新命名或遭到刪除。</span><span class="sxs-lookup"><span data-stu-id="e2d67-272">If the object located in the connector space has an anchor, then sync engine assumes that this object has either been renamed or deleted in the connected directory.</span></span> <span data-ttu-id="e2d67-273">它會為連接器空間物件指派新的暫時辨別名稱，以便預備連入的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-273">It assigns a temporary, new distinguished name for the connector space object so that it can stage the incoming object.</span></span> <span data-ttu-id="e2d67-274">舊物件就會變成 **暫時性**，等待連接器匯入重新命名或刪除內容，以解決這種狀況。</span><span class="sxs-lookup"><span data-stu-id="e2d67-274">The old object then becomes **transient**, waiting for the Connector to import the rename or deletion to resolve the situation.</span></span>

<span data-ttu-id="e2d67-275">如果同步處理引擎找到的預備物件對應至連接器中指定的物件，它會判斷要套用哪一種變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-275">If sync engine locates a staging object that corresponds to the object specified in the Connector, it determines what kind of changes to apply.</span></span> <span data-ttu-id="e2d67-276">例如，同步處理引擎可能會在連接的資料來源中重新命名或刪除此物件，或者可能只更新此物件的屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-276">For example, sync engine might rename or delete the object in the connected data source, or it might only update the object’s attribute values.</span></span>

<span data-ttu-id="e2d67-277">具有更新後資料的預備物件會標示為「擱置匯入」。</span><span class="sxs-lookup"><span data-stu-id="e2d67-277">Staging objects with updated data are marked as pending import.</span></span> <span data-ttu-id="e2d67-278">有不同的暫止匯入類型可以使用。</span><span class="sxs-lookup"><span data-stu-id="e2d67-278">Different types of pending imports are available.</span></span> <span data-ttu-id="e2d67-279">視匯入程序的結果而定，連接器空間中的預備物件具有下列其中一種擱置匯入類型：</span><span class="sxs-lookup"><span data-stu-id="e2d67-279">Depending on the result of the import process, a staging object in the connector space has one of the following pending import types:</span></span>

* <span data-ttu-id="e2d67-280">**無**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-280">**None**.</span></span> <span data-ttu-id="e2d67-281">預備物件的任何屬性均沒有可用的變更。</span><span class="sxs-lookup"><span data-stu-id="e2d67-281">No changes to any of the attributes of the staging object are available.</span></span> <span data-ttu-id="e2d67-282">同步處理引擎不會將此類型標示為「擱置匯入」。</span><span class="sxs-lookup"><span data-stu-id="e2d67-282">Sync engine does not flag this type as pending import.</span></span>
* <span data-ttu-id="e2d67-283">**新增**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-283">**Add**.</span></span> <span data-ttu-id="e2d67-284">預備物件是連接器空間中新的匯入物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-284">The staging object is a new import object in the connector space.</span></span> <span data-ttu-id="e2d67-285">同步處理引擎會將此類型標示為「擱置匯入」，以便在 Metaverse 中進行其他處理。</span><span class="sxs-lookup"><span data-stu-id="e2d67-285">Sync engine flags this type as pending import for additional processing in the metaverse.</span></span>
* <span data-ttu-id="e2d67-286">**更新**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-286">**Update**.</span></span> <span data-ttu-id="e2d67-287">同步處理引擎會在連接器空間中尋找對應的預備物件並此類型標示為「擱置匯入」，以便在 Metaverse 中處理屬性更新。</span><span class="sxs-lookup"><span data-stu-id="e2d67-287">Sync engine finds a corresponding staging object in the connector space and flags this type as pending import so that updates to the attributes can be processed in the metaverse.</span></span> <span data-ttu-id="e2d67-288">更新包含物件重新命名。</span><span class="sxs-lookup"><span data-stu-id="e2d67-288">Updates include object renaming.</span></span>
* <span data-ttu-id="e2d67-289">**刪除**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-289">**Delete**.</span></span> <span data-ttu-id="e2d67-290">同步處理引擎會在連接器空間中尋找對應的預備物件並將此類型標示為「擱置匯入」，以便刪除聯結的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-290">Sync engine finds a corresponding staging object in the connector space and flags this type as pending import so that the joined object can be deleted.</span></span>
* <span data-ttu-id="e2d67-291">**刪除/新增**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-291">**Delete/Add**.</span></span> <span data-ttu-id="e2d67-292">同步處理引擎會在連接器空間中尋找對應的預備物件，但物件類型不相符。</span><span class="sxs-lookup"><span data-stu-id="e2d67-292">Sync engine finds a corresponding staging object in the connector space, but the object types do not match.</span></span> <span data-ttu-id="e2d67-293">在此情況下，會預備刪除-新增的修改。</span><span class="sxs-lookup"><span data-stu-id="e2d67-293">In this case, a delete-add modification is staged.</span></span> <span data-ttu-id="e2d67-294">刪除-新增的修改會向同步處理引擎表示必須進行此物件的完整重新同步處理，因為物件類型變更時此物件會套用不同的規則組合。</span><span class="sxs-lookup"><span data-stu-id="e2d67-294">A delete-add modification indicates to the sync engine that a complete resynchronization of this object must occur because different sets of rules apply to this object when the object type changes.</span></span>

<span data-ttu-id="e2d67-295">設定預備物件的擱置匯入狀態，就可以大幅減少在同步處理期間處理的資料量，因為這麼做可讓系統只處理已更新資料的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-295">By setting the pending import status of a staging object, it is possible to reduce significantly the amount of data processed during synchronization because doing so allows the system to process only those objects that have updated data.</span></span>

### <a name="synchronization-process"></a><span data-ttu-id="e2d67-296">同步處理程序</span><span class="sxs-lookup"><span data-stu-id="e2d67-296">Synchronization process</span></span>
<span data-ttu-id="e2d67-297">同步處理是由兩個相關的程序所組成：</span><span class="sxs-lookup"><span data-stu-id="e2d67-297">Synchronization consists of two related processes:</span></span>

* <span data-ttu-id="e2d67-298">輸入同步處理：適用於使用連接器空間中的資料更新 Metaverse 的內容時。</span><span class="sxs-lookup"><span data-stu-id="e2d67-298">Inbound synchronization, when the content of the metaverse is updated by using the data in the connector space.</span></span>
* <span data-ttu-id="e2d67-299">輸出同步處理：適用於使用 Metaverse 中的資料更新連接器空間的內容時。</span><span class="sxs-lookup"><span data-stu-id="e2d67-299">Outbound synchronization, when the content of the connector space is updated by using data in the metaverse.</span></span>

<span data-ttu-id="e2d67-300">輸入同步處理程序可使用連接器空間中預備的資訊，在 Metaverse 中為儲存在連接的資料來源中的資料建立整合式檢視。</span><span class="sxs-lookup"><span data-stu-id="e2d67-300">By using the information staged in the connector space, the inbound synchronization process creates in the metaverse the integrated view of the data that is stored in the connected data sources.</span></span> <span data-ttu-id="e2d67-301">根據規則的設定方式而定，彙總所有的預備物件或僅限具有擱置匯入資訊的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-301">Either all staging objects or only those with a pending import information are aggregated, depending on how the rules are configured.</span></span>

<span data-ttu-id="e2d67-302">輸出同步處理程序會在 Metaverse 物件變更時更新匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-302">The outbound synchronization process updates export objects when metaverse objects change.</span></span>

<span data-ttu-id="e2d67-303">輸入同步處理會在 Metaverse 中為從連接的資料來源接收的身分識別資訊建立整合式檢視。</span><span class="sxs-lookup"><span data-stu-id="e2d67-303">Inbound synchronization creates the integrated view in the metaverse of the identity information that is received from the connected data sources.</span></span> <span data-ttu-id="e2d67-304">同步處理引擎可以使用連接的資料來源中最新的身分識別資訊，隨時處理身分識別資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-304">Sync engine can process identity information at any time by using the latest identity information that it has from the connected data source.</span></span>

<span data-ttu-id="e2d67-305">**輸入同步處理**</span><span class="sxs-lookup"><span data-stu-id="e2d67-305">**Inbound synchronization**</span></span>

<span data-ttu-id="e2d67-306">輸入同步處理包含下列程序：</span><span class="sxs-lookup"><span data-stu-id="e2d67-306">Inbound synchronization includes the following processes:</span></span>

* <span data-ttu-id="e2d67-307">**佈建** (也稱為**投射**，如果一定要區分此程序與輸出同步處理佈建)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-307">**Provision** (also called **Projection** if it is important to distinguish this process from outbound synchronization provisioning).</span></span> <span data-ttu-id="e2d67-308">同步處理引擎會根據預備物件建立新的 Metaverse 物件並連結它們。</span><span class="sxs-lookup"><span data-stu-id="e2d67-308">The Sync engine creates a new metaverse object based on a staging object and links them.</span></span> <span data-ttu-id="e2d67-309">佈建是物件層級作業。</span><span class="sxs-lookup"><span data-stu-id="e2d67-309">Provision is an object-level operation.</span></span>
* <span data-ttu-id="e2d67-310">**聯結**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-310">**Join**.</span></span> <span data-ttu-id="e2d67-311">同步處理引擎會將預備物件連結至現有的 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-311">The Sync engine links a staging object to an existing metaverse object.</span></span> <span data-ttu-id="e2d67-312">聯結是物件層級作業。</span><span class="sxs-lookup"><span data-stu-id="e2d67-312">A join is an object-level operation.</span></span>
* <span data-ttu-id="e2d67-313">**匯入屬性流程**。</span><span class="sxs-lookup"><span data-stu-id="e2d67-313">**Import attribute flow**.</span></span> <span data-ttu-id="e2d67-314">同步處理引擎會更新 Metaverse 中物件的屬性值 (稱為屬性流程)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-314">Sync engine updates the attribute values, called attribute flow, of the object in the metaverse.</span></span> <span data-ttu-id="e2d67-315">匯入屬性流程是屬性層級作業，其需要預備物件與 Metaverse 物件之間的連結。</span><span class="sxs-lookup"><span data-stu-id="e2d67-315">Import attribute flow is an attribute-level operation that requires a link between a staging object and a metaverse object.</span></span>

<span data-ttu-id="e2d67-316">佈建是唯一可在 Metaverse 中建立物件的程序。</span><span class="sxs-lookup"><span data-stu-id="e2d67-316">Provision is the only process that creates objects in the metaverse.</span></span> <span data-ttu-id="e2d67-317">佈建只會影響屬於分離物件的匯入物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-317">Provision affects only import objects that are disjoined objects.</span></span> <span data-ttu-id="e2d67-318">在佈建期間，同步處理引擎會建立 Metaverse 物件 (其對應至匯入物件的物件類型)，並且建立這兩個物件間的連結，進而建立聯結的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-318">During provision, sync engine creates a metaverse object that corresponds to the object type of the import object and establishes a link between both objects, thus creating a joined object.</span></span>

<span data-ttu-id="e2d67-319">聯結程序還會建立匯入物件與 Metaverse 物件之間的連結。</span><span class="sxs-lookup"><span data-stu-id="e2d67-319">The join process also establishes a link between import objects and a metaverse object.</span></span> <span data-ttu-id="e2d67-320">聯結與佈建的差異在於聯結程序要求匯入物件連結至現有的 Metaverse 物件，而佈建程序會建立新的 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-320">The difference between join and provision is that the join process requires that the import object are linked to an existing metaverse object, where the provision process creates a new metaverse object.</span></span>

<span data-ttu-id="e2d67-321">同步處理引擎會使用在同步處理規則組態中指定的準則，嘗試將匯入物件聯結至 Metaverse 物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-321">Sync engine tries to join an import object to a metaverse object by using criteria that is specified in the Synchronization Rule configuration.</span></span>

<span data-ttu-id="e2d67-322">在佈建或聯結過程中，同步處理引擎會將分離物件連結到 Metaverse 物件，使它們聯結在一起。</span><span class="sxs-lookup"><span data-stu-id="e2d67-322">During the provision and join processes, sync engine links a disjoined object to a metaverse object, making them joined.</span></span> <span data-ttu-id="e2d67-323">在完成這些物件層級的作業之後，同步處理引擎可以更新相關聯 Metaverse 物件的屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-323">After these object-level operations are completed, sync engine can update the attribute values of the associated metaverse object.</span></span> <span data-ttu-id="e2d67-324">此程序稱為匯入屬性流程。</span><span class="sxs-lookup"><span data-stu-id="e2d67-324">This process is called import attribute flow.</span></span>

<span data-ttu-id="e2d67-325">匯入屬性流程發生於帶有新資料並連結至 Metaverse 物件的所有匯入物件上。</span><span class="sxs-lookup"><span data-stu-id="e2d67-325">Import attribute flow occurs on all import objects that carry new data and are linked to a metaverse object.</span></span>

<span data-ttu-id="e2d67-326">**輸出同步處理**</span><span class="sxs-lookup"><span data-stu-id="e2d67-326">**Outbound synchronization**</span></span>

<span data-ttu-id="e2d67-327">輸出同步處理會在 Metaverse 物件變更但未刪除時更新匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-327">Outbound synchronization updates export objects when a metaverse object change but is not deleted.</span></span> <span data-ttu-id="e2d67-328">輸出同步處理的目標是要評估變更 Metaverse 物件是否需要更新連接器空間中的預備物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-328">The objective of outbound synchronization is to evaluate whether changes to metaverse objects require updates to staging objects in the connector spaces.</span></span> <span data-ttu-id="e2d67-329">在某些情況下，變更可以要求更新所有連接器空間中的預備物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-329">In some cases, the changes can require that staging objects in all connector spaces be updated.</span></span> <span data-ttu-id="e2d67-330">變更的預備物件會標示為「擱置匯出」，並使其成為匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-330">Staging objects that are changed are flagged as pending export, making them export objects.</span></span> <span data-ttu-id="e2d67-331">這些匯出物件稍後會在匯出過程中推送到連接的資料來源。</span><span class="sxs-lookup"><span data-stu-id="e2d67-331">These export objects are later pushed out to the connected data source during the export process.</span></span>

<span data-ttu-id="e2d67-332">輸出同步處理有三個程序：</span><span class="sxs-lookup"><span data-stu-id="e2d67-332">Outbound synchronization has three processes:</span></span>

* <span data-ttu-id="e2d67-333">**佈建**</span><span class="sxs-lookup"><span data-stu-id="e2d67-333">**Provisioning**</span></span>
* <span data-ttu-id="e2d67-334">**解除佈建**</span><span class="sxs-lookup"><span data-stu-id="e2d67-334">**Deprovisioning**</span></span>
* <span data-ttu-id="e2d67-335">**匯出屬性流程**</span><span class="sxs-lookup"><span data-stu-id="e2d67-335">**Export attribute flow**</span></span>

<span data-ttu-id="e2d67-336">佈建和解除佈建都是物件層級的作業。</span><span class="sxs-lookup"><span data-stu-id="e2d67-336">Provisioning and deprovisioning are both object-level operations.</span></span> <span data-ttu-id="e2d67-337">解除佈建相依於佈建，因為只有佈建可以啟始它。</span><span class="sxs-lookup"><span data-stu-id="e2d67-337">Deprovisioning depends on provisioning because only provisioning can initiate it.</span></span> <span data-ttu-id="e2d67-338">當佈建移除 Metaverse 物件與匯出物件之間的連結時，就會觸發解除佈建。</span><span class="sxs-lookup"><span data-stu-id="e2d67-338">Deprovisioning is triggered when provisioning removes the link between a metaverse object and an export object.</span></span>

<span data-ttu-id="e2d67-339">將變更套用至 Metaverse 中的物件時，一律會觸發佈建。</span><span class="sxs-lookup"><span data-stu-id="e2d67-339">Provisioning is always triggered when changes are applied to objects in the metaverse.</span></span> <span data-ttu-id="e2d67-340">對 Metaverse 物件進行變更時，同步處理引擎可以在佈建過程中執行下列任何一項工作：</span><span class="sxs-lookup"><span data-stu-id="e2d67-340">When changes are made to metaverse objects, sync engine can perform any of the following tasks as part of the provisioning process:</span></span>

* <span data-ttu-id="e2d67-341">建立聯結的物件，其中 Metaverse 物件會連結至新建立的匯出物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-341">Create joined objects, where a metaverse object is linked to a newly created export object.</span></span>
* <span data-ttu-id="e2d67-342">重新命名聯結的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-342">Rename a joined object.</span></span>
* <span data-ttu-id="e2d67-343">斷開 Metaverse 物件與預備物件之間的連結，進而建立分離的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-343">Disjoin links between a metaverse object and staging objects, creating a disjoined object.</span></span>

<span data-ttu-id="e2d67-344">如果佈建要求同步處理引擎建立新的連接器物件，則 Metaverse 物件連結至的預備物件一律為匯出物件，因為該物件會尚未存在於連接的資料來源中。</span><span class="sxs-lookup"><span data-stu-id="e2d67-344">If provisioning requires sync engine to create a new connector object, the staging object to which the metaverse object is linked is always an export object, because the object does not yet exist in the connected data source.</span></span>

<span data-ttu-id="e2d67-345">如果佈建要求同步處理引擎分開聯結的物件，進而分離的物件，則會觸發解除佈建。</span><span class="sxs-lookup"><span data-stu-id="e2d67-345">If provisioning requires sync engine to disjoin a joined object, creating a disjoined object, deprovisioning is triggered.</span></span> <span data-ttu-id="e2d67-346">解除佈建程序會刪除此物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-346">The deprovisioning process deletes the object.</span></span>

<span data-ttu-id="e2d67-347">在解除佈建期間，刪除匯出物件並不會實際刪除此物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-347">During deprovisioning, deleting an export object does not physically delete the object.</span></span> <span data-ttu-id="e2d67-348">此物件會標示為 [已刪除] ，這表示物件上已預備刪除作業。</span><span class="sxs-lookup"><span data-stu-id="e2d67-348">The object is flagged as **deleted**, which means that the delete operation is staged on the object.</span></span>

<span data-ttu-id="e2d67-349">匯出屬性流程也會發生在輸出同步處理過程中，就類似於匯入屬性流程發生於輸入同步處理期間。</span><span class="sxs-lookup"><span data-stu-id="e2d67-349">Export attribute flow also occurs during the outbound synchronization process, similar to the way that import attribute flow occurs during inbound synchronization.</span></span> <span data-ttu-id="e2d67-350">匯出屬性流程只會發生於聯結的 Metaverse 與匯出物件之間。</span><span class="sxs-lookup"><span data-stu-id="e2d67-350">Export attribute flow occurs only between metaverse and export objects that are joined.</span></span>

### <a name="export-process"></a><span data-ttu-id="e2d67-351">匯出程序</span><span class="sxs-lookup"><span data-stu-id="e2d67-351">Export process</span></span>
<span data-ttu-id="e2d67-352">在匯出過程中，同步處理引擎會檢查連接器空間中所有標示為「擱置匯出」的匯出物件，然後將更新傳送到連接的資料來源。</span><span class="sxs-lookup"><span data-stu-id="e2d67-352">During the export process, sync engine examines all export objects that are flagged as pending export in the connector space, and then sends updates to the connected data source.</span></span>

<span data-ttu-id="e2d67-353">同步處理引擎可以判斷匯出是否成功，但無法充分判斷身分識別管理程序是否完成。</span><span class="sxs-lookup"><span data-stu-id="e2d67-353">The sync engine can determine the success of an export but it cannot sufficiently determine that the identity management process is complete.</span></span> <span data-ttu-id="e2d67-354">其他程序永遠可以變更連接的資料來源中的物件。</span><span class="sxs-lookup"><span data-stu-id="e2d67-354">Objects in the connected data source can always be changed by other processes.</span></span> <span data-ttu-id="e2d67-355">因為同步處理引擎對於連接的資料來源沒有持續連線，所以無法只根據成功匯出通知，對連接的資料來源中的物件屬性進行假設。</span><span class="sxs-lookup"><span data-stu-id="e2d67-355">Because sync engine does not have a persistent connection to the connected data source, it is not sufficient to make assumptions about the properties of an object in the connected data source based only on a successful export notification.</span></span>

<span data-ttu-id="e2d67-356">例如，連接的資料來源中的程序可以將物件的屬性變回其原始值 (也就是說，連接的資料來源可以在同步處理引擎推送資料並成功套用於連接的資料來源之後，立即覆寫這些值)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-356">For example, a process in the connected data source could change the object’s attributes back to their original values (that is, the connected data source could overwrite the values immediately after the data is pushed out by sync engine and successfully applied in the connected data source).</span></span>

<span data-ttu-id="e2d67-357">同步處理引擎會儲存有關每個預備物件的匯出和匯入狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="e2d67-357">The sync engine stores export and import status information about each staging object.</span></span> <span data-ttu-id="e2d67-358">自從上次匯出以後，如果在屬性包含清單中指定的屬性值已變更，則儲存匯入和匯出狀態可讓同步處理引擎做出適當的回應。</span><span class="sxs-lookup"><span data-stu-id="e2d67-358">If values of the attributes that are specified in the attribute inclusion list have changed since the last export, the storage of import and export status enables sync engine to react appropriately.</span></span> <span data-ttu-id="e2d67-359">同步處理引擎會使用匯入程序來確認已匯出到連接的資料來源的屬性值。</span><span class="sxs-lookup"><span data-stu-id="e2d67-359">Sync engine uses the import process to confirm attribute values that have been exported to the connected data source.</span></span> <span data-ttu-id="e2d67-360">如下圖所示，比較匯入和匯出的資訊，可讓同步處理引擎判斷匯出是否成功或是否需要重複執行。</span><span class="sxs-lookup"><span data-stu-id="e2d67-360">A comparison between the imported and exported information, as shown in the following illustration, enables sync engine to determine whether the export was successful or if it needs to be repeated.</span></span>

![Arch7](./media/active-directory-aadconnectsync-understanding-architecture/arch7.png)

<span data-ttu-id="e2d67-362">例如，如果同步處理引擎將值為 5 的屬性 C 匯出至連接的資料來源，它會在匯出狀態記憶體中儲存 C=5。</span><span class="sxs-lookup"><span data-stu-id="e2d67-362">For example, if sync engine exports attribute C, which has a value of 5, to a connected data source, it stores C=5 in its export status memory.</span></span> <span data-ttu-id="e2d67-363">此物件的每次額外匯出都會導致嘗試再度將 C=5 匯出到連接的資料來源，因為同步處理引擎假設此值尚未持續地套用至物件 (也就是說，除非最近從連接的資料來源匯入了不同的值)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-363">Each additional export on this object results in an attempt to export C=5 to the connected data source again because sync engine assumes that this value has not been persistently applied to the object (that is, unless a different value was imported recently from the connected data source).</span></span> <span data-ttu-id="e2d67-364">在物件匯入作業期間收到 C=5 時，就會清除匯出記憶體。</span><span class="sxs-lookup"><span data-stu-id="e2d67-364">The export memory is cleared when C=5 is received during an import operation on the object.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e2d67-365">後續步驟</span><span class="sxs-lookup"><span data-stu-id="e2d67-365">Next steps</span></span>
<span data-ttu-id="e2d67-366">深入了解 [Azure AD Connect 同步](active-directory-aadconnectsync-whatis.md) 組態。</span><span class="sxs-lookup"><span data-stu-id="e2d67-366">Learn more about the [Azure AD Connect sync](active-directory-aadconnectsync-whatis.md) configuration.</span></span>

<span data-ttu-id="e2d67-367">深入了解 [整合內部部署身分識別與 Azure Active Directory](active-directory-aadconnect.md)。</span><span class="sxs-lookup"><span data-stu-id="e2d67-367">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

