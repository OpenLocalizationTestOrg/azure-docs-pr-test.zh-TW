---
title: "Azure AD Connect︰當您已經有 Azure AD 時 | Microsoft Docs"
description: "本主題描述如何 toouse 連接時您有現有的 Azure AD 租用戶。"
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: f7b166e9e85c1f03330e8e0074d4afa4036738c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-when-you-have-an-existent-tenant"></a><span data-ttu-id="5d001-103">Azure AD Connect︰當您有存在的租用戶</span><span class="sxs-lookup"><span data-stu-id="5d001-103">Azure AD Connect: When you have an existent tenant</span></span>
<span data-ttu-id="5d001-104">大部分的 hello 主題 toouse Azure AD Connect 如何假設您開始使用新的 Azure AD 租用戶，並確認沒有任何使用者或有其他物件。</span><span class="sxs-lookup"><span data-stu-id="5d001-104">Most of hello topics for how toouse Azure AD Connect assumes you start with a new Azure AD tenant and that there are no users or other objects there.</span></span> <span data-ttu-id="5d001-105">但如果您已經啟動的 Azure AD 租用戶中，填入使用者和其他物件，而想 toouse 連接，則本主題是供您。</span><span class="sxs-lookup"><span data-stu-id="5d001-105">But if you have started with an Azure AD tenant, populated it with users and other objects, and now want toouse Connect, then this topic is for you.</span></span>

## <a name="hello-basics"></a><span data-ttu-id="5d001-106">hello 基本概念</span><span class="sxs-lookup"><span data-stu-id="5d001-106">hello basics</span></span>
<span data-ttu-id="5d001-107">Azure AD 中的物件可能是受控制 hello 雲端 (Azure AD) 或內部部署中。</span><span class="sxs-lookup"><span data-stu-id="5d001-107">An object in Azure AD is either mastered in hello cloud (Azure AD) or on-premises.</span></span> <span data-ttu-id="5d001-108">針對一個單一物件，您無法管理內部部署的某些屬性和 Azure AD 中的一些其他屬性。</span><span class="sxs-lookup"><span data-stu-id="5d001-108">For one single object, you cannot manage some attributes on-premises and some other attributes in Azure AD.</span></span> <span data-ttu-id="5d001-109">每個物件都有旗標，表示受到 hello 物件。</span><span class="sxs-lookup"><span data-stu-id="5d001-109">Each object has a flag indicating where hello object is managed.</span></span>

<span data-ttu-id="5d001-110">您可以管理有些使用者在內部部署及其他 hello 雲端中。</span><span class="sxs-lookup"><span data-stu-id="5d001-110">You can manage some users on-premises and other in hello cloud.</span></span> <span data-ttu-id="5d001-111">混合著會計工作者和銷售工作者的組織是此組態的常見案例。</span><span class="sxs-lookup"><span data-stu-id="5d001-111">A common scenario for this configuration is an organization with a mix of accounting workers and sales workers.</span></span> <span data-ttu-id="5d001-112">hello 會計工作者已在內部 AD 帳戶，但 hello 銷售背景工作，請他們有 Azure AD 的帳戶。</span><span class="sxs-lookup"><span data-stu-id="5d001-112">hello accounting workers have an on-premises AD account, but hello sales workers do not, they have an account in Azure AD.</span></span> <span data-ttu-id="5d001-113">您可在內部部署管理部分使用者，並在 Azure AD 管理其他使用者。</span><span class="sxs-lookup"><span data-stu-id="5d001-113">You would manage some users on-premises and some in Azure AD.</span></span>

<span data-ttu-id="5d001-114">如果您啟動 toomanage 使用者在 Azure AD 也會在內部部署 AD，稍後想 toouse 連接，則您需要 tooconsider 一些其他考量。</span><span class="sxs-lookup"><span data-stu-id="5d001-114">If you started toomanage users in Azure AD that are also in on-premises AD and later want toouse Connect, then there are some additional concerns you need tooconsider.</span></span>

## <a name="sync-with-existing-users-in-azure-ad"></a><span data-ttu-id="5d001-115">在 Azure AD 中與現有的使用者同步處理</span><span class="sxs-lookup"><span data-stu-id="5d001-115">Sync with existing users in Azure AD</span></span>
<span data-ttu-id="5d001-116">當您安裝 Azure AD Connect，您啟動同步處理時 hello （在 Azure AD) 中的 Azure AD 同步處理服務不在每個新的物件上執行檢查然後再次嘗試 toofind 現有的物件 toomatch。</span><span class="sxs-lookup"><span data-stu-id="5d001-116">When you install Azure AD Connect and you start synchronizing, hello Azure AD sync service (in Azure AD) does a check on every new object and try toofind an existing object toomatch.</span></span> <span data-ttu-id="5d001-117">有三種屬性用於此處理程序︰**userPrincipalName**、**proxyAddresses** 和 **sourceAnchor**/**immutableID**。</span><span class="sxs-lookup"><span data-stu-id="5d001-117">There are three attributes used for this process: **userPrincipalName**, **proxyAddresses**, and **sourceAnchor**/**immutableID**.</span></span> <span data-ttu-id="5d001-118">比對 **userPrincipalName** 和 **proxyAddresses** 稱為**大致比對**。</span><span class="sxs-lookup"><span data-stu-id="5d001-118">A match on **userPrincipalName** and **proxyAddresses** is known as a **soft match**.</span></span> <span data-ttu-id="5d001-119">比對 **sourceAnchor** 稱為**精確比對**。</span><span class="sxs-lookup"><span data-stu-id="5d001-119">A match on **sourceAnchor** is known as **hard match**.</span></span> <span data-ttu-id="5d001-120">Hello **proxyAddresses**屬性只與 hello 值**SMTP:**的 hello 主要電子郵件地址，用於評估 hello。</span><span class="sxs-lookup"><span data-stu-id="5d001-120">For hello **proxyAddresses** attribute only hello value with **SMTP:**, that is hello primary email address, is used for hello evaluation.</span></span>

<span data-ttu-id="5d001-121">hello 相符項目只會評估來自連接的新物件。</span><span class="sxs-lookup"><span data-stu-id="5d001-121">hello match is only evaluated for new objects coming from Connect.</span></span> <span data-ttu-id="5d001-122">如果您變更現有的物件，而它會比對任何這些屬性，則您會看到錯誤。</span><span class="sxs-lookup"><span data-stu-id="5d001-122">If you change an exiting object so it is matching any of these attributes, then you see an error instead.</span></span>

<span data-ttu-id="5d001-123">如果 Azure AD 會尋找的物件是 hello 屬性值 hello 相同物件即將從連接，它已存在於在 Azure AD 中則 hello Azure AD 中的物件接手連接。</span><span class="sxs-lookup"><span data-stu-id="5d001-123">If Azure AD finds an object where hello attribute values are hello same for an object coming from Connect and that it is already present in Azure AD, then hello object in Azure AD is taken over by Connect.</span></span> <span data-ttu-id="5d001-124">hello 先前雲端管理的物件標示為在內部部署管理。</span><span class="sxs-lookup"><span data-stu-id="5d001-124">hello previously cloud-managed object is flagged as on-premises managed.</span></span> <span data-ttu-id="5d001-125">所有屬性值在內部部署的 Azure AD 中 AD 會使用覆寫 hello 內部值。</span><span class="sxs-lookup"><span data-stu-id="5d001-125">All attributes in Azure AD with a value in on-premises AD are overwritten with hello on-premises value.</span></span> <span data-ttu-id="5d001-126">當屬性擁有 hello 例外狀況**NULL**值在內部部署。</span><span class="sxs-lookup"><span data-stu-id="5d001-126">hello exception is when an attribute has a **NULL** value on-premises.</span></span> <span data-ttu-id="5d001-127">在此情況下，hello 值儲存在 Azure AD 還會保留，但是仍然只能變更它在內部部署 toosomething 其他。</span><span class="sxs-lookup"><span data-stu-id="5d001-127">In this case, hello value in Azure AD remains, but you can still only change it on-premises toosomething else.</span></span>

> [!WARNING]
> <span data-ttu-id="5d001-128">Azure AD 中的所有屬性會成為 toobe hello 內部值來覆寫，請確定您有良好的資料在內部。</span><span class="sxs-lookup"><span data-stu-id="5d001-128">Since all attributes in Azure AD are going toobe overwritten by hello on-premises value, make sure you have good data on-premises.</span></span> <span data-ttu-id="5d001-129">例如，如果您只在 Office 365 中管理電子郵件地址，且不會在內部部署 AD DS 中保持更新，則您會遺失不存在於 AD DS 之 Azure AD/Office 365 中的任何值。</span><span class="sxs-lookup"><span data-stu-id="5d001-129">For example, if you only have managed email address in Office 365 and not kept it updated in on-premises AD DS, then you lose any values in Azure AD/Office 365 not present in AD DS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="5d001-130">如果您使用密碼同步處理，一律會使用快速設定，則在 Azure AD 中的 hello 密碼會以內部部署中的 hello 密碼覆寫 AD。</span><span class="sxs-lookup"><span data-stu-id="5d001-130">If you use password sync, which is always used by express settings, then hello password in Azure AD is overwritten with hello password in on-premises AD.</span></span> <span data-ttu-id="5d001-131">如果您的使用者是使用的 toomanage 不同的密碼，則您需要 tooinform 它們他們應該使用 hello 在內部部署密碼，當您安裝連接。</span><span class="sxs-lookup"><span data-stu-id="5d001-131">If your users are used toomanage different passwords, then you need tooinform them that they should use hello on-premises password when you have installed Connect.</span></span>

<span data-ttu-id="5d001-132">必須在您規劃考量 hello 上一節和警告。</span><span class="sxs-lookup"><span data-stu-id="5d001-132">hello previous section and warning must be considered in your planning.</span></span> <span data-ttu-id="5d001-133">如果您不會反映在 Azure AD 中所做的許多變更內部部署 AD DS 中，則您需要 tooplan 同步您的物件，使用 Azure AD Connect 之前 toopopulate AD DS 以 hello 更新值的方式。</span><span class="sxs-lookup"><span data-stu-id="5d001-133">If you have made many changes in Azure AD not reflected in on-premises AD DS, then you need tooplan for how toopopulate AD DS with hello updated values before you sync your objects with Azure AD Connect.</span></span>

<span data-ttu-id="5d001-134">如果您符合軟體對您物件，然後 hello **sourceAnchor**會在 Azure AD 中加入 toohello 物件，所以稍後可以使用固定的相符項目。</span><span class="sxs-lookup"><span data-stu-id="5d001-134">If you matched your objects with a soft-match, then hello **sourceAnchor** is added toohello object in Azure AD so a hard match can be used later.</span></span>

### <a name="hard-match-vs-soft-match"></a><span data-ttu-id="5d001-135">精確比對與大致比對</span><span class="sxs-lookup"><span data-stu-id="5d001-135">Hard-match vs Soft-match</span></span>
<span data-ttu-id="5d001-136">對於 Connect 的全新安裝，精確比對與大致比對之間並無實際差別。</span><span class="sxs-lookup"><span data-stu-id="5d001-136">For a new installation of Connect, there is no practical difference between a soft- and a hard-match.</span></span> <span data-ttu-id="5d001-137">hello 差異是在災害復原情況下。</span><span class="sxs-lookup"><span data-stu-id="5d001-137">hello difference is in a disaster recovery situation.</span></span> <span data-ttu-id="5d001-138">如果遺失您的伺服器與 Azure AD Connect，您可以重新安裝新的執行個體而不會遺失任何資料。</span><span class="sxs-lookup"><span data-stu-id="5d001-138">If you have lost your server with Azure AD Connect, you can reinstall a new instance without losing any data.</span></span> <span data-ttu-id="5d001-139">初始安裝期間傳送 tooConnect sourceAnchor 的物件。</span><span class="sxs-lookup"><span data-stu-id="5d001-139">An object with a sourceAnchor is sent tooConnect during initial install.</span></span> <span data-ttu-id="5d001-140">hello 相符項目可以再來評估 hello 用戶端 (Azure AD Connect)，也就是許多較快，但這麼做 hello 相同 Azure AD 中。</span><span class="sxs-lookup"><span data-stu-id="5d001-140">hello match can then be evaluated by hello client (Azure AD Connect), which is a lot faster than doing hello same in Azure AD.</span></span> <span data-ttu-id="5d001-141">精確比對會由 Connect 和 Azure AD 評估。</span><span class="sxs-lookup"><span data-stu-id="5d001-141">A hard match is evaluated both by Connect and by Azure AD.</span></span> <span data-ttu-id="5d001-142">大致比對只會由 Azure AD 評估。</span><span class="sxs-lookup"><span data-stu-id="5d001-142">A soft match is only evaluated by Azure AD.</span></span>

### <a name="other-objects-than-users"></a><span data-ttu-id="5d001-143">使用者以外的其他物件</span><span class="sxs-lookup"><span data-stu-id="5d001-143">Other objects than users</span></span>
<span data-ttu-id="5d001-144">使用者通常會有 userPrincipalName 和 proxyAddresses，如此可輕鬆 hello 相符項目。</span><span class="sxs-lookup"><span data-stu-id="5d001-144">Users usually have both userPrincipalName and proxyAddresses, making hello match easy.</span></span> <span data-ttu-id="5d001-145">但是其他物件 (例如安全性群組) 沒有這些。</span><span class="sxs-lookup"><span data-stu-id="5d001-145">But other objects, such as security groups, do not have those.</span></span> <span data-ttu-id="5d001-146">在此情況下，您可以只比對上使用 hello sourceAnchor 的硬碟相符項。</span><span class="sxs-lookup"><span data-stu-id="5d001-146">In this case, you can only match on a hard match using hello sourceAnchor.</span></span> <span data-ttu-id="5d001-147">hello sourceAnchor 一律為 Base64 轉換的 hello **objectGUID**內部，所以您必須更新 hello 值，當您需要兩個物件 toomatch 的 Azure AD 中。</span><span class="sxs-lookup"><span data-stu-id="5d001-147">hello sourceAnchor is always hello Base64 converted **objectGUID** on-premises, so you must update hello value in Azure AD when you need two objects toomatch.</span></span> <span data-ttu-id="5d001-148">hello sourceAnchor/immutableID 只能使用 PowerShell，而不是透過 hello 入口網站更新。</span><span class="sxs-lookup"><span data-stu-id="5d001-148">hello sourceAnchor/immutableID can only be updated with PowerShell and not through hello portals.</span></span>

## <a name="create-a-new-on-premises-active-directory-from-data-in-azure-ad"></a><span data-ttu-id="5d001-149">從 Azure AD 中的資料建立新的內部部署 Active Directory</span><span class="sxs-lookup"><span data-stu-id="5d001-149">Create a new on-premises Active Directory from data in Azure AD</span></span>
<span data-ttu-id="5d001-150">有些客戶開始使用僅限雲端的解決方案與 Azure AD，且他們沒有內部部署 AD。</span><span class="sxs-lookup"><span data-stu-id="5d001-150">Some customers start with a cloud-only solution with Azure AD and they do not have an on-premises AD.</span></span> <span data-ttu-id="5d001-151">稍後要 tooconsume 在內部部署資源和想 toobuild 內部 AD 為基礎的 Azure AD 資料。</span><span class="sxs-lookup"><span data-stu-id="5d001-151">Later they want tooconsume on-premises resources and want toobuild an on-premises AD based on Azure AD data.</span></span> <span data-ttu-id="5d001-152">Azure AD Connect 無法針對此案例協助您。</span><span class="sxs-lookup"><span data-stu-id="5d001-152">Azure AD Connect cannot help you for this scenario.</span></span> <span data-ttu-id="5d001-153">不會建立使用者內部部署和它並沒有任何能力 tooset hello 密碼在內部部署 toohello 相同，如 Azure AD 所示。</span><span class="sxs-lookup"><span data-stu-id="5d001-153">It does not create users on-premises and it does not have any ability tooset hello password on-premises toohello same as in Azure AD.</span></span>

<span data-ttu-id="5d001-154">如果 hello 的唯一理由為何您計劃 tooadd 內部部署 AD toosupport Lob （特定業務應用程式），則也許您應該考慮 toouse [Azure AD 網域服務](../../active-directory-domain-services/index.md)改為。</span><span class="sxs-lookup"><span data-stu-id="5d001-154">If hello only reason why you plan tooadd on-premises AD is toosupport LOBs (Line-of-Business apps), then maybe you should consider toouse [Azure AD domain services](../../active-directory-domain-services/index.md) instead.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5d001-155">後續步驟</span><span class="sxs-lookup"><span data-stu-id="5d001-155">Next steps</span></span>
<span data-ttu-id="5d001-156">深入了解 [整合內部部署身分識別與 Azure Active Directory](active-directory-aadconnect.md)。</span><span class="sxs-lookup"><span data-stu-id="5d001-156">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
