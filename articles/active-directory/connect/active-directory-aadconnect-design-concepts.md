---
title: "Azure AD Connect：設計概念 |Microsoft Docs"
description: "本主題詳細說明特定的實作設計領域"
services: active-directory
documentationcenter: 
author: billmath
manager: femila
editor: 
ms.assetid: 4114a6c0-f96a-493c-be74-1153666ce6c9
ms.service: active-directory
ms.custom: azure-ad-connect
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: f23443d438c95a784f655fb9a5f20dfcf37be189
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-design-concepts"></a><span data-ttu-id="4ff08-103">Azure AD Connect：設計概念</span><span class="sxs-lookup"><span data-stu-id="4ff08-103">Azure AD Connect: Design concepts</span></span>
<span data-ttu-id="4ff08-104">本主題旨在說明在 Azure AD Connect 實作設計期間必須考量的領域。</span><span class="sxs-lookup"><span data-stu-id="4ff08-104">The purpose of this topic is to describe areas that must be thought through during the implementation design of Azure AD Connect.</span></span> <span data-ttu-id="4ff08-105">這個主題是特定領域的深入探討，而在其他主題中也會簡短描述這些概念。</span><span class="sxs-lookup"><span data-stu-id="4ff08-105">This topic is a deep dive on certain areas and these concepts are briefly described in other topics as well.</span></span>

## <a name="sourceanchor"></a><span data-ttu-id="4ff08-106">sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="4ff08-106">sourceAnchor</span></span>
<span data-ttu-id="4ff08-107">sourceAnchor 屬性的定義是 *在物件存留期間不會變更的屬性*。</span><span class="sxs-lookup"><span data-stu-id="4ff08-107">The sourceAnchor attribute is defined as *an attribute immutable during the lifetime of an object*.</span></span> <span data-ttu-id="4ff08-108">它可將物件唯一識別為內部部署和 Azure AD 中的相同物件。</span><span class="sxs-lookup"><span data-stu-id="4ff08-108">It uniquely identifies an object as being the same object on-premises and in Azure AD.</span></span> <span data-ttu-id="4ff08-109">此屬性也稱為 **immutableId** ，兩個名稱可交換使用。</span><span class="sxs-lookup"><span data-stu-id="4ff08-109">The attribute is also called **immutableId** and the two names are used interchangeable.</span></span>

<span data-ttu-id="4ff08-110">在本主題中，不可變 (亦即無法變更) 這個字非常重要。</span><span class="sxs-lookup"><span data-stu-id="4ff08-110">The word immutable, that is "cannot be changed", is important to this topic.</span></span> <span data-ttu-id="4ff08-111">由於此屬性的值在設定之後就無法變更，所以請務必挑選支援您案例的設計。</span><span class="sxs-lookup"><span data-stu-id="4ff08-111">Since this attribute’s value cannot be changed after it has been set, it is important to pick a design that supports your scenario.</span></span>

<span data-ttu-id="4ff08-112">此屬性用於下列案例︰</span><span class="sxs-lookup"><span data-stu-id="4ff08-112">The attribute is used for the following scenarios:</span></span>

* <span data-ttu-id="4ff08-113">在建置新的同步處理引擎伺服器，或在災害復原案例後進行重建時，這個屬性會連結 Azure AD 中的現有物件與內部部署的物件。</span><span class="sxs-lookup"><span data-stu-id="4ff08-113">When a new sync engine server is built, or rebuilt after a disaster recovery scenario, this attribute links existing objects in Azure AD with objects on-premises.</span></span>
* <span data-ttu-id="4ff08-114">如果您從僅限雲端的身分識別移至已同步處理的身分識別模型，則這個屬性可讓物件「完全比對」Azure AD 中的現有物件與內部部署的物件。</span><span class="sxs-lookup"><span data-stu-id="4ff08-114">If you move from a cloud-only identity to a synchronized identity model, then this attribute allows objects to "hard match" existing objects in Azure AD with on-premises objects.</span></span>
* <span data-ttu-id="4ff08-115">如果您使用同盟，則這個屬性會與 **userPrincipalName** 一起用於宣告來唯一識別使用者。</span><span class="sxs-lookup"><span data-stu-id="4ff08-115">If you use federation, then this attribute together with the **userPrincipalName** is used in the claim to uniquely identify a user.</span></span>

<span data-ttu-id="4ff08-116">本主題只討論與使用者相關的 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="4ff08-116">This topic only talks about sourceAnchor as it relates to users.</span></span> <span data-ttu-id="4ff08-117">相同的規則適用於所有的物件類型，但僅限於通常有此問題的使用者。</span><span class="sxs-lookup"><span data-stu-id="4ff08-117">The same rules apply to all object types, but it is only for users this problem usually is a concern.</span></span>

### <a name="selecting-a-good-sourceanchor-attribute"></a><span data-ttu-id="4ff08-118">選取良好的 sourceAnchor 屬性</span><span class="sxs-lookup"><span data-stu-id="4ff08-118">Selecting a good sourceAnchor attribute</span></span>
<span data-ttu-id="4ff08-119">此屬性值必須遵循下列規則：</span><span class="sxs-lookup"><span data-stu-id="4ff08-119">The attribute value must follow the following rules:</span></span>

* <span data-ttu-id="4ff08-120">長度小於 60 個字元</span><span class="sxs-lookup"><span data-stu-id="4ff08-120">Be less than 60 characters in length</span></span>
  * <span data-ttu-id="4ff08-121">系統會將 a-z、A-Z 或 0-9 以外的字元編碼並計為 3 個字元</span><span class="sxs-lookup"><span data-stu-id="4ff08-121">Characters not being a-z, A-Z, or 0-9 are encoded and counted as 3 characters</span></span>
* <span data-ttu-id="4ff08-122">不包含特殊字元︰&#92; !</span><span class="sxs-lookup"><span data-stu-id="4ff08-122">Not contain a special character: &#92; !</span></span> <span data-ttu-id="4ff08-123"># $ % & * + / = ?</span><span class="sxs-lookup"><span data-stu-id="4ff08-123"># $ % & * + / = ?</span></span> <span data-ttu-id="4ff08-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span><span class="sxs-lookup"><span data-stu-id="4ff08-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span></span>
* <span data-ttu-id="4ff08-125">必須是全域唯一的</span><span class="sxs-lookup"><span data-stu-id="4ff08-125">Must be globally unique</span></span>
* <span data-ttu-id="4ff08-126">必須是字串、整數或二進位</span><span class="sxs-lookup"><span data-stu-id="4ff08-126">Must be either a string, integer, or binary</span></span>
* <span data-ttu-id="4ff08-127">不應以使用者的名稱、這些變更為基礎</span><span class="sxs-lookup"><span data-stu-id="4ff08-127">Should not be based on user's name, these changes</span></span>
* <span data-ttu-id="4ff08-128">不應區分大小寫，並避免可能會因大小寫而改變的值</span><span class="sxs-lookup"><span data-stu-id="4ff08-128">Should not be case-sensitive and avoid values that may vary by case</span></span>
* <span data-ttu-id="4ff08-129">建立物件時應該要予以指派</span><span class="sxs-lookup"><span data-stu-id="4ff08-129">Should be assigned when the object is created</span></span>

<span data-ttu-id="4ff08-130">如果選取的 sourceAnchor 不是字串類型，則 Azure AD Connect 會將此屬性值進行 Base64Encode 處理，以確保不會出現特殊字元。</span><span class="sxs-lookup"><span data-stu-id="4ff08-130">If the selected sourceAnchor is not of type string, then Azure AD Connect Base64Encode the attribute value to ensure no special characters appear.</span></span> <span data-ttu-id="4ff08-131">如果您使用 ADFS 以外的其他同盟伺服器，請確定您的伺服器也能夠將此屬性進行 Base64Encode 處理。</span><span class="sxs-lookup"><span data-stu-id="4ff08-131">If you use another federation server than ADFS, make sure your server can also Base64Encode the attribute.</span></span>

<span data-ttu-id="4ff08-132">sourceAnchor 屬性會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="4ff08-132">The sourceAnchor attribute is case-sensitive.</span></span> <span data-ttu-id="4ff08-133">"JohnDoe" 與 "johndoe" 是不同的值。</span><span class="sxs-lookup"><span data-stu-id="4ff08-133">A value of “JohnDoe” is not the same as “johndoe”.</span></span> <span data-ttu-id="4ff08-134">但是您不應該擁有兩個只有大小寫有差異的不同物件。</span><span class="sxs-lookup"><span data-stu-id="4ff08-134">But you should not have two different objects with only a difference in case.</span></span>

<span data-ttu-id="4ff08-135">如果您有單一內部部署樹系，應該使用的屬性為 **objectGUID**。</span><span class="sxs-lookup"><span data-stu-id="4ff08-135">If you have a single forest on-premises, then the attribute you should use is **objectGUID**.</span></span> <span data-ttu-id="4ff08-136">這也是您在 Azure AD Connect 中使用快速設定時所用的屬性，而且也是 DirSync 所用的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-136">This is also the attribute used when you use express settings in Azure AD Connect and also the attribute used by DirSync.</span></span>

<span data-ttu-id="4ff08-137">如果您有多個樹系，而且不會在樹系和網域之間移動使用者，則 **objectGUID** 是適合使用的屬性 (即使在此情況下)。</span><span class="sxs-lookup"><span data-stu-id="4ff08-137">If you have multiple forests and do not move users between forests and domains, then **objectGUID** is a good attribute to use even in this case.</span></span>

<span data-ttu-id="4ff08-138">如果您在樹系和網域之間移動使用者，則必須尋找不會變更的屬性，或在移動時可隨使用者移動的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-138">If you move users between forests and domains, then you must find an attribute that does not change or can be moved with the users during the move.</span></span> <span data-ttu-id="4ff08-139">建議的方法是引入綜合的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-139">A recommended approach is to introduce a synthetic attribute.</span></span> <span data-ttu-id="4ff08-140">可保存 GUID 之類項目的屬性也可能適用。</span><span class="sxs-lookup"><span data-stu-id="4ff08-140">An attribute that could hold something that looks like a GUID would be suitable.</span></span> <span data-ttu-id="4ff08-141">在物件建立期間，會建立新的 GUID 建立並於使用者加上戳記。</span><span class="sxs-lookup"><span data-stu-id="4ff08-141">During object creation, a new GUID is created and stamped on the user.</span></span> <span data-ttu-id="4ff08-142">可以在同步處理引擎伺服器中建立自訂同步規則，以根據 **objectGUID** 建立這個值，然後在 ADDS 中更新選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-142">A custom sync rule can be created in the sync engine server to create this value based on the **objectGUID** and update the selected attribute in ADDS.</span></span> <span data-ttu-id="4ff08-143">當您移動物件時，請務必同時複製此值的內容。</span><span class="sxs-lookup"><span data-stu-id="4ff08-143">When you move the object, make sure to also copy the content of this value.</span></span>

<span data-ttu-id="4ff08-144">另一個解決方案是挑選您知道不會變更的現有屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-144">Another solution is to pick an existing attribute you know does not change.</span></span> <span data-ttu-id="4ff08-145">常用的屬性包括 **employeeID**。</span><span class="sxs-lookup"><span data-stu-id="4ff08-145">Commonly used attributes include **employeeID**.</span></span> <span data-ttu-id="4ff08-146">如果您考慮使用含有字母的屬性，請確定屬性值的大小寫 (大寫與小寫) 沒機會變更。</span><span class="sxs-lookup"><span data-stu-id="4ff08-146">If you consider an attribute that contains letters, make sure there is no chance the case (upper case vs. lower case) can change for the attribute's value.</span></span> <span data-ttu-id="4ff08-147">不該使用的不合適屬性，包括含使用者姓名的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-147">Bad attributes that should not be used include those attributes with the name of the user.</span></span> <span data-ttu-id="4ff08-148">結婚或離婚時，此名稱可能會變更，所以不適用於此屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-148">In a marriage or divorce, the name is expected to change, which is not allowed for this attribute.</span></span> <span data-ttu-id="4ff08-149">這也就是不可能在 Azure AD Connect 安裝精靈中選取 **userPrincipalName**、**mail** 和 **targetAddress** 之類屬性的原因之一。</span><span class="sxs-lookup"><span data-stu-id="4ff08-149">This is also one reason why attributes such as **userPrincipalName**, **mail**, and **targetAddress** are not even possible to select in the Azure AD Connect installation wizard.</span></span> <span data-ttu-id="4ff08-150">這些屬性也會包含 "@" 字元，而 sourceAnchor 中不允許此字元。</span><span class="sxs-lookup"><span data-stu-id="4ff08-150">Those attributes also contain the "@" character, which is not allowed in the sourceAnchor.</span></span>

### <a name="changing-the-sourceanchor-attribute"></a><span data-ttu-id="4ff08-151">變更 sourceAnchor 屬性</span><span class="sxs-lookup"><span data-stu-id="4ff08-151">Changing the sourceAnchor attribute</span></span>
<span data-ttu-id="4ff08-152">在 Azure AD 中建立物件並同步處理身分識別之後，無法變更 sourceAnchor 屬性值。</span><span class="sxs-lookup"><span data-stu-id="4ff08-152">The sourceAnchor attribute value cannot be changed after the object has been created in Azure AD and the identity is synchronized.</span></span>

<span data-ttu-id="4ff08-153">基於這個理由，下列限制適用於 Azure AD Connect：</span><span class="sxs-lookup"><span data-stu-id="4ff08-153">For this reason, the following restrictions apply to Azure AD Connect:</span></span>

* <span data-ttu-id="4ff08-154">只能在初始安裝期間設定 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-154">The sourceAnchor attribute can only be set during initial installation.</span></span> <span data-ttu-id="4ff08-155">如果您重新執行安裝精靈，這個選項會是唯讀選項。</span><span class="sxs-lookup"><span data-stu-id="4ff08-155">If you rerun the installation wizard, this option is read-only.</span></span> <span data-ttu-id="4ff08-156">如果您需要變更此設定，就必須解除安裝後再重新安裝。</span><span class="sxs-lookup"><span data-stu-id="4ff08-156">If you need to change this setting, then you must uninstall and reinstall.</span></span>
* <span data-ttu-id="4ff08-157">如果您安裝其他 Azure AD Connect 伺服器，您必須選取如先前所用的相同 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-157">If you install another Azure AD Connect server, then you must select the same sourceAnchor attribute as previously used.</span></span> <span data-ttu-id="4ff08-158">如果您稍早已使用 DirSync 並移至 Azure AD Connect，則必須使用 **objectGUID** ，因為這是 DirSync 所用的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-158">If you have earlier been using DirSync and move to Azure AD Connect, then you must use **objectGUID** since that is the attribute used by DirSync.</span></span>
* <span data-ttu-id="4ff08-159">如果 sourceAnchor 值在物件匯出至 Azure AD 之後變更，則 Azure AD Connect Sync 會擲回錯誤，並在修正問題且於來源目錄中將 sourceAnchor 變回之前，不允許對此物件進行任何其他變更。</span><span class="sxs-lookup"><span data-stu-id="4ff08-159">If the value for sourceAnchor is changed after the object has been exported to Azure AD, then Azure AD Connect sync throws an error and does not allow any more changes on that object before the issue has been fixed and the sourceAnchor is changed back in the source directory.</span></span>

## <a name="using-msds-consistencyguid-as-sourceanchor"></a><span data-ttu-id="4ff08-160">使用 msDS-ConsistencyGuid 來作為 sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="4ff08-160">Using msDS-ConsistencyGuid as sourceAnchor</span></span>
<span data-ttu-id="4ff08-161">根據預設，Azure AD Connect (1.1.486.0 版或較舊版本) 會使用 objectGUID 來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-161">By default, Azure AD Connect (version 1.1.486.0 and older) uses objectGUID as the sourceAnchor attribute.</span></span> <span data-ttu-id="4ff08-162">ObjectGUID 是由系統所產生。</span><span class="sxs-lookup"><span data-stu-id="4ff08-162">ObjectGUID is system-generated.</span></span> <span data-ttu-id="4ff08-163">您並無法在建立內部部署 AD 物件時指定它的值。</span><span class="sxs-lookup"><span data-stu-id="4ff08-163">You cannot specify its value when creating on-premises AD objects.</span></span> <span data-ttu-id="4ff08-164">如 [sourceAnchor](#sourceanchor) 一節所述，在某些情況下，您需要指定 sourceAnchor 值。</span><span class="sxs-lookup"><span data-stu-id="4ff08-164">As explained in section [sourceAnchor](#sourceanchor), there are scenarios where you need to specify the sourceAnchor value.</span></span> <span data-ttu-id="4ff08-165">如果您遇到這類情況，則必須使用可設定的 AD 屬性 (例如，msDS-ConsistencyGuid) 來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-165">If the scenarios are applicable to you, you must use a configurable AD attribute (for example, msDS-ConsistencyGuid) as the sourceAnchor attribute.</span></span>

<span data-ttu-id="4ff08-166">Azure AD Connect (1.1.524.0 版和更新版本) 現在可協助您使用 msDS-ConsistencyGuid 來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-166">Azure AD Connect (version 1.1.524.0 and after) now facilitates the use of msDS-ConsistencyGuid as sourceAnchor attribute.</span></span> <span data-ttu-id="4ff08-167">在使用此功能時，Azure AD Connect 會自動將同步處理規則設定為︰</span><span class="sxs-lookup"><span data-stu-id="4ff08-167">When using this feature, Azure AD Connect automatically configures the synchronization rules to:</span></span>

1. <span data-ttu-id="4ff08-168">使用 msDS-ConsistencyGuid 來作為使用者物件的 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-168">Use msDS-ConsistencyGuid as the sourceAnchor attribute for User objects.</span></span> <span data-ttu-id="4ff08-169">若為其他物件類型，則要使用 ObjectGUID。</span><span class="sxs-lookup"><span data-stu-id="4ff08-169">ObjectGUID is used for other object types.</span></span>

2. <span data-ttu-id="4ff08-170">對於未填入 msDS-ConsistencyGuid 屬性的給定內部部署 AD 使用者物件，Azure AD Connect 會將其 objectGUID 值反向寫入內部部署 Active Directory 中的 msDS-ConsistencyGuid 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-170">For any given on-premises AD User object whose msDS-ConsistencyGuid attribute isn't populated, Azure AD Connect writes its objectGUID value back to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span> <span data-ttu-id="4ff08-171">該物件在填入 msDS-ConsistencyGuid 屬性之後，Azure AD Connect 便會將其匯出至 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="4ff08-171">After the msDS-ConsistencyGuid attribute is populated, Azure AD Connect then exports the object to Azure AD.</span></span>

>[!NOTE]
> <span data-ttu-id="4ff08-172">在內部部署 AD 物件匯入到 Azure AD Connect (也就是，匯入到 AD 連接器空間並投影到 Metaverse) 之後，您就無法再變更其 sourceAnchor 值。</span><span class="sxs-lookup"><span data-stu-id="4ff08-172">Once an on-premises AD object is imported into Azure AD Connect (that is, imported into the AD Connector Space and projected into the Metaverse), you cannot change its sourceAnchor value anymore.</span></span> <span data-ttu-id="4ff08-173">若要對給定的內部部署 AD 物件指定 sourceAnchor 值，請先設定其 msDS-ConsistencyGuid 屬性，再將其匯入到 Azure AD Connect。</span><span class="sxs-lookup"><span data-stu-id="4ff08-173">To specify the sourceAnchor value for a given on-premises AD object, configure its msDS-ConsistencyGuid attribute before it is imported into Azure AD Connect.</span></span>

### <a name="permission-required"></a><span data-ttu-id="4ff08-174">所需權限</span><span class="sxs-lookup"><span data-stu-id="4ff08-174">Permission required</span></span>
<span data-ttu-id="4ff08-175">若要讓這項功能生效，用來與內部部署 Active Directory 同步的 AD DS 帳戶，必須獲得內部部署 Active Directory 中 msDS-ConsistencyGuid 屬性的寫入權限。</span><span class="sxs-lookup"><span data-stu-id="4ff08-175">For this feature to work, the AD DS account used to synchronize with on-premises Active Directory must be granted write permission to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature---new-installation"></a><span data-ttu-id="4ff08-176">如何啟用 ConsistencyGuid 功能 - 新安裝</span><span class="sxs-lookup"><span data-stu-id="4ff08-176">How to enable the ConsistencyGuid feature - New installation</span></span>
<span data-ttu-id="4ff08-177">您可以在新安裝期間啟用 ConsistencyGuid 作為 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="4ff08-177">You can enable the use of ConsistencyGuid as sourceAnchor during new installation.</span></span> <span data-ttu-id="4ff08-178">本節詳述快速和自訂安裝。</span><span class="sxs-lookup"><span data-stu-id="4ff08-178">This section covers both Express and Custom installation in details.</span></span>

  >[!NOTE]
  > <span data-ttu-id="4ff08-179">在新安裝期間，只有較新版本的 Azure AD Connect (1.1.524.0 和更新版本) 才支援使用 ConsistencyGuid 作為 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="4ff08-179">Only newer versions of Azure AD Connect (1.1.524.0 and after) supports the use of ConsistencyGuid as sourceAnchor during new installation.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature"></a><span data-ttu-id="4ff08-180">如何啟用 ConsistencyGuid 功能</span><span class="sxs-lookup"><span data-stu-id="4ff08-180">How to enable the ConsistencyGuid feature</span></span>
<span data-ttu-id="4ff08-181">目前來說，只有在安裝新的 Azure AD Connect 時，才能啟用此功能。</span><span class="sxs-lookup"><span data-stu-id="4ff08-181">Currently, the feature can only be enabled during new Azure AD Connect installation only.</span></span>

#### <a name="express-installation"></a><span data-ttu-id="4ff08-182">快速安裝</span><span class="sxs-lookup"><span data-stu-id="4ff08-182">Express Installation</span></span>
<span data-ttu-id="4ff08-183">使用快速模式來安裝 Azure AD Connect 時，Azure AD Connect 精靈會使用下列邏輯，自動決定最適合作為 sourceAnchor 屬性的 AD 屬性︰</span><span class="sxs-lookup"><span data-stu-id="4ff08-183">When installing Azure AD Connect with Express mode, the Azure AD Connect wizard automatically determines the most appropriate AD attribute to use as the sourceAnchor attribute using the following logic:</span></span>

* <span data-ttu-id="4ff08-184">首先，Azure AD Connect 精靈會向 Azure AD 租用戶進行查詢，以擷取之前的 Azure AD Connect 安裝 (如果有的話) 中作為 sourceAnchor 屬性的 AD 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-184">First, the Azure AD Connect wizard queries your Azure AD tenant to retrieve the AD attribute used as the sourceAnchor attribute in the previous Azure AD Connect installation (if any).</span></span> <span data-ttu-id="4ff08-185">如果可以取得這項資訊，Azure AD Connect 就會使用相同的 AD 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-185">If this information is available, Azure AD Connect uses the same AD attribute.</span></span>

  >[!NOTE]
  > <span data-ttu-id="4ff08-186">在安裝期間，只有較新版本的 Azure AD Connect (1.1.524.0 和更新版本) 才會在 Azure AD 租用戶中儲存有關所使用 sourceAnchor 屬性的資訊。</span><span class="sxs-lookup"><span data-stu-id="4ff08-186">Only newer versions of Azure AD Connect (1.1.524.0 and after) stores information in your Azure AD tenant about the sourceAnchor attribute used during installation.</span></span> <span data-ttu-id="4ff08-187">較舊版本的 Azure AD Connect 則不會這麼做。</span><span class="sxs-lookup"><span data-stu-id="4ff08-187">Older versions of Azure AD Connect do not.</span></span>

* <span data-ttu-id="4ff08-188">若未提供所使用之 sourceAnchor 屬性的相關資訊，則精靈會檢查內部部署 Active Directory 中的 msDS-ConsistencyGuid 屬性狀態。</span><span class="sxs-lookup"><span data-stu-id="4ff08-188">If information about the sourceAnchor attribute used isn't available, the wizard checks the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="4ff08-189">如果目錄中沒有任何物件設定了此屬性，精靈就會使用 msDS-ConsistencyGuid 來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-189">If the attribute isn't configured on any object in the directory, the wizard uses the msDS-ConsistencyGuid as the sourceAnchor attribute.</span></span> <span data-ttu-id="4ff08-190">如果目錄中有一或多個物件設定了此屬性，則精靈會認為其他應用程式正在使用此屬性，因此此屬性不適合作為 sourceAnchor 屬性...</span><span class="sxs-lookup"><span data-stu-id="4ff08-190">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and is not suitable as sourceAnchor attribute...</span></span>

* <span data-ttu-id="4ff08-191">在此情況下，精靈會轉為使用 objectGUID 來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-191">In which case, the wizard falls back to using objectGUID as the sourceAnchor attribute.</span></span>

* <span data-ttu-id="4ff08-192">在決定好 sourceAnchor 屬性之後，精靈會將此資訊儲存在 Azure AD 租用戶中。</span><span class="sxs-lookup"><span data-stu-id="4ff08-192">Once the sourceAnchor attribute is decided, the wizard stores the information in your Azure AD tenant.</span></span> <span data-ttu-id="4ff08-193">未來在安裝 Azure AD Connect 時，系統便會使用此資訊。</span><span class="sxs-lookup"><span data-stu-id="4ff08-193">The information will be used by future installation of Azure AD Connect.</span></span>

<span data-ttu-id="4ff08-194">在快速安裝完成之後，精靈會通知您它已挑選哪個屬性來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-194">Once Express installation completes, the wizard informs you which attribute has been picked as the Source Anchor attribute.</span></span>

![精靈的通知指出它已挑選 AD 屬性來作為 sourceAnchor](./media/active-directory-aadconnect-design-concepts/consistencyGuid-01.png)

#### <a name="custom-installation"></a><span data-ttu-id="4ff08-196">自訂安裝</span><span class="sxs-lookup"><span data-stu-id="4ff08-196">Custom installation</span></span>
<span data-ttu-id="4ff08-197">使用自訂模式來安裝 Azure AD Connect 時，Azure AD Connect 精靈會提供兩個選項供您設定 sourceAnchor 屬性︰</span><span class="sxs-lookup"><span data-stu-id="4ff08-197">When installing Azure AD Connect with Custom mode, the Azure AD Connect wizard provides two options when configuring sourceAnchor attribute:</span></span>

![自訂安裝 - sourceAnchor 設定](./media/active-directory-aadconnect-design-concepts/consistencyGuid-02.png)

| <span data-ttu-id="4ff08-199">設定</span><span class="sxs-lookup"><span data-stu-id="4ff08-199">Setting</span></span> | <span data-ttu-id="4ff08-200">說明</span><span class="sxs-lookup"><span data-stu-id="4ff08-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="4ff08-201">讓 Azure 為我管理來源錨點</span><span class="sxs-lookup"><span data-stu-id="4ff08-201">Let Azure manage the source anchor for me</span></span> | <span data-ttu-id="4ff08-202">如果您想要 Azure AD 為您挑選屬性，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="4ff08-202">Select this option if you want Azure AD to pick the attribute for you.</span></span> <span data-ttu-id="4ff08-203">如果您選取此選項，Azure AD Connect 精靈會套用[快速安裝期間所使用的相同邏輯來選取 sourceAnchor 屬性](#express-installation)。</span><span class="sxs-lookup"><span data-stu-id="4ff08-203">If you select this option, Azure AD Connect wizard applies the same [sourceAnchor attribute selection logic used during Express installation](#express-installation).</span></span> <span data-ttu-id="4ff08-204">和快速安裝一樣，在自訂安裝完成之後，精靈會通知您它已挑選哪個屬性來作為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-204">Similar to Express installation, the wizard informs you which attribute has been picked as the Source Anchor attribute after Custom installation completes.</span></span> |
| <span data-ttu-id="4ff08-205">特定的屬性</span><span class="sxs-lookup"><span data-stu-id="4ff08-205">A specific attribute</span></span> | <span data-ttu-id="4ff08-206">如果您希望指定現有的 AD 屬性作為 sourceAnchor 屬性，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="4ff08-206">Select this option if you wish to specify an existing AD attribute as the sourceAnchor attribute.</span></span> |

### <a name="how-to-enable-the-consistencyguid-feature---existing-deployment"></a><span data-ttu-id="4ff08-207">如何啟用 ConsistencyGuid 功能 - 現有部署</span><span class="sxs-lookup"><span data-stu-id="4ff08-207">How to enable the ConsistencyGuid feature - Existing deployment</span></span>
<span data-ttu-id="4ff08-208">如果您的現有 Azure AD Connect 部署使用 objectGUID 作為「來源錨點」屬性，則可以改為將它切換成使用 ConsistencyGuid。</span><span class="sxs-lookup"><span data-stu-id="4ff08-208">If you have an existing Azure AD Connect deployment which is using objectGUID as the Source Anchor attribute, you can switch it to using ConsistencyGuid instead.</span></span>

>[!NOTE]
> <span data-ttu-id="4ff08-209">只有較新版本的 Azure AD Connect (1.1.552.0 和更新版本) 才支援從 ObjectGuid 切換成 ConsistencyGuid 以作為「來源錨點」屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-209">Only newer versions of Azure AD Connect (1.1.552.0 and after) supports switching from ObjectGuid to ConsistencyGuid as the Source Anchor attribute.</span></span>

<span data-ttu-id="4ff08-210">從 objectGUID 切換至 ConsistencyGuid 作為「來源錨點」屬性：</span><span class="sxs-lookup"><span data-stu-id="4ff08-210">To switch from objectGUID to ConsistencyGuid as the Source Anchor attribute:</span></span>

1. <span data-ttu-id="4ff08-211">啟動 Azure AD Connect 精靈，然後按一下 [設定] 以移至 [工作] 畫面。</span><span class="sxs-lookup"><span data-stu-id="4ff08-211">Start the Azure AD Connect wizard and click **Configure** to go to the Tasks screen.</span></span>

2. <span data-ttu-id="4ff08-212">選取 [設定來源錨點] 工作選項，然後按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="4ff08-212">Select the **Configure Source Anchor** task option and click **Next**.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 2](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment01.png)

3. <span data-ttu-id="4ff08-214">輸入 Azure AD 系統管理員認證，然後按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="4ff08-214">Enter your Azure AD Administrator credentials and click **Next**.</span></span>

4. <span data-ttu-id="4ff08-215">Azure AD Connect 精靈會分析內部部署 Active Directory 中的 msDS-ConsistencyGuid 屬性狀態。</span><span class="sxs-lookup"><span data-stu-id="4ff08-215">Azure AD Connect wizard analyzes the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="4ff08-216">如果未在目錄的任何物件上設定此屬性，則 Azure AD Connect 會結束，而且其他應用程式目前未使用此屬性，可安全地使用它作為「來源錨點」屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-216">If the attribute isn't configured on any object in the directory, Azure AD Connect concludes that no other application is currently using the attribute and is safe to use it as the Source Anchor attribute.</span></span> <span data-ttu-id="4ff08-217">選取 [下一步] 以繼續操作。</span><span class="sxs-lookup"><span data-stu-id="4ff08-217">Click **Next** to continue.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 4](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment02.png)

5. <span data-ttu-id="4ff08-219">在 [準備設定] 畫面上，按一下 [設定] 進行設定變更。</span><span class="sxs-lookup"><span data-stu-id="4ff08-219">In the **Ready to Configure** screen, click **Configure** to make the configuration change.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 5](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment03.png)

6. <span data-ttu-id="4ff08-221">設定完成之後，精靈會指出 msDS-ConsistencyGuid 現在用作「來源錨點」屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-221">Once the configuration completes, the wizard indicates that msDS-ConsistencyGuid is now being used as the Source Anchor attribute.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 6](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment04.png)

<span data-ttu-id="4ff08-223">在分析期間 (步驟 4)，如果目錄中有一或多個物件設定此屬性，則精靈會認為其他應用程式正在使用此屬性，並傳回如下圖所示的錯誤。</span><span class="sxs-lookup"><span data-stu-id="4ff08-223">During the analysis (step 4), if the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by another application and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="4ff08-224">如果您確定現有應用程式並沒有使用此屬性，則請連絡支援人員，以了解該如何隱藏此錯誤。</span><span class="sxs-lookup"><span data-stu-id="4ff08-224">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![啟用現有部署的 ConsistencyGuid - 錯誤](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeploymenterror.png)

### <a name="impact-on-ad-fs-or-third-party-federation-configuration"></a><span data-ttu-id="4ff08-226">對 AD FS 或第三方同盟設定的影響</span><span class="sxs-lookup"><span data-stu-id="4ff08-226">Impact on AD FS or third-party federation configuration</span></span>
<span data-ttu-id="4ff08-227">如果您要使用 Azure AD Connect 來管理內部部署 AD FS 的部署，Azure AD Connect 會自動將宣告規則更新為使用同樣的 AD 屬性來作為 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="4ff08-227">If you are using Azure AD Connect to manage on-premises AD FS deployment, the Azure AD Connect automatically updates the claim rules to use the same AD attribute as sourceAnchor.</span></span> <span data-ttu-id="4ff08-228">這種作法可確保 ADFS 所產生的 ImmutableID 宣告會與匯出至 Azure AD 的 sourceAnchor 值保持一致。</span><span class="sxs-lookup"><span data-stu-id="4ff08-228">This ensures that the ImmutableID claim generated by ADFS is consistent with the sourceAnchor values exported to Azure AD.</span></span>

<span data-ttu-id="4ff08-229">如果您要在 Azure AD Connect 之外管理 AD FS，或是要使用第三方同盟伺服器來進行驗證，則必須手動更新 ImmutableID 宣告的宣告規則，使其與匯出到 Azure AD 的 sourceAnchor 值保持一致，詳情如[修改 AD FS 宣告規則](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims)一節所述。</span><span class="sxs-lookup"><span data-stu-id="4ff08-229">If you are managing AD FS outside of Azure AD Connect or you are using third-party federation servers for authentication, you must manually update the claim rules for ImmutableID claim to be consistent with the sourceAnchor values exported to Azure AD as described in article section [Modify AD FS claim rules](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span></span> <span data-ttu-id="4ff08-230">安裝完成後，精靈會傳回下列警告︰</span><span class="sxs-lookup"><span data-stu-id="4ff08-230">The wizard returns the following warning after installation completes:</span></span>

![第三方同盟設定](./media/active-directory-aadconnect-design-concepts/consistencyGuid-03.png)

### <a name="adding-new-directories-to-existing-deployment"></a><span data-ttu-id="4ff08-232">在現有部署中新增目錄</span><span class="sxs-lookup"><span data-stu-id="4ff08-232">Adding new directories to existing deployment</span></span>
<span data-ttu-id="4ff08-233">假設您已部署 Azure AD Connect 並啟用 ConsistencyGuid 功能，而現在您想要在部署中新增另一個目錄。</span><span class="sxs-lookup"><span data-stu-id="4ff08-233">Suppose you have deployed Azure AD Connect with the ConsistencyGuid feature enabled, and now you would like to add another directory to the deployment.</span></span> <span data-ttu-id="4ff08-234">當您嘗試新增目錄時，Azure AD Connect 精靈會檢查目錄中 msDS-ConsistencyGuid 屬性的狀態。</span><span class="sxs-lookup"><span data-stu-id="4ff08-234">When you try to add the directory, Azure AD Connect wizard checks the state of the mSDS-ConsistencyGuid attribute in the directory.</span></span> <span data-ttu-id="4ff08-235">如果目錄中有一或多個物件設定了此屬性，則精靈會認為其他應用程式正在使用此屬性，並傳回如下圖所示的錯誤。</span><span class="sxs-lookup"><span data-stu-id="4ff08-235">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="4ff08-236">如果您確定現有應用程式並沒有使用此屬性，則請連絡支援人員，以了解該如何隱藏此錯誤。</span><span class="sxs-lookup"><span data-stu-id="4ff08-236">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![在現有部署中新增目錄](./media/active-directory-aadconnect-design-concepts/consistencyGuid-04.png)

## <a name="azure-ad-sign-in"></a><span data-ttu-id="4ff08-238">Azure AD 登入</span><span class="sxs-lookup"><span data-stu-id="4ff08-238">Azure AD sign-in</span></span>
<span data-ttu-id="4ff08-239">整合您的內部部署目錄與 Azure AD 時，請務必了解同步處理設定對使用者驗證的方式有何影響。</span><span class="sxs-lookup"><span data-stu-id="4ff08-239">While integrating your on-premises directory with Azure AD, it is important to understand how the synchronization settings can affect the way user authenticates.</span></span> <span data-ttu-id="4ff08-240">Azure AD 使用 userPrincipalName (UPN) 來驗證使用者。</span><span class="sxs-lookup"><span data-stu-id="4ff08-240">Azure AD uses userPrincipalName (UPN) to authenticate the user.</span></span> <span data-ttu-id="4ff08-241">不過，當您同步處理使用者時，必須小心選擇要用於 userPrincipalName 值的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-241">However, when you synchronize your users, you must choose the attribute to be used for value of userPrincipalName carefully.</span></span>

### <a name="choosing-the-attribute-for-userprincipalname"></a><span data-ttu-id="4ff08-242">選擇 userPrincipalName 的屬性</span><span class="sxs-lookup"><span data-stu-id="4ff08-242">Choosing the attribute for userPrincipalName</span></span>
<span data-ttu-id="4ff08-243">當您選取屬性以便提供要用於 Azure 的 UPN 值時，應確保</span><span class="sxs-lookup"><span data-stu-id="4ff08-243">When you are selecting the attribute for providing the value of UPN to be used in Azure one should ensure</span></span>

* <span data-ttu-id="4ff08-244">屬性值符合 UPN 語法 (RFC 822)，其格式應該是 username@domain</span><span class="sxs-lookup"><span data-stu-id="4ff08-244">The attribute values conform to the UPN syntax (RFC 822), that is it should be of the format username@domain</span></span>
* <span data-ttu-id="4ff08-245">這些值的尾碼符合 Azure AD 中其中一個已驗證的自訂網域</span><span class="sxs-lookup"><span data-stu-id="4ff08-245">The suffix in the values matches to one of the verified custom domains in Azure AD</span></span>

<span data-ttu-id="4ff08-246">在快速設定中，屬性的假定選擇會是 userPrincipalName。</span><span class="sxs-lookup"><span data-stu-id="4ff08-246">In express settings, the assumed choice for the attribute is userPrincipalName.</span></span> <span data-ttu-id="4ff08-247">如果 userprincipalname 屬性不包含您希望使用者用於登入 Azure 的值，則必須選擇 [自訂安裝] 。</span><span class="sxs-lookup"><span data-stu-id="4ff08-247">If the userPrincipalName attribute does not contain the value you want your users to sign in to Azure, then you must choose **Custom Installation**.</span></span>

### <a name="custom-domain-state-and-upn"></a><span data-ttu-id="4ff08-248">自訂網域狀態和 UPN</span><span class="sxs-lookup"><span data-stu-id="4ff08-248">Custom domain state and UPN</span></span>
<span data-ttu-id="4ff08-249">請務必確保 UPN 尾碼有已驗證的網域。</span><span class="sxs-lookup"><span data-stu-id="4ff08-249">It is important to ensure that there is a verified domain for the UPN suffix.</span></span>

<span data-ttu-id="4ff08-250">John 是 contoso.com 中的使用者。</span><span class="sxs-lookup"><span data-stu-id="4ff08-250">John is a user in contoso.com.</span></span> <span data-ttu-id="4ff08-251">在您將使用者同步至 Azure AD 目錄 contoso.onmicrosoft.com 之後，您希望 John 使用內部部署 UPN john@contoso.com 來登入 Azure。</span><span class="sxs-lookup"><span data-stu-id="4ff08-251">You want John to use the on-premises UPN john@contoso.com to sign in to Azure after you have synced users to your Azure AD directory contoso.onmicrosoft.com.</span></span> <span data-ttu-id="4ff08-252">若要這樣做，您必須將 contoso.com 新增為 Azure AD 中的自訂網域並加以驗證，才能開始同步處理使用者。</span><span class="sxs-lookup"><span data-stu-id="4ff08-252">To do so, you need to add and verify contoso.com as a custom domain in Azure AD before you can start syncing the users.</span></span> <span data-ttu-id="4ff08-253">舉例來說，如果 John 的 UPN 尾碼是 contoso.com，不符合 Azure AD 中已驗證的網域，則 Azure AD 會以 contoso.onmicrosoft.com 取代 UPN 尾碼。</span><span class="sxs-lookup"><span data-stu-id="4ff08-253">If the UPN suffix of John, for example contoso.com, does not match a verified domain in Azure AD, then Azure AD replaces the UPN suffix with contoso.onmicrosoft.com.</span></span>

### <a name="non-routable-on-premises-domains-and-upn-for-azure-ad"></a><span data-ttu-id="4ff08-254">無法路由傳送的內部部署網域與 Azure AD 的 UPN</span><span class="sxs-lookup"><span data-stu-id="4ff08-254">Non-routable on-premises domains and UPN for Azure AD</span></span>
<span data-ttu-id="4ff08-255">有些組織有無法路由傳送的網域，例如 contoso.local 或簡單單一標籤網域，例如 contoso。</span><span class="sxs-lookup"><span data-stu-id="4ff08-255">Some organizations have non-routable domains, like contoso.local, or simple single label domains like contoso.</span></span> <span data-ttu-id="4ff08-256">您無法確認在 Azure AD 中無法路由傳送的網域。</span><span class="sxs-lookup"><span data-stu-id="4ff08-256">You are not able to verify a non-routable domain in Azure AD.</span></span> <span data-ttu-id="4ff08-257">Azure AD Connect 可以僅同步至 Azure AD 中已驗證的網域。</span><span class="sxs-lookup"><span data-stu-id="4ff08-257">Azure AD Connect can sync to only a verified domain in Azure AD.</span></span> <span data-ttu-id="4ff08-258">當您建立 Azure AD 目錄時，它會建立可路由傳送的網域，而該網域會成為 Azure AD 的預設網域，例如 contoso.onmicrosoft.com。</span><span class="sxs-lookup"><span data-stu-id="4ff08-258">When you create an Azure AD directory, it creates a routable domain that becomes default domain for your Azure AD for example, contoso.onmicrosoft.com.</span></span> <span data-ttu-id="4ff08-259">因此，如果您不想要同步至預設的 .onmicrosoft.com 網域，則必須在此類案例中驗證所有其他可路由傳送的網域。</span><span class="sxs-lookup"><span data-stu-id="4ff08-259">Therefore, it becomes necessary to verify any other routable domain in such a scenario in case you don't want to sync to the default onmicrosoft.com domain.</span></span>

<span data-ttu-id="4ff08-260">如需有關如何新增和驗證網域的詳細資訊，請參閱 [將您的自訂網域名稱新增至 Azure Active Directory](../active-directory-add-domain.md) 。</span><span class="sxs-lookup"><span data-stu-id="4ff08-260">Read [Add your custom domain name to Azure Active Directory](../active-directory-add-domain.md) for more info on adding and verifying domains.</span></span>

<span data-ttu-id="4ff08-261">Azure AD Connect 會偵測您是否在無法路由傳送的網域環境中執行，並且會適當地警告您不要繼續進行快速設定。</span><span class="sxs-lookup"><span data-stu-id="4ff08-261">Azure AD Connect detects if you are running in a non-routable domain environment and would appropriately warn you from going ahead with express settings.</span></span> <span data-ttu-id="4ff08-262">如果您是在不可路由傳送的網域中操作，則使用者的 UPN 可能也有無法路由傳送的尾碼。</span><span class="sxs-lookup"><span data-stu-id="4ff08-262">If you are operating in a non-routable domain, then it is likely that the UPN of the users have non-routable suffixes too.</span></span> <span data-ttu-id="4ff08-263">例如，如果您是在 contoso.local 之下執行，Azure AD Connect 會建議您使用自訂設定，而不是使用快速設定。</span><span class="sxs-lookup"><span data-stu-id="4ff08-263">For example, if you are running under contoso.local, Azure AD Connect suggests you to use custom settings rather than using express settings.</span></span> <span data-ttu-id="4ff08-264">使用自訂設定，在使用者同步至 Azure AD 之後，您能夠指定應做為 UPN 以供登入 Azure 的屬性。</span><span class="sxs-lookup"><span data-stu-id="4ff08-264">Using custom settings, you are able to specify the attribute that should be used as UPN to sign in to Azure after the users are synced to Azure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4ff08-265">後續步驟</span><span class="sxs-lookup"><span data-stu-id="4ff08-265">Next steps</span></span>
<span data-ttu-id="4ff08-266">深入了解 [整合內部部署身分識別與 Azure Active Directory](active-directory-aadconnect.md)。</span><span class="sxs-lookup"><span data-stu-id="4ff08-266">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
