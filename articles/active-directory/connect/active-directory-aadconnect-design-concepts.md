---
title: "Azure AD Connect：設計概念 |Microsoft Docs"
description: "本主題詳細說明特定的實作設計領域"
services: active-directory
documentationcenter: 
author: billmath
manager: femila
editor: 
ms.assetid: 4114a6c0-f96a-493c-be74-1153666ce6c9
ms.service: active-directory
ms.custom: azure-ad-connect
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: 1e5d5c6a716ca653fb14fc059e8155124b433732
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-design-concepts"></a><span data-ttu-id="f62f8-103">Azure AD Connect：設計概念</span><span class="sxs-lookup"><span data-stu-id="f62f8-103">Azure AD Connect: Design concepts</span></span>
<span data-ttu-id="f62f8-104">hello 本主題的目的是必須在 Azure AD connect 的 hello 實作設計期間思考 toodescribe 區域。</span><span class="sxs-lookup"><span data-stu-id="f62f8-104">hello purpose of this topic is toodescribe areas that must be thought through during hello implementation design of Azure AD Connect.</span></span> <span data-ttu-id="f62f8-105">這個主題是特定領域的深入探討，而在其他主題中也會簡短描述這些概念。</span><span class="sxs-lookup"><span data-stu-id="f62f8-105">This topic is a deep dive on certain areas and these concepts are briefly described in other topics as well.</span></span>

## <a name="sourceanchor"></a><span data-ttu-id="f62f8-106">sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="f62f8-106">sourceAnchor</span></span>
<span data-ttu-id="f62f8-107">hello sourceAnchor 屬性定義為*hello 物件存留期間不可變屬性*。</span><span class="sxs-lookup"><span data-stu-id="f62f8-107">hello sourceAnchor attribute is defined as *an attribute immutable during hello lifetime of an object*.</span></span> <span data-ttu-id="f62f8-108">它會唯一識別物件視為 hello 相同的物件在內部部署和 Azure AD 中。</span><span class="sxs-lookup"><span data-stu-id="f62f8-108">It uniquely identifies an object as being hello same object on-premises and in Azure AD.</span></span> <span data-ttu-id="f62f8-109">也稱為 hello 屬性**immutableId**並用 hello 兩個名稱是可互換。</span><span class="sxs-lookup"><span data-stu-id="f62f8-109">hello attribute is also called **immutableId** and hello two names are used interchangeable.</span></span>

<span data-ttu-id="f62f8-110">hello word 不可變的是 「 不變更 」，是重要的 toothis 主題。</span><span class="sxs-lookup"><span data-stu-id="f62f8-110">hello word immutable, that is "cannot be changed", is important toothis topic.</span></span> <span data-ttu-id="f62f8-111">因為已設定之後，就無法變更這個屬性的值，所以重要 toopick 支援您的案例的設計。</span><span class="sxs-lookup"><span data-stu-id="f62f8-111">Since this attribute’s value cannot be changed after it has been set, it is important toopick a design that supports your scenario.</span></span>

<span data-ttu-id="f62f8-112">hello 屬性可用於下列案例的 hello:</span><span class="sxs-lookup"><span data-stu-id="f62f8-112">hello attribute is used for hello following scenarios:</span></span>

* <span data-ttu-id="f62f8-113">在建置新的同步處理引擎伺服器，或在災害復原案例後進行重建時，這個屬性會連結 Azure AD 中的現有物件與內部部署的物件。</span><span class="sxs-lookup"><span data-stu-id="f62f8-113">When a new sync engine server is built, or rebuilt after a disaster recovery scenario, this attribute links existing objects in Azure AD with objects on-premises.</span></span>
* <span data-ttu-id="f62f8-114">如果您移動從僅限雲端的身分識別 tooa 已同步處理身分識別模型，則這個屬性允許的物件太"硬碟的相符項目 」 中的現有物件 Azure AD 與內部部署物件。</span><span class="sxs-lookup"><span data-stu-id="f62f8-114">If you move from a cloud-only identity tooa synchronized identity model, then this attribute allows objects too"hard match" existing objects in Azure AD with on-premises objects.</span></span>
* <span data-ttu-id="f62f8-115">如果您使用同盟，則此屬性，以及 hello **userPrincipalName**用於 hello toouniquely 識別使用者的宣告。</span><span class="sxs-lookup"><span data-stu-id="f62f8-115">If you use federation, then this attribute together with hello **userPrincipalName** is used in hello claim toouniquely identify a user.</span></span>

<span data-ttu-id="f62f8-116">本主題只討論有關 sourceAnchor 與 toousers。</span><span class="sxs-lookup"><span data-stu-id="f62f8-116">This topic only talks about sourceAnchor as it relates toousers.</span></span> <span data-ttu-id="f62f8-117">hello 適用相同的規則 tooall 物件類型，但它只適用於使用者是此問題通常是一項考量。</span><span class="sxs-lookup"><span data-stu-id="f62f8-117">hello same rules apply tooall object types, but it is only for users this problem usually is a concern.</span></span>

### <a name="selecting-a-good-sourceanchor-attribute"></a><span data-ttu-id="f62f8-118">選取良好的 sourceAnchor 屬性</span><span class="sxs-lookup"><span data-stu-id="f62f8-118">Selecting a good sourceAnchor attribute</span></span>
<span data-ttu-id="f62f8-119">hello 屬性值必須遵守下列規則的 hello:</span><span class="sxs-lookup"><span data-stu-id="f62f8-119">hello attribute value must follow hello following rules:</span></span>

* <span data-ttu-id="f62f8-120">長度小於 60 個字元</span><span class="sxs-lookup"><span data-stu-id="f62f8-120">Be less than 60 characters in length</span></span>
  * <span data-ttu-id="f62f8-121">系統會將 a-z、A-Z 或 0-9 以外的字元編碼並計為 3 個字元</span><span class="sxs-lookup"><span data-stu-id="f62f8-121">Characters not being a-z, A-Z, or 0-9 are encoded and counted as 3 characters</span></span>
* <span data-ttu-id="f62f8-122">不包含特殊字元︰&#92; !</span><span class="sxs-lookup"><span data-stu-id="f62f8-122">Not contain a special character: &#92; !</span></span> <span data-ttu-id="f62f8-123"># $ % & * + / = ?</span><span class="sxs-lookup"><span data-stu-id="f62f8-123"># $ % & * + / = ?</span></span> <span data-ttu-id="f62f8-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span><span class="sxs-lookup"><span data-stu-id="f62f8-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span></span>
* <span data-ttu-id="f62f8-125">必須是全域唯一的</span><span class="sxs-lookup"><span data-stu-id="f62f8-125">Must be globally unique</span></span>
* <span data-ttu-id="f62f8-126">必須是字串、整數或二進位</span><span class="sxs-lookup"><span data-stu-id="f62f8-126">Must be either a string, integer, or binary</span></span>
* <span data-ttu-id="f62f8-127">不應以使用者的名稱、這些變更為基礎</span><span class="sxs-lookup"><span data-stu-id="f62f8-127">Should not be based on user's name, these changes</span></span>
* <span data-ttu-id="f62f8-128">不應區分大小寫，並避免可能會因大小寫而改變的值</span><span class="sxs-lookup"><span data-stu-id="f62f8-128">Should not be case-sensitive and avoid values that may vary by case</span></span>
* <span data-ttu-id="f62f8-129">應該在 hello 物件建立時指派</span><span class="sxs-lookup"><span data-stu-id="f62f8-129">Should be assigned when hello object is created</span></span>

<span data-ttu-id="f62f8-130">如果 hello 選取 sourceAnchor 不是字串型別，則會不顯示 Azure AD 連接 Base64Encode hello 屬性值 tooensure 任何特殊字元。</span><span class="sxs-lookup"><span data-stu-id="f62f8-130">If hello selected sourceAnchor is not of type string, then Azure AD Connect Base64Encode hello attribute value tooensure no special characters appear.</span></span> <span data-ttu-id="f62f8-131">如果您使用比 ADFS 的另一部同盟伺服器，請確定您也可以 Base64Encode hello 屬性的伺服器。</span><span class="sxs-lookup"><span data-stu-id="f62f8-131">If you use another federation server than ADFS, make sure your server can also Base64Encode hello attribute.</span></span>

<span data-ttu-id="f62f8-132">hello sourceAnchor 屬性會區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="f62f8-132">hello sourceAnchor attribute is case-sensitive.</span></span> <span data-ttu-id="f62f8-133">值為"JohnDoe"不是 hello 與 「 johndoe 」 相同。</span><span class="sxs-lookup"><span data-stu-id="f62f8-133">A value of “JohnDoe” is not hello same as “johndoe”.</span></span> <span data-ttu-id="f62f8-134">但是您不應該擁有兩個只有大小寫有差異的不同物件。</span><span class="sxs-lookup"><span data-stu-id="f62f8-134">But you should not have two different objects with only a difference in case.</span></span>

<span data-ttu-id="f62f8-135">如果您有單一樹系內部部署，您應該使用然後 hello 屬性是**objectGUID**。</span><span class="sxs-lookup"><span data-stu-id="f62f8-135">If you have a single forest on-premises, then hello attribute you should use is **objectGUID**.</span></span> <span data-ttu-id="f62f8-136">這也是您在 Azure AD Connect 中使用快速設定，並也 hello DirSync 使用的屬性時所使用的 hello 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-136">This is also hello attribute used when you use express settings in Azure AD Connect and also hello attribute used by DirSync.</span></span>

<span data-ttu-id="f62f8-137">如果您有多個樹系並不會移動使用者之間樹系和網域，然後**objectGUID**是不錯的屬性 toouse 即使在此情況下。</span><span class="sxs-lookup"><span data-stu-id="f62f8-137">If you have multiple forests and do not move users between forests and domains, then **objectGUID** is a good attribute toouse even in this case.</span></span>

<span data-ttu-id="f62f8-138">如果樹系和網域之間移動使用者，然後您必須尋找的屬性，不會變更，或可以移動與 hello 使用者在 hello 移動。</span><span class="sxs-lookup"><span data-stu-id="f62f8-138">If you move users between forests and domains, then you must find an attribute that does not change or can be moved with hello users during hello move.</span></span> <span data-ttu-id="f62f8-139">建議的方法是 toointroduce 綜合的屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-139">A recommended approach is toointroduce a synthetic attribute.</span></span> <span data-ttu-id="f62f8-140">可保存 GUID 之類項目的屬性也可能適用。</span><span class="sxs-lookup"><span data-stu-id="f62f8-140">An attribute that could hold something that looks like a GUID would be suitable.</span></span> <span data-ttu-id="f62f8-141">在物件建立時，新的 GUID，建立並上 hello 使用者加上戳記。</span><span class="sxs-lookup"><span data-stu-id="f62f8-141">During object creation, a new GUID is created and stamped on hello user.</span></span> <span data-ttu-id="f62f8-142">自訂同步處理規則中可建立 hello 同步作業引擎伺服器 toocreate 根據 hello 這個值**objectGUID**和 ADDS 中的更新 hello 選取的屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-142">A custom sync rule can be created in hello sync engine server toocreate this value based on hello **objectGUID** and update hello selected attribute in ADDS.</span></span> <span data-ttu-id="f62f8-143">當您移動 hello 物件時，請確定 tooalso 複製 hello 內容，這個值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-143">When you move hello object, make sure tooalso copy hello content of this value.</span></span>

<span data-ttu-id="f62f8-144">另一個解決方案是 toopick 您知道不會變更現有屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-144">Another solution is toopick an existing attribute you know does not change.</span></span> <span data-ttu-id="f62f8-145">常用的屬性包括 **employeeID**。</span><span class="sxs-lookup"><span data-stu-id="f62f8-145">Commonly used attributes include **employeeID**.</span></span> <span data-ttu-id="f62f8-146">如果您將包含字母的屬性，請確定沒有任何機率 hello 大小寫 （大寫與小寫） 可以變更 hello 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-146">If you consider an attribute that contains letters, make sure there is no chance hello case (upper case vs. lower case) can change for hello attribute's value.</span></span> <span data-ttu-id="f62f8-147">不正確的屬性，不應包含 hello hello 使用者名稱與這些屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-147">Bad attributes that should not be used include those attributes with hello name of hello user.</span></span> <span data-ttu-id="f62f8-148">在婚姻或離婚，hello 名稱會是預期的 toochange，這不允許這個屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-148">In a marriage or divorce, hello name is expected toochange, which is not allowed for this attribute.</span></span> <span data-ttu-id="f62f8-149">這是另一個原因為何等屬性**userPrincipalName**，**郵件**，和**targetAddress**不 hello Azure AD Connect 的安裝中甚至可能 tooselect精靈。</span><span class="sxs-lookup"><span data-stu-id="f62f8-149">This is also one reason why attributes such as **userPrincipalName**, **mail**, and **targetAddress** are not even possible tooselect in hello Azure AD Connect installation wizard.</span></span> <span data-ttu-id="f62f8-150">這些屬性也包含 hello"@"字元，這不允許在 hello sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="f62f8-150">Those attributes also contain hello "@" character, which is not allowed in hello sourceAnchor.</span></span>

### <a name="changing-hello-sourceanchor-attribute"></a><span data-ttu-id="f62f8-151">Hello sourceAnchor 屬性變更</span><span class="sxs-lookup"><span data-stu-id="f62f8-151">Changing hello sourceAnchor attribute</span></span>
<span data-ttu-id="f62f8-152">在 Azure AD 中已建立 hello 物件並 hello 身分識別同步處理之後，就無法變更 hello sourceAnchor 屬性值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-152">hello sourceAnchor attribute value cannot be changed after hello object has been created in Azure AD and hello identity is synchronized.</span></span>

<span data-ttu-id="f62f8-153">基於這個理由，hello 下列限制適用於 tooAzure AD 連線：</span><span class="sxs-lookup"><span data-stu-id="f62f8-153">For this reason, hello following restrictions apply tooAzure AD Connect:</span></span>

* <span data-ttu-id="f62f8-154">hello sourceAnchor 屬性只能在初始安裝期間設定。</span><span class="sxs-lookup"><span data-stu-id="f62f8-154">hello sourceAnchor attribute can only be set during initial installation.</span></span> <span data-ttu-id="f62f8-155">如果您重新執行 hello 安裝精靈，此選項會處於唯讀狀態。</span><span class="sxs-lookup"><span data-stu-id="f62f8-155">If you rerun hello installation wizard, this option is read-only.</span></span> <span data-ttu-id="f62f8-156">如果您需要 toochange 這項設定，則您必須解除安裝並重新安裝。</span><span class="sxs-lookup"><span data-stu-id="f62f8-156">If you need toochange this setting, then you must uninstall and reinstall.</span></span>
* <span data-ttu-id="f62f8-157">如果您安裝其他 Azure AD Connect 的伺服器，則選取必須 hello 如先前使用相同的 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-157">If you install another Azure AD Connect server, then you must select hello same sourceAnchor attribute as previously used.</span></span> <span data-ttu-id="f62f8-158">如果您先前已在使用 DirSync，移動 tooAzure AD 連線，則您必須使用**objectGUID**因為這是使用 DirSync hello 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-158">If you have earlier been using DirSync and move tooAzure AD Connect, then you must use **objectGUID** since that is hello attribute used by DirSync.</span></span>
* <span data-ttu-id="f62f8-159">如果 hello sourceAnchor 值變更之後已匯出的 tooAzure AD，然後 Azure AD Connect 同步處理擲回錯誤，且不允許任何其他變更該物件之前 hello 問題已修正並 hello sourceAnchor 回變更 hello hello 物件。來源目錄。</span><span class="sxs-lookup"><span data-stu-id="f62f8-159">If hello value for sourceAnchor is changed after hello object has been exported tooAzure AD, then Azure AD Connect sync throws an error and does not allow any more changes on that object before hello issue has been fixed and hello sourceAnchor is changed back in hello source directory.</span></span>

## <a name="using-msds-consistencyguid-as-sourceanchor"></a><span data-ttu-id="f62f8-160">使用 msDS-ConsistencyGuid 來作為 sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="f62f8-160">Using msDS-ConsistencyGuid as sourceAnchor</span></span>
<span data-ttu-id="f62f8-161">根據預設，Azure AD Connect (版本 1.1.486.0 和較舊) 使用 objectGUID 做 hello sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-161">By default, Azure AD Connect (version 1.1.486.0 and older) uses objectGUID as hello sourceAnchor attribute.</span></span> <span data-ttu-id="f62f8-162">ObjectGUID 是由系統所產生。</span><span class="sxs-lookup"><span data-stu-id="f62f8-162">ObjectGUID is system-generated.</span></span> <span data-ttu-id="f62f8-163">您並無法在建立內部部署 AD 物件時指定它的值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-163">You cannot specify its value when creating on-premises AD objects.</span></span> <span data-ttu-id="f62f8-164">一節中所述[sourceAnchor](#sourceanchor)，情況下，您需要 toospecify hello sourceAnchor 值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-164">As explained in section [sourceAnchor](#sourceanchor), there are scenarios where you need toospecify hello sourceAnchor value.</span></span> <span data-ttu-id="f62f8-165">適用於 tooyou hello 案例時，您必須使用可設定的 AD 屬性 (例如，ConsistencyGuid msDS) 為 hello sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-165">If hello scenarios are applicable tooyou, you must use a configurable AD attribute (for example, msDS-ConsistencyGuid) as hello sourceAnchor attribute.</span></span>

<span data-ttu-id="f62f8-166">Azure AD Connect (1.1.524.0 版本和之後) 現在可協助 hello 使用 Msds-primary-computer ConsistencyGuid 做為 sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-166">Azure AD Connect (version 1.1.524.0 and after) now facilitates hello use of msDS-ConsistencyGuid as sourceAnchor attribute.</span></span> <span data-ttu-id="f62f8-167">使用此功能時，Azure AD Connect 會自動設定 hello 同步處理規則：</span><span class="sxs-lookup"><span data-stu-id="f62f8-167">When using this feature, Azure AD Connect automatically configures hello synchronization rules to:</span></span>

1. <span data-ttu-id="f62f8-168">作為 Msds-primary-computer ConsistencyGuid hello sourceAnchor 屬性使用者物件。</span><span class="sxs-lookup"><span data-stu-id="f62f8-168">Use msDS-ConsistencyGuid as hello sourceAnchor attribute for User objects.</span></span> <span data-ttu-id="f62f8-169">若為其他物件類型，則要使用 ObjectGUID。</span><span class="sxs-lookup"><span data-stu-id="f62f8-169">ObjectGUID is used for other object types.</span></span>

2. <span data-ttu-id="f62f8-170">任何給定的內部部署 AD 使用者並不填入其 Msds-primary-computer ConsistencyGuid 屬性，Azure AD Connect 寫入其 objectGUID 值後 toohello Msds-primary-computer ConsistencyGuid 屬性在內部部署 Active Directory 中的物件。</span><span class="sxs-lookup"><span data-stu-id="f62f8-170">For any given on-premises AD User object whose msDS-ConsistencyGuid attribute isn't populated, Azure AD Connect writes its objectGUID value back toohello msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span> <span data-ttu-id="f62f8-171">填入 hello Msds-primary-computer ConsistencyGuid 屬性之後，Azure AD Connect 然後匯出 hello 物件 tooAzure AD。</span><span class="sxs-lookup"><span data-stu-id="f62f8-171">After hello msDS-ConsistencyGuid attribute is populated, Azure AD Connect then exports hello object tooAzure AD.</span></span>

>[!NOTE]
> <span data-ttu-id="f62f8-172">一次內部部署 AD 物件會匯入至 Azure AD Connect （，，匯入 hello AD 連接器空間投射至 hello Metaverse），您無法再變更 sourceAnchor 值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-172">Once an on-premises AD object is imported into Azure AD Connect (that is, imported into hello AD Connector Space and projected into hello Metaverse), you cannot change its sourceAnchor value anymore.</span></span> <span data-ttu-id="f62f8-173">toospecify hello sourceAnchor 值的指定內部部署 AD 物件、 設定其 Msds-primary-computer ConsistencyGuid 屬性，才能匯入 Azure AD Connect。</span><span class="sxs-lookup"><span data-stu-id="f62f8-173">toospecify hello sourceAnchor value for a given on-premises AD object, configure its msDS-ConsistencyGuid attribute before it is imported into Azure AD Connect.</span></span>

### <a name="permission-required"></a><span data-ttu-id="f62f8-174">所需權限</span><span class="sxs-lookup"><span data-stu-id="f62f8-174">Permission required</span></span>
<span data-ttu-id="f62f8-175">針對這個功能 toowork，與在內部部署 Active Directory 的 hello AD DS 帳戶使用 toosynchronize 必須授與寫入權限 toohello Msds-primary-computer ConsistencyGuid 屬性在內部部署 Active Directory 中。</span><span class="sxs-lookup"><span data-stu-id="f62f8-175">For this feature toowork, hello AD DS account used toosynchronize with on-premises Active Directory must be granted write permission toohello msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span>

### <a name="how-tooenable-hello-consistencyguid-feature---new-installation"></a><span data-ttu-id="f62f8-176">如何 tooenable hello ConsistencyGuid 功能-新的安裝</span><span class="sxs-lookup"><span data-stu-id="f62f8-176">How tooenable hello ConsistencyGuid feature - New installation</span></span>
<span data-ttu-id="f62f8-177">您可以在全新安裝期間啟用 hello 使用 ConsistencyGuid 做為 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="f62f8-177">You can enable hello use of ConsistencyGuid as sourceAnchor during new installation.</span></span> <span data-ttu-id="f62f8-178">本節詳述快速和自訂安裝。</span><span class="sxs-lookup"><span data-stu-id="f62f8-178">This section covers both Express and Custom installation in details.</span></span>

  >[!NOTE]
  > <span data-ttu-id="f62f8-179">僅有較新版本的 Azure AD Connect (1.1.524.0 及之後) 支援 hello 全新安裝期間使用 ConsistencyGuid 做 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="f62f8-179">Only newer versions of Azure AD Connect (1.1.524.0 and after) supports hello use of ConsistencyGuid as sourceAnchor during new installation.</span></span>

### <a name="how-tooenable-hello-consistencyguid-feature"></a><span data-ttu-id="f62f8-180">如何 tooenable hello ConsistencyGuid 功能</span><span class="sxs-lookup"><span data-stu-id="f62f8-180">How tooenable hello ConsistencyGuid feature</span></span>
<span data-ttu-id="f62f8-181">目前，可以只啟用 hello 功能，在安裝新的 Azure AD Connect，僅期間。</span><span class="sxs-lookup"><span data-stu-id="f62f8-181">Currently, hello feature can only be enabled during new Azure AD Connect installation only.</span></span>

#### <a name="express-installation"></a><span data-ttu-id="f62f8-182">快速安裝</span><span class="sxs-lookup"><span data-stu-id="f62f8-182">Express Installation</span></span>
<span data-ttu-id="f62f8-183">使用快速模式中安裝 Azure AD Connect 時, hello Azure AD Connect 精靈會自動決定 hello 最適當的 AD 屬性 toouse 做 hello sourceAnchor 屬性使用下列邏輯 hello:</span><span class="sxs-lookup"><span data-stu-id="f62f8-183">When installing Azure AD Connect with Express mode, hello Azure AD Connect wizard automatically determines hello most appropriate AD attribute toouse as hello sourceAnchor attribute using hello following logic:</span></span>

* <span data-ttu-id="f62f8-184">首先，做為您的 Azure AD 租用戶 tooretrieve hello AD 屬性 hello Azure AD Connect 精靈查詢 hello sourceAnchor 屬性 hello 先前的 Azure AD Connect 的安裝中，（如果有的話）。</span><span class="sxs-lookup"><span data-stu-id="f62f8-184">First, hello Azure AD Connect wizard queries your Azure AD tenant tooretrieve hello AD attribute used as hello sourceAnchor attribute in hello previous Azure AD Connect installation (if any).</span></span> <span data-ttu-id="f62f8-185">這項資訊是否可用，Azure AD Connect 會使用 hello 相同 AD 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-185">If this information is available, Azure AD Connect uses hello same AD attribute.</span></span>

  >[!NOTE]
  > <span data-ttu-id="f62f8-186">僅有較新版本的 Azure AD Connect (1.1.524.0 及之後) 安裝期間使用 Azure AD 租用戶中的儲存資訊，關於 hello sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-186">Only newer versions of Azure AD Connect (1.1.524.0 and after) stores information in your Azure AD tenant about hello sourceAnchor attribute used during installation.</span></span> <span data-ttu-id="f62f8-187">較舊版本的 Azure AD Connect 則不會這麼做。</span><span class="sxs-lookup"><span data-stu-id="f62f8-187">Older versions of Azure AD Connect do not.</span></span>

* <span data-ttu-id="f62f8-188">如果使用 hello sourceAnchor 屬性的相關資訊無法使用，hello 精靈會檢查 hello Msds-primary-computer ConsistencyGuid 屬性在內部部署 Active Directory 中的 hello 狀態。</span><span class="sxs-lookup"><span data-stu-id="f62f8-188">If information about hello sourceAnchor attribute used isn't available, hello wizard checks hello state of hello msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="f62f8-189">Hello 屬性未設定 hello 目錄中的任何物件上，如果 hello 精靈會使用 hello Msds-primary-computer ConsistencyGuid 作為 hello sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-189">If hello attribute isn't configured on any object in hello directory, hello wizard uses hello msDS-ConsistencyGuid as hello sourceAnchor attribute.</span></span> <span data-ttu-id="f62f8-190">如果在 hello 目錄的一或多個物件上設定 hello 屬性，hello 精靈結束時 hello 屬性正由其他應用程式，因此不適合做為 sourceAnchor 屬性...</span><span class="sxs-lookup"><span data-stu-id="f62f8-190">If hello attribute is configured on one or more objects in hello directory, hello wizard concludes hello attribute is being used by other applications and is not suitable as sourceAnchor attribute...</span></span>

* <span data-ttu-id="f62f8-191">在此情況下，hello 精靈就會回到 toousing objectGUID 做 hello sourceAnchor 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-191">In which case, hello wizard falls back toousing objectGUID as hello sourceAnchor attribute.</span></span>

* <span data-ttu-id="f62f8-192">一旦決定 hello sourceAnchor 屬性是，hello 精靈 hello 將資訊儲存在 Azure AD 租用戶。</span><span class="sxs-lookup"><span data-stu-id="f62f8-192">Once hello sourceAnchor attribute is decided, hello wizard stores hello information in your Azure AD tenant.</span></span> <span data-ttu-id="f62f8-193">hello 資訊供未來的 Azure AD Connect 的安裝。</span><span class="sxs-lookup"><span data-stu-id="f62f8-193">hello information will be used by future installation of Azure AD Connect.</span></span>

<span data-ttu-id="f62f8-194">快速安裝完成之後，「 hello 精靈 」 會通知您哪一個屬性具有已挑選為 hello 來源錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-194">Once Express installation completes, hello wizard informs you which attribute has been picked as hello Source Anchor attribute.</span></span>

![精靈的通知指出它已挑選 AD 屬性來作為 sourceAnchor](./media/active-directory-aadconnect-design-concepts/consistencyGuid-01.png)

#### <a name="custom-installation"></a><span data-ttu-id="f62f8-196">自訂安裝</span><span class="sxs-lookup"><span data-stu-id="f62f8-196">Custom installation</span></span>
<span data-ttu-id="f62f8-197">使用自訂 模式中安裝 Azure AD Connect 時, hello Azure AD Connect 精靈設定 sourceAnchor 屬性時，就會提供兩個選項：</span><span class="sxs-lookup"><span data-stu-id="f62f8-197">When installing Azure AD Connect with Custom mode, hello Azure AD Connect wizard provides two options when configuring sourceAnchor attribute:</span></span>

![自訂安裝 - sourceAnchor 設定](./media/active-directory-aadconnect-design-concepts/consistencyGuid-02.png)

| <span data-ttu-id="f62f8-199">設定</span><span class="sxs-lookup"><span data-stu-id="f62f8-199">Setting</span></span> | <span data-ttu-id="f62f8-200">說明</span><span class="sxs-lookup"><span data-stu-id="f62f8-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f62f8-201">可讓 Azure 能管理我的 hello 來源錨點</span><span class="sxs-lookup"><span data-stu-id="f62f8-201">Let Azure manage hello source anchor for me</span></span> | <span data-ttu-id="f62f8-202">如果您要為您的 Azure AD toopick hello 屬性，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="f62f8-202">Select this option if you want Azure AD toopick hello attribute for you.</span></span> <span data-ttu-id="f62f8-203">如果您選取此選項時，Azure AD Connect 精靈會套用 hello 相同[sourceAnchor 屬性選取邏輯 Express 安裝期間使用](#express-installation)。</span><span class="sxs-lookup"><span data-stu-id="f62f8-203">If you select this option, Azure AD Connect wizard applies hello same [sourceAnchor attribute selection logic used during Express installation](#express-installation).</span></span> <span data-ttu-id="f62f8-204">類似的 tooExpress 安裝 hello 精靈會通知您哪一個屬性具有已挑選為 hello 來源錨點屬性自訂安裝完成之後。</span><span class="sxs-lookup"><span data-stu-id="f62f8-204">Similar tooExpress installation, hello wizard informs you which attribute has been picked as hello Source Anchor attribute after Custom installation completes.</span></span> |
| <span data-ttu-id="f62f8-205">特定的屬性</span><span class="sxs-lookup"><span data-stu-id="f62f8-205">A specific attribute</span></span> | <span data-ttu-id="f62f8-206">如果您想 toospecify hello sourceAnchor 屬性的現有 AD 屬性，請選取此選項。</span><span class="sxs-lookup"><span data-stu-id="f62f8-206">Select this option if you wish toospecify an existing AD attribute as hello sourceAnchor attribute.</span></span> |

### <a name="how-tooenable-hello-consistencyguid-feature---existing-deployment"></a><span data-ttu-id="f62f8-207">如何 tooenable hello ConsistencyGuid 功能-現有的部署</span><span class="sxs-lookup"><span data-stu-id="f62f8-207">How tooenable hello ConsistencyGuid feature - Existing deployment</span></span>
<span data-ttu-id="f62f8-208">如果您有現有的 Azure AD Connect 部署使用 objectGUID 做 hello 來源錨點屬性，您可以切換它 toousing ConsistencyGuid 改為。</span><span class="sxs-lookup"><span data-stu-id="f62f8-208">If you have an existing Azure AD Connect deployment which is using objectGUID as hello Source Anchor attribute, you can switch it toousing ConsistencyGuid instead.</span></span>

>[!NOTE]
> <span data-ttu-id="f62f8-209">僅有較新版本的 Azure AD Connect (1.1.552.0 及之後) 支援從 ObjectGuid tooConsistencyGuid 做 hello 來源錨點屬性切換。</span><span class="sxs-lookup"><span data-stu-id="f62f8-209">Only newer versions of Azure AD Connect (1.1.552.0 and after) supports switching from ObjectGuid tooConsistencyGuid as hello Source Anchor attribute.</span></span>

<span data-ttu-id="f62f8-210">tooswitch 從 objectGUID tooConsistencyGuid 做 hello 來源錨點屬性：</span><span class="sxs-lookup"><span data-stu-id="f62f8-210">tooswitch from objectGUID tooConsistencyGuid as hello Source Anchor attribute:</span></span>

1. <span data-ttu-id="f62f8-211">啟動 hello Azure AD Connect 精靈，然後按一下**設定**toogo toohello 工作 畫面。</span><span class="sxs-lookup"><span data-stu-id="f62f8-211">Start hello Azure AD Connect wizard and click **Configure** toogo toohello Tasks screen.</span></span>

2. <span data-ttu-id="f62f8-212">選取 hello**設定來源錨點**工作選項，並按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="f62f8-212">Select hello **Configure Source Anchor** task option and click **Next**.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 2](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment01.png)

3. <span data-ttu-id="f62f8-214">輸入 Azure AD 系統管理員認證，然後按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="f62f8-214">Enter your Azure AD Administrator credentials and click **Next**.</span></span>

4. <span data-ttu-id="f62f8-215">Azure AD Connect 精靈會分析您在內部部署 Active Directory 中的 hello Msds-primary-computer ConsistencyGuid 屬性 hello 狀態。</span><span class="sxs-lookup"><span data-stu-id="f62f8-215">Azure AD Connect wizard analyzes hello state of hello msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="f62f8-216">如果 hello 屬性未設定任何物件在目錄中，Azure AD Connect 結束時，沒有其他應用程式目前正在使用 hello 屬性，並為安全 toouse hello 它為 hello 來源錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-216">If hello attribute isn't configured on any object in hello directory, Azure AD Connect concludes that no other application is currently using hello attribute and is safe toouse it as hello Source Anchor attribute.</span></span> <span data-ttu-id="f62f8-217">按一下**下一步**toocontinue。</span><span class="sxs-lookup"><span data-stu-id="f62f8-217">Click **Next** toocontinue.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 4](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment02.png)

5. <span data-ttu-id="f62f8-219">在 hello**準備 tooConfigure**畫面上，按一下**設定**toomake hello 組態變更。</span><span class="sxs-lookup"><span data-stu-id="f62f8-219">In hello **Ready tooConfigure** screen, click **Configure** toomake hello configuration change.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 5](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment03.png)

6. <span data-ttu-id="f62f8-221">Hello 組態完成之後，hello 精靈會指示該 Msds-primary-computer ConsistencyGuid 現在當作 hello 來源錨點屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-221">Once hello configuration completes, hello wizard indicates that msDS-ConsistencyGuid is now being used as hello Source Anchor attribute.</span></span>

   ![啟用現有部署的 ConsistencyGuid - 步驟 6](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment04.png)

<span data-ttu-id="f62f8-223">Hello 在分析期間 （步驟 4），如果 hello 目錄中的一個或多個物件上設定 hello 屬性 hello 精靈結束時，hello 屬性已由另一個應用程式，並傳回錯誤 hello 如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="f62f8-223">During hello analysis (step 4), if hello attribute is configured on one or more objects in hello directory, hello wizard concludes hello attribute is being used by another application and returns an error as illustrated in hello diagram below.</span></span> <span data-ttu-id="f62f8-224">如果您確定該 hello 屬性不會使用現有的應用程式，您需要 toocontact 支援 toosuppress 如何 hello 錯誤的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f62f8-224">If you are certain that hello attribute isn't used by existing applications, you need toocontact Support for information on how toosuppress hello error.</span></span>

![啟用現有部署的 ConsistencyGuid - 錯誤](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeploymenterror.png)

### <a name="impact-on-ad-fs-or-third-party-federation-configuration"></a><span data-ttu-id="f62f8-226">對 AD FS 或第三方同盟設定的影響</span><span class="sxs-lookup"><span data-stu-id="f62f8-226">Impact on AD FS or third-party federation configuration</span></span>
<span data-ttu-id="f62f8-227">如果您使用 Azure AD Connect toomanage 內部部署 AD FS 部署、 hello Azure AD Connect 會自動更新 hello 宣告規則 toouse hello 相同 AD 屬性做為 sourceAnchor。</span><span class="sxs-lookup"><span data-stu-id="f62f8-227">If you are using Azure AD Connect toomanage on-premises AD FS deployment, hello Azure AD Connect automatically updates hello claim rules toouse hello same AD attribute as sourceAnchor.</span></span> <span data-ttu-id="f62f8-228">這可確保產生的 ADFS 該 hello ImmutableID 宣告與 hello sourceAnchor 值匯出 tooAzure AD 一致。</span><span class="sxs-lookup"><span data-stu-id="f62f8-228">This ensures that hello ImmutableID claim generated by ADFS is consistent with hello sourceAnchor values exported tooAzure AD.</span></span>

<span data-ttu-id="f62f8-229">如果您要管理 Azure AD Connect 之外的 AD FS，或使用協力廠商同盟伺服器進行驗證，您必須手動更新 hello 宣告規則 ImmutableID 宣告 toobe 一致 hello sourceAnchor 值匯出為 tooAzure AD發行項 > 一節中所述[修改 AD FS 宣告規則](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims)。</span><span class="sxs-lookup"><span data-stu-id="f62f8-229">If you are managing AD FS outside of Azure AD Connect or you are using third-party federation servers for authentication, you must manually update hello claim rules for ImmutableID claim toobe consistent with hello sourceAnchor values exported tooAzure AD as described in article section [Modify AD FS claim rules](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span></span> <span data-ttu-id="f62f8-230">hello 精靈就會返回 hello 安裝完成之後，下列警告：</span><span class="sxs-lookup"><span data-stu-id="f62f8-230">hello wizard returns hello following warning after installation completes:</span></span>

![第三方同盟設定](./media/active-directory-aadconnect-design-concepts/consistencyGuid-03.png)

### <a name="adding-new-directories-tooexisting-deployment"></a><span data-ttu-id="f62f8-232">加入新的目錄 tooexisting 部署</span><span class="sxs-lookup"><span data-stu-id="f62f8-232">Adding new directories tooexisting deployment</span></span>
<span data-ttu-id="f62f8-233">假設您已部署 Azure AD Connect 與 hello ConsistencyGuid 功能啟用，而且現在您想要 tooadd 另一個目錄 toohello 部署。</span><span class="sxs-lookup"><span data-stu-id="f62f8-233">Suppose you have deployed Azure AD Connect with hello ConsistencyGuid feature enabled, and now you would like tooadd another directory toohello deployment.</span></span> <span data-ttu-id="f62f8-234">當您嘗試 tooadd hello 目錄時，Azure AD Connect 精靈會檢查 hello hello 目錄中的 hello Msds-primary-computer ConsistencyGuid 屬性狀態。</span><span class="sxs-lookup"><span data-stu-id="f62f8-234">When you try tooadd hello directory, Azure AD Connect wizard checks hello state of hello mSDS-ConsistencyGuid attribute in hello directory.</span></span> <span data-ttu-id="f62f8-235">如果在 hello 目錄的一或多個物件上設定 hello 屬性，hello 精靈結束時 hello 屬性已由其他應用程式，並傳回錯誤 hello 如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="f62f8-235">If hello attribute is configured on one or more objects in hello directory, hello wizard concludes hello attribute is being used by other applications and returns an error as illustrated in hello diagram below.</span></span> <span data-ttu-id="f62f8-236">如果您確定該 hello 屬性不會使用現有的應用程式，您需要 toocontact 支援 toosuppress 如何 hello 錯誤的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f62f8-236">If you are certain that hello attribute isn't used by existing applications, you need toocontact Support for information on how toosuppress hello error.</span></span>

![加入新的目錄 tooexisting 部署](./media/active-directory-aadconnect-design-concepts/consistencyGuid-04.png)

## <a name="azure-ad-sign-in"></a><span data-ttu-id="f62f8-238">Azure AD 登入</span><span class="sxs-lookup"><span data-stu-id="f62f8-238">Azure AD sign-in</span></span>
<span data-ttu-id="f62f8-239">同時使用 Azure AD 整合您的內部部署目錄，它是重要的 toounderstand hello 同步處理設定如何影響 hello 方式使用者驗證。</span><span class="sxs-lookup"><span data-stu-id="f62f8-239">While integrating your on-premises directory with Azure AD, it is important toounderstand how hello synchronization settings can affect hello way user authenticates.</span></span> <span data-ttu-id="f62f8-240">Azure AD 使用 userPrincipalName (UPN) tooauthenticate hello 使用者。</span><span class="sxs-lookup"><span data-stu-id="f62f8-240">Azure AD uses userPrincipalName (UPN) tooauthenticate hello user.</span></span> <span data-ttu-id="f62f8-241">不過，當您同步處理您的使用者，您必須選擇 hello 屬性 toobe 謹慎使用的 userPrincipalName 值。</span><span class="sxs-lookup"><span data-stu-id="f62f8-241">However, when you synchronize your users, you must choose hello attribute toobe used for value of userPrincipalName carefully.</span></span>

### <a name="choosing-hello-attribute-for-userprincipalname"></a><span data-ttu-id="f62f8-242">選擇 hello userPrincipalName 屬性</span><span class="sxs-lookup"><span data-stu-id="f62f8-242">Choosing hello attribute for userPrincipalName</span></span>
<span data-ttu-id="f62f8-243">當您選取 hello 屬性提供用於 Azure 的一個 UPN toobe hello 值應該確定</span><span class="sxs-lookup"><span data-stu-id="f62f8-243">When you are selecting hello attribute for providing hello value of UPN toobe used in Azure one should ensure</span></span>

* <span data-ttu-id="f62f8-244">hello 屬性值符合 toohello UPN 的語法 (RFC 822)，它應該是 hello 格式username@domain</span><span class="sxs-lookup"><span data-stu-id="f62f8-244">hello attribute values conform toohello UPN syntax (RFC 822), that is it should be of hello format username@domain</span></span>
* <span data-ttu-id="f62f8-245">中的 hello hello 值符合 tooone hello 後置字元在 Azure AD 中驗證自訂網域</span><span class="sxs-lookup"><span data-stu-id="f62f8-245">hello suffix in hello values matches tooone of hello verified custom domains in Azure AD</span></span>

<span data-ttu-id="f62f8-246">快速設定，在 hello 會假設是 userPrincipalName hello 屬性的選擇。</span><span class="sxs-lookup"><span data-stu-id="f62f8-246">In express settings, hello assumed choice for hello attribute is userPrincipalName.</span></span> <span data-ttu-id="f62f8-247">Hello userPrincipalName 屬性未包含 hello 值，如果您想 tooAzure，在您的使用者 toosign，則您必須選擇**自訂安裝**。</span><span class="sxs-lookup"><span data-stu-id="f62f8-247">If hello userPrincipalName attribute does not contain hello value you want your users toosign in tooAzure, then you must choose **Custom Installation**.</span></span>

### <a name="custom-domain-state-and-upn"></a><span data-ttu-id="f62f8-248">自訂網域狀態和 UPN</span><span class="sxs-lookup"><span data-stu-id="f62f8-248">Custom domain state and UPN</span></span>
<span data-ttu-id="f62f8-249">它是重要 tooensure 是 hello UPN 尾碼的已驗證的網域。</span><span class="sxs-lookup"><span data-stu-id="f62f8-249">It is important tooensure that there is a verified domain for hello UPN suffix.</span></span>

<span data-ttu-id="f62f8-250">John 是 contoso.com 中的使用者。您想要 John toouse hello 內部部署 UPN john@contoso.com toosign tooAzure 之後在已同步處理使用者 tooyour Azure AD 目錄 contoso.onmicrosoft.com。 toodo 因此，您需要 tooadd，並確認 contoso.com 做為自訂網域，在 Azure AD，您可以在開始之前同步處理 hello 使用者。</span><span class="sxs-lookup"><span data-stu-id="f62f8-250">John is a user in contoso.com. You want John toouse hello on-premises UPN john@contoso.com toosign in tooAzure after you have synced users tooyour Azure AD directory contoso.onmicrosoft.com. toodo so, you need tooadd and verify contoso.com as a custom domain in Azure AD before you can start syncing hello users.</span></span> <span data-ttu-id="f62f8-251">如果 John，例如 contoso.com hello UPN 尾碼不符合在 Azure AD 中的已驗證的網域，然後 Azure AD 來取代 hello UPN 尾碼 contoso.onmicrosoft.com。</span><span class="sxs-lookup"><span data-stu-id="f62f8-251">If hello UPN suffix of John, for example contoso.com, does not match a verified domain in Azure AD, then Azure AD replaces hello UPN suffix with contoso.onmicrosoft.com.</span></span>

### <a name="non-routable-on-premises-domains-and-upn-for-azure-ad"></a><span data-ttu-id="f62f8-252">無法路由傳送的內部部署網域與 Azure AD 的 UPN</span><span class="sxs-lookup"><span data-stu-id="f62f8-252">Non-routable on-premises domains and UPN for Azure AD</span></span>
<span data-ttu-id="f62f8-253">有些組織有無法路由傳送的網域，例如 contoso.local 或簡單單一標籤網域，例如 contoso。</span><span class="sxs-lookup"><span data-stu-id="f62f8-253">Some organizations have non-routable domains, like contoso.local, or simple single label domains like contoso.</span></span> <span data-ttu-id="f62f8-254">您不能 tooverify 路由的內部網域在 Azure AD 中。</span><span class="sxs-lookup"><span data-stu-id="f62f8-254">You are not able tooverify a non-routable domain in Azure AD.</span></span> <span data-ttu-id="f62f8-255">Azure AD Connect 可以在 Azure AD 同步 tooonly 已驗證的網域。</span><span class="sxs-lookup"><span data-stu-id="f62f8-255">Azure AD Connect can sync tooonly a verified domain in Azure AD.</span></span> <span data-ttu-id="f62f8-256">當您建立 Azure AD 目錄時，它會建立可路由傳送的網域，而該網域會成為 Azure AD 的預設網域，例如 contoso.onmicrosoft.com。因此，它會變成必要 tooverify 其他任何可路由網域，在此案例中如果您不想 toosync toohello 預設 onmicrosoft.com 網域。</span><span class="sxs-lookup"><span data-stu-id="f62f8-256">When you create an Azure AD directory, it creates a routable domain that becomes default domain for your Azure AD for example, contoso.onmicrosoft.com. Therefore, it becomes necessary tooverify any other routable domain in such a scenario in case you don't want toosync toohello default onmicrosoft.com domain.</span></span>

<span data-ttu-id="f62f8-257">讀取[加入您的自訂網域名稱 tooAzure Active Directory](../active-directory-add-domain.md)如需加入及驗證網域的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f62f8-257">Read [Add your custom domain name tooAzure Active Directory](../active-directory-add-domain.md) for more info on adding and verifying domains.</span></span>

<span data-ttu-id="f62f8-258">Azure AD Connect 會偵測您是否在無法路由傳送的網域環境中執行，並且會適當地警告您不要繼續進行快速設定。</span><span class="sxs-lookup"><span data-stu-id="f62f8-258">Azure AD Connect detects if you are running in a non-routable domain environment and would appropriately warn you from going ahead with express settings.</span></span> <span data-ttu-id="f62f8-259">如果您要在路由的內部網域中，操作可能是該 hello hello 使用者 UPN，然後也有非路由傳送的尾碼。</span><span class="sxs-lookup"><span data-stu-id="f62f8-259">If you are operating in a non-routable domain, then it is likely that hello UPN of hello users have non-routable suffixes too.</span></span> <span data-ttu-id="f62f8-260">例如，如果您正在執行 contoso.local，Azure AD Connect 會建議您 toouse 自訂設定，而不是使用 express 設定。</span><span class="sxs-lookup"><span data-stu-id="f62f8-260">For example, if you are running under contoso.local, Azure AD Connect suggests you toouse custom settings rather than using express settings.</span></span> <span data-ttu-id="f62f8-261">使用自訂設定，就應該做為 UPN toosign tooAzure 中同步處理的 tooAzure AD hello 使用者之後可以 toospecify hello 屬性。</span><span class="sxs-lookup"><span data-stu-id="f62f8-261">Using custom settings, you are able toospecify hello attribute that should be used as UPN toosign in tooAzure after hello users are synced tooAzure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f62f8-262">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f62f8-262">Next steps</span></span>
<span data-ttu-id="f62f8-263">深入了解 [整合內部部署身分識別與 Azure Active Directory](active-directory-aadconnect.md)。</span><span class="sxs-lookup"><span data-stu-id="f62f8-263">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
