---
title: "Azure AD v2.0 端點中有哪些差異？ | Microsoft Docs"
description: "原始的 Azure AD 和 v2.0 端點之間的比較。"
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 5060da46-b091-4e25-9fa8-af4ae4359b6c
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/01/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 81de65b0e825dec64383f52b02c5ee56c9434807
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="whats-different-about-the-v20-endpoint"></a><span data-ttu-id="53338-104">V2.0 端點有哪些差異？</span><span class="sxs-lookup"><span data-stu-id="53338-104">What's different about the v2.0 endpoint?</span></span>
<span data-ttu-id="53338-105">如果您熟悉 Azure Active Directory 或過去已整合 app 與 Azure AD，v2.0 端點中可能會有一些您預期不到的差異。</span><span class="sxs-lookup"><span data-stu-id="53338-105">If you're familiar with Azure Active Directory or have integrated apps with Azure AD in the past, there may be some differences in the v2.0 endpoint that you would not expect.</span></span>  <span data-ttu-id="53338-106">本文件集結了這些差異，讓您得以瞭解。</span><span class="sxs-lookup"><span data-stu-id="53338-106">This document calls out those differences for your understanding.</span></span>

> [!NOTE]
> <span data-ttu-id="53338-107">v2.0 端點並非支援每個 Azure Active Directory 案例和功能。</span><span class="sxs-lookup"><span data-stu-id="53338-107">Not all Azure Active Directory scenarios & features are supported by the v2.0 endpoint.</span></span>  <span data-ttu-id="53338-108">若要判斷是否應該使用 v2.0 端點，請閱讀相關的 [v2.0 限制](active-directory-v2-limitations.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-108">To determine if you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>

## <a name="microsoft-accounts-and-azure-ad-accounts"></a><span data-ttu-id="53338-109">Microsoft 帳戶和 Azure AD 帳戶</span><span class="sxs-lookup"><span data-stu-id="53338-109">Microsoft accounts and Azure AD accounts</span></span>
<span data-ttu-id="53338-110">v2.0 端點讓開發人員能夠撰寫可接受使用單一驗證端點同時從 Microsoft 帳戶和 Azure AD 帳戶登入的 app。</span><span class="sxs-lookup"><span data-stu-id="53338-110">The v2.0 endpoint allow developers to write apps that accept sign-in from both Microsoft Accounts and Azure AD accounts, using a single auth endpoint.</span></span>  <span data-ttu-id="53338-111">這可讓您撰寫您的應用程式且帳戶完全無從驗證；可以忽略使用者登入時所用的帳戶類型。</span><span class="sxs-lookup"><span data-stu-id="53338-111">This gives you the ability to write your app completely account-agnostic; it can be ignorant of the type of account that the user signs in with.</span></span>  <span data-ttu-id="53338-112">當然，您 *可以* 讓您的應用程式知道特定工作階段中所使用的帳戶類型，但您不必這麼做。</span><span class="sxs-lookup"><span data-stu-id="53338-112">Of course, you *can* make your app aware of the type of account being used in a particular session, but you don't have to.</span></span>

<span data-ttu-id="53338-113">例如，如果您的 app 呼叫 [Microsoft Graph](https://graph.microsoft.io)，則有一些額外的功能和資料可供企業使用者使用，例如他們的 SharePoint 網站或目錄資料。</span><span class="sxs-lookup"><span data-stu-id="53338-113">For instance, if your app calls the [Microsoft Graph](https://graph.microsoft.io), some additional functionality and data will be available to enterprise users, such as their SharePoint sites or Directory data.</span></span>  <span data-ttu-id="53338-114">但在許多動作 (例如 [讀取使用者的郵件](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message)) 中，針對 Microsoft 帳戶和 Azure AD 帳戶撰寫的程式碼可以完全相同。</span><span class="sxs-lookup"><span data-stu-id="53338-114">But for many actions, such as [Reading a user's mail](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message), the code can be written exactly the same for both Microsoft Accounts and Azure AD accounts.</span></span>  

<span data-ttu-id="53338-115">整合應用程式與 Microsoft 帳戶和 Azure AD 帳戶現在是一個簡單的程序。</span><span class="sxs-lookup"><span data-stu-id="53338-115">Integrating your app with Microsoft Accounts and Azure AD accounts is now one simple process.</span></span>  <span data-ttu-id="53338-116">您可以利用一組端點、單一資源庫和單一應用程式註冊來進入消費者和企業的世界。</span><span class="sxs-lookup"><span data-stu-id="53338-116">You can use a single set of endpoints, a single library, and a single app registration to gain access to both the consumer and enterprise worlds.</span></span>  <span data-ttu-id="53338-117">若要深入了解 v2.0 端點，請參閱 [概觀](active-directory-appmodel-v2-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-117">To learn more about the v2.0 endpoint, check out [the overview](active-directory-appmodel-v2-overview.md).</span></span>

## <a name="new-app-registration-portal"></a><span data-ttu-id="53338-118">新的 App 註冊入口網站</span><span class="sxs-lookup"><span data-stu-id="53338-118">New app registration portal</span></span>
<span data-ttu-id="53338-119">若要註冊可與 v2.0 端點搭配使用的應用程式，您必須使用新的應用程式註冊入口網站：[apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)。</span><span class="sxs-lookup"><span data-stu-id="53338-119">To register an app that works with the v2.0 endpoint, you must use a new app registration portal: [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).</span></span>  <span data-ttu-id="53338-120">您可以在這個入口網站取得應用程式識別碼、自訂應用程式登入頁面的外觀等等。</span><span class="sxs-lookup"><span data-stu-id="53338-120">This is the portal where you can obtain an application ID, customize the appearance of your app's sign-in page, and more.</span></span>  <span data-ttu-id="53338-121">您存取入口網站時唯一需要的是 Microsoft 提供的帳戶 - 個人或工作/學校帳戶。</span><span class="sxs-lookup"><span data-stu-id="53338-121">All you need to access the portal is a Microsoft powered account - either personal or work/school account.</span></span>

## <a name="one-app-id-for-all-platforms"></a><span data-ttu-id="53338-122">所有平台使用一個應用程式識別碼</span><span class="sxs-lookup"><span data-stu-id="53338-122">One app ID for all platforms</span></span>
<span data-ttu-id="53338-123">如果您已經使用 Azure Active Directory，您可能已針對單一專案註冊數個不同的應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-123">If you've used Azure Active Directory, you've probably registered several different apps for a single project.</span></span>  <span data-ttu-id="53338-124">例如，如果您同時建置了網站和 iOS app，就必須使用兩個不同的應用程式識別碼分別註冊它們。</span><span class="sxs-lookup"><span data-stu-id="53338-124">For example, if you built both a website and an iOS app, you had to register them separately, using two different Application Ids.</span></span> <span data-ttu-id="53338-125">Azure AD 應用程式註冊入口網站會在註冊過程中強制您做此區分：</span><span class="sxs-lookup"><span data-stu-id="53338-125">The Azure AD app registration portal forced you to make this distinction during registration:</span></span>

![舊版應用程式註冊 UI](../../media/active-directory-v2-flows/old_app_registration.PNG)

<span data-ttu-id="53338-127">同樣地，如果您有網站和後端 Web API，您可能已在 Azure AD 中將它們註冊為個別的應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-127">Similarly, if you had a website and a backend web api, you might have registered each as a separate app in Azure AD.</span></span>  <span data-ttu-id="53338-128">或者，如果您有 iOS 應用程式和 Android 應用程式，您也可能已註冊兩個不同的應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-128">Or if you had an iOS app and an Android app, you also might have registered two different apps.</span></span>  <span data-ttu-id="53338-129">註冊應用程式的每個元件，會導致針對開發人員和其客戶出現某些非預期的行為：</span><span class="sxs-lookup"><span data-stu-id="53338-129">Registering each component of an application led to some unexpected behaviors for developers and their customers:</span></span>

* <span data-ttu-id="53338-130">每個元件會在每個客戶的 Azure Active Directory 租用戶中顯示為個別的應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-130">Each component appeared as a separate app in the Azure Active Directory tenant of each customer.</span></span>
* <span data-ttu-id="53338-131">當租用戶系統管理員嘗試套用原則至應用程式、管理對應用程式的存取，或刪除應用程式時，他們就必須針對應用程式的每個元件執行此操作。</span><span class="sxs-lookup"><span data-stu-id="53338-131">When a tenant administrator attempted to apply policy to, manage access to, or delete an app, they would have to do so for each component of the app.</span></span>
* <span data-ttu-id="53338-132">當客戶同意使用應用程式時，每個元件會以個別應用程式的形式出現在同意畫面中。</span><span class="sxs-lookup"><span data-stu-id="53338-132">When customers consented to an application, each component would appear in the consent screen as a distinct application.</span></span>

<span data-ttu-id="53338-133">您現在可以使用 v2.0 端點，以單一應用程式註冊的方式註冊您專案中的所有元件，並針對整個專案使用單一應用程式識別碼。</span><span class="sxs-lookup"><span data-stu-id="53338-133">With the v2.0 endpoint, you can now register all components of your project as a single app registration, and use a single Application Id for your entire project.</span></span>  <span data-ttu-id="53338-134">您可以將數個「平台」加入至每個專案，並且為您加入的每個平台提供適當的資料。</span><span class="sxs-lookup"><span data-stu-id="53338-134">You can add several "platforms" to a each project, and provide the appropriate data for each platform you add.</span></span>  <span data-ttu-id="53338-135">當然，您可以根據您的需求建立任意數量的應用程式，但在大多數的情況下應該只需要一個應用程式識別碼。</span><span class="sxs-lookup"><span data-stu-id="53338-135">Of course, you can create as many apps as you like depending on your requirements, but for the majority of cases only one Application Id should be necessary.</span></span>

<span data-ttu-id="53338-136">我們的目標是促成更簡化的應用程式管理及開發經驗，並且為您可能正在處理的單一專案建立更加整合的檢視。</span><span class="sxs-lookup"><span data-stu-id="53338-136">Our aim is that this will lead to a more simplified app management and development experience, and create a more consolidated view of a single project that you might be working on.</span></span>

## <a name="scopes-not-resources"></a><span data-ttu-id="53338-137">範圍，而非資源</span><span class="sxs-lookup"><span data-stu-id="53338-137">Scopes, not resources</span></span>
<span data-ttu-id="53338-138">在 Azure Active Directory 中，應用程式能以「資源」，或是權杖收件者的方式運作。</span><span class="sxs-lookup"><span data-stu-id="53338-138">In Azure Active Directory, an app can behave as a **resource**, or a recipient of tokens.</span></span>  <span data-ttu-id="53338-139">資源可以定義它所了解的許多**範圍**或 **oAuth2Permissions**，讓用戶端應用程式得以針對特定一組範圍要求該資源的權杖。</span><span class="sxs-lookup"><span data-stu-id="53338-139">A resource can define a number of **scopes** or **oAuth2Permissions** that it understands, allowing client apps to request tokens to that resource for a certain set of scopes.</span></span>  <span data-ttu-id="53338-140">請考慮以 Azure AD Graph API 做為資源的範例：</span><span class="sxs-lookup"><span data-stu-id="53338-140">Consider the Azure AD Graph API as an example of a resource:</span></span>

* <span data-ttu-id="53338-141">資源識別碼，或`AppID URI`：`https://graph.windows.net/`</span><span class="sxs-lookup"><span data-stu-id="53338-141">Resource Identifier, or `AppID URI`: `https://graph.windows.net/`</span></span>
* <span data-ttu-id="53338-142">範圍，或`OAuth2Permissions`：`Directory.Read`、`Directory.Write` 等。</span><span class="sxs-lookup"><span data-stu-id="53338-142">Scopes, or `OAuth2Permissions`: `Directory.Read`, `Directory.Write`, etc.</span></span>  

<span data-ttu-id="53338-143">這一切都適用於 v2.0 端點。</span><span class="sxs-lookup"><span data-stu-id="53338-143">All of this holds true for the the v2.0 endpoint.</span></span>  <span data-ttu-id="53338-144">應用程式仍可做為資源、定義範圍並依據 URI 識別。</span><span class="sxs-lookup"><span data-stu-id="53338-144">An app can still behave as resource, define scopes, and be identified by a URI.</span></span>  <span data-ttu-id="53338-145">用戶端應用程式仍可要求存取這些範圍。</span><span class="sxs-lookup"><span data-stu-id="53338-145">Client apps can still request access to those scopes.</span></span>  <span data-ttu-id="53338-146">不過，用戶端用來要求這些權限的方式已改變。</span><span class="sxs-lookup"><span data-stu-id="53338-146">However, the way in which a client requests those permissions has changed.</span></span>  <span data-ttu-id="53338-147">在過去，Azure AD 的 OAuth 2.0 授權要求可能如下所示：</span><span class="sxs-lookup"><span data-stu-id="53338-147">In the past, an OAuth 2.0 authorize request to Azure AD might have looked like:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&resource=https%3A%2F%2Fgraph.windows.net%2F
...
```

<span data-ttu-id="53338-148">其中 **resource** 參數指出用戶端應用程式要求授權的資源。</span><span class="sxs-lookup"><span data-stu-id="53338-148">where the **resource** parameter indicated which resource the client app is requesting authorization for.</span></span>  <span data-ttu-id="53338-149">Azure AD 根據 Azure 入口網站中的靜態設定計算應用程式所需的權限，並據以發出權杖。</span><span class="sxs-lookup"><span data-stu-id="53338-149">Azure AD computed the permissions required by the app based on static configuration in the Azure Portal, and issued tokens accordingly.</span></span>  <span data-ttu-id="53338-150">現在，相同的 OAuth 2.0 授權要求如下所示：</span><span class="sxs-lookup"><span data-stu-id="53338-150">Now, the same OAuth 2.0 authorize request looks like:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

<span data-ttu-id="53338-151">其中 **scope** 參數指出用戶端應用程式授權的資源和權限。</span><span class="sxs-lookup"><span data-stu-id="53338-151">where the **scope** parameter indicates which resource and permissions the app is requesting authorization for.</span></span> <span data-ttu-id="53338-152">所需的資源仍是要求中最新的 - 它只會包含在 scope 參數的每個值中。</span><span class="sxs-lookup"><span data-stu-id="53338-152">The desired resource is still very present in the request - it is simply encompassed in each of the values of the scope parameter.</span></span>  <span data-ttu-id="53338-153">以此方式使用 scope 參數可讓 v2.0 端點更符合 OAuth 2.0 規格，並且更貼近常見的業界作法。</span><span class="sxs-lookup"><span data-stu-id="53338-153">Using the scope parameter in this manner allows the v2.0 endpoint to be more compliant with the OAuth 2.0 specification, and aligns more closely with common industry practices.</span></span>  <span data-ttu-id="53338-154">它也可以讓應用程式執行下一節所描述的 [增量同意](#incremental-and-dynamic-consent)。</span><span class="sxs-lookup"><span data-stu-id="53338-154">It also enables apps to perform [incremental consent](#incremental-and-dynamic-consent), which is described in the next section.</span></span>

## <a name="incremental-and-dynamic-consent"></a><span data-ttu-id="53338-155">增量和動態同意</span><span class="sxs-lookup"><span data-stu-id="53338-155">Incremental and dynamic consent</span></span>
<span data-ttu-id="53338-156">已在 Azure AD 中註冊的應用程式，必須於應用程式建立時，在 Azure 入口網站中指定其所需的 OAuth 2.0 權限：</span><span class="sxs-lookup"><span data-stu-id="53338-156">Apps registered in Azure AD previously needed to specify their required OAuth 2.0 permissions in the Azure Portal, at app creation time:</span></span>

![權限註冊 UI](../../media/active-directory-v2-flows/app_reg_permissions.PNG)

<span data-ttu-id="53338-158">應用程式所需的權限是以 **靜態**方式進行設定。</span><span class="sxs-lookup"><span data-stu-id="53338-158">The permissions an app required were configured **statically**.</span></span>  <span data-ttu-id="53338-159">雖然這可讓應用程式的設定存在於 Azure 入口網站中並使程式碼好用又簡單，但開發人員會面臨一些問題：</span><span class="sxs-lookup"><span data-stu-id="53338-159">While this allowed configuration of the app to exist in the Azure Portal and kept the code nice and simple, it presents a few issues for developers:</span></span>

* <span data-ttu-id="53338-160">應用程式必須在應用程式建立時知道可能會需要的所有權限。</span><span class="sxs-lookup"><span data-stu-id="53338-160">An app had to know all of the permissions it would ever need at app creation time.</span></span>  <span data-ttu-id="53338-161">隨著時間新增權限有所困難。</span><span class="sxs-lookup"><span data-stu-id="53338-161">Adding permissions over time was a difficult process.</span></span>
* <span data-ttu-id="53338-162">應用程式必須事先知道可能會存取的所有資源。</span><span class="sxs-lookup"><span data-stu-id="53338-162">An app had to know all of the resources it would ever access ahead of time.</span></span>  <span data-ttu-id="53338-163">很難建立能夠存取任意數目的資源的應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-163">It was difficult to create apps that could access an arbitrary number of resources.</span></span>
* <span data-ttu-id="53338-164">應用程式必須在使用者第一次登入時要求可能會需要的權限。</span><span class="sxs-lookup"><span data-stu-id="53338-164">An app had to request all the permissions it would ever need upon the user's first sign-in.</span></span>  <span data-ttu-id="53338-165">在某些情況下，這會導致非常冗長的權限清單，而讓使用者在初始登入時打消核准應用程式存取權的念頭。</span><span class="sxs-lookup"><span data-stu-id="53338-165">In some cases this led to a very long list of permissions, which discouraged end-users from approving the app's access on initial sign-in.</span></span>

<span data-ttu-id="53338-166">透過 v2.0 端點，您可以在執行階段 **動態**指定您的 app 在一般使用期間所需的權限。</span><span class="sxs-lookup"><span data-stu-id="53338-166">With the v2.0 endpoint, you can specify the permissions your app needs **dynamically**, at runtime, during regular usage of your app.</span></span>  <span data-ttu-id="53338-167">若要這麼做，您可以在授權要求的 `scope` 參數中包含範圍，以在任何指定的時間點指定您的應用程式所需的範圍：</span><span class="sxs-lookup"><span data-stu-id="53338-167">To do so, you can specify the scopes your app needs at any given point in time by including them in the `scope` parameter of an authorization request:</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

<span data-ttu-id="53338-168">應用程式的上述要求權限可讀取 Azure AD 使用者的目錄資料，以及將資料寫入至其目錄。</span><span class="sxs-lookup"><span data-stu-id="53338-168">The above requests permission for the app to read an Azure AD user's directory data, as well as write data to their directory.</span></span>  <span data-ttu-id="53338-169">如果使用者過去曾針對此特定應用程式同意這些權限，他們只要輸入其認證並登入應用程式。</span><span class="sxs-lookup"><span data-stu-id="53338-169">If the user has consented to those permissions in the past for this particular app, they will simply enter their credentials and be signed into the app.</span></span>  <span data-ttu-id="53338-170">如果使用者未曾同意這些權限的任何一項，v2.0 端點會要求使用者同意這些權限。</span><span class="sxs-lookup"><span data-stu-id="53338-170">If the user has not consented to any of these permissions, the v2.0 endpoint will ask the user for consent to those permissions.</span></span>  <span data-ttu-id="53338-171">若要深入了解，您可以參閱 [權限、同意和範圍](active-directory-v2-scopes.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-171">To learn more, you can read up on [permissions, consent, and scopes](active-directory-v2-scopes.md).</span></span>

<span data-ttu-id="53338-172">允許應用程式透過 `scope` 參數動態要求權限，您即可完全掌控使用者的經驗。</span><span class="sxs-lookup"><span data-stu-id="53338-172">Allowing an app to request permissions dynamically via the `scope` parameter gives you full control over your user's experience.</span></span>  <span data-ttu-id="53338-173">如果您希望，您可以選擇將您的同意體驗提前，並在一個初始授權要求中要求所有的權限。</span><span class="sxs-lookup"><span data-stu-id="53338-173">If you wish, you can choose to frontload your consent experience and ask for all permissions in one initial authorization request.</span></span>  <span data-ttu-id="53338-174">或者，如果您的應用程式需要大量的權限，您可以選擇在嘗試使用您的應用程式的某些功能時，以遞增方式向使用者收集這些權限。</span><span class="sxs-lookup"><span data-stu-id="53338-174">Or if your app requires a large number of permissions, you can choose to gather those permissions from the user incrementally, as they attempt to use certain features of your app over time.</span></span>

## <a name="well-known-scopes"></a><span data-ttu-id="53338-175">知名的範圍</span><span class="sxs-lookup"><span data-stu-id="53338-175">Well-known scopes</span></span>
#### <a name="offline-access"></a><span data-ttu-id="53338-176">離線存取</span><span class="sxs-lookup"><span data-stu-id="53338-176">Offline access</span></span>
<span data-ttu-id="53338-177">使用 v2.0 端點的應用程式可能需要針對應用程式使用新的已知權限：`offline_access` 範圍。</span><span class="sxs-lookup"><span data-stu-id="53338-177">Apps using the v2.0 endpoint may require the use of a new well-known permission for apps - the `offline_access` scope.</span></span>  <span data-ttu-id="53338-178">如果應用程式需要長期代表使用者存取資源，則所有應用程式都需要要求此權限，即使使用者可能不會主動使用此應用程式亦然。</span><span class="sxs-lookup"><span data-stu-id="53338-178">All apps will need to request this permission if they need to access resources on the behalf of a user for a prolonged period of time, even when the user may not be actively using the app.</span></span>  <span data-ttu-id="53338-179">在同意對話方塊中， `offline_access` 範圍會對使用者顯示做為「離線存取您的資料」，而使用者必須加以同意。</span><span class="sxs-lookup"><span data-stu-id="53338-179">The `offline_access` scope will appear to the user in consent dialogs as "Access your data offline", which the user must agree to.</span></span>  <span data-ttu-id="53338-180">要求 `offline_access` 權限可讓您的 Web 應用程式從 v2.0 端點獲取 OAuth 2.0 refresh_token。</span><span class="sxs-lookup"><span data-stu-id="53338-180">Requesting the `offline_access` permission will enable your web app to receive OAuth 2.0 refresh_tokens from the v2.0 endpoint.</span></span>  <span data-ttu-id="53338-181">Refresh_token 屬於長效權杖，可用來交換新的 OAuth 2.0 access_token 以延長存取期間。</span><span class="sxs-lookup"><span data-stu-id="53338-181">Refresh_tokens are long-lived, and can be exchanged for new OAuth 2.0 access_tokens for extended periods of access.</span></span>  

<span data-ttu-id="53338-182">如果您的應用程式未要求 `offline_access` 範圍，則不會收到 refresh_token。</span><span class="sxs-lookup"><span data-stu-id="53338-182">If your app does not request the `offline_access` scope, it will not receive refresh_tokens.</span></span>  <span data-ttu-id="53338-183">這表示當您在 OAuth 2.0 授權碼流程中兌換 authorization_code 時，只會從 `/token` 端點接收回一個 access_token。</span><span class="sxs-lookup"><span data-stu-id="53338-183">This means that when you redeem an authorization_code in the OAuth 2.0 authorization code flow, you will only receive back an access_token from the `/token` endpoint.</span></span>  <span data-ttu-id="53338-184">該 access_token 會短時間維持有效 (通常是一小時)，但最後終將過期。</span><span class="sxs-lookup"><span data-stu-id="53338-184">That access_token will remain valid for a short period of time (typically one hour), but will eventually expire.</span></span>  <span data-ttu-id="53338-185">屆時，您的應用程式必須將使用者重新導向回到 `/authorize` 端點以擷取新的 authorization_code。</span><span class="sxs-lookup"><span data-stu-id="53338-185">At that point in time, your app will need to redirect the user back to the `/authorize` endpoint to retrieve a new authorization_code.</span></span>  <span data-ttu-id="53338-186">在此重新導向期間，視應用程式的類型而定，使用者或許不需要再次輸入其認證或重新同意權限。</span><span class="sxs-lookup"><span data-stu-id="53338-186">During this redirect, the user may or may not need to enter their credentials again or re-consent to permissions, depending on the the type of app.</span></span>

<span data-ttu-id="53338-187">若要深入了解 OAuth 2.0、refresh_token 和 access_token，請參閱 [v2.0 通訊協定參考](active-directory-v2-protocols.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-187">To learn more about OAuth 2.0, refresh_tokens, and access_tokens, check out the [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

#### <a name="openid-profile-and-email"></a><span data-ttu-id="53338-188">OpenID、設定檔和電子郵件</span><span class="sxs-lookup"><span data-stu-id="53338-188">OpenID, profile and email</span></span>
<span data-ttu-id="53338-189">過去，搭配 Azure Active Directory 之最基本的 OpenID Connect 登入流程，會在產生的 id_token 中提供豐富的使用者相關資訊。</span><span class="sxs-lookup"><span data-stu-id="53338-189">Historically, the most basic OpenID Connect sign-in flow with Azure Active Directory would provide a wealth of information about the user in the resulting id_token.</span></span>  <span data-ttu-id="53338-190">id_token 中的宣告可以包含使用者的名稱、慣用使用者名稱、電子郵件地址、物件識別碼等等。</span><span class="sxs-lookup"><span data-stu-id="53338-190">The claims in an id_token can include the user's name, preferred username, email address, object ID, and more.</span></span>

<span data-ttu-id="53338-191">我們現在會限制 `openid` 範圍可提供 app 存取權的資訊。</span><span class="sxs-lookup"><span data-stu-id="53338-191">We are now restricting the information that the `openid` scope affords your app access to.</span></span>  <span data-ttu-id="53338-192">‘openid’ 範圍只允許您的 app 將使用者登入，並接收使用者的 app 特定識別碼。</span><span class="sxs-lookup"><span data-stu-id="53338-192">The ‘openid’ scope will only allow your app to sign the user in, and receive an app-specific identifier for the user.</span></span>  <span data-ttu-id="53338-193">如果您想要取得有關您的應用程式中的使用者的個人識別資訊 (PII)，您的應用程式必須向使用者要求其他權限。</span><span class="sxs-lookup"><span data-stu-id="53338-193">If you want to obtain personally identifiable information (PII) about the user in your app, your app will need to request additional permissions from the user.</span></span>  <span data-ttu-id="53338-194">我們引進的兩個新範圍 (`email` 和 `profile` 範圍) 可讓您執行這項操作。</span><span class="sxs-lookup"><span data-stu-id="53338-194">We are introducing two new scopes – the `email` and `profile` scopes – which allow you to do so.</span></span>

<span data-ttu-id="53338-195">`email` 範圍非常簡單，它可讓您的 app 透過 id_token 中的 `email` 宣告存取使用者的主要電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="53338-195">The `email` scope is very straightforward – it allows your app access to the user’s primary email address via the `email` claim in the id_token.</span></span>  <span data-ttu-id="53338-196">`profile` 範圍可以讓您的應用程式存取使用者的所有其他基本資訊 – 其名稱、慣用的使用者名稱、物件識別碼等等。</span><span class="sxs-lookup"><span data-stu-id="53338-196">The `profile` scope affords your app access to all other basic information about the user – their name, preferred username, object ID, and so on.</span></span>

<span data-ttu-id="53338-197">這可讓您以最低洩漏的方式編碼應用程式 – 您只可以向使用者要求應用程式執行其作業所需的資訊集。</span><span class="sxs-lookup"><span data-stu-id="53338-197">This allows you to code your app in a minimal-disclosure fashion – you can only ask the user for the set of information that your app requires to do its job.</span></span>  <span data-ttu-id="53338-198">如需這些範圍的詳細資訊，請參閱 [v2.0 範圍參考](active-directory-v2-scopes.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-198">For more information on these scopes, refer to [the v2.0 scope reference](active-directory-v2-scopes.md).</span></span>

## <a name="token-claims"></a><span data-ttu-id="53338-199">權杖宣告</span><span class="sxs-lookup"><span data-stu-id="53338-199">Token Claims</span></span>
<span data-ttu-id="53338-200">V2.0 端點所簽發的權杖中的宣告與公開上市 Azure AD 端點所簽發的權杖不會相同 - 移轉至新服務的應用程式不應假設特定的宣告會存在於 id_token 或 access_token 中。</span><span class="sxs-lookup"><span data-stu-id="53338-200">The claims in tokens issued by the v2.0 endpoint will not be identical to tokens issued by the generally available Azure AD endpoints - apps migrating to the new service should not assume a particular claim will exist in id_tokens or access_tokens.</span></span> <span data-ttu-id="53338-201">若要深入了解 v2.0 權杖中發出的特定宣告，請參閱 [v2.0 權杖參考](active-directory-v2-tokens.md)。</span><span class="sxs-lookup"><span data-stu-id="53338-201">To learn about the specific claims emitted in v2.0 tokens, see the [v2.0 token reference](active-directory-v2-tokens.md).</span></span>

## <a name="limitations"></a><span data-ttu-id="53338-202">限制</span><span class="sxs-lookup"><span data-stu-id="53338-202">Limitations</span></span>
<span data-ttu-id="53338-203">使用 v2.0 端點時有一些要注意的限制。</span><span class="sxs-lookup"><span data-stu-id="53338-203">There are a few restrictions to be aware of when using the v2.0 point.</span></span>  <span data-ttu-id="53338-204">請參閱 [v2.0 限制文件](active-directory-v2-limitations.md) ，以了解是否有任何限制適用於您特定的案例。</span><span class="sxs-lookup"><span data-stu-id="53338-204">Please refer to the [v2.0 limitations doc](active-directory-v2-limitations.md) to see if any of these restrictions apply to your particular scenario.</span></span>
