---
title: "設定 Azure AD 資源庫應用程式的使用者佈建時遇到的問題 | Microsoft Docs"
description: "如何對在為已經列於 Azure AD 應用程式庫中的應用程式設定使用者佈建時所面臨的常見問題進行疑難排解"
services: active-directory
documentationcenter: 
author: ajamess
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: asteen
ms.openlocfilehash: 44e344095352f2bc6b27e389fc8be2cdf3e368d8
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="problem-configuring-user-provisioning-to-an-azure-ad-gallery-application"></a><span data-ttu-id="b13e3-103">設定 Azure AD 資源庫應用程式的使用者佈建時遇到的問題</span><span class="sxs-lookup"><span data-stu-id="b13e3-103">Problem configuring user provisioning to an Azure AD Gallery application</span></span>

<span data-ttu-id="b13e3-104">設定應用程式的[自動使用者佈建](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning) (如果支援)，需要遵循特定指示來準備應用程式以進行自動佈建。</span><span class="sxs-lookup"><span data-stu-id="b13e3-104">Configuring [automatic user provisioning](https://docs.microsoft.com/azure/active-directory/active-directory-saas-app-provisioning) for an app (where supported), requires that specific instructions be followed to prepare the application for automatic provisioning.</span></span> <span data-ttu-id="b13e3-105">接著，可以使用 Azure 入口網站來設定佈建服務，將使用者帳戶同步處理至應用程式。</span><span class="sxs-lookup"><span data-stu-id="b13e3-105">Then you can use the Azure portal to configure the provisioning service to synchronize user accounts to the application.</span></span>

<span data-ttu-id="b13e3-106">您一開始總是應先尋找為應用程式設定佈建專用的設定教學課程。</span><span class="sxs-lookup"><span data-stu-id="b13e3-106">You should always start by finding the setup tutorial specific to setting up provisioning for your application.</span></span> <span data-ttu-id="b13e3-107">然後，遵循這些步驟來設定應用程式和 Azure AD 以建立佈建連接。</span><span class="sxs-lookup"><span data-stu-id="b13e3-107">Then follow those steps to configure both the app and Azure AD to create the provisioning connection.</span></span> <span data-ttu-id="b13e3-108">您可以在[如何與 Azure Active Directory 整合 SaaS 應用程式的教學課程清單](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list)中找到應用程式教學課程清單。</span><span class="sxs-lookup"><span data-stu-id="b13e3-108">A list of app tutorials can be found at [List of Tutorials on How to Integrate SaaS Apps with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list).</span></span>

## <a name="how-to-see-if-provisioning-is-working"></a><span data-ttu-id="b13e3-109">如何查看佈建是否正常運作</span><span class="sxs-lookup"><span data-stu-id="b13e3-109">How to see if provisioning is working</span></span> 

<span data-ttu-id="b13e3-110">一旦設定服務之後，就能從下列兩個位置繪製出大多數對服務作業的深入見解：</span><span class="sxs-lookup"><span data-stu-id="b13e3-110">Once the service is configured, most insights into the operation of the service can be drawn from two places:</span></span>

-   <span data-ttu-id="b13e3-111">**稽核記錄** - 佈建稽核記錄會記錄佈建服務所執行的所有作業，包括針對位於佈建範圍內的已指派使用者查詢 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="b13e3-111">**Audit logs** – The provisioning audit logs record all the operations performed by the provisioning service, including querying Azure AD for assigned users that are in scope for provisioning.</span></span> <span data-ttu-id="b13e3-112">查詢目標應用程式以確定那些使用者是否存在，比較系統之間的使用者物件。</span><span class="sxs-lookup"><span data-stu-id="b13e3-112">Query the target app for the existence of those users, comparing the user objects between the system.</span></span> <span data-ttu-id="b13e3-113">接著，根據比較，在目標系統中新增、更新或停用使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="b13e3-113">Then add, update, or disable the user account in the target system based on the comparison.</span></span> <span data-ttu-id="b13e3-114">您可以在 Azure 入口網站的 [Azure Active Directory]&gt;[企業應用程式]&gt;[\[應用程式名稱\]]&gt;[稽核記錄] 索引標籤中存取佈建稽核記錄。</span><span class="sxs-lookup"><span data-stu-id="b13e3-114">The provisioning audit logs can be accessed in the Azure portal, in the **Azure Active Directory &gt; Enterprise Apps &gt; \[Application Name\] &gt; Audit Logs** tab.</span></span> <span data-ttu-id="b13e3-115">基於 [帳戶佈建] 類別來篩選記錄，只顯示該應用程式的佈建事件。</span><span class="sxs-lookup"><span data-stu-id="b13e3-115">Filter the logs on the **Account Provisioning** category to only see the provisioning events for that app.</span></span>

-   <span data-ttu-id="b13e3-116">**佈建狀態 -** 您可以在 [Azure Active Directory]&gt;[企業應用程式]&gt;[\[應用程式名稱\]]&gt;[佈建] 區段中，於螢幕底部的服務設定下方，看見指定應用程式的最後一個佈建執行摘要。</span><span class="sxs-lookup"><span data-stu-id="b13e3-116">**Provisioning status –** A summary of the last provisioning run for a given app can be seen in the **Azure Active Directory &gt; Enterprise Apps &gt; \[Application Name\] &gt;Provisioning** section, at the bottom of the screen under the service settings.</span></span> <span data-ttu-id="b13e3-117">本節將摘要說明目前會在這兩個系統之間同步處理多少個使用者 (和/或群組)，以及是否發生任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="b13e3-117">This section summarizes how many users (and/or groups) are currently being synchronized between the two systems, and if there are any errors.</span></span> <span data-ttu-id="b13e3-118">錯誤詳細資料位於稽核記錄中。</span><span class="sxs-lookup"><span data-stu-id="b13e3-118">Error details be in the audit logs.</span></span> <span data-ttu-id="b13e3-119">請注意，在 Azure AD 和應用程式之間完成一次完整的初始同步處理之前，不會填入佈建資料。</span><span class="sxs-lookup"><span data-stu-id="b13e3-119">Note that the provisioning status not be populated until one full initial synchronization has been completed between Azure AD and the app.</span></span>

## <a name="general-problem-areas-with-provisioning-to-consider"></a><span data-ttu-id="b13e3-120">關於佈建要考慮的一般問題領域</span><span class="sxs-lookup"><span data-stu-id="b13e3-120">General problem areas with provisioning to consider</span></span>

<span data-ttu-id="b13e3-121">如果您已知道要從何處著手，則以下是您可以向下切入的一般問題領域清單。</span><span class="sxs-lookup"><span data-stu-id="b13e3-121">Below is a list of the general problem areas that you can drill into if you have an idea of where to start.</span></span>

* [<span data-ttu-id="b13e3-122">佈建服務似乎未啟動</span><span class="sxs-lookup"><span data-stu-id="b13e3-122">Provisioning service does not appear to start</span></span>](#provisioning-service-does-not-appear-to-start)
* [<span data-ttu-id="b13e3-123">無法儲存設定，因為應用程式認證無法運作</span><span class="sxs-lookup"><span data-stu-id="b13e3-123">Can’t save configuration due to app credentials not working</span></span>](#can’t-save-configuration-due-to-app-credentials-not-working)
* [<span data-ttu-id="b13e3-124">稽核記錄表示「已略過」且未佈建使用者，即使已指派它們</span><span class="sxs-lookup"><span data-stu-id="b13e3-124">Audit logs say users are “skipped” and not provisioned, even though they are assigned</span></span>](#audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned)

## <a name="provisioning-service-does-not-appear-to-start"></a><span data-ttu-id="b13e3-125">佈建服務似乎未啟動</span><span class="sxs-lookup"><span data-stu-id="b13e3-125">Provisioning service does not appear to start</span></span>

<span data-ttu-id="b13e3-126">如果您在 Azure 入口網站的 [Azure Active Directory]&gt;[企業應用程式]&gt;[\[應用程式名稱\]]&gt;[佈建] 區段中，將 [佈建狀態] 設為 [啟用]。</span><span class="sxs-lookup"><span data-stu-id="b13e3-126">If you set the **Provisioning Status** to be **On** in the **Azure Active Directory &gt; Enterprise Apps &gt; \[Application Name\] &gt;Provisioning** section of the Azure portal.</span></span> <span data-ttu-id="b13e3-127">不過，在後續重新載入之後，該頁面上並未顯示任何其他狀態詳細資料。</span><span class="sxs-lookup"><span data-stu-id="b13e3-127">However no other status details are shown on that page after subsequent reloads.</span></span> <span data-ttu-id="b13e3-128">很可能是服務正在執行，但尚未完成初始同步處理。</span><span class="sxs-lookup"><span data-stu-id="b13e3-128">It is likely that the service is running but has not completed an initial synchronization yet.</span></span> <span data-ttu-id="b13e3-129">請檢查上述的**稽核記錄**，以判斷服務正在執行哪些作業，以及是否發生任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="b13e3-129">Check the **Audit logs** described above to determine what operations the service is performing, and if there are any errors.</span></span>

>[!NOTE]
><span data-ttu-id="b13e3-130">根據 Azure AD 目錄大小和佈建範圍中的使用者數目而定，初始同步處理可能會花費 20 分鐘到數小時。</span><span class="sxs-lookup"><span data-stu-id="b13e3-130">An initial sync can take anywhere from 20 minutes to several hours, depending on the size of the Azure AD directory and the number of users in scope for provisioning.</span></span> <span data-ttu-id="b13e3-131">初始同步處理之後的後續同步處理會更快，因為佈建服務會儲存浮水印，代表兩個系統在初始同步處理之後的狀態，所以會改善後續同步處理的效能。</span><span class="sxs-lookup"><span data-stu-id="b13e3-131">Subsequent syncs after the initial sync be faster, as the provisioning service stores watermarks that represent the state of both systems after the initial sync, improving performance of subsequent syncs.</span></span>
>
>

## <a name="cant-save-configuration-due-to-app-credentials-not-working"></a><span data-ttu-id="b13e3-132">無法儲存設定，因為應用程式認證無法運作</span><span class="sxs-lookup"><span data-stu-id="b13e3-132">Can’t save configuration due to app credentials not working</span></span>

<span data-ttu-id="b13e3-133">為了讓佈建能夠運作，Azure AD 需要有效的認證，讓它能夠連接到該應用程式所提供的使用者管理 API。</span><span class="sxs-lookup"><span data-stu-id="b13e3-133">In order for provisioning to work, Azure AD requires valid credentials that allow it to connect to a user management API provided by that app.</span></span> <span data-ttu-id="b13e3-134">如果這些認證無效，或您不了解它們，請檢閱設定此應用程式的教學課程，如先前所述。</span><span class="sxs-lookup"><span data-stu-id="b13e3-134">If these credentials do not work, or you don’t know wat they are, review the tutorial for setting up this app, described previously.</span></span>

## <a name="audit-logs-say-users-are-skipped-and-not-provisioned-even-though-they-are-assigned"></a><span data-ttu-id="b13e3-135">稽核記錄表示「已略過」且未佈建使用者，即使已指派它們</span><span class="sxs-lookup"><span data-stu-id="b13e3-135">Audit logs say users are skipped and not provisioned even though they are assigned</span></span>

<span data-ttu-id="b13e3-136">當使用者在稽核記錄中顯示為「已略過」時，請務必讀取記錄訊息中延伸的詳細資料來判斷原因。</span><span class="sxs-lookup"><span data-stu-id="b13e3-136">When a user shows up as “skipped” in the audit logs, it is very important to read the extended details in the log message to determine the reason.</span></span> <span data-ttu-id="b13e3-137">下面是常見原因和解決方式：</span><span class="sxs-lookup"><span data-stu-id="b13e3-137">Below are common reasons and resolutions:</span></span>

-   <span data-ttu-id="b13e3-138">**已設定範圍設定篩選****，這會根據屬性值篩選出使用者**。</span><span class="sxs-lookup"><span data-stu-id="b13e3-138">**A scoping filter has been configured** **that is filtering the user out based on an attribute value**.</span></span> <span data-ttu-id="b13e3-139">如需範圍設定篩選的詳細資訊，請參閱 <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>。</span><span class="sxs-lookup"><span data-stu-id="b13e3-139">For more information on scoping filters, see <https://docs.microsoft.com/azure/active-directory/active-directory-saas-scoping-filters>.</span></span>

-   <span data-ttu-id="b13e3-140">**使用者「不具有效權限」。**</span><span class="sxs-lookup"><span data-stu-id="b13e3-140">**The user is “not effectively entitled”.**</span></span> <span data-ttu-id="b13e3-141">如果您看到此特定錯誤訊息，這是因為儲存在 Azure AD 中的使用者指派記錄發生問題。</span><span class="sxs-lookup"><span data-stu-id="b13e3-141">If you see this specific error message, it is because there is a problem with the user assignment record stored in Azure AD.</span></span> <span data-ttu-id="b13e3-142">若要修正此問題，請從應用程式解除指派使用者 (或群組)，然後重新指派一次。</span><span class="sxs-lookup"><span data-stu-id="b13e3-142">To fix this issue, un-assign the user (or group) from the app, and re-assign it again.</span></span> <span data-ttu-id="b13e3-143">如需指派的詳細資訊，請參閱 <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>。</span><span class="sxs-lookup"><span data-stu-id="b13e3-143">For more information on assignment, see <https://docs.microsoft.com/azure/active-directory/active-directory-coreapps-assign-user-azure-portal>.</span></span>

-   <span data-ttu-id="b13e3-144">**必要屬性已遺失或未針對使用者填入。**</span><span class="sxs-lookup"><span data-stu-id="b13e3-144">**A required attribute is missing or not populated for a user.**</span></span> <span data-ttu-id="b13e3-145">設定佈建時必須考量的重點是，檢視和設定屬性 (Attribute) 對應，以及定義哪些使用者 (或群組) 屬性 (Property) 會從 Azure AD 流向應用程式的工作流程。</span><span class="sxs-lookup"><span data-stu-id="b13e3-145">An important thing to consider when setting up provisioning be to review and configure the attribute mappings and workflows that define which user (or group) properties flow from Azure AD to the application.</span></span> <span data-ttu-id="b13e3-146">這包括設定「比對屬性」，此屬性可用於唯一識別並比對兩個系統之間的使用者/群組。</span><span class="sxs-lookup"><span data-stu-id="b13e3-146">This includes setting the “matching property” that be used to uniquely identify and match users/groups between the two systems.</span></span> <span data-ttu-id="b13e3-147">如需這個重要程序的詳細資訊，請參閱 <https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings>。</span><span class="sxs-lookup"><span data-stu-id="b13e3-147">For more information on this important process, see <https://docs.microsoft.com/azure/active-directory/active-directory-saas-customizing-attribute-mappings>.</span></span>

   * <span data-ttu-id="b13e3-148">**群組的屬性對應：**除了成員，還有群組名稱和群組詳細資訊的佈建 (如果某些應用程式有支援)。</span><span class="sxs-lookup"><span data-stu-id="b13e3-148">**Attribute mappings for groups:** Provisioning of the group name and group details, in addition to the members, if supported for some applications.</span></span> <span data-ttu-id="b13e3-149">您可以對 [佈建] 索引標籤中顯示的群組物件啟用或停用 [對應]，以啟用或停用此功能。</span><span class="sxs-lookup"><span data-stu-id="b13e3-149">You can enable or disable this functionality by enabling or disabling the **Mapping** for group objects shown in the **Provisioning** tab.</span></span> <span data-ttu-id="b13e3-150">如果已啟用佈建群組，請務必檢閱屬性對應，以確保「比對識別碼」使用適當的欄位。</span><span class="sxs-lookup"><span data-stu-id="b13e3-150">If provisioning groups is enabled, be sure to review the attribute mappings to ensure an appropriate field is being used for the “matching ID”.</span></span> <span data-ttu-id="b13e3-151">這可以是顯示名稱或電子郵件別名，因為如果 Azure AD 中某個群組的比對屬性空白或未填入，則不會佈建群組和其成員。</span><span class="sxs-lookup"><span data-stu-id="b13e3-151">This can be the display name or email alias), as the group and its members not be provisioned if the matching property is empty or not populated for a group in Azure AD.</span></span>

#<a name="next-steps"></a><span data-ttu-id="b13e3-152">後續步驟</span><span class="sxs-lookup"><span data-stu-id="b13e3-152">Next steps</span></span>
[<span data-ttu-id="b13e3-153">自動化使用 Azure Active Directory 對於 SaaS 應用程式的使用者佈建和解除佈建</span><span class="sxs-lookup"><span data-stu-id="b13e3-153">Automate User Provisioning and Deprovisioning to SaaS Applications with Azure Active Directory</span></span>](active-directory-saas-app-provisioning.md)
