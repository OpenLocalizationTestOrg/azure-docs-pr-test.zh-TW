---
title: "服務匯流排和 .NET 與 AMQP 1.0 |Microsoft Docs"
description: "搭配使用 .NET 的 Azure 服務匯流排與 AMQP"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 332bcb13-e287-4715-99ee-3d7d97396487
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: e089a7d772b51194d8300beb99797bf40a8611b1
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="using-service-bus-from-net-with-amqp-10"></a><span data-ttu-id="8662c-103">搭配使用 .NET 的服務匯流排與 AMQP 1.0</span><span class="sxs-lookup"><span data-stu-id="8662c-103">Using Service Bus from .NET with AMQP 1.0</span></span>

## <a name="downloading-the-service-bus-sdk"></a><span data-ttu-id="8662c-104">下載服務匯流排 SDK</span><span class="sxs-lookup"><span data-stu-id="8662c-104">Downloading the Service Bus SDK</span></span>

<span data-ttu-id="8662c-105">服務匯流排 SDK 2.1 版或更新版本提供 AMQP 1.0 支援。</span><span class="sxs-lookup"><span data-stu-id="8662c-105">AMQP 1.0 support is available in the Service Bus SDK version 2.1 or later.</span></span> <span data-ttu-id="8662c-106">您可以從 [NuGet][NuGet] 下載「服務匯流排」軟體，以確保您擁有最新版本。</span><span class="sxs-lookup"><span data-stu-id="8662c-106">You can ensure you have the latest version by downloading the Service Bus bits from [NuGet][NuGet].</span></span>

## <a name="configuring-net-applications-to-use-amqp-10"></a><span data-ttu-id="8662c-107">設定 .NET 應用程式以使用 AMQP 1.0</span><span class="sxs-lookup"><span data-stu-id="8662c-107">Configuring .NET applications to use AMQP 1.0</span></span>

<span data-ttu-id="8662c-108">依預設，服務匯流排 .NET 用戶端程式庫能使用專屬的 SOAP 型通訊協定與服務匯流排服務通訊。</span><span class="sxs-lookup"><span data-stu-id="8662c-108">By default, the Service Bus .NET client library communicates with the Service Bus service using a dedicated SOAP-based protocol.</span></span> <span data-ttu-id="8662c-109">若要使用 AMQP 1.0 (而非預設的通訊協定)，您需要明確地設定服務匯流排連接字串，如下節內容所述。</span><span class="sxs-lookup"><span data-stu-id="8662c-109">To use AMQP 1.0 instead of the default protocol requires explicit configuration on the Service Bus connection string, as described in the next section.</span></span> <span data-ttu-id="8662c-110">除了這項變更之外，在使用 AMQP 1.0 時，應用程式程式碼會維持不變。</span><span class="sxs-lookup"><span data-stu-id="8662c-110">Other than this change, application code remains unchanged when using AMQP 1.0.</span></span>

<span data-ttu-id="8662c-111">目前的版本中有幾項在使用 AMQP 時不支援的 API 功能。</span><span class="sxs-lookup"><span data-stu-id="8662c-111">In the current release, there are a few API features that are not supported when using AMQP.</span></span> <span data-ttu-id="8662c-112">這些不支援的功能稍後會在[不支援的功能、限制與行為差異](#unsupported-features-restrictions-and-behavioral-differences)一節中列示。</span><span class="sxs-lookup"><span data-stu-id="8662c-112">These unsupported features are listed later in the section [Unsupported features, restrictions, and behavioral differences](#unsupported-features-restrictions-and-behavioral-differences).</span></span> <span data-ttu-id="8662c-113">在使用 AMQP 時，某些進階組態設定亦有不同的意義。</span><span class="sxs-lookup"><span data-stu-id="8662c-113">Some of the advanced configuration settings also have a different meaning when using AMQP.</span></span>

### <a name="configuration-using-appconfig"></a><span data-ttu-id="8662c-114">使用 App.config 進行設定</span><span class="sxs-lookup"><span data-stu-id="8662c-114">Configuration using App.config</span></span>

<span data-ttu-id="8662c-115">讓應用程式使用 App.config 組態檔案來儲存設定是不錯的作法。</span><span class="sxs-lookup"><span data-stu-id="8662c-115">It is good practice for applications to use the App.config configuration file to store settings.</span></span> <span data-ttu-id="8662c-116">對於服務匯流排應用程式，您可以使用 App.config 來儲存服務匯流排連接字串。</span><span class="sxs-lookup"><span data-stu-id="8662c-116">For Service Bus applications, you can use App.config to store the Service Bus connection string.</span></span> <span data-ttu-id="8662c-117">範例 App.config 檔案如下所示：</span><span class="sxs-lookup"><span data-stu-id="8662c-117">An example App.config file is as follows:</span></span>

```xml
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <appSettings>
        <add key="Microsoft.ServiceBus.ConnectionString"
             value="Endpoint=sb://[namespace].servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=[SAS key];TransportType=Amqp" />
    </appSettings>
</configuration>
```

<span data-ttu-id="8662c-118">`Microsoft.ServiceBus.ConnectionString` 設定的值是用來設定服務匯流排連線的服務匯流排連接字串。</span><span class="sxs-lookup"><span data-stu-id="8662c-118">The value of the `Microsoft.ServiceBus.ConnectionString` setting is the Service Bus connection string that is used to configure the connection to Service Bus.</span></span> <span data-ttu-id="8662c-119">其格式如下所示：</span><span class="sxs-lookup"><span data-stu-id="8662c-119">The format is as follows:</span></span>

`Endpoint=sb://[namespace].servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=[SAS key];TransportType=Amqp`

<span data-ttu-id="8662c-120">其中 `[namespace]` 和 `SharedAccessKey` 是當您建立服務匯流排命名空間時，取自 [Azure 入口網站][Azure portal]。</span><span class="sxs-lookup"><span data-stu-id="8662c-120">Where `[namespace]` and `SharedAccessKey` are obtained from the [Azure portal][Azure portal] when you create a Service Bus namespace.</span></span> <span data-ttu-id="8662c-121">如需詳細資訊，請參閱[使用 Azure 入口網站建立服務匯流排命名空間][Create a Service Bus namespace using the Azure portal]。</span><span class="sxs-lookup"><span data-stu-id="8662c-121">For more information, see [Create a Service Bus namespace using the Azure portal][Create a Service Bus namespace using the Azure portal].</span></span>

<span data-ttu-id="8662c-122">使用 AMQP 時，在連接字串中附加 `;TransportType=Amqp`。</span><span class="sxs-lookup"><span data-stu-id="8662c-122">When using AMQP, append the connection string with `;TransportType=Amqp`.</span></span> <span data-ttu-id="8662c-123">此標記法會指示用戶端程式庫使用 AMQP 1.0 來連線到「服務匯流排」。</span><span class="sxs-lookup"><span data-stu-id="8662c-123">This notation instructs the client library to make its connection to Service Bus using AMQP 1.0.</span></span>

## <a name="message-serialization"></a><span data-ttu-id="8662c-124">訊息序列化</span><span class="sxs-lookup"><span data-stu-id="8662c-124">Message serialization</span></span>

<span data-ttu-id="8662c-125">使用預設通訊協定時，.NET 用戶端程式庫的預設序列化行為是使用 [DataContractSerializer][DataContractSerializer] 類型將 [BrokeredMessage][BrokeredMessage] 執行個體序列化，以用於用戶端程式庫與「服務匯流排服務」之間的傳輸。</span><span class="sxs-lookup"><span data-stu-id="8662c-125">When using the default protocol, the default serialization behavior of the .NET client library is to use the [DataContractSerializer][DataContractSerializer] type to serialize a [BrokeredMessage][BrokeredMessage] instance for transport between the client library and the Service Bus service.</span></span> <span data-ttu-id="8662c-126">使用 AMQP 傳輸模式時，用戶端程式庫會使用 AMQP 類型系統，將[代理訊息][BrokeredMessage]序列化為 AMQP 訊息。</span><span class="sxs-lookup"><span data-stu-id="8662c-126">When using the AMQP transport mode, the client library uses the AMQP type system for serialization of the [brokered message][BrokeredMessage] into an AMQP message.</span></span> <span data-ttu-id="8662c-127">此序列化作業讓可能在不同平台上執行的接收應用程式 (例如使用 JMS API 來存取服務匯流排的 Java 應用程式) 能夠接收和解譯此訊息。</span><span class="sxs-lookup"><span data-stu-id="8662c-127">This serialization enables the message to be received and interpreted by a receiving application that is potentially running on a different platform, for example, a Java application that uses the JMS API to access Service Bus.</span></span>

<span data-ttu-id="8662c-128">當您建構 [BrokeredMessage][BrokeredMessage] 執行個體時，您可以提供 .NET 物件作為建構函式的參數，進而做為訊息的本文。</span><span class="sxs-lookup"><span data-stu-id="8662c-128">When you construct a [BrokeredMessage][BrokeredMessage] instance, you can provide a .NET object as a parameter to the constructor to serve as the body of the message.</span></span> <span data-ttu-id="8662c-129">如果是可以對應至 AMQP 基本類型的物件，本文會序列化為 AMQP 資料類型。</span><span class="sxs-lookup"><span data-stu-id="8662c-129">For objects that can be mapped to AMQP primitive types, the body is serialized into AMQP data types.</span></span> <span data-ttu-id="8662c-130">如果物件不能直接對應至 AMQP 基本類型 (也就是，應用程式所定義的自訂類型)，就會使用 [DataContractSerializer][DataContractSerializer] 將物件序列化，然後在 AMQP 資料訊息中傳送序列化的位元組。</span><span class="sxs-lookup"><span data-stu-id="8662c-130">If the object cannot be directly mapped into an AMQP primitive type; that is, a custom type defined by the application, then the object is serialized using the [DataContractSerializer][DataContractSerializer], and the serialized bytes are sent in an AMQP data message.</span></span>

<span data-ttu-id="8662c-131">若要促進與非 .NET 用戶端的互通性，在訊息本文中僅使用可直接序列化為 AMQP 類型的 .NET 類型。</span><span class="sxs-lookup"><span data-stu-id="8662c-131">To facilitate interoperability with non-.NET clients, use only .NET types that can be serialized directly into AMQP types for the body of the message.</span></span> <span data-ttu-id="8662c-132">下表詳細說明這些類型及對應的 AMQP 類型系統。</span><span class="sxs-lookup"><span data-stu-id="8662c-132">The following table details those types and the corresponding mapping to the AMQP type system.</span></span>

| <span data-ttu-id="8662c-133">.NET 主體物件類型</span><span class="sxs-lookup"><span data-stu-id="8662c-133">.NET Body Object Type</span></span> | <span data-ttu-id="8662c-134">對應的 AMQP 類型</span><span class="sxs-lookup"><span data-stu-id="8662c-134">Mapped AMQP Type</span></span> | <span data-ttu-id="8662c-135">AMQP 主體區段類型</span><span class="sxs-lookup"><span data-stu-id="8662c-135">AMQP Body Section Type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8662c-136">布林</span><span class="sxs-lookup"><span data-stu-id="8662c-136">bool</span></span> |<span data-ttu-id="8662c-137">布林值</span><span class="sxs-lookup"><span data-stu-id="8662c-137">boolean</span></span> |<span data-ttu-id="8662c-138">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-138">AMQP Value</span></span> |
| <span data-ttu-id="8662c-139">byte</span><span class="sxs-lookup"><span data-stu-id="8662c-139">byte</span></span> |<span data-ttu-id="8662c-140">ubyte</span><span class="sxs-lookup"><span data-stu-id="8662c-140">ubyte</span></span> |<span data-ttu-id="8662c-141">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-141">AMQP Value</span></span> |
| <span data-ttu-id="8662c-142">ushort</span><span class="sxs-lookup"><span data-stu-id="8662c-142">ushort</span></span> |<span data-ttu-id="8662c-143">ushort</span><span class="sxs-lookup"><span data-stu-id="8662c-143">ushort</span></span> |<span data-ttu-id="8662c-144">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-144">AMQP Value</span></span> |
| <span data-ttu-id="8662c-145">uint</span><span class="sxs-lookup"><span data-stu-id="8662c-145">uint</span></span> |<span data-ttu-id="8662c-146">uint</span><span class="sxs-lookup"><span data-stu-id="8662c-146">uint</span></span> |<span data-ttu-id="8662c-147">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-147">AMQP Value</span></span> |
| <span data-ttu-id="8662c-148">ulong</span><span class="sxs-lookup"><span data-stu-id="8662c-148">ulong</span></span> |<span data-ttu-id="8662c-149">ulong</span><span class="sxs-lookup"><span data-stu-id="8662c-149">ulong</span></span> |<span data-ttu-id="8662c-150">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-150">AMQP Value</span></span> |
| <span data-ttu-id="8662c-151">sbyte</span><span class="sxs-lookup"><span data-stu-id="8662c-151">sbyte</span></span> |<span data-ttu-id="8662c-152">byte</span><span class="sxs-lookup"><span data-stu-id="8662c-152">byte</span></span> |<span data-ttu-id="8662c-153">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-153">AMQP Value</span></span> |
| <span data-ttu-id="8662c-154">short</span><span class="sxs-lookup"><span data-stu-id="8662c-154">short</span></span> |<span data-ttu-id="8662c-155">short</span><span class="sxs-lookup"><span data-stu-id="8662c-155">short</span></span> |<span data-ttu-id="8662c-156">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-156">AMQP Value</span></span> |
| <span data-ttu-id="8662c-157">int</span><span class="sxs-lookup"><span data-stu-id="8662c-157">int</span></span> |<span data-ttu-id="8662c-158">int</span><span class="sxs-lookup"><span data-stu-id="8662c-158">int</span></span> |<span data-ttu-id="8662c-159">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-159">AMQP Value</span></span> |
| <span data-ttu-id="8662c-160">long</span><span class="sxs-lookup"><span data-stu-id="8662c-160">long</span></span> |<span data-ttu-id="8662c-161">long</span><span class="sxs-lookup"><span data-stu-id="8662c-161">long</span></span> |<span data-ttu-id="8662c-162">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-162">AMQP Value</span></span> |
| <span data-ttu-id="8662c-163">float</span><span class="sxs-lookup"><span data-stu-id="8662c-163">float</span></span> |<span data-ttu-id="8662c-164">float</span><span class="sxs-lookup"><span data-stu-id="8662c-164">float</span></span> |<span data-ttu-id="8662c-165">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-165">AMQP Value</span></span> |
| <span data-ttu-id="8662c-166">double</span><span class="sxs-lookup"><span data-stu-id="8662c-166">double</span></span> |<span data-ttu-id="8662c-167">double</span><span class="sxs-lookup"><span data-stu-id="8662c-167">double</span></span> |<span data-ttu-id="8662c-168">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-168">AMQP Value</span></span> |
| <span data-ttu-id="8662c-169">decimal</span><span class="sxs-lookup"><span data-stu-id="8662c-169">decimal</span></span> |<span data-ttu-id="8662c-170">decimal128</span><span class="sxs-lookup"><span data-stu-id="8662c-170">decimal128</span></span> |<span data-ttu-id="8662c-171">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-171">AMQP Value</span></span> |
| <span data-ttu-id="8662c-172">char</span><span class="sxs-lookup"><span data-stu-id="8662c-172">char</span></span> |<span data-ttu-id="8662c-173">char</span><span class="sxs-lookup"><span data-stu-id="8662c-173">char</span></span> |<span data-ttu-id="8662c-174">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-174">AMQP Value</span></span> |
| <span data-ttu-id="8662c-175">DateTime</span><span class="sxs-lookup"><span data-stu-id="8662c-175">DateTime</span></span> |<span data-ttu-id="8662c-176">timestamp</span><span class="sxs-lookup"><span data-stu-id="8662c-176">timestamp</span></span> |<span data-ttu-id="8662c-177">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-177">AMQP Value</span></span> |
| <span data-ttu-id="8662c-178">Guid</span><span class="sxs-lookup"><span data-stu-id="8662c-178">Guid</span></span> |<span data-ttu-id="8662c-179">uuid</span><span class="sxs-lookup"><span data-stu-id="8662c-179">uuid</span></span> |<span data-ttu-id="8662c-180">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-180">AMQP Value</span></span> |
| <span data-ttu-id="8662c-181">byte[]</span><span class="sxs-lookup"><span data-stu-id="8662c-181">byte[]</span></span> |<span data-ttu-id="8662c-182">binary</span><span class="sxs-lookup"><span data-stu-id="8662c-182">binary</span></span> |<span data-ttu-id="8662c-183">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-183">AMQP Value</span></span> |
| <span data-ttu-id="8662c-184">string</span><span class="sxs-lookup"><span data-stu-id="8662c-184">string</span></span> |<span data-ttu-id="8662c-185">string</span><span class="sxs-lookup"><span data-stu-id="8662c-185">string</span></span> |<span data-ttu-id="8662c-186">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-186">AMQP Value</span></span> |
| <span data-ttu-id="8662c-187">System.Collections.IList</span><span class="sxs-lookup"><span data-stu-id="8662c-187">System.Collections.IList</span></span> |<span data-ttu-id="8662c-188">list</span><span class="sxs-lookup"><span data-stu-id="8662c-188">list</span></span> |<span data-ttu-id="8662c-189">AMQP 值︰集合中包含的項目只能是在此表格中定義的項目。</span><span class="sxs-lookup"><span data-stu-id="8662c-189">AMQP Value: items contained in the collection can only be those that are defined in this table.</span></span> |
| <span data-ttu-id="8662c-190">System.Array</span><span class="sxs-lookup"><span data-stu-id="8662c-190">System.Array</span></span> |<span data-ttu-id="8662c-191">array</span><span class="sxs-lookup"><span data-stu-id="8662c-191">array</span></span> |<span data-ttu-id="8662c-192">AMQP 值︰集合中包含的項目只能是在此表格中定義的項目。</span><span class="sxs-lookup"><span data-stu-id="8662c-192">AMQP Value: items contained in the collection can only be those that are defined in this table.</span></span> |
| <span data-ttu-id="8662c-193">System.Collections.IDictionary</span><span class="sxs-lookup"><span data-stu-id="8662c-193">System.Collections.IDictionary</span></span> |<span data-ttu-id="8662c-194">map</span><span class="sxs-lookup"><span data-stu-id="8662c-194">map</span></span> |<span data-ttu-id="8662c-195">AMQP 值︰集合中包含的項目只能是在此表格中定義的項目。注意︰僅支援 String 索引鍵。</span><span class="sxs-lookup"><span data-stu-id="8662c-195">AMQP Value: items contained in the collection can only be those that are defined in this table.Note: only String keys are supported.</span></span> |
| <span data-ttu-id="8662c-196">Uri</span><span class="sxs-lookup"><span data-stu-id="8662c-196">Uri</span></span> |<span data-ttu-id="8662c-197">描述的 string (請參閱下表)</span><span class="sxs-lookup"><span data-stu-id="8662c-197">Described string(see the following table)</span></span> |<span data-ttu-id="8662c-198">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-198">AMQP Value</span></span> |
| <span data-ttu-id="8662c-199">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="8662c-199">DateTimeOffset</span></span> |<span data-ttu-id="8662c-200">描述的 long (請參閱下表)</span><span class="sxs-lookup"><span data-stu-id="8662c-200">Described long(see the following table)</span></span> |<span data-ttu-id="8662c-201">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-201">AMQP Value</span></span> |
| <span data-ttu-id="8662c-202">TimeSpan</span><span class="sxs-lookup"><span data-stu-id="8662c-202">TimeSpan</span></span> |<span data-ttu-id="8662c-203">描述的 long (請參閱下表)</span><span class="sxs-lookup"><span data-stu-id="8662c-203">Described long(see the following)</span></span> |<span data-ttu-id="8662c-204">AMQP 值</span><span class="sxs-lookup"><span data-stu-id="8662c-204">AMQP Value</span></span> |
| <span data-ttu-id="8662c-205">Stream</span><span class="sxs-lookup"><span data-stu-id="8662c-205">Stream</span></span> |<span data-ttu-id="8662c-206">binary</span><span class="sxs-lookup"><span data-stu-id="8662c-206">binary</span></span> |<span data-ttu-id="8662c-207">AMQP 資料 (可能有多個)。</span><span class="sxs-lookup"><span data-stu-id="8662c-207">AMQP Data (may be multiple).</span></span> <span data-ttu-id="8662c-208">Data 區段包含從 Stream 物件讀取的原始位元組。</span><span class="sxs-lookup"><span data-stu-id="8662c-208">The Data sections contain the raw bytes read from the Stream object.</span></span> |
| <span data-ttu-id="8662c-209">其他物件</span><span class="sxs-lookup"><span data-stu-id="8662c-209">Other Object</span></span> |<span data-ttu-id="8662c-210">binary</span><span class="sxs-lookup"><span data-stu-id="8662c-210">binary</span></span> |<span data-ttu-id="8662c-211">AMQP 資料 (可能有多個)。</span><span class="sxs-lookup"><span data-stu-id="8662c-211">AMQP Data (may be multiple).</span></span> <span data-ttu-id="8662c-212">包含使用 DataContractSerializer 或應用程式所提供序列化程式之物件的序列化二進位資料。</span><span class="sxs-lookup"><span data-stu-id="8662c-212">Contains the serialized binary of the object that uses the DataContractSerializer or a serializer supplied by the application.</span></span> |

| <span data-ttu-id="8662c-213">.NET 類型</span><span class="sxs-lookup"><span data-stu-id="8662c-213">.NET Type</span></span> | <span data-ttu-id="8662c-214">對應的 AMQP 描述類型</span><span class="sxs-lookup"><span data-stu-id="8662c-214">Mapped AMQP Described Type</span></span> | <span data-ttu-id="8662c-215">注意事項</span><span class="sxs-lookup"><span data-stu-id="8662c-215">Notes</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8662c-216">Uri</span><span class="sxs-lookup"><span data-stu-id="8662c-216">Uri</span></span> |`<type name=”uri” class=restricted source=”string”> <descriptor name=”com.microsoft:uri” /></type>` |<span data-ttu-id="8662c-217">Uri.AbsoluteUri</span><span class="sxs-lookup"><span data-stu-id="8662c-217">Uri.AbsoluteUri</span></span> |
| <span data-ttu-id="8662c-218">Datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="8662c-218">DateTimeOffset</span></span> |`<type name=”datetime-offset” class=restricted source=”long”> <descriptor name=”com.microsoft:datetime-offset” /></type>` |<span data-ttu-id="8662c-219">DateTimeOffset.UtcTicks</span><span class="sxs-lookup"><span data-stu-id="8662c-219">DateTimeOffset.UtcTicks</span></span> |
| <span data-ttu-id="8662c-220">TimeSpan</span><span class="sxs-lookup"><span data-stu-id="8662c-220">TimeSpan</span></span> |`<type name=”timespan” class=restricted source=”long”> <descriptor name=”com.microsoft:timespan” /></type> ` |<span data-ttu-id="8662c-221">TimeSpan.Ticks</span><span class="sxs-lookup"><span data-stu-id="8662c-221">TimeSpan.Ticks</span></span> |

## <a name="unsupported-features-restrictions-and-behavioral-differences"></a><span data-ttu-id="8662c-222">不支援的功能、限制和行為差異</span><span class="sxs-lookup"><span data-stu-id="8662c-222">Unsupported features, restrictions, and behavioral differences</span></span>

<span data-ttu-id="8662c-223">使用 AMQP 時，目前不支援服務匯流排 .NET API 的以下功能：</span><span class="sxs-lookup"><span data-stu-id="8662c-223">The following features of the Service Bus .NET API are not currently supported when using AMQP:</span></span>

* <span data-ttu-id="8662c-224">交易</span><span class="sxs-lookup"><span data-stu-id="8662c-224">Transactions</span></span>
* <span data-ttu-id="8662c-225">透過傳輸目的地傳送</span><span class="sxs-lookup"><span data-stu-id="8662c-225">Send via transfer destination</span></span>

<span data-ttu-id="8662c-226">相較於預設通訊協定，使用 AMQP 時，服務匯流排 .NET API 也有一些細微的行為差異：</span><span class="sxs-lookup"><span data-stu-id="8662c-226">There are also some small differences in the behavior of the Service Bus .NET API when using AMQP, compared to the default protocol:</span></span>

* <span data-ttu-id="8662c-227">[OperationTimeout][OperationTimeout] 屬性會被忽略。</span><span class="sxs-lookup"><span data-stu-id="8662c-227">The [OperationTimeout][OperationTimeout] property is ignored.</span></span>
* <span data-ttu-id="8662c-228">`MessageReceiver.Receive(TimeSpan.Zero)` 會實作為 `MessageReceiver.Receive(TimeSpan.FromSeconds(10))`。</span><span class="sxs-lookup"><span data-stu-id="8662c-228">`MessageReceiver.Receive(TimeSpan.Zero)` is implemented as `MessageReceiver.Receive(TimeSpan.FromSeconds(10))`.</span></span>
* <span data-ttu-id="8662c-229">只有最初收到訊息的訊息接收者能夠以鎖定權杖完成訊息。</span><span class="sxs-lookup"><span data-stu-id="8662c-229">Completing messages by lock tokens can only be done by the message receivers that initially received the messages.</span></span>

## <a name="controlling-amqp-protocol-settings"></a><span data-ttu-id="8662c-230">控制 AMQP 通訊協定設定</span><span class="sxs-lookup"><span data-stu-id="8662c-230">Controlling AMQP protocol settings</span></span>

<span data-ttu-id="8662c-231">[.NET API](/dotnet/api/) 會公開數個可控制 AMQP 通訊協定行為的設定：</span><span class="sxs-lookup"><span data-stu-id="8662c-231">The [.NET APIs](/dotnet/api/) expose several settings to control the behavior of the AMQP protocol:</span></span>

* <span data-ttu-id="8662c-232">**[MessageReceiver.PrefetchCount](/dotnet/api/microsoft.servicebus.messaging.messagereceiver.prefetchcount?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_MessageReceiver_PrefetchCount)**：控制套用至連結的初始信用額度。</span><span class="sxs-lookup"><span data-stu-id="8662c-232">**[MessageReceiver.PrefetchCount](/dotnet/api/microsoft.servicebus.messaging.messagereceiver.prefetchcount?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_MessageReceiver_PrefetchCount)**: Controls the initial credit applied to a link.</span></span> <span data-ttu-id="8662c-233">預設值為 0。</span><span class="sxs-lookup"><span data-stu-id="8662c-233">The default is 0.</span></span>
* <span data-ttu-id="8662c-234">**[MessagingFactorySettings.AmqpTransportSettings.MaxFrameSize](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.maxframesize?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_MaxFrameSize)**︰控制在連線開啟時間進行交涉時所提供的 AMQP 框架大小上限。</span><span class="sxs-lookup"><span data-stu-id="8662c-234">**[MessagingFactorySettings.AmqpTransportSettings.MaxFrameSize](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.maxframesize?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_MaxFrameSize)**: Controls the maximum AMQP frame size offered during the negotiation at connection open time.</span></span> <span data-ttu-id="8662c-235">預設值為 65,536 個位元組。</span><span class="sxs-lookup"><span data-stu-id="8662c-235">The default is 65,536 bytes.</span></span>
* <span data-ttu-id="8662c-236">**[MessagingFactorySettings.AmqpTransportSettings.BatchFlushInterval](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.batchflushinterval?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_BatchFlushInterval)**︰如果傳輸可分批進行，這個值會決定用於傳送配置的延遲上限。</span><span class="sxs-lookup"><span data-stu-id="8662c-236">**[MessagingFactorySettings.AmqpTransportSettings.BatchFlushInterval](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.batchflushinterval?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_BatchFlushInterval)**: If transfers are batchable, this value determines the maximum delay for sending dispositions.</span></span> <span data-ttu-id="8662c-237">預設由傳送者/接收者繼承。</span><span class="sxs-lookup"><span data-stu-id="8662c-237">Inherited by senders/receivers by default.</span></span> <span data-ttu-id="8662c-238">個別的傳送者/接收者可以覆寫預設值 (20 毫秒)。</span><span class="sxs-lookup"><span data-stu-id="8662c-238">Individual sender/receiver can override the default, which is 20 milliseconds.</span></span>
* <span data-ttu-id="8662c-239">**[MessagingFactorySettings.AmqpTransportSettings.UseSslStreamSecurity](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.usesslstreamsecurity?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_UseSslStreamSecurity)**︰控制是否透過 SSL 連線建立 AMQP 連線。</span><span class="sxs-lookup"><span data-stu-id="8662c-239">**[MessagingFactorySettings.AmqpTransportSettings.UseSslStreamSecurity](/dotnet/api/microsoft.servicebus.messaging.amqp.amqptransportsettings.usesslstreamsecurity?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_Amqp_AmqpTransportSettings_UseSslStreamSecurity)**: Controls whether AMQP connections are established over an SSL connection.</span></span> <span data-ttu-id="8662c-240">預設值為 **true**。</span><span class="sxs-lookup"><span data-stu-id="8662c-240">The default is **true**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8662c-241">後續步驟</span><span class="sxs-lookup"><span data-stu-id="8662c-241">Next steps</span></span>

<span data-ttu-id="8662c-242">準備好進行深入了解嗎？</span><span class="sxs-lookup"><span data-stu-id="8662c-242">Ready to learn more?</span></span> <span data-ttu-id="8662c-243">請造訪下列連結：</span><span class="sxs-lookup"><span data-stu-id="8662c-243">Visit the following links:</span></span>

* <span data-ttu-id="8662c-244">[服務匯流排 AMQP 概觀]</span><span class="sxs-lookup"><span data-stu-id="8662c-244">[Service Bus AMQP overview]</span></span>
* <span data-ttu-id="8662c-245">[適用於服務匯流排分割的佇列和主題的 AMQP 1.0 支援]</span><span class="sxs-lookup"><span data-stu-id="8662c-245">[AMQP 1.0 support for Service Bus partitioned queues and topics]</span></span>
* <span data-ttu-id="8662c-246">[Windows Server 服務匯流排中的 AMQP]</span><span class="sxs-lookup"><span data-stu-id="8662c-246">[AMQP in Service Bus for Windows Server]</span></span>

[Create a Service Bus namespace using the Azure portal]: service-bus-create-namespace-portal.md
[DataContractSerializer]: https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx
[BrokeredMessage]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage?view=azureservicebus-4.0.0
[Microsoft.ServiceBus.Messaging.MessagingFactory.AcceptMessageSession]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory.acceptmessagesession?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_MessagingFactory_AcceptMessageSession
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings.operationtimeout?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[NuGet]: http://nuget.org/packages/WindowsAzure.ServiceBus/
[Azure portal]: https://portal.azure.com
<span data-ttu-id="8662c-247">[服務匯流排 AMQP 概觀]: service-bus-amqp-overview.md</span><span class="sxs-lookup"><span data-stu-id="8662c-247">[Service Bus AMQP overview]: service-bus-amqp-overview.md</span></span>
<span data-ttu-id="8662c-248">[適用於服務匯流排分割的佇列和主題的 AMQP 1.0 支援]: service-bus-partitioned-queues-and-topics-amqp-overview.md</span><span class="sxs-lookup"><span data-stu-id="8662c-248">[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md</span></span>
<span data-ttu-id="8662c-249">[Windows Server 服務匯流排中的 AMQP]: https://msdn.microsoft.com/library/dn574799.aspx</span><span class="sxs-lookup"><span data-stu-id="8662c-249">[AMQP in Service Bus for Windows Server]: https://msdn.microsoft.com/library/dn574799.aspx</span></span>
