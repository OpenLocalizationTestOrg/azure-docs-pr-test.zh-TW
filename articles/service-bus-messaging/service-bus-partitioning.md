---
title: "建立分割的 Azure 服務匯流排佇列和主題 | Microsoft Docs"
description: "說明如何使用多個訊息代理程式分割服務匯流排佇列和主題。"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 5a4e69ea7e13cb017f8fb432c524c6a8ce9228a8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/18/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="4b70e-103">分割的佇列和主題</span><span class="sxs-lookup"><span data-stu-id="4b70e-103">Partitioned queues and topics</span></span>
<span data-ttu-id="4b70e-104">Azure 服務匯流排會採用多個訊息代理人來處理訊息，並採用多個訊息存放區來儲存訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-104">Azure Service Bus employs multiple message brokers to process messages and multiple messaging stores to store messages.</span></span> <span data-ttu-id="4b70e-105">傳統的佇列或主題由單一訊息代理程式處理並儲存在一個訊息存放區中。</span><span class="sxs-lookup"><span data-stu-id="4b70e-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="4b70e-106">服務匯流排「分割區」可讓佇列和主題或「傳訊實體」分割到多個訊息代理程式及訊息存放區。</span><span class="sxs-lookup"><span data-stu-id="4b70e-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, to be partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="4b70e-107">這表示分割實體的整體輸送量不會再受到單一訊息代理程式或訊息存放區的效能所限制。</span><span class="sxs-lookup"><span data-stu-id="4b70e-107">This means that the overall throughput of a partitioned entity is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="4b70e-108">此外，即使訊息存放區暫時中斷也不會讓分割的佇列或主題無法使用。</span><span class="sxs-lookup"><span data-stu-id="4b70e-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="4b70e-109">分割的佇列和主題可以包含所有進階的服務匯流排功能，例如支援交易和工作階段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="4b70e-110">如需服務匯流排內部的資訊，請參閱[服務匯流排架構][Service Bus architecture]一文。</span><span class="sxs-lookup"><span data-stu-id="4b70e-110">For information about Service Bus internals, see the [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="4b70e-111">在標準和進階傳訊中，依預設，在所有佇列和主題上建立實體時會啟用分割。</span><span class="sxs-lookup"><span data-stu-id="4b70e-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="4b70e-112">您可以建立標準傳訊層實體而不要分割，但進階命名空間中的佇列和主題永遠會分割。無法停用此選項。</span><span class="sxs-lookup"><span data-stu-id="4b70e-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="4b70e-113">在標準或進階層中的現有佇列或主題上，無法變更分割選項，您只能在建立實體時設定此選項。</span><span class="sxs-lookup"><span data-stu-id="4b70e-113">It is not possible to change the partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set the option when you create the entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="4b70e-114">運作方式</span><span class="sxs-lookup"><span data-stu-id="4b70e-114">How it works</span></span>

<span data-ttu-id="4b70e-115">每個分割的佇列或主題都包含多個片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="4b70e-116">每個片段儲存在不同的訊息存放區中，並由不同的訊息代理人處理。</span><span class="sxs-lookup"><span data-stu-id="4b70e-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="4b70e-117">當訊息傳送至分割的佇列或主題時，服務匯流排會指派訊息到其中一個片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-117">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="4b70e-118">選取作業由服務匯流排或使用傳送者可指定的分割索引鍵隨機進行。</span><span class="sxs-lookup"><span data-stu-id="4b70e-118">The selection is done randomly by Service Bus or by using a partition key that the sender can specify.</span></span>

<span data-ttu-id="4b70e-119">當用戶端想要從分割的佇列或從分割主題的訂用帳戶接收訊息時，服務匯流排會查詢所有片段的訊息，然後將取自任何訊息存放區的第一個訊息傳回給接收者。</span><span class="sxs-lookup"><span data-stu-id="4b70e-119">When a client wants to receive a message from a partitioned queue, or from a subscription to a partitioned topic, Service Bus queries all fragments for messages, then returns the first message that is obtained from any of the messaging stores to the receiver.</span></span> <span data-ttu-id="4b70e-120">服務匯流排會快取其他訊息，然後在它收到其他接收要求時將其傳回。</span><span class="sxs-lookup"><span data-stu-id="4b70e-120">Service Bus caches the other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="4b70e-121">接收的用戶端並不知道分割。分割佇列或主題的用戶端對向行為 (例如讀取、完成、延遲、無效化、預先擷取) 和一般實體的行為相同。</span><span class="sxs-lookup"><span data-stu-id="4b70e-121">A receiving client is not aware of the partitioning; the client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical to the behavior of a regular entity.</span></span>

<span data-ttu-id="4b70e-122">傳送訊息給分割的佇列或主題，或從該處接收訊息時，不需要額外成本。</span><span class="sxs-lookup"><span data-stu-id="4b70e-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="4b70e-123">啟用分割</span><span class="sxs-lookup"><span data-stu-id="4b70e-123">Enable partitioning</span></span>

<span data-ttu-id="4b70e-124">若要搭配 Azure 服務匯流排使用分割的佇列和主題，請使用 Azure SDK 2.2 版或更新版本，或在您的 HTTP 要求中指定 `api-version=2013-10`。</span><span class="sxs-lookup"><span data-stu-id="4b70e-124">To use partitioned queues and topics with Azure Service Bus, use the Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="4b70e-125">標準</span><span class="sxs-lookup"><span data-stu-id="4b70e-125">Standard</span></span>

<span data-ttu-id="4b70e-126">在標準傳訊層中，您可以建立 1、2、3、4 或 5 GB 大小的服務匯流排佇列和主題 (預設值為 1 GB)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-126">In the Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="4b70e-127">啟用分割時，服務匯流排會為您指定的每 GB 建立 16 個複本 (16 個資料分割)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of the entity for each GB you specify.</span></span> <span data-ttu-id="4b70e-128">因此，如果您建立 5 GB 大小的佇列，每 GB 有 16 個資料分割，則佇列大小上限會變成 (5 \* 16) = 80 GB。</span><span class="sxs-lookup"><span data-stu-id="4b70e-128">As such, if you create a queue that's 5 GB in size, with 16 partitions the maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="4b70e-129">如果要查看分割佇列或主題的大小上限，您可以在 [Azure 入口網站][Azure portal]上，在該實體的 [概觀] 刀鋒視窗中檢視其項目。</span><span class="sxs-lookup"><span data-stu-id="4b70e-129">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="4b70e-130">進階</span><span class="sxs-lookup"><span data-stu-id="4b70e-130">Premium</span></span>

<span data-ttu-id="4b70e-131">在進階層命名空間中，您可以建立 1、2、3、4、5、10、20、40 或 80 GB 大小的服務匯流排佇列和主題 (預設值為 1 GB)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="4b70e-132">由於依預設會啟用分割，服務匯流排會為每個實體建立兩個資料分割。</span><span class="sxs-lookup"><span data-stu-id="4b70e-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="4b70e-133">如果要查看分割佇列或主題的大小上限，您可以在 [Azure 入口網站][Azure portal]上，在該實體的 [概觀] 刀鋒視窗中檢視其項目。</span><span class="sxs-lookup"><span data-stu-id="4b70e-133">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

<span data-ttu-id="4b70e-134">如需有關進階傳訊層中之分割的詳細資訊，請參閱[服務匯流排進階和標準傳訊層級](service-bus-premium-messaging.md)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-134">For more information about partitioning in the Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="4b70e-135">建立分割實體</span><span class="sxs-lookup"><span data-stu-id="4b70e-135">Create a partitioned entity</span></span>

<span data-ttu-id="4b70e-136">有多種方式可以建立分割的佇列或主題。</span><span class="sxs-lookup"><span data-stu-id="4b70e-136">There are several ways to create a partitioned queue or topic.</span></span> <span data-ttu-id="4b70e-137">當您從應用程式建立佇列或主題時，您可以分別將 [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] 或 [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] 屬性設為 **true** 來啟用佇列或主題的分割。</span><span class="sxs-lookup"><span data-stu-id="4b70e-137">When you create the queue or topic from your application, you can enable partitioning for the queue or topic by respectively setting the [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property to **true**.</span></span> <span data-ttu-id="4b70e-138">這些屬性必須在建立佇列或主題時設定。</span><span class="sxs-lookup"><span data-stu-id="4b70e-138">These properties must be set at the time the queue or topic is created.</span></span> <span data-ttu-id="4b70e-139">如先前所述，在現有的佇列或主題上無法變更這些屬性。</span><span class="sxs-lookup"><span data-stu-id="4b70e-139">As stated previously, it is not possible to change these properties on an existing queue or topic.</span></span> <span data-ttu-id="4b70e-140">例如：</span><span class="sxs-lookup"><span data-stu-id="4b70e-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="4b70e-141">或者，您可以在 [Azure 入口網站][Azure portal]或 Visual Studio 中建立分割的佇列或主題。</span><span class="sxs-lookup"><span data-stu-id="4b70e-141">Alternatively, you can create a partitioned queue or topic in the [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="4b70e-142">當您在入口網站建立佇列或主題時，依預設會勾選佇列或主題 [建立] 刀鋒視窗中的 [啟用分割] 選項。</span><span class="sxs-lookup"><span data-stu-id="4b70e-142">When you create a queue or topic in the portal, the **Enable partitioning** option in the queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="4b70e-143">您只能在標準層實體中停用此選項，在進階層中，永遠會啟用分割。</span><span class="sxs-lookup"><span data-stu-id="4b70e-143">You can only disable this option in a Standard tier entity; in the Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="4b70e-144">在 Visual Studio 中，按一下 [新增佇列] 或 [新增主題] 對話方塊中的 [啟用分割] 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="4b70e-144">In Visual Studio, click the **Enable Partitioning** checkbox in the **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="4b70e-145">分割索引鍵的用途</span><span class="sxs-lookup"><span data-stu-id="4b70e-145">Use of partition keys</span></span>
<span data-ttu-id="4b70e-146">當訊息加入佇列至分割的佇列或主題時，服務匯流排會檢查分割區索引鍵是否存在。</span><span class="sxs-lookup"><span data-stu-id="4b70e-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for the presence of a partition key.</span></span> <span data-ttu-id="4b70e-147">如果找到，它會根據該索引鍵選取片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-147">If it finds one, it selects the fragment based on that key.</span></span> <span data-ttu-id="4b70e-148">如果找不到分割索引鍵，它會根據內部演算法選取片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-148">If it does not find a partition key, it selects the fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="4b70e-149">使用分割區索引鍵</span><span class="sxs-lookup"><span data-stu-id="4b70e-149">Using a partition key</span></span>
<span data-ttu-id="4b70e-150">某些案例，例如工作階段或交易，需要儲存在特定片段的訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-150">Some scenarios, such as sessions or transactions, require messages to be stored in a specific fragment.</span></span> <span data-ttu-id="4b70e-151">這些案例都需要使用分割區索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-151">All these scenarios require the use of a partition key.</span></span> <span data-ttu-id="4b70e-152">使用相同分割索引鍵的所有訊息都會指派給相同的片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-152">All messages that use the same partition key are assigned to the same fragment.</span></span> <span data-ttu-id="4b70e-153">若片段暫時無法使用，服務匯流排會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="4b70e-153">If the fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="4b70e-154">根據這個案例，會使用不同的訊息屬性做為分割索引鍵：</span><span class="sxs-lookup"><span data-stu-id="4b70e-154">Depending on the scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="4b70e-155">**SessionId**：若訊息已設定 [BrokeredMessage.SessionId][BrokeredMessage.SessionId] 屬性，則服務匯流排會使用這個屬性做為分割區索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-155">**SessionId**: If a message has the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as the partition key.</span></span> <span data-ttu-id="4b70e-156">如此一來，所有屬於相同工作階段的訊息都會由相同的訊息代理人處理。</span><span class="sxs-lookup"><span data-stu-id="4b70e-156">This way, all messages that belong to the same session are handled by the same message broker.</span></span> <span data-ttu-id="4b70e-157">這樣可讓服務匯流排保證訊息的排序以及工作階段狀態的一致性。</span><span class="sxs-lookup"><span data-stu-id="4b70e-157">This enables Service Bus to guarantee message ordering as well as the consistency of session states.</span></span>

<span data-ttu-id="4b70e-158">**PartitionKey**：若訊息已設定 [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] 屬性而非 [BrokeredMessage.SessionId][BrokeredMessage.SessionId] 屬性，則服務匯流排會使用 [PartitionKey][PartitionKey] 屬性做為分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-158">**PartitionKey**: If a message has the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses the [PartitionKey][PartitionKey] property as the partition key.</span></span> <span data-ttu-id="4b70e-159">如果訊息已設定 [SessionId][SessionId] 和 [PartitionKey][PartitionKey] 屬性，這兩個屬性必須相同。</span><span class="sxs-lookup"><span data-stu-id="4b70e-159">If the message has both the [SessionId][SessionId] and the [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="4b70e-160">如果 [PartitionKey][PartitionKey] 屬性設為和 [SessionId][SessionId] 屬性不同的值，服務匯流排會傳回無效作業例外狀況。</span><span class="sxs-lookup"><span data-stu-id="4b70e-160">If the [PartitionKey][PartitionKey] property is set to a different value than the [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="4b70e-161">如果傳送者傳送非工作階段感知的交易訊息，應使用 [PartitionKey][PartitionKey] 屬性。</span><span class="sxs-lookup"><span data-stu-id="4b70e-161">The [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="4b70e-162">分割索引鍵可確保在交易內傳送的所有訊息都由相同的訊息代理人處理。</span><span class="sxs-lookup"><span data-stu-id="4b70e-162">The partition key ensures that all messages that are sent within a transaction are handled by the same messaging broker.</span></span>

<span data-ttu-id="4b70e-163">**MessageId**：如果佇列或主題已將 [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] 屬性設為 **true**，且未設定 [BrokeredMessage.SessionId][BrokeredMessage.SessionId] 或 [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] 屬性，則 [BrokeredMessage.MessageId][BrokeredMessage.MessageId] 屬性可做為分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-163">**MessageId**: If the queue or topic has the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set to **true** and the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as the partition key.</span></span> <span data-ttu-id="4b70e-164">(請注意，如果傳送應用程式沒有指派訊息識別碼，Microsoft .NET 和 AMQP 程式庫會自動指派)。在此情況下，相同訊息的所有複本會由相同的訊息代理人處理。</span><span class="sxs-lookup"><span data-stu-id="4b70e-164">(Note that the Microsoft .NET and AMQP libraries automatically assign a message ID if the sending application does not.) In this case, all copies of the same message are handled by the same message broker.</span></span> <span data-ttu-id="4b70e-165">這可讓服務匯流排偵測並排除重複的訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-165">This enables Service Bus to detect and eliminate duplicate messages.</span></span> <span data-ttu-id="4b70e-166">如果 [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] 屬性未設為 **true**，服務匯流排不會將 [MessageId][MessageId] 屬性視為分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-166">If the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set to **true**, Service Bus does not consider the [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="4b70e-167">不使用分割索引鍵</span><span class="sxs-lookup"><span data-stu-id="4b70e-167">Not using a partition key</span></span>
<span data-ttu-id="4b70e-168">沒有分割區索引鍵時，服務匯流排會以循環配置的方式將訊息分配到分割區佇列或主題的所有片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-168">In the absence of a partition key, Service Bus distributes messages in a round-robin fashion to all the fragments of the partitioned queue or topic.</span></span> <span data-ttu-id="4b70e-169">如果找不到所選的片段，服務匯流排會將訊息指派至不同的片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-169">If the chosen fragment is not available, Service Bus assigns the message to a different fragment.</span></span> <span data-ttu-id="4b70e-170">如此一來，儘管訊息存放區暫時無法使用，傳送作業仍會成功。</span><span class="sxs-lookup"><span data-stu-id="4b70e-170">This way, the send operation succeeds despite the temporary unavailability of a messaging store.</span></span> <span data-ttu-id="4b70e-171">不過，您將無法達到分割區索引鍵所提供的保證排序。</span><span class="sxs-lookup"><span data-stu-id="4b70e-171">However, you will not achieve the guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="4b70e-172">如需可用性 (無分割區索引鍵) 和一致性 (使用分割區索引鍵) 之間權衡取捨的深入討論，請參閱[這篇文章](../event-hubs/event-hubs-availability-and-consistency.md)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-172">For a more in-depth discussion of the tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="4b70e-173">此資訊同時適用於已分割的服務匯流排實體和事件中樞分割區。</span><span class="sxs-lookup"><span data-stu-id="4b70e-173">This information applies equally to partitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="4b70e-174">若要讓服務匯流排有足夠的時間將訊息加入佇列的不同片段中，由傳送訊息之用戶端所指定的 [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] 值必須大於 15 秒。</span><span class="sxs-lookup"><span data-stu-id="4b70e-174">To give Service Bus enough time to enqueue the message into a different fragment, the [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by the client that sends the message must be greater than 15 seconds.</span></span> <span data-ttu-id="4b70e-175">建議將 [OperationTimeout][OperationTimeout] 屬性設為預設值 60 秒。</span><span class="sxs-lookup"><span data-stu-id="4b70e-175">It is recommended that you set the [OperationTimeout][OperationTimeout] property to the default value of 60 seconds.</span></span>

<span data-ttu-id="4b70e-176">請注意，分割索引鍵會將訊息「釘選」到指定的片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-176">Note that a partition key "pins" a message to a specific fragment.</span></span> <span data-ttu-id="4b70e-177">如果保留此片段的訊息存放區無法使用，服務匯流排會傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="4b70e-177">If the messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="4b70e-178">沒有分割索引鍵時，服務匯流排可以選擇不同的片段，而作業就會成功。</span><span class="sxs-lookup"><span data-stu-id="4b70e-178">In the absence of a partition key, Service Bus can choose a different fragment and the operation succeeds.</span></span> <span data-ttu-id="4b70e-179">因此，建議您若非必要請勿提供分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="4b70e-180">進階主題：搭配交易使用分割的實體</span><span class="sxs-lookup"><span data-stu-id="4b70e-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="4b70e-181">傳送做為交易一部分的訊息必須指定資料分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="4b70e-182">這可以是下列屬性之一：[BrokeredMessage.SessionId][BrokeredMessage.SessionId]、[BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] 或 [BrokeredMessage.MessageId][BrokeredMessage.MessageId]。</span><span class="sxs-lookup"><span data-stu-id="4b70e-182">This can be one of the following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="4b70e-183">傳送做為相同交易一部分的所有訊息必須指定相同的分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-183">All messages that are sent as part of the same transaction must specify the same partition key.</span></span> <span data-ttu-id="4b70e-184">如果您嘗試在交易內傳送沒有分割索引鍵的訊息，服務匯流排會傳回無效作業例外狀況。</span><span class="sxs-lookup"><span data-stu-id="4b70e-184">If you attempt to send a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="4b70e-185">如果您嘗試在相同交易內傳送多個具有不同分割索引鍵的訊息，服務匯流排會傳回無效作業例外狀況。</span><span class="sxs-lookup"><span data-stu-id="4b70e-185">If you attempt to send multiple messages within the same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="4b70e-186">例如：</span><span class="sxs-lookup"><span data-stu-id="4b70e-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="4b70e-187">如果設定任何做為分割索引鍵的屬性，服務匯流排會將訊息釘選到特定片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-187">If any of the properties that serve as a partition key are set, Service Bus pins the message to a specific fragment.</span></span> <span data-ttu-id="4b70e-188">無論是否使用交易，都會發生這個行為。</span><span class="sxs-lookup"><span data-stu-id="4b70e-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="4b70e-189">建議您若非必要請勿指定分割索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b70e-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="4b70e-190">搭配工作階段使用分割的實體</span><span class="sxs-lookup"><span data-stu-id="4b70e-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="4b70e-191">若要將交易訊息傳送至工作階段感知的主題或佇列，該訊息必須設定 [BrokeredMessage.SessionId][BrokeredMessage.SessionId] 屬性。</span><span class="sxs-lookup"><span data-stu-id="4b70e-191">To send a transactional message to a session-aware topic or queue, the message must have the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="4b70e-192">如果也指定 [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] 屬性，它必須與 [SessionId][SessionId] 屬性相同。</span><span class="sxs-lookup"><span data-stu-id="4b70e-192">If the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical to the [SessionId][SessionId] property.</span></span> <span data-ttu-id="4b70e-193">如果兩者不同，服務匯流排會傳回無效作業例外狀況。</span><span class="sxs-lookup"><span data-stu-id="4b70e-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="4b70e-194">不同於一般 (非分割) 的佇列或主題，無法使用單一交易將多則訊息傳送到不同的工作階段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-194">Unlike regular (non-partitioned) queues or topics, it is not possible to use a single transaction to send multiple messages to different sessions.</span></span> <span data-ttu-id="4b70e-195">如果嘗試這樣做，服務匯流排會傳回無效作業例外狀況。</span><span class="sxs-lookup"><span data-stu-id="4b70e-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="4b70e-196">例如：</span><span class="sxs-lookup"><span data-stu-id="4b70e-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="4b70e-197">使用分割實體的自動訊息轉送</span><span class="sxs-lookup"><span data-stu-id="4b70e-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="4b70e-198">服務匯流排支援往返於分割實體或在它們之間自動轉送訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="4b70e-199">若要啟用自動訊息轉送，請在來源佇列或訂用帳戶上設定 [QueueDescription.ForwardTo][QueueDescription.ForwardTo] 屬性。</span><span class="sxs-lookup"><span data-stu-id="4b70e-199">To enable automatic message forwarding, set the [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on the source queue or subscription.</span></span> <span data-ttu-id="4b70e-200">如果訊息指定分割索引鍵 ([SessionId][SessionId]、[PartitionKey][PartitionKey] 或 [MessageId][MessageId])，該分割索引鍵會用於目的地實體。</span><span class="sxs-lookup"><span data-stu-id="4b70e-200">If the message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for the destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="4b70e-201">考量和指導方針</span><span class="sxs-lookup"><span data-stu-id="4b70e-201">Considerations and guidelines</span></span>
* <span data-ttu-id="4b70e-202">**高度一致性功能**︰如果實體使用工作階段、重複偵測或明確控制資料分割區索引鍵等功能，則傳訊作業一定會路由至特定的片段。</span><span class="sxs-lookup"><span data-stu-id="4b70e-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then the messaging operations are always routed to specific fragments.</span></span> <span data-ttu-id="4b70e-203">如果任何片段遇到過高的流量，或基礎存放區的狀況不良，這些作業將會失敗，而且可用性會降低。</span><span class="sxs-lookup"><span data-stu-id="4b70e-203">If any of the fragments experience high traffic or the underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="4b70e-204">整體來說，一致性仍然遠高於非分割實體，只有一部分流量會遭遇問題，而不是所有的流量。</span><span class="sxs-lookup"><span data-stu-id="4b70e-204">Overall, the consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed to all the traffic.</span></span> <span data-ttu-id="4b70e-205">如需詳細資訊，請參閱這篇[針對可用性和一致性的討論](../event-hubs/event-hubs-availability-and-consistency.md)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="4b70e-206">**管理**︰必須在實體的所有片段上執行建立、更新及刪除等作業。</span><span class="sxs-lookup"><span data-stu-id="4b70e-206">**Management**: Operations such as Create, Update and Delete must be performed on all the fragments of the entity.</span></span> <span data-ttu-id="4b70e-207">如果任何片段的狀況不良，可能會造成這些作業失敗。</span><span class="sxs-lookup"><span data-stu-id="4b70e-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="4b70e-208">以「取得」作業來說，必須彙總來自所有片段的資訊，例如訊息計數。</span><span class="sxs-lookup"><span data-stu-id="4b70e-208">For the Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="4b70e-209">如果任何片段的狀況不良，則實體可用性狀態會報告為受限制。</span><span class="sxs-lookup"><span data-stu-id="4b70e-209">If any fragment is unhealthy, the entity availability status is reported as limited.</span></span>
* <span data-ttu-id="4b70e-210">**少量訊息案例**︰對於這類案例，尤其是當使用 HTTP 通訊協定時，您可能必須執行多次接收作業，才能取得所有訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-210">**Low volume message scenarios**: For such scenarios, especially when using the HTTP protocol, you may have to perform multiple receive operations in order to obtain all the messages.</span></span> <span data-ttu-id="4b70e-211">對於接收要求，前端會在所有片段上執行接收，並快取所有收到的回應。</span><span class="sxs-lookup"><span data-stu-id="4b70e-211">For receive requests, the front end performs a receive on all the fragments and caches all the responses received.</span></span> <span data-ttu-id="4b70e-212">相同連接上的後續接收要求將受益於此快取，而且接收延遲將會縮短。</span><span class="sxs-lookup"><span data-stu-id="4b70e-212">A subsequent receive request on the same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="4b70e-213">不過，如果您有多個連線或使用 HTTP，則會針對每個要求建立新的連接。</span><span class="sxs-lookup"><span data-stu-id="4b70e-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="4b70e-214">因此，不保證抵達相同的節點。</span><span class="sxs-lookup"><span data-stu-id="4b70e-214">As such, there is no guarantee that it would land on the same node.</span></span> <span data-ttu-id="4b70e-215">如果所有現有的訊息遭鎖定，而且在另一個前端中快取，接收作業會傳回 **null**。</span><span class="sxs-lookup"><span data-stu-id="4b70e-215">If all existing messages are locked and cached in another front end, the receive operation returns **null**.</span></span> <span data-ttu-id="4b70e-216">訊息最後會到期，您可以再次接收它們。</span><span class="sxs-lookup"><span data-stu-id="4b70e-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="4b70e-217">建議使用 HTTP 持續作用。</span><span class="sxs-lookup"><span data-stu-id="4b70e-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="4b70e-218">**瀏覽/查看訊息**：[PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) 不一定會傳回 [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) 屬性中指定的訊息數目。</span><span class="sxs-lookup"><span data-stu-id="4b70e-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return the number of messages specified in the [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="4b70e-219">這有兩個常見的原因。</span><span class="sxs-lookup"><span data-stu-id="4b70e-219">There are two common reasons for this.</span></span> <span data-ttu-id="4b70e-220">其中一個原因是訊息集合的彙總大小超過大小上限 256KB。</span><span class="sxs-lookup"><span data-stu-id="4b70e-220">One reason is that the aggregated size of the collection of messages exceeds the maximum size of 256KB.</span></span> <span data-ttu-id="4b70e-221">另一個原因是，如果佇列或主題的 [EnablePartitioning 屬性](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning)設為 **true**，分割區可能沒有足夠的訊息來完成所要求的訊息數目。</span><span class="sxs-lookup"><span data-stu-id="4b70e-221">Another reason is that if the queue or topic has the [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set to **true**, a partition may not have enough messages to complete the requested number of messages.</span></span> <span data-ttu-id="4b70e-222">一般而言，如果應用程式想要接收一定數目的訊息，它應該重複呼叫 [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_)，直到取得該數目的訊息，或已沒有更多訊息可查看為止。</span><span class="sxs-lookup"><span data-stu-id="4b70e-222">In general, if an application wants to receive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages to peek.</span></span> <span data-ttu-id="4b70e-223">如需詳細資訊，包括程式碼範例，請參閱 [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) 或 [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="4b70e-224">最新加入的功能</span><span class="sxs-lookup"><span data-stu-id="4b70e-224">Latest added features</span></span>
* <span data-ttu-id="4b70e-225">分割實體現在支援新增或移除規則。</span><span class="sxs-lookup"><span data-stu-id="4b70e-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="4b70e-226">不同於非分割實體，交易情況下不支援這些作業。</span><span class="sxs-lookup"><span data-stu-id="4b70e-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="4b70e-227">AMQP 現在支援往返於分割實體傳送和接收訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-227">AMQP is now supported for sending and receiving messages to and from a partitioned entity.</span></span>
* <span data-ttu-id="4b70e-228">AMQP 現在支援下列作業：[批次傳送](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__)、[批次接收](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_)、[依序號接收](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_)、[查看](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek)、[更新鎖定](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_)、[排定訊息](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_)、[取消排定的訊息](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_)、[新增規則](/dotnet/api/microsoft.servicebus.messaging.ruledescription)、[移除規則](/dotnet/api/microsoft.servicebus.messaging.ruledescription)、[工作階段更新鎖定](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock)、[設定工作階段狀態](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_)、[取得工作階段狀態](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState)和[列舉工作階段](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-228">AMQP is now supported for the following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="4b70e-229">分割實體限制</span><span class="sxs-lookup"><span data-stu-id="4b70e-229">Partitioned entities limitations</span></span>
<span data-ttu-id="4b70e-230">目前服務匯流排會為分割的佇列和主題設定下列限制：</span><span class="sxs-lookup"><span data-stu-id="4b70e-230">Currently Service Bus imposes the following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="4b70e-231">分割的佇列及主題不支援在單一交易中傳送屬於不同工作階段的訊息。</span><span class="sxs-lookup"><span data-stu-id="4b70e-231">Partitioned queues and topics do not support sending messages that belong to different sessions in a single transaction.</span></span>
* <span data-ttu-id="4b70e-232">服務匯流排目前每個命名空間允許最多 100 個分割佇列或主題。</span><span class="sxs-lookup"><span data-stu-id="4b70e-232">Service Bus currently allows up to 100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="4b70e-233">每個分割佇列或主題的配額計數為每個命名空間 10,000 個實體 (不適用於高階層)。</span><span class="sxs-lookup"><span data-stu-id="4b70e-233">Each partitioned queue or topic counts towards the quota of 10,000 entities per namespace (does not apply to Premium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="4b70e-234">後續步驟</span><span class="sxs-lookup"><span data-stu-id="4b70e-234">Next steps</span></span>
<span data-ttu-id="4b70e-235">請參閱[適用於服務匯流排分割的佇列和主題的 AMQP 1.0 支援][AMQP 1.0 support for Service Bus partitioned queues and topics]，深入了解分割訊息實體。</span><span class="sxs-lookup"><span data-stu-id="4b70e-235">See the discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] to learn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
