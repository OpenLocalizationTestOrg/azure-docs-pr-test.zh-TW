---
title: "aaaAzure Service Bus 訊息處理架構概觀 |Microsoft 文件"
description: "描述 Azure 服務匯流排 hello 訊息處理架構。"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: baf94c2d-0e58-4d5d-a588-767f996ccf7f
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: f7606e40cdf6db3797a0db2de9365453ff2a158e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="service-bus-architecture"></a><span data-ttu-id="ab28a-103">服務匯流排架構</span><span class="sxs-lookup"><span data-stu-id="ab28a-103">Service Bus architecture</span></span>
<span data-ttu-id="ab28a-104">本文說明的 Azure 服務匯流排 hello 訊息處理的架構。</span><span class="sxs-lookup"><span data-stu-id="ab28a-104">This article describes hello message processing architecture of Azure Service Bus.</span></span>

## <a name="service-bus-scale-units"></a><span data-ttu-id="ab28a-105">服務匯流排縮放單位</span><span class="sxs-lookup"><span data-stu-id="ab28a-105">Service Bus scale units</span></span>
<span data-ttu-id="ab28a-106">服務匯流排依 *縮放單位*組織。</span><span class="sxs-lookup"><span data-stu-id="ab28a-106">Service Bus is organized by *scale units*.</span></span> <span data-ttu-id="ab28a-107">擴充單元是部署單位，並包含所有的元件所需執行的 hello 服務。</span><span class="sxs-lookup"><span data-stu-id="ab28a-107">A scale unit is a unit of deployment and contains all components required run hello service.</span></span> <span data-ttu-id="ab28a-108">每個區域都會部署一或多個服務匯流排縮放單位。</span><span class="sxs-lookup"><span data-stu-id="ab28a-108">Each region deploys one or more Service Bus scale units.</span></span>

<span data-ttu-id="ab28a-109">服務匯流排命名空間是對應的 tooa 擴充單元。</span><span class="sxs-lookup"><span data-stu-id="ab28a-109">A Service Bus namespace is mapped tooa scale unit.</span></span> <span data-ttu-id="ab28a-110">hello 縮放單位會處理所有類型的服務匯流排實體 （佇列、 主題、 訂用帳戶）。</span><span class="sxs-lookup"><span data-stu-id="ab28a-110">hello scale unit handles all types of Service Bus entities (queues, topics, subscriptions).</span></span> <span data-ttu-id="ab28a-111">服務匯流排擴充單元包含下列元件的 hello:</span><span class="sxs-lookup"><span data-stu-id="ab28a-111">A Service Bus scale unit consists of hello following components:</span></span>

* <span data-ttu-id="ab28a-112">**一組閘道器節點。**</span><span class="sxs-lookup"><span data-stu-id="ab28a-112">**A set of gateway nodes.**</span></span> <span data-ttu-id="ab28a-113">閘道節點會驗證傳入要求。</span><span class="sxs-lookup"><span data-stu-id="ab28a-113">Gateway nodes authenticate incoming requests.</span></span> <span data-ttu-id="ab28a-114">每個閘道器節點都有一個公用 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="ab28a-114">Each gateway node has a public IP address.</span></span>
* <span data-ttu-id="ab28a-115">**一組訊息代理程式節點。**</span><span class="sxs-lookup"><span data-stu-id="ab28a-115">**A set of messaging broker nodes.**</span></span> <span data-ttu-id="ab28a-116">訊息代理程式節點會處理關於訊息實體的要求。</span><span class="sxs-lookup"><span data-stu-id="ab28a-116">Messaging broker nodes process requests concerning messaging entities.</span></span>
* <span data-ttu-id="ab28a-117">**一個閘道器存放區。**</span><span class="sxs-lookup"><span data-stu-id="ab28a-117">**One gateway store.**</span></span> <span data-ttu-id="ab28a-118">hello 閘道存放區會保留此縮放單位會定義每個實體的 hello 資料。</span><span class="sxs-lookup"><span data-stu-id="ab28a-118">hello gateway store holds hello data for every entity that is defined in this scale unit.</span></span> <span data-ttu-id="ab28a-119">SQL Azure 資料庫最上層，則實作 hello 閘道存放區。</span><span class="sxs-lookup"><span data-stu-id="ab28a-119">hello gateway store is implemented on top of a SQL Azure database.</span></span>
* <span data-ttu-id="ab28a-120">**多個訊息存放區。**</span><span class="sxs-lookup"><span data-stu-id="ab28a-120">**Multiple messaging stores.**</span></span> <span data-ttu-id="ab28a-121">訊息存放區保留所有佇列、 主題和訂用帳戶在此縮放單位中定義的 hello 的訊息。</span><span class="sxs-lookup"><span data-stu-id="ab28a-121">Messaging stores hold hello messages of all queues, topics and subscriptions that are defined in this scale unit.</span></span> <span data-ttu-id="ab28a-122">它也包含所有訂用帳戶資料。</span><span class="sxs-lookup"><span data-stu-id="ab28a-122">It also contains all subscription data.</span></span> <span data-ttu-id="ab28a-123">除非[分割訊息實體](service-bus-partitioning.md)已啟用，佇列或主題是對應的 tooone 訊息存放區。</span><span class="sxs-lookup"><span data-stu-id="ab28a-123">Unless [partitioning messaging entities](service-bus-partitioning.md) is enabled, a queue or topic is mapped tooone messaging store.</span></span> <span data-ttu-id="ab28a-124">訂用帳戶會儲存在 hello 相同的訊息存放區做為其父主題。</span><span class="sxs-lookup"><span data-stu-id="ab28a-124">Subscriptions are stored in hello same messaging store as their parent topic.</span></span> <span data-ttu-id="ab28a-125">除了服務匯流排[進階傳訊](service-bus-premium-messaging.md)，SQL Azure 資料庫上實作 hello 訊息存放區。</span><span class="sxs-lookup"><span data-stu-id="ab28a-125">Except for Service Bus [Premium Messaging](service-bus-premium-messaging.md), hello messaging stores are implemented on top of SQL Azure databases.</span></span>

## <a name="containers"></a><span data-ttu-id="ab28a-126">容器</span><span class="sxs-lookup"><span data-stu-id="ab28a-126">Containers</span></span>
<span data-ttu-id="ab28a-127">每個訊息實體都會指派給特定的容器。</span><span class="sxs-lookup"><span data-stu-id="ab28a-127">Each messaging entity is assigned a specific container.</span></span> <span data-ttu-id="ab28a-128">容器是這個容器使用一個訊息存放區 toostore 所有相關資料的邏輯建構。</span><span class="sxs-lookup"><span data-stu-id="ab28a-128">A container is a logical construct that uses exactly one messaging store toostore all relevant data for this container.</span></span> <span data-ttu-id="ab28a-129">每個容器會指派 tooa 訊息代理人節點。</span><span class="sxs-lookup"><span data-stu-id="ab28a-129">Each container is assigned tooa messaging broker node.</span></span> <span data-ttu-id="ab28a-130">通常，容器較訊息代理程式節點多。</span><span class="sxs-lookup"><span data-stu-id="ab28a-130">Typically, there are more containers than messaging broker nodes.</span></span> <span data-ttu-id="ab28a-131">因此，每個訊息代理程式節點會載入多個容器。</span><span class="sxs-lookup"><span data-stu-id="ab28a-131">Therefore, each messaging broker node loads multiple containers.</span></span> <span data-ttu-id="ab28a-132">容器 tooa 傳訊代理程式節點的 hello 發佈組織同樣會載入所有的訊息代理程式節點。</span><span class="sxs-lookup"><span data-stu-id="ab28a-132">hello distribution of containers tooa messaging broker node is organized such that all messaging broker nodes are equally loaded.</span></span> <span data-ttu-id="ab28a-133">如果 hello hello 負載模式變更 （例如，一個 hello 容器取得非常忙碌），或訊息代理程式節點會變成暫時無法使用，容器會重新分配 hello 訊息代理程式節點。</span><span class="sxs-lookup"><span data-stu-id="ab28a-133">If hello load pattern changes (for example, one of hello containers gets very busy), or if a messaging broker node becomes temporarily unavailable, hello containers are redistributed among hello messaging broker nodes.</span></span>

## <a name="processing-of-incoming-messaging-requests"></a><span data-ttu-id="ab28a-134">處理內送訊息要求</span><span class="sxs-lookup"><span data-stu-id="ab28a-134">Processing of incoming messaging requests</span></span>
<span data-ttu-id="ab28a-135">當用戶端傳送要求 tooService 匯流排時，hello Azure 負載平衡器將其路由傳送 hello 閘道節點的 tooany。</span><span class="sxs-lookup"><span data-stu-id="ab28a-135">When a client sends a request tooService Bus, hello Azure load balancer routes it tooany of hello gateway nodes.</span></span> <span data-ttu-id="ab28a-136">hello 的 gateway 節點授權 hello 要求。</span><span class="sxs-lookup"><span data-stu-id="ab28a-136">hello gateway node authorizes hello request.</span></span> <span data-ttu-id="ab28a-137">Hello 要求動作訊息實體 （佇列、 主題、 訂用帳戶），如果 hello 的 gateway 節點查閱 hello 閘道存放區中的 hello 實體，並判斷哪些訊息存放區 hello 中實體所在。</span><span class="sxs-lookup"><span data-stu-id="ab28a-137">If hello request concerns a messaging entity (queue, topic, subscription), hello gateway node looks up hello entity in hello gateway store and determines in which messaging store hello entity is located.</span></span> <span data-ttu-id="ab28a-138">接著會尋找哪一個訊息代理人節點目前正在服務此容器，以及傳送嗨要求 toothat 訊息代理人節點。</span><span class="sxs-lookup"><span data-stu-id="ab28a-138">It then looks up which messaging broker node is currently servicing this container, and sends hello request toothat messaging broker node.</span></span> <span data-ttu-id="ab28a-139">hello 訊息代理人節點處理 hello 要求，並更新 hello hello 容器存放區中的實體狀態。</span><span class="sxs-lookup"><span data-stu-id="ab28a-139">hello messaging broker node processes hello request and updates hello entity state in hello container store.</span></span> <span data-ttu-id="ab28a-140">hello 訊息代理人節點，然後會傳送 hello 回應後 toohello 閘道 節點，該發行的 hello 原始要求傳送給適當的回應後 toohello 用戶端。</span><span class="sxs-lookup"><span data-stu-id="ab28a-140">hello messaging broker node then sends hello response back toohello gateway node, which sends an appropriate response back toohello client that issued hello original request.</span></span>

![處理內送訊息要求](./media/service-bus-architecture/ic690644.png)

## <a name="next-steps"></a><span data-ttu-id="ab28a-142">後續步驟</span><span class="sxs-lookup"><span data-stu-id="ab28a-142">Next steps</span></span>
<span data-ttu-id="ab28a-143">既然您已閱讀 Service Bus 架構的概觀，請造訪下列連結以取得詳細資訊的 hello:</span><span class="sxs-lookup"><span data-stu-id="ab28a-143">Now that you've read an overview of Service Bus architecture, visit hello following links for more information:</span></span>

* [<span data-ttu-id="ab28a-144">服務匯流排訊息概觀</span><span class="sxs-lookup"><span data-stu-id="ab28a-144">Service Bus messaging overview</span></span>](service-bus-messaging-overview.md)
* [<span data-ttu-id="ab28a-145">服務匯流排基本概念</span><span class="sxs-lookup"><span data-stu-id="ab28a-145">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="ab28a-146">使用服務匯流排佇列的佇列訊息解決方案</span><span class="sxs-lookup"><span data-stu-id="ab28a-146">A queued messaging solution using Service Bus queues</span></span>](service-bus-dotnet-multi-tier-app-using-service-bus-queues.md)


