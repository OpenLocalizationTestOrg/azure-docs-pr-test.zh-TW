---
title: "Machine Learning 中的線性迴歸 aaaUsing |Microsoft 文件"
description: "在 Excel 和 Azure Machine Learning Studio 中的線性迴歸模型的比較"
metakeywords: 
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 417ae6ab-de4f-4bdd-957a-d96133234656
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/20/2017
ms.author: kbaroni;garye
ms.openlocfilehash: 8716040ad296053a72fb06c7c9660a186123ac15
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="using-linear-regression-in-azure-machine-learning"></a><span data-ttu-id="5ad93-103">在 Azure Machine Learning 中使用線性迴歸</span><span class="sxs-lookup"><span data-stu-id="5ad93-103">Using linear regression in Azure Machine Learning</span></span>
> <span data-ttu-id="5ad93-104">*Kate Baroni* 和 *Ben Boatman* 是 Microsoft 的 Data Insights Center of Excellence 的企業解決方案架構設計人員。</span><span class="sxs-lookup"><span data-stu-id="5ad93-104">*Kate Baroni* and *Ben Boatman* are enterprise solution architects in Microsoft’s Data Insights Center of Excellence.</span></span> <span data-ttu-id="5ad93-105">在本文中，這些主題說明移轉現有迴歸分析套件 tooa 以雲端為基礎的方案使用 Azure Machine Learning 經驗。</span><span class="sxs-lookup"><span data-stu-id="5ad93-105">In this article, they describe their experience migrating an existing regression analysis suite tooa cloud-based solution using Azure Machine Learning.</span></span> 
> 
> 

&nbsp; 

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="goal"></a><span data-ttu-id="5ad93-106">目標</span><span class="sxs-lookup"><span data-stu-id="5ad93-106">Goal</span></span>
<span data-ttu-id="5ad93-107">我們的專案開始時有兩個目標：</span><span class="sxs-lookup"><span data-stu-id="5ad93-107">Our project started with two goals in mind:</span></span> 

1. <span data-ttu-id="5ad93-108">使用我們的組織每月的營收預測的預測分析 tooimprove hello 精確度</span><span class="sxs-lookup"><span data-stu-id="5ad93-108">Use predictive analytics tooimprove hello accuracy of our organization’s monthly revenue projections</span></span> 
2. <span data-ttu-id="5ad93-109">使用 Azure Machine Learning tooconfirm、 最佳化、 增加的速度，和小數位數的結果。</span><span class="sxs-lookup"><span data-stu-id="5ad93-109">Use Azure Machine Learning tooconfirm, optimize, increase velocity, and scale of our results.</span></span> 

<span data-ttu-id="5ad93-110">與許多企業一樣，我們的組織會每個月都會經歷營收預測程序。</span><span class="sxs-lookup"><span data-stu-id="5ad93-110">Like many businesses, our organization goes through a monthly revenue forecasting process.</span></span> <span data-ttu-id="5ad93-111">商務分析師我們小組需要使用 Azure Machine Learning toosupport hello 程序，並改善預測的精確度。</span><span class="sxs-lookup"><span data-stu-id="5ad93-111">Our small team of business analysts was tasked with using Azure Machine Learning toosupport hello process and improve forecast accuracy.</span></span> <span data-ttu-id="5ad93-112">hello 小組花費幾個月多個來源收集資料，並透過識別索引鍵屬性相關 tooservices 銷售預測的統計分析執行 hello 資料屬性。</span><span class="sxs-lookup"><span data-stu-id="5ad93-112">hello team spent several months collecting data from multiple sources and running hello data attributes through statistical analysis identifying key attributes relevant tooservices sales forecasting.</span></span> <span data-ttu-id="5ad93-113">hello 下一個步驟是在 Excel 中的 hello 資料 toobegin 原型統計的迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-113">hello next step was toobegin prototyping statistical regression models on hello data in Excel.</span></span> <span data-ttu-id="5ad93-114">幾週後，我們必須其效果優於 hello 目前的欄位和財務預測程序，將 Excel 迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-114">Within a few weeks, we had an Excel regression model that was outperforming hello current field and finance forecasting processes.</span></span> <span data-ttu-id="5ad93-115">這會變成 hello 基準預測結果。</span><span class="sxs-lookup"><span data-stu-id="5ad93-115">This became hello baseline prediction result.</span></span> 

<span data-ttu-id="5ad93-116">然後把下一個步驟 toomoving hello 我們的預測分析透過 tooAzure Machine Learning toofind 出機器學習如何對預測的效能改進。</span><span class="sxs-lookup"><span data-stu-id="5ad93-116">We then took hello next step toomoving our predictive analytics over tooAzure Machine Learning toofind out how Machine Learning could improve on predictive performance.</span></span>

## <a name="achieving-predictive-performance-parity"></a><span data-ttu-id="5ad93-117">達成預測效能同位檢查</span><span class="sxs-lookup"><span data-stu-id="5ad93-117">Achieving predictive performance parity</span></span>
<span data-ttu-id="5ad93-118">我們第一優先順序的機器學習和 Excel 迴歸模型之間的 tooachieve 同位檢查。</span><span class="sxs-lookup"><span data-stu-id="5ad93-118">Our first priority was tooachieve parity between Machine Learning and Excel regression models.</span></span> <span data-ttu-id="5ad93-119">指定 hello 相同的資料，而且 hello 分割進行定型和測試資料相同，我們想 tooachieve 預測效能 Excel 和機器學習服務之間的同位檢查。</span><span class="sxs-lookup"><span data-stu-id="5ad93-119">Given hello same data, and hello same split for training and testing data, we wanted tooachieve predictive performance parity between Excel and Machine Learning.</span></span> <span data-ttu-id="5ad93-120">一開始我們失敗了。</span><span class="sxs-lookup"><span data-stu-id="5ad93-120">Initially we failed.</span></span> <span data-ttu-id="5ad93-121">hello Excel 模型的效能勝過 hello 機器學習模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-121">hello Excel model outperformed hello Machine Learning model.</span></span> <span data-ttu-id="5ad93-122">hello 失敗是工具的由於 tooa 缺乏 hello 基底，在機器學習中設定了解。</span><span class="sxs-lookup"><span data-stu-id="5ad93-122">hello failure was due tooa lack of understanding of hello base tool setting in Machine Learning.</span></span> <span data-ttu-id="5ad93-123">與 hello Machine Learning 產品小組的同步處理之後, 我們將獲得更深入了解 hello 基底設定需要針對我們的資料集，並達成 hello 兩個模型之間的同位檢查。</span><span class="sxs-lookup"><span data-stu-id="5ad93-123">After a sync with hello Machine Learning product team, we gained a better understanding of hello base setting required for our data sets, and achieved parity between hello two models.</span></span> 

### <a name="create-regression-model-in-excel"></a><span data-ttu-id="5ad93-124">在 Excel 中建立迴歸模型</span><span class="sxs-lookup"><span data-stu-id="5ad93-124">Create regression model in Excel</span></span>
<span data-ttu-id="5ad93-125">我們 Excel 迴歸用於 hello Excel 分析工具箱 中找到的 hello 標準的線性迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-125">Our Excel Regression used hello standard linear regression model found in hello Excel Analysis ToolPak.</span></span> 

<span data-ttu-id="5ad93-126">我們計算*平均絕對 %錯誤*，當成 hello 模型 hello 效能量值。</span><span class="sxs-lookup"><span data-stu-id="5ad93-126">We calculated *Mean Absolute % Error* and used it as hello performance measure for hello model.</span></span> <span data-ttu-id="5ad93-127">花費在處理模型，使用 Excel 的 3 個月 tooarrive。</span><span class="sxs-lookup"><span data-stu-id="5ad93-127">It took 3 months tooarrive at a working model using Excel.</span></span> <span data-ttu-id="5ad93-128">我們回到大部分 hello 學習到 hello Machine Learning Studio 的實驗，最終已了解需求有幫助。</span><span class="sxs-lookup"><span data-stu-id="5ad93-128">We brought much of hello learning into hello Machine Learning Studio experiment which ultimately was beneficial in understanding requirements.</span></span>

### <a name="create-comparable-experiment-in-azure-machine-learning"></a><span data-ttu-id="5ad93-129">在 Azure Machine Learning 建立可比較的實驗</span><span class="sxs-lookup"><span data-stu-id="5ad93-129">Create comparable experiment in Azure Machine Learning</span></span>
<span data-ttu-id="5ad93-130">我們會遵循這些步驟 toocreate 我們 Machine Learning Studio 中的實驗：</span><span class="sxs-lookup"><span data-stu-id="5ad93-130">We followed these steps toocreate our experiment in Machine Learning Studio:</span></span> 

1. <span data-ttu-id="5ad93-131">上傳的 hello 做為 csv 檔案 tooMachine Learning Studio （非常小的檔案） 的資料集</span><span class="sxs-lookup"><span data-stu-id="5ad93-131">Uploaded hello dataset as a csv file tooMachine Learning Studio (very small file)</span></span>
2. <span data-ttu-id="5ad93-132">建立新的實驗，並使用 hello[資料集中選取的資料行][ select-columns]模組 tooselect hello Excel 中所使用的相同資料功能</span><span class="sxs-lookup"><span data-stu-id="5ad93-132">Created a new experiment and used hello [Select Columns in Dataset][select-columns] module tooselect hello same data features used in Excel</span></span> 
3. <span data-ttu-id="5ad93-133">使用的 hello[分割資料][ split]模組 (具有*相對運算式*模式) toodivide hello 資料 hello 相同訓練資料集，為 「 已在 Excel 中已完成</span><span class="sxs-lookup"><span data-stu-id="5ad93-133">Used hello [Split Data][split] module (with *Relative Expression* mode) toodivide hello data into hello same training datasets as had been done in Excel</span></span> 
4. <span data-ttu-id="5ad93-134">實驗 hello[線性迴歸][ linear-regression]模組 （只有預設選項），記載，並比較 hello 結果 tooour Excel 迴歸模型</span><span class="sxs-lookup"><span data-stu-id="5ad93-134">Experimented with hello [Linear Regression][linear-regression] module (default options only), documented, and compared hello results tooour Excel regression model</span></span>

### <a name="review-initial-results"></a><span data-ttu-id="5ad93-135">檢閱初步結果</span><span class="sxs-lookup"><span data-stu-id="5ad93-135">Review initial results</span></span>
<span data-ttu-id="5ad93-136">首先，hello Excel 模型清楚的效能勝過 hello Machine Learning Studio 模型：</span><span class="sxs-lookup"><span data-stu-id="5ad93-136">At first, hello Excel model clearly outperformed hello Machine Learning Studio model:</span></span> 

|  | <span data-ttu-id="5ad93-137">Excel</span><span class="sxs-lookup"><span data-stu-id="5ad93-137">Excel</span></span> | <span data-ttu-id="5ad93-138">Studio</span><span class="sxs-lookup"><span data-stu-id="5ad93-138">Studio</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="5ad93-139">效能</span><span class="sxs-lookup"><span data-stu-id="5ad93-139">Performance</span></span> | | |
| <ul style="list-style-type: none;"><li><span data-ttu-id="5ad93-140">調整 R 平方</span><span class="sxs-lookup"><span data-stu-id="5ad93-140">Adjusted R Square</span></span></li></ul> |<span data-ttu-id="5ad93-141">0.96</span><span class="sxs-lookup"><span data-stu-id="5ad93-141">0.96</span></span> |<span data-ttu-id="5ad93-142">N/A</span><span class="sxs-lookup"><span data-stu-id="5ad93-142">N/A</span></span> |
| <ul style="list-style-type: none;"><li><span data-ttu-id="5ad93-143">決定</span><span class="sxs-lookup"><span data-stu-id="5ad93-143">Coefficient of</span></span> <br /><span data-ttu-id="5ad93-144">係數</span><span class="sxs-lookup"><span data-stu-id="5ad93-144">Determination</span></span></li></ul> |<span data-ttu-id="5ad93-145">N/A</span><span class="sxs-lookup"><span data-stu-id="5ad93-145">N/A</span></span> |<span data-ttu-id="5ad93-146">0.78</span><span class="sxs-lookup"><span data-stu-id="5ad93-146">0.78</span></span><br /><span data-ttu-id="5ad93-147">(低度精確度)</span><span class="sxs-lookup"><span data-stu-id="5ad93-147">(low accuracy)</span></span> |
| <span data-ttu-id="5ad93-148">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-148">Mean Absolute Error</span></span> |<span data-ttu-id="5ad93-149">$9.5M</span><span class="sxs-lookup"><span data-stu-id="5ad93-149">$9.5M</span></span> |<span data-ttu-id="5ad93-150">$ 19.4M</span><span class="sxs-lookup"><span data-stu-id="5ad93-150">$ 19.4M</span></span> |
| <span data-ttu-id="5ad93-151">平均絕對誤差 (%)</span><span class="sxs-lookup"><span data-stu-id="5ad93-151">Mean Absolute Error (%)</span></span> |<span data-ttu-id="5ad93-152">6.03%</span><span class="sxs-lookup"><span data-stu-id="5ad93-152">6.03%</span></span> |<span data-ttu-id="5ad93-153">12.2%</span><span class="sxs-lookup"><span data-stu-id="5ad93-153">12.2%</span></span> |

<span data-ttu-id="5ad93-154">當我們執行我們的程序和結果的 hello 開發人員和資料科學家 hello Machine Learning 小組時，他們快速提供實用秘訣。</span><span class="sxs-lookup"><span data-stu-id="5ad93-154">When we ran our process and results by hello developers and data scientists on hello Machine Learning team, they quickly provided some useful tips.</span></span> 

* <span data-ttu-id="5ad93-155">當您使用 hello[線性迴歸][ linear-regression] Machine Learning Studio 中的模組，提供兩種方法：</span><span class="sxs-lookup"><span data-stu-id="5ad93-155">When you use hello [Linear Regression][linear-regression] module in Machine Learning Studio, two methods are provided:</span></span>
  * <span data-ttu-id="5ad93-156">線上梯度下降：可能比較適合較大規模的問題</span><span class="sxs-lookup"><span data-stu-id="5ad93-156">Online Gradient Descent: May be more suitable for larger-scale problems</span></span>
  * <span data-ttu-id="5ad93-157">普通最小平方： 這是當它們聽到線性迴歸大部分的人想到的 hello 方法。</span><span class="sxs-lookup"><span data-stu-id="5ad93-157">Ordinary Least Squares: This is hello method most people think of when they hear linear regression.</span></span> <span data-ttu-id="5ad93-158">對於小型資料集，一般最小平方是較佳的選擇。</span><span class="sxs-lookup"><span data-stu-id="5ad93-158">For small datasets, Ordinary Least Squares can be a more optimal choice.</span></span>
* <span data-ttu-id="5ad93-159">請考慮調整 hello L2 正則化權數參數 tooimprove 效能。</span><span class="sxs-lookup"><span data-stu-id="5ad93-159">Consider tweaking hello L2 Regularization Weight parameter tooimprove performance.</span></span> <span data-ttu-id="5ad93-160">依預設，它會設 too0.001 但我們的小型資料集我們設 too0.005 tooimprove 效能。</span><span class="sxs-lookup"><span data-stu-id="5ad93-160">It is set too0.001 by default, but for our small data set we set it too0.005 tooimprove performance.</span></span> 

### <a name="mystery-solved"></a><span data-ttu-id="5ad93-161">謎題解開了！</span><span class="sxs-lookup"><span data-stu-id="5ad93-161">Mystery solved!</span></span>
<span data-ttu-id="5ad93-162">當我們套用 hello 建議時，我們所達成 hello 與 Excel 相同 Machine Learning Studio 中的基準效能：</span><span class="sxs-lookup"><span data-stu-id="5ad93-162">When we applied hello recommendations, we achieved hello same baseline performance in Machine Learning Studio as with Excel:</span></span> 

|  | <span data-ttu-id="5ad93-163">Excel</span><span class="sxs-lookup"><span data-stu-id="5ad93-163">Excel</span></span> | <span data-ttu-id="5ad93-164">Studio (最初)</span><span class="sxs-lookup"><span data-stu-id="5ad93-164">Studio (Initial)</span></span> | <span data-ttu-id="5ad93-165">Studio (最小平方法)</span><span class="sxs-lookup"><span data-stu-id="5ad93-165">Studio w/ Least Squares</span></span> |
| --- |:---:|:---:|:---:|
| <span data-ttu-id="5ad93-166">加上標籤的值</span><span class="sxs-lookup"><span data-stu-id="5ad93-166">Labeled value</span></span> |<span data-ttu-id="5ad93-167">實際值 (數值)</span><span class="sxs-lookup"><span data-stu-id="5ad93-167">Actuals (numeric)</span></span> |<span data-ttu-id="5ad93-168">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-168">same</span></span> |<span data-ttu-id="5ad93-169">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-169">same</span></span> |
| <span data-ttu-id="5ad93-170">學習模組</span><span class="sxs-lookup"><span data-stu-id="5ad93-170">Learner</span></span> |<span data-ttu-id="5ad93-171">Excel -> 資料分析 -> 迴歸</span><span class="sxs-lookup"><span data-stu-id="5ad93-171">Excel -> Data Analysis -> Regression</span></span> |<span data-ttu-id="5ad93-172">線性迴歸。</span><span class="sxs-lookup"><span data-stu-id="5ad93-172">Linear Regression.</span></span> |<span data-ttu-id="5ad93-173">線性迴歸</span><span class="sxs-lookup"><span data-stu-id="5ad93-173">Linear Regression</span></span> |
| <span data-ttu-id="5ad93-174">學習模組選項</span><span class="sxs-lookup"><span data-stu-id="5ad93-174">Learner options</span></span> |<span data-ttu-id="5ad93-175">N/A</span><span class="sxs-lookup"><span data-stu-id="5ad93-175">N/A</span></span> |<span data-ttu-id="5ad93-176">預設值</span><span class="sxs-lookup"><span data-stu-id="5ad93-176">Defaults</span></span> |<span data-ttu-id="5ad93-177">普通最小平方</span><span class="sxs-lookup"><span data-stu-id="5ad93-177">ordinary least squares</span></span><br /><span data-ttu-id="5ad93-178">L2 = 0.005</span><span class="sxs-lookup"><span data-stu-id="5ad93-178">L2 = 0.005</span></span> |
| <span data-ttu-id="5ad93-179">資料集</span><span class="sxs-lookup"><span data-stu-id="5ad93-179">Data Set</span></span> |<span data-ttu-id="5ad93-180">26 個資料列，3 個功能，1 個標籤。</span><span class="sxs-lookup"><span data-stu-id="5ad93-180">26 rows, 3 features, 1 label.</span></span> <span data-ttu-id="5ad93-181">全部數值。</span><span class="sxs-lookup"><span data-stu-id="5ad93-181">All numeric.</span></span> |<span data-ttu-id="5ad93-182">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-182">same</span></span> |<span data-ttu-id="5ad93-183">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-183">same</span></span> |
| <span data-ttu-id="5ad93-184">分割：訓練</span><span class="sxs-lookup"><span data-stu-id="5ad93-184">Split: Train</span></span> |<span data-ttu-id="5ad93-185">Excel hello 定型先 18 個資料列，測試 hello 最後 8 個資料列。</span><span class="sxs-lookup"><span data-stu-id="5ad93-185">Excel trained on hello first 18 rows, tested on hello last 8 rows.</span></span> |<span data-ttu-id="5ad93-186">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-186">same</span></span> |<span data-ttu-id="5ad93-187">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-187">same</span></span> |
| <span data-ttu-id="5ad93-188">分割：測試</span><span class="sxs-lookup"><span data-stu-id="5ad93-188">Split: Test</span></span> |<span data-ttu-id="5ad93-189">Excel 迴歸公式套用 toohello 最後 8 個資料列</span><span class="sxs-lookup"><span data-stu-id="5ad93-189">Excel regression formula applied toohello last 8 rows</span></span> |<span data-ttu-id="5ad93-190">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-190">same</span></span> |<span data-ttu-id="5ad93-191">相同</span><span class="sxs-lookup"><span data-stu-id="5ad93-191">same</span></span> |
| <span data-ttu-id="5ad93-192">**效能**</span><span class="sxs-lookup"><span data-stu-id="5ad93-192">**Performance**</span></span> | | | |
| <span data-ttu-id="5ad93-193">調整 R 平方</span><span class="sxs-lookup"><span data-stu-id="5ad93-193">Adjusted R Square</span></span> |<span data-ttu-id="5ad93-194">0.96</span><span class="sxs-lookup"><span data-stu-id="5ad93-194">0.96</span></span> |<span data-ttu-id="5ad93-195">N/A</span><span class="sxs-lookup"><span data-stu-id="5ad93-195">N/A</span></span> | |
| <span data-ttu-id="5ad93-196">決定係數</span><span class="sxs-lookup"><span data-stu-id="5ad93-196">Coefficient of Determination</span></span> |<span data-ttu-id="5ad93-197">N/A</span><span class="sxs-lookup"><span data-stu-id="5ad93-197">N/A</span></span> |<span data-ttu-id="5ad93-198">0.78</span><span class="sxs-lookup"><span data-stu-id="5ad93-198">0.78</span></span> |<span data-ttu-id="5ad93-199">0.952049</span><span class="sxs-lookup"><span data-stu-id="5ad93-199">0.952049</span></span> |
| <span data-ttu-id="5ad93-200">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-200">Mean Absolute Error</span></span> |<span data-ttu-id="5ad93-201">$9.5M</span><span class="sxs-lookup"><span data-stu-id="5ad93-201">$9.5M</span></span> |<span data-ttu-id="5ad93-202">$ 19.4M</span><span class="sxs-lookup"><span data-stu-id="5ad93-202">$ 19.4M</span></span> |<span data-ttu-id="5ad93-203">$9.5M</span><span class="sxs-lookup"><span data-stu-id="5ad93-203">$9.5M</span></span> |
| <span data-ttu-id="5ad93-204">平均絕對誤差 (%)</span><span class="sxs-lookup"><span data-stu-id="5ad93-204">Mean Absolute Error (%)</span></span> |<span data-ttu-id="5ad93-205"><span style="background-color: 00FF00;"> 6.03%</span></span><span class="sxs-lookup"><span data-stu-id="5ad93-205"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |<span data-ttu-id="5ad93-206">12.2%</span><span class="sxs-lookup"><span data-stu-id="5ad93-206">12.2%</span></span> |<span data-ttu-id="5ad93-207"><span style="background-color: 00FF00;"> 6.03%</span></span><span class="sxs-lookup"><span data-stu-id="5ad93-207"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |

<span data-ttu-id="5ad93-208">此外，hello Excel 係數也比較 toohello hello Azure 定型的模型中的特徵權數：</span><span class="sxs-lookup"><span data-stu-id="5ad93-208">In addition, hello Excel coefficients compared well toohello feature weights in hello Azure trained model:</span></span>

|  | <span data-ttu-id="5ad93-209">Excel 係數</span><span class="sxs-lookup"><span data-stu-id="5ad93-209">Excel Coefficients</span></span> | <span data-ttu-id="5ad93-210">Azure 功能加權</span><span class="sxs-lookup"><span data-stu-id="5ad93-210">Azure Feature Weights</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="5ad93-211">截距/偏差</span><span class="sxs-lookup"><span data-stu-id="5ad93-211">Intercept/Bias</span></span> |<span data-ttu-id="5ad93-212">19470209.88</span><span class="sxs-lookup"><span data-stu-id="5ad93-212">19470209.88</span></span> |<span data-ttu-id="5ad93-213">19328500</span><span class="sxs-lookup"><span data-stu-id="5ad93-213">19328500</span></span> |
| <span data-ttu-id="5ad93-214">功能 A</span><span class="sxs-lookup"><span data-stu-id="5ad93-214">Feature A</span></span> |<span data-ttu-id="5ad93-215">0.832653063</span><span class="sxs-lookup"><span data-stu-id="5ad93-215">0.832653063</span></span> |<span data-ttu-id="5ad93-216">0.834156</span><span class="sxs-lookup"><span data-stu-id="5ad93-216">0.834156</span></span> |
| <span data-ttu-id="5ad93-217">功能 B</span><span class="sxs-lookup"><span data-stu-id="5ad93-217">Feature B</span></span> |<span data-ttu-id="5ad93-218">11071967.08</span><span class="sxs-lookup"><span data-stu-id="5ad93-218">11071967.08</span></span> |<span data-ttu-id="5ad93-219">11007300</span><span class="sxs-lookup"><span data-stu-id="5ad93-219">11007300</span></span> |
| <span data-ttu-id="5ad93-220">功能 C</span><span class="sxs-lookup"><span data-stu-id="5ad93-220">Feature C</span></span> |<span data-ttu-id="5ad93-221">25383318.09</span><span class="sxs-lookup"><span data-stu-id="5ad93-221">25383318.09</span></span> |<span data-ttu-id="5ad93-222">25140800</span><span class="sxs-lookup"><span data-stu-id="5ad93-222">25140800</span></span> |

## <a name="next-steps"></a><span data-ttu-id="5ad93-223">後續步驟</span><span class="sxs-lookup"><span data-stu-id="5ad93-223">Next Steps</span></span>
<span data-ttu-id="5ad93-224">我們想在 Excel 內 tooconsume hello 機器學習 web 服務。</span><span class="sxs-lookup"><span data-stu-id="5ad93-224">We wanted tooconsume hello Machine Learning web service within Excel.</span></span> <span data-ttu-id="5ad93-225">我們的商務分析師所需方式 toocall hello 機器學習 web 服務的 Excel 資料的資料列，並讓它傳回依賴 Excel 和我們 hello 預測值 tooExcel。</span><span class="sxs-lookup"><span data-stu-id="5ad93-225">Our business analysts rely on Excel and we needed a way toocall hello Machine Learning web service with a row of Excel data and have it return hello predicted value tooExcel.</span></span> 

<span data-ttu-id="5ad93-226">我們也想 toooptimize 我們的模型中，使用 hello 選項和 Machine Learning Studio 中可用的演算法。</span><span class="sxs-lookup"><span data-stu-id="5ad93-226">We also wanted toooptimize our model, using hello options and algorithms available in Machine Learning Studio.</span></span>

### <a name="integration-with-excel"></a><span data-ttu-id="5ad93-227">與 Excel 整合</span><span class="sxs-lookup"><span data-stu-id="5ad93-227">Integration with Excel</span></span>
<span data-ttu-id="5ad93-228">我們的解決方案是的 toooperationalize 我們的機器學習迴歸模型所建立的 web 服務從 hello 定型的模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-228">Our solution was toooperationalize our Machine Learning regression model by creating a web service from hello trained model.</span></span> <span data-ttu-id="5ad93-229">在幾分鐘的時間內建立 hello web 服務，我們可以呼叫它直接從 Excel tooreturn 營收預測的值。</span><span class="sxs-lookup"><span data-stu-id="5ad93-229">Within a few minutes, hello web service was created and we could call it directly from Excel tooreturn a predicted revenue value.</span></span> 

<span data-ttu-id="5ad93-230">hello *Web Services 儀表板*區段包括可下載的 Excel 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="5ad93-230">hello *Web Services Dashboard* section includes a downloadable Excel workbook.</span></span> <span data-ttu-id="5ad93-231">hello 活頁簿隨附預先格式化 hello web 服務應用程式開發介面和結構描述資訊內嵌。</span><span class="sxs-lookup"><span data-stu-id="5ad93-231">hello workbook comes pre-formatted with hello web service API and schema information embedded.</span></span> <span data-ttu-id="5ad93-232">當您按一下*下載 Excel 活頁簿*hello 活頁簿隨即開啟，您可以將它儲存 tooyour 本機電腦。</span><span class="sxs-lookup"><span data-stu-id="5ad93-232">When you click *Download Excel Workbook*, hello workbook opens and you can save it tooyour local computer.</span></span> 

![][1]

<span data-ttu-id="5ad93-233">與 hello 活頁簿開啟，請將預先定義的參數複製到藍色 hello 參數區段，如下所示。</span><span class="sxs-lookup"><span data-stu-id="5ad93-233">With hello workbook open, copy your predefined parameters into hello blue Parameter section as shown below.</span></span> <span data-ttu-id="5ad93-234">輸入 hello 參數，一旦 toohello 機器學習 web 服務會呼叫 Excel 而且 hello 預測計分的標籤會顯示於 hello 綠色預測值 」 一節。</span><span class="sxs-lookup"><span data-stu-id="5ad93-234">Once hello parameters are entered, Excel calls out toohello Machine Learning web service and hello predicted scored labels will display in hello green Predicted Values section.</span></span> <span data-ttu-id="5ad93-235">hello 活頁簿將會繼續 toocreate 預測參數根據定型模型的輸入參數的所有資料列項目。</span><span class="sxs-lookup"><span data-stu-id="5ad93-235">hello workbook will continue toocreate predictions for parameters based on your trained model for all row items entered under Parameters.</span></span> <span data-ttu-id="5ad93-236">如需有關如何 toouse 這項功能的詳細資訊，請參閱[取用 Azure Machine Learning Web 服務從 Excel](machine-learning-consuming-from-excel.md)。</span><span class="sxs-lookup"><span data-stu-id="5ad93-236">For more information on how toouse this feature, see [Consuming an Azure Machine Learning Web Service from Excel](machine-learning-consuming-from-excel.md).</span></span> 

![][2]

### <a name="optimization-and-further-experiments"></a><span data-ttu-id="5ad93-237">最佳化及進一步實驗</span><span class="sxs-lookup"><span data-stu-id="5ad93-237">Optimization and further experiments</span></span>
<span data-ttu-id="5ad93-238">既然我們已經基準與我們的 Excel 模型中，我們會將預先 toooptimize 移我們的機器學習線性迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-238">Now that we had a baseline with our Excel model, we moved ahead toooptimize our Machine Learning Linear Regression Model.</span></span> <span data-ttu-id="5ad93-239">我們使用 hello 模組[篩選器為基礎的特徵選取][ filter-based-feature-selection] tooimprove 我們選取初始資料元素，它可協助我們 4.6%的效能改善平均絕對誤差。</span><span class="sxs-lookup"><span data-stu-id="5ad93-239">We used hello module [Filter-Based Feature Selection][filter-based-feature-selection] tooimprove on our selection of initial data elements and it helped us achieve a performance improvement of 4.6% Mean Absolute Error.</span></span> <span data-ttu-id="5ad93-240">為未來的專案中，我們將使用這項功能可以儲存我們週在逐一查看資料屬性 toofind hello 的一組正確功能 toouse 的模型。</span><span class="sxs-lookup"><span data-stu-id="5ad93-240">For future projects we will use this feature which could save us weeks in iterating through data attributes toofind hello right set of features toouse for modelling.</span></span> 

<span data-ttu-id="5ad93-241">接下來我們計劃 tooinclude 其他演算法，例如[Bayesian] [ bayesian-linear-regression]或[促進式決策樹][ boosted-decision-tree-regression]我們實驗 toocompare 中效能。</span><span class="sxs-lookup"><span data-stu-id="5ad93-241">Next we plan tooinclude additional algorithms like [Bayesian][bayesian-linear-regression] or [Boosted Decision Trees][boosted-decision-tree-regression] in our experiment toocompare performance.</span></span> 

<span data-ttu-id="5ad93-242">如果您想與迴歸 tooexperiment，良好的資料集 tootry 是 hello 能源效率迴歸範例資料集，其中包含多個數值的屬性。</span><span class="sxs-lookup"><span data-stu-id="5ad93-242">If you want tooexperiment with regression, a good dataset tootry is hello Energy Efficiency Regression sample dataset, which has lots of numerical attributes.</span></span> <span data-ttu-id="5ad93-243">hello 資料集是依現狀 hello Machine Learning Studio 中的範例資料集的一部分。</span><span class="sxs-lookup"><span data-stu-id="5ad93-243">hello dataset is provided as part of hello sample datasets in Machine Learning Studio.</span></span> <span data-ttu-id="5ad93-244">您可以使用各種不同的學習模組 toopredict 加熱負載或冷卻負載。</span><span class="sxs-lookup"><span data-stu-id="5ad93-244">You can use a variety of learning modules toopredict either Heating Load or Cooling Load.</span></span> <span data-ttu-id="5ad93-245">hello 圖是針對 hello 電源效率的資料集預測的 hello 目標變數的冷卻負載的效能比較不同的迴歸學習：</span><span class="sxs-lookup"><span data-stu-id="5ad93-245">hello chart below is a performance comparison of different regression learns against hello Energy Efficiency dataset predicting for hello target variable Cooling Load:</span></span> 

| <span data-ttu-id="5ad93-246">模型</span><span class="sxs-lookup"><span data-stu-id="5ad93-246">Model</span></span> | <span data-ttu-id="5ad93-247">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-247">Mean Absolute Error</span></span> | <span data-ttu-id="5ad93-248">均方根誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-248">Root Mean Squared Error</span></span> | <span data-ttu-id="5ad93-249">相對絕對誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-249">Relative Absolute Error</span></span> | <span data-ttu-id="5ad93-250">相對平方誤差</span><span class="sxs-lookup"><span data-stu-id="5ad93-250">Relative Squared Error</span></span> | <span data-ttu-id="5ad93-251">決定係數</span><span class="sxs-lookup"><span data-stu-id="5ad93-251">Coefficient of Determination</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="5ad93-252">推進式決策樹</span><span class="sxs-lookup"><span data-stu-id="5ad93-252">Boosted Decision Tree</span></span> |<span data-ttu-id="5ad93-253">0.930113</span><span class="sxs-lookup"><span data-stu-id="5ad93-253">0.930113</span></span> |<span data-ttu-id="5ad93-254">1.4239</span><span class="sxs-lookup"><span data-stu-id="5ad93-254">1.4239</span></span> |<span data-ttu-id="5ad93-255">0.106647</span><span class="sxs-lookup"><span data-stu-id="5ad93-255">0.106647</span></span> |<span data-ttu-id="5ad93-256">0.021662</span><span class="sxs-lookup"><span data-stu-id="5ad93-256">0.021662</span></span> |<span data-ttu-id="5ad93-257">0.978338</span><span class="sxs-lookup"><span data-stu-id="5ad93-257">0.978338</span></span> |
| <span data-ttu-id="5ad93-258">線性迴歸 (梯度下降)</span><span class="sxs-lookup"><span data-stu-id="5ad93-258">Linear Regression (Gradient Descent)</span></span> |<span data-ttu-id="5ad93-259">2.035693</span><span class="sxs-lookup"><span data-stu-id="5ad93-259">2.035693</span></span> |<span data-ttu-id="5ad93-260">2.98006</span><span class="sxs-lookup"><span data-stu-id="5ad93-260">2.98006</span></span> |<span data-ttu-id="5ad93-261">0.233414</span><span class="sxs-lookup"><span data-stu-id="5ad93-261">0.233414</span></span> |<span data-ttu-id="5ad93-262">0.094881</span><span class="sxs-lookup"><span data-stu-id="5ad93-262">0.094881</span></span> |<span data-ttu-id="5ad93-263">0.905119</span><span class="sxs-lookup"><span data-stu-id="5ad93-263">0.905119</span></span> |
| <span data-ttu-id="5ad93-264">類神經網路迴歸</span><span class="sxs-lookup"><span data-stu-id="5ad93-264">Neural Network Regression</span></span> |<span data-ttu-id="5ad93-265">1.548195</span><span class="sxs-lookup"><span data-stu-id="5ad93-265">1.548195</span></span> |<span data-ttu-id="5ad93-266">2.114617</span><span class="sxs-lookup"><span data-stu-id="5ad93-266">2.114617</span></span> |<span data-ttu-id="5ad93-267">0.177517</span><span class="sxs-lookup"><span data-stu-id="5ad93-267">0.177517</span></span> |<span data-ttu-id="5ad93-268">0.047774</span><span class="sxs-lookup"><span data-stu-id="5ad93-268">0.047774</span></span> |<span data-ttu-id="5ad93-269">0.952226</span><span class="sxs-lookup"><span data-stu-id="5ad93-269">0.952226</span></span> |
| <span data-ttu-id="5ad93-270">線性迴歸 (一般最小平方)</span><span class="sxs-lookup"><span data-stu-id="5ad93-270">Linear Regression (Ordinary Least Squares)</span></span> |<span data-ttu-id="5ad93-271">1.428273</span><span class="sxs-lookup"><span data-stu-id="5ad93-271">1.428273</span></span> |<span data-ttu-id="5ad93-272">1.984461</span><span class="sxs-lookup"><span data-stu-id="5ad93-272">1.984461</span></span> |<span data-ttu-id="5ad93-273">0.163767</span><span class="sxs-lookup"><span data-stu-id="5ad93-273">0.163767</span></span> |<span data-ttu-id="5ad93-274">0.042074</span><span class="sxs-lookup"><span data-stu-id="5ad93-274">0.042074</span></span> |<span data-ttu-id="5ad93-275">0.957926</span><span class="sxs-lookup"><span data-stu-id="5ad93-275">0.957926</span></span> |

## <a name="key-takeaways"></a><span data-ttu-id="5ad93-276">重要心得</span><span class="sxs-lookup"><span data-stu-id="5ad93-276">Key Takeaways</span></span>
<span data-ttu-id="5ad93-277">我們從並行執行 Excel 迴歸和 Azure Machine Learning 實驗中學到很多。</span><span class="sxs-lookup"><span data-stu-id="5ad93-277">We learned a lot by from running Excel regression and Azure Machine Learning experiments in parallel.</span></span> <span data-ttu-id="5ad93-278">在 Excel 和比較 toomodels 使用機器學習中的建立 hello 基準模型[線性迴歸][ linear-regression]幫助我們了解 Azure Machine Learning 中，以及我們發現機會 tooimprove 資料選取項目和模型的效能。</span><span class="sxs-lookup"><span data-stu-id="5ad93-278">Creating hello baseline model in Excel and comparing it toomodels using Machine Learning [Linear Regression][linear-regression] helped us learn Azure Machine Learning, and we discovered opportunities tooimprove data selection and model performance.</span></span> 

<span data-ttu-id="5ad93-279">我們也會發現，則建議您 toouse[篩選器為基礎的特徵選取][ filter-based-feature-selection] tooaccelerate 未來的預測專案。</span><span class="sxs-lookup"><span data-stu-id="5ad93-279">We also found that it is advisable toouse [Filter-Based Feature Selection][filter-based-feature-selection] tooaccelerate future prediction projects.</span></span> <span data-ttu-id="5ad93-280">藉由套用功能選取項目 tooyour 資料，您可以建立在機器學習中改良的模型，整體效能更佳。</span><span class="sxs-lookup"><span data-stu-id="5ad93-280">By applying feature selection tooyour data, you can create an improved model in Machine Learning with better overall performance.</span></span> 

<span data-ttu-id="5ad93-281">hello 能力 tootransfer hello 預測分析 systemically 預測從 Machine Learning tooExcel 允許大幅增加在 hello 能力 toosuccessfully 中提供的結果 tooa 廣泛商務使用者對象。</span><span class="sxs-lookup"><span data-stu-id="5ad93-281">hello ability tootransfer hello predictive analytic forecasting from Machine Learning tooExcel systemically allows a significant increase in hello ability toosuccessfully provide results tooa broad business user audience.</span></span> 

## <a name="resources"></a><span data-ttu-id="5ad93-282">資源</span><span class="sxs-lookup"><span data-stu-id="5ad93-282">Resources</span></span>
<span data-ttu-id="5ad93-283">以下是一些可幫助您處理迴歸的資源：</span><span class="sxs-lookup"><span data-stu-id="5ad93-283">Here are some resources for helping you work with regression:</span></span> 

* <span data-ttu-id="5ad93-284">Excel 中的迴歸。</span><span class="sxs-lookup"><span data-stu-id="5ad93-284">Regression in Excel.</span></span> <span data-ttu-id="5ad93-285">如果您未曾使用 Excel 中的迴歸，本教學課程可讓它變得容易： [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span><span class="sxs-lookup"><span data-stu-id="5ad93-285">If you’ve never tried regression in Excel, this tutorial makes it easy: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span></span>
* <span data-ttu-id="5ad93-286">迴歸與預測。</span><span class="sxs-lookup"><span data-stu-id="5ad93-286">Regression vs forecasting.</span></span> <span data-ttu-id="5ad93-287">Tyler Chessman 撰寫部落格文章說明如何 toodo 時間序列預測在 Excel 中，其中包含的線性迴歸的良好初級開發人員描述。</span><span class="sxs-lookup"><span data-stu-id="5ad93-287">Tyler Chessman wrote a blog article explaining how toodo time series forecasting in Excel, which contains a good beginner’s description of linear regression.</span></span> [<span data-ttu-id="5ad93-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span><span class="sxs-lookup"><span data-stu-id="5ad93-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span></span>](http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts) 
* <span data-ttu-id="5ad93-289">一般最小平方線性迴歸：缺點、問題和陷阱。</span><span class="sxs-lookup"><span data-stu-id="5ad93-289">Ordinary Least Squares Linear Regression: Flaws, Problems and Pitfalls.</span></span> <span data-ttu-id="5ad93-290">迴歸的簡介和討論： [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span><span class="sxs-lookup"><span data-stu-id="5ad93-290">For an introduction and discussion of Regression: [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span></span>

[1]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png
[2]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png


<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

