---
title: "在 Machine Learning 中使用線性迴歸 | Microsoft Docs"
description: "在 Excel 和 Azure Machine Learning Studio 中的線性迴歸模型的比較"
metakeywords: 
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 417ae6ab-de4f-4bdd-957a-d96133234656
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/20/2017
ms.author: kbaroni;garye
ms.openlocfilehash: 7feb5d62415850e66f8eb7e22b9ada0d25a7058e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="using-linear-regression-in-azure-machine-learning"></a><span data-ttu-id="04440-103">在 Azure Machine Learning 中使用線性迴歸</span><span class="sxs-lookup"><span data-stu-id="04440-103">Using linear regression in Azure Machine Learning</span></span>
> <span data-ttu-id="04440-104">*Kate Baroni* 和 *Ben Boatman* 是 Microsoft 的 Data Insights Center of Excellence 的企業解決方案架構設計人員。</span><span class="sxs-lookup"><span data-stu-id="04440-104">*Kate Baroni* and *Ben Boatman* are enterprise solution architects in Microsoft’s Data Insights Center of Excellence.</span></span> <span data-ttu-id="04440-105">在本文章中，他們將說明使用 Azure Machine Learning 將現有的迴歸分析套件移轉至雲端式解決方案的經驗。</span><span class="sxs-lookup"><span data-stu-id="04440-105">In this article, they describe their experience migrating an existing regression analysis suite to a cloud-based solution using Azure Machine Learning.</span></span> 
> 
> 

&nbsp; 

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="goal"></a><span data-ttu-id="04440-106">目標</span><span class="sxs-lookup"><span data-stu-id="04440-106">Goal</span></span>
<span data-ttu-id="04440-107">我們的專案開始時有兩個目標：</span><span class="sxs-lookup"><span data-stu-id="04440-107">Our project started with two goals in mind:</span></span> 

1. <span data-ttu-id="04440-108">使用預測分析來改善我們組織每月營收預測的準確度</span><span class="sxs-lookup"><span data-stu-id="04440-108">Use predictive analytics to improve the accuracy of our organization’s monthly revenue projections</span></span> 
2. <span data-ttu-id="04440-109">使用 Azure Machine Learning 確認、最佳化、加快我們的成果的速度和規模。</span><span class="sxs-lookup"><span data-stu-id="04440-109">Use Azure Machine Learning to confirm, optimize, increase velocity, and scale of our results.</span></span> 

<span data-ttu-id="04440-110">與許多企業一樣，我們的組織會每個月都會經歷營收預測程序。</span><span class="sxs-lookup"><span data-stu-id="04440-110">Like many businesses, our organization goes through a monthly revenue forecasting process.</span></span> <span data-ttu-id="04440-111">我們的商務分析師小組被賦與使用 Azure Machine Learning 來支援程序並改善預測的準確度工作。</span><span class="sxs-lookup"><span data-stu-id="04440-111">Our small team of business analysts was tasked with using Azure Machine Learning to support the process and improve forecast accuracy.</span></span> <span data-ttu-id="04440-112">小組花費數個月收集多個來源的資料，並透過可識別與服務銷售預測相關的索引鍵屬性的統計分析，來執行資料屬性。</span><span class="sxs-lookup"><span data-stu-id="04440-112">The team spent several months collecting data from multiple sources and running the data attributes through statistical analysis identifying key attributes relevant to services sales forecasting.</span></span> <span data-ttu-id="04440-113">下一步是要開始在 Excel 中建立為資料建立統計迴歸模型的原型。</span><span class="sxs-lookup"><span data-stu-id="04440-113">The next step was to begin prototyping statistical regression models on the data in Excel.</span></span> <span data-ttu-id="04440-114">在幾週內我們便有了 Excel 迴歸模型，其效果優於目前的欄位和財務預測程序。</span><span class="sxs-lookup"><span data-stu-id="04440-114">Within a few weeks, we had an Excel regression model that was outperforming the current field and finance forecasting processes.</span></span> <span data-ttu-id="04440-115">這也成為預測結果的比較基準。</span><span class="sxs-lookup"><span data-stu-id="04440-115">This became the baseline prediction result.</span></span> 

<span data-ttu-id="04440-116">然後我們進行下一步，將我們的預測性分析移至 Azure Machine Learning 以了解 Machine Learning 如何改善預測的效能。</span><span class="sxs-lookup"><span data-stu-id="04440-116">We then took the next step to moving our predictive analytics over to Azure Machine Learning to find out how Machine Learning could improve on predictive performance.</span></span>

## <a name="achieving-predictive-performance-parity"></a><span data-ttu-id="04440-117">達成預測效能同位檢查</span><span class="sxs-lookup"><span data-stu-id="04440-117">Achieving predictive performance parity</span></span>
<span data-ttu-id="04440-118">我們的第一優先是達到 Machine Learning 和 Excel 迴歸模型之間的同位檢查。</span><span class="sxs-lookup"><span data-stu-id="04440-118">Our first priority was to achieve parity between Machine Learning and Excel regression models.</span></span> <span data-ttu-id="04440-119">對我們想要在 Excel 和 Machine Learning 之間達到預測效能同位檢查的訓練和測試資料，指定完全相同的資料，而且相同的分割。</span><span class="sxs-lookup"><span data-stu-id="04440-119">Given the same data, and the same split for training and testing data, we wanted to achieve predictive performance parity between Excel and Machine Learning.</span></span> <span data-ttu-id="04440-120">一開始我們失敗了。</span><span class="sxs-lookup"><span data-stu-id="04440-120">Initially we failed.</span></span> <span data-ttu-id="04440-121">Excel 模型的效能勝過 Machine Learning 模型。</span><span class="sxs-lookup"><span data-stu-id="04440-121">The Excel model outperformed the Machine Learning model.</span></span> <span data-ttu-id="04440-122">失敗是因為對 Machine Learning 的基礎工具設定缺乏了解。</span><span class="sxs-lookup"><span data-stu-id="04440-122">The failure was due to a lack of understanding of the base tool setting in Machine Learning.</span></span> <span data-ttu-id="04440-123">與 Machine Learning 產品團隊同步討論之後，我們對於我們的資料集需要的基礎設定獲得進一步了解，並達成兩個模型之間的同位檢查。</span><span class="sxs-lookup"><span data-stu-id="04440-123">After a sync with the Machine Learning product team, we gained a better understanding of the base setting required for our data sets, and achieved parity between the two models.</span></span> 

### <a name="create-regression-model-in-excel"></a><span data-ttu-id="04440-124">在 Excel 中建立迴歸模型</span><span class="sxs-lookup"><span data-stu-id="04440-124">Create regression model in Excel</span></span>
<span data-ttu-id="04440-125">我們的 Excel 迴歸使用可在 Excel 分析工具箱找到的標準的線性迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="04440-125">Our Excel Regression used the standard linear regression model found in the Excel Analysis ToolPak.</span></span> 

<span data-ttu-id="04440-126">我們計算 *平均絕對 %錯誤* ，並用它做為模型的效能量值。</span><span class="sxs-lookup"><span data-stu-id="04440-126">We calculated *Mean Absolute % Error* and used it as the performance measure for the model.</span></span> <span data-ttu-id="04440-127">大約花費 3 個月來達成使用 Excel 的工作模型。</span><span class="sxs-lookup"><span data-stu-id="04440-127">It took 3 months to arrive at a working model using Excel.</span></span> <span data-ttu-id="04440-128">我們將許多學習經驗帶到 Machine Learning Studio，最終有助於了解需求。</span><span class="sxs-lookup"><span data-stu-id="04440-128">We brought much of the learning into the Machine Learning Studio experiment which ultimately was beneficial in understanding requirements.</span></span>

### <a name="create-comparable-experiment-in-azure-machine-learning"></a><span data-ttu-id="04440-129">在 Azure Machine Learning 建立可比較的實驗</span><span class="sxs-lookup"><span data-stu-id="04440-129">Create comparable experiment in Azure Machine Learning</span></span>
<span data-ttu-id="04440-130">我們遵循下列步驟在 Machine Learning Studio 中建立我們的實驗：</span><span class="sxs-lookup"><span data-stu-id="04440-130">We followed these steps to create our experiment in Machine Learning Studio:</span></span> 

1. <span data-ttu-id="04440-131">將資料集以 csv 檔案的形式上傳到 Machine Learning Studio (非常小的檔案)</span><span class="sxs-lookup"><span data-stu-id="04440-131">Uploaded the dataset as a csv file to Machine Learning Studio (very small file)</span></span>
2. <span data-ttu-id="04440-132">建立新的實驗，並使用[選取資料集中的資料行][select-columns]模組來選取 Excel 中所使用的相同資料特徵</span><span class="sxs-lookup"><span data-stu-id="04440-132">Created a new experiment and used the [Select Columns in Dataset][select-columns] module to select the same data features used in Excel</span></span> 
3. <span data-ttu-id="04440-133">使用[資料分割][split]模組 (與「相對運算式」模式)，將資料分割成完全如同 Excel 中產生的相同訓練資料集</span><span class="sxs-lookup"><span data-stu-id="04440-133">Used the [Split Data][split] module (with *Relative Expression* mode) to divide the data into the same training datasets as had been done in Excel</span></span> 
4. <span data-ttu-id="04440-134">使用[線性迴歸][linear-regression]模組進行實驗 (只使用預設選項)、記載，並將結果與我們的 Excel 迴歸模型相互比較</span><span class="sxs-lookup"><span data-stu-id="04440-134">Experimented with the [Linear Regression][linear-regression] module (default options only), documented, and compared the results to our Excel regression model</span></span>

### <a name="review-initial-results"></a><span data-ttu-id="04440-135">檢閱初步結果</span><span class="sxs-lookup"><span data-stu-id="04440-135">Review initial results</span></span>
<span data-ttu-id="04440-136">一開始，Excel 模型效能明顯勝過 Machine Learning Studio 模型：</span><span class="sxs-lookup"><span data-stu-id="04440-136">At first, the Excel model clearly outperformed the Machine Learning Studio model:</span></span> 

|  | <span data-ttu-id="04440-137">Excel</span><span class="sxs-lookup"><span data-stu-id="04440-137">Excel</span></span> | <span data-ttu-id="04440-138">Studio</span><span class="sxs-lookup"><span data-stu-id="04440-138">Studio</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="04440-139">效能</span><span class="sxs-lookup"><span data-stu-id="04440-139">Performance</span></span> | | |
| <ul style="list-style-type: none;"><li><span data-ttu-id="04440-140">調整 R 平方</span><span class="sxs-lookup"><span data-stu-id="04440-140">Adjusted R Square</span></span></li></ul> |<span data-ttu-id="04440-141">0.96</span><span class="sxs-lookup"><span data-stu-id="04440-141">0.96</span></span> |<span data-ttu-id="04440-142">N/A</span><span class="sxs-lookup"><span data-stu-id="04440-142">N/A</span></span> |
| <ul style="list-style-type: none;"><li><span data-ttu-id="04440-143">決定</span><span class="sxs-lookup"><span data-stu-id="04440-143">Coefficient of</span></span> <br /><span data-ttu-id="04440-144">係數</span><span class="sxs-lookup"><span data-stu-id="04440-144">Determination</span></span></li></ul> |<span data-ttu-id="04440-145">N/A</span><span class="sxs-lookup"><span data-stu-id="04440-145">N/A</span></span> |<span data-ttu-id="04440-146">0.78</span><span class="sxs-lookup"><span data-stu-id="04440-146">0.78</span></span><br /><span data-ttu-id="04440-147">(低度精確度)</span><span class="sxs-lookup"><span data-stu-id="04440-147">(low accuracy)</span></span> |
| <span data-ttu-id="04440-148">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="04440-148">Mean Absolute Error</span></span> |<span data-ttu-id="04440-149">$9.5M</span><span class="sxs-lookup"><span data-stu-id="04440-149">$9.5M</span></span> |<span data-ttu-id="04440-150">$ 19.4M</span><span class="sxs-lookup"><span data-stu-id="04440-150">$ 19.4M</span></span> |
| <span data-ttu-id="04440-151">平均絕對誤差 (%)</span><span class="sxs-lookup"><span data-stu-id="04440-151">Mean Absolute Error (%)</span></span> |<span data-ttu-id="04440-152">6.03%</span><span class="sxs-lookup"><span data-stu-id="04440-152">6.03%</span></span> |<span data-ttu-id="04440-153">12.2%</span><span class="sxs-lookup"><span data-stu-id="04440-153">12.2%</span></span> |

<span data-ttu-id="04440-154">當我們向 Machine Learning 小組的開發人員和資料科學家執行我們的程序和結果時，他們快速提供一些實用的秘訣。</span><span class="sxs-lookup"><span data-stu-id="04440-154">When we ran our process and results by the developers and data scientists on the Machine Learning team, they quickly provided some useful tips.</span></span> 

* <span data-ttu-id="04440-155">當您在 Machine Learning Studio 中使用[線性迴歸][linear-regression]模組時，我們提供兩種方法：</span><span class="sxs-lookup"><span data-stu-id="04440-155">When you use the [Linear Regression][linear-regression] module in Machine Learning Studio, two methods are provided:</span></span>
  * <span data-ttu-id="04440-156">線上梯度下降：可能比較適合較大規模的問題</span><span class="sxs-lookup"><span data-stu-id="04440-156">Online Gradient Descent: May be more suitable for larger-scale problems</span></span>
  * <span data-ttu-id="04440-157">一般最小平方：這是大多數人聽到線性迴歸時會想到的方法。</span><span class="sxs-lookup"><span data-stu-id="04440-157">Ordinary Least Squares: This is the method most people think of when they hear linear regression.</span></span> <span data-ttu-id="04440-158">對於小型資料集，一般最小平方是較佳的選擇。</span><span class="sxs-lookup"><span data-stu-id="04440-158">For small datasets, Ordinary Least Squares can be a more optimal choice.</span></span>
* <span data-ttu-id="04440-159">考慮調整 L2 正規化加權參數，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="04440-159">Consider tweaking the L2 Regularization Weight parameter to improve performance.</span></span> <span data-ttu-id="04440-160">它預設設定為 0.001，但對我們的小型資料集，請將它設定為 0.005 以改善效能。</span><span class="sxs-lookup"><span data-stu-id="04440-160">It is set to 0.001 by default, but for our small data set we set it to 0.005 to improve performance.</span></span> 

### <a name="mystery-solved"></a><span data-ttu-id="04440-161">謎題解開了！</span><span class="sxs-lookup"><span data-stu-id="04440-161">Mystery solved!</span></span>
<span data-ttu-id="04440-162">當套用建議時，我們會在 Machine Learning Studio 中達成與 Excel 的相同基準效能：</span><span class="sxs-lookup"><span data-stu-id="04440-162">When we applied the recommendations, we achieved the same baseline performance in Machine Learning Studio as with Excel:</span></span> 

|  | <span data-ttu-id="04440-163">Excel</span><span class="sxs-lookup"><span data-stu-id="04440-163">Excel</span></span> | <span data-ttu-id="04440-164">Studio (最初)</span><span class="sxs-lookup"><span data-stu-id="04440-164">Studio (Initial)</span></span> | <span data-ttu-id="04440-165">Studio (最小平方法)</span><span class="sxs-lookup"><span data-stu-id="04440-165">Studio w/ Least Squares</span></span> |
| --- |:---:|:---:|:---:|
| <span data-ttu-id="04440-166">加上標籤的值</span><span class="sxs-lookup"><span data-stu-id="04440-166">Labeled value</span></span> |<span data-ttu-id="04440-167">實際值 (數值)</span><span class="sxs-lookup"><span data-stu-id="04440-167">Actuals (numeric)</span></span> |<span data-ttu-id="04440-168">相同</span><span class="sxs-lookup"><span data-stu-id="04440-168">same</span></span> |<span data-ttu-id="04440-169">相同</span><span class="sxs-lookup"><span data-stu-id="04440-169">same</span></span> |
| <span data-ttu-id="04440-170">學習模組</span><span class="sxs-lookup"><span data-stu-id="04440-170">Learner</span></span> |<span data-ttu-id="04440-171">Excel -> 資料分析 -> 迴歸</span><span class="sxs-lookup"><span data-stu-id="04440-171">Excel -> Data Analysis -> Regression</span></span> |<span data-ttu-id="04440-172">線性迴歸。</span><span class="sxs-lookup"><span data-stu-id="04440-172">Linear Regression.</span></span> |<span data-ttu-id="04440-173">線性迴歸</span><span class="sxs-lookup"><span data-stu-id="04440-173">Linear Regression</span></span> |
| <span data-ttu-id="04440-174">學習模組選項</span><span class="sxs-lookup"><span data-stu-id="04440-174">Learner options</span></span> |<span data-ttu-id="04440-175">N/A</span><span class="sxs-lookup"><span data-stu-id="04440-175">N/A</span></span> |<span data-ttu-id="04440-176">預設值</span><span class="sxs-lookup"><span data-stu-id="04440-176">Defaults</span></span> |<span data-ttu-id="04440-177">普通最小平方</span><span class="sxs-lookup"><span data-stu-id="04440-177">ordinary least squares</span></span><br /><span data-ttu-id="04440-178">L2 = 0.005</span><span class="sxs-lookup"><span data-stu-id="04440-178">L2 = 0.005</span></span> |
| <span data-ttu-id="04440-179">資料集</span><span class="sxs-lookup"><span data-stu-id="04440-179">Data Set</span></span> |<span data-ttu-id="04440-180">26 個資料列，3 個功能，1 個標籤。</span><span class="sxs-lookup"><span data-stu-id="04440-180">26 rows, 3 features, 1 label.</span></span> <span data-ttu-id="04440-181">全部數值。</span><span class="sxs-lookup"><span data-stu-id="04440-181">All numeric.</span></span> |<span data-ttu-id="04440-182">相同</span><span class="sxs-lookup"><span data-stu-id="04440-182">same</span></span> |<span data-ttu-id="04440-183">相同</span><span class="sxs-lookup"><span data-stu-id="04440-183">same</span></span> |
| <span data-ttu-id="04440-184">分割：訓練</span><span class="sxs-lookup"><span data-stu-id="04440-184">Split: Train</span></span> |<span data-ttu-id="04440-185">Excel 會在前 18 個資料列上訓練，在最後 8 個資料列上測試。</span><span class="sxs-lookup"><span data-stu-id="04440-185">Excel trained on the first 18 rows, tested on the last 8 rows.</span></span> |<span data-ttu-id="04440-186">相同</span><span class="sxs-lookup"><span data-stu-id="04440-186">same</span></span> |<span data-ttu-id="04440-187">相同</span><span class="sxs-lookup"><span data-stu-id="04440-187">same</span></span> |
| <span data-ttu-id="04440-188">分割：測試</span><span class="sxs-lookup"><span data-stu-id="04440-188">Split: Test</span></span> |<span data-ttu-id="04440-189">Excel 迴歸公式會套用至最後 8 個資料列</span><span class="sxs-lookup"><span data-stu-id="04440-189">Excel regression formula applied to the last 8 rows</span></span> |<span data-ttu-id="04440-190">相同</span><span class="sxs-lookup"><span data-stu-id="04440-190">same</span></span> |<span data-ttu-id="04440-191">相同</span><span class="sxs-lookup"><span data-stu-id="04440-191">same</span></span> |
| <span data-ttu-id="04440-192">**效能**</span><span class="sxs-lookup"><span data-stu-id="04440-192">**Performance**</span></span> | | | |
| <span data-ttu-id="04440-193">調整 R 平方</span><span class="sxs-lookup"><span data-stu-id="04440-193">Adjusted R Square</span></span> |<span data-ttu-id="04440-194">0.96</span><span class="sxs-lookup"><span data-stu-id="04440-194">0.96</span></span> |<span data-ttu-id="04440-195">N/A</span><span class="sxs-lookup"><span data-stu-id="04440-195">N/A</span></span> | |
| <span data-ttu-id="04440-196">決定係數</span><span class="sxs-lookup"><span data-stu-id="04440-196">Coefficient of Determination</span></span> |<span data-ttu-id="04440-197">N/A</span><span class="sxs-lookup"><span data-stu-id="04440-197">N/A</span></span> |<span data-ttu-id="04440-198">0.78</span><span class="sxs-lookup"><span data-stu-id="04440-198">0.78</span></span> |<span data-ttu-id="04440-199">0.952049</span><span class="sxs-lookup"><span data-stu-id="04440-199">0.952049</span></span> |
| <span data-ttu-id="04440-200">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="04440-200">Mean Absolute Error</span></span> |<span data-ttu-id="04440-201">$9.5M</span><span class="sxs-lookup"><span data-stu-id="04440-201">$9.5M</span></span> |<span data-ttu-id="04440-202">$ 19.4M</span><span class="sxs-lookup"><span data-stu-id="04440-202">$ 19.4M</span></span> |<span data-ttu-id="04440-203">$9.5M</span><span class="sxs-lookup"><span data-stu-id="04440-203">$9.5M</span></span> |
| <span data-ttu-id="04440-204">平均絕對誤差 (%)</span><span class="sxs-lookup"><span data-stu-id="04440-204">Mean Absolute Error (%)</span></span> |<span data-ttu-id="04440-205"><span style="background-color: 00FF00;"> 6.03%</span></span><span class="sxs-lookup"><span data-stu-id="04440-205"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |<span data-ttu-id="04440-206">12.2%</span><span class="sxs-lookup"><span data-stu-id="04440-206">12.2%</span></span> |<span data-ttu-id="04440-207"><span style="background-color: 00FF00;"> 6.03%</span></span><span class="sxs-lookup"><span data-stu-id="04440-207"><span style="background-color: 00FF00;"> 6.03%</span></span></span> |

<span data-ttu-id="04440-208">此外，Excel 係數相較與 Azure 訓練模型中的功能加權不相上下：</span><span class="sxs-lookup"><span data-stu-id="04440-208">In addition, the Excel coefficients compared well to the feature weights in the Azure trained model:</span></span>

|  | <span data-ttu-id="04440-209">Excel 係數</span><span class="sxs-lookup"><span data-stu-id="04440-209">Excel Coefficients</span></span> | <span data-ttu-id="04440-210">Azure 功能加權</span><span class="sxs-lookup"><span data-stu-id="04440-210">Azure Feature Weights</span></span> |
| --- |:---:|:---:|
| <span data-ttu-id="04440-211">截距/偏差</span><span class="sxs-lookup"><span data-stu-id="04440-211">Intercept/Bias</span></span> |<span data-ttu-id="04440-212">19470209.88</span><span class="sxs-lookup"><span data-stu-id="04440-212">19470209.88</span></span> |<span data-ttu-id="04440-213">19328500</span><span class="sxs-lookup"><span data-stu-id="04440-213">19328500</span></span> |
| <span data-ttu-id="04440-214">功能 A</span><span class="sxs-lookup"><span data-stu-id="04440-214">Feature A</span></span> |<span data-ttu-id="04440-215">0.832653063</span><span class="sxs-lookup"><span data-stu-id="04440-215">0.832653063</span></span> |<span data-ttu-id="04440-216">0.834156</span><span class="sxs-lookup"><span data-stu-id="04440-216">0.834156</span></span> |
| <span data-ttu-id="04440-217">功能 B</span><span class="sxs-lookup"><span data-stu-id="04440-217">Feature B</span></span> |<span data-ttu-id="04440-218">11071967.08</span><span class="sxs-lookup"><span data-stu-id="04440-218">11071967.08</span></span> |<span data-ttu-id="04440-219">11007300</span><span class="sxs-lookup"><span data-stu-id="04440-219">11007300</span></span> |
| <span data-ttu-id="04440-220">功能 C</span><span class="sxs-lookup"><span data-stu-id="04440-220">Feature C</span></span> |<span data-ttu-id="04440-221">25383318.09</span><span class="sxs-lookup"><span data-stu-id="04440-221">25383318.09</span></span> |<span data-ttu-id="04440-222">25140800</span><span class="sxs-lookup"><span data-stu-id="04440-222">25140800</span></span> |

## <a name="next-steps"></a><span data-ttu-id="04440-223">後續步驟</span><span class="sxs-lookup"><span data-stu-id="04440-223">Next Steps</span></span>
<span data-ttu-id="04440-224">我們想要在 Excel 內使用 Machine Learning Web 服務。</span><span class="sxs-lookup"><span data-stu-id="04440-224">We wanted to consume the Machine Learning web service within Excel.</span></span> <span data-ttu-id="04440-225">我們的商務分析師依賴 Excel，且我們需要方法來呼叫 Machine Learning Web 服務與一列 Excel 資料列，讓它將預測值傳回 Excel。</span><span class="sxs-lookup"><span data-stu-id="04440-225">Our business analysts rely on Excel and we needed a way to call the Machine Learning web service with a row of Excel data and have it return the predicted value to Excel.</span></span> 

<span data-ttu-id="04440-226">我們也想要使用 Machine Learning Studio 中可用的選項和演算法來最佳化我們的模型。</span><span class="sxs-lookup"><span data-stu-id="04440-226">We also wanted to optimize our model, using the options and algorithms available in Machine Learning Studio.</span></span>

### <a name="integration-with-excel"></a><span data-ttu-id="04440-227">與 Excel 整合</span><span class="sxs-lookup"><span data-stu-id="04440-227">Integration with Excel</span></span>
<span data-ttu-id="04440-228">我們的解決方案要使我們的 Machine Learning 迴歸模型作業化，方法是透過從訓練的模型建立 Web 服務。</span><span class="sxs-lookup"><span data-stu-id="04440-228">Our solution was to operationalize our Machine Learning regression model by creating a web service from the trained model.</span></span> <span data-ttu-id="04440-229">在幾分鐘內，Web 服務即已建立，我們可以直接從 Excel 呼叫它，以傳回預測的收入值。</span><span class="sxs-lookup"><span data-stu-id="04440-229">Within a few minutes, the web service was created and we could call it directly from Excel to return a predicted revenue value.</span></span> 

<span data-ttu-id="04440-230">*Web 服務儀表板* 一節包含可下載的 Excel 活頁簿。</span><span class="sxs-lookup"><span data-stu-id="04440-230">The *Web Services Dashboard* section includes a downloadable Excel workbook.</span></span> <span data-ttu-id="04440-231">活頁簿已使用 Web 服務 API 預先格式化並內嵌結構描述資訊。</span><span class="sxs-lookup"><span data-stu-id="04440-231">The workbook comes pre-formatted with the web service API and schema information embedded.</span></span> <span data-ttu-id="04440-232">按一下 [下載 Excel 活頁簿] 開啟活頁簿，您可以將它儲存到本機電腦。</span><span class="sxs-lookup"><span data-stu-id="04440-232">When you click *Download Excel Workbook*, the workbook opens and you can save it to your local computer.</span></span> 

![][1]

<span data-ttu-id="04440-233">在活頁簿開啟時，請將預先定義的參數複製到藍色的 Parameter 區段，如下所示。</span><span class="sxs-lookup"><span data-stu-id="04440-233">With the workbook open, copy your predefined parameters into the blue Parameter section as shown below.</span></span> <span data-ttu-id="04440-234">一旦輸入參數，Excel 即會對外呼叫 Machine Learning Web 服務，而會在綠色的預測值區段中顯示預測的計分標籤。</span><span class="sxs-lookup"><span data-stu-id="04440-234">Once the parameters are entered, Excel calls out to the Machine Learning web service and the predicted scored labels will display in the green Predicted Values section.</span></span> <span data-ttu-id="04440-235">活頁簿將會針對在 Parameters 下輸入參數下的所有資料列項目，繼續根據您的訓練模型建立預測。</span><span class="sxs-lookup"><span data-stu-id="04440-235">The workbook will continue to create predictions for parameters based on your trained model for all row items entered under Parameters.</span></span> <span data-ttu-id="04440-236">如需有關如何使用這項功能的詳細資訊，請參閱 [從 Excel 使用 Azure Machine Learning Web 服務](machine-learning-consuming-from-excel.md)。</span><span class="sxs-lookup"><span data-stu-id="04440-236">For more information on how to use this feature, see [Consuming an Azure Machine Learning Web Service from Excel](machine-learning-consuming-from-excel.md).</span></span> 

![][2]

### <a name="optimization-and-further-experiments"></a><span data-ttu-id="04440-237">最佳化及進一步實驗</span><span class="sxs-lookup"><span data-stu-id="04440-237">Optimization and further experiments</span></span>
<span data-ttu-id="04440-238">現在我們已具備 Excel 模型的基準，我們可以進行最佳化 Machine Learning 線性迴歸模型。</span><span class="sxs-lookup"><span data-stu-id="04440-238">Now that we had a baseline with our Excel model, we moved ahead to optimize our Machine Learning Linear Regression Model.</span></span> <span data-ttu-id="04440-239">我們使用[以篩選為基礎的特徵選取][filter-based-feature-selection]模組，改善我們選取的初始資料元素，有助於我們的效能提升達到平均絕對誤差 4.6%。</span><span class="sxs-lookup"><span data-stu-id="04440-239">We used the module [Filter-Based Feature Selection][filter-based-feature-selection] to improve on our selection of initial data elements and it helped us achieve a performance improvement of 4.6% Mean Absolute Error.</span></span> <span data-ttu-id="04440-240">針對未來的專案，我們將使用這項功能，它可以為逐一查看資料屬性，以找出正確的功能，用於模型化組合上，可為我們節省數週的時間。</span><span class="sxs-lookup"><span data-stu-id="04440-240">For future projects we will use this feature which could save us weeks in iterating through data attributes to find the right set of features to use for modelling.</span></span> 

<span data-ttu-id="04440-241">接下來，我們打算在實驗中納入其他演算法來比較效能，例如 [Bayesian][bayesian-linear-regression]或[推進式決策樹][boosted-decision-tree-regression]。</span><span class="sxs-lookup"><span data-stu-id="04440-241">Next we plan to include additional algorithms like [Bayesian][bayesian-linear-regression] or [Boosted Decision Trees][boosted-decision-tree-regression] in our experiment to compare performance.</span></span> 

<span data-ttu-id="04440-242">如果您想要實驗迴歸，「能量效益迴歸」範例資料集即是可用來嘗試的良好的資料集，其中包含多個數值屬性。</span><span class="sxs-lookup"><span data-stu-id="04440-242">If you want to experiment with regression, a good dataset to try is the Energy Efficiency Regression sample dataset, which has lots of numerical attributes.</span></span> <span data-ttu-id="04440-243">資料集是在 Machine Learning Studio 中的範例資料集的一部分提供。</span><span class="sxs-lookup"><span data-stu-id="04440-243">The dataset is provided as part of the sample datasets in Machine Learning Studio.</span></span> <span data-ttu-id="04440-244">您可以使用各種不同的學習模組，來預測加熱負載或冷卻負載。</span><span class="sxs-lookup"><span data-stu-id="04440-244">You can use a variety of learning modules to predict either Heating Load or Cooling Load.</span></span> <span data-ttu-id="04440-245">下列圖表是針對目標變數冷卻負載預測的能源效率資料集所學習不同的迴歸的效能比較：</span><span class="sxs-lookup"><span data-stu-id="04440-245">The chart below is a performance comparison of different regression learns against the Energy Efficiency dataset predicting for the target variable Cooling Load:</span></span> 

| <span data-ttu-id="04440-246">模型</span><span class="sxs-lookup"><span data-stu-id="04440-246">Model</span></span> | <span data-ttu-id="04440-247">平均絕對誤差</span><span class="sxs-lookup"><span data-stu-id="04440-247">Mean Absolute Error</span></span> | <span data-ttu-id="04440-248">均方根誤差</span><span class="sxs-lookup"><span data-stu-id="04440-248">Root Mean Squared Error</span></span> | <span data-ttu-id="04440-249">相對絕對誤差</span><span class="sxs-lookup"><span data-stu-id="04440-249">Relative Absolute Error</span></span> | <span data-ttu-id="04440-250">相對平方誤差</span><span class="sxs-lookup"><span data-stu-id="04440-250">Relative Squared Error</span></span> | <span data-ttu-id="04440-251">決定係數</span><span class="sxs-lookup"><span data-stu-id="04440-251">Coefficient of Determination</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="04440-252">推進式決策樹</span><span class="sxs-lookup"><span data-stu-id="04440-252">Boosted Decision Tree</span></span> |<span data-ttu-id="04440-253">0.930113</span><span class="sxs-lookup"><span data-stu-id="04440-253">0.930113</span></span> |<span data-ttu-id="04440-254">1.4239</span><span class="sxs-lookup"><span data-stu-id="04440-254">1.4239</span></span> |<span data-ttu-id="04440-255">0.106647</span><span class="sxs-lookup"><span data-stu-id="04440-255">0.106647</span></span> |<span data-ttu-id="04440-256">0.021662</span><span class="sxs-lookup"><span data-stu-id="04440-256">0.021662</span></span> |<span data-ttu-id="04440-257">0.978338</span><span class="sxs-lookup"><span data-stu-id="04440-257">0.978338</span></span> |
| <span data-ttu-id="04440-258">線性迴歸 (梯度下降)</span><span class="sxs-lookup"><span data-stu-id="04440-258">Linear Regression (Gradient Descent)</span></span> |<span data-ttu-id="04440-259">2.035693</span><span class="sxs-lookup"><span data-stu-id="04440-259">2.035693</span></span> |<span data-ttu-id="04440-260">2.98006</span><span class="sxs-lookup"><span data-stu-id="04440-260">2.98006</span></span> |<span data-ttu-id="04440-261">0.233414</span><span class="sxs-lookup"><span data-stu-id="04440-261">0.233414</span></span> |<span data-ttu-id="04440-262">0.094881</span><span class="sxs-lookup"><span data-stu-id="04440-262">0.094881</span></span> |<span data-ttu-id="04440-263">0.905119</span><span class="sxs-lookup"><span data-stu-id="04440-263">0.905119</span></span> |
| <span data-ttu-id="04440-264">類神經網路迴歸</span><span class="sxs-lookup"><span data-stu-id="04440-264">Neural Network Regression</span></span> |<span data-ttu-id="04440-265">1.548195</span><span class="sxs-lookup"><span data-stu-id="04440-265">1.548195</span></span> |<span data-ttu-id="04440-266">2.114617</span><span class="sxs-lookup"><span data-stu-id="04440-266">2.114617</span></span> |<span data-ttu-id="04440-267">0.177517</span><span class="sxs-lookup"><span data-stu-id="04440-267">0.177517</span></span> |<span data-ttu-id="04440-268">0.047774</span><span class="sxs-lookup"><span data-stu-id="04440-268">0.047774</span></span> |<span data-ttu-id="04440-269">0.952226</span><span class="sxs-lookup"><span data-stu-id="04440-269">0.952226</span></span> |
| <span data-ttu-id="04440-270">線性迴歸 (一般最小平方)</span><span class="sxs-lookup"><span data-stu-id="04440-270">Linear Regression (Ordinary Least Squares)</span></span> |<span data-ttu-id="04440-271">1.428273</span><span class="sxs-lookup"><span data-stu-id="04440-271">1.428273</span></span> |<span data-ttu-id="04440-272">1.984461</span><span class="sxs-lookup"><span data-stu-id="04440-272">1.984461</span></span> |<span data-ttu-id="04440-273">0.163767</span><span class="sxs-lookup"><span data-stu-id="04440-273">0.163767</span></span> |<span data-ttu-id="04440-274">0.042074</span><span class="sxs-lookup"><span data-stu-id="04440-274">0.042074</span></span> |<span data-ttu-id="04440-275">0.957926</span><span class="sxs-lookup"><span data-stu-id="04440-275">0.957926</span></span> |

## <a name="key-takeaways"></a><span data-ttu-id="04440-276">重要心得</span><span class="sxs-lookup"><span data-stu-id="04440-276">Key Takeaways</span></span>
<span data-ttu-id="04440-277">我們從並行執行 Excel 迴歸和 Azure Machine Learning 實驗中學到很多。</span><span class="sxs-lookup"><span data-stu-id="04440-277">We learned a lot by from running Excel regression and Azure Machine Learning experiments in parallel.</span></span> <span data-ttu-id="04440-278">我們在 Excel 中建立基準模型，並與使用 Machine Learning [線性迴歸][linear-regression]的模型相互比較，幫助我們了解 Azure Machine Learning，同時也發現有機會改善資料的選取和模型效能。</span><span class="sxs-lookup"><span data-stu-id="04440-278">Creating the baseline model in Excel and comparing it to models using Machine Learning [Linear Regression][linear-regression] helped us learn Azure Machine Learning, and we discovered opportunities to improve data selection and model performance.</span></span> 

<span data-ttu-id="04440-279">我們也發現，最好使用[以篩選為基礎的特徵選取][filter-based-feature-selection]來加速未來的預測專案。</span><span class="sxs-lookup"><span data-stu-id="04440-279">We also found that it is advisable to use [Filter-Based Feature Selection][filter-based-feature-selection] to accelerate future prediction projects.</span></span> <span data-ttu-id="04440-280">藉由將功能選取套用到您的資料，您可以在 Machine Learning 中建立改良的模型，以獲得更好的整體效能。</span><span class="sxs-lookup"><span data-stu-id="04440-280">By applying feature selection to your data, you can create an improved model in Machine Learning with better overall performance.</span></span> 

<span data-ttu-id="04440-281">能夠從 Machine Learning 傳送預測性的分析預測至 Excel，可大幅增加將結果成功提供給廣泛商業使用者對象的能力。</span><span class="sxs-lookup"><span data-stu-id="04440-281">The ability to transfer the predictive analytic forecasting from Machine Learning to Excel systemically allows a significant increase in the ability to successfully provide results to a broad business user audience.</span></span> 

## <a name="resources"></a><span data-ttu-id="04440-282">資源</span><span class="sxs-lookup"><span data-stu-id="04440-282">Resources</span></span>
<span data-ttu-id="04440-283">以下是一些可幫助您處理迴歸的資源：</span><span class="sxs-lookup"><span data-stu-id="04440-283">Here are some resources for helping you work with regression:</span></span> 

* <span data-ttu-id="04440-284">Excel 中的迴歸。</span><span class="sxs-lookup"><span data-stu-id="04440-284">Regression in Excel.</span></span> <span data-ttu-id="04440-285">如果您未曾使用 Excel 中的迴歸，本教學課程可讓它變得容易： [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span><span class="sxs-lookup"><span data-stu-id="04440-285">If you’ve never tried regression in Excel, this tutorial makes it easy: [http://www.excel-easy.com/examples/regression.html](http://www.excel-easy.com/examples/regression.html)</span></span>
* <span data-ttu-id="04440-286">迴歸與預測。</span><span class="sxs-lookup"><span data-stu-id="04440-286">Regression vs forecasting.</span></span> <span data-ttu-id="04440-287">Tyler Chessman 撰寫部落格文章，說明如何在 Excel 中執行時間序列預測，其中包含初學者適用的良好線性迴歸描述。</span><span class="sxs-lookup"><span data-stu-id="04440-287">Tyler Chessman wrote a blog article explaining how to do time series forecasting in Excel, which contains a good beginner’s description of linear regression.</span></span> [<span data-ttu-id="04440-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span><span class="sxs-lookup"><span data-stu-id="04440-288">http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts</span></span>](http://sqlmag.com/sql-server-analysis-services/understanding-time-series-forecasting-concepts) 
* <span data-ttu-id="04440-289">一般最小平方線性迴歸：缺點、問題和陷阱。</span><span class="sxs-lookup"><span data-stu-id="04440-289">Ordinary Least Squares Linear Regression: Flaws, Problems and Pitfalls.</span></span> <span data-ttu-id="04440-290">迴歸的簡介和討論： [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span><span class="sxs-lookup"><span data-stu-id="04440-290">For an introduction and discussion of Regression: [http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](http://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/)</span></span>

[1]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png
[2]: ./media/machine-learning-linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png


<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

