---
title: "在 Azure Machine Learning 中使用內部部署 SQL Server | Microsoft Docs"
description: "使用來自內部部署 SQL Server 資料庫的資料，利用 Azure Machine Learning 執行進階分析。"
services: machine-learning
documentationcenter: 
author: garyericson
manager: jhubbard
editor: cgronlun
ms.assetid: 08e4610d-02b6-4071-aad7-a2340ad8e2ea
ms.service: machine-learning
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/13/2017
ms.author: garye;krishnan
ms.openlocfilehash: ec1620be2aaf4339ba9d22540ffb2239d0678b70
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="perform-advanced-analytics-with-azure-machine-learning-using-data-from-an-on-premises-sql-server-database"></a><span data-ttu-id="b2226-103">使用來自內部部署 SQL Server 資料庫的資料，利用 Azure Machine Learning 執行進階分析</span><span class="sxs-lookup"><span data-stu-id="b2226-103">Perform advanced analytics with Azure Machine Learning using data from an on-premises SQL Server database</span></span>

[!INCLUDE [import-data-into-aml-studio-selector](../../includes/machine-learning-import-data-into-aml-studio.md)]

<span data-ttu-id="b2226-104">使用內部部署資料的企業通常會想要針對他們的機器學習服務工作負載來利用雲端的範圍和靈活度。</span><span class="sxs-lookup"><span data-stu-id="b2226-104">Often enterprises that work with on-premises data would like to take advantage of the scale and agility of the cloud for their machine learning workloads.</span></span> <span data-ttu-id="b2226-105">但是他們又不想因為將內部部署資料移至雲端而中斷目前的商務程序和工作流程。</span><span class="sxs-lookup"><span data-stu-id="b2226-105">But they don't want to disrupt their current business processes and workflows by moving their on-premises data to the cloud.</span></span> <span data-ttu-id="b2226-106">Azure Machine Learning 現在支援從內部部署 SQL Server 資料庫讀取資料，然後利用此資料，針對某個模型進行訓練與評分。</span><span class="sxs-lookup"><span data-stu-id="b2226-106">Azure Machine Learning now supports reading your data from an on-premises SQL Server database and then training and scoring a model with this data.</span></span> <span data-ttu-id="b2226-107">您不再需要手動複製和同步處理雲端與內部部署伺服器之間的資料。</span><span class="sxs-lookup"><span data-stu-id="b2226-107">You no longer have to manually copy and sync the data between the cloud and your on-premises server.</span></span> <span data-ttu-id="b2226-108">相反地，Azure Machine Learning Studio 中的 **匯入資料** 模組現在可以直接從您的內部部署 SQL Server 資料庫讀取，以進行您的訓練和評分作業。</span><span class="sxs-lookup"><span data-stu-id="b2226-108">Instead, the **Import Data** module in Azure Machine Learning Studio can now read directly from your on-premises SQL Server database for your training and scoring jobs.</span></span>

<span data-ttu-id="b2226-109">本文提供如何將內部部署 SQL Server 資料輸入至 Azure Machine Learning 的概觀。</span><span class="sxs-lookup"><span data-stu-id="b2226-109">This article provides an overview of how to ingress on-premises SQL server data into Azure Machine Learning.</span></span> <span data-ttu-id="b2226-110">它假設您已熟悉像是工作區、模組、資料集、實驗等 Azure Machine Learning 概念。</span><span class="sxs-lookup"><span data-stu-id="b2226-110">It assumes that you're familiar with Azure Machine Learning concepts like workspaces, modules, datasets, experiments, *etc.*.</span></span>

> [!NOTE]
> <span data-ttu-id="b2226-111">此功能不適用於免費的工作區。</span><span class="sxs-lookup"><span data-stu-id="b2226-111">This feature is not available for free workspaces.</span></span> <span data-ttu-id="b2226-112">如需機器學習服務定價和層級的詳細資訊，請參閱 [Azure 機器學習服務定價](https://azure.microsoft.com/pricing/details/machine-learning/)。</span><span class="sxs-lookup"><span data-stu-id="b2226-112">For more information about Machine Learning pricing and tiers, see [Azure Machine Learning Pricing](https://azure.microsoft.com/pricing/details/machine-learning/).</span></span>
>
>

<!-- -->

[!INCLUDE [machine-learning-free-trial](../../includes/machine-learning-free-trial.md)]

## <a name="install-the-microsoft-data-management-gateway"></a><span data-ttu-id="b2226-113">安裝 Microsoft 資料管理閘道器</span><span class="sxs-lookup"><span data-stu-id="b2226-113">Install the Microsoft Data Management Gateway</span></span>
<span data-ttu-id="b2226-114">若要存取 Azure Machine Learning 中的內部部署 SQL Server 資料庫，您需要下載並安裝 Microsoft 資料管理閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-114">To access an on-premises SQL Server database in Azure Machine Learning, you need to download and install the Microsoft Data Management Gateway.</span></span> <span data-ttu-id="b2226-115">當您在 Machine Learning Studio 中設定閘道器連接時，您會有機會使用 [下載並註冊資料閘道] 對話方塊來下載並安裝閘道，如下所述。</span><span class="sxs-lookup"><span data-stu-id="b2226-115">When you configure the gateway connection in Machine Learning Studio, you have the opportunity to download and install the gateway using the **Download and register data gateway** dialog described below.</span></span>

<span data-ttu-id="b2226-116">您也可以從 [Microsoft 下載中心](https://www.microsoft.com/download/details.aspx?id=39717)事先下載並執行 MSI 安裝程式套件來安裝資料管理閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-116">You also can install the Data Management Gateway ahead of time by downloading and running the MSI setup package from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=39717).</span></span>
<span data-ttu-id="b2226-117">選擇最新版本，選取電腦適用的 32 位元或 64 位元。</span><span class="sxs-lookup"><span data-stu-id="b2226-117">Choose the latest version, selecting either 32-bit or 64-bit as appropriate for your computer.</span></span> <span data-ttu-id="b2226-118">MSI 也可用來將現有的資料管理閘道器升級到最新版本，並保留所有設定。</span><span class="sxs-lookup"><span data-stu-id="b2226-118">The MSI can also be used to upgrade an existing Data Management Gateway to the latest version, with all settings preserved.</span></span>

<span data-ttu-id="b2226-119">閘道器的必要條件如下：</span><span class="sxs-lookup"><span data-stu-id="b2226-119">The gateway has the following prerequisites:</span></span>

* <span data-ttu-id="b2226-120">支援的 Windows 作業系統版本包括 Windows 7、Windows 8/8.1、Windows 10、Windows Server 2008 R2、Windows Server 2012 及 Windows Server 2012 R2。</span><span class="sxs-lookup"><span data-stu-id="b2226-120">The supported Windows operating system versions are Windows 7, Windows 8/8.1, Windows 10, Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.</span></span>
* <span data-ttu-id="b2226-121">閘道電腦的建議組態至少為 2 GHz、4 核心、8 GB RAM 和 80 GB 磁碟。</span><span class="sxs-lookup"><span data-stu-id="b2226-121">The recommended configuration for the gateway machine is at least 2 GHz, 4 cores, 8GB RAM, and 80GB disk.</span></span>
* <span data-ttu-id="b2226-122">如果主機電腦休眠，閘道不會回應資料要求。</span><span class="sxs-lookup"><span data-stu-id="b2226-122">If the host machine hibernates, the gateway won’t respond to data requests.</span></span> <span data-ttu-id="b2226-123">因此，安裝閘道之前，請先在電腦上設定適當的電源計劃。</span><span class="sxs-lookup"><span data-stu-id="b2226-123">Therefore, configure an appropriate power plan on the computer before installing the gateway.</span></span> <span data-ttu-id="b2226-124">如果電腦已設定為休眠，安裝閘道時會顯示訊息。</span><span class="sxs-lookup"><span data-stu-id="b2226-124">If the machine is configured to hibernate, the gateway installation displays a message.</span></span>
* <span data-ttu-id="b2226-125">由於複製活動會以特定的頻率發生，因此，電腦上的資源使用量 (CPU、記憶體) 也會遵循與尖峰和閒置時間相同的模式。</span><span class="sxs-lookup"><span data-stu-id="b2226-125">Because copy activity occurs at a specific frequency, the resource usage (CPU, memory) on the machine also follows the same pattern with peak and idle times.</span></span> <span data-ttu-id="b2226-126">資源使用率也仰賴要移動的資料量。</span><span class="sxs-lookup"><span data-stu-id="b2226-126">Resource utilization also depends heavily on the amount of data being moved.</span></span> <span data-ttu-id="b2226-127">如果有多個複製作業正在進行，您將可觀察到資源使用量會在尖峰時段增加。</span><span class="sxs-lookup"><span data-stu-id="b2226-127">When multiple copy jobs are in progress, you'll observe resource usage go up during peak times.</span></span> <span data-ttu-id="b2226-128">雖然上述的基本組態在技術上來說即已足夠，但是根據資料移動的特定負載而定，您的組態最好具備比基本組態還要多的資源。</span><span class="sxs-lookup"><span data-stu-id="b2226-128">While the minimum configuration listed above is technically sufficient, you may want to have a configuration with more resources than the minimum configuration depending on your specific load for data movement.</span></span>

<span data-ttu-id="b2226-129">在設定和使用資料管理閘道時，請考慮下列內容：</span><span class="sxs-lookup"><span data-stu-id="b2226-129">Consider the following when setting up and using a Data Management Gateway:</span></span>

* <span data-ttu-id="b2226-130">單一電腦上只能安裝一個資料管理閘道器的執行個體。</span><span class="sxs-lookup"><span data-stu-id="b2226-130">You can install only one instance of Data Management Gateway on a single computer.</span></span>
* <span data-ttu-id="b2226-131">您可以針對多個內部部署資料來源使用單一閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-131">You can use a single gateway for multiple on-premises data sources.</span></span>
* <span data-ttu-id="b2226-132">您可以將不同電腦上的多個閘道器連接到相同的內部部署資料來源。</span><span class="sxs-lookup"><span data-stu-id="b2226-132">You can connect multiple gateways on different computers to the same on-premises data source.</span></span>
* <span data-ttu-id="b2226-133">您一次只能針對一個工作區設定一個閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-133">You configure a gateway for only one workspace at a time.</span></span> <span data-ttu-id="b2226-134">目前，閘道無法在工作區之間共用。</span><span class="sxs-lookup"><span data-stu-id="b2226-134">Currently, gateways can’t be shared across workspaces.</span></span>
* <span data-ttu-id="b2226-135">您可以針對單一工作區設定多個閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-135">You can configure multiple gateways for a single workspace.</span></span> <span data-ttu-id="b2226-136">例如，您可能想要使用一個閘道器，在開發期間連接到您的測試資料來源，並在準備運作之際使用生產閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-136">For example, you may want to use a gateway that's connected to your test data sources during development and a production gateway when you're ready to operationalize.</span></span>
* <span data-ttu-id="b2226-137">閘道不一定要在與資料來源相同的電腦上。</span><span class="sxs-lookup"><span data-stu-id="b2226-137">The gateway does not need to be on the same machine as the data source.</span></span> <span data-ttu-id="b2226-138">但是，愈接近資料來源，可縮短閘道連線到資料來源的時間。</span><span class="sxs-lookup"><span data-stu-id="b2226-138">But staying closer to the data source reduces the time for the gateway to connect to the data source.</span></span> <span data-ttu-id="b2226-139">建議您安裝閘道器的電腦不同於裝載內部部署資料來源的電腦，如此閘道器和資料來源才不會爭奪資源。</span><span class="sxs-lookup"><span data-stu-id="b2226-139">We recommend that you install the gateway on a machine that's different from the one that hosts the on-premises data source so that the gateway and data source don't compete for resources.</span></span>
* <span data-ttu-id="b2226-140">如果您已在電腦上安裝用於 Power BI 或 Azure Data Factory 案例的閘道器，請於另一台電腦上安裝另一個用於 Azure Machine Learning 的閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-140">If you already have a gateway installed on your computer serving Power BI or Azure Data Factory scenarios, install a separate gateway for Azure Machine Learning on another computer.</span></span>

  > [!NOTE]
  > <span data-ttu-id="b2226-141">您無法在同一台電腦上同時執行資料管理閘道器和 Power BI Gateway。</span><span class="sxs-lookup"><span data-stu-id="b2226-141">You can't run Data Management Gateway and Power BI Gateway on the same computer.</span></span>
  >
  >
* <span data-ttu-id="b2226-142">即使您針對其他資料使用 Azure ExpressRoute，還是需要針對 Azure Machine Learning 使用資料管理閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-142">You need to use the Data Management Gateway for Azure Machine Learning even if you are using Azure ExpressRoute for other data.</span></span> <span data-ttu-id="b2226-143">即使使用 ExpressRoute，您也應該將資料來源視為內部部署資料來源 (亦即在防火牆後面)。</span><span class="sxs-lookup"><span data-stu-id="b2226-143">You should treat your data source as an on-premises data source (that's behind a firewall) even when you use ExpressRoute.</span></span> <span data-ttu-id="b2226-144">使用資料管理閘道來建立 Machine Learning 和資料來源之間的連線。</span><span class="sxs-lookup"><span data-stu-id="b2226-144">Use the Data Management Gateway to establish connectivity between Machine Learning and the data source.</span></span>

<span data-ttu-id="b2226-145">您可以在[資料管理閘道](../data-factory/data-factory-data-management-gateway.md)一文中，找到安裝必要條件、安裝步驟和疑難排解秘訣的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="b2226-145">You can find detailed information on installation prerequisites, installation steps, and troubleshooting tips in the article [Data Management Gateway](../data-factory/data-factory-data-management-gateway.md).</span></span>

## <a name="span-idusing-the-data-gateway-step-by-step-walk-classanchorspan-idtoc450838866-classanchorspanspaningress-data-from-your-on-premises-sql-server-database-into-azure-machine-learning"></a><span data-ttu-id="b2226-146"><span id="using-the-data-gateway-step-by-step-walk" class="anchor"><span id="_Toc450838866" class="anchor"></span></span>將內部部署 SQL Server 資料庫的資料輸入至 Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="b2226-146"><span id="using-the-data-gateway-step-by-step-walk" class="anchor"><span id="_Toc450838866" class="anchor"></span></span>Ingress data from your on-premises SQL Server database into Azure Machine Learning</span></span>
<span data-ttu-id="b2226-147">在本逐步解說中，您將會在 Azure Machine Learning 工作區中設定資料管理閘道器、設定該閘道器，然後讀取來自內部部署 SQL Server 資料庫的資料。</span><span class="sxs-lookup"><span data-stu-id="b2226-147">In this walkthrough, you will set up a Data Management Gateway in an Azure Machine Learning workspace, configure it, and then read data from an on-premises SQL Server database.</span></span>

> [!TIP]
> <span data-ttu-id="b2226-148">開始之前，請先針對 `studio.azureml.net` 停用瀏覽器的快顯封鎖程式。</span><span class="sxs-lookup"><span data-stu-id="b2226-148">Before you start, disable your browser’s pop-up blocker for `studio.azureml.net`.</span></span> <span data-ttu-id="b2226-149">如果您使用 Google Chrome 瀏覽器，請下載並安裝數個可在 Google Chrome 線上應用程式商店 [Click Once 應用程式擴充功能](https://chrome.google.com/webstore/search/clickonce?_category=extensions)上取得的外掛程式之一。</span><span class="sxs-lookup"><span data-stu-id="b2226-149">If you're using the Google Chrome browser, download and install one of the several plug-ins available at Google Chrome WebStore [Click Once App Extension](https://chrome.google.com/webstore/search/clickonce?_category=extensions).</span></span>
>
>

### <a name="step-1-create-a-gateway"></a><span data-ttu-id="b2226-150">步驟 1：建立閘道器</span><span class="sxs-lookup"><span data-stu-id="b2226-150">Step 1: Create a gateway</span></span>
<span data-ttu-id="b2226-151">第一個步驟是建立並設定閘道器來存取您的內部部署 SQL 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b2226-151">The first step is to create and set up the gateway to access your on-premises SQL database.</span></span>

1. <span data-ttu-id="b2226-152">登入 [Azure Machine Learning  Studio](https://studio.azureml.net/Home/)，然後選取您想要使用的工作區。</span><span class="sxs-lookup"><span data-stu-id="b2226-152">Log in to [Azure Machine Learning  Studio](https://studio.azureml.net/Home/) and select the workspace  that you want to work in.</span></span>
2. <span data-ttu-id="b2226-153">按一下左側的 [設定] 刀鋒視窗，然後按一下頂端的 [資料閘道] 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="b2226-153">Click the **SETTINGS** blade on the left, and then click the **DATA  GATEWAYS** tab at the top.</span></span>
3. <span data-ttu-id="b2226-154">按一下螢幕底部的 [新增資料閘道]  。</span><span class="sxs-lookup"><span data-stu-id="b2226-154">Click **NEW DATA GATEWAY** at the bottom of the screen.</span></span>

    ![新增資料閘道](media/machine-learning-use-data-from-an-on-premises-sql-server/new-data-gateway-button.png)
4. <span data-ttu-id="b2226-156">在 [新增資料閘道] 對話方塊中，輸入 [閘道名稱] 並選擇性地新增 [描述]。</span><span class="sxs-lookup"><span data-stu-id="b2226-156">In the **New data gateway** dialog, enter the **Gateway Name** and optionally add a **Description**.</span></span> <span data-ttu-id="b2226-157">按一下右下角的箭號，以移至組態的下一個步驟。</span><span class="sxs-lookup"><span data-stu-id="b2226-157">Click the arrow on the bottom right-hand corner to go to the next step of the configuration.</span></span>

    ![輸入閘道名稱和描述](media/machine-learning-use-data-from-an-on-premises-sql-server/new-data-gateway-dialog-enter-name.png)
5. <span data-ttu-id="b2226-159">在 [下載並註冊資料閘道] 對話方塊中，將閘道註冊金鑰複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="b2226-159">In the Download and register data gateway dialog, copy the GATEWAY  REGISTRATION KEY to the clipboard.</span></span>

    ![下載並註冊資料閘道](media/machine-learning-use-data-from-an-on-premises-sql-server/download-and-register-data-gateway.png)
6. <span data-ttu-id="b2226-161"><span id="note-1" class="anchor"></span>如果您還沒有下載並安裝 Microsoft 資料管理閘道，則可按一下 [下載資料管理閘道]。</span><span class="sxs-lookup"><span data-stu-id="b2226-161"><span id="note-1" class="anchor"></span>If you have not yet downloaded and installed the Microsoft Data Management Gateway, then click **Download data management gateway**.</span></span> <span data-ttu-id="b2226-162">這會帶您前往 Microsoft 下載中心，您可以在其中選取所需的閘道器版本，然後下載並安裝它。</span><span class="sxs-lookup"><span data-stu-id="b2226-162">This takes you to the Microsoft Download Center where you can select the gateway version you need, download it, and install it.</span></span> <span data-ttu-id="b2226-163">您可以在 [利用資料管理閘道在內部部署來源和雲端之間移動資料](../data-factory/data-factory-move-data-between-onprem-and-cloud.md)一文的前幾節中，找到有關安裝必要條件、安裝步驟及疑難排解秘訣的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="b2226-163">You can find detailed information on installation prerequisites, installation steps, and troubleshooting tips in the beginning sections of the article [Move data between on-premises sources and cloud with Data Management Gateway](../data-factory/data-factory-move-data-between-onprem-and-cloud.md).</span></span>
7. <span data-ttu-id="b2226-164">安裝閘道之後，隨即開啟 [資料管理閘道組態管理員]，並顯示 [註冊閘道] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b2226-164">After the gateway is installed, the Data Management Gateway Configuration Manager will open and the **Register gateway** dialog is displayed.</span></span> <span data-ttu-id="b2226-165">貼上您複製到剪貼簿的**閘道註冊金鑰**，然後按一下 [註冊]。</span><span class="sxs-lookup"><span data-stu-id="b2226-165">Paste the **Gateway Registration Key** that you copied to the clipboard and click **Register**.</span></span>
8. <span data-ttu-id="b2226-166">如果您已經安裝閘道，請執行「資料管理閘道組態管理員」。</span><span class="sxs-lookup"><span data-stu-id="b2226-166">If you already have a gateway installed, run the Data Management Gateway Configuration Manager.</span></span> <span data-ttu-id="b2226-167">按一下 [變更金鑰]、貼上您在上一個步驟中複製到剪貼簿的**閘道註冊金鑰**，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="b2226-167">Click **Change key**, paste the **Gateway Registration Key** that you copied to the clipboard in the previous step, and click **OK**.</span></span>
9. <span data-ttu-id="b2226-168">安裝完成時，便會隨即顯示「Microsoft 資料管理閘道組態管理員」的 [註冊閘道]  對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b2226-168">When the installation is complete, the **Register gateway** dialog for Microsoft Data Management Gateway Configuration Manager is displayed.</span></span> <span data-ttu-id="b2226-169">貼上您在上一個步驟中複製到剪貼簿的「閘道註冊金鑰」，然後按一下 [註冊]。</span><span class="sxs-lookup"><span data-stu-id="b2226-169">Paste the GATEWAY REGISTRATION KEY that you copied to the clipboard in a previous step and click **Register**.</span></span>

    ![註冊閘道](media/machine-learning-use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-register-gateway.png)
10. <span data-ttu-id="b2226-171">當「Microsoft 資料管理閘道組態管理員」中的 [常用]  索引標籤中設定了下列值時，閘道組態即已完成︰</span><span class="sxs-lookup"><span data-stu-id="b2226-171">The gateway configuration is complete when the following values are set on the **Home** tab in Microsoft Data Management Gateway Configuration Manager:</span></span>

    * <span data-ttu-id="b2226-172">[閘道名稱] 和 [執行個體名稱] 設定為閘道的名稱。</span><span class="sxs-lookup"><span data-stu-id="b2226-172">**Gateway name** and **Instance name** are set to the name of   the gateway.</span></span>
    * <span data-ttu-id="b2226-173">[註冊] 設定為 [已註冊]。</span><span class="sxs-lookup"><span data-stu-id="b2226-173">**Registration** is set to **Registered**.</span></span>
    * <span data-ttu-id="b2226-174">[狀態] 設定為 [已啟動]。</span><span class="sxs-lookup"><span data-stu-id="b2226-174">**Status** is set to **Started**.</span></span>
    * <span data-ttu-id="b2226-175">底部的狀態列會顯示 [已連接到資料管理閘道雲端服務] 和一個綠色的核取記號。</span><span class="sxs-lookup"><span data-stu-id="b2226-175">The status bar at the bottom displays **Connected to Data   Management Gateway Cloud Service** along with a green   check mark.</span></span>

      ![資料管理閘道管理員](media/machine-learning-use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-registered.png)

      <span data-ttu-id="b2226-177">註冊成功時，也會更新 Azure Machine Learning Studio。</span><span class="sxs-lookup"><span data-stu-id="b2226-177">Azure Machine Learning Studio also gets updated when the registration is successful.</span></span>

    ![閘道註冊成功](media/machine-learning-use-data-from-an-on-premises-sql-server/gateway-registered.png)
11. <span data-ttu-id="b2226-179">在 [下載並註冊資料閘道]  對話方塊中，按一下核取記號以完成安裝。</span><span class="sxs-lookup"><span data-stu-id="b2226-179">In the **Download and register data gateway** dialog, click the check mark to complete the setup.</span></span> <span data-ttu-id="b2226-180">[設定]  頁面會將閘道狀態顯示為「線上」。</span><span class="sxs-lookup"><span data-stu-id="b2226-180">The **Settings** page displays the gateway status as "Online".</span></span> <span data-ttu-id="b2226-181">在右側窗格中，您將會發現狀態和其他有用的資訊。</span><span class="sxs-lookup"><span data-stu-id="b2226-181">In the right-hand pane, you'll find status and other useful information.</span></span>

    ![閘道設定](media/machine-learning-use-data-from-an-on-premises-sql-server/gateway-status.png)
12. <span data-ttu-id="b2226-183">在 [Microsoft 資料管理閘道組態管理員] 中，切換到 [憑證]  索引標籤。</span><span class="sxs-lookup"><span data-stu-id="b2226-183">In the Microsoft Data Management Gateway Configuration Manager switch to the **Certificate** tab.</span></span> <span data-ttu-id="b2226-184">此索引標籤上指定的憑證可用來加密/解密您在入口網站指定之內部部署資料存放區的認證。</span><span class="sxs-lookup"><span data-stu-id="b2226-184">The certificate specified on this tab is used to encrypt/decrypt credentials for the on-premises data store that you specify in the portal.</span></span> <span data-ttu-id="b2226-185">此憑證是預設的憑證。</span><span class="sxs-lookup"><span data-stu-id="b2226-185">This certificate is the default certificate.</span></span> <span data-ttu-id="b2226-186">Microsoft 建議將此憑證變更為您自己在憑證管理系統中備份的憑證。</span><span class="sxs-lookup"><span data-stu-id="b2226-186">Microsoft recommends changing this to your own certificate that you back up in your certificate management system.</span></span> <span data-ttu-id="b2226-187">按一下 [變更]  改為使用您自己的憑證。</span><span class="sxs-lookup"><span data-stu-id="b2226-187">Click **Change** to use your own certificate instead.</span></span>

    ![變更閘道憑證](media/machine-learning-use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-certificate.png)
13. <span data-ttu-id="b2226-189">(選擇性) 如果您想啟用詳細資訊記錄功能來為閘道問題進行疑難排解，請在 [Microsoft 資料管理閘道組態管理員] 中切換到 [診斷] 索引標籤，然後選取 [啟用詳細資訊記錄以進行疑難排解] 選項。</span><span class="sxs-lookup"><span data-stu-id="b2226-189">(optional) If you want to enable verbose logging in order to troubleshoot issues with the gateway, in the Microsoft Data Management Gateway Configuration Manager switch to the **Diagnostics** tab and check the **Enable verbose logging for troubleshooting purposes** option.</span></span> <span data-ttu-id="b2226-190">您可以在 Windows 事件檢視器中，於 [應用程式及服務記錄檔] -&gt; [資料管理閘道] 節點下方找到記錄資訊。</span><span class="sxs-lookup"><span data-stu-id="b2226-190">The logging information can be found in the Windows Event Viewer under the **Applications and Services Logs** -&gt; **Data Management Gateway** node.</span></span> <span data-ttu-id="b2226-191">您也可以使用 [診斷]  索引標籤，使用閘道來測試與內部部署資料來源的連線。</span><span class="sxs-lookup"><span data-stu-id="b2226-191">You can also use the **Diagnostics** tab to test the connection to an on-premises data source using the gateway.</span></span>

    ![啟用詳細資訊記錄](media/machine-learning-use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-verbose-logging.png)

<span data-ttu-id="b2226-193">如此即可完成 Azure Machine Learning 中的閘道設定程序。</span><span class="sxs-lookup"><span data-stu-id="b2226-193">This completes the gateway setup process in Azure Machine Learning.</span></span>
<span data-ttu-id="b2226-194">您現在可以開始使用內部部署資料。</span><span class="sxs-lookup"><span data-stu-id="b2226-194">You're now ready to use your on-premises data.</span></span>

<span data-ttu-id="b2226-195">您可以在 Studio 中針對每個工作區建立和設定多個閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-195">You can create and set up multiple gateways in Studio for each workspace.</span></span> <span data-ttu-id="b2226-196">例如，您可能想要有一個可在開發期間連接到測試資料來源的閘道器，以及另一個適用於生產資料來源的閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-196">For example, you may have a gateway that you want to connect to your test data sources during development, and a different gateway for your production data sources.</span></span> <span data-ttu-id="b2226-197">根據貴公司的環境而定，Azure Machine Learning 可讓您彈性地設定多個閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-197">Azure Machine Learning gives you the flexibility to set up multiple gateways depending upon your corporate environment.</span></span> <span data-ttu-id="b2226-198">目前您無法在工作區之間共用一個閘道器，而且單一電腦上只能安裝一個閘道器。</span><span class="sxs-lookup"><span data-stu-id="b2226-198">Currently you can’t share a gateway between workspaces and only one gateway can be installed on a single computer.</span></span> <span data-ttu-id="b2226-199">如需詳細資訊，請參閱[利用資料管理閘道在內部部署來源和雲端之間移動資料](../data-factory/data-factory-move-data-between-onprem-and-cloud.md)。</span><span class="sxs-lookup"><span data-stu-id="b2226-199">For more information, see [Move data between on-premises sources and cloud with Data Management Gateway](../data-factory/data-factory-move-data-between-onprem-and-cloud.md).</span></span>

### <a name="step-2-use-the-gateway-to-read-data-from-an-on-premises-data-source"></a><span data-ttu-id="b2226-200">步驟 2︰使用閘道器讀取來自內部部署資料來源的資料</span><span class="sxs-lookup"><span data-stu-id="b2226-200">Step 2: Use the gateway to read data from an on-premises data source</span></span>
<span data-ttu-id="b2226-201">設定閘道之後，您可以將 **匯入資料** 模組新增到會輸入來自內部部署 SQL Server 資料庫之資料的實驗。</span><span class="sxs-lookup"><span data-stu-id="b2226-201">After you set up the gateway, you can add an **Import Data** module to an experiment that inputs the data from the on-premises SQL Server database.</span></span>

1. <span data-ttu-id="b2226-202">在 Machine Learning Studio 中，選取 [實驗] 索引標籤，並按一下左下角的 [+新增]，然後選取 [空白實驗] (或從數個可用的範例實驗中選取其中一個)。</span><span class="sxs-lookup"><span data-stu-id="b2226-202">In Machine Learning Studio, select the **EXPERIMENTS** tab, click **+NEW** in the lower-left corner, and select **Blank Experiment** (or select one of several sample experiments available).</span></span>
2. <span data-ttu-id="b2226-203">找出 **匯入模型** 模組，並將它拖曳到實驗畫布。</span><span class="sxs-lookup"><span data-stu-id="b2226-203">Find and drag the **Import Data** module to the experiment canvas.</span></span>
3. <span data-ttu-id="b2226-204">按一下畫布下方的 [另存新檔]  。</span><span class="sxs-lookup"><span data-stu-id="b2226-204">Click **Save as** below the canvas.</span></span> <span data-ttu-id="b2226-205">輸入「Azure Machine Learning 內部部署 SQL Server 教學課程」做為實驗名稱，選取工作區，然後按一下 [確定]  核取記號。</span><span class="sxs-lookup"><span data-stu-id="b2226-205">Enter "Azure Machine Learning On-Premises SQL Server Tutorial" for the experiment name, select the workspace, and click the **OK** check mark.</span></span>

   ![以新名稱儲存實驗](media/machine-learning-use-data-from-an-on-premises-sql-server/experiment-save-as.png)
4. <span data-ttu-id="b2226-207">按一下 [匯入資料] 模組來選取它，並在畫布右邊的 [屬性] 窗格中，然後選取 [資料來源] 下拉式清單中的 [內部部署 SQL Database]。</span><span class="sxs-lookup"><span data-stu-id="b2226-207">Click the **Import Data** module to select it, then in the **Properties** pane to the right of the canvas, select "On-Premises SQL Database" in the **Data source** dropdown list.</span></span>
5. <span data-ttu-id="b2226-208">選取您安裝並註冊的 **資料閘道** 。</span><span class="sxs-lookup"><span data-stu-id="b2226-208">Select the **Data gateway** you installed and registered.</span></span> <span data-ttu-id="b2226-209">您可以藉由選取 [(新增資料閘道...)] 來設定其他閘道。</span><span class="sxs-lookup"><span data-stu-id="b2226-209">You can set up another gateway by selecting "(add new Data Gateway…)".</span></span>

   ![從匯入資料模組選取資料閘道](media/machine-learning-use-data-from-an-on-premises-sql-server/import-data-select-on-premises-data-source.png)
6. <span data-ttu-id="b2226-211">輸入 SQL **Database 伺服器名稱**和**資料庫名稱**，以及您想要執行的 SQL **Database 查詢**。</span><span class="sxs-lookup"><span data-stu-id="b2226-211">Enter the SQL **Database server name** and **Database name**, along with the SQL **Database query** you want to execute.</span></span>
7. <span data-ttu-id="b2226-212">按一下 [使用者名稱和密碼] 下方的 [輸入值]，然後輸入資料庫認證。</span><span class="sxs-lookup"><span data-stu-id="b2226-212">Click **Enter values** under **User name and password** and enter your database credentials.</span></span> <span data-ttu-id="b2226-213">根據您內部部署 SQL Server 的設定方式而定，您可以使用 Windows 整合式驗證或 SQL Server 驗證。</span><span class="sxs-lookup"><span data-stu-id="b2226-213">You can use Windows Integrated Authentication or SQL Server Authentication depending upon how your on-premises SQL Server is configured.</span></span>

   ![輸入資料庫認證](media/machine-learning-use-data-from-an-on-premises-sql-server/database-credentials.png)

   <span data-ttu-id="b2226-215">「需要值」訊息會變更為「已設定值」並具有綠色核取記號。</span><span class="sxs-lookup"><span data-stu-id="b2226-215">The message "values required" changes to "values set" with a green check mark.</span></span> <span data-ttu-id="b2226-216">除非資料庫資訊或密碼變更，否則您只需輸入認證一次。</span><span class="sxs-lookup"><span data-stu-id="b2226-216">You only need to enter the credentials once unless the database information or password changes.</span></span> <span data-ttu-id="b2226-217">Azure Machine Learning 會使用您在安裝閘道器來加密雲端中的認證時所提供的憑證。</span><span class="sxs-lookup"><span data-stu-id="b2226-217">Azure Machine Learning uses the certificate you provided when you installed the gateway to encrypt the credentials in the cloud.</span></span> <span data-ttu-id="b2226-218">Azure 永遠不會在沒有加密的情況下儲存內部部署認證。</span><span class="sxs-lookup"><span data-stu-id="b2226-218">Azure never stores on-premises credentials without encryption.</span></span>

   ![匯入資料模組屬性](media/machine-learning-use-data-from-an-on-premises-sql-server/import-data-properties-entered.png)
8. <span data-ttu-id="b2226-220">按一下 [執行]  來執行實驗。</span><span class="sxs-lookup"><span data-stu-id="b2226-220">Click **RUN** to run the experiment.</span></span>

<span data-ttu-id="b2226-221">實驗完成執行之後，就可以將您從資料庫匯入的資料視覺化，方法是按一下 [匯入資料] 模組的輸出連接埠，然後選取 [視覺化]。</span><span class="sxs-lookup"><span data-stu-id="b2226-221">Once the experiment finishes running, you can visualize the data you imported from the database by clicking the output port of the **Import Data** module and selecting **Visualize**.</span></span>

<span data-ttu-id="b2226-222">當實驗完成開發之後，您就能部署和操作您的模型。</span><span class="sxs-lookup"><span data-stu-id="b2226-222">Once you finish developing your experiment, you can deploy and operationalize your model.</span></span> <span data-ttu-id="b2226-223">使用批次執行服務時，將會讀取來自 **匯入資料** 模組中所設定之內部部署 SQL Server 資料庫的資料並用於計分。</span><span class="sxs-lookup"><span data-stu-id="b2226-223">Using the Batch Execution Service, data from the on-premises SQL Server database configured in the **Import Data** module will be read and used for scoring.</span></span> <span data-ttu-id="b2226-224">雖然您可以使用要求回應服務來對內部部署資料進行評分，但是 Microsoft 建議改用 [Excel 增益集](machine-learning-excel-add-in-for-web-services.md) 。</span><span class="sxs-lookup"><span data-stu-id="b2226-224">While you can use the Request Response Service for scoring on-premises data, Microsoft recommends using the [Excel Add-in](machine-learning-excel-add-in-for-web-services.md) instead.</span></span> <span data-ttu-id="b2226-225">目前不論是在您的實驗或是已發行的 Web 服務中，都不支援透過 **匯出資料** 寫入內部部署 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b2226-225">Currently, writing to an on-premises SQL Server database through **Export Data** is not supported either in your experiments or published web services.</span></span>
