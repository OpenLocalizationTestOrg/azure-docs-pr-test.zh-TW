---
title: "從自訂映像的 aaaProvision Azure Batch 集區 |Microsoft 文件"
description: "您可以建立自訂映像 tooprovision 從集區計算節點，其中包含 hello 軟體和您的應用程式所需的資料批次。 自訂映像可以有效率地 tooconfigure 計算節點 toorun 批次的工作負載。"
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/07/2017
ms.author: tamram
ms.openlocfilehash: 5cb698ee90f7d3ec9ffe69fa4dc602132c3f7569
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="use-a-custom-image-toocreate-a-pool-of-virtual-machines"></a><span data-ttu-id="f8b37-104">使用自訂映像 toocreate 虛擬機器的集區</span><span class="sxs-lookup"><span data-stu-id="f8b37-104">Use a custom image toocreate a pool of virtual machines</span></span>

<span data-ttu-id="f8b37-105">當您在 Azure 批次中建立的虛擬機器的集區時，您會指定為 hello 集區中每個計算節點提供 hello 作業系統的虛擬機器 (VM) 映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-105">When you create a pool of virtual machines in Azure Batch, you specify a virtual machine (VM) image that provides hello operating system for each compute node in hello pool.</span></span> <span data-ttu-id="f8b37-106">使用 Azure Marketplace 映像，或提供您已備妥的自訂 VHD 映像，即可建立虛擬機器的集區。</span><span class="sxs-lookup"><span data-stu-id="f8b37-106">You can create a pool of virtual machines either by using an Azure Marketplace image, or by providing a custom VHD image that you have prepared.</span></span> <span data-ttu-id="f8b37-107">當您提供的自訂映像時，您可以控制在每個運算節點會佈建的 hello 階段 hello 作業系統的設定方式。</span><span class="sxs-lookup"><span data-stu-id="f8b37-107">When you provide a custom image, you have control over how hello operating system is configured at hello time that each compute node is provisioned.</span></span> <span data-ttu-id="f8b37-108">自訂映像也可以包含應用程式和參考資料所提供的 hello 計算節點，因為它已佈建。</span><span class="sxs-lookup"><span data-stu-id="f8b37-108">Your custom image can also include applications and reference data that are available on hello compute node as soon as it is provisioned.</span></span>

<span data-ttu-id="f8b37-109">使用自訂映像可以節省時間在取得集區的計算節點準備 toorun 您批次的工作負載。</span><span class="sxs-lookup"><span data-stu-id="f8b37-109">Using a custom image can save you time in getting your pool's compute nodes ready toorun your Batch workload.</span></span> <span data-ttu-id="f8b37-110">雖然您一律可以使用 Azure Marketplace 映像，並且在每個已佈建的計算節點上安裝軟體，但相較於使用自訂映像，這種方法可能比較沒有效率。</span><span class="sxs-lookup"><span data-stu-id="f8b37-110">While you can always use an Azure Marketplace image and install software on each compute node after it has been provisioned, this approach may be less efficient than using a custom image.</span></span> 

<span data-ttu-id="f8b37-111">某些原因 toouse 自訂映像已針對您的案例包括需要：</span><span class="sxs-lookup"><span data-stu-id="f8b37-111">Some reasons toouse a custom image that is configured for your scenario include needing to:</span></span>

- <span data-ttu-id="f8b37-112">**設定 hello 作業系統 (OS)** hello 作業系統的任何特殊組態可對 hello 自訂映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-112">**Configure hello operating system (OS)** Any special configuration of hello operating system can be performed on hello custom image.</span></span> 
- <span data-ttu-id="f8b37-113">**安裝大型應用程式。**</span><span class="sxs-lookup"><span data-stu-id="f8b37-113">**Install large applications.**</span></span> <span data-ttu-id="f8b37-114">相較於在佈建完成後，在每個計算節點上安裝應用程式，在自訂映像上安裝應用程式會更有效率。</span><span class="sxs-lookup"><span data-stu-id="f8b37-114">Installing applications on a custom image is more efficient than installing them on each compute node after it is provisioned.</span></span>
- <span data-ttu-id="f8b37-115">**複製大量資料。**</span><span class="sxs-lookup"><span data-stu-id="f8b37-115">**Copy significant amounts of data.**</span></span> <span data-ttu-id="f8b37-116">如果 hello 資料複製的 toohello 自訂映像，它只需要 toobe 複製一次，而不是 tooeach 計算節點，進而節省時間與頻寬。</span><span class="sxs-lookup"><span data-stu-id="f8b37-116">If hello data is copied toohello custom image, it only needs toobe copied once, rather than tooeach compute node, saving time and bandwidth.</span></span>
- <span data-ttu-id="f8b37-117">**Hello 安裝程序期間，重新啟動 hello VM。**</span><span class="sxs-lookup"><span data-stu-id="f8b37-117">**Reboot hello VM during hello setup process.**</span></span> <span data-ttu-id="f8b37-118">正在重新啟動 hello VM 可以是費時的程序，尤其是如果您的運算節點數目。</span><span class="sxs-lookup"><span data-stu-id="f8b37-118">Rebooting hello VM can be a time-consuming process, especially if you have a number of compute nodes.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="f8b37-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="f8b37-119">Prerequisites</span></span>

- <span data-ttu-id="f8b37-120">**批次建立的帳戶與 hello 使用者訂用帳戶集區配置模式。**</span><span class="sxs-lookup"><span data-stu-id="f8b37-120">**A Batch account created with hello User Subscription pool allocation mode.**</span></span> <span data-ttu-id="f8b37-121">toouse 自訂映像 tooprovision 虛擬機器集區，建立您的 Batch 帳戶以 hello 使用者訂用帳戶[集區配置模式](batch-api-basics.md#pool-allocation-mode)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-121">toouse a custom image tooprovision Virtual Machine pools, create your Batch account with hello User Subscription [pool allocation mode](batch-api-basics.md#pool-allocation-mode).</span></span> <span data-ttu-id="f8b37-122">在此模式中，批次集區配置到 hello hello 帳戶所在的訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="f8b37-122">With this mode, Batch pools are allocated into hello subscription where hello account resides.</span></span> <span data-ttu-id="f8b37-123">請參閱 hello[帳戶](batch-api-basics.md#account)一節中[開發大規模的平行計算與批次的解決方案](batch-api-basics.md)如需設定 hello 集區配置模式下，當您建立批次帳戶資訊。</span><span class="sxs-lookup"><span data-stu-id="f8b37-123">See hello [Account](batch-api-basics.md#account) section in [Develop large-scale parallel compute solutions with Batch](batch-api-basics.md) for information on setting hello pool allocation mode when you create a Batch account.</span></span>

- <span data-ttu-id="f8b37-124">**Azure 儲存體帳戶**。</span><span class="sxs-lookup"><span data-stu-id="f8b37-124">**An Azure Storage account.**</span></span> <span data-ttu-id="f8b37-125">您需要標準的一般用途的 Azure 儲存體帳戶中 hello toocreate 使用自訂映像的虛擬機器的集區，相同的訂用帳戶和地區。</span><span class="sxs-lookup"><span data-stu-id="f8b37-125">toocreate a pool of virtual machines using a custom image, you need a standard, general-purpose Azure Storage account in hello same subscription and region.</span></span> <span data-ttu-id="f8b37-126">如果您從 Azure VM 中建立自訂映像，您將會複製 hello 映像 toohello 儲存體帳戶 hello VM 之 OS 磁碟位於何處，而且您不需要 toocreate 個別儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="f8b37-126">If you create a custom image from an Azure VM, then you will copy hello image toohello storage account where hello VM's OS disk resides, and you won't need toocreate a separate storage account.</span></span> 
    
## <a name="prepare-a-custom-image"></a><span data-ttu-id="f8b37-127">準備自訂映像</span><span class="sxs-lookup"><span data-stu-id="f8b37-127">Prepare a custom image</span></span>

<span data-ttu-id="f8b37-128">tooprepare 用於批次的自訂映像，您必須一般化 Linux 或 Windows 的現有安裝。</span><span class="sxs-lookup"><span data-stu-id="f8b37-128">tooprepare a custom image for use with Batch, you must generalize an existing installation of Linux or Windows.</span></span> <span data-ttu-id="f8b37-129">將作業系統安裝一般化可移除機器專屬資訊。</span><span class="sxs-lookup"><span data-stu-id="f8b37-129">Generalizing an operating system installation removes machine-specific information.</span></span> <span data-ttu-id="f8b37-130">hello 結果是可以安裝在其他電腦或 Vm 映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-130">hello result is an image that can be installed on other computers or VMs.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="f8b37-131">批次目前不支援使用 Azure 受管理的映像 tooprovision 集區。</span><span class="sxs-lookup"><span data-stu-id="f8b37-131">Batch does not currently support using Azure managed images tooprovision a pool.</span></span> <span data-ttu-id="f8b37-132">hello 自訂映像您使用的 tooprovision 集區必須儲存在 Azure 儲存體。</span><span class="sxs-lookup"><span data-stu-id="f8b37-132">hello custom image you use tooprovision a pool must be stored in Azure Storage.</span></span> 
>
> <span data-ttu-id="f8b37-133">當您準備自訂映像，請注意 hello 下列點：</span><span class="sxs-lookup"><span data-stu-id="f8b37-133">When preparing your custom image, keep in mind hello following points:</span></span>
> - <span data-ttu-id="f8b37-134">請確定該 hello 基本 OS 映像使用的 tooprovision 您批次集區並沒有任何預先安裝 Azure 擴充功能，例如 hello 自訂指令碼延伸模組。</span><span class="sxs-lookup"><span data-stu-id="f8b37-134">Ensure that hello base OS image you use tooprovision your Batch pools does not have any pre-installed Azure extensions, such as hello Custom Script extension.</span></span> <span data-ttu-id="f8b37-135">如果 hello 映像包含預先安裝的擴充功能，則 Azure 可能會遇到部署 hello VM 的問題。</span><span class="sxs-lookup"><span data-stu-id="f8b37-135">If hello image contains a pre-installed extension, Azure may encounter problems deploying hello VM.</span></span>
> - <span data-ttu-id="f8b37-136">請確定該 hello 基本 OS 映像您提供使用 hello 預設暫存磁碟機，如 hello 批次節點代理程式目前必須要有 hello 預設暫存磁碟機。</span><span class="sxs-lookup"><span data-stu-id="f8b37-136">Ensure that hello base OS image you provide uses hello default temp drive, as hello Batch node agent currently expects hello default temp drive.</span></span>
>
>

<span data-ttu-id="f8b37-137">您可以使用任何現有已備妥的 Windows 或 Linux 映像作為自訂映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-137">You can use any existing prepared Windows or Linux image as a custom image.</span></span> <span data-ttu-id="f8b37-138">例如，如果您想 toouse 本機映像，則上傳 hello 映像 tooan Azure 儲存體帳戶中的 hello 相同訂用帳戶和區域，所以您批次帳戶使用[AzCopy](../storage/storage-use-azcopy.md)或另一個上傳工具。</span><span class="sxs-lookup"><span data-stu-id="f8b37-138">For example, if you wish toouse a local image, then upload hello image tooan Azure Storage account that is in hello same subscription and region as your Batch account using [AzCopy](../storage/storage-use-azcopy.md) or another upload tool.</span></span>

<span data-ttu-id="f8b37-139">您也可以從新的或現有的 Azure VM 準備自訂映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-139">You can also prepare a custom image from a new or existing Azure VM.</span></span> <span data-ttu-id="f8b37-140">如果您要建立新的 VM，您可以使用 Azure Marketplace 映像做為 hello 基底映像自訂映像，然後加以自訂。</span><span class="sxs-lookup"><span data-stu-id="f8b37-140">If you are creating a new VM, you can use an Azure Marketplace image as hello base image for your custom image and then customize it.</span></span> <span data-ttu-id="f8b37-141">toocustomize hello 基底映像，建立 Azure VM，並加入您的應用程式或資料 tooit。</span><span class="sxs-lookup"><span data-stu-id="f8b37-141">toocustomize hello base image, create an Azure VM and add your applications or data tooit.</span></span> <span data-ttu-id="f8b37-142">然後一般化 hello VM tooserve 與自訂映像，並將它儲存 tooAzure 儲存體。</span><span class="sxs-lookup"><span data-stu-id="f8b37-142">Then generalize hello VM tooserve as your custom image and save it tooAzure Storage.</span></span> 

<span data-ttu-id="f8b37-143">tooprepare 自訂映像從 Azure VM，請遵循下列步驟：</span><span class="sxs-lookup"><span data-stu-id="f8b37-143">tooprepare a custom image from an Azure VM, follow these steps:</span></span>

1. <span data-ttu-id="f8b37-144">從 Azure Marketplace 映像建立**未受管理的**的 Azure VM。</span><span class="sxs-lookup"><span data-stu-id="f8b37-144">Create an **unmanaged** Azure VM from an Azure Marketplace image.</span></span> <span data-ttu-id="f8b37-145">Azure Marketplace 包括 [Windows](../virtual-machines/windows/quick-create-portal.md) 和 [Linux](../virtual-machines/linux/quick-create-portal.md) 的映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-145">Azure Marketplace includes images for both [Windows](../virtual-machines/windows/quick-create-portal.md) and [Linux](../virtual-machines/linux/quick-create-portal.md).</span></span>
    
    <span data-ttu-id="f8b37-146">在步驟 3 中的 hello VM 建立程序，請確定您選取**否**如**存放裝置： 使用管理磁碟**選項。</span><span class="sxs-lookup"><span data-stu-id="f8b37-146">On step 3 of hello VM creation process, make sure that you select **No** for **Storage: Use Managed Disks** option.</span></span> <span data-ttu-id="f8b37-147">也請記 hello VM 之 OS 磁碟，hello 儲存體帳戶名稱做為這個儲存體帳戶也，Azure 會在其中儲存自訂映像：</span><span class="sxs-lookup"><span data-stu-id="f8b37-147">Also take note of hello storage account name for hello VM's OS disk, as this storage account is also where Azure will save your custom image:</span></span>

    ![建立未受管理的 VM 和附註 hello 儲存體帳戶名稱](media/batch-custom-images/vm-create-storage.png)
 
2. <span data-ttu-id="f8b37-149">完成建立您的 VM 的 hello 程序，並等候 toobe Azure 所配置。</span><span class="sxs-lookup"><span data-stu-id="f8b37-149">Complete hello process of creating your VM, and wait for it toobe allocated by Azure.</span></span> <span data-ttu-id="f8b37-150">以下是示範 hello hello 執行狀態中的 Azure 入口網站中的 VM 映像：</span><span class="sxs-lookup"><span data-stu-id="f8b37-150">Here's an image that shows a VM in hello Azure portal in hello running state:</span></span>

    ![從市集映像建立 VM](media/batch-custom-images/vm-status-running.png)

3. <span data-ttu-id="f8b37-152">Hello VM 開始執行之後，連接 tooit 透過 （適用於 Windows) 的 RDP 或 SSH （適用於 Linux)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-152">Once hello VM is running, connect tooit via RDP (for Windows) or SSH (for Linux).</span></span> <span data-ttu-id="f8b37-153">安裝任何必要的軟體，或複製所需的資料，並再一般化 hello VM。</span><span class="sxs-lookup"><span data-stu-id="f8b37-153">Install any necessary software or copy desired data, and then generalize hello VM.</span></span> <span data-ttu-id="f8b37-154">中所述步驟 hello[一般化 hello VM](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized.md#generalize-the-vm)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-154">Follow hello steps described in [Generalize hello VM](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized.md#generalize-the-vm).</span></span> 
   
4. <span data-ttu-id="f8b37-155">請依照下列步驟 hello 太[登入 tooAzure PowerShell](../virtual-machines/windows/sa-copy-generalized.md#log-in-to-azure-powershell)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-155">Follow hello steps too[Log in tooAzure PowerShell](../virtual-machines/windows/sa-copy-generalized.md#log-in-to-azure-powershell).</span></span> <span data-ttu-id="f8b37-156">tooinstall Azure PowerShell，請參閱[Azure PowerShell 概觀](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.2.0)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-156">tooinstall Azure PowerShell, see [Overview of Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.2.0).</span></span> 

5. <span data-ttu-id="f8b37-157">接下來，請依照下列步驟 hello 太[Deallocate hello VM 和集 hello 狀態 toogeneralized](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized#deallocate-the-vm-and-set-the-state-to-generalized)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-157">Next, follow hello steps too[Deallocate hello VM and set hello state toogeneralized](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized#deallocate-the-vm-and-set-the-state-to-generalized).</span></span> 

    <span data-ttu-id="f8b37-158">在 hello Azure 入口網站，請注意該 VM 解除配置的 hello:</span><span class="sxs-lookup"><span data-stu-id="f8b37-158">In hello Azure portal, notice that hello VM is deallocated:</span></span>

    ![請確認 VM 解除配置該 hello](media/batch-custom-images/vm-status-deallocated.png)

6.  <span data-ttu-id="f8b37-160">建立並儲存 hello VM 映像 tooAzure 儲存體使用 hello[儲存 AzureRmVMImage](https://docs.microsoft.com/powershell/module/azurerm.compute/save-azurermvmimage) PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="f8b37-160">Create and save hello VM image tooAzure Storage using hello [Save-AzureRmVMImage](https://docs.microsoft.com/powershell/module/azurerm.compute/save-azurermvmimage) PowerShell cmdlet.</span></span> <span data-ttu-id="f8b37-161">請依照下列所述的 hello 指示[建立 hello 圖像](../virtual-machines/windows/sa-copy-generalized.md#create-the-image)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-161">Follow hello instructions described in [Create hello image](../virtual-machines/windows/sa-copy-generalized.md#create-the-image).</span></span>
    
    <span data-ttu-id="f8b37-162">hello VM 映像會儲存 toohello Azure 儲存體帳戶建立 hello VM 建立時，這個程序的步驟 1 所示。</span><span class="sxs-lookup"><span data-stu-id="f8b37-162">hello VM image is saved toohello Azure Storage account created when hello VM was created, as shown in step 1 of this procedure.</span></span> <span data-ttu-id="f8b37-163">hello 儲存 AzureRmVMImage cmdlet 會將儲存 hello 映像 toohello**系統**該儲存體帳戶中的容器。</span><span class="sxs-lookup"><span data-stu-id="f8b37-163">hello Save-AzureRmVMImage cmdlet saves hello image toohello **system** container in that storage account.</span></span> <span data-ttu-id="f8b37-164">hello`-DestinationContainername`參數名稱的虛擬目錄內 hello**系統**容器。</span><span class="sxs-lookup"><span data-stu-id="f8b37-164">hello `-DestinationContainername` parameter names a virtual directory within hello **system** container.</span></span> <span data-ttu-id="f8b37-165">hello`-VHDNamePrefix`參數會指定 hello blob 名稱的前置詞。</span><span class="sxs-lookup"><span data-stu-id="f8b37-165">hello `-VHDNamePrefix` parameter specifies a prefix for hello blob name.</span></span> <span data-ttu-id="f8b37-166">此前置詞是預留的 toohello blob 名稱與連字號。</span><span class="sxs-lookup"><span data-stu-id="f8b37-166">This prefix is prepended toohello blob name with a hyphen.</span></span> 

    <span data-ttu-id="f8b37-167">例如，假設您呼叫 Save AzureRmVMImage 以 hello 下列參數：</span><span class="sxs-lookup"><span data-stu-id="f8b37-167">For example, suppose you call Save-AzureRmVMImage with hello following parameters:</span></span>  

        Save-AzureRmVMImage -ResourceGroupName sample-resource-group -Name vm-custom-image -DestinationContainerName batchimages -VHDNamePrefix custom -Path C:\Temp\Images\vm-custom-image.json

    <span data-ttu-id="f8b37-168">hello 產生的影像會儲存 toohello 位置和 blob 名稱，如下所示：</span><span class="sxs-lookup"><span data-stu-id="f8b37-168">hello resulting image is saved toohello location and blob name shown here:</span></span>

    ![系統容器中儲存 VHD 的位置](media/batch-custom-images/vhd-in-vm-storage-account.png)

    > [!NOTE]
    > <span data-ttu-id="f8b37-170">Azure 未受管理的 VM 會針對不同用途建立數個儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="f8b37-170">An Azure unmanaged VM creates several storage accounts for different purposes.</span></span> <span data-ttu-id="f8b37-171">如果您沒有記下 hello hello 儲存體容器名稱時 hello hello OS 磁碟 VM 已建立，然後尋找 hello 相關聯的儲存體帳戶包含 hello**系統**容器。</span><span class="sxs-lookup"><span data-stu-id="f8b37-171">If you did not note hello name of hello storage container for hello OS disk when hello VM was created, then find hello associated storage account that contains hello **system** container.</span></span> <span data-ttu-id="f8b37-172">瀏覽 hello**系統**容器 toofind hello 自訂映像使用您指定的 hello 值 hello**儲存 AzureRmVMImage**命令。</span><span class="sxs-lookup"><span data-stu-id="f8b37-172">Navigate through hello **system** container toofind hello custom image using hello values you specified for hello **Save-AzureRmVMImage** command.</span></span>

## <a name="create-a-pool-from-a-custom-image-in-hello-portal"></a><span data-ttu-id="f8b37-173">建立集區從 hello 入口網站中的自訂映像</span><span class="sxs-lookup"><span data-stu-id="f8b37-173">Create a pool from a custom image in hello portal</span></span>

<span data-ttu-id="f8b37-174">一旦您儲存自訂映像且知道它的位置之後，就可以從該映像建立 Batch 集區。</span><span class="sxs-lookup"><span data-stu-id="f8b37-174">Once you have saved your custom image and you know its location, you can create a Batch pool from that image.</span></span> <span data-ttu-id="f8b37-175">從 hello Azure 入口網站，請遵循這些步驟 toocreate 集區：</span><span class="sxs-lookup"><span data-stu-id="f8b37-175">Follow these steps toocreate a pool from hello Azure portal:</span></span>

1. <span data-ttu-id="f8b37-176">瀏覽 tooyour hello Azure 入口網站中的批次帳戶。</span><span class="sxs-lookup"><span data-stu-id="f8b37-176">Navigate tooyour Batch account in hello Azure portal.</span></span> <span data-ttu-id="f8b37-177">此帳戶必須是在 hello 相同訂用帳戶和區域，所以 hello 儲存體帳戶包含 hello 自訂映像。</span><span class="sxs-lookup"><span data-stu-id="f8b37-177">This account must be in hello same subscription and region as hello storage account containing hello custom image.</span></span> 
2. <span data-ttu-id="f8b37-178">在 hello**設定**視窗上 hello 左，請選取 hello**集區**功能表項目。</span><span class="sxs-lookup"><span data-stu-id="f8b37-178">In hello **Settings** window on hello left, select hello **Pools** menu item.</span></span>
3. <span data-ttu-id="f8b37-179">在 hello**集區**視窗中，選取 hello**新增**命令。</span><span class="sxs-lookup"><span data-stu-id="f8b37-179">In hello **Pools** window, select hello **Add** command.</span></span>
4. <span data-ttu-id="f8b37-180">在 hello**新增集區**視窗中，選取**自訂映像 (Linux/Windows)** hello 從**映像類型**下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="f8b37-180">On hello **Add Pool** window, select **Custom Image (Linux/Windows)** from hello **Image Type** dropdown.</span></span> <span data-ttu-id="f8b37-181">hello 入口網站會顯示 hello**自訂映像**選擇器。</span><span class="sxs-lookup"><span data-stu-id="f8b37-181">hello portal displays hello **Custom Image** picker.</span></span> <span data-ttu-id="f8b37-182">瀏覽 toohello 自訂映像所在的儲存體帳戶，然後選取 hello 從 hello 容器所需的 VHD。</span><span class="sxs-lookup"><span data-stu-id="f8b37-182">Navigate toohello storage account where your custom image is located, and select hello desired VHD from hello container.</span></span> 
5. <span data-ttu-id="f8b37-183">選取正確的 hello **Sku/方案發行者/**針對您自訂的 VHD。</span><span class="sxs-lookup"><span data-stu-id="f8b37-183">Select hello correct **Publisher/Offer/Sku** for your custom VHD.</span></span>
6. <span data-ttu-id="f8b37-184">指定 hello 剩餘需要設定，包括 hello**節點大小**，**目標專用的節點**，和**低優先權的節點**，以及所需的任何選擇性設定。</span><span class="sxs-lookup"><span data-stu-id="f8b37-184">Specify hello remaining required settings, including hello **Node size**, **Target dedicated nodes**, and **Low priority nodes**, as well as any desired optional settings.</span></span>

    <span data-ttu-id="f8b37-185">例如，Microsoft Windows Server Datacenter 2016 自訂映像，hello**新增集區** 視窗隨即出現，如下所示：</span><span class="sxs-lookup"><span data-stu-id="f8b37-185">For example, for a Microsoft Windows Server Datacenter 2016 custom image, hello **Add Pool** window appears as shown here:</span></span>

    ![從自訂 Windows 映像新增集區](media/batch-custom-images/add-pool-custom-image.png)
  
<span data-ttu-id="f8b37-187">toocheck 是否現有集區為基礎的自訂映像，請參閱 hello**作業系統**屬性中的 hello hello 資源摘要區段**集區**視窗。</span><span class="sxs-lookup"><span data-stu-id="f8b37-187">toocheck whether an existing pool is based on a custom image, see hello **Operating System** property in hello resource summary section of hello **Pool** window.</span></span> <span data-ttu-id="f8b37-188">如果從自訂映像已建立 hello 集區，它會設定太**自訂 VM 映像**。</span><span class="sxs-lookup"><span data-stu-id="f8b37-188">If hello pool was created from a custom image, it is set too**Custom VM Image**.</span></span>

<span data-ttu-id="f8b37-189">集區相關聯的所有自訂 Vhd 會顯示在集區 hello**屬性**視窗。</span><span class="sxs-lookup"><span data-stu-id="f8b37-189">All custom VHDs associated with a pool are displayed on hello pool's **Properties** window.</span></span>
 
## <a name="next-steps"></a><span data-ttu-id="f8b37-190">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f8b37-190">Next steps</span></span>

- <span data-ttu-id="f8b37-191">如需 Batch 的深入概觀，請參閱[使用 Batch 開發大規模的平行計算解決方案](batch-api-basics.md)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-191">For an in-depth overview of Batch, see [Develop large-scale parallel compute solutions with Batch](batch-api-basics.md).</span></span>
- <span data-ttu-id="f8b37-192">如需建立 Batch 帳戶的資訊，請參閱[的 hello Azure 入口網站來建立批次帳戶](batch-account-create-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="f8b37-192">For information about creating a Batch account, see [Create a Batch account with hello Azure portal](batch-account-create-portal.md).</span></span>
