---
title: "從自訂映像佈建 Azure Batch 集區 | Microsoft Docs"
description: "您可以從自訂映像建立 Batch 集區，以佈建含有您應用程式所需軟體與資料的計算節點。 自訂映像是設定計算節點以執行 Batch 工作負載的有效方式。"
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/07/2017
ms.author: tamram
ms.openlocfilehash: 3d655766b4f2a5efb0c8c29ffa81a89f84b3e17c
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2017
---
# <a name="use-a-custom-image-to-create-a-pool-of-virtual-machines"></a><span data-ttu-id="0f863-104">使用自訂映像來建立虛擬機器的集區</span><span class="sxs-lookup"><span data-stu-id="0f863-104">Use a custom image to create a pool of virtual machines</span></span>

<span data-ttu-id="0f863-105">當您在 Azure Batch 中建立虛擬機器的集區時，可指定虛擬機器 (VM) 映像，以提供集區中每個計算節點的作業系統。</span><span class="sxs-lookup"><span data-stu-id="0f863-105">When you create a pool of virtual machines in Azure Batch, you specify a virtual machine (VM) image that provides the operating system for each compute node in the pool.</span></span> <span data-ttu-id="0f863-106">使用 Azure Marketplace 映像，或提供您已備妥的自訂 VHD 映像，即可建立虛擬機器的集區。</span><span class="sxs-lookup"><span data-stu-id="0f863-106">You can create a pool of virtual machines either by using an Azure Marketplace image, or by providing a custom VHD image that you have prepared.</span></span> <span data-ttu-id="0f863-107">當您提供自訂映像時，您可以控制在佈建每個計算節點時的作業系統設定方式。</span><span class="sxs-lookup"><span data-stu-id="0f863-107">When you provide a custom image, you have control over how the operating system is configured at the time that each compute node is provisioned.</span></span> <span data-ttu-id="0f863-108">自訂映像也可以包含已佈建計算節點上可用的應用程式和參考資料。</span><span class="sxs-lookup"><span data-stu-id="0f863-108">Your custom image can also include applications and reference data that are available on the compute node as soon as it is provisioned.</span></span>

<span data-ttu-id="0f863-109">使用自訂映像可以節省時間，讓您集區的計算節點可立即執行 Batch 工作負載。</span><span class="sxs-lookup"><span data-stu-id="0f863-109">Using a custom image can save you time in getting your pool's compute nodes ready to run your Batch workload.</span></span> <span data-ttu-id="0f863-110">雖然您一律可以使用 Azure Marketplace 映像，並且在每個已佈建的計算節點上安裝軟體，但相較於使用自訂映像，這種方法可能比較沒有效率。</span><span class="sxs-lookup"><span data-stu-id="0f863-110">While you can always use an Azure Marketplace image and install software on each compute node after it has been provisioned, this approach may be less efficient than using a custom image.</span></span> 

<span data-ttu-id="0f863-111">若要使用針對您情節設定的自訂映像，有一些原因，包括需要：</span><span class="sxs-lookup"><span data-stu-id="0f863-111">Some reasons to use a custom image that is configured for your scenario include needing to:</span></span>

- <span data-ttu-id="0f863-112">**設定作業系統 (OS)** 可以在自訂映像上執行之作業系統的任何特別設定。</span><span class="sxs-lookup"><span data-stu-id="0f863-112">**Configure the operating system (OS)** Any special configuration of the operating system can be performed on the custom image.</span></span> 
- <span data-ttu-id="0f863-113">**安裝大型應用程式。**</span><span class="sxs-lookup"><span data-stu-id="0f863-113">**Install large applications.**</span></span> <span data-ttu-id="0f863-114">相較於在佈建完成後，在每個計算節點上安裝應用程式，在自訂映像上安裝應用程式會更有效率。</span><span class="sxs-lookup"><span data-stu-id="0f863-114">Installing applications on a custom image is more efficient than installing them on each compute node after it is provisioned.</span></span>
- <span data-ttu-id="0f863-115">**複製大量資料。**</span><span class="sxs-lookup"><span data-stu-id="0f863-115">**Copy significant amounts of data.**</span></span> <span data-ttu-id="0f863-116">如果將資料複製到自訂映像，只需要複製一次，而不需要複製到每個計算節點，從而節省時間與頻寬。</span><span class="sxs-lookup"><span data-stu-id="0f863-116">If the data is copied to the custom image, it only needs to be copied once, rather than to each compute node, saving time and bandwidth.</span></span>
- <span data-ttu-id="0f863-117">**在安裝過程中，重新啟動 VM。**</span><span class="sxs-lookup"><span data-stu-id="0f863-117">**Reboot the VM during the setup process.**</span></span> <span data-ttu-id="0f863-118">重新啟動 VM 可能是曠日耗時的流程，尤其是如果您有許多計算節點。</span><span class="sxs-lookup"><span data-stu-id="0f863-118">Rebooting the VM can be a time-consuming process, especially if you have a number of compute nodes.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="0f863-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="0f863-119">Prerequisites</span></span>

- <span data-ttu-id="0f863-120">**使用「使用者訂用帳戶」集區配置模式建立的 Batch 帳戶。**</span><span class="sxs-lookup"><span data-stu-id="0f863-120">**A Batch account created with the User Subscription pool allocation mode.**</span></span> <span data-ttu-id="0f863-121">若要使用自訂映像來佈建虛擬機器集區，請以「使用者訂用帳戶」[集區配置模式](batch-api-basics.md#pool-allocation-mode)來建立 Batch 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-121">To use a custom image to provision Virtual Machine pools, create your Batch account with the User Subscription [pool allocation mode](batch-api-basics.md#pool-allocation-mode).</span></span> <span data-ttu-id="0f863-122">使用此模式時，Batch 集區會配置到帳戶所在的訂用帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-122">With this mode, Batch pools are allocated into the subscription where the account resides.</span></span> <span data-ttu-id="0f863-123">如需有關在建立 Batch 帳戶時設定集區配置模式的資訊，請參閱[使用 Batch 開發大規模平行計算解決方案](batch-api-basics.md)中的[帳戶](batch-api-basics.md#account)一節。</span><span class="sxs-lookup"><span data-stu-id="0f863-123">See the [Account](batch-api-basics.md#account) section in [Develop large-scale parallel compute solutions with Batch](batch-api-basics.md) for information on setting the pool allocation mode when you create a Batch account.</span></span>

- <span data-ttu-id="0f863-124">**Azure 儲存體帳戶**。</span><span class="sxs-lookup"><span data-stu-id="0f863-124">**An Azure Storage account.**</span></span> <span data-ttu-id="0f863-125">若要使用自訂映像來建立虛擬機器的集區，您需要在相同訂用帳戶和區域中的標準、一般用途 Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-125">To create a pool of virtual machines using a custom image, you need a standard, general-purpose Azure Storage account in the same subscription and region.</span></span> <span data-ttu-id="0f863-126">如果您要從 Azure VM 中建立自訂映像，就要將映像複製到 VM 之 OS 磁碟所在的儲存體帳戶，且不需要建立個別的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-126">If you create a custom image from an Azure VM, then you will copy the image to the storage account where the VM's OS disk resides, and you won't need to create a separate storage account.</span></span> 
    
## <a name="prepare-a-custom-image"></a><span data-ttu-id="0f863-127">準備自訂映像</span><span class="sxs-lookup"><span data-stu-id="0f863-127">Prepare a custom image</span></span>

<span data-ttu-id="0f863-128">若要準備自訂映像以便用於 Batch，您必須將現有的 Linux 或 Windows 安裝一般化。</span><span class="sxs-lookup"><span data-stu-id="0f863-128">To prepare a custom image for use with Batch, you must generalize an existing installation of Linux or Windows.</span></span> <span data-ttu-id="0f863-129">將作業系統安裝一般化可移除機器專屬資訊。</span><span class="sxs-lookup"><span data-stu-id="0f863-129">Generalizing an operating system installation removes machine-specific information.</span></span> <span data-ttu-id="0f863-130">結果會產生可安裝在其他電腦或 VM 上的映像。</span><span class="sxs-lookup"><span data-stu-id="0f863-130">The result is an image that can be installed on other computers or VMs.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="0f863-131">Batch 目前不支援使用 Azure 管理的映像來佈建集區。</span><span class="sxs-lookup"><span data-stu-id="0f863-131">Batch does not currently support using Azure managed images to provision a pool.</span></span> <span data-ttu-id="0f863-132">您用於佈建集區的自訂映像必須儲存在 Azure 儲存體中。</span><span class="sxs-lookup"><span data-stu-id="0f863-132">The custom image you use to provision a pool must be stored in Azure Storage.</span></span> 
>
> <span data-ttu-id="0f863-133">準備您的自訂映像時，請記住下列幾點：</span><span class="sxs-lookup"><span data-stu-id="0f863-133">When preparing your custom image, keep in mind the following points:</span></span>
> - <span data-ttu-id="0f863-134">請確認您用來佈建 Batch 集區的基本 OS 映像沒有任何預先安裝的 Azure 擴充，例如自訂指令碼擴充。</span><span class="sxs-lookup"><span data-stu-id="0f863-134">Ensure that the base OS image you use to provision your Batch pools does not have any pre-installed Azure extensions, such as the Custom Script extension.</span></span> <span data-ttu-id="0f863-135">如果映像包含預先安裝的擴充，Azure 在部署 VM 時可能會遇到問題。</span><span class="sxs-lookup"><span data-stu-id="0f863-135">If the image contains a pre-installed extension, Azure may encounter problems deploying the VM.</span></span>
> - <span data-ttu-id="0f863-136">請確定您提供的基本 OS 映像使用預設的暫存磁碟機，因為 Batch 節點代理程式目前需要有預設的暫存磁碟機。</span><span class="sxs-lookup"><span data-stu-id="0f863-136">Ensure that the base OS image you provide uses the default temp drive, as the Batch node agent currently expects the default temp drive.</span></span>
>
>

<span data-ttu-id="0f863-137">您可以使用任何現有已備妥的 Windows 或 Linux 映像作為自訂映像。</span><span class="sxs-lookup"><span data-stu-id="0f863-137">You can use any existing prepared Windows or Linux image as a custom image.</span></span> <span data-ttu-id="0f863-138">例如，如果您需要使用本機映像，請使用 [AzCopy](../storage/storage-use-azcopy.md) 或另一個上傳工具，將映像上傳到位於相同訂用帳戶和區域中作為 Batch 帳戶的 Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-138">For example, if you wish to use a local image, then upload the image to an Azure Storage account that is in the same subscription and region as your Batch account using [AzCopy](../storage/storage-use-azcopy.md) or another upload tool.</span></span>

<span data-ttu-id="0f863-139">您也可以從新的或現有的 Azure VM 準備自訂映像。</span><span class="sxs-lookup"><span data-stu-id="0f863-139">You can also prepare a custom image from a new or existing Azure VM.</span></span> <span data-ttu-id="0f863-140">如果您要建立新的 VM，可以使用 Azure Marketplace 映像作為自訂映像的基礎映像，然後加以自訂。</span><span class="sxs-lookup"><span data-stu-id="0f863-140">If you are creating a new VM, you can use an Azure Marketplace image as the base image for your custom image and then customize it.</span></span> <span data-ttu-id="0f863-141">若要自訂基礎映像，請建立 Azure VM 並在其中新增您的應用程式或資料。</span><span class="sxs-lookup"><span data-stu-id="0f863-141">To customize the base image, create an Azure VM and add your applications or data to it.</span></span> <span data-ttu-id="0f863-142">然後將 VM 一般化以作為您的自訂映像，並將它儲存到 Azure 儲存體。</span><span class="sxs-lookup"><span data-stu-id="0f863-142">Then generalize the VM to serve as your custom image and save it to Azure Storage.</span></span> 

<span data-ttu-id="0f863-143">若要從 Azure VM 準備自訂映像，請遵循下列步驟：</span><span class="sxs-lookup"><span data-stu-id="0f863-143">To prepare a custom image from an Azure VM, follow these steps:</span></span>

1. <span data-ttu-id="0f863-144">從 Azure Marketplace 映像建立**未受管理的**的 Azure VM。</span><span class="sxs-lookup"><span data-stu-id="0f863-144">Create an **unmanaged** Azure VM from an Azure Marketplace image.</span></span> <span data-ttu-id="0f863-145">Azure Marketplace 包括 [Windows](../virtual-machines/windows/quick-create-portal.md) 和 [Linux](../virtual-machines/linux/quick-create-portal.md) 的映像。</span><span class="sxs-lookup"><span data-stu-id="0f863-145">Azure Marketplace includes images for both [Windows](../virtual-machines/windows/quick-create-portal.md) and [Linux](../virtual-machines/linux/quick-create-portal.md).</span></span>
    
    <span data-ttu-id="0f863-146">請在 VM 建立程序的步驟 3 中，確定您 [儲存體：受控磁碟] 的選項是選取 [否]。</span><span class="sxs-lookup"><span data-stu-id="0f863-146">On step 3 of the VM creation process, make sure that you select **No** for **Storage: Use Managed Disks** option.</span></span> <span data-ttu-id="0f863-147">另請記下 VM 之 OS 磁碟的儲存體帳戶名稱，因為這個儲存體帳戶也是 Azure 會在其中儲存自訂映像的位置：</span><span class="sxs-lookup"><span data-stu-id="0f863-147">Also take note of the storage account name for the VM's OS disk, as this storage account is also where Azure will save your custom image:</span></span>

    ![建立未受管理的 VM，並記下儲存體帳戶名稱](media/batch-custom-images/vm-create-storage.png)
 
2. <span data-ttu-id="0f863-149">完成您的 VM 建立程序，並等候 Azure 將它進行配置。</span><span class="sxs-lookup"><span data-stu-id="0f863-149">Complete the process of creating your VM, and wait for it to be allocated by Azure.</span></span> <span data-ttu-id="0f863-150">以下映像顯示 Azure 入口網站在執行中狀態的 VM：</span><span class="sxs-lookup"><span data-stu-id="0f863-150">Here's an image that shows a VM in the Azure portal in the running state:</span></span>

    ![從市集映像建立 VM](media/batch-custom-images/vm-status-running.png)

3. <span data-ttu-id="0f863-152">一旦 VM 開始執行之後，請透過 RDP (適用於 Windows) 或 SSH (適用於 Linux) 向它連線。</span><span class="sxs-lookup"><span data-stu-id="0f863-152">Once the VM is running, connect to it via RDP (for Windows) or SSH (for Linux).</span></span> <span data-ttu-id="0f863-153">安裝任何必要的軟體或複製所需的資料，然後將 VM 一般化。</span><span class="sxs-lookup"><span data-stu-id="0f863-153">Install any necessary software or copy desired data, and then generalize the VM.</span></span> <span data-ttu-id="0f863-154">請遵循[一般化 VM](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized.md#generalize-the-vm) 中所述的步驟操作。</span><span class="sxs-lookup"><span data-stu-id="0f863-154">Follow the steps described in [Generalize the VM](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized.md#generalize-the-vm).</span></span> 
   
4. <span data-ttu-id="0f863-155">請遵循下列步驟[登入 Azure PowerShell](../virtual-machines/windows/sa-copy-generalized.md#log-in-to-azure-powershell)。</span><span class="sxs-lookup"><span data-stu-id="0f863-155">Follow the steps to [Log in to Azure PowerShell](../virtual-machines/windows/sa-copy-generalized.md#log-in-to-azure-powershell).</span></span> <span data-ttu-id="0f863-156">若要安裝 Azure PowerShell，請參閱 [Azure PowerShell 概觀](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.2.0)。</span><span class="sxs-lookup"><span data-stu-id="0f863-156">To install Azure PowerShell, see [Overview of Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview?view=azurermps-4.2.0).</span></span> 

5. <span data-ttu-id="0f863-157">接下來，請遵循下列步驟以[解除配置 VM 並將狀態設定為一般化](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized#deallocate-the-vm-and-set-the-state-to-generalized)。</span><span class="sxs-lookup"><span data-stu-id="0f863-157">Next, follow the steps to [Deallocate the VM and set the state to generalized](https://docs.microsoft.com/en-us/azure/virtual-machines/windows/sa-copy-generalized#deallocate-the-vm-and-set-the-state-to-generalized).</span></span> 

    <span data-ttu-id="0f863-158">在 Azure 入口網站中，請注意 VM 會解除配置：</span><span class="sxs-lookup"><span data-stu-id="0f863-158">In the Azure portal, notice that the VM is deallocated:</span></span>

    ![請確認 VM 已解除配置](media/batch-custom-images/vm-status-deallocated.png)

6.  <span data-ttu-id="0f863-160">使用 [Save-AzureRmVMImage](https://docs.microsoft.com/powershell/module/azurerm.compute/save-azurermvmimage) PowerShell Cmdlet 來建立 VM 映像並加以儲存至 Azure 儲存體。</span><span class="sxs-lookup"><span data-stu-id="0f863-160">Create and save the VM image to Azure Storage using the [Save-AzureRmVMImage](https://docs.microsoft.com/powershell/module/azurerm.compute/save-azurermvmimage) PowerShell cmdlet.</span></span> <span data-ttu-id="0f863-161">請遵循[建立映像](../virtual-machines/windows/sa-copy-generalized.md#create-the-image)中所述的指示。</span><span class="sxs-lookup"><span data-stu-id="0f863-161">Follow the instructions described in [Create the image](../virtual-machines/windows/sa-copy-generalized.md#create-the-image).</span></span>
    
    <span data-ttu-id="0f863-162">VM 映像會儲存到建立 VM 時所建立的 Azure 儲存體帳戶，如這個程序的步驟 1 中所示。</span><span class="sxs-lookup"><span data-stu-id="0f863-162">The VM image is saved to the Azure Storage account created when the VM was created, as shown in step 1 of this procedure.</span></span> <span data-ttu-id="0f863-163">Save-AzureRmVMImage Cmdlet 會將映像儲存至該儲存體帳戶中的**系統**容器。</span><span class="sxs-lookup"><span data-stu-id="0f863-163">the Save-AzureRmVMImage cmdlet saves the image to the **system** container in that storage account.</span></span> <span data-ttu-id="0f863-164">`-DestinationContainername` 參數會命名**系統**容器內的虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="0f863-164">The `-DestinationContainername` parameter names a virtual directory within the **system** container.</span></span> <span data-ttu-id="0f863-165">`-VHDNamePrefix` 參數會指定 blob 名稱的前置詞。</span><span class="sxs-lookup"><span data-stu-id="0f863-165">The `-VHDNamePrefix` parameter specifies a prefix for the blob name.</span></span> <span data-ttu-id="0f863-166">blob 名稱前面會加上此前置詞並包含連字號。</span><span class="sxs-lookup"><span data-stu-id="0f863-166">This prefix is prepended to the blob name with a hyphen.</span></span> 

    <span data-ttu-id="0f863-167">例如，假設您使用下列參數呼叫 Save-AzureRmVMImage：</span><span class="sxs-lookup"><span data-stu-id="0f863-167">For example, suppose you call Save-AzureRmVMImage with the following parameters:</span></span>  

        Save-AzureRmVMImage -ResourceGroupName sample-resource-group -Name vm-custom-image -DestinationContainerName batchimages -VHDNamePrefix custom -Path C:\Temp\Images\vm-custom-image.json

    <span data-ttu-id="0f863-168">所產生的影像會儲存到位置，blob 名稱如下所示：</span><span class="sxs-lookup"><span data-stu-id="0f863-168">The resulting image is saved to the location and blob name shown here:</span></span>

    ![系統容器中儲存 VHD 的位置](media/batch-custom-images/vhd-in-vm-storage-account.png)

    > [!NOTE]
    > <span data-ttu-id="0f863-170">Azure 未受管理的 VM 會針對不同用途建立數個儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-170">An Azure unmanaged VM creates several storage accounts for different purposes.</span></span> <span data-ttu-id="0f863-171">如果建立 VM 時您沒有記下作業系統磁碟的儲存體容器名稱，就請尋找包含**系統**容器的相關聯儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-171">If you did not note the name of the storage container for the OS disk when the VM was created, then find the associated storage account that contains the **system** container.</span></span> <span data-ttu-id="0f863-172">瀏覽**系統**容器，以使用您為 **Save-AzureRmVMImage** 命令指定的值來找出自訂映像。</span><span class="sxs-lookup"><span data-stu-id="0f863-172">Navigate through the **system** container to find the custom image using the values you specified for the **Save-AzureRmVMImage** command.</span></span>

## <a name="create-a-pool-from-a-custom-image-in-the-portal"></a><span data-ttu-id="0f863-173">在 Azure 入口網站中從自訂映像建立集區</span><span class="sxs-lookup"><span data-stu-id="0f863-173">Create a pool from a custom image in the portal</span></span>

<span data-ttu-id="0f863-174">一旦您儲存自訂映像且知道它的位置之後，就可以從該映像建立 Batch 集區。</span><span class="sxs-lookup"><span data-stu-id="0f863-174">Once you have saved your custom image and you know its location, you can create a Batch pool from that image.</span></span> <span data-ttu-id="0f863-175">請遵循下列步驟，從 Azure 入口網站建立集區：</span><span class="sxs-lookup"><span data-stu-id="0f863-175">Follow these steps to create a pool from the Azure portal:</span></span>

1. <span data-ttu-id="0f863-176">在 Azure 入口網站中瀏覽至您的 Batch 帳戶。</span><span class="sxs-lookup"><span data-stu-id="0f863-176">Navigate to your Batch account in the Azure portal.</span></span> <span data-ttu-id="0f863-177">此帳戶必須與包含自訂映像的儲存體帳戶位於相同的訂用帳戶和區域中。</span><span class="sxs-lookup"><span data-stu-id="0f863-177">This account must be in the same subscription and region as the storage account containing the custom image.</span></span> 
2. <span data-ttu-id="0f863-178">在左側的 [設定] 視窗中，選取 [集區] 功能表項目。</span><span class="sxs-lookup"><span data-stu-id="0f863-178">In the **Settings** window on the left, select the **Pools** menu item.</span></span>
3. <span data-ttu-id="0f863-179">在 [集區] 視窗中，選取 [新增] 命令。</span><span class="sxs-lookup"><span data-stu-id="0f863-179">In the **Pools** window, select the **Add** command.</span></span>
4. <span data-ttu-id="0f863-180">在 [新增集區] 視窗上，從 [映像類型] 下拉式清單選取 [自訂映像 (Linux/Windows)]。</span><span class="sxs-lookup"><span data-stu-id="0f863-180">On the **Add Pool** window, select **Custom Image (Linux/Windows)** from the **Image Type** dropdown.</span></span> <span data-ttu-id="0f863-181">入口網站會顯示 [自訂映像] 選擇器。</span><span class="sxs-lookup"><span data-stu-id="0f863-181">The portal displays the **Custom Image** picker.</span></span> <span data-ttu-id="0f863-182">瀏覽至您自訂映像所在的儲存體帳戶，並從容器選取所需的 VHD。</span><span class="sxs-lookup"><span data-stu-id="0f863-182">Navigate to the storage account where your custom image is located, and select the desired VHD from the container.</span></span> 
5. <span data-ttu-id="0f863-183">針對您的自訂 VHD 選取正確的**發行者/提供項目/SKU**。</span><span class="sxs-lookup"><span data-stu-id="0f863-183">Select the correct **Publisher/Offer/Sku** for your custom VHD.</span></span>
6. <span data-ttu-id="0f863-184">指定其餘的必要設定，包括**節點大小**、**目標專用的節點**和**低優先權的節點**，以及所需的任何選擇性設定。</span><span class="sxs-lookup"><span data-stu-id="0f863-184">Specify the remaining required settings, including the **Node size**, **Target dedicated nodes**, and **Low priority nodes**, as well as any desired optional settings.</span></span>

    <span data-ttu-id="0f863-185">例如，針對 Microsoft Windows Server Datacenter 2016 自訂映像，[新增集區] 視窗隨即顯示，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0f863-185">For example, for a Microsoft Windows Server Datacenter 2016 custom image, the **Add Pool** window appears as shown here:</span></span>

    ![從自訂 Windows 映像新增集區](media/batch-custom-images/add-pool-custom-image.png)
  
<span data-ttu-id="0f863-187">若要檢查現有的集區是否以自訂映像作為基礎，請參閱 [集區] 視窗的資源摘要區段中的 **Operating System** 屬性。</span><span class="sxs-lookup"><span data-stu-id="0f863-187">To check whether an existing pool is based on a custom image, see the **Operating System** property in the resource summary section of the **Pool** window.</span></span> <span data-ttu-id="0f863-188">如果已從自訂映像建立集區，它就會設定為**自訂 VM 映像**。</span><span class="sxs-lookup"><span data-stu-id="0f863-188">If the pool was created from a custom image, it is set to **Custom VM Image**.</span></span>

<span data-ttu-id="0f863-189">與集區相關聯的所有自訂 VHD 都會顯示在集區的 [屬性] 視窗中。</span><span class="sxs-lookup"><span data-stu-id="0f863-189">All custom VHDs associated with a pool are displayed on the pool's **Properties** window.</span></span>
 
## <a name="next-steps"></a><span data-ttu-id="0f863-190">後續步驟</span><span class="sxs-lookup"><span data-stu-id="0f863-190">Next steps</span></span>

- <span data-ttu-id="0f863-191">如需 Batch 的深入概觀，請參閱[使用 Batch 開發大規模的平行計算解決方案](batch-api-basics.md)。</span><span class="sxs-lookup"><span data-stu-id="0f863-191">For an in-depth overview of Batch, see [Develop large-scale parallel compute solutions with Batch](batch-api-basics.md).</span></span>
- <span data-ttu-id="0f863-192">如需建立 Batch 帳戶的相關資訊，請參閱[使用 Azure 入口網站建立 Batch 帳戶](batch-account-create-portal.md)。</span><span class="sxs-lookup"><span data-stu-id="0f863-192">For information about creating a Batch account, see [Create a Batch account with the Azure portal](batch-account-create-portal.md).</span></span>