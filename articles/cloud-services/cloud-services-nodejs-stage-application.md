---
title: "預備雲端服務部署 (Node.js) | Microsoft Docs"
description: "了解如何將 Azure 應用程式部署至預備環境，然後使用虛擬 IP (VIP) 交換來部署至生產環境。"
services: cloud-services
documentationcenter: nodejs
author: TomArcher
manager: routlaw
editor: 
ms.assetid: d65d26a6-b424-49cd-a88c-7ef46bb112a8
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: b3000ed769e8c60eccb21e26f53ce7ccb7e68d7f
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/18/2017
---
# <a name="staging-an-application-in-azure"></a><span data-ttu-id="11f47-103">在 Azure 中預備應用程式</span><span class="sxs-lookup"><span data-stu-id="11f47-103">Staging an Application in Azure</span></span>
<span data-ttu-id="11f47-104">將封裝的應用程式移至生產環境供網際網路存取之前，可先將應用程式部署到 Azure 中的預備環境來進行測試。</span><span class="sxs-lookup"><span data-stu-id="11f47-104">A packaged application can be deployed to the staging environment in Azure to be tested before you move it to the production environment in which the application is accessible on the Internet.</span></span> <span data-ttu-id="11f47-105">預備環境與生產環境完全相同，差別在於您只能以 Azure 產生的隱藏 URL 來存取預備應用程式。</span><span class="sxs-lookup"><span data-stu-id="11f47-105">The staging environment is exactly like the production environment, except that you can only access the staged application with an obfuscated URL that is generated by Azure.</span></span> <span data-ttu-id="11f47-106">在確認應用程式可正常運作之後，就可以執行虛擬 IP (VIP) 交換將它部署至生產環境。</span><span class="sxs-lookup"><span data-stu-id="11f47-106">After you have verified that your application is working correctly, it can be deployed to the production environment by performing a Virtual IP (VIP) swap.</span></span>

> [!NOTE]
> <span data-ttu-id="11f47-107">本文中的步驟僅適用於以 Azure 雲端服務的形式受到代管的節點應用程式。</span><span class="sxs-lookup"><span data-stu-id="11f47-107">The steps in this article only apply to node applications hosted as an Azure Cloud Service.</span></span>
> 
> 

## <a name="step-1-stage-an-application"></a><span data-ttu-id="11f47-108">步驟 1：預備應用程式</span><span class="sxs-lookup"><span data-stu-id="11f47-108">Step 1: Stage an Application</span></span>
<span data-ttu-id="11f47-109">此工作涵蓋如何使用 **Microsoft Azure PowerShell**來預備應用程式。</span><span class="sxs-lookup"><span data-stu-id="11f47-109">This task covers how to stage an application by using the **Microsoft Azure PowerShell**.</span></span>

1. <span data-ttu-id="11f47-110">發佈服務時，只要將 **-Slot** 參數傳給 **Publish-AzureServiceProject** Cmdlet 即可。</span><span class="sxs-lookup"><span data-stu-id="11f47-110">When publishing a service, simply pass the **-Slot** parameter to the **Publish-AzureServiceProject** cmdlet.</span></span>
   
   ```powershell
   Publish-AzureServiceProject -Slot staging
   ```
2. <span data-ttu-id="11f47-111">登入 [Azure 傳統入口網站]，並選取 [雲端服務]。</span><span class="sxs-lookup"><span data-stu-id="11f47-111">Log on to the [Azure classic portal] and select **Cloud Services**.</span></span> <span data-ttu-id="11f47-112">當雲端服務已建立且 [預備] 欄狀態更新為 [正在執行] 之後，按一下服務名稱。</span><span class="sxs-lookup"><span data-stu-id="11f47-112">After the cloud service is created and the **Staging** column status has been updated to **Running**, click on the service name.</span></span>
   
   ![portal displaying a running service][cloud-service]
3. <span data-ttu-id="11f47-114">選取 [儀表板]，然後選取 [預備]。</span><span class="sxs-lookup"><span data-stu-id="11f47-114">Select the **Dashboard**, and then select **Staging**.</span></span>
   
   ![cloud service dashboard][cloud-service-dashboard]
4. <span data-ttu-id="11f47-116">請注意右邊的 [網站 URL]  項目中的值。</span><span class="sxs-lookup"><span data-stu-id="11f47-116">Note the value in the **Site URL** entry to the right.</span></span> <span data-ttu-id="11f47-117">DNS 名稱是 Azure 產生的隱藏內部識別碼。</span><span class="sxs-lookup"><span data-stu-id="11f47-117">The DNS name is an obfuscated internal ID that Azure generated.</span></span>
   
    ![site url][cloud-service-staging-url]

<span data-ttu-id="11f47-119">現在，您可以利用預備網站 URL，驗證應用程式在預備環境中可正常運作。</span><span class="sxs-lookup"><span data-stu-id="11f47-119">Now you can verify that the application is working correctly in the staging environment by using the staging site URL.</span></span>

## <a name="step-2-upgrade-an-application-in-production-by-swapping-vips"></a><span data-ttu-id="11f47-120">步驟 2：交換 VIP 將應用程式升級至生產環境</span><span class="sxs-lookup"><span data-stu-id="11f47-120">Step 2: Upgrade an Application in Production by Swapping VIPs</span></span>
<span data-ttu-id="11f47-121">在預備環境中驗證應用程式的升級版本之後，您可以交換預備和生產環境的虛擬 IP (VIP)，快速將應用程式移至生產環境。</span><span class="sxs-lookup"><span data-stu-id="11f47-121">After you have verified the upgraded version of an application in the staging environment, you can quickly make it available in production by swapping the virtual IPs (VIPs) of the staging and production environments.</span></span>

> [!NOTE]
> <span data-ttu-id="11f47-122">此步驟假設您已將應用程式部署至生產環境，也已預備應用程式的升級版本。</span><span class="sxs-lookup"><span data-stu-id="11f47-122">This step assumes that you have already deployed an application to production and staged the upgraded version of the application.</span></span>
> 
> 

1. <span data-ttu-id="11f47-123">登入 [Azure 傳統入口網站]，按一下 [雲端服務]，然後選取服務名稱。</span><span class="sxs-lookup"><span data-stu-id="11f47-123">Log into the [Azure classic portal], click **Cloud Services** and then select the service name.</span></span>
2. <span data-ttu-id="11f47-124">從 [儀表板] 中，選取 [預備]，然後按一下頁面底部的 [交換]。</span><span class="sxs-lookup"><span data-stu-id="11f47-124">From the **Dashboard**, select **Staging**, and then click **Swap** at the bottom of the page.</span></span> <span data-ttu-id="11f47-125">這樣會開啟 [VIP 交換] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="11f47-125">This opens the VIP Swap dialog.</span></span>
   
   ![vip swap dialog][vip-swap-dialog]
3. <span data-ttu-id="11f47-127">檢閱資訊，然後按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="11f47-127">Review the information, and then click **OK**.</span></span> <span data-ttu-id="11f47-128">兩個部署開始更新，預備部署會切換至生產環境，而生產部署會切換至預備環境。</span><span class="sxs-lookup"><span data-stu-id="11f47-128">The two deployments begin updating as the staging deployment switches to production and the production deployment switches to staging.</span></span>

<span data-ttu-id="11f47-129">您已與預備中的部署交換 IP，順利預備部署並升級生產部署。</span><span class="sxs-lookup"><span data-stu-id="11f47-129">You have successfully staged a deployment and upgraded a production deployment by swapping VIPs with the deployment in staging.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="11f47-130">其他資源</span><span class="sxs-lookup"><span data-stu-id="11f47-130">Additional Resources</span></span>
* <span data-ttu-id="11f47-131">[如何在 Azure 中交換 VIP 將服務升級部署至生產環境]</span><span class="sxs-lookup"><span data-stu-id="11f47-131">[How to Deploy a Service Upgrade to Production by Swapping VIPs in Azure]</span></span>

<span data-ttu-id="11f47-132">[Azure 傳統入口網站]: http://manage.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="11f47-132">[Azure classic portal]: http://manage.windowsazure.com</span></span>
[cloud-service]: ./media/cloud-services-nodejs-stage-application/staging-cloud-service-running.png
[cloud-service-dashboard]: ./media/cloud-services-nodejs-stage-application/cloud-service-dashboard-staging.png
[cloud-service-staging-url]: ./media/cloud-services-nodejs-stage-application/cloud-service-staging-url.png
[vip-swap-dialog]: ./media/cloud-services-nodejs-stage-application/vip-swap-dialog.png
<span data-ttu-id="11f47-133">[如何在 Azure 中交換 VIP 將服務升級部署至生產環境]: cloud-services-how-to-manage.md#how-to-swap-deployments-to-promote-a-staged-deployment-to-production</span><span class="sxs-lookup"><span data-stu-id="11f47-133">[How to Deploy a Service Upgrade to Production by Swapping VIPs in Azure]: cloud-services-how-to-manage.md#how-to-swap-deployments-to-promote-a-staged-deployment-to-production</span></span>
