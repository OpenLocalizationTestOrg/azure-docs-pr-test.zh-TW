---
title: "aaaAzure Traffic Manager 的常見問題集 |Microsoft 文件"
description: "本文提供的解答 toofrequently 常見問題關於流量管理員"
services: traffic-manager
documentationcenter: 
author: kumudd
manager: timlt
editor: 
ms.assetid: 75d5ff9a-f4b9-4b05-af32-700e7bdfea5a
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/15/2017
ms.author: kumud
ms.openlocfilehash: 5530d03b55bbf49a52002841e281e2cf5819c2b8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="traffic-manager-frequently-asked-questions-faq"></a><span data-ttu-id="cb365-103">流量管理員常見問題集 (FAQ)</span><span class="sxs-lookup"><span data-stu-id="cb365-103">Traffic Manager Frequently Asked Questions (FAQ)</span></span>

## <a name="traffic-manager-basics"></a><span data-ttu-id="cb365-104">流量管理員基本概念</span><span class="sxs-lookup"><span data-stu-id="cb365-104">Traffic Manager basics</span></span>

### <a name="what-ip-address-does-traffic-manager-use"></a><span data-ttu-id="cb365-105">「流量管理員」使用什麼 IP 位址？</span><span class="sxs-lookup"><span data-stu-id="cb365-105">What IP address does Traffic Manager use?</span></span>

<span data-ttu-id="cb365-106">中所述[Traffic Manager 的運作方式](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works)，Traffic Manager 會在 hello DNS 層級運作。</span><span class="sxs-lookup"><span data-stu-id="cb365-106">As explained in [How Traffic Manager Works](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager works at hello DNS level.</span></span> <span data-ttu-id="cb365-107">它會傳送 DNS 回應 toodirect 用戶端 toohello 適當的服務端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-107">It sends DNS responses toodirect clients toohello appropriate service endpoint.</span></span> <span data-ttu-id="cb365-108">用戶端然後 toohello 服務端點直接連接，未透過 Traffic Manager。</span><span class="sxs-lookup"><span data-stu-id="cb365-108">Clients then connect toohello service endpoint directly, not through Traffic Manager.</span></span>

<span data-ttu-id="cb365-109">因此，Traffic Manager 不針對用戶端 tooconnect 來提供端點或 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-109">Therefore, Traffic Manager does not provide an endpoint or IP address for clients tooconnect to.</span></span> <span data-ttu-id="cb365-110">因此，如果您想要您的服務靜態 IP 位址，，必須設定在 hello 服務，不在 Traffic Manager 中。</span><span class="sxs-lookup"><span data-stu-id="cb365-110">Therefore, if you want static IP address for your service, that must be configured at hello service, not in Traffic Manager.</span></span>

### <a name="does-traffic-manager-support-sticky-sessions"></a><span data-ttu-id="cb365-111">流量管理員是否支援「黏性」工作階段？</span><span class="sxs-lookup"><span data-stu-id="cb365-111">Does Traffic Manager support 'sticky' sessions?</span></span>

<span data-ttu-id="cb365-112">中所述[Traffic Manager 的運作方式](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works)，Traffic Manager 會在 hello DNS 層級運作。</span><span class="sxs-lookup"><span data-stu-id="cb365-112">As explained in [How Traffic Manager Works](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager works at hello DNS level.</span></span> <span data-ttu-id="cb365-113">它會使用 DNS 回應 toodirect 用戶端 toohello 適當的服務端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-113">It uses DNS responses toodirect clients toohello appropriate service endpoint.</span></span> <span data-ttu-id="cb365-114">用戶端連接直接，未透過 Traffic Manager toohello 服務端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-114">Clients connect toohello service endpoint directly, not through Traffic Manager.</span></span> <span data-ttu-id="cb365-115">因此，Traffic Manager 不會看到 hello HTTP hello 用戶端和伺服器之間傳輸 hello。</span><span class="sxs-lookup"><span data-stu-id="cb365-115">Therefore, Traffic Manager does not see hello HTTP traffic between hello client and hello server.</span></span>

<span data-ttu-id="cb365-116">此外，hello DNS 查詢流量管理員所收到 hello 來源 IP 位址所屬 toohello 遞迴 DNS 服務，不使用用戶端 hello。</span><span class="sxs-lookup"><span data-stu-id="cb365-116">Additionally, hello source IP address of hello DNS query received by Traffic Manager belongs toohello recursive DNS service, not hello client.</span></span> <span data-ttu-id="cb365-117">因此，Traffic Manager 沒有方式 tootrack 個別用戶端，而且無法實作 '自黏' 工作階段。</span><span class="sxs-lookup"><span data-stu-id="cb365-117">Therefore, Traffic Manager has no way tootrack individual clients and cannot implement 'sticky' sessions.</span></span> <span data-ttu-id="cb365-118">這項限制是常見 tooall DNS 為基礎的流量管理系統而非特定 tooTraffic 管理員。</span><span class="sxs-lookup"><span data-stu-id="cb365-118">This limitation is common tooall DNS-based traffic management systems and is not specific tooTraffic Manager.</span></span>

### <a name="why-am-i-seeing-an-http-error-when-using-traffic-manager"></a><span data-ttu-id="cb365-119">我在使用流量管理員時為何看到 HTTP 錯誤？</span><span class="sxs-lookup"><span data-stu-id="cb365-119">Why am I seeing an HTTP error when using Traffic Manager?</span></span>

<span data-ttu-id="cb365-120">中所述[Traffic Manager 的運作方式](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works)，Traffic Manager 會在 hello DNS 層級運作。</span><span class="sxs-lookup"><span data-stu-id="cb365-120">As explained in [How Traffic Manager Works](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager works at hello DNS level.</span></span> <span data-ttu-id="cb365-121">它會使用 DNS 回應 toodirect 用戶端 toohello 適當的服務端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-121">It uses DNS responses toodirect clients toohello appropriate service endpoint.</span></span> <span data-ttu-id="cb365-122">用戶端然後 toohello 服務端點直接連接，未透過 Traffic Manager。</span><span class="sxs-lookup"><span data-stu-id="cb365-122">Clients then connect toohello service endpoint directly, not through Traffic Manager.</span></span> <span data-ttu-id="cb365-123">流量管理員看不到用戶端與伺服器之間的 HTTP 流量。</span><span class="sxs-lookup"><span data-stu-id="cb365-123">Traffic Manager does not see HTTP traffic between client and server.</span></span> <span data-ttu-id="cb365-124">因此，您看到的任何 HTTP 錯誤必定來自您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cb365-124">Therefore, any HTTP error you see must be coming from your application.</span></span> <span data-ttu-id="cb365-125">Hello 用戶端 tooconnect toohello 應用程式，所有的 DNS 解析步驟都已完成。</span><span class="sxs-lookup"><span data-stu-id="cb365-125">For hello client tooconnect toohello application, all DNS resolution steps are complete.</span></span> <span data-ttu-id="cb365-126">這包括 Traffic Manager 對應用程式流量 hello 任何互動。</span><span class="sxs-lookup"><span data-stu-id="cb365-126">That includes any interaction that Traffic Manager has on hello application traffic flow.</span></span>

<span data-ttu-id="cb365-127">進一步調查因此應該專注於 hello 應用程式中。</span><span class="sxs-lookup"><span data-stu-id="cb365-127">Further investigation should therefore focus on hello application.</span></span>

<span data-ttu-id="cb365-128">從用戶端 hello 瀏覽器傳送 hello HTTP 主機標頭是 hello 最常見的問題的來源。</span><span class="sxs-lookup"><span data-stu-id="cb365-128">hello HTTP host header sent from hello client's browser is hello most common source of problems.</span></span> <span data-ttu-id="cb365-129">請確定 hello 應用程式設定的 tooaccept hello 正確的主機標頭 hello 您使用的網域名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-129">Make sure that hello application is configured tooaccept hello correct host header for hello domain name you are using.</span></span> <span data-ttu-id="cb365-130">如需使用端點 hello Azure 應用程式服務，請參閱[使用 Traffic Manager 的 Azure App Service 中設定 web 應用程式的自訂網域名稱](../app-service-web/web-sites-traffic-manager-custom-domain-name.md)。</span><span class="sxs-lookup"><span data-stu-id="cb365-130">For endpoints using hello Azure App Service, see [configuring a custom domain name for a web app in Azure App Service using Traffic Manager](../app-service-web/web-sites-traffic-manager-custom-domain-name.md).</span></span>

### <a name="what-is-hello-performance-impact-of-using-traffic-manager"></a><span data-ttu-id="cb365-131">使用 Traffic Manager 的 hello 效能影響為何？</span><span class="sxs-lookup"><span data-stu-id="cb365-131">What is hello performance impact of using Traffic Manager?</span></span>

<span data-ttu-id="cb365-132">中所述[Traffic Manager 的運作方式](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works)，Traffic Manager 會在 hello DNS 層級運作。</span><span class="sxs-lookup"><span data-stu-id="cb365-132">As explained in [How Traffic Manager Works](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager works at hello DNS level.</span></span> <span data-ttu-id="cb365-133">因為用戶端直接連接 tooyour 服務端點，所以沒有建立 hello 連接之後，使用流量管理員時所產生效能影響。</span><span class="sxs-lookup"><span data-stu-id="cb365-133">Since clients connect tooyour service endpoints directly, there is no performance impact incurred when using Traffic Manager once hello connection is established.</span></span>

<span data-ttu-id="cb365-134">Traffic Manager 會與在 hello DNS 層級的應用程式整合，因為它需要插入 hello DNS 解析鏈結至其他 DNS 查閱 toobe。</span><span class="sxs-lookup"><span data-stu-id="cb365-134">Since Traffic Manager integrates with applications at hello DNS level, it does require an additional DNS lookup toobe inserted into hello DNS resolution chain.</span></span> <span data-ttu-id="cb365-135">hello 影響的 Traffic Manager DNS 解析時間是最小。</span><span class="sxs-lookup"><span data-stu-id="cb365-135">hello impact of Traffic Manager on DNS resolution time is minimal.</span></span> <span data-ttu-id="cb365-136">Traffic Manager 會使用全域網路的名稱伺服器，並使用[任一傳播](https://en.wikipedia.org/wiki/Anycast)網路 tooensure DNS 查詢都路由的 toohello 最接近可用的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb365-136">Traffic Manager uses a global network of name servers, and uses [anycast](https://en.wikipedia.org/wiki/Anycast) networking tooensure DNS queries are always routed toohello closest available name server.</span></span> <span data-ttu-id="cb365-137">此外，DNS 回應的快取表示 hello 使用 Traffic Manager 會產生其他 DNS 延遲套用只 tooa 分數的工作階段。</span><span class="sxs-lookup"><span data-stu-id="cb365-137">In addition, caching of DNS responses means that hello additional DNS latency incurred by using Traffic Manager applies only tooa fraction of sessions.</span></span>

<span data-ttu-id="cb365-138">hello 效能方法路由流量 toohello 最接近的可用端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-138">hello Performance method routes traffic toohello closest available endpoint.</span></span> <span data-ttu-id="cb365-139">hello 最後結果就是該 hello 這個方法與相關聯的整體效能影響應該很小。</span><span class="sxs-lookup"><span data-stu-id="cb365-139">hello net result is that hello overall performance impact associated with this method should be minimal.</span></span> <span data-ttu-id="cb365-140">應該會增加任何的 DNS 延遲位移較低的網路延遲 toohello 端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-140">Any increase in DNS latency should be offset by lower network latency toohello endpoint.</span></span>

### <a name="what-application-protocols-can-i-use-with-traffic-manager"></a><span data-ttu-id="cb365-141">我可以搭配「流量管理員」使用哪些應用程式通訊協定？</span><span class="sxs-lookup"><span data-stu-id="cb365-141">What application protocols can I use with Traffic Manager?</span></span>

<span data-ttu-id="cb365-142">中所述[Traffic Manager 的運作方式](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works)，Traffic Manager 會在 hello DNS 層級運作。</span><span class="sxs-lookup"><span data-stu-id="cb365-142">As explained in [How Traffic Manager Works](../traffic-manager/traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager works at hello DNS level.</span></span> <span data-ttu-id="cb365-143">Hello DNS 查閱完成之後，用戶端連線 toohello 應用程式端點直接，未透過 Traffic Manager。</span><span class="sxs-lookup"><span data-stu-id="cb365-143">Once hello DNS lookup is complete, clients connect toohello application endpoint directly, not through Traffic Manager.</span></span> <span data-ttu-id="cb365-144">因此，hello 連線可以使用任何應用程式通訊協定。</span><span class="sxs-lookup"><span data-stu-id="cb365-144">Therefore, hello connection can use any application protocol.</span></span> <span data-ttu-id="cb365-145">如果您選取 TCP 作為 hello 監視通訊協定，Traffic Manager 的端點健全狀況監視，才可以不使用任何應用程式通訊協定。</span><span class="sxs-lookup"><span data-stu-id="cb365-145">If you select TCP as hello monitoring protocol, Traffic Manager's endpoint health monitoring can be done without using any application protocols.</span></span> <span data-ttu-id="cb365-146">如果您選擇使用應用程式通訊協定驗證 toohave hello 健全狀況，hello 端點需要 toobe 無法 toorespond tooeither HTTP 或 HTTPS GET 要求。</span><span class="sxs-lookup"><span data-stu-id="cb365-146">If you choose toohave hello health verified using an application protocol, hello endpoint needs toobe able toorespond tooeither HTTP or HTTPS GET requests.</span></span>

### <a name="can-i-use-traffic-manager-with-a-naked-domain-name"></a><span data-ttu-id="cb365-147">我是否可以在流量管理員中使用「裸」網域名稱？</span><span class="sxs-lookup"><span data-stu-id="cb365-147">Can I use Traffic Manager with a 'naked' domain name?</span></span>

<span data-ttu-id="cb365-148">否。</span><span class="sxs-lookup"><span data-stu-id="cb365-148">No.</span></span> <span data-ttu-id="cb365-149">hello DNS 標準不允許 Cname tooco-存在 hello 其他 DNS 記錄，具有相同名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-149">hello DNS standards do not permit CNAMEs tooco-exist with other DNS records of hello same name.</span></span> <span data-ttu-id="cb365-150">hello apex （或根） 的 DNS 區域一定會包含兩個預先存在的 DNS 記錄。hello SOA 和 hello 權威 NS 記錄。</span><span class="sxs-lookup"><span data-stu-id="cb365-150">hello apex (or root) of a DNS zone always contains two pre-existing DNS records; hello SOA and hello authoritative NS records.</span></span> <span data-ttu-id="cb365-151">這表示無法在 hello 區域的 apex 建立 CNAME 記錄，而不會違反 hello DNS 標準。</span><span class="sxs-lookup"><span data-stu-id="cb365-151">This means a CNAME record cannot be created at hello zone apex without violating hello DNS standards.</span></span>

<span data-ttu-id="cb365-152">Traffic Manager 會需要 DNS CNAME 記錄 toomap hello 虛名 DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-152">Traffic Manager requires a DNS CNAME record toomap hello vanity DNS name.</span></span> <span data-ttu-id="cb365-153">例如，您將對應 www.contoso.com toohello Traffic Manager 設定檔 DNS 名稱 contoso.trafficmanager.net。</span><span class="sxs-lookup"><span data-stu-id="cb365-153">For example, you map www.contoso.com toohello Traffic Manager profile DNS name contoso.trafficmanager.net.</span></span> <span data-ttu-id="cb365-154">此外，hello Traffic Manager 設定檔會傳回第二個的 DNS CNAME tooindicate hello 用戶端應該連接至哪一個端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-154">Additionally, hello Traffic Manager profile returns a second DNS CNAME tooindicate which endpoint hello client should connect to.</span></span>

<span data-ttu-id="cb365-155">toowork 解決此問題，我們建議使用 hello naked 網域名稱 tooa 不同的 URL，然後可以使用 Traffic Manager 從 HTTP 重新導向 toodirect 流量。</span><span class="sxs-lookup"><span data-stu-id="cb365-155">toowork around this issue, we recommend using an HTTP redirect toodirect traffic from hello naked domain name tooa different URL, which can then use Traffic Manager.</span></span> <span data-ttu-id="cb365-156">例如，hello naked 網域 'contoso.com' 可以重新導向使用者 toohello CNAME 'www.contoso.com' 指向 toohello Traffic Manager DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-156">For example, hello naked domain 'contoso.com' can redirect users toohello CNAME 'www.contoso.com' that points toohello Traffic Manager DNS name.</span></span>

<span data-ttu-id="cb365-157">我們的功能待處理項目中追蹤了對「流量管理員」中裸網域的完整支援。</span><span class="sxs-lookup"><span data-stu-id="cb365-157">Full support for naked domains in Traffic Manager is tracked in our feature backlog.</span></span> <span data-ttu-id="cb365-158">您可以[在我們的社群意見反應站投票](https://feedback.azure.com/forums/217313-networking/suggestions/5485350-support-apex-naked-domains-more-seamlessly)，以表達您支持這項功能要求。</span><span class="sxs-lookup"><span data-stu-id="cb365-158">You can register your support for this feature request by [voting for it on our community feedback site](https://feedback.azure.com/forums/217313-networking/suggestions/5485350-support-apex-naked-domains-more-seamlessly).</span></span>

### <a name="does-traffic-manager-consider-hello-client-subnet-address-when-handling-dns-queries"></a><span data-ttu-id="cb365-159">處理 DNS 查詢時，就 Traffic Manager 考慮 hello 用戶端的子網路位址嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-159">Does Traffic Manager consider hello client subnet address when handling DNS queries?</span></span> 
<span data-ttu-id="cb365-160">否，目前 Traffic Manager 會考慮只 hello 來源 IP 位址的 hello DNS 查詢收到，地理和效能的路由方法執行查詢時，通常是 hello DNS 解讀器，hello IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-160">No, currently Traffic Manager considers only hello source IP address of hello DNS query it receives, which usually is hello IP address of hello DNS resolver, when performing lookups for Geographic and Performance routing methods.</span></span>  
<span data-ttu-id="cb365-161">具體來說， [RFC 7871 – 用戶端在 DNS 查詢中的子網路](https://tools.ietf.org/html/rfc7871)提供[DNS (EDNS0) 的延伸模組機制](https://tools.ietf.org/html/rfc2671)其可以從解析程式支援它 tooDNS 伺服器傳遞 hello 用戶端的子網路位址是目前不支援在 Traffic Manager 中。</span><span class="sxs-lookup"><span data-stu-id="cb365-161">Specifically, [RFC 7871 – Client Subnet in DNS Queries](https://tools.ietf.org/html/rfc7871) that provides an [Extension Mechanism for DNS (EDNS0)](https://tools.ietf.org/html/rfc2671) which can pass on hello client subnet address from resolvers that support it tooDNS servers is currently not supported in Traffic Manager.</span></span> <span data-ttu-id="cb365-162">您可以透過我們的[社群意見反應站 (英文)](https://feedback.azure.com/forums/217313-networking) 來表達您支持這項功能要求。</span><span class="sxs-lookup"><span data-stu-id="cb365-162">You can register your support for this feature request through our [community feedback site](https://feedback.azure.com/forums/217313-networking).</span></span>


### <a name="what-is-dns-ttl-and-how-does-it-impact-my-users"></a><span data-ttu-id="cb365-163">什麼是 DNS TTL，以及它如何影響我的使用者？</span><span class="sxs-lookup"><span data-stu-id="cb365-163">What is DNS TTL and how does it impact my users?</span></span>

<span data-ttu-id="cb365-164">DNS 查詢會落在 Traffic Manager，它會設定稱為 「 存留時間 (TTL) 的 hello 回應中的值。</span><span class="sxs-lookup"><span data-stu-id="cb365-164">When a DNS query lands on Traffic Manager, it sets a value in hello response called time-to-live (TTL).</span></span> <span data-ttu-id="cb365-165">這個值，其單位是以秒為單位，表示 tooDNS 上的解析程式下游多久 toocache 此回應。</span><span class="sxs-lookup"><span data-stu-id="cb365-165">This value, whose unit is in seconds, indicates tooDNS resolvers downstream on how long toocache this response.</span></span> <span data-ttu-id="cb365-166">雖然 DNS 解析程式不會保證 toocache 此結果中，快取它可讓他們關閉 hello life tooTraffic Manager DNS 伺服器的快取 toorespond tooany 後續查詢。</span><span class="sxs-lookup"><span data-stu-id="cb365-166">While DNS resolvers are not guaranteed toocache this result, caching it enables them toorespond tooany subsequent queries off hello cache instead of going tooTraffic Manager DNS servers.</span></span> <span data-ttu-id="cb365-167">這會影響 hello 回應，如下所示：</span><span class="sxs-lookup"><span data-stu-id="cb365-167">This impacts hello responses as follows:</span></span>
- <span data-ttu-id="cb365-168">較高的 TTL 會減少 hello 進入 hello Traffic Manager DNS 伺服器，因為提供的查詢數目為可計費的使用量，可以降低 hello 成本客戶的查詢數目。</span><span class="sxs-lookup"><span data-stu-id="cb365-168">a higher TTL reduces hello number of queries that land on hello Traffic Manager DNS servers, which can reduce hello cost for a customer since number of queries served is a billable usage.</span></span>
- <span data-ttu-id="cb365-169">較高的 TTL 可能會減少 hello 花的時間 toodo DNS 查閱。</span><span class="sxs-lookup"><span data-stu-id="cb365-169">a higher TTL can potentially reduce hello time it takes toodo a DNS lookup.</span></span>
- <span data-ttu-id="cb365-170">較高的 TTL 也表示您的資料不會反映 hello 最新健全狀況，Traffic Manager 已取得資訊透過其探查的代理程式。</span><span class="sxs-lookup"><span data-stu-id="cb365-170">a higher TTL also means that your data does not reflect hello latest health information that Traffic Manager has obtained through its probing agents.</span></span>

### <a name="how-high-or-low-can-i-set-hello-ttl-for-traffic-manager-responses"></a><span data-ttu-id="cb365-171">如何最高或最低可設定 Traffic Manager 回應 hello TTL？</span><span class="sxs-lookup"><span data-stu-id="cb365-171">How high or low can I set hello TTL for Traffic Manager responses?</span></span>

<span data-ttu-id="cb365-172">您可以設定，在每個設定檔層級，hello DNS TTL toobe 做為 0 秒，最高為 2,147,483,647 秒 (hello 與相容的最大範圍[RFC 1035](https://www.ietf.org/rfc/rfc1035.txt ))。</span><span class="sxs-lookup"><span data-stu-id="cb365-172">You can set, at a per profile level, hello DNS TTL toobe as low as 0 seconds and as high as 2,147,483,647 seconds (hello maximum range compliant with [RFC-1035](https://www.ietf.org/rfc/rfc1035.txt )).</span></span> <span data-ttu-id="cb365-173">0 表示下游的 DNS 解析程式不會快取查詢回應所有查詢都是 TTL 預期 tooreach hello Traffic Manager DNS 伺服器來進行解析。</span><span class="sxs-lookup"><span data-stu-id="cb365-173">A TTL of 0 means that downstream DNS resolvers do not cache query responses and all queries are expected tooreach hello Traffic Manager DNS servers for resolution.</span></span>

## <a name="traffic-manager-geographic-traffic-routing-method"></a><span data-ttu-id="cb365-174">流量管理員地理流量路由方法</span><span class="sxs-lookup"><span data-stu-id="cb365-174">Traffic Manager Geographic traffic routing method</span></span>

### <a name="what-are-some-use-cases-where-geographic-routing-is-useful"></a><span data-ttu-id="cb365-175">地理路由派上用場的使用案例有哪些？</span><span class="sxs-lookup"><span data-stu-id="cb365-175">What are some use cases where geographic routing is useful?</span></span> 
<span data-ttu-id="cb365-176">地理路由類型可用在任何案例中是 Azure 客戶需要的地方 toodistinguish 使用者根據地理區域。</span><span class="sxs-lookup"><span data-stu-id="cb365-176">Geographic routing type can be used in any scenario where an Azure customer needs toodistinguish their users based on geographic regions.</span></span> <span data-ttu-id="cb365-177">例如，使用 hello 地理流量路由方式，您就能給予使用者從特定區域以外的其他區域的不同的使用者體驗。</span><span class="sxs-lookup"><span data-stu-id="cb365-177">For example, using hello Geographic traffic routing method, you can give users from specific regions a different user experience than those from other regions.</span></span> <span data-ttu-id="cb365-178">另一個例子是符合本機資料主權規定，要求特定區域的使用者只能由該區域中的端點提供服務。</span><span class="sxs-lookup"><span data-stu-id="cb365-178">Another example is complying with local data sovereignty mandates that require that users from a specific region be served only by endpoints in that region.</span></span>

### <a name="what-are-hello-regions-that-are-supported-by-traffic-manager-for-geographic-routing"></a><span data-ttu-id="cb365-179">Traffic Manager 所支援的地理路由 hello 區域有哪些？</span><span class="sxs-lookup"><span data-stu-id="cb365-179">What are hello regions that are supported by Traffic Manager for geographic routing?</span></span> 
<span data-ttu-id="cb365-180">您可以找到 hello Traffic Manager 時使用的國家/地區階層[這裡](traffic-manager-geographic-regions.md)。</span><span class="sxs-lookup"><span data-stu-id="cb365-180">hello country/region hierarchy that is used by Traffic Manager can be found [here](traffic-manager-geographic-regions.md).</span></span> <span data-ttu-id="cb365-181">此頁面會保留最新狀態的任何變更，而您也以程式設計方式可以擷取使用 hello hello 相同資訊[Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/)。</span><span class="sxs-lookup"><span data-stu-id="cb365-181">While this page is kept up-to-date with any changes, you can also programmatically retrieve hello same information by using hello [Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/).</span></span> 

### <a name="how-does-traffic-manager-determine-where-a-user-is-querying-from"></a><span data-ttu-id="cb365-182">流量管理員如何判斷使用者從何處執行查詢？</span><span class="sxs-lookup"><span data-stu-id="cb365-182">How does traffic manager determine where a user is querying from?</span></span> 
<span data-ttu-id="cb365-183">Traffic Manager 會查看 hello 來源 IP hello 查詢 （這可能是執行 hello 查詢代表 hello 使用者的本機 DNS 解析程式），並使用內部 IP tooregion 對應 toodetermine hello 位置。</span><span class="sxs-lookup"><span data-stu-id="cb365-183">Traffic Manager looks at hello source IP of hello query (this most likely is a local DNS resolver doing hello querying on behalf of hello user) and uses an internal IP tooregion map toodetermine hello location.</span></span> <span data-ttu-id="cb365-184">此對應會更新變更的 hello 持續 tooaccount 網際網路。</span><span class="sxs-lookup"><span data-stu-id="cb365-184">This map is updated on an ongoing basis tooaccount for changes in hello internet.</span></span> 

### <a name="is-it-guaranteed-that-traffic-manager-can-correctly-determine-hello-exact-geographic-location-of-hello-user-in-every-case"></a><span data-ttu-id="cb365-185">這樣會保證 Traffic Manager 可以正確判斷 hello 確切地理位置中每個案例的 hello 使用者嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-185">Is it guaranteed that Traffic Manager can correctly determine hello exact geographic location of hello user in every case?</span></span>
<span data-ttu-id="cb365-186">否，Traffic Manager 無法保證我們推斷 hello 來源 IP 位址的 DNS 查詢從該 hello 地理區域永遠都會將對應 toohello 使用者的位置，因為 toohello 下列原因：</span><span class="sxs-lookup"><span data-stu-id="cb365-186">No, Traffic Manager cannot guarantee that hello geographic region we infer from hello source IP address of a DNS query will always correspond toohello user’s location due toohello following reasons:</span></span> 

- <span data-ttu-id="cb365-187">首先，hello 先前常見問題集所述，hello 我們看到是 DNS 解析程式執行代表 hello 使用者 hello 查閱的來源 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-187">First, as described in hello previous FAQ, hello source IP address we see is that of a DNS resolver doing hello lookup on behalf of hello user.</span></span> <span data-ttu-id="cb365-188">Hello hello 使用者地理位置的良好 proxy hello hello DNS 解析程式的地理位置時，它也可以是不同定 hello DNS 解析程式服務和 hello 特定 DNS 解析程式服務的客戶已選擇 hello 耗用量toouse。</span><span class="sxs-lookup"><span data-stu-id="cb365-188">While hello geographic location of hello DNS resolver is a good proxy for hello geographic location of hello user, it can also be different depending upon hello footprint of hello DNS resolver service and hello specific DNS resolver service a customer has chosen toouse.</span></span> <span data-ttu-id="cb365-189">例如，位於馬來西亞客戶可以指定他們的裝置設定使用中新加坡其 DNS 伺服器可能會收到一個 DNS 解析程式服務中挑選 toohandle hello 查詢解析度，該使用者/裝置。</span><span class="sxs-lookup"><span data-stu-id="cb365-189">As an example, a customer located in Malaysia could specify in their device’s settings use a DNS resolver service whose DNS server in Singapore might get picked toohandle hello query resolutions for that user/device.</span></span> <span data-ttu-id="cb365-190">案例中，Traffic Manager 只能看見 hello 解析程式的 IP 位址，對應 toohello 新加坡位置。</span><span class="sxs-lookup"><span data-stu-id="cb365-190">In that case, Traffic Manager can only see hello resolver’s IP address that corresponds toohello Singapore location.</span></span> <span data-ttu-id="cb365-191">此外，請參閱之前有關用戶端的子網路位址的常見問題集支援此頁面的 hello。</span><span class="sxs-lookup"><span data-stu-id="cb365-191">Also, see hello earlier FAQ regarding client subnet address support on this page.</span></span>

- <span data-ttu-id="cb365-192">第二，Traffic Manager 會使用內部對應 toodo hello IP 位址 toogeographic 區域轉譯。</span><span class="sxs-lookup"><span data-stu-id="cb365-192">Second, Traffic Manager uses an internal map toodo hello IP address toogeographic region translation.</span></span> <span data-ttu-id="cb365-193">雖然此對應會驗證並更新持續 tooincrease 上其精確度和帳戶 hello 發展的本質 hello 網際網路，仍有 hello 可能性，我們的資訊不是所有的 hello 地理位置的精確表示hello IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-193">While this map is validated and updated on an ongoing basis tooincrease its accuracy and account for hello evolving nature of hello internet, there is still hello possibility that our information is not an exact representation of hello geographic location of all hello IP addresses.</span></span>


###  <a name="does-an-endpoint-need-toobe-physically-located-in-hello-same-region-as-hello-one-it-is-configured-with-for-geographic-routing"></a><span data-ttu-id="cb365-194">沒有實際位於端點需要 toobe hello hello 與相同的區域一個設定為地理路由？</span><span class="sxs-lookup"><span data-stu-id="cb365-194">Does an endpoint need toobe physically located in hello same region as hello one it is configured with for geographic routing?</span></span> 
<span data-ttu-id="cb365-195">否，hello hello 端點位置都會加入所在區域可以是對應的 tooit 沒有限制。</span><span class="sxs-lookup"><span data-stu-id="cb365-195">No, hello location of hello endpoint imposes no restrictions on which regions can be mapped tooit.</span></span> <span data-ttu-id="cb365-196">例如，美國中部 Azure 區域中的端點可以有來自印度導向 tooit 的所有使用者。</span><span class="sxs-lookup"><span data-stu-id="cb365-196">For example, an endpoint in US-Central Azure region can have all users from India directed tooit.</span></span>

### <a name="can-i-assign-geographic-regions-tooendpoints-in-a-profile-that-is-not-configured-toodo-geographic-routing"></a><span data-ttu-id="cb365-197">可以將指定的地理區域 tooendpoints 不是設定檔中的設定 toodo 地理路由？</span><span class="sxs-lookup"><span data-stu-id="cb365-197">Can I assign geographic regions tooendpoints in a profile that is not configured toodo geographic routing?</span></span> 

<span data-ttu-id="cb365-198">是，如果不地理 hello 路由方式的設定檔，您可以使用 hello [Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/) tooassign 地理區域 tooendpoints 該設定檔中的。</span><span class="sxs-lookup"><span data-stu-id="cb365-198">Yes, if hello routing method of a profile is not geographic, you can use hello [Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/) tooassign geographic regions tooendpoints in that profile.</span></span> <span data-ttu-id="cb365-199">在非地理路由類型設定檔的 hello 情況下，會忽略此設定。</span><span class="sxs-lookup"><span data-stu-id="cb365-199">In hello case of non-geographic routing type profiles, this configuration is ignored.</span></span> <span data-ttu-id="cb365-200">如果您在稍後變更這類的設定檔 toogeographic 路由類型，Traffic Manager 可以使用這些對應。</span><span class="sxs-lookup"><span data-stu-id="cb365-200">If you change such a profile toogeographic routing type at a later time, Traffic Manager can use those mappings.</span></span>


### <a name="why-am-i-getting-an-error-when-i-try-toochange-hello-routing-method-of-an-existing-profile-toogeographic"></a><span data-ttu-id="cb365-201">為什麼我會收到錯誤時的現有的設定檔 tooGeographic toochange hello 路由方法？</span><span class="sxs-lookup"><span data-stu-id="cb365-201">Why am I getting an error when I try toochange hello routing method of an existing profile tooGeographic?</span></span>

<span data-ttu-id="cb365-202">在具有地理路由的設定檔的所有 hello 端點都需要 toohave 至少一個區域對應 tooit。</span><span class="sxs-lookup"><span data-stu-id="cb365-202">All hello endpoints under a profile with geographic routing need toohave at least one region mapped tooit.</span></span> <span data-ttu-id="cb365-203">tooconvert 現有的設定檔 toogeographic 路由類型，您必須先 tooassociate 地理區域 tooall 其端點使用 hello [Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/)之前變更 hello 路由輸入 toogeographic。</span><span class="sxs-lookup"><span data-stu-id="cb365-203">tooconvert an existing profile toogeographic routing type, you first need tooassociate geographic regions tooall its endpoints using hello [Azure Traffic Manager REST API](https://docs.microsoft.com/rest/api/trafficmanager/) before changing hello routing type toogeographic.</span></span> <span data-ttu-id="cb365-204">如果使用入口網站中，第一次刪除 hello 端點，變更 hello 設定檔 toogeographic hello 路由方法，然後新增 hello 端點，以及其地理區域的對應。</span><span class="sxs-lookup"><span data-stu-id="cb365-204">If using portal, first delete hello endpoints, change hello routing method of hello profile toogeographic and then add hello endpoints along with their geographic region mapping.</span></span> 


###  <a name="why-is-it-strongly-recommended-that-customers-create-nested-profiles-instead-of-endpoints-under-a-profile-with-geographic-routing-enabled"></a><span data-ttu-id="cb365-205">為什麼強烈建議客戶建立巢狀設定檔，而不是在啟用地理路由的設定檔下新增端點？</span><span class="sxs-lookup"><span data-stu-id="cb365-205">Why is it strongly recommended that customers create nested profiles instead of endpoints under a profile with geographic routing enabled?</span></span> 

<span data-ttu-id="cb365-206">區域可以指派設定檔中的一個 tooonly 端點如果它使用地理路由類型。</span><span class="sxs-lookup"><span data-stu-id="cb365-206">A region can be assigned tooonly one endpoint within a profile if its using geographic routing type.</span></span> <span data-ttu-id="cb365-207">如果該端點不是子連接的設定檔 tooit，具有的巢狀型別，如果該端點會處於狀況不良，Traffic Manager 會持續 toosend 流量 tooit 自 hello 不傳送任何流量不好的替代方式。</span><span class="sxs-lookup"><span data-stu-id="cb365-207">If that endpoint is not a nested type with a child profile attached tooit, if that endpoint going unhealthy, Traffic Manager continues toosend traffic tooit since hello alternative of not sending any traffic isn’t any better.</span></span> <span data-ttu-id="cb365-208">流量管理員 」 會執行不容錯移轉 tooanother 端點，即使 hello 區域指派 「 父 」 的 hello 區域指派 toohello 端點發生 （例如，如果擁有區域西班牙的端點，變成狀況不良，我們將無法容錯移轉 tooanother 狀況不良具有 hello 區域歐洲的端點指派 tooit）。</span><span class="sxs-lookup"><span data-stu-id="cb365-208">Traffic Manager does not failover tooanother endpoint, even when hello region assigned is a “parent” of hello region assigned toohello endpoint that went unhealthy (for example, if an endpoint that has region Spain goes unhealthy, we will not failover tooanother endpoint that has hello region Europe assigned tooit).</span></span> <span data-ttu-id="cb365-209">這是 tooensure Traffic Manager 方面 hello 地理界限的客戶的安裝程式在其設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-209">This is done tooensure that Traffic Manager respects hello geographic boundaries that a customer has setup in their profile.</span></span> <span data-ttu-id="cb365-210">tooget hello 優點容錯移轉 tooanother 端點當端點變成狀況不良時，建議您使用地理區域，指派 toonested 具有多個端點中，而不是個別端點的設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-210">tooget hello benefit of failing over tooanother endpoint when an endpoint goes unhealthy, it is recommended that geographic regions be assigned toonested profiles with multiple endpoints within it instead of individual endpoints.</span></span> <span data-ttu-id="cb365-211">如此一來，如果中巢狀的 hello 子項設定檔失敗，流量的端點可以容錯移轉 tooanother 端點內 hello 相同巢狀化子系設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-211">In this way, if an endpoint in hello nested child profile fails, traffic can failover tooanother endpoint inside hello same nested child profile.</span></span>

### <a name="are-there-any-restrictions-on-hello-api-version-that-supports-this-routing-type"></a><span data-ttu-id="cb365-212">有支援這種路由類型的 hello API 版本的任何限制嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-212">Are there any restrictions on hello API version that supports this routing type?</span></span>

<span data-ttu-id="cb365-213">可以，只有 2017年-03-01 的 API 版本和更新版本支援 hello 地理路由類型。</span><span class="sxs-lookup"><span data-stu-id="cb365-213">Yes, only API version 2017-03-01 and newer supports hello Geographic routing type.</span></span> <span data-ttu-id="cb365-214">任何較舊的應用程式開發介面版本無法使用的 toocreated 的地理路由類型的設定檔或指派 tooendpoints 地理區域。</span><span class="sxs-lookup"><span data-stu-id="cb365-214">Any older API versions cannot be used toocreated profiles of Geographic routing type or assign geographic regions tooendpoints.</span></span> <span data-ttu-id="cb365-215">如果較舊的 API 版本使用的 tooretrieve 從 Azure 訂用帳戶的設定檔，不會傳回任何設定檔的地理路由類型。</span><span class="sxs-lookup"><span data-stu-id="cb365-215">If an older API version is used tooretrieve profiles from an Azure subscription, any profile of Geographic routing type is not returned.</span></span> <span data-ttu-id="cb365-216">此外，使用舊版 API 時，傳回的任何設定檔如果有已指派地理區域的端點，則不會顯示其地理區域指派。</span><span class="sxs-lookup"><span data-stu-id="cb365-216">In addition, when using older API versions, any profile returned that has endpoints with a geographic region assignment, does not have its geographic region assignment shown.</span></span>



## <a name="traffic-manager-endpoints"></a><span data-ttu-id="cb365-217">流量管理員端點</span><span class="sxs-lookup"><span data-stu-id="cb365-217">Traffic Manager endpoints</span></span>

### <a name="can-i-use-traffic-manager-with-endpoints-from-multiple-subscriptions"></a><span data-ttu-id="cb365-218">可以將流量管理員用於來自多個訂用帳戶的端點嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-218">Can I use Traffic Manager with endpoints from multiple subscriptions?</span></span>

<span data-ttu-id="cb365-219">來自多個訂用帳戶的端點不能與 Azure Web 應用程式搭配使用。</span><span class="sxs-lookup"><span data-stu-id="cb365-219">Using endpoints from multiple subscriptions is not possible with Azure Web Apps.</span></span> <span data-ttu-id="cb365-220">Azure Web Apps 規定 Web Apps 使用的任何自訂網域名稱只能在單一訂用帳戶內使用。</span><span class="sxs-lookup"><span data-stu-id="cb365-220">Azure Web Apps requires that any custom domain name used with Web Apps is only used within a single subscription.</span></span> <span data-ttu-id="cb365-221">它不是從多個訂閱 hello 與可能 toouse Web 應用程式相同的網域名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-221">It is not possible toouse Web Apps from multiple subscriptions with hello same domain name.</span></span>

<span data-ttu-id="cb365-222">對於其他端點型別，就可能 toouse Traffic Manager 具有一個以上的訂用帳戶的端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-222">For other endpoint types, it is possible toouse Traffic Manager with endpoints from more than one subscription.</span></span> <span data-ttu-id="cb365-223">資源管理員 中，從任何訂用帳戶的端點可以加入 tooTraffic 管理員 中，只要設定 hello Traffic Manager 設定檔的 hello 使用者擁有讀取權限 toohello 端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-223">In Resource Manager, endpoints from any subscription can be added tooTraffic Manager, as long as hello person configuring hello Traffic Manager profile has read access toohello endpoint.</span></span> <span data-ttu-id="cb365-224">使用 [Azure Resource Manager 角色型存取控制 (RBAC)](../active-directory/role-based-access-control-configure.md)可以授與這些權限。</span><span class="sxs-lookup"><span data-stu-id="cb365-224">These permissions can be granted using [Azure Resource Manager role-based access control (RBAC)](../active-directory/role-based-access-control-configure.md).</span></span>


### <a name="can-i-use-traffic-manager-with-cloud-service-staging-slots"></a><span data-ttu-id="cb365-225">我可以使用流量管理員來設定雲端服務「預備」位置嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-225">Can I use Traffic Manager with Cloud Service 'Staging' slots?</span></span>

<span data-ttu-id="cb365-226">是。</span><span class="sxs-lookup"><span data-stu-id="cb365-226">Yes.</span></span> <span data-ttu-id="cb365-227">雲端服務「預備」位置可在流量管理員中設定為外部端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-227">Cloud Service 'staging' slots can be configured in Traffic Manager as External endpoints.</span></span> <span data-ttu-id="cb365-228">健康情況檢查仍會收費 hello Azure 端點速率。</span><span class="sxs-lookup"><span data-stu-id="cb365-228">Health checks are still be charged at hello Azure Endpoints rate.</span></span> <span data-ttu-id="cb365-229">正在使用中的 hello 外部端點的型別，因為變更 toohello 基礎服務不會收取自動。</span><span class="sxs-lookup"><span data-stu-id="cb365-229">Because hello External endpoint type is in use, changes toohello underlying service are not picked up automatically.</span></span> <span data-ttu-id="cb365-230">與外部端點，hello 雲端服務已停止或刪除時，無法偵測 Traffic Manager。</span><span class="sxs-lookup"><span data-stu-id="cb365-230">With external endpoints, Traffic Manager cannot detect when hello Cloud Service is stopped or deleted.</span></span> <span data-ttu-id="cb365-231">因此，hello Traffic Manager 會持續健全狀況檢查的計費 hello 端點已停用或刪除為止。</span><span class="sxs-lookup"><span data-stu-id="cb365-231">Therefore, hello Traffic Manager continues billing for health checks until hello endpoint is disabled or deleted.</span></span>

### <a name="does-traffic-manager-support-ipv6-endpoints"></a><span data-ttu-id="cb365-232">流量管理員是否支援 IPv6 端點？</span><span class="sxs-lookup"><span data-stu-id="cb365-232">Does Traffic Manager support IPv6 endpoints?</span></span>

<span data-ttu-id="cb365-233">流量管理員目前不提供 IPv6 定址的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="cb365-233">Traffic Manager does not currently provide IPv6-addressible name servers.</span></span> <span data-ttu-id="cb365-234">不過，Traffic Manager 仍可以使用 IPv6 連接 tooIPv6 端點的用戶端。</span><span class="sxs-lookup"><span data-stu-id="cb365-234">However, Traffic Manager can still be used by IPv6 clients connecting tooIPv6 endpoints.</span></span> <span data-ttu-id="cb365-235">用戶端不會進行 DNS 要求直接 tooTraffic 管理員。</span><span class="sxs-lookup"><span data-stu-id="cb365-235">A client does not make DNS requests directly tooTraffic Manager.</span></span> <span data-ttu-id="cb365-236">相反地，hello 用戶端會使用遞迴 DNS 服務。</span><span class="sxs-lookup"><span data-stu-id="cb365-236">Instead, hello client uses a recursive DNS service.</span></span> <span data-ttu-id="cb365-237">僅支援 IPv6 的用戶端傳送要求透過 IPv6 toohello 遞迴 DNS 服務。</span><span class="sxs-lookup"><span data-stu-id="cb365-237">An IPv6-only client sends requests toohello recursive DNS service via IPv6.</span></span> <span data-ttu-id="cb365-238">然後 hello 遞迴服務應能 toocontact hello Traffic Manager 名稱伺服器使用 IPv4。</span><span class="sxs-lookup"><span data-stu-id="cb365-238">Then hello recursive service should be able toocontact hello Traffic Manager name servers using IPv4.</span></span>

<span data-ttu-id="cb365-239">Traffic Manager 的回應 hello 端點 hello DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-239">Traffic Manager responds with hello DNS name of hello endpoint.</span></span> <span data-ttu-id="cb365-240">toosupport IPv6 端點 DNS AAAA 記錄指標 hello 端點 DNS 名稱 toohello IPv6 位址必須存在。</span><span class="sxs-lookup"><span data-stu-id="cb365-240">toosupport an IPv6 endpoint, a DNS AAAA record pointing hello endpoint DNS name toohello IPv6 address must exist.</span></span> <span data-ttu-id="cb365-241">流量管理員健康情況檢查僅支援 IPv4 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-241">Traffic Manager health checks only support IPv4 addresses.</span></span> <span data-ttu-id="cb365-242">hello 服務必須在 hello tooexpose IPv4 端點相同的 DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-242">hello service needs tooexpose an IPv4 endpoint on hello same DNS name.</span></span>

### <a name="can-i-use-traffic-manager-with-more-than-one-web-app-in-hello-same-region"></a><span data-ttu-id="cb365-243">可以使用 Traffic Manager hello 中的多個 Web 應用程式使用相同的區域？</span><span class="sxs-lookup"><span data-stu-id="cb365-243">Can I use Traffic Manager with more than one Web App in hello same region?</span></span>

<span data-ttu-id="cb365-244">通常，Traffic Manager 會使用的 toodirect 流量 tooapplications 部署在不同的區域。</span><span class="sxs-lookup"><span data-stu-id="cb365-244">Typically, Traffic Manager is used toodirect traffic tooapplications deployed in different regions.</span></span> <span data-ttu-id="cb365-245">不過，它也可用位置的應用程式有多個部署 hello 中相同的區域。</span><span class="sxs-lookup"><span data-stu-id="cb365-245">However, it can also be used where an application has more than one deployment in hello same region.</span></span> <span data-ttu-id="cb365-246">hello Azure Traffic Manager 端點不允許多個 Web 應用程式端點 hello 從相同的 Azure 區域 toobe 加入 toohello 相同 Traffic Manager 設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-246">hello Traffic Manager Azure endpoints do not permit more than one Web App endpoint from hello same Azure region toobe added toohello same Traffic Manager profile.</span></span>

##  <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="cb365-247">流量管理員端點監視</span><span class="sxs-lookup"><span data-stu-id="cb365-247">Traffic Manager endpoint monitoring</span></span>

### <a name="is-traffic-manager-resilient-tooazure-region-failures"></a><span data-ttu-id="cb365-248">為 Traffic Manager 彈性 tooAzure 區域失敗？</span><span class="sxs-lookup"><span data-stu-id="cb365-248">Is Traffic Manager resilient tooAzure region failures?</span></span>

<span data-ttu-id="cb365-249">Traffic Manager 是高度可用的應用程式在 Azure 中的 hello 傳遞的重要元件。</span><span class="sxs-lookup"><span data-stu-id="cb365-249">Traffic Manager is a key component of hello delivery of highly available applications in Azure.</span></span>
<span data-ttu-id="cb365-250">toodeliver 高可用性，Traffic Manager 必須有過高的層級的可用性和彈性 tooregional 失敗。</span><span class="sxs-lookup"><span data-stu-id="cb365-250">toodeliver high availability, Traffic Manager must have an exceptionally high level of availability and be resilient tooregional failure.</span></span>

<span data-ttu-id="cb365-251">根據設計，Traffic Manager 元件是彈性 tooa 完全失敗的任何 Azure 區域。</span><span class="sxs-lookup"><span data-stu-id="cb365-251">By design, Traffic Manager components are resilient tooa complete failure of any Azure region.</span></span> <span data-ttu-id="cb365-252">此彈性適用於 tooall Traffic Manager 元件： hello DNS 名稱伺服器、 hello API、 hello 儲存層和 hello 端點監視服務。</span><span class="sxs-lookup"><span data-stu-id="cb365-252">This resilience applies tooall Traffic Manager components: hello DNS name servers, hello API, hello storage layer, and hello endpoint monitoring service.</span></span>

<span data-ttu-id="cb365-253">在整個 Azure 地區中斷的罕見事件中 hello，Traffic Manager 通常是預期的 toocontinue toofunction。</span><span class="sxs-lookup"><span data-stu-id="cb365-253">In hello unlikely event of an outage of an entire Azure region, Traffic Manager is expected toocontinue toofunction normally.</span></span> <span data-ttu-id="cb365-254">部署多個 Azure 區域中的應用程式可以依賴 Traffic Manager toodirect 流量 tooan 可用其應用程式執行個體。</span><span class="sxs-lookup"><span data-stu-id="cb365-254">Applications deployed in multiple Azure regions can rely on Traffic Manager toodirect traffic tooan available instance of their application.</span></span>

### <a name="how-does-hello-choice-of-resource-group-location-affect-traffic-manager"></a><span data-ttu-id="cb365-255">資源群組位置 hello 選擇如何影響 Traffic Manager？</span><span class="sxs-lookup"><span data-stu-id="cb365-255">How does hello choice of resource group location affect Traffic Manager?</span></span>

<span data-ttu-id="cb365-256">流量管理員是單一全域服務。</span><span class="sxs-lookup"><span data-stu-id="cb365-256">Traffic Manager is a single, global service.</span></span> <span data-ttu-id="cb365-257">不是區域性。</span><span class="sxs-lookup"><span data-stu-id="cb365-257">It is not regional.</span></span> <span data-ttu-id="cb365-258">hello 所選擇的資源群組位置可讓部署該資源群組中沒有差異 tooTraffic 管理員設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-258">hello choice of resource group location makes no difference tooTraffic Manager profiles deployed in that resource group.</span></span>

<span data-ttu-id="cb365-259">Azure 資源管理員需要所有的資源群組 toospecify 位置，這會決定部署資源的資源群組中的 hello 預設位置。</span><span class="sxs-lookup"><span data-stu-id="cb365-259">Azure Resource Manager requires all resource groups toospecify a location, which determines hello default location for resources deployed in that resource group.</span></span> <span data-ttu-id="cb365-260">當您建立流量管理員設定檔時，它會建立在資源群組中。</span><span class="sxs-lookup"><span data-stu-id="cb365-260">When you create a Traffic Manager profile, it is created in a resource group.</span></span> <span data-ttu-id="cb365-261">所有的 Traffic Manager 設定檔使用**全域**作為其位置，覆寫 hello 資源群組的預設值。</span><span class="sxs-lookup"><span data-stu-id="cb365-261">All Traffic Manager profiles use **global** as their location, overriding hello resource group default.</span></span>

### <a name="how-do-i-determine-hello-current-health-of-each-endpoint"></a><span data-ttu-id="cb365-262">我要如何判斷 hello 的每個端點的目前健全狀況？</span><span class="sxs-lookup"><span data-stu-id="cb365-262">How do I determine hello current health of each endpoint?</span></span>

<span data-ttu-id="cb365-263">hello 目前監視的每個端點的狀態，在加法 toohello 整體的設定檔，會顯示在 hello Azure 入口網站。</span><span class="sxs-lookup"><span data-stu-id="cb365-263">hello current monitoring status of each endpoint, in addition toohello overall profile, is displayed in hello Azure portal.</span></span> <span data-ttu-id="cb365-264">這項資訊也可以使用透過 hello 流量監視[REST API](https://msdn.microsoft.com/library/azure/mt163667.aspx)， [PowerShell cmdlet](https://msdn.microsoft.com/library/mt125941.aspx)，和[跨平台 Azure CLI](../cli-install-nodejs.md)。</span><span class="sxs-lookup"><span data-stu-id="cb365-264">This information also is available via hello Traffic Monitor [REST API](https://msdn.microsoft.com/library/azure/mt163667.aspx), [PowerShell cmdlets](https://msdn.microsoft.com/library/mt125941.aspx), and [cross-platform Azure CLI](../cli-install-nodejs.md).</span></span>

<span data-ttu-id="cb365-265">Azure 不提供過去端點相關的歷程記錄資訊的相關變更 tooendpoint 健全狀況的健全狀況或 hello 能力 tooraise 警示。</span><span class="sxs-lookup"><span data-stu-id="cb365-265">Azure does not provide historical information about past endpoint health or hello ability tooraise alerts about changes tooendpoint health.</span></span>

### <a name="can-i-monitor-https-endpoints"></a><span data-ttu-id="cb365-266">我可以監視 HTTPS 端點嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-266">Can I monitor HTTPS endpoints?</span></span>

<span data-ttu-id="cb365-267">是。</span><span class="sxs-lookup"><span data-stu-id="cb365-267">Yes.</span></span> <span data-ttu-id="cb365-268">流量管理員支援透過 HTTPS 探查。</span><span class="sxs-lookup"><span data-stu-id="cb365-268">Traffic Manager supports probing over HTTPS.</span></span> <span data-ttu-id="cb365-269">設定**HTTPS**做為 hello 監視設定中的 hello 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="cb365-269">Configure **HTTPS** as hello protocol in hello monitoring configuration.</span></span>

<span data-ttu-id="cb365-270">流量管理員無法提供任何憑證驗證，包括：</span><span class="sxs-lookup"><span data-stu-id="cb365-270">Traffic manager cannot provide any certificate validation, including:</span></span>

* <span data-ttu-id="cb365-271">不會驗證伺服器端憑證</span><span class="sxs-lookup"><span data-stu-id="cb365-271">Server-side certificates are not validated</span></span>
* <span data-ttu-id="cb365-272">不支援 SNI 伺服器端憑證</span><span class="sxs-lookup"><span data-stu-id="cb365-272">SNI server-side certificates are not supported</span></span>
* <span data-ttu-id="cb365-273">不支援用戶端憑證</span><span class="sxs-lookup"><span data-stu-id="cb365-273">Client certificates are not supported</span></span>

### <a name="can-i-use-traffic-manager-even-if-my-application-does-not-have-support-for-http-or-https"></a><span data-ttu-id="cb365-274">即使我的應用程式不支援 HTTP 或 HTTPS 也可以使用流量管理員嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-274">Can I use Traffic Manager even if my application does not have support for HTTP or HTTPS?</span></span>

<span data-ttu-id="cb365-275">是。</span><span class="sxs-lookup"><span data-stu-id="cb365-275">Yes.</span></span> <span data-ttu-id="cb365-276">您可以指定 TCP 通訊協定和 Traffic Manager 監視的 hello 可以起始 TCP 連線，或等候 hello 端點的回應。</span><span class="sxs-lookup"><span data-stu-id="cb365-276">You can specify TCP as hello monitoring protocol and Traffic Manager can initiate a TCP connection and wait for a response from hello endpoint.</span></span> <span data-ttu-id="cb365-277">如果 hello 端點回覆 toohello 連線要求與回應 tooestablish hello 連接，hello 逾時時間內期間，則該端點會標示為狀況良好。</span><span class="sxs-lookup"><span data-stu-id="cb365-277">If hello endpoint replies toohello connection request with a response tooestablish hello connection, within hello timeout period, then that endpoint is marked as healthy.</span></span>

### <a name="what-specific-responses-are-required-from-hello-endpoint-when-using-tcp-monitoring"></a><span data-ttu-id="cb365-278">使用 TCP 監視時從 hello 端點需要哪些特定回應？</span><span class="sxs-lookup"><span data-stu-id="cb365-278">What specific responses are required from hello endpoint when using TCP monitoring?</span></span>

<span data-ttu-id="cb365-279">使用 TCP 監視時，Traffic Manager 會開始傳送 SYN 三向 TCP 交握要求在 tooendpoint hello 指定的連接埠。</span><span class="sxs-lookup"><span data-stu-id="cb365-279">When TCP monitoring is used, Traffic Manager starts a three-way TCP handshake by sending a SYN request tooendpoint at hello specified port.</span></span> <span data-ttu-id="cb365-280">接著會等待一段時間 （如 hello 逾時設定中指定） 的回應 hello 端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-280">It then waits for a period of time (as specified in hello timeout settings) for a response from hello endpoint.</span></span> <span data-ttu-id="cb365-281">如果 hello 端點回應 toohello SYN SYN ACK 回應 hello 監視設定，在指定的 hello 逾時期間內要求，則該端點視為狀況良好。</span><span class="sxs-lookup"><span data-stu-id="cb365-281">If hello endpoint responds toohello SYN request with a SYN-ACK response within hello timeout period specified in hello monitoring settings, then that endpoint is considered healthy.</span></span> <span data-ttu-id="cb365-282">收到 hello SYN ACK 回應時，如果 hello Traffic Manager 重設回與 RST 回應 hello 連線。</span><span class="sxs-lookup"><span data-stu-id="cb365-282">If hello SYN-ACK response is received, hello Traffic Manager resets hello connection by responding back with a RST.</span></span>

### <a name="how-fast-does-traffic-manager-move-my-users-away-from-an-unhealthy-endpoint"></a><span data-ttu-id="cb365-283">流量管理員將我的使用者從狀況不良的端點移開時間有多快？</span><span class="sxs-lookup"><span data-stu-id="cb365-283">How fast does Traffic Manager move my users away from an unhealthy endpoint?</span></span>

<span data-ttu-id="cb365-284">Traffic Manager 所提供多項設定，可協助您 toocontrol hello 容錯移轉行為，您的 Traffic Manager 設定檔，如下所示：</span><span class="sxs-lookup"><span data-stu-id="cb365-284">Traffic Manager provides multiple settings that can help you toocontrol hello failover behavior of your Traffic Manager profile as follows:</span></span>
- <span data-ttu-id="cb365-285">您可以指定 hello 更頻繁地藉由設定 Traffic Manager 探查 hello 端點 hello 探查間隔，在 10 秒。</span><span class="sxs-lookup"><span data-stu-id="cb365-285">you can specify that hello Traffic Manager probes hello endpoints more frequently by setting hello Probing Interval at 10 seconds.</span></span> <span data-ttu-id="cb365-286">這可確保能夠立即偵測到狀況不良的任何端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-286">This ensures that any endpoint going unhealthy can be detected as soon as possible.</span></span> 
- <span data-ttu-id="cb365-287">您可以指定 toowait 健全狀況檢查要求之前逾時的時間長度 （最小逾時值是 5 秒）。</span><span class="sxs-lookup"><span data-stu-id="cb365-287">you can specify how long toowait before a health check request times out (minimum time out value is 5 sec).</span></span>
- <span data-ttu-id="cb365-288">您可以指定 hello 端點標示為狀況不良之前，可能會發生多少次失敗。</span><span class="sxs-lookup"><span data-stu-id="cb365-288">you can specify how many failures can occur before hello endpoint is marked as unhealthy.</span></span> <span data-ttu-id="cb365-289">這個值可以是下限為 0，第一個的健康情況檢查在哪一個案例的 hello 端點標示為狀況不良時失敗的 hello。</span><span class="sxs-lookup"><span data-stu-id="cb365-289">This value can be low as 0, in which case hello endpoint is marked unhealthy as soon as it fails hello first health check.</span></span> <span data-ttu-id="cb365-290">不過，使用 hello 所容許之失敗次數的 hello 最小值為 0 可能會導致 tooendpoints 取得離輪替循環，因為 tooany 的探查 hello 時間可能會發生的暫時性問題。</span><span class="sxs-lookup"><span data-stu-id="cb365-290">However, using hello minimum value of 0 for hello tolerated number of failures can lead tooendpoints being taken out of rotation due tooany transient issues that may occur at hello time of probing.</span></span>
- <span data-ttu-id="cb365-291">您可以指定為 0 的 hello DNS 回應 toobe hello 存留時間 (TTL)。</span><span class="sxs-lookup"><span data-stu-id="cb365-291">you can specify hello time-to-live (TTL) for hello DNS response toobe as low as 0.</span></span> <span data-ttu-id="cb365-292">這麼做會表示的 DNS 解析程式無法快取 hello 回應，每個新的查詢會取得包含最新健全狀況資訊 hello 回應該 hello Traffic Manager 有。</span><span class="sxs-lookup"><span data-stu-id="cb365-292">Doing so means that DNS resolvers cannot cache hello response and each new query gets a response that incorporates hello most up-to-date health information that hello Traffic Manager has.</span></span>

<span data-ttu-id="cb365-293">透過使用這些設定，Traffic Manager 可以提供容錯移轉在 10 秒後端點會處於狀況不良，並針對 hello 對應的設定檔進行 DNS 查詢。</span><span class="sxs-lookup"><span data-stu-id="cb365-293">By using these settings, Traffic Manager can provide failovers under 10 seconds after an endpoint goes unhealthy and a DNS query is made against hello corresponding profile.</span></span>

### <a name="how-can-i-specify-different-monitoring-settings-for-different-endpoints-in-a-profile"></a><span data-ttu-id="cb365-294">如何為設定檔中不同的端點指定不同監視設定？</span><span class="sxs-lookup"><span data-stu-id="cb365-294">How can I specify different monitoring settings for different endpoints in a profile?</span></span>

<span data-ttu-id="cb365-295">流量管理員監視設定是在各個設定檔層級。</span><span class="sxs-lookup"><span data-stu-id="cb365-295">Traffic Manager monitoring settings are at a per profile level.</span></span> <span data-ttu-id="cb365-296">如果您需要 toouse 不同的監視設定為只能有一個端點時，可以透過讓該端點，如[巢狀設定檔](traffic-manager-nested-profiles.md)其監視的設定會與不同 hello 父系設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-296">If you need toouse a different monitoring setting for only one endpoint, it can be done by having that endpoint as a [nested profile](traffic-manager-nested-profiles.md) whose monitoring settings are different from hello parent profile.</span></span>

### <a name="what-host-header-do-endpoint-health-checks-use"></a><span data-ttu-id="cb365-297">端點健全狀況檢查使用哪一個主機標頭？</span><span class="sxs-lookup"><span data-stu-id="cb365-297">What host header do endpoint health checks use?</span></span>

<span data-ttu-id="cb365-298">流量管理員在 HTTP 和 HTTPS 的健康狀態檢查中使用主機標頭。</span><span class="sxs-lookup"><span data-stu-id="cb365-298">Traffic Manager uses host headers in HTTP and HTTPS health checks.</span></span> <span data-ttu-id="cb365-299">hello Traffic Manager 所使用的主機標頭是 hello hello hello 設定檔中設定的端點目標名稱。</span><span class="sxs-lookup"><span data-stu-id="cb365-299">hello host header used by Traffic Manager is hello name of hello endpoint target configured in hello profile.</span></span> <span data-ttu-id="cb365-300">無法從 hello 目標屬性分別指定 hello hello 主機標頭中使用的值。</span><span class="sxs-lookup"><span data-stu-id="cb365-300">hello value used in hello host header cannot be specified separately from hello target property.</span></span>

### <a name="what-are-hello-ip-addresses-from-which-hello-health-checks-originate"></a><span data-ttu-id="cb365-301">從中 hello 健康情況檢查源自 hello IP 位址有哪些？</span><span class="sxs-lookup"><span data-stu-id="cb365-301">What are hello IP addresses from which hello health checks originate?</span></span>

<span data-ttu-id="cb365-302">hello 下列清單包含要從中 Traffic Manager 的健康情況檢查可能源自 hello IP 位址。</span><span class="sxs-lookup"><span data-stu-id="cb365-302">hello following list contains hello IP addresses from which Traffic Manager health checks can originate.</span></span> <span data-ttu-id="cb365-303">您可以使用此清單 tooensure，來自這些 IP 位址的連入連線可以在 hello 端點 toocheck 其健全狀況狀態。</span><span class="sxs-lookup"><span data-stu-id="cb365-303">You may use this list tooensure that incoming connections from these IP addresses are allowed at hello endpoints toocheck its health status.</span></span>

* <span data-ttu-id="cb365-304">40.68.30.66</span><span class="sxs-lookup"><span data-stu-id="cb365-304">40.68.30.66</span></span>
* <span data-ttu-id="cb365-305">40.68.31.178</span><span class="sxs-lookup"><span data-stu-id="cb365-305">40.68.31.178</span></span>
* <span data-ttu-id="cb365-306">137.135.80.149</span><span class="sxs-lookup"><span data-stu-id="cb365-306">137.135.80.149</span></span>
* <span data-ttu-id="cb365-307">137.135.82.249</span><span class="sxs-lookup"><span data-stu-id="cb365-307">137.135.82.249</span></span>
* <span data-ttu-id="cb365-308">23.96.236.252</span><span class="sxs-lookup"><span data-stu-id="cb365-308">23.96.236.252</span></span>
* <span data-ttu-id="cb365-309">65.52.217.19</span><span class="sxs-lookup"><span data-stu-id="cb365-309">65.52.217.19</span></span>
* <span data-ttu-id="cb365-310">40.87.147.10</span><span class="sxs-lookup"><span data-stu-id="cb365-310">40.87.147.10</span></span>
* <span data-ttu-id="cb365-311">40.87.151.34</span><span class="sxs-lookup"><span data-stu-id="cb365-311">40.87.151.34</span></span>
* <span data-ttu-id="cb365-312">13.75.124.254</span><span class="sxs-lookup"><span data-stu-id="cb365-312">13.75.124.254</span></span>
* <span data-ttu-id="cb365-313">13.75.127.63</span><span class="sxs-lookup"><span data-stu-id="cb365-313">13.75.127.63</span></span>
* <span data-ttu-id="cb365-314">52.172.155.168</span><span class="sxs-lookup"><span data-stu-id="cb365-314">52.172.155.168</span></span>
* <span data-ttu-id="cb365-315">52.172.158.37</span><span class="sxs-lookup"><span data-stu-id="cb365-315">52.172.158.37</span></span>
* <span data-ttu-id="cb365-316">104.215.91.84</span><span class="sxs-lookup"><span data-stu-id="cb365-316">104.215.91.84</span></span>
* <span data-ttu-id="cb365-317">13.75.153.124</span><span class="sxs-lookup"><span data-stu-id="cb365-317">13.75.153.124</span></span>
* <span data-ttu-id="cb365-318">13.84.222.37</span><span class="sxs-lookup"><span data-stu-id="cb365-318">13.84.222.37</span></span>
* <span data-ttu-id="cb365-319">23.101.191.199</span><span class="sxs-lookup"><span data-stu-id="cb365-319">23.101.191.199</span></span>
* <span data-ttu-id="cb365-320">23.96.213.12</span><span class="sxs-lookup"><span data-stu-id="cb365-320">23.96.213.12</span></span>
* <span data-ttu-id="cb365-321">137.135.46.163</span><span class="sxs-lookup"><span data-stu-id="cb365-321">137.135.46.163</span></span>
* <span data-ttu-id="cb365-322">137.135.47.215</span><span class="sxs-lookup"><span data-stu-id="cb365-322">137.135.47.215</span></span>
* <span data-ttu-id="cb365-323">191.232.208.52</span><span class="sxs-lookup"><span data-stu-id="cb365-323">191.232.208.52</span></span>
* <span data-ttu-id="cb365-324">191.232.214.62</span><span class="sxs-lookup"><span data-stu-id="cb365-324">191.232.214.62</span></span>
* <span data-ttu-id="cb365-325">13.75.152.253</span><span class="sxs-lookup"><span data-stu-id="cb365-325">13.75.152.253</span></span>
* <span data-ttu-id="cb365-326">104.41.187.209</span><span class="sxs-lookup"><span data-stu-id="cb365-326">104.41.187.209</span></span>
* <span data-ttu-id="cb365-327">104.41.190.203</span><span class="sxs-lookup"><span data-stu-id="cb365-327">104.41.190.203</span></span>

### <a name="how-many-health-checks-toomy-endpoint-can-i-expect-from-traffic-manager"></a><span data-ttu-id="cb365-328">多少健全狀況檢查 toomy 端點應該會有從 Traffic Manager？</span><span class="sxs-lookup"><span data-stu-id="cb365-328">How many health checks toomy endpoint can I expect from Traffic Manager?</span></span>

<span data-ttu-id="cb365-329">hello 數目 Traffic Manager 健全狀況檢查到達您的端點取決於下列 hello:</span><span class="sxs-lookup"><span data-stu-id="cb365-329">hello number of Traffic Manager health checks reaching your endpoint depends on hello following:</span></span>
- <span data-ttu-id="cb365-330">hello hello 監視間隔為設定的值 （較小的間隔表示在任何給定的時間期間內登陸在您的端點上的更多要求）。</span><span class="sxs-lookup"><span data-stu-id="cb365-330">hello value that you have set for hello monitoring interval (smaller interval means more requests landing on your endpoint in any given time period).</span></span>
- <span data-ttu-id="cb365-331">hello 位置 hello 健康情況檢查產生 （hello IP 位址與其中預期這些檢查會列在 hello 前面常見問題集） 的位置數目。</span><span class="sxs-lookup"><span data-stu-id="cb365-331">hello number of locations from where hello health checks originate (hello IP addresses from where you can expect these checks is listed in hello preceding FAQ).</span></span>

## <a name="traffic-manager-nested-profiles"></a><span data-ttu-id="cb365-332">流量管理員巢狀設定檔</span><span class="sxs-lookup"><span data-stu-id="cb365-332">Traffic Manager nested profiles</span></span>

### <a name="how-do-i-configure-nested-profiles"></a><span data-ttu-id="cb365-333">如何設定巢狀設定檔？</span><span class="sxs-lookup"><span data-stu-id="cb365-333">How do I configure nested profiles?</span></span>

<span data-ttu-id="cb365-334">巢狀 流量管理員設定檔可以使用這兩個 hello Azure 資源管理員來設定和 hello 傳統 Azure REST Api，Azure PowerShell cmdlet 和跨平台 Azure CLI 命令。</span><span class="sxs-lookup"><span data-stu-id="cb365-334">Nested Traffic Manager profiles can be configured using both hello Azure Resource Manager and hello classic Azure REST APIs, Azure PowerShell cmdlets and cross-platform Azure CLI commands.</span></span> <span data-ttu-id="cb365-335">它們也支援透過 hello 新版 Azure 入口網站。</span><span class="sxs-lookup"><span data-stu-id="cb365-335">They are also supported via hello new Azure portal.</span></span> <span data-ttu-id="cb365-336">它們不支援 hello 傳統入口網站中。</span><span class="sxs-lookup"><span data-stu-id="cb365-336">They are not supported in hello classic portal.</span></span>

### <a name="how-many-layers-of-nesting-does-traffic-manger-support"></a><span data-ttu-id="cb365-337">流量管理員支援幾層巢狀結構？</span><span class="sxs-lookup"><span data-stu-id="cb365-337">How many layers of nesting does Traffic Manger support?</span></span>

<span data-ttu-id="cb365-338">您可以巢狀深度 too10 層級上的設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-338">You can nest profiles up too10 levels deep.</span></span> <span data-ttu-id="cb365-339">不允許使用「迴圈」。</span><span class="sxs-lookup"><span data-stu-id="cb365-339">'Loops' are not permitted.</span></span>

### <a name="can-i-mix-other-endpoint-types-with-nested-child-profiles-in-hello-same-traffic-manager-profile"></a><span data-ttu-id="cb365-340">可以我混合其他端點類型巢狀的子系的設定檔，請在 hello 相同 Traffic Manager 設定檔嗎？</span><span class="sxs-lookup"><span data-stu-id="cb365-340">Can I mix other endpoint types with nested child profiles, in hello same Traffic Manager profile?</span></span>

<span data-ttu-id="cb365-341">是。</span><span class="sxs-lookup"><span data-stu-id="cb365-341">Yes.</span></span> <span data-ttu-id="cb365-342">對於在設定檔內如何結合不同類型的端點，並沒有任何限制。</span><span class="sxs-lookup"><span data-stu-id="cb365-342">There are no restrictions on how you combine endpoints of different types within a profile.</span></span>

### <a name="how-does-hello-billing-model-apply-for-nested-profiles"></a><span data-ttu-id="cb365-343">Hello 計費模型如何套用的巢狀設定檔？</span><span class="sxs-lookup"><span data-stu-id="cb365-343">How does hello billing model apply for Nested profiles?</span></span>

<span data-ttu-id="cb365-344">使用巢狀設定檔並沒有計價上的負面影響。</span><span class="sxs-lookup"><span data-stu-id="cb365-344">There is no negative pricing impact of using nested profiles.</span></span>

<span data-ttu-id="cb365-345">流量管理員計費有兩個要素︰端點健康狀態檢查和數百萬個 DNS 查詢</span><span class="sxs-lookup"><span data-stu-id="cb365-345">Traffic Manager billing has two components: endpoint health checks and millions of DNS queries</span></span>

* <span data-ttu-id="cb365-346">端點健康情況檢查︰當子設定檔被設定為父設定檔中的端點時，並不會針對該子設定檔收費。</span><span class="sxs-lookup"><span data-stu-id="cb365-346">Endpoint health checks: There is no charge for a child profile when configured as an endpoint in a parent profile.</span></span> <span data-ttu-id="cb365-347">監視的 hello 子項設定檔中的 hello 端點在 hello 計費一般方式。</span><span class="sxs-lookup"><span data-stu-id="cb365-347">Monitoring of hello endpoints in hello child profile is billed in hello usual way.</span></span>
* <span data-ttu-id="cb365-348">DNS 查詢：每個查詢只計算一次。</span><span class="sxs-lookup"><span data-stu-id="cb365-348">DNS queries: Each query is only counted once.</span></span> <span data-ttu-id="cb365-349">針對傳回端點的子項設定檔從父設定檔的查詢會計算針對 hello 父系設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-349">A query against a parent profile that returns an endpoint from a child profile is counted against hello parent profile only.</span></span>

<span data-ttu-id="cb365-350">完整的詳細資訊，請參閱 hello [Traffic Manager 定價頁面](https://azure.microsoft.com/pricing/details/traffic-manager/)。</span><span class="sxs-lookup"><span data-stu-id="cb365-350">For full details, see hello [Traffic Manager pricing page](https://azure.microsoft.com/pricing/details/traffic-manager/).</span></span>

### <a name="is-there-a-performance-impact-for-nested-profiles"></a><span data-ttu-id="cb365-351">巢狀設定檔是否會對效能造成影響？</span><span class="sxs-lookup"><span data-stu-id="cb365-351">Is there a performance impact for nested profiles?</span></span>

<span data-ttu-id="cb365-352">沒有。</span><span class="sxs-lookup"><span data-stu-id="cb365-352">No.</span></span> <span data-ttu-id="cb365-353">使用巢狀設定檔不會影響效能。</span><span class="sxs-lookup"><span data-stu-id="cb365-353">There is no performance impact incurred when using nested profiles.</span></span>

<span data-ttu-id="cb365-354">hello Traffic Manager 名稱伺服器在內部周遊 hello 設定檔的階層，在處理每個 DNS 查詢。</span><span class="sxs-lookup"><span data-stu-id="cb365-354">hello Traffic Manager name servers traverse hello profile hierarchy internally when processing each DNS query.</span></span> <span data-ttu-id="cb365-355">DNS 查詢 tooa 父系設定檔可以接收與端點的 DNS 回應中的子項設定檔。</span><span class="sxs-lookup"><span data-stu-id="cb365-355">A DNS query tooa parent profile can receive a DNS response with an endpoint from a child profile.</span></span> <span data-ttu-id="cb365-356">不論您使用單一設定檔或巢狀設定檔，都只會使用單一 CNAME 記錄。</span><span class="sxs-lookup"><span data-stu-id="cb365-356">A single CNAME record is used whether you are using a single profile or nested profiles.</span></span> <span data-ttu-id="cb365-357">沒有任何需要 toocreate hello 階層中每個設定檔的 CNAME 記錄。</span><span class="sxs-lookup"><span data-stu-id="cb365-357">There is no need toocreate a CNAME record for each profile in hello hierarchy.</span></span>

### <a name="how-does-traffic-manager-compute-hello-health-of-a-nested-endpoint-in-a-parent-profile"></a><span data-ttu-id="cb365-358">Traffic Manager 如何計算 hello 的父系設定檔中的巢狀端點的健全狀況？</span><span class="sxs-lookup"><span data-stu-id="cb365-358">How does Traffic Manager compute hello health of a nested endpoint in a parent profile?</span></span>

<span data-ttu-id="cb365-359">hello 父系設定檔不會直接執行 hello 子系上的健康情況檢查。</span><span class="sxs-lookup"><span data-stu-id="cb365-359">hello parent profile doesn't perform health checks on hello child directly.</span></span> <span data-ttu-id="cb365-360">相反地，hello hello 子項設定檔的端點健全狀況是使用的 toocalculate hello hello 子項設定檔的整體健全狀況。</span><span class="sxs-lookup"><span data-stu-id="cb365-360">Instead, hello health of hello child profile's endpoints are used toocalculate hello overall health of hello child profile.</span></span> <span data-ttu-id="cb365-361">這項資訊會傳播 hello 巢狀設定檔階層 toodetermine hello 健全狀況的巢狀的 hello 端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-361">This information is propagated up hello nested profile hierarchy toodetermine hello health of hello nested endpoint.</span></span> <span data-ttu-id="cb365-362">hello 父系設定檔會使用此彙總健全狀況 toodetermine 是否 hello 流量可以成為導向的 toohello 子系。</span><span class="sxs-lookup"><span data-stu-id="cb365-362">hello parent profile uses this aggregated health toodetermine whether hello traffic can be directed toohello child.</span></span>

<span data-ttu-id="cb365-363">hello 下表描述 hello 行為流量管理員 」 的健全狀況檢查有巢狀的端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-363">hello following table describes hello behavior of Traffic Manager health checks for a nested endpoint.</span></span>

| <span data-ttu-id="cb365-364">子設定檔監視狀態</span><span class="sxs-lookup"><span data-stu-id="cb365-364">Child Profile Monitor status</span></span> | <span data-ttu-id="cb365-365">父端點監視狀態</span><span class="sxs-lookup"><span data-stu-id="cb365-365">Parent Endpoint Monitor status</span></span> | <span data-ttu-id="cb365-366">注意事項</span><span class="sxs-lookup"><span data-stu-id="cb365-366">Notes</span></span> |
| --- | --- | --- |
| <span data-ttu-id="cb365-367">已停用。</span><span class="sxs-lookup"><span data-stu-id="cb365-367">Disabled.</span></span> <span data-ttu-id="cb365-368">hello 子系的設定檔已停用。</span><span class="sxs-lookup"><span data-stu-id="cb365-368">hello child profile has been disabled.</span></span> |<span data-ttu-id="cb365-369">已停止</span><span class="sxs-lookup"><span data-stu-id="cb365-369">Stopped</span></span> |<span data-ttu-id="cb365-370">停止 hello 父系端點狀態，不會停用。</span><span class="sxs-lookup"><span data-stu-id="cb365-370">hello parent endpoint state is Stopped, not Disabled.</span></span> <span data-ttu-id="cb365-371">hello 停用狀態保留來指出您已停用 hello 父系設定檔中的 hello 端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-371">hello Disabled state is reserved for indicating that you have disabled hello endpoint in hello parent profile.</span></span> |
| <span data-ttu-id="cb365-372">已降級。</span><span class="sxs-lookup"><span data-stu-id="cb365-372">Degraded.</span></span> <span data-ttu-id="cb365-373">至少有一個子設定檔端點的狀態為「已降級」。</span><span class="sxs-lookup"><span data-stu-id="cb365-373">At least one child profile endpoint is in a Degraded state.</span></span> |<span data-ttu-id="cb365-374">Online: hello hello 子系的設定檔中的線上端點數目至少為 hello MinChildEndpoints 的值。</span><span class="sxs-lookup"><span data-stu-id="cb365-374">Online: hello number of Online endpoints in hello child profile is at least hello value of MinChildEndpoints.</span></span><BR><span data-ttu-id="cb365-375">CheckingEndpoint: hello hello 子項設定檔中的線上 」 加上 CheckingEndpoint 端點數目至少為 hello MinChildEndpoints 的值。</span><span class="sxs-lookup"><span data-stu-id="cb365-375">CheckingEndpoint: hello number of Online plus CheckingEndpoint endpoints in hello child profile is at least hello value of MinChildEndpoints.</span></span><BR><span data-ttu-id="cb365-376">已降級︰其他情況。</span><span class="sxs-lookup"><span data-stu-id="cb365-376">Degraded: otherwise.</span></span> |<span data-ttu-id="cb365-377">流量會路由的 tooan CheckingEndpoint 狀態的端點。</span><span class="sxs-lookup"><span data-stu-id="cb365-377">Traffic is routed tooan endpoint of status CheckingEndpoint.</span></span> <span data-ttu-id="cb365-378">如果 MinChildEndpoints 設定太高，則 hello 端點一定會降級。</span><span class="sxs-lookup"><span data-stu-id="cb365-378">If MinChildEndpoints is set too high, hello endpoint is always degraded.</span></span> |
| <span data-ttu-id="cb365-379">線上。</span><span class="sxs-lookup"><span data-stu-id="cb365-379">Online.</span></span> <span data-ttu-id="cb365-380">至少有一個子設定檔端點處於「線上」狀態。</span><span class="sxs-lookup"><span data-stu-id="cb365-380">At least one child profile endpoint is an Online state.</span></span> <span data-ttu-id="cb365-381">沒有端點處於 hello 降級 」 狀態。</span><span class="sxs-lookup"><span data-stu-id="cb365-381">No endpoint is in hello Degraded state.</span></span> |<span data-ttu-id="cb365-382">請參閱上方。</span><span class="sxs-lookup"><span data-stu-id="cb365-382">See above.</span></span> | |
| <span data-ttu-id="cb365-383">CheckingEndpoints。</span><span class="sxs-lookup"><span data-stu-id="cb365-383">CheckingEndpoints.</span></span> <span data-ttu-id="cb365-384">至少有一個子設定檔端點是 'CheckingEndpoint'。</span><span class="sxs-lookup"><span data-stu-id="cb365-384">At least one child profile endpoint is 'CheckingEndpoint'.</span></span> <span data-ttu-id="cb365-385">沒有端點是「線上」或「已降級」。</span><span class="sxs-lookup"><span data-stu-id="cb365-385">No endpoints are 'Online' or 'Degraded'</span></span> |<span data-ttu-id="cb365-386">同上。</span><span class="sxs-lookup"><span data-stu-id="cb365-386">Same as above.</span></span> | |
| <span data-ttu-id="cb365-387">非使用中。</span><span class="sxs-lookup"><span data-stu-id="cb365-387">Inactive.</span></span> <span data-ttu-id="cb365-388">所有子設定檔端點不是「已停用」就是「已停止」，或者此設定檔沒有任何端點</span><span class="sxs-lookup"><span data-stu-id="cb365-388">All child profile endpoints are either Disabled or Stopped, or this profile has no endpoints.</span></span> |<span data-ttu-id="cb365-389">已停止</span><span class="sxs-lookup"><span data-stu-id="cb365-389">Stopped</span></span> | |

## <a name="next-steps"></a><span data-ttu-id="cb365-390">後續步驟：</span><span class="sxs-lookup"><span data-stu-id="cb365-390">Next steps:</span></span>
- <span data-ttu-id="cb365-391">深入了解「流量管理員」的 [端點監視和自動容錯移轉](../traffic-manager/traffic-manager-monitoring.md)。</span><span class="sxs-lookup"><span data-stu-id="cb365-391">Learn more about Traffic Manager [endpoint monitoring and automatic failover](../traffic-manager/traffic-manager-monitoring.md).</span></span>
- <span data-ttu-id="cb365-392">深入了解「流量管理員」的 [流量路由方法](../traffic-manager/traffic-manager-routing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="cb365-392">Learn more about Traffic Manager [traffic routing methods](../traffic-manager/traffic-manager-routing-methods.md).</span></span>