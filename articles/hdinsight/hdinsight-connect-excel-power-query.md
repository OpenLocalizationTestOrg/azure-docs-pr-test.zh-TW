---
title: "有了 Power Query-Azure HDInsight aaaConnect Excel tooHadoop |Microsoft 文件"
description: "了解如何 tootake 善用商業智慧元件及使用 Power Query for Excel tooaccess 資料儲存在 HDInsight 上的 Hadoop。"
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="67d2c-103">使用 Power Query 連線 Excel tooHadoop</span><span class="sxs-lookup"><span data-stu-id="67d2c-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="67d2c-104">Hello Microsoft 巨量資料解決方案的關鍵功能是 hello 與在 Azure HDInsight Hadoop 叢集的 Microsoft 商業智慧 (BI) 元件整合。</span><span class="sxs-lookup"><span data-stu-id="67d2c-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="67d2c-105">主要範例是 hello 能力 tooconnect Excel toohello 包含 hello 資料使用 hello Microsoft Power Query for Excel 增益集與 Hadoop 叢集相關聯的 Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="67d2c-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="67d2c-106">這篇文章會引導您 tooset 註冊並使用與 Hdinsight 叢集相關聯的 Power Query tooquery 資料管理與 HDInsight 的方式。</span><span class="sxs-lookup"><span data-stu-id="67d2c-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="67d2c-107">必要條件</span><span class="sxs-lookup"><span data-stu-id="67d2c-107">Prerequisites</span></span>
<span data-ttu-id="67d2c-108">在開始這份文件之前，您必須擁有 hello 下列項目：</span><span class="sxs-lookup"><span data-stu-id="67d2c-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="67d2c-109">**HDInsight 叢集**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="67d2c-110">tooconfigure 其中一個，請參閱[開始使用 Azure HDInsight][hdinsight-get-started]。</span><span class="sxs-lookup"><span data-stu-id="67d2c-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="67d2c-111">**工作站** 。</span><span class="sxs-lookup"><span data-stu-id="67d2c-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="67d2c-112">**Office 2016、Office 2013 專業增強版、Office 365 專業增強版、Excel 2013 獨立版或 Office 2010 專業增強版**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="67d2c-113">安裝 Power Query</span><span class="sxs-lookup"><span data-stu-id="67d2c-113">Install Power Query</span></span>
<span data-ttu-id="67d2c-114">Power Query 可匯入在 HDInsight 叢集上執行的 Hadoop 工作所匯出或產生的資料。</span><span class="sxs-lookup"><span data-stu-id="67d2c-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="67d2c-115">在 Excel 2016 中，Power Query 已整合至 hello 資料 功能區 hello 取得和轉換 區段下。</span><span class="sxs-lookup"><span data-stu-id="67d2c-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="67d2c-116">對於較舊的 Excel 版本中，下載 Microsoft Power Query for Excel 從 hello [Microsoft Download Center] [ powerquery-download]並安裝它。</span><span class="sxs-lookup"><span data-stu-id="67d2c-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="67d2c-117">將 HDInsight 資料匯入 Excel 中</span><span class="sxs-lookup"><span data-stu-id="67d2c-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="67d2c-118">Power Query 增益集適用於 Excel 的 hello 可從您的 HDInsight 叢集到 Excel，其中 BI 工具，例如 PowerPivot 和 Power 對應可以是使用的 tooinspect、 分析和呈現 hello 資料輕鬆 tooimport 資料。</span><span class="sxs-lookup"><span data-stu-id="67d2c-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="67d2c-119">**tooimport 資料從 HDInsight 叢集**</span><span class="sxs-lookup"><span data-stu-id="67d2c-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="67d2c-120">開啟 Excel。</span><span class="sxs-lookup"><span data-stu-id="67d2c-120">Open Excel.</span></span>
2. <span data-ttu-id="67d2c-121">建立新的空白活頁簿。</span><span class="sxs-lookup"><span data-stu-id="67d2c-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="67d2c-122">執行下列步驟以 hello Excel 版本為基礎的 hello:</span><span class="sxs-lookup"><span data-stu-id="67d2c-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="67d2c-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="67d2c-123">Excel 2016</span></span>

        - <span data-ttu-id="67d2c-124">按一下 hello**資料**功能表上，按一下 **取得資料**從 hello**取得與轉換資料**功能區中，按一下 **從 Azure**，然後按一下 **從 Azure HDInsight(HDFS)**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="67d2c-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="67d2c-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="67d2c-127">按一下 hello **Power Query**功能表上，按一下 **從 Azure**，然後按一下**從 Microsoft Azure HDInsight**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="67d2c-129">**注意：**如果您沒有看見 hello **Power Query**功能表上，移過**檔案** > **選項** > **增益集**，然後選取**COM 增益集**hello 下拉式清單中**管理**在 hello hello 頁面底部的方塊。</span><span class="sxs-lookup"><span data-stu-id="67d2c-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="67d2c-130">選取 hello**移...**按鈕，並確認該 hello 方塊為已核取 hello Power Query for Excel 增益集。</span><span class="sxs-lookup"><span data-stu-id="67d2c-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="67d2c-131">**注意：** Power Query 也可讓您從 HDFS tooimport 資料即可**從其他來源**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="67d2c-132">如**帳戶名稱**，輸入 hello hello 與您的叢集相關聯的 Azure Blob 儲存體帳戶名稱，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="67d2c-133">此帳戶可以是 hello[預設儲存體帳戶](hdinsight-administer-use-management-portal.md#find-the-default-storage-account)或連結的儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="67d2c-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="67d2c-134">hello 格式是*https://&lt;StorageAccountName >.blob.core.windows.net/*。</span><span class="sxs-lookup"><span data-stu-id="67d2c-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="67d2c-135">如**帳戶金鑰**，輸入 hello hello Blob 儲存體帳戶金鑰，然後按一下**儲存**。</span><span class="sxs-lookup"><span data-stu-id="67d2c-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="67d2c-136">（您需要 tooenter hello 帳戶資訊只有 hello 存取這個存放區的第一次）。</span><span class="sxs-lookup"><span data-stu-id="67d2c-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="67d2c-137">在 hello**導覽**hello 窗格左邊 hello 查詢編輯器中，按兩下 hello Blob 儲存體容器名稱。</span><span class="sxs-lookup"><span data-stu-id="67d2c-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="67d2c-138">根據預設，hello 容器名稱是 hello 相同名稱做為 hello 叢集名稱。</span><span class="sxs-lookup"><span data-stu-id="67d2c-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="67d2c-139">找出**HiveSampleData.txt**在 hello**名稱**資料行 (hello 的資料夾路徑**../ hive/倉儲/hivesampletable/**)，然後按一下**二進位**左邊的 HiveSampleData.txt hello。</span><span class="sxs-lookup"><span data-stu-id="67d2c-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="67d2c-140">HiveSampleData.txt 隨附於所有 hello 叢集。</span><span class="sxs-lookup"><span data-stu-id="67d2c-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="67d2c-141">您也可以選擇使用您自己的檔案。</span><span class="sxs-lookup"><span data-stu-id="67d2c-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="67d2c-143">如果您想，您可以重新命名 hello 資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="67d2c-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="67d2c-144">請在準備就緒後，按一下 [關閉並載入]。</span><span class="sxs-lookup"><span data-stu-id="67d2c-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="67d2c-145">hello 資料已經載入的 tooyour 活頁簿：</span><span class="sxs-lookup"><span data-stu-id="67d2c-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="67d2c-147">後續步驟</span><span class="sxs-lookup"><span data-stu-id="67d2c-147">Next steps</span></span>
<span data-ttu-id="67d2c-148">在本文中，您學到如何 toouse HDInsight 到 Excel 的 Power Query tooretrieve 資料。</span><span class="sxs-lookup"><span data-stu-id="67d2c-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="67d2c-149">同樣地，您也可以將 HDInsight 中的資料擷取至 Azure SQL Database。</span><span class="sxs-lookup"><span data-stu-id="67d2c-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="67d2c-150">它也是可能 tooupload HDInsight 資料。</span><span class="sxs-lookup"><span data-stu-id="67d2c-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="67d2c-151">toolearn 詳細資訊，請參閱下列文章 hello:</span><span class="sxs-lookup"><span data-stu-id="67d2c-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="67d2c-152">[Excel tooHDInsight 連接以 hello Microsoft Hive ODBC 驅動程式][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="67d2c-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="67d2c-153">[上傳資料 tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="67d2c-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
