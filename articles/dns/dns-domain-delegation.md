---
title: "Azure DNS 委派概觀 | Microsoft Docs"
description: "了解如何變更網域委派及使用 Azure DNS 名稱伺服器提供網域主機代管。"
services: dns
documentationcenter: na
author: georgewallace
manager: timlt
ms.assetid: 257da6ec-d6e2-4b6f-ad76-ee2dde4efbcc
ms.service: dns
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/12/2017
ms.author: gwallace
ms.openlocfilehash: 31a500502a4d3e729ecb79929ed6c1de156d6259
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="delegation-of-dns-zones-with-azure-dns"></a><span data-ttu-id="f6e48-103">使用 Azure DNS 的 DNS 區域委派</span><span class="sxs-lookup"><span data-stu-id="f6e48-103">Delegation of DNS zones with Azure DNS</span></span>

<span data-ttu-id="f6e48-104">Azure DNS 可讓您裝載 DNS 區域，並在 Azure 中管理網域的 DNS 記錄。</span><span class="sxs-lookup"><span data-stu-id="f6e48-104">Azure DNS allows you to host a DNS zone and manage the DNS records for a domain in Azure.</span></span> <span data-ttu-id="f6e48-105">網域必須從父系網域委派給 Azure DNS，該網域的 DNS 查詢才能送達 Azure DNS。</span><span class="sxs-lookup"><span data-stu-id="f6e48-105">In order for DNS queries for a domain to reach Azure DNS, the domain has to be delegated to Azure DNS from the parent domain.</span></span> <span data-ttu-id="f6e48-106">請記住，Azure DNS 不是網域註冊機構。</span><span class="sxs-lookup"><span data-stu-id="f6e48-106">Keep in mind Azure DNS is not the domain registrar.</span></span> <span data-ttu-id="f6e48-107">本文說明網域委派的運作方式，以及如何將網域委派給 Azure DNS。</span><span class="sxs-lookup"><span data-stu-id="f6e48-107">This article explains how domain delegation works and how to delegate domains to Azure DNS.</span></span>

## <a name="how-dns-delegation-works"></a><span data-ttu-id="f6e48-108">DNS 委派的運作方式</span><span class="sxs-lookup"><span data-stu-id="f6e48-108">How DNS delegation works</span></span>

### <a name="domains-and-zones"></a><span data-ttu-id="f6e48-109">網域和區域</span><span class="sxs-lookup"><span data-stu-id="f6e48-109">Domains and zones</span></span>

<span data-ttu-id="f6e48-110">網域名稱系統是網域階層。</span><span class="sxs-lookup"><span data-stu-id="f6e48-110">The Domain Name System is a hierarchy of domains.</span></span> <span data-ttu-id="f6e48-111">階層從「根」網域開始，其名稱只是 '**.**'。</span><span class="sxs-lookup"><span data-stu-id="f6e48-111">The hierarchy starts from the 'root' domain, whose name is simply '**.**'.</span></span>  <span data-ttu-id="f6e48-112">下面接著最上層網域，例如 'com'、'net'、'org'、'uk' 或 'jp'。</span><span class="sxs-lookup"><span data-stu-id="f6e48-112">Below this come top-level domains, such as 'com', 'net', 'org', 'uk' or 'jp'.</span></span>  <span data-ttu-id="f6e48-113">最上層網域下面是第二層網域，例如 'org.uk' 或 'co.jp'。</span><span class="sxs-lookup"><span data-stu-id="f6e48-113">Below these top-level domains are second-level domains, such as 'org.uk' or 'co.jp'.</span></span>  <span data-ttu-id="f6e48-114">依此類推。</span><span class="sxs-lookup"><span data-stu-id="f6e48-114">And so on.</span></span> <span data-ttu-id="f6e48-115">DNS 階層中的網域裝載於個別的 DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-115">The domains in the DNS hierarchy are hosted using separate DNS zones.</span></span> <span data-ttu-id="f6e48-116">這些區域遍布全球，由世界各地的 DNS 名稱伺服器所裝載。</span><span class="sxs-lookup"><span data-stu-id="f6e48-116">These zones are globally distributed, hosted by DNS name servers around the world.</span></span>

<span data-ttu-id="f6e48-117">**DNS 區域** - 網域是網域名稱系統中的唯一名稱，例如 'contoso.com'。</span><span class="sxs-lookup"><span data-stu-id="f6e48-117">**DNS zone** - A domain is a unique name in the Domain Name System, for example 'contoso.com'.</span></span> <span data-ttu-id="f6e48-118">DNS 區域用來裝載特定網域的 DNS 記錄。</span><span class="sxs-lookup"><span data-stu-id="f6e48-118">A DNS zone is used to host the DNS records for a particular domain.</span></span> <span data-ttu-id="f6e48-119">例如，網域 'contoso.com' 可能包含數筆 DNS 記錄，例如 'mail.contoso.com' (用於郵件伺服器) 和 'www.contoso.com' (用於網站)。</span><span class="sxs-lookup"><span data-stu-id="f6e48-119">For example, the domain 'contoso.com' may contain several DNS records such as 'mail.contoso.com' (for a mail server) and 'www.contoso.com' (for a website).</span></span>

<span data-ttu-id="f6e48-120">**網域註冊機構** - 網域註冊機構是指可以提供網際網路網域名稱的公司。</span><span class="sxs-lookup"><span data-stu-id="f6e48-120">**Domain registrar** - A domain registrar is a company who can provide Internet domain names.</span></span> <span data-ttu-id="f6e48-121">他們會驗證您想要使用的網際網路網域是否可用，並允許您購買。</span><span class="sxs-lookup"><span data-stu-id="f6e48-121">They verify if the Internet domain you want to use is available and allow you to purchase it.</span></span> <span data-ttu-id="f6e48-122">一旦註冊網域名稱，您就成為該網域名稱的合法擁有者。</span><span class="sxs-lookup"><span data-stu-id="f6e48-122">Once the domain name is registered, you are the legal owner for the domain name.</span></span> <span data-ttu-id="f6e48-123">如果您已經有網際網路網域，您將使用目前的網域註冊機構委派給 Azure DNS。</span><span class="sxs-lookup"><span data-stu-id="f6e48-123">If you already have an Internet domain, you will use the current domain registrar to delegate to Azure DNS.</span></span>

<span data-ttu-id="f6e48-124">若要了解誰擁有指定的網域名稱，或如需有關如何購買網域的詳細資訊，請參閱 [Azure AD 中的網際網路網域管理](https://msdn.microsoft.com/library/azure/hh969248.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f6e48-124">To find out more information on who owns a given domain name, or for information on how to buy a domain, see [Internet domain management in Azure AD](https://msdn.microsoft.com/library/azure/hh969248.aspx).</span></span>

### <a name="resolution-and-delegation"></a><span data-ttu-id="f6e48-125">解析和委派</span><span class="sxs-lookup"><span data-stu-id="f6e48-125">Resolution and delegation</span></span>

<span data-ttu-id="f6e48-126">有兩種類型的 DNS 伺服器：</span><span class="sxs-lookup"><span data-stu-id="f6e48-126">There are two types of DNS servers:</span></span>

* <span data-ttu-id="f6e48-127">*授權* DNS 伺服器裝載 DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-127">An *authoritative* DNS server hosts DNS zones.</span></span> <span data-ttu-id="f6e48-128">它只會回答這些區域中的 DNS 記錄查詢。</span><span class="sxs-lookup"><span data-stu-id="f6e48-128">It answers DNS queries for records in those zones only.</span></span>
* <span data-ttu-id="f6e48-129">*遞迴* DNS 伺服器不裝載 DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-129">A *recursive* DNS server does not host DNS zones.</span></span> <span data-ttu-id="f6e48-130">它會呼叫授權 DNS 伺服器來收集所需的資料，以回答所有 DNS 查詢。</span><span class="sxs-lookup"><span data-stu-id="f6e48-130">It answers all DNS queries by calling authoritative DNS servers to gather the data it needs.</span></span>

<span data-ttu-id="f6e48-131">Azure DNS 提供具權威性的 DNS 服務。</span><span class="sxs-lookup"><span data-stu-id="f6e48-131">Azure DNS provides an authoritative DNS service.</span></span>  <span data-ttu-id="f6e48-132">它不提供遞迴 DNS 服務。</span><span class="sxs-lookup"><span data-stu-id="f6e48-132">It does not provide a recursive DNS service.</span></span> <span data-ttu-id="f6e48-133">Azure 中的雲端服務和 VM 會自動設定為使用在 Azure 的基礎結構中個別提供的遞迴 DNS 服務。</span><span class="sxs-lookup"><span data-stu-id="f6e48-133">Cloud Services and VMs in Azure are automatically configured to use a recursive DNS service that is provided separately as part of Azure's infrastructure.</span></span> <span data-ttu-id="f6e48-134">如需如何變更這些 DNS 設定的詳細資訊，請參閱 [Azure 中的名稱解析](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server)。</span><span class="sxs-lookup"><span data-stu-id="f6e48-134">For information on how to change these DNS settings, see [Name Resolution in Azure](../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-using-your-own-dns-server).</span></span>

<span data-ttu-id="f6e48-135">電腦或行動裝置中的 DNS 用戶端，通常會呼叫遞迴 DNS 伺服器，以執行用戶端應用程式需要的任何 DNS 查詢。</span><span class="sxs-lookup"><span data-stu-id="f6e48-135">DNS clients in PCs or mobile devices typically call a recursive DNS server to perform any DNS queries the client applications need.</span></span>

<span data-ttu-id="f6e48-136">當遞迴 DNS 伺服器收到 DNS 記錄的查詢時，例如 'www.contoso.com'，就必須先找到裝載 'contoso.com' 網域的區域的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="f6e48-136">When a recursive DNS server receives a query for a DNS record such as 'www.contoso.com', it first needs to find the name server hosting the zone for the 'contoso.com' domain.</span></span> <span data-ttu-id="f6e48-137">若要尋找名稱伺服器，它會從根名稱伺服器開始，尋找裝載 'com' 區域的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="f6e48-137">To find the name server, it starts at the root name servers, and from there finds the name servers hosting the 'com' zone.</span></span> <span data-ttu-id="f6e48-138">然後，查詢 'com' 名稱伺服器，尋找裝載 'contoso.com' 區域的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="f6e48-138">It then queries the 'com' name servers to find the name servers hosting the 'contoso.com' zone.</span></span>  <span data-ttu-id="f6e48-139">最後，就能夠向這些名稱伺服器查詢 'www.contoso.com'。</span><span class="sxs-lookup"><span data-stu-id="f6e48-139">Finally, it is able to query these name servers for 'www.contoso.com'.</span></span>

<span data-ttu-id="f6e48-140">此程序稱為 DNS 名稱解析。</span><span class="sxs-lookup"><span data-stu-id="f6e48-140">This procedure is called resolving the DNS name.</span></span> <span data-ttu-id="f6e48-141">嚴格來說，DNS 解析還有其他步驟，例如追蹤 CNAME，但這對於了解 DNS 委派的運作方式並不重要。</span><span class="sxs-lookup"><span data-stu-id="f6e48-141">Strictly speaking, DNS resolution includes additional steps such as following CNAMEs, but that's not important to understanding how DNS delegation works.</span></span>

<span data-ttu-id="f6e48-142">上層區域如何「指向」子區域的名稱伺服器？</span><span class="sxs-lookup"><span data-stu-id="f6e48-142">How does a parent zone 'point' to the name servers for a child zone?</span></span> <span data-ttu-id="f6e48-143">作法是使用一種特殊的 DNS 記錄，稱為 NS 記錄 (NS 代表「名稱伺服器」)。</span><span class="sxs-lookup"><span data-stu-id="f6e48-143">It does this using a special type of DNS record called an NS record (NS stands for 'name server').</span></span> <span data-ttu-id="f6e48-144">例如，根區域包含 'com' 的 NS 記錄，並且會顯示 'com' 區域的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="f6e48-144">For example, the root zone contains NS records for 'com' and shows the name servers for the 'com' zone.</span></span> <span data-ttu-id="f6e48-145">接著，'com' 區域包含 'contoso.com' 的 NS 記錄，其中顯示 'contoso.com' 區域的名稱伺服器。</span><span class="sxs-lookup"><span data-stu-id="f6e48-145">In turn, the 'com' zone contains NS records for 'contoso.com', which shows the name servers for the 'contoso.com' zone.</span></span> <span data-ttu-id="f6e48-146">在上層區域中設定子區域的 NS 記錄，稱為委派網域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-146">Setting up the NS records for a child zone in a parent zone is called delegating the domain.</span></span>

<span data-ttu-id="f6e48-147">下圖顯示 DNS 查詢範例。</span><span class="sxs-lookup"><span data-stu-id="f6e48-147">The following image shows an example DNS query.</span></span> <span data-ttu-id="f6e48-148">contoso.net 和 partners.contoso.net 都是 Azure DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-148">The contoso.net and partners.contoso.net are Azure DNS zones.</span></span>

![Dns-nameserver](./media/dns-domain-delegation/image1.png)

1. <span data-ttu-id="f6e48-150">用戶端會向其本機 DNS 伺服器要求 `www.partners.contoso.net`。</span><span class="sxs-lookup"><span data-stu-id="f6e48-150">The client requests `www.partners.contoso.net` from their local DNS server.</span></span>
1. <span data-ttu-id="f6e48-151">本機 DNS 伺服器沒有記錄，因此會對其根名稱伺服器提出要求。</span><span class="sxs-lookup"><span data-stu-id="f6e48-151">The local DNS server does not have the record so it makes a request to their root name server.</span></span>
1. <span data-ttu-id="f6e48-152">根名稱伺服器沒有記錄，但知道 `.net` 名稱伺服器的位址，所以會將該位址提供給 DNS 伺服器</span><span class="sxs-lookup"><span data-stu-id="f6e48-152">The root name server does not have the record, but knows the address of the `.net` name server, it provides that address to the DNS server</span></span>
1. <span data-ttu-id="f6e48-153">DNS 會將要求傳送至 `.net` 名稱伺服器，而它沒有記錄，但是知道 contoso.net 名稱伺服器的位址。</span><span class="sxs-lookup"><span data-stu-id="f6e48-153">The DNS sends the request to the `.net` name server, it does not have the record but does know the address of the contoso.net name server.</span></span> <span data-ttu-id="f6e48-154">在此情況下，這是在 Azure DNS 中託管的 DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-154">In this case it is a DNS zone hosted in Azure DNS.</span></span>
1. <span data-ttu-id="f6e48-155">`contoso.net` 區域沒有記錄，但知道 `partners.contoso.net` 的名稱伺服器並以該名稱伺服器回應。</span><span class="sxs-lookup"><span data-stu-id="f6e48-155">The zone `contoso.net` does not have the record but knows the name server for `partners.contoso.net` and responds with that.</span></span> <span data-ttu-id="f6e48-156">在此情況下，這是在 Azure DNS 中託管的 DNS 區域。</span><span class="sxs-lookup"><span data-stu-id="f6e48-156">In this case it is a DNS zone hosted in Azure DNS.</span></span>
1. <span data-ttu-id="f6e48-157">DNS 伺服器會向`partners.contoso.net` 區域要求 `partners.contoso.net` 的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f6e48-157">The DNS server requests the IP address of `partners.contoso.net` from the `partners.contoso.net` zone.</span></span> <span data-ttu-id="f6e48-158">它包含 A 記錄並以此 IP 位址回應。</span><span class="sxs-lookup"><span data-stu-id="f6e48-158">It contains the A record and responds with the IP address.</span></span>
1. <span data-ttu-id="f6e48-159">DNS 伺服器會將此 IP 位址提供給用戶端</span><span class="sxs-lookup"><span data-stu-id="f6e48-159">The DNS server provides the IP address to the client</span></span>
1. <span data-ttu-id="f6e48-160">用戶端會連線至網站`www.partners.contoso.net`。</span><span class="sxs-lookup"><span data-stu-id="f6e48-160">The client connects to the website `www.partners.contoso.net`.</span></span>

<span data-ttu-id="f6e48-161">每個委派實際上有兩份 NS 記錄：一份在上層區域中指向子區域，另一份在子區域本身。</span><span class="sxs-lookup"><span data-stu-id="f6e48-161">Each delegation actually has two copies of the NS records; one in the parent zone pointing to the child, and another in the child zone itself.</span></span> <span data-ttu-id="f6e48-162">'contoso.net' 區域包含 'contoso.net' 的 NS 記錄 (除了 'net' 中的 NS 記錄之外)。</span><span class="sxs-lookup"><span data-stu-id="f6e48-162">The 'contoso.net' zone contains the NS records for 'contoso.net' (in addition to the NS records in 'net').</span></span> <span data-ttu-id="f6e48-163">這些記錄稱為授權 NS 記錄，位於子區域的頂點。</span><span class="sxs-lookup"><span data-stu-id="f6e48-163">These records are called authoritative NS records and they sit at the apex of the child zone.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f6e48-164">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f6e48-164">Next steps</span></span>

<span data-ttu-id="f6e48-165">了解如何[將您的網域委派給 Azure DNS](dns-delegate-domain-azure-dns.md)</span><span class="sxs-lookup"><span data-stu-id="f6e48-165">Learn how to [delegate your domain to Azure DNS](dns-delegate-domain-azure-dns.md)</span></span>

