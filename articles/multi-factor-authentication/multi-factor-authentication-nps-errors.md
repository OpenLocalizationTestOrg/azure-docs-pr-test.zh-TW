---
title: "針對 Azure MFA NPS 擴充功能的錯誤碼進行移難排解 | Microsoft Docs"
description: "針對常見錯誤訊息提供特定解決方案，協助您解決 Azure Multi-Factor Authentication NPS 擴充功能的相關問題"
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: 173353d67772c2549aa1b8ec9f2a471bd1c65677
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/03/2017
---
# <a name="resolve-error-messages-from-the-nps-extension-for-azure-multi-factor-authentication"></a><span data-ttu-id="69f7f-103">解決 Azure Multi-Factor Authentication NPS 擴充功能的錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-103">Resolve error messages from the NPS extension for Azure Multi-Factor Authentication</span></span>

<span data-ttu-id="69f7f-104">如果您使用 Azure Multi-Factor Authentication NPS 擴充功能時發生錯誤，請使用本文以快速取得解決方案。</span><span class="sxs-lookup"><span data-stu-id="69f7f-104">If you encounter errors with the NPS extension for Azure Multi-Factor Authentication, use this article to reach a resolution faster.</span></span> 

## <a name="troubleshooting-steps-for-common-errors"></a><span data-ttu-id="69f7f-105">為常見錯誤而設的疑難排解步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-105">Troubleshooting steps for common errors</span></span>

| <span data-ttu-id="69f7f-106">錯誤碼</span><span class="sxs-lookup"><span data-stu-id="69f7f-106">Error code</span></span> | <span data-ttu-id="69f7f-107">疑難排解步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-107">Troubleshooting steps</span></span> |
| ---------- | --------------------- |
| <span data-ttu-id="69f7f-108">**CONTACT_SUPPORT**</span><span class="sxs-lookup"><span data-stu-id="69f7f-108">**CONTACT_SUPPORT**</span></span> | <span data-ttu-id="69f7f-109">請[連絡支援人員](#contact-microsoft-support)，並提供步驟清單以利收集記錄。</span><span class="sxs-lookup"><span data-stu-id="69f7f-109">[Contact support](#contact-microsoft-support), and mention the list of steps for collecting logs.</span></span> <span data-ttu-id="69f7f-110">請儘可能多提供錯誤發生前的相關資訊，包括租用戶識別碼和使用者主體名稱 (UPN) 等。</span><span class="sxs-lookup"><span data-stu-id="69f7f-110">Provide as much information as you can about what happened before the error, including tenant id, and user principal name (UPN).</span></span> |
| <span data-ttu-id="69f7f-111">**CLIENT_CERT_INSTALL_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-111">**CLIENT_CERT_INSTALL_ERROR**</span></span> | <span data-ttu-id="69f7f-112">可能是用戶端憑證的安裝方式或與您租用戶建立關聯的方式出了問題。</span><span class="sxs-lookup"><span data-stu-id="69f7f-112">There may be an issue with how the client certificate was installed or associated with your tenant.</span></span> <span data-ttu-id="69f7f-113">請遵循[針對 Azure MFA NPS 擴充功能進行移難排解](multi-factor-authentication-nps-extension.md#troubleshooting)中的指示來調查用戶端憑證問題。</span><span class="sxs-lookup"><span data-stu-id="69f7f-113">Follow the instructions in [Troubleshooting the MFA NPS extension](multi-factor-authentication-nps-extension.md#troubleshooting) to investigate client cert problems.</span></span> |
| <span data-ttu-id="69f7f-114">**ESTS_TOKEN_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-114">**ESTS_TOKEN_ERROR**</span></span> | <span data-ttu-id="69f7f-115">請遵循[針對 Azure MFA NPS 擴充功能進行移難排解](multi-factor-authentication-nps-extension.md#troubleshooting)中的指示來調查用戶端憑證和 ADAL 權杖問題。</span><span class="sxs-lookup"><span data-stu-id="69f7f-115">Follow the instructions in [Troubleshooting the MFA NPS extension](multi-factor-authentication-nps-extension.md#troubleshooting) to investigate client cert and ADAL token problems.</span></span> |
| <span data-ttu-id="69f7f-116">**HTTPS_COMMUNICATION_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-116">**HTTPS_COMMUNICATION_ERROR**</span></span> | <span data-ttu-id="69f7f-117">NPS 伺服器無法接收來自 Azure MFA 的的回應。</span><span class="sxs-lookup"><span data-stu-id="69f7f-117">The NPS server is unable to receive responses from Azure MFA.</span></span> <span data-ttu-id="69f7f-118">請確定您的防火牆已開放讓 https://adnotifications.windowsazure.com 可雙向傳輸流量</span><span class="sxs-lookup"><span data-stu-id="69f7f-118">Verify that your firewalls are open bidirectionally for traffic to and from https://adnotifications.windowsazure.com</span></span> |
| <span data-ttu-id="69f7f-119">**HTTP_CONNECT_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-119">**HTTP_CONNECT_ERROR**</span></span> | <span data-ttu-id="69f7f-120">在執行 NPS 延伸模組的伺服器上，確認您可以連線到 https://adnotifications.windowsazure.com 和 https://login.microsoftonline.com/。</span><span class="sxs-lookup"><span data-stu-id="69f7f-120">On the server that runs the NPS extension, verify that you can reach  https://adnotifications.windowsazure.com and https://login.microsoftonline.com/.</span></span> <span data-ttu-id="69f7f-121">如果無法載入這些站台，請針對該伺服器上的連線進行移難排解。</span><span class="sxs-lookup"><span data-stu-id="69f7f-121">If those sites don't load, troubleshoot connectivity on that server.</span></span> |
| <span data-ttu-id="69f7f-122">**REGISTRY_CONFIG_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-122">**REGISTRY_CONFIG_ERROR**</span></span> | <span data-ttu-id="69f7f-123">應用程式登錄中遺失機碼，可能是因為 [PowerShell 指令碼](multi-factor-authentication-nps-extension.md#install-the-nps-extension)並未在安裝後執行。</span><span class="sxs-lookup"><span data-stu-id="69f7f-123">A key is missing in the registry for the application, which may be because the [PowerShell script](multi-factor-authentication-nps-extension.md#install-the-nps-extension) wasn't run after installation.</span></span> <span data-ttu-id="69f7f-124">錯誤訊息應包含遺失的機碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-124">The error message should include the missing key.</span></span> <span data-ttu-id="69f7f-125">請確定您在 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\AzureMfa 下有該機碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-125">Make sure you have the key under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\AzureMfa.</span></span> |
| <span data-ttu-id="69f7f-126">**REQUEST_FORMAT_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-126">**REQUEST_FORMAT_ERROR**</span></span> <br> <span data-ttu-id="69f7f-127">RADIUS 要求中遺失必要的 RADIUS 使用者名稱\識別碼。請確定 NPS 會收到 RADIUS 要求</span><span class="sxs-lookup"><span data-stu-id="69f7f-127">Radius Request missing mandatory Radius userName\Identifier attribute.Verify that NPS is receiving RADIUS requests</span></span> | <span data-ttu-id="69f7f-128">此錯誤通常反映的是安裝問題。</span><span class="sxs-lookup"><span data-stu-id="69f7f-128">This error usually reflects an installation issue.</span></span> <span data-ttu-id="69f7f-129">NPS 擴充功能必須安裝在可接收 RADIUS 要求的 NPS 伺服器。</span><span class="sxs-lookup"><span data-stu-id="69f7f-129">The NPS extension must be installed in NPS servers that can receive RADIUS requests.</span></span> <span data-ttu-id="69f7f-130">NPS 伺服器若是作為 RDG 和 RRAS 等服務的相依項目安裝，則不會收到 RADIUS 要求。</span><span class="sxs-lookup"><span data-stu-id="69f7f-130">NPS servers that are installed as dependencies for services like RDG and RRAS don't receive radius requests.</span></span> <span data-ttu-id="69f7f-131">NPS 擴充功能若透過這類安裝方式進行安裝就會無法運作，並會因為無法讀取來自驗證要求的詳細資料而發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="69f7f-131">NPS Extension does not work when installed over such installations and errors out since it cannot read the details from the authentication request.</span></span> |
| <span data-ttu-id="69f7f-132">**REQUEST_MISSING_CODE**</span><span class="sxs-lookup"><span data-stu-id="69f7f-132">**REQUEST_MISSING_CODE**</span></span> | <span data-ttu-id="69f7f-133">請確定 NPS 和 NAS 伺服器之間的密碼加密協定支援您使用的次要驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-133">Make sure that the password encryption protocol between the NPS and NAS servers supports the secondary authentication method that you're using.</span></span> <span data-ttu-id="69f7f-134">**PAP** 支援雲端中 Azure MFA 的所有驗證方法：通話、單向簡訊、行動裝置應用程式通知，和行動裝置應用程式驗證碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-134">**PAP** supports all the authentication methods of Azure MFA in the cloud: phone call, one-way text message, mobile app notification, and mobile app verification code.</span></span> <span data-ttu-id="69f7f-135">**CHAPV2** 和 **EAP** 支援通話和行動裝置應用程式通知。</span><span class="sxs-lookup"><span data-stu-id="69f7f-135">**CHAPV2** and **EAP** support phone call and mobile app notification.</span></span> |
| <span data-ttu-id="69f7f-136">**USERNAME_CANONICALIZATION_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-136">**USERNAME_CANONICALIZATION_ERROR**</span></span> | <span data-ttu-id="69f7f-137">請確定使用者已存在於內部部署的 Active Directory 執行個體中，而且 NPS 服務有權存取目錄。</span><span class="sxs-lookup"><span data-stu-id="69f7f-137">Verify that the user is present in your on-premises Active Directory instance, and that the NPS Service has permissions to access the directory.</span></span> <span data-ttu-id="69f7f-138">如果您使用跨樹系信任，請[連絡支援人員](#contact-microsoft-support)以取得進一步協助。</span><span class="sxs-lookup"><span data-stu-id="69f7f-138">If you are using cross-forest trusts, [contact support](#contact-microsoft-support) for further help.</span></span> |


   

### <a name="alternate-login-id-errors"></a><span data-ttu-id="69f7f-139">替代登入識別碼錯誤</span><span class="sxs-lookup"><span data-stu-id="69f7f-139">Alternate login ID errors</span></span>

| <span data-ttu-id="69f7f-140">錯誤碼</span><span class="sxs-lookup"><span data-stu-id="69f7f-140">Error code</span></span> | <span data-ttu-id="69f7f-141">錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-141">Error message</span></span> | <span data-ttu-id="69f7f-142">疑難排解步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-142">Troubleshooting steps</span></span> |
| ---------- | ------------- | --------------------- |
| <span data-ttu-id="69f7f-143">**ALTERNATE_LOGIN_ID_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-143">**ALTERNATE_LOGIN_ID_ERROR**</span></span> | <span data-ttu-id="69f7f-144">錯誤：userObjectSid 查閱失敗</span><span class="sxs-lookup"><span data-stu-id="69f7f-144">Error: userObjectSid lookup failed</span></span> | <span data-ttu-id="69f7f-145">請確認使用者存在於內部部署 Active Directory 執行個體中。</span><span class="sxs-lookup"><span data-stu-id="69f7f-145">Verify that the user exists in your on-premises Active Directory instance.</span></span> <span data-ttu-id="69f7f-146">如果您使用跨樹系信任，請[連絡支援人員](#contact-microsoft-support)以取得進一步協助。</span><span class="sxs-lookup"><span data-stu-id="69f7f-146">If you are using cross-forest trusts, [contact support](#contact-microsoft-support) for further help.</span></span> |
| <span data-ttu-id="69f7f-147">**ALTERNATE_LOGIN_ID_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-147">**ALTERNATE_LOGIN_ID_ERROR**</span></span> | <span data-ttu-id="69f7f-148">錯誤：替代 LoginId 查閱失敗</span><span class="sxs-lookup"><span data-stu-id="69f7f-148">Error: Alternate LoginId lookup failed</span></span> | <span data-ttu-id="69f7f-149">請確認 LDAP_ALTERNATE_LOGINID_ATTRIBUTE 設定為[有效的 Active Directory 屬性](https://msdn.microsoft.com/library/ms675090(v=vs.85).aspx)。</span><span class="sxs-lookup"><span data-stu-id="69f7f-149">Verify that LDAP_ALTERNATE_LOGINID_ATTRIBUTE is set to a [valid active directory attribute](https://msdn.microsoft.com/library/ms675090(v=vs.85).aspx).</span></span> <br><br> <span data-ttu-id="69f7f-150">如果 LDAP_FORCE_GLOBAL_CATALOG 設定為 True，或 LDAP_LOOKUP_FORESTS 設定具有非空白值，請確認您已設定通用類別目錄，且 AlternateLoginId 屬性已新增到其中。</span><span class="sxs-lookup"><span data-stu-id="69f7f-150">If LDAP_FORCE_GLOBAL_CATALOG is set to True, or LDAP_LOOKUP_FORESTS is configured with a non-empty value, verify that you have configured a Global Catalog and that the AlternateLoginId attribute is added to it.</span></span> <br><br> <span data-ttu-id="69f7f-151">如果 LDAP_LOOKUP_FORESTS 設定具有非空白值，請確認值是否正確。</span><span class="sxs-lookup"><span data-stu-id="69f7f-151">If LDAP_LOOKUP_FORESTS is configured with a non-empty value, verify that the value is correct.</span></span> <span data-ttu-id="69f7f-152">如果有多個樹系名稱，名稱必須以分號分隔，而非空格。</span><span class="sxs-lookup"><span data-stu-id="69f7f-152">If there is more than one forest name, the names must be separated with semi-colons, not spaces.</span></span> <br><br> <span data-ttu-id="69f7f-153">如果上述步驟未能解決問題，請[連絡支援人員](#contact-microsoft-support)以取得更多協助。</span><span class="sxs-lookup"><span data-stu-id="69f7f-153">If these steps don't fix the problem, [contact support](#contact-microsoft-support) for more help.</span></span> |
| <span data-ttu-id="69f7f-154">**ALTERNATE_LOGIN_ID_ERROR**</span><span class="sxs-lookup"><span data-stu-id="69f7f-154">**ALTERNATE_LOGIN_ID_ERROR**</span></span> | <span data-ttu-id="69f7f-155">錯誤：替代 LoginId 值是空的</span><span class="sxs-lookup"><span data-stu-id="69f7f-155">Error: Alternate LoginId value is empty</span></span> | <span data-ttu-id="69f7f-156">請確認已為使用者設定 AlternateLoginId 屬性。</span><span class="sxs-lookup"><span data-stu-id="69f7f-156">Verify that the AlternateLoginId attribute is configured for the user.</span></span> |


## <a name="errors-your-users-may-encounter"></a><span data-ttu-id="69f7f-157">您的使用者可能會遇到下列錯誤</span><span class="sxs-lookup"><span data-stu-id="69f7f-157">Errors your users may encounter</span></span>

| <span data-ttu-id="69f7f-158">錯誤碼</span><span class="sxs-lookup"><span data-stu-id="69f7f-158">Error code</span></span> | <span data-ttu-id="69f7f-159">錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-159">Error message</span></span> | <span data-ttu-id="69f7f-160">疑難排解步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-160">Troubleshooting steps</span></span> |
| ---------- | ------------- | --------------------- |
| <span data-ttu-id="69f7f-161">**AccessDenied**</span><span class="sxs-lookup"><span data-stu-id="69f7f-161">**AccessDenied**</span></span> | <span data-ttu-id="69f7f-162">呼叫者租用戶並沒有執行使用者驗證的存取權限</span><span class="sxs-lookup"><span data-stu-id="69f7f-162">Caller tenant does not have access permissions to do authentication for the user</span></span> | <span data-ttu-id="69f7f-163">請檢查租用戶網域和使用者主要名稱 (UPN) 的網域是否相同。</span><span class="sxs-lookup"><span data-stu-id="69f7f-163">Check whether the tenant domain and the domain of the user principal name (UPN) are the same.</span></span> <span data-ttu-id="69f7f-164">例如，請確定 user@contoso.com 正在嘗試驗證的是 Contoso 租用戶。</span><span class="sxs-lookup"><span data-stu-id="69f7f-164">For example, make sure that user@contoso.com is trying to authenticate to the Contoso tenant.</span></span> <span data-ttu-id="69f7f-165">UPN 代表 Azure 中有效的租用戶使用者。</span><span class="sxs-lookup"><span data-stu-id="69f7f-165">The UPN represents a valid user for the tenant in Azure.</span></span> |
| <span data-ttu-id="69f7f-166">**AuthenticationMethodNotConfigured**</span><span class="sxs-lookup"><span data-stu-id="69f7f-166">**AuthenticationMethodNotConfigured**</span></span> | <span data-ttu-id="69f7f-167">使用者未設定指定的驗證方法</span><span class="sxs-lookup"><span data-stu-id="69f7f-167">The specified authentication method was not configured for the user</span></span> | <span data-ttu-id="69f7f-168">請讓使用者根據[管理您的雙步驟驗證設定](./end-user/multi-factor-authentication-end-user-manage-settings.md)中的指示，來新增或驗證他們的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-168">Have the user add or verify their verification methods according to the instructions in [Manage your settings for two-step verification](./end-user/multi-factor-authentication-end-user-manage-settings.md).</span></span> |
| <span data-ttu-id="69f7f-169">**AuthenticationMethodNotSupported**</span><span class="sxs-lookup"><span data-stu-id="69f7f-169">**AuthenticationMethodNotSupported**</span></span> | <span data-ttu-id="69f7f-170">不支援指定的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-170">Specified authentication method is not supported.</span></span> | <span data-ttu-id="69f7f-171">請收集所有包含此錯誤的記錄，並[連絡支援人員](#contact-microsoft-support)。</span><span class="sxs-lookup"><span data-stu-id="69f7f-171">Collect all your logs that include this error, and [contact support](#contact-microsoft-support).</span></span> <span data-ttu-id="69f7f-172">當您連絡支援人員時，請提供使用者名稱和觸發錯誤的次要驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-172">When you contact support, provide the username and the secondary verification method that triggered the error.</span></span> |
| <span data-ttu-id="69f7f-173">**BecAccessDenied**</span><span class="sxs-lookup"><span data-stu-id="69f7f-173">**BecAccessDenied**</span></span> | <span data-ttu-id="69f7f-174">MSODS Bec 呼叫傳回拒絕存取，可能是因為使用者名稱未在租用戶中定義</span><span class="sxs-lookup"><span data-stu-id="69f7f-174">MSODS Bec call returned access denied, probably the username is not defined in the tenant</span></span> | <span data-ttu-id="69f7f-175">使用者存在於 Active Directory 內部部署中，但未透過 AD Connect 同步至 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="69f7f-175">The user is present in Active Directory on-premises but is not synced into Azure AD by AD Connect.</span></span> <span data-ttu-id="69f7f-176">或者，租用戶遺失使用者。</span><span class="sxs-lookup"><span data-stu-id="69f7f-176">Or, the user is missing for the tenant.</span></span> <span data-ttu-id="69f7f-177">請將使用者新增至 Azure AD，並讓使用者根據[管理您的雙步驟驗證設定](./end-user/multi-factor-authentication-end-user-manage-settings.md)中的指示，來新增他們的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-177">Add the user to Azure AD and have them add their verification methods according to the instructions in [Manage your settings for two-step verification](./end-user/multi-factor-authentication-end-user-manage-settings.md).</span></span> |
| <span data-ttu-id="69f7f-178">**InvalidFormat** 或 **StrongAuthenticationServiceInvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-178">**InvalidFormat** or **StrongAuthenticationServiceInvalidParameter**</span></span> | <span data-ttu-id="69f7f-179">無法辨識電話號碼格式</span><span class="sxs-lookup"><span data-stu-id="69f7f-179">The phone number is in an unrecognizable format</span></span> | <span data-ttu-id="69f7f-180">請使用者修正他們的驗證電話號碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-180">Have the user correct their verification phone numbers.</span></span> |
| <span data-ttu-id="69f7f-181">**InvalidSession**</span><span class="sxs-lookup"><span data-stu-id="69f7f-181">**InvalidSession**</span></span> | <span data-ttu-id="69f7f-182">指定的工作階段無效或已過期</span><span class="sxs-lookup"><span data-stu-id="69f7f-182">The specified session is invalid or may have expired</span></span> | <span data-ttu-id="69f7f-183">工作階段費時三分鐘以上才完成。</span><span class="sxs-lookup"><span data-stu-id="69f7f-183">The session has taken more than three minutes to complete.</span></span> <span data-ttu-id="69f7f-184">請確定使用者在驗證要求啟動後的三分鐘內輸入驗證碼或回應應用程式通知。</span><span class="sxs-lookup"><span data-stu-id="69f7f-184">Verify that the user is entering the verification code, or responding to the app notification, within three minutes of initiating the authentication request.</span></span> <span data-ttu-id="69f7f-185">如果這麼做沒有修正問題，請檢查用戶端、NAS 伺服器、NPS 伺服器與 Azure MFA 端點之間沒有網路延遲的情形。</span><span class="sxs-lookup"><span data-stu-id="69f7f-185">If that doesn't fix the problem, check that there are no network latencies between client, NAS Server, NPS Server, and the Azure MFA endpoint.</span></span>  |
| <span data-ttu-id="69f7f-186">**NoDefaultAuthenticationMethodIsConfigured**</span><span class="sxs-lookup"><span data-stu-id="69f7f-186">**NoDefaultAuthenticationMethodIsConfigured**</span></span> | <span data-ttu-id="69f7f-187">使用者未設定預設的驗證方法</span><span class="sxs-lookup"><span data-stu-id="69f7f-187">No default authentication method was configured for the user</span></span> | <span data-ttu-id="69f7f-188">請讓使用者根據[管理您的雙步驟驗證設定](./end-user/multi-factor-authentication-end-user-manage-settings.md)中的指示，來新增或驗證他們的驗證方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-188">Have the user add or verify their verification methods according to the instructions in [Manage your settings for two-step verification](./end-user/multi-factor-authentication-end-user-manage-settings.md).</span></span> <span data-ttu-id="69f7f-189">請確定使用者已選擇預設驗證方法，且已為他們的帳戶設定該方法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-189">Verify that the user has chosen a default authentication method, and configured that method for their account.</span></span> |
| <span data-ttu-id="69f7f-190">**OathCodePinIncorrect**</span><span class="sxs-lookup"><span data-stu-id="69f7f-190">**OathCodePinIncorrect**</span></span> | <span data-ttu-id="69f7f-191">輸入的代碼和 Pin 碼錯誤。</span><span class="sxs-lookup"><span data-stu-id="69f7f-191">Wrong code and pin entered.</span></span> | <span data-ttu-id="69f7f-192">此錯誤不應出現在 NPS 擴充功能中。</span><span class="sxs-lookup"><span data-stu-id="69f7f-192">This error is not expected in the NPS extension.</span></span> <span data-ttu-id="69f7f-193">如果您的使用者遇到此錯誤，請[連絡支援人員](#contact-microsoft-support)以取得疑難排解說明。</span><span class="sxs-lookup"><span data-stu-id="69f7f-193">If your user encounters this, [contact support](#contact-microsoft-support) for troubleshooting help.</span></span> |
| <span data-ttu-id="69f7f-194">**ProofDataNotFound**</span><span class="sxs-lookup"><span data-stu-id="69f7f-194">**ProofDataNotFound**</span></span> | <span data-ttu-id="69f7f-195">指定的驗證方法未設定證明資料。</span><span class="sxs-lookup"><span data-stu-id="69f7f-195">Proof data was not configured for the specified authentication method.</span></span> | <span data-ttu-id="69f7f-196">請讓使用者根據[管理您的雙步驟驗證設定](./end-user/multi-factor-authentication-end-user-manage-settings.md)中的指示，嘗試不同驗證方法或新增驗證法。</span><span class="sxs-lookup"><span data-stu-id="69f7f-196">Have the user try a different verification method, or add a new verification methods according to the instructions in [Manage your settings for two-step verification](./end-user/multi-factor-authentication-end-user-manage-settings.md).</span></span> <span data-ttu-id="69f7f-197">如果您確認使用者已正確設定他們的驗證方法，但使用者仍持續看見此錯誤，請[連絡支援人員](#contact-microsoft-support)。</span><span class="sxs-lookup"><span data-stu-id="69f7f-197">If the user continues to see this error after you confirmed that their verification method is set up correctly, [contact support](#contact-microsoft-support).</span></span> |
| <span data-ttu-id="69f7f-198">**SMSAuthFailedWrongCodePinEntered**</span><span class="sxs-lookup"><span data-stu-id="69f7f-198">**SMSAuthFailedWrongCodePinEntered**</span></span> | <span data-ttu-id="69f7f-199">輸入的代碼和 Pin 碼錯誤。</span><span class="sxs-lookup"><span data-stu-id="69f7f-199">Wrong code and pin entered.</span></span> <span data-ttu-id="69f7f-200">(OneWaySMS)</span><span class="sxs-lookup"><span data-stu-id="69f7f-200">(OneWaySMS)</span></span> | <span data-ttu-id="69f7f-201">此錯誤不應出現在 NPS 擴充功能中。</span><span class="sxs-lookup"><span data-stu-id="69f7f-201">This error is not expected in the NPS extension.</span></span> <span data-ttu-id="69f7f-202">如果您的使用者遇到此錯誤，請[連絡支援人員](#contact-microsoft-support)以取得疑難排解說明。</span><span class="sxs-lookup"><span data-stu-id="69f7f-202">If your user encounters this, [contact support](#contact-microsoft-support) for troubleshooting help.</span></span> |
| <span data-ttu-id="69f7f-203">**TenantIsBlocked**</span><span class="sxs-lookup"><span data-stu-id="69f7f-203">**TenantIsBlocked**</span></span> | <span data-ttu-id="69f7f-204">租用戶已遭封鎖</span><span class="sxs-lookup"><span data-stu-id="69f7f-204">Tenant is blocked</span></span> | <span data-ttu-id="69f7f-205">請從 Azure 入口網站中的 Azure AD 屬性頁面中取得 Directory 識別碼並[連絡支援人員](#contact-microsoft-support)。</span><span class="sxs-lookup"><span data-stu-id="69f7f-205">[Contact support](#contact-microsoft-support) with Directory ID from the Azure AD properties page in the Azure portal.</span></span> |
| <span data-ttu-id="69f7f-206">**UserNotFound**</span><span class="sxs-lookup"><span data-stu-id="69f7f-206">**UserNotFound**</span></span> | <span data-ttu-id="69f7f-207">找不到指定的使用者</span><span class="sxs-lookup"><span data-stu-id="69f7f-207">The specified user was not found</span></span> | <span data-ttu-id="69f7f-208">此租用戶在 Azure AD 中已不是顯示為作用中的租用戶。</span><span class="sxs-lookup"><span data-stu-id="69f7f-208">The tenant is no longer visible as active in Azure AD.</span></span> <span data-ttu-id="69f7f-209">請檢查您的訂用帳戶是否在作用中，以及您是否有必要的第一方應用程式。</span><span class="sxs-lookup"><span data-stu-id="69f7f-209">Check that your subscription is active and you have the required first party apps.</span></span> <span data-ttu-id="69f7f-210">也請確定憑證主體中的租用戶正確，且憑證仍然有效，並已註冊於服務主體下。</span><span class="sxs-lookup"><span data-stu-id="69f7f-210">Also make sure the tenant in the certificate subject is as expected and the cert is still valid and registered under the service principal.</span></span> |

## <a name="messages-your-users-may-encounter-that-arent-errors"></a><span data-ttu-id="69f7f-211">使用者收到的訊息可能不是錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-211">Messages your users may encounter that aren't errors</span></span>

<span data-ttu-id="69f7f-212">有時候，由於您使用者的驗證要求失敗，他們可能會收到來自 Multi-Factor Authentication 的訊息。</span><span class="sxs-lookup"><span data-stu-id="69f7f-212">Sometimes, your users may get messages from Multi-Factor Authentication because their authentication request failed.</span></span> <span data-ttu-id="69f7f-213">這不是產品組態中發生錯誤，而是說明為何驗證要求遭拒的內部警告。</span><span class="sxs-lookup"><span data-stu-id="69f7f-213">These aren't errors in the product of configuration, but are intentional warnings explaining why an authentication request was denied.</span></span>

| <span data-ttu-id="69f7f-214">錯誤碼</span><span class="sxs-lookup"><span data-stu-id="69f7f-214">Error code</span></span> | <span data-ttu-id="69f7f-215">錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-215">Error message</span></span> | <span data-ttu-id="69f7f-216">建議的步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-216">Recommended steps</span></span> | 
| ---------- | ------------- | ----------------- |
| <span data-ttu-id="69f7f-217">**OathCodeIncorrect**</span><span class="sxs-lookup"><span data-stu-id="69f7f-217">**OathCodeIncorrect**</span></span> | <span data-ttu-id="69f7f-218">輸入的代碼錯誤\OATH 代碼錯誤</span><span class="sxs-lookup"><span data-stu-id="69f7f-218">Wrong code entered\OATH Code Incorrect</span></span> | <span data-ttu-id="69f7f-219">這不是錯誤，是使用者輸入的代碼有誤。</span><span class="sxs-lookup"><span data-stu-id="69f7f-219">Not an error,User has entered wrong code.</span></span> | <span data-ttu-id="69f7f-220">使用者輸入了錯誤的代碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-220">The user entered the wrong code.</span></span> <span data-ttu-id="69f7f-221">請要求新代碼並讓他們再試一次，或請他們重新登入。</span><span class="sxs-lookup"><span data-stu-id="69f7f-221">Have them try again by requesting a new code or signing in again.</span></span> | 
| <span data-ttu-id="69f7f-222">**SMSAuthFailedMaxAllowedCodeRetryReached**</span><span class="sxs-lookup"><span data-stu-id="69f7f-222">**SMSAuthFailedMaxAllowedCodeRetryReached**</span></span> | <span data-ttu-id="69f7f-223">已達重試代碼次數的上限</span><span class="sxs-lookup"><span data-stu-id="69f7f-223">Maximum allowed code retry reached</span></span> | <span data-ttu-id="69f7f-224">使用者的驗證嘗試失敗太多次。</span><span class="sxs-lookup"><span data-stu-id="69f7f-224">The user failed the verification challenge too many times.</span></span> <span data-ttu-id="69f7f-225">視您的設定而定，使用者現在可能需要透過系統管理員來解除封鎖。</span><span class="sxs-lookup"><span data-stu-id="69f7f-225">Depending on your settings, they may need to be unblocked by an admin now.</span></span>  |
| <span data-ttu-id="69f7f-226">**SMSAuthFailedWrongCodeEntered**</span><span class="sxs-lookup"><span data-stu-id="69f7f-226">**SMSAuthFailedWrongCodeEntered**</span></span> | <span data-ttu-id="69f7f-227">輸入的代碼錯誤/文字訊息 OTP 不正確</span><span class="sxs-lookup"><span data-stu-id="69f7f-227">Wrong code entered/Text Message OTP Incorrect</span></span> | <span data-ttu-id="69f7f-228">使用者輸入了錯誤的代碼。</span><span class="sxs-lookup"><span data-stu-id="69f7f-228">The user entered the wrong code.</span></span> <span data-ttu-id="69f7f-229">請要求新代碼並讓他們再試一次，或請他們重新登入。</span><span class="sxs-lookup"><span data-stu-id="69f7f-229">Have them try again by requesting a new code or signing in again.</span></span> |

## <a name="errors-that-require-support"></a><span data-ttu-id="69f7f-230">需要支援的錯誤</span><span class="sxs-lookup"><span data-stu-id="69f7f-230">Errors that require support</span></span>

<span data-ttu-id="69f7f-231">如果您遇到以下其中一種錯誤，我們建議您[連絡支援人員](#contact-microsoft-support)以取得診斷協助。</span><span class="sxs-lookup"><span data-stu-id="69f7f-231">If you encounter one of these errors, we recommend that you [contact support](#contact-microsoft-support) for diagnostic help.</span></span> <span data-ttu-id="69f7f-232">這些錯誤並沒有標準的解決步驟。</span><span class="sxs-lookup"><span data-stu-id="69f7f-232">There's no standard set of steps that can address these errors.</span></span> <span data-ttu-id="69f7f-233">當您連絡支援人員時，請務必多提供導致此錯誤的步驟資訊，以及您的租用戶資訊。</span><span class="sxs-lookup"><span data-stu-id="69f7f-233">When you do contact support, be sure to include as much information as possible about the steps that led to an error, and your tenant information.</span></span>

| <span data-ttu-id="69f7f-234">錯誤碼</span><span class="sxs-lookup"><span data-stu-id="69f7f-234">Error code</span></span> | <span data-ttu-id="69f7f-235">錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="69f7f-235">Error message</span></span> |
| ---------- | ------------- |
| <span data-ttu-id="69f7f-236">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-236">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-237">要求不能是 Null</span><span class="sxs-lookup"><span data-stu-id="69f7f-237">Request must not be null</span></span> |
| <span data-ttu-id="69f7f-238">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-238">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-239">對 ReplicationScope:{0} 而言，ObjectId 不能是 Null 或空白</span><span class="sxs-lookup"><span data-stu-id="69f7f-239">ObjectId must not be null or empty for ReplicationScope:{0}</span></span> |
| <span data-ttu-id="69f7f-240">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-240">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-241">公司名稱長度 \{0}\ 超過允許的長度上限 {1}</span><span class="sxs-lookup"><span data-stu-id="69f7f-241">The length of CompanyName \{0}\ is longer than the maximum allowed length {1}</span></span> |
| <span data-ttu-id="69f7f-242">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-242">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-243">UserPrincipalName 不能是 Null 或空白</span><span class="sxs-lookup"><span data-stu-id="69f7f-243">UserPrincipalName must not be null or empty</span></span> |
| <span data-ttu-id="69f7f-244">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-244">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-245">提供的 TenantId 格式不正確</span><span class="sxs-lookup"><span data-stu-id="69f7f-245">The provided TenantId is not in correct format</span></span> |
| <span data-ttu-id="69f7f-246">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-246">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-247">SessionId 不能是 Null 或空白</span><span class="sxs-lookup"><span data-stu-id="69f7f-247">SessionId must not be null or empty</span></span> |
| <span data-ttu-id="69f7f-248">**InvalidParameter**</span><span class="sxs-lookup"><span data-stu-id="69f7f-248">**InvalidParameter**</span></span> | <span data-ttu-id="69f7f-249">無法解析任何來自要求或 Msods 的 ProofData。</span><span class="sxs-lookup"><span data-stu-id="69f7f-249">Could not resolve any ProofData from request or Msods.</span></span> <span data-ttu-id="69f7f-250">ProofData 不明</span><span class="sxs-lookup"><span data-stu-id="69f7f-250">The ProofData is unKnown</span></span> |
| <span data-ttu-id="69f7f-251">**InternalError**</span><span class="sxs-lookup"><span data-stu-id="69f7f-251">**InternalError**</span></span> |  |
| <span data-ttu-id="69f7f-252">**OathCodePinIncorrect**</span><span class="sxs-lookup"><span data-stu-id="69f7f-252">**OathCodePinIncorrect**</span></span> |  |
| <span data-ttu-id="69f7f-253">**VersionNotSupported**</span><span class="sxs-lookup"><span data-stu-id="69f7f-253">**VersionNotSupported**</span></span> |  |
| <span data-ttu-id="69f7f-254">**MFAPinNotSetup**</span><span class="sxs-lookup"><span data-stu-id="69f7f-254">**MFAPinNotSetup**</span></span> |  |

## <a name="next-steps"></a><span data-ttu-id="69f7f-255">後續步驟</span><span class="sxs-lookup"><span data-stu-id="69f7f-255">Next steps</span></span>

### <a name="troubleshoot-user-accounts"></a><span data-ttu-id="69f7f-256">針對使用者帳戶進行移難排解</span><span class="sxs-lookup"><span data-stu-id="69f7f-256">Troubleshoot user accounts</span></span>

<span data-ttu-id="69f7f-257">如果您的使用者[進行雙步驟驗證時發生問題](./end-user/multi-factor-authentication-end-user-troubleshoot.md)，請協助助他們自行診斷問題。</span><span class="sxs-lookup"><span data-stu-id="69f7f-257">If your users are [Having trouble with two-step verification](./end-user/multi-factor-authentication-end-user-troubleshoot.md), help them self-diagnose problems.</span></span> 

### <a name="contact-microsoft-support"></a><span data-ttu-id="69f7f-258">連絡 Microsoft 支援</span><span class="sxs-lookup"><span data-stu-id="69f7f-258">Contact Microsoft support</span></span>

<span data-ttu-id="69f7f-259">如需其他協助，請透過 [Azure Multi-Factor Authentication Server 支援](https://support.microsoft.com/oas/default.aspx?prid=14947)連絡支援專業人員。</span><span class="sxs-lookup"><span data-stu-id="69f7f-259">If you need additional help, contact a support professional through [Azure Multi-Factor Authentication Server support](https://support.microsoft.com/oas/default.aspx?prid=14947).</span></span> <span data-ttu-id="69f7f-260">連絡我們時，請盡量包含有關問題的最多資訊，這樣會十分有幫助。</span><span class="sxs-lookup"><span data-stu-id="69f7f-260">When contacting us, it's helpful if you can include as much information about your issue as possible.</span></span> <span data-ttu-id="69f7f-261">您可以提供的資訊包含您看到錯誤的頁面、特定錯誤碼、特定工作階段 ID、使用者 (看到錯誤者) 識別碼，以及偵錯記錄。</span><span class="sxs-lookup"><span data-stu-id="69f7f-261">Information you can supply includes the page where you saw the error, the specific error code, the specific session ID, the ID of the user who saw the error, and debug logs.</span></span>

<span data-ttu-id="69f7f-262">若要收集偵錯記錄以支援診斷，請使用下列步驟︰</span><span class="sxs-lookup"><span data-stu-id="69f7f-262">To collect debug logs for support diagnostics, use the following steps:</span></span> 

1. <span data-ttu-id="69f7f-263">開啟系統管理員命令提示字元並執行下列命令︰</span><span class="sxs-lookup"><span data-stu-id="69f7f-263">Open an Administrator command prompt and run these commands:</span></span>

   ```
   Mkdir c:\NPS
   Cd NPS
   netsh trace start Scenario=NetConnection capture=yes tracefile=c:\NPS\nettrace.etl
   logman create trace "NPSExtension" -ow -o c:\NPS\NPSExtension.etl -p {7237ED00-E119-430B-AB0F-C63360C8EE81} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode Circular -f bincirc -max 4096 -ets
   logman update trace "NPSExtension" -p {EC2E6D3A-C958-4C76-8EA4-0262520886FF} 0xffffffffffffffff 0xff -ets
   ```

2. <span data-ttu-id="69f7f-264">重現問題</span><span class="sxs-lookup"><span data-stu-id="69f7f-264">Reproduce the issue</span></span>

3. <span data-ttu-id="69f7f-265">使用下列命令停止追蹤︰</span><span class="sxs-lookup"><span data-stu-id="69f7f-265">Stop the tracing with these commands:</span></span>

   ```
   logman stop "NPSExtension" -ets
   netsh trace stop
   wevtutil epl AuthNOptCh C:\NPS\%computername%_AuthNOptCh.evtx
   wevtutil epl AuthZOptCh C:\NPS\%computername%_AuthZOptCh.evtx
   wevtutil epl AuthZAdminCh C:\NPS\%computername%_AuthZAdminCh.evtx
   Start .
   ```

4. <span data-ttu-id="69f7f-266">壓縮 C:\NPS 資料夾的內容，並將壓縮的檔案附加到支援案例。</span><span class="sxs-lookup"><span data-stu-id="69f7f-266">Zip the contents of the C:\NPS folder and attach the zipped file to the support case.</span></span>


