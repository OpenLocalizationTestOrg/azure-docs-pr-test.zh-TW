---
title: "Azure Multi-Factor Authentication 和 Active Directory 之間的目錄整合"
description: "此 Azure Multi-Factor Authentication 頁面說明如何整合 Azure Multi-Factor Authentication Server 與 Active Directory，讓您可以同步處理目錄。"
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: def7a534-cfb2-492a-9124-87fb1148ab1f
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/16/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c469dfaccf515bcd1ced43279decfefe6be8375b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2017
---
# <a name="directory-integration-between-azure-mfa-server-and-active-directory"></a><span data-ttu-id="475d8-103">Azure MFA Server 與 Active Directory 之間的目錄整合</span><span class="sxs-lookup"><span data-stu-id="475d8-103">Directory integration between Azure MFA Server and Active Directory</span></span>
<span data-ttu-id="475d8-104">使用 Azure MFA Server 的 [目錄整合] 區段來與 Active Directory 或另一個 LDAP 目錄整合。</span><span class="sxs-lookup"><span data-stu-id="475d8-104">Use the Directory Integration section of the Azure MFA Server to integrate with Active Directory or another LDAP directory.</span></span> <span data-ttu-id="475d8-105">您可以設定相關屬性以比對目錄結構描述，並設定自動使用者同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-105">You can configure attributes to match the directory schema and set up automatic user synchronization.</span></span>

## <a name="settings"></a><span data-ttu-id="475d8-106">設定</span><span class="sxs-lookup"><span data-stu-id="475d8-106">Settings</span></span>
<span data-ttu-id="475d8-107">根據預設，Azure Multi-Factor Authentication (MFA) Server 會設定為從 Active Directory 匯入或同步處理使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-107">By default, the Azure Multi-Factor Authentication (MFA) Server is configured to import or synchronize users from Active Directory.</span></span>  <span data-ttu-id="475d8-108">[目錄整合] 索引標籤可讓您覆寫預設行為，並繫結至不同的 LDAP 目錄、ADAM 目錄或特定 Active Directory 網域控制站。</span><span class="sxs-lookup"><span data-stu-id="475d8-108">The Directory Integration tab allows you to override the default behavior and to bind to a different LDAP directory, an ADAM directory, or specific Active Directory domain controller.</span></span>  <span data-ttu-id="475d8-109">它也支援使用 LDAP 驗證來代理 LDAP 或 LDAP 繫結做為 RADIUS 目標、IIS 驗證的預先驗證，或使用者入口網站的主要驗證。</span><span class="sxs-lookup"><span data-stu-id="475d8-109">It also provides for the use of LDAP Authentication to proxy LDAP or for LDAP Bind as a RADIUS target, pre-authentication for IIS Authentication, or primary authentication for User Portal.</span></span>  <span data-ttu-id="475d8-110">下表描述個別設定。</span><span class="sxs-lookup"><span data-stu-id="475d8-110">The following table describes the individual settings.</span></span>

![設定](./media/multi-factor-authentication-get-started-server-dirint/dirint.png)

| <span data-ttu-id="475d8-112">功能</span><span class="sxs-lookup"><span data-stu-id="475d8-112">Feature</span></span> | <span data-ttu-id="475d8-113">說明</span><span class="sxs-lookup"><span data-stu-id="475d8-113">Description</span></span> |
| --- | --- |
| <span data-ttu-id="475d8-114">使用 Active Directory</span><span class="sxs-lookup"><span data-stu-id="475d8-114">Use Active Directory</span></span> |<span data-ttu-id="475d8-115">選取 [使用 Active Directory] 選項，以使用 Active Directory 來匯入和同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-115">Select the Use Active Directory option to use Active Directory for importing and synchronization.</span></span>  <span data-ttu-id="475d8-116">這是預設設定。</span><span class="sxs-lookup"><span data-stu-id="475d8-116">This is the default setting.</span></span> <br><span data-ttu-id="475d8-117">注意：為了使 Active Directory 整合能正常運作，請將電腦加入網域並以網域帳戶進行登入。</span><span class="sxs-lookup"><span data-stu-id="475d8-117">Note: For Active Directory integration to work properly,join the computer to a domain and sign in with a domain account.</span></span> |
| <span data-ttu-id="475d8-118">包含受信任的網域</span><span class="sxs-lookup"><span data-stu-id="475d8-118">Include trusted domains</span></span> |<span data-ttu-id="475d8-119">核取 [包含受信任的網域]，讓代理程式嘗試連線至目前網域所信任的網域、樹系中的另一個網域，或涉及樹系信任的網域。</span><span class="sxs-lookup"><span data-stu-id="475d8-119">Check **Include Trusted Domains** to have the agent attempt to connect to domains trusted by the current domain, another domain in the forest, or domains involved in a forest trust.</span></span>  <span data-ttu-id="475d8-120">當不從任何受信任的網域匯入或同步處理使用者時，請取消選取此核取方塊，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="475d8-120">When not importing or synchronizing users from any of the trusted domains, uncheck the checkbox to improve performance.</span></span>  <span data-ttu-id="475d8-121">預設為核取。</span><span class="sxs-lookup"><span data-stu-id="475d8-121">The default is checked.</span></span> |
| <span data-ttu-id="475d8-122">使用特定 LDAP 組態</span><span class="sxs-lookup"><span data-stu-id="475d8-122">Use specific LDAP configuration</span></span> |<span data-ttu-id="475d8-123">選取 [使用 LDAP] 選項，以使用指定的 LDAP 設定來匯入和同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-123">Select the Use LDAP option to use the LDAP settings specified for importing and synchronization.</span></span> <span data-ttu-id="475d8-124">注意：當選取 [使用 LDAP] 時，使用者介面會將參考從 Active Directory 變更為 LDAP。</span><span class="sxs-lookup"><span data-stu-id="475d8-124">Note: When Use LDAP is selected, the user interface changes references from Active Directory to LDAP.</span></span> |
| <span data-ttu-id="475d8-125">[編輯] 按鈕</span><span class="sxs-lookup"><span data-stu-id="475d8-125">Edit button</span></span> |<span data-ttu-id="475d8-126">[編輯] 按鈕允許修改目前的 LDAP 組態設定。</span><span class="sxs-lookup"><span data-stu-id="475d8-126">The Edit button allows the current LDAP configuration settings to modified.</span></span> |
| <span data-ttu-id="475d8-127">使用屬性範圍查詢</span><span class="sxs-lookup"><span data-stu-id="475d8-127">Use attribute scope queries</span></span> |<span data-ttu-id="475d8-128">指出是否應該使用屬性範圍查詢。</span><span class="sxs-lookup"><span data-stu-id="475d8-128">Indicates whether attribute scope queries should be used.</span></span>  <span data-ttu-id="475d8-129">屬性範圍查詢可以根據另一個記錄屬性中的項目，有效率地在目錄中搜尋合格的記錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-129">Attribute scope queries allow for efficient directory searches qualifying records based on the entries in another record's attribute.</span></span>  <span data-ttu-id="475d8-130">Azure Multi-Factor Authentication Server 可以使用屬性範圍查詢，有效率地查詢安全性群組成員的使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-130">The Azure Multi-Factor Authentication Server uses attribute scope queries to efficiently query the users that are a member of a security group.</span></span>   <br><span data-ttu-id="475d8-131">注意：在某些情況下，雖然支援屬性範圍查詢，但卻不應該使用。</span><span class="sxs-lookup"><span data-stu-id="475d8-131">Note:  There are some cases where attribute scope queries are supported, but shouldn't be used.</span></span>  <span data-ttu-id="475d8-132">比方說，當安全性群組包含來自多個網域的成員時，Active Directory 的屬性範圍查詢可能會有問題。</span><span class="sxs-lookup"><span data-stu-id="475d8-132">For example, Active Directory can have issues with attribute scope queries when a security group contains members from more than one domain.</span></span> <span data-ttu-id="475d8-133">在此情況下，請取消選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="475d8-133">In this case, unselect the checkbox.</span></span> |

<span data-ttu-id="475d8-134">下表描述 LDAP 組態設定。</span><span class="sxs-lookup"><span data-stu-id="475d8-134">The following table describes the LDAP configuration settings.</span></span>

| <span data-ttu-id="475d8-135">功能</span><span class="sxs-lookup"><span data-stu-id="475d8-135">Feature</span></span> | <span data-ttu-id="475d8-136">說明</span><span class="sxs-lookup"><span data-stu-id="475d8-136">Description</span></span> |
| --- | --- |
| <span data-ttu-id="475d8-137">伺服器</span><span class="sxs-lookup"><span data-stu-id="475d8-137">Server</span></span> |<span data-ttu-id="475d8-138">輸入執行 LDAP 目錄之伺服器的主機名稱或 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="475d8-138">Enter the hostname or IP address of the server running the LDAP directory.</span></span>  <span data-ttu-id="475d8-139">也可以指定備份伺服器 (以分號隔開)。</span><span class="sxs-lookup"><span data-stu-id="475d8-139">A backup server may also be specified separated by a semi-colon.</span></span> <br><span data-ttu-id="475d8-140">注意：當 [繫結類型] 是 [SSL] 時，需要完整主機名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-140">Note: When Bind Type is SSL, a fully qualified hostname is required.</span></span> |
| <span data-ttu-id="475d8-141">基準 DN</span><span class="sxs-lookup"><span data-stu-id="475d8-141">Base DN</span></span> |<span data-ttu-id="475d8-142">輸入作為所有目錄查詢起點之基準目錄物件的辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-142">Enter the distinguished name of the base directory object from which all directory queries start.</span></span>  <span data-ttu-id="475d8-143">例如，dc=abc,dc=com。</span><span class="sxs-lookup"><span data-stu-id="475d8-143">For example, dc=abc,dc=com.</span></span> |
| <span data-ttu-id="475d8-144">繫結類型 - 查詢</span><span class="sxs-lookup"><span data-stu-id="475d8-144">Bind type - Queries</span></span> |<span data-ttu-id="475d8-145">選取繫結時可用的適當繫結類型，以搜尋 LDAP 目錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-145">Select the appropriate bind type for use when binding to search the LDAP directory.</span></span>  <span data-ttu-id="475d8-146">這用於匯入、同步處理和使用者名稱解析。</span><span class="sxs-lookup"><span data-stu-id="475d8-146">This is used for imports, synchronization, and username resolution.</span></span> <br><br>  <span data-ttu-id="475d8-147">匿名 - 執行匿名繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-147">Anonymous - An anonymous bind is performed.</span></span>  <span data-ttu-id="475d8-148">不會使用繫結 DN 和繫結密碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-148">Bind DN and Bind Password are not used.</span></span>  <span data-ttu-id="475d8-149">只有當 LDAP 目錄允許匿名繫結，而且權限允許查詢適當的記錄和屬性時，這才有作用。</span><span class="sxs-lookup"><span data-stu-id="475d8-149">This only works if the LDAP directory allows anonymous binding and permissions allow the querying of the appropriate records and attributes.</span></span>  <br><br> <span data-ttu-id="475d8-150">簡單 - 以純文字傳遞 [繫結 DN] 和 [繫結密碼] 來繫結至 LDAP 目錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-150">Simple - Bind DN and Bind Password are passed as plain text to bind to the LDAP directory.</span></span>  <span data-ttu-id="475d8-151">這只適用於測試目的，以確認可連上伺服器且繫結帳戶具有適當的存取權。</span><span class="sxs-lookup"><span data-stu-id="475d8-151">This is for testing purposes, to verify that the server can be reached and that the bind account has the appropriate access.</span></span> <span data-ttu-id="475d8-152">安裝適當的憑證之後，請改用 SSL。</span><span class="sxs-lookup"><span data-stu-id="475d8-152">After the appropriate cert has been installed, use SSL instead.</span></span>  <br><br> <span data-ttu-id="475d8-153">SSL - 使用 SSL 加密 [繫結 DN] 和 [繫結密碼] 以繫結至 LDAP 目錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-153">SSL - Bind DN and Bind Password are encrypted using SSL to bind to the LDAP directory.</span></span>  <span data-ttu-id="475d8-154">在本機安裝 LDAP 目錄所信任的憑證。</span><span class="sxs-lookup"><span data-stu-id="475d8-154">Install a cert locally that the LDAP directory trusts.</span></span>  <br><br> <span data-ttu-id="475d8-155">Windows - 使用繫結使用者名稱和繫結密碼來安全地連線到 Active Directory 網域控制站或 ADAM 目錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-155">Windows - Bind Username and Bind Password are used to securely connect to an Active Directory domain controller or ADAM directory.</span></span>  <span data-ttu-id="475d8-156">如果 [繫結使用者名稱] 空白，則會使用已登入的使用者帳戶進行繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-156">If Bind Username is left blank, the logged-on user's account is used to bind.</span></span> |
| <span data-ttu-id="475d8-157">繫結類型 - 驗證</span><span class="sxs-lookup"><span data-stu-id="475d8-157">Bind type - Authentications</span></span> |<span data-ttu-id="475d8-158">選取適當的繫結類型供執行 LDAP 繫結驗證時使用。</span><span class="sxs-lookup"><span data-stu-id="475d8-158">Select the appropriate bind type for use when performing LDAP bind authentication.</span></span>  <span data-ttu-id="475d8-159">請參閱＜繫結類型 - 查詢＞下的繫結類型描述。</span><span class="sxs-lookup"><span data-stu-id="475d8-159">See the bind type descriptions under Bind type - Queries.</span></span>  <span data-ttu-id="475d8-160">比方說，這可將匿名繫結用於查詢，而將 SSL 繫結用於保護 LDAP 繫結驗證。</span><span class="sxs-lookup"><span data-stu-id="475d8-160">For example, this allows for Anonymous bind to be used for queries while SSL bind is used to secure LDAP bind authentications.</span></span> |
| <span data-ttu-id="475d8-161">繫結 DN 或繫結使用者名稱</span><span class="sxs-lookup"><span data-stu-id="475d8-161">Bind DN or Bind username</span></span> |<span data-ttu-id="475d8-162">輸入帳戶的使用者記錄辨別名稱，以在繫結至 LDAP 目錄時使用。</span><span class="sxs-lookup"><span data-stu-id="475d8-162">Enter the distinguished name of the user record for the account to use when binding to the LDAP directory.</span></span><br><br><span data-ttu-id="475d8-163">只有在 [繫結類型] 為 [簡單] 或 [SSL] 時，才會使用繫結辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-163">The bind distinguished name is only used when Bind Type is Simple or SSL.</span></span>  <br><br><span data-ttu-id="475d8-164">當 [繫結類型] 為 [Windows] 時，輸入當繫結至 LDAP 目錄時要使用的 Windows 帳戶的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-164">Enter the username of the Windows account to use when binding to the LDAP directory when Bind Type is Windows.</span></span>  <span data-ttu-id="475d8-165">如果空白，則會使用已登入的使用者帳戶進行繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-165">If left blank, the logged-on user's account is used to bind.</span></span> |
| <span data-ttu-id="475d8-166">繫結密碼</span><span class="sxs-lookup"><span data-stu-id="475d8-166">Bind Password</span></span> |<span data-ttu-id="475d8-167">輸入用來繫結至 LDAP 目錄之繫結 DN 或使用者名稱的繫結密碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-167">Enter the bind password for the Bind DN or username being used to bind to the LDAP directory.</span></span>  <span data-ttu-id="475d8-168">若要設定 Multi-Factor Auth Server AdSync 服務的密碼，請啟用同步處理並確保此服務在本機電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="475d8-168">To configure the password for the Multi-Factor Auth Server AdSync Service, enable synchronization and ensure that the service is running on the local machine.</span></span>  <span data-ttu-id="475d8-169">此密碼會儲存在用於執行 Multi-Factor Auth Server AdSync Service 的帳戶下的 [Windows 儲存的使用者和密碼] 中。</span><span class="sxs-lookup"><span data-stu-id="475d8-169">The password is saved in the Windows Stored Usernames and Passwords under the account the Multi-Factor Auth Server AdSync Service is running as.</span></span>  <span data-ttu-id="475d8-170">此密碼也會儲存在用於執行 Multi-Factor Auth Server 使用者介面的帳戶下，以及用於執行 Multi-Factor Auth Server Service 的帳戶下。</span><span class="sxs-lookup"><span data-stu-id="475d8-170">The password is also saved under the account the Multi-Factor Auth Server user interface is running as and under the account the Multi-Factor Auth Server Service is running as.</span></span>  <br><br><span data-ttu-id="475d8-171">由於密碼只會儲存在本機伺服器的 [Windows 儲存的使用者和密碼] 中，所以在每個需要存取此密碼的 Multi-Factor Auth Server 上重複此步驟。</span><span class="sxs-lookup"><span data-stu-id="475d8-171">Since the password is only stored in the local server's Windows Stored Usernames and Passwords, repeat this step on each Multi-Factor Auth Server that needs access to the password.</span></span> |
| <span data-ttu-id="475d8-172">查詢大小限制</span><span class="sxs-lookup"><span data-stu-id="475d8-172">Query size limit</span></span> |<span data-ttu-id="475d8-173">指定目錄搜尋可傳回的使用者數目上限。</span><span class="sxs-lookup"><span data-stu-id="475d8-173">Specify the size limit for the maximum number of users that a directory search returns.</span></span>  <span data-ttu-id="475d8-174">此限制應該符合 LDAP 目錄上的設定。</span><span class="sxs-lookup"><span data-stu-id="475d8-174">This limit should match the configuration on the LDAP directory.</span></span>  <span data-ttu-id="475d8-175">對於不支援分頁的大型搜尋，匯入和同步處理會嘗試以批次方式擷取使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-175">For large searches where paging is not supported, import and synchronization attempts to retrieve users in batches.</span></span>  <span data-ttu-id="475d8-176">如果此處指定的大小限制大於 LDAP 目錄上設定的限制，可能會遺漏部分使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-176">If the size limit specified here is larger than the limit configured on the LDAP directory, some users may be missed.</span></span> |
| <span data-ttu-id="475d8-177">測試按鈕</span><span class="sxs-lookup"><span data-stu-id="475d8-177">Test button</span></span> |<span data-ttu-id="475d8-178">按一下 [測試] 以測試 LDAP 伺服器繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-178">Click **Test** to test binding to the LDAP server.</span></span>  <br><br><span data-ttu-id="475d8-179">您不需要選取 [使用 LDAP] 選項來測試繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-179">You don't need to select the **Use LDAP** option to test binding.</span></span> <span data-ttu-id="475d8-180">這樣可以在使用 LDAP 組態之前先測試繫結。</span><span class="sxs-lookup"><span data-stu-id="475d8-180">This allows the binding to be tested before you use the LDAP configuration.</span></span> |

## <a name="filters"></a><span data-ttu-id="475d8-181">篩選器</span><span class="sxs-lookup"><span data-stu-id="475d8-181">Filters</span></span>
<span data-ttu-id="475d8-182">篩選可讓您在執行目錄搜尋時，設定準則來限定記錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-182">Filters allow you to set criteria to qualify records when performing a directory search.</span></span>  <span data-ttu-id="475d8-183">您可以設定篩選以限定想要同步處理的物件範圍。</span><span class="sxs-lookup"><span data-stu-id="475d8-183">By setting the filter, you can scope the objects you want to synchronize.</span></span>  

![篩選器](./media/multi-factor-authentication-get-started-server-dirint/dirint2.png)

<span data-ttu-id="475d8-185">Azure Multi-Factor Authentication 具有下列三個篩選選項：</span><span class="sxs-lookup"><span data-stu-id="475d8-185">Azure Multi-Factor Authentication has the following three filter options:</span></span>

* <span data-ttu-id="475d8-186">**容器篩選** - 指定執行目錄搜尋時，用來限定容器記錄的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-186">**Container filter** - Specify the filter criteria used to qualify container records when performing a directory search.</span></span>  <span data-ttu-id="475d8-187">對於 Active Directory 和 ADAM，通常會使用 (|(objectClass=organizationalUnit)(objectClass=container))。</span><span class="sxs-lookup"><span data-stu-id="475d8-187">For Active Directory and ADAM, (|(objectClass=organizationalUnit)(objectClass=container)) is commonly used.</span></span>  <span data-ttu-id="475d8-188">對於其他 LDAP 目錄，請根據目錄結構描述，使用可限定每一種容器物件的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-188">For other LDAP directories, use filter criteria that qualifies each type of container object, depending on the directory schema.</span></span>  <br><span data-ttu-id="475d8-189">注意：如果空白，預設會使用 ((objectClass=organizationalUnit)(objectClass=container))。</span><span class="sxs-lookup"><span data-stu-id="475d8-189">Note:  If left blank, ((objectClass=organizationalUnit)(objectClass=container)) is used by default.</span></span>
* <span data-ttu-id="475d8-190">**安全性群組篩選** - 指定執行目錄搜尋時，用來限定安全性群組記錄的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-190">**Security group filter** - Specify the filter criteria used to qualify security group records when performing a directory search.</span></span>  <span data-ttu-id="475d8-191">對於 Active Directory 和 ADAM，通常會使用 (&(objectCategory=group)(groupType:1.2.840.113556.1.4.804:=-2147483648))。</span><span class="sxs-lookup"><span data-stu-id="475d8-191">For Active Directory and ADAM, (&(objectCategory=group)(groupType:1.2.840.113556.1.4.804:=-2147483648)) is commonly used.</span></span>  <span data-ttu-id="475d8-192">對於其他 LDAP 目錄，請根據目錄結構描述，使用可限定每一種安全性群組物件的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-192">For other LDAP directories, use filter criteria that qualifies each type of security group object, depending on the directory schema.</span></span>  <br><span data-ttu-id="475d8-193">注意：如果空白，預設會使用 (&(objectCategory=group)(groupType:1.2.840.113556.1.4.804:=-2147483648))。</span><span class="sxs-lookup"><span data-stu-id="475d8-193">Note:  If left blank, (&(objectCategory=group)(groupType:1.2.840.113556.1.4.804:=-2147483648)) is used by default.</span></span>
* <span data-ttu-id="475d8-194">**使用者篩選** - 指定執行目錄搜尋時，用來限定使用者記錄的篩選準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-194">**User filter** - Specify the filter criteria used to qualify user records when performing a directory search.</span></span>  <span data-ttu-id="475d8-195">對於 Active Directory 和 ADAM，通常會使用 (&(objectClass=user)(objectCategory=person))。</span><span class="sxs-lookup"><span data-stu-id="475d8-195">For Active Directory and ADAM, (&(objectClass=user)(objectCategory=person)) is commonly used.</span></span>  <span data-ttu-id="475d8-196">對於其他 LDAP 目錄，請根據目錄結構描述，使用 (objectClass = inetOrgPerson) 或類似的準則。</span><span class="sxs-lookup"><span data-stu-id="475d8-196">For other LDAP directories, use (objectClass=inetOrgPerson) or something similar, depending on the directory schema.</span></span> <br><span data-ttu-id="475d8-197">注意：如果空白，預設會使用 (&(objectCategory=person)(objectClass=user))。</span><span class="sxs-lookup"><span data-stu-id="475d8-197">Note:  If left blank, (&(objectCategory=person)(objectClass=user)) is used by default.</span></span>

## <a name="attributes"></a><span data-ttu-id="475d8-198">屬性</span><span class="sxs-lookup"><span data-stu-id="475d8-198">Attributes</span></span>
<span data-ttu-id="475d8-199">您可以視需要自訂特定目錄的屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-199">You can customize attributes as necessary for a specific directory.</span></span>  <span data-ttu-id="475d8-200">這可讓您新增自訂屬性，並微調到只同步處理您需要的屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-200">This allows you to add custom attributes and fine-tune the synchronization to only the attributes that you need.</span></span> <span data-ttu-id="475d8-201">使用目錄結構描述中所定義的屬性名稱作為每個屬性欄位的值。</span><span class="sxs-lookup"><span data-stu-id="475d8-201">Use the name of the attricute as defined in the directory schema for the value of each attribute field.</span></span> <span data-ttu-id="475d8-202">下表提供每項功能的其他相關資訊。</span><span class="sxs-lookup"><span data-stu-id="475d8-202">The following table provides additional information about each feature.</span></span>

<span data-ttu-id="475d8-203">您可以手動輸入屬性，並不需要符合屬性清單中的屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-203">Attributes may be entered manually and are not required to match an attribute in the attribute list.</span></span>

![屬性](./media/multi-factor-authentication-get-started-server-dirint/dirint3.png)

| <span data-ttu-id="475d8-205">功能</span><span class="sxs-lookup"><span data-stu-id="475d8-205">Feature</span></span> | <span data-ttu-id="475d8-206">說明</span><span class="sxs-lookup"><span data-stu-id="475d8-206">Description</span></span> |
| --- | --- |
| <span data-ttu-id="475d8-207">唯一識別碼</span><span class="sxs-lookup"><span data-stu-id="475d8-207">Unique identifier</span></span> |<span data-ttu-id="475d8-208">輸入屬性的屬性名稱，做為容器、安全性群組和使用者記錄的唯一識別碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-208">Enter the attribute name of the attribute that serves as the unique identifier of container, security group, and user records.</span></span>  <span data-ttu-id="475d8-209">在 Active Directory 中，這通常是 objectGUID。</span><span class="sxs-lookup"><span data-stu-id="475d8-209">In Active Directory, this is usually objectGUID.</span></span> <span data-ttu-id="475d8-210">其他 LDAP 實作可能使用 entryUUID 或類似的項目。</span><span class="sxs-lookup"><span data-stu-id="475d8-210">Other LDAP implementations may use entryUUID or something similar.</span></span>  <span data-ttu-id="475d8-211">預設值是 objectGUID。</span><span class="sxs-lookup"><span data-stu-id="475d8-211">The default is objectGUID.</span></span> |
| <span data-ttu-id="475d8-212">唯一識別碼類型</span><span class="sxs-lookup"><span data-stu-id="475d8-212">Unique identifier type</span></span> |<span data-ttu-id="475d8-213">選取唯一識別碼屬性的類型。</span><span class="sxs-lookup"><span data-stu-id="475d8-213">Select the type of the unique identifier attribute.</span></span>  <span data-ttu-id="475d8-214">在 Active Directory 中，objectGUID 屬性為 GUID 類型。</span><span class="sxs-lookup"><span data-stu-id="475d8-214">In Active Directory, the objectGUID attribute is of type GUID.</span></span> <span data-ttu-id="475d8-215">其他 LDAP 實作可能使用 ASCII 位元組陣列或字串類型。</span><span class="sxs-lookup"><span data-stu-id="475d8-215">Other LDAP implementations may use type ASCII Byte Array or String.</span></span>  <span data-ttu-id="475d8-216">預設值是 GUID。</span><span class="sxs-lookup"><span data-stu-id="475d8-216">The default is GUID.</span></span> <br><br><span data-ttu-id="475d8-217">務必正確設定此類型，因為同步處理項目是依照其唯一識別碼來參考。</span><span class="sxs-lookup"><span data-stu-id="475d8-217">It is important to set this type correctly since Synchronization Items are referenced by their Unique Identifier.</span></span> <span data-ttu-id="475d8-218">唯一識別碼類型是用來直接在目錄中尋找物件。</span><span class="sxs-lookup"><span data-stu-id="475d8-218">The Unique Identifier Type is used to directly find the object in the directory.</span></span>  <span data-ttu-id="475d8-219">當目錄實際上將值儲存為 ASCII 字元的位元組陣列時，將此類型設定為 [字串] 會導致同步處理無法正確運作。</span><span class="sxs-lookup"><span data-stu-id="475d8-219">Setting this type to String when the directory actually stores the value as a byte array of ASCII characters prevents synchronization from functioning properly.</span></span> |
| <span data-ttu-id="475d8-220">辨別名稱</span><span class="sxs-lookup"><span data-stu-id="475d8-220">Distinguished name</span></span> |<span data-ttu-id="475d8-221">輸入屬性的屬性名稱，此屬性包含每一筆記錄的辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-221">Enter the attribute name of the attribute that contains the distinguished name for each record.</span></span>  <span data-ttu-id="475d8-222">在 Active Directory 中，這通常是 distinguishedName。</span><span class="sxs-lookup"><span data-stu-id="475d8-222">In Active Directory, this is usually distinguishedName.</span></span> <span data-ttu-id="475d8-223">其他 LDAP 實作可能使用 entryDN 或類似的項目。</span><span class="sxs-lookup"><span data-stu-id="475d8-223">Other LDAP implementations may use entryDN or something similar.</span></span>  <span data-ttu-id="475d8-224">預設值是 distinguishedName。</span><span class="sxs-lookup"><span data-stu-id="475d8-224">The default is distinguishedName.</span></span> <br><br><span data-ttu-id="475d8-225">如果不存在只包含辨別名稱的屬性，可以使用 adspath 屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-225">If an attribute containing just the distinguished name doesn't exist, the adspath attribute may be used.</span></span>  <span data-ttu-id="475d8-226">路徑的 "LDAP://\<server\>/" 部分將會自動去除，只保留物件的辨別名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-226">The "LDAP://\<server\>/" portion of the path is automatically stripped off, leaving just the distinguished name of the object.</span></span> |
| <span data-ttu-id="475d8-227">容器名稱</span><span class="sxs-lookup"><span data-stu-id="475d8-227">Container name</span></span> |<span data-ttu-id="475d8-228">輸入屬性的屬性名稱，此屬性包含容器記錄中的名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-228">Enter the attribute name of the attribute that contains the name in a container record.</span></span>  <span data-ttu-id="475d8-229">從 Active Directory 匯入或新增同步處理項目時，這個屬性的值會顯示在容器階層中。</span><span class="sxs-lookup"><span data-stu-id="475d8-229">The value of this attribute is displayed in the Container Hierarchy when importing from Active Directory or adding synchronization items.</span></span>  <span data-ttu-id="475d8-230">預設值是 name。</span><span class="sxs-lookup"><span data-stu-id="475d8-230">The default is name.</span></span> <br><br><span data-ttu-id="475d8-231">如果不同容器使用不同的屬性做為名稱，請使用分號來隔開多個容器名稱屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-231">If different containers use different attributes for their names, use semi-colons to separate multiple container name attributes.</span></span>  <span data-ttu-id="475d8-232">在容器物件上找到的第一個容器名稱屬性用來顯示其名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-232">The first container name attribute found on a container object is used to display its name.</span></span> |
| <span data-ttu-id="475d8-233">安全性群組名稱</span><span class="sxs-lookup"><span data-stu-id="475d8-233">Security group name</span></span> |<span data-ttu-id="475d8-234">輸入屬性的屬性名稱，此屬性包含安全性群組記錄中的名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-234">Enter the attribute name of the attribute that contains the name in a security group record.</span></span>  <span data-ttu-id="475d8-235">從 Active Directory 匯入或新增同步處理項目時，這個屬性的值會顯示在安全性群組清單中。</span><span class="sxs-lookup"><span data-stu-id="475d8-235">The value of this attribute is displayed in the Security Group list when importing from Active Directory or adding synchronization items.</span></span>  <span data-ttu-id="475d8-236">預設值是 name。</span><span class="sxs-lookup"><span data-stu-id="475d8-236">The default is name.</span></span> |
| <span data-ttu-id="475d8-237">使用者名稱</span><span class="sxs-lookup"><span data-stu-id="475d8-237">Username</span></span> |<span data-ttu-id="475d8-238">輸入屬性的屬性名稱，此屬性包含使用者記錄中的使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-238">Enter the attribute name of the attribute that contains the username in a user record.</span></span>  <span data-ttu-id="475d8-239">這個屬性的值用於做為 Multi-Factor Auth Server 使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-239">The value of this attribute is used as the Multi-Factor Auth Server username.</span></span>  <span data-ttu-id="475d8-240">可以指定第二個屬性做為第一個屬性的備用。</span><span class="sxs-lookup"><span data-stu-id="475d8-240">A second attribute may be specified as a backup to the first.</span></span>  <span data-ttu-id="475d8-241">只有當第一個屬性不包含使用者的值時，才會使用第二個屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-241">The second attribute is only used if the first attribute does not contain a value for the user.</span></span>  <span data-ttu-id="475d8-242">預設值是 userPrincipalName 和 sAMAccountName。</span><span class="sxs-lookup"><span data-stu-id="475d8-242">The defaults are userPrincipalName and sAMAccountName.</span></span> |
| <span data-ttu-id="475d8-243">名字</span><span class="sxs-lookup"><span data-stu-id="475d8-243">First name</span></span> |<span data-ttu-id="475d8-244">輸入屬性的屬性名稱，此屬性包含使用者記錄中的名字。</span><span class="sxs-lookup"><span data-stu-id="475d8-244">Enter the attribute name of the attribute that contains the first name in a user record.</span></span>  <span data-ttu-id="475d8-245">預設值是 givenName。</span><span class="sxs-lookup"><span data-stu-id="475d8-245">The default is givenName.</span></span> |
| <span data-ttu-id="475d8-246">姓氏</span><span class="sxs-lookup"><span data-stu-id="475d8-246">Last name</span></span> |<span data-ttu-id="475d8-247">輸入屬性的屬性名稱，此屬性包含使用者記錄中的姓氏。</span><span class="sxs-lookup"><span data-stu-id="475d8-247">Enter the attribute name of the attribute that contains the last name in a user record.</span></span>  <span data-ttu-id="475d8-248">預設值是 sn。</span><span class="sxs-lookup"><span data-stu-id="475d8-248">The default is sn.</span></span> |
| <span data-ttu-id="475d8-249">電子郵件地址</span><span class="sxs-lookup"><span data-stu-id="475d8-249">Email address</span></span> |<span data-ttu-id="475d8-250">輸入屬性的屬性名稱，此屬性包含使用者記錄中的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="475d8-250">Enter the attribute name of the attribute that contains the email address in a user record.</span></span>  <span data-ttu-id="475d8-251">電子郵件地址用來傳送歡迎及更新電子郵件給使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-251">Email address is used to send welcome and update emails to the user.</span></span>  <span data-ttu-id="475d8-252">預設值是 mail。</span><span class="sxs-lookup"><span data-stu-id="475d8-252">The default is mail.</span></span> |
| <span data-ttu-id="475d8-253">使用者群組</span><span class="sxs-lookup"><span data-stu-id="475d8-253">User group</span></span> |<span data-ttu-id="475d8-254">輸入屬性的屬性名稱，此屬性包含使用者記錄中的使用者群組。</span><span class="sxs-lookup"><span data-stu-id="475d8-254">Enter the attribute name of the attribute that contains the user group in a user record.</span></span>  <span data-ttu-id="475d8-255">使用者群組可在 Multi-Factor Auth Server 管理入口網站中用來篩選代理程式和報告中的使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-255">User group can be used to filter users in the agent and on reports in the Multi-Factor Auth Server Management Portal.</span></span> |
| <span data-ttu-id="475d8-256">說明</span><span class="sxs-lookup"><span data-stu-id="475d8-256">Description</span></span> |<span data-ttu-id="475d8-257">輸入屬性的屬性名稱，此屬性包含使用者記錄中的描述。</span><span class="sxs-lookup"><span data-stu-id="475d8-257">Enter the attribute name of the attribute that contains the description in a user record.</span></span>  <span data-ttu-id="475d8-258">描述只用於搜尋。</span><span class="sxs-lookup"><span data-stu-id="475d8-258">Description is only used for searching.</span></span>  <span data-ttu-id="475d8-259">預設值是 description。</span><span class="sxs-lookup"><span data-stu-id="475d8-259">The default is description.</span></span> |
| <span data-ttu-id="475d8-260">通話語言</span><span class="sxs-lookup"><span data-stu-id="475d8-260">Phone call language</span></span> |<span data-ttu-id="475d8-261">輸入屬性的屬性名稱，此屬性包含用於使用者語音通話的語言簡稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-261">Enter the attribute name of the attribute that contains the short name of the language to use for voice calls for the user.</span></span> |
| <span data-ttu-id="475d8-262">簡訊語言</span><span class="sxs-lookup"><span data-stu-id="475d8-262">Text message language</span></span> |<span data-ttu-id="475d8-263">輸入屬性的屬性名稱，此屬性包含用於使用者簡訊的語言簡稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-263">Enter the attribute name of the attribute that contains the short name of the language to use for SMS text messages for the user.</span></span> |
| <span data-ttu-id="475d8-264">行動應用程式語言</span><span class="sxs-lookup"><span data-stu-id="475d8-264">Mobile app language</span></span> |<span data-ttu-id="475d8-265">輸入屬性的屬性名稱，此屬性包含用於使用者電話應用程式簡訊的語言簡稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-265">Enter the attribute name of the attribute that contains the short name of the language to use for phone app text messages for the user.</span></span> |
| <span data-ttu-id="475d8-266">OATH 權杖語言</span><span class="sxs-lookup"><span data-stu-id="475d8-266">OATH token language</span></span> |<span data-ttu-id="475d8-267">輸入屬性的屬性名稱，此屬性包含用於使用者 OATH 權杖簡訊的語言簡稱。</span><span class="sxs-lookup"><span data-stu-id="475d8-267">Enter the attribute name of the attribute that contains the short name of the language to use for OATH token text messages for the user.</span></span> |
| <span data-ttu-id="475d8-268">商務電話</span><span class="sxs-lookup"><span data-stu-id="475d8-268">Business phone</span></span> |<span data-ttu-id="475d8-269">輸入屬性的屬性名稱，此屬性包含使用者記錄中的商務電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-269">Enter the attribute name of the attribute that contains the business phone number in a user record.</span></span>  <span data-ttu-id="475d8-270">預設值是 telephoneNumber。</span><span class="sxs-lookup"><span data-stu-id="475d8-270">The default is telephoneNumber.</span></span> |
| <span data-ttu-id="475d8-271">住家電話</span><span class="sxs-lookup"><span data-stu-id="475d8-271">Home phone</span></span> |<span data-ttu-id="475d8-272">輸入屬性的屬性名稱，此屬性包含使用者記錄中的住家電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-272">Enter the attribute name of the attribute that contains the home phone number in a user record.</span></span>  <span data-ttu-id="475d8-273">預設值是 homePhone。</span><span class="sxs-lookup"><span data-stu-id="475d8-273">The default is homePhone.</span></span> |
| <span data-ttu-id="475d8-274">呼叫器</span><span class="sxs-lookup"><span data-stu-id="475d8-274">Pager</span></span> |<span data-ttu-id="475d8-275">輸入屬性的屬性名稱，此屬性包含使用者記錄中的呼叫器號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-275">Enter the attribute name of the attribute that contains the pager number in a user record.</span></span>  <span data-ttu-id="475d8-276">預設值是 pager。</span><span class="sxs-lookup"><span data-stu-id="475d8-276">The default is pager.</span></span> |
| <span data-ttu-id="475d8-277">行動電話</span><span class="sxs-lookup"><span data-stu-id="475d8-277">Mobile phone</span></span> |<span data-ttu-id="475d8-278">輸入屬性的屬性名稱，此屬性包含使用者記錄中的行動電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-278">Enter the attribute name of the attribute that contains the mobile phone number in a user record.</span></span>  <span data-ttu-id="475d8-279">預設值是 mobile。</span><span class="sxs-lookup"><span data-stu-id="475d8-279">The default is mobile.</span></span> |
| <span data-ttu-id="475d8-280">傳真</span><span class="sxs-lookup"><span data-stu-id="475d8-280">Fax</span></span> |<span data-ttu-id="475d8-281">輸入屬性的屬性名稱，此屬性包含使用者記錄中的傳真號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-281">Enter the attribute name of the attribute that contains the fax number in a user record.</span></span>  <span data-ttu-id="475d8-282">預設值是 facsimileTelephoneNumber。</span><span class="sxs-lookup"><span data-stu-id="475d8-282">The default is facsimileTelephoneNumber.</span></span> |
| <span data-ttu-id="475d8-283">IP 電話</span><span class="sxs-lookup"><span data-stu-id="475d8-283">IP phone</span></span> |<span data-ttu-id="475d8-284">輸入屬性的屬性名稱，此屬性包含使用者記錄中的 IP 電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-284">Enter the attribute name of the attribute that contains the IP phone number in a user record.</span></span>  <span data-ttu-id="475d8-285">預設值是 ipPhone。</span><span class="sxs-lookup"><span data-stu-id="475d8-285">The default is ipPhone.</span></span> |
| <span data-ttu-id="475d8-286">自訂</span><span class="sxs-lookup"><span data-stu-id="475d8-286">Custom</span></span> |<span data-ttu-id="475d8-287">輸入屬性的屬性名稱，其中包含使用者記錄中的自訂電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-287">Enter the attribute name of the attribute that contains a custom phone number in a user record.</span></span>  <span data-ttu-id="475d8-288">預設值為空白。</span><span class="sxs-lookup"><span data-stu-id="475d8-288">The default is blank.</span></span> |
| <span data-ttu-id="475d8-289">分機</span><span class="sxs-lookup"><span data-stu-id="475d8-289">Extension</span></span> |<span data-ttu-id="475d8-290">輸入屬性的屬性名稱，此屬性包含使用者記錄中的分機電話號碼。</span><span class="sxs-lookup"><span data-stu-id="475d8-290">Enter the attribute name of the attribute that contains the phone number extension in a user record.</span></span>  <span data-ttu-id="475d8-291">分機欄位的值只會做為主要電話號碼的分機。</span><span class="sxs-lookup"><span data-stu-id="475d8-291">The value of the extension field is used as the extension to the primary phone number only.</span></span>  <span data-ttu-id="475d8-292">預設值為空白。</span><span class="sxs-lookup"><span data-stu-id="475d8-292">The default is blank.</span></span> <br><br><span data-ttu-id="475d8-293">如果不指定分機屬性，則可以在電話屬性中包含分機。</span><span class="sxs-lookup"><span data-stu-id="475d8-293">If the Extension attribute is not specified, extensions can be included as part of the phone attribute.</span></span> <span data-ttu-id="475d8-294">在此情況下，在分機前面加上 'x'，便可得到正確剖析。</span><span class="sxs-lookup"><span data-stu-id="475d8-294">In this case, precede the extension with an 'x' so that it gets parsed correctly.</span></span>  <span data-ttu-id="475d8-295">例如，555-123-4567 x890 會形成電話號碼 555-123-4567 和分機 890。</span><span class="sxs-lookup"><span data-stu-id="475d8-295">For example, 555-123-4567 x890 would result in 555-123-4567 as the phone number and 890 as the extension.</span></span> |
| <span data-ttu-id="475d8-296">[還原預設值] 按鈕</span><span class="sxs-lookup"><span data-stu-id="475d8-296">Restore Defaults button</span></span> |<span data-ttu-id="475d8-297">按一下 [還原預設值]，可將所有屬性還原為預設值。</span><span class="sxs-lookup"><span data-stu-id="475d8-297">Click **Restore Defaults** to return all attributes back to their default value.</span></span>  <span data-ttu-id="475d8-298">在一般 Active Directory 或 ADAM 結構描述中，預設值應該可以正確運作。</span><span class="sxs-lookup"><span data-stu-id="475d8-298">The defaults should work properly with the normal Active Directory or ADAM schema.</span></span> |

<span data-ttu-id="475d8-299">若要編輯屬性，按一下 [屬性] 索引標籤上的 [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="475d8-299">To edit attributes, click **Edit** on the Attributes tab.</span></span>  <span data-ttu-id="475d8-300">這會帶出您可以在其中編輯屬性的視窗。</span><span class="sxs-lookup"><span data-stu-id="475d8-300">This brings up a window where you can edit the attributes.</span></span> <span data-ttu-id="475d8-301">選取任何屬性旁邊的 [...] 可開啟視窗供您選擇要顯示的屬性。</span><span class="sxs-lookup"><span data-stu-id="475d8-301">Select the **...** next to any attribute to open a window where you can choose which attributes to display.</span></span>

![編輯屬性](./media/multi-factor-authentication-get-started-server-dirint/dirint4.png)

## <a name="synchronization"></a><span data-ttu-id="475d8-303">同步處理</span><span class="sxs-lookup"><span data-stu-id="475d8-303">Synchronization</span></span>
<span data-ttu-id="475d8-304">同步處理可將 Azure MFA 使用者資料庫與 Active Directory 或另一個輕量型目錄存取通訊協定 (LDAP) 目錄中的使用者保持同步。</span><span class="sxs-lookup"><span data-stu-id="475d8-304">Synchronization keeps the Azure MFA user database synchronized with the users in Active Directory or another Lightweight Directory Access Protocol (LDAP) directory.</span></span> <span data-ttu-id="475d8-305">此程序類似於從 Active Directory 手動匯入使用者，但會定期輪詢 Active Directory 使用者和安全性群組是否有需要處理的變更。</span><span class="sxs-lookup"><span data-stu-id="475d8-305">The process is similar to importing users manually from Active Directory, but periodically polls for Active Directory user and security group changes to process.</span></span>  <span data-ttu-id="475d8-306">它也可停用或移除已從容器、安全性群組或 Active Directory 中移除的使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-306">It also disables or removes users that were removed from a container, security group, or Active Directory.</span></span>

<span data-ttu-id="475d8-307">Multi-Factor Auth ADSync 服務是會定期輪詢 Active Directory 的 Windows 服務。</span><span class="sxs-lookup"><span data-stu-id="475d8-307">The Multi-Factor Auth ADSync service is a Windows service that performs the periodic polling of Active Directory.</span></span>  <span data-ttu-id="475d8-308">請勿與 Azure AD Sync 或 Azure AD Connect 搞混。</span><span class="sxs-lookup"><span data-stu-id="475d8-308">This is not to be confused with Azure AD Sync or Azure AD Connect.</span></span>  <span data-ttu-id="475d8-309">Multi-Factor Auth ADSync 雖然是根據類似的程式碼基底建置，但為 Azure Multi-Factor Authentication Server 所專用。</span><span class="sxs-lookup"><span data-stu-id="475d8-309">the Multi-Factor Auth ADSync, although built on a similar code base, is specific to the Azure Multi-Factor Authentication Server.</span></span>  <span data-ttu-id="475d8-310">它會安裝成「已停止」狀態，在設定為執行時才由 Multi-Factor Auth Server 服務啟動。</span><span class="sxs-lookup"><span data-stu-id="475d8-310">It is installed in a Stopped state and is started by the Multi-Factor Auth Server service when configured to run.</span></span>  <span data-ttu-id="475d8-311">如果您有多伺服器 Multi-Factor Auth Server 組態，Multi-Factor Auth ADSync 只能在單一伺服器上執行。</span><span class="sxs-lookup"><span data-stu-id="475d8-311">If you have a multi-server Multi-Factor Auth Server configuration, the Multi-Factor Auth ADSync may only be run on a single server.</span></span>

<span data-ttu-id="475d8-312">Multi-Factor Auth ADSync 服務使用 Microsoft 所提供的 DirSync LDAP 伺服器擴充功能，有效率地輪詢變更。</span><span class="sxs-lookup"><span data-stu-id="475d8-312">The Multi-Factor Auth ADSync service uses the DirSync LDAP server extension provided by Microsoft to efficiently poll for changes.</span></span>  <span data-ttu-id="475d8-313">此 DirSync 控制呼叫端必須具有「目錄變更」權限和 DS-Replication-Get-Changes 擴充控制存取權限。</span><span class="sxs-lookup"><span data-stu-id="475d8-313">This DirSync control caller must have the "directory get changes" right and DS-Replication-Get-Changes extended control access right.</span></span>  <span data-ttu-id="475d8-314">根據預設，這些權限指派給網域控制站上的 Administrator 和 LocalSystem 帳戶。</span><span class="sxs-lookup"><span data-stu-id="475d8-314">By default, these rights are assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span>  <span data-ttu-id="475d8-315">根據預設，Multi-Factor Auth AdSync 服務設定為以 LocalSystem 身分執行。</span><span class="sxs-lookup"><span data-stu-id="475d8-315">The Multi-Factor Auth AdSync service is configured to run as LocalSystem by default.</span></span>  <span data-ttu-id="475d8-316">因此，在網域控制站上執行此服務最簡單。</span><span class="sxs-lookup"><span data-stu-id="475d8-316">Therefore it is simplest to run the service on a domain controller.</span></span>  <span data-ttu-id="475d8-317">如果您將此服務設定為一律執行完整同步處理，此服務可以用權限較少的帳戶執行。</span><span class="sxs-lookup"><span data-stu-id="475d8-317">If you configure the service to always perform a full synchronization, it can run as an account with lesser permissions.</span></span>  <span data-ttu-id="475d8-318">這樣比較沒有效率，但需要的帳戶權限較少。</span><span class="sxs-lookup"><span data-stu-id="475d8-318">This is less efficient, but requires fewer account privileges.</span></span>

<span data-ttu-id="475d8-319">如果 LDAP 目錄支援 DirSync 並為其進行設定，則輪詢使用者和安全性群組的變更時，就如同輪詢 Active Directory 的變更一樣。</span><span class="sxs-lookup"><span data-stu-id="475d8-319">If the LDAP directory supports and is configured for DirSync, then polling for user and security group changes will work the same as it does with Active Directory.</span></span>  <span data-ttu-id="475d8-320">如果 LDAP 目錄不支援 DirSync 控制，則會在每個週期執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-320">If the LDAP directory does not support the DirSync control, then a full synchronization is performed during each cycle.</span></span>

![同步處理](./media/multi-factor-authentication-get-started-server-dirint/dirint5.png)

<span data-ttu-id="475d8-322">下表包含各項 [同步處理] 索引標籤設定的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="475d8-322">The following table contains additional information on each of the Synchronization tab settings.</span></span>

| <span data-ttu-id="475d8-323">功能</span><span class="sxs-lookup"><span data-stu-id="475d8-323">Feature</span></span> | <span data-ttu-id="475d8-324">說明</span><span class="sxs-lookup"><span data-stu-id="475d8-324">Description</span></span> |
| --- | --- |
| <span data-ttu-id="475d8-325">啟用與 Active Directory 同步處理</span><span class="sxs-lookup"><span data-stu-id="475d8-325">Enable synchronization with Active Directory</span></span> |<span data-ttu-id="475d8-326">核取時，Multi-Factor Auth Server 服務會定期輪詢 Active Directory 的變更。</span><span class="sxs-lookup"><span data-stu-id="475d8-326">When checked, the Multi-Factor Auth Server service periodically polls Active Directory for changes.</span></span> <br><br><span data-ttu-id="475d8-327">注意：必須加入至少一個同步處理項目，且必須執行「立即同步處理」，Multi-Factor Auth Server 服務才會開始處理變更。</span><span class="sxs-lookup"><span data-stu-id="475d8-327">Note: At least one Synchronization Item must be added and a Synchronize Now must be performed before the Multi-Factor Auth Server service will start processing changes.</span></span> |
| <span data-ttu-id="475d8-328">同步處理頻率</span><span class="sxs-lookup"><span data-stu-id="475d8-328">Synchronize every</span></span> |<span data-ttu-id="475d8-329">指定 Multi-Factor Auth Server 服務在輪詢和處理變更之間等候的時間間隔。</span><span class="sxs-lookup"><span data-stu-id="475d8-329">Specify the time interval the Multi-Factor Auth Server service will wait between polling and processing changes.</span></span> <br><br> <span data-ttu-id="475d8-330">注意：指定的間隔是每個週期開始之間的時間。</span><span class="sxs-lookup"><span data-stu-id="475d8-330">Note: The interval specified is the time between the beginning of each cycle.</span></span>  <span data-ttu-id="475d8-331">如果處理變更的時間超過間隔，服務將立即再次輪詢。</span><span class="sxs-lookup"><span data-stu-id="475d8-331">If the time processing changes exceed the interval, the service will poll again immediately.</span></span> |
| <span data-ttu-id="475d8-332">移除已不在 Active Directory 中的使用者</span><span class="sxs-lookup"><span data-stu-id="475d8-332">Remove users no longer in Active Directory</span></span> |<span data-ttu-id="475d8-333">核取時，Multi-Factor Auth Server 服務會處理 Active Directory 刪除的使用者標記，並移除相關的 Multi-Factor Auth Server 使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-333">When checked, the Multi-Factor Auth Server service will process Active Directory deleted user tombstones and remove the related Multi-Factor Auth Server user.</span></span> |
| <span data-ttu-id="475d8-334">永遠執行完整同步處理</span><span class="sxs-lookup"><span data-stu-id="475d8-334">Always perform a full synchronization</span></span> |<span data-ttu-id="475d8-335">核取時，Multi-Factor Auth Server 服務將一律執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-335">When checked, the Multi-Factor Auth Server service will always perform a full synchronization.</span></span>  <span data-ttu-id="475d8-336">取消核取時，Multi-Factor Auth Server 服務只會查詢已變更的使用者來執行增量同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-336">When unchecked, the Multi-Factor Auth Server service will perform an incremental synchronization by only querying users that have changed.</span></span>  <span data-ttu-id="475d8-337">預設為核取。</span><span class="sxs-lookup"><span data-stu-id="475d8-337">The default is unchecked.</span></span> <br><br><span data-ttu-id="475d8-338">取消核取時，只有當目錄支援 DirSync 控制，且繫結至目錄的帳戶具有執行 DirSync 增量查詢的權限時，Azure MFA Server 才能執行增量同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-338">When unchecked, Azure MFA Server performs incremental synchronization only when the directory supports the DirSync control and the account binding to the directory has permissions to perform DirSync incremental queries.</span></span>  <span data-ttu-id="475d8-339">如果帳戶沒有適當的權限，或有多個網域涉及同步處理，則 Azure MFA Server 會執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-339">If the account does not have the appropriate permissions or multiple domains are involved in the synchronization, Azure MFA Server performs a full synchronization.</span></span> |
| <span data-ttu-id="475d8-340">超過 X 個使用者將停用或移除時，需要系統管理員核准</span><span class="sxs-lookup"><span data-stu-id="475d8-340">Require administrator approval when more than X users will be disabled or removed</span></span> |<span data-ttu-id="475d8-341">同步處理項目可以設定為停用或移除不再是項目的容器或安全性群組成員的使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-341">Synchronization items can be configured to disable or remove users who are no longer a member of the item's container or security group.</span></span>  <span data-ttu-id="475d8-342">以防萬一，當停用或移除的使用者數目超過臨界值時，可能需要系統管理員核准。</span><span class="sxs-lookup"><span data-stu-id="475d8-342">As a safeguard, administrator approval can be required when the number of users to disable or remove exceeds a threshold.</span></span>  <span data-ttu-id="475d8-343">核取時，超過指定的臨界值就需要核准。</span><span class="sxs-lookup"><span data-stu-id="475d8-343">When checked, approval is required for specified threshold.</span></span>  <span data-ttu-id="475d8-344">預設值為 5，範圍從 1 到 999。</span><span class="sxs-lookup"><span data-stu-id="475d8-344">The default is 5 and the range is 1 to 999.</span></span> <br><br> <span data-ttu-id="475d8-345">核准之前會先傳送電子郵件通知給系統管理員。</span><span class="sxs-lookup"><span data-stu-id="475d8-345">Approval is facilitated by first sending an email notification to administrators.</span></span> <span data-ttu-id="475d8-346">電子郵件通知提供指示來檢閱及核准停用和移除使用者。</span><span class="sxs-lookup"><span data-stu-id="475d8-346">The email notification gives instructions for reviewing and approving the disabling and removal of users.</span></span>  <span data-ttu-id="475d8-347">Multi-Factor Auth Server 使用者介面啟動時會提示要求核准。</span><span class="sxs-lookup"><span data-stu-id="475d8-347">When the Multi-Factor Auth Server user interface is launched, it will prompt for approval.</span></span> |

<span data-ttu-id="475d8-348">[ **立即同步處理** ] 按鈕可讓您針對指定的同步處理項目，執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-348">The **Synchronize Now** button allows you to run a full synchronization for the synchronization items specified.</span></span>  <span data-ttu-id="475d8-349">每當加入、修改、移除或重新排列同步處理項目時，就需要完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-349">A full synchronization is required whenever synchronization items are added, modified, removed, or reordered.</span></span>  <span data-ttu-id="475d8-350">也需要如此，Multi-Factor Auth AdSync 服務才能運作，因為它會設定服務輪詢增量變更的起始點。</span><span class="sxs-lookup"><span data-stu-id="475d8-350">It is also required before the Multi-Factor Auth AdSync service is operational since it sets the starting point from which the service will poll for incremental changes.</span></span>  <span data-ttu-id="475d8-351">如果同步處理項目已變更，但尚未執行完整同步處理，系統將會提示您「立即同步處理」。</span><span class="sxs-lookup"><span data-stu-id="475d8-351">If changes have been made to synchronization items but a full synchronization hasn't been performed, you will be prompted to Synchronize Now.</span></span>

<span data-ttu-id="475d8-352">[ **移除** ] 按鈕可讓系統管理員從 Multi-Factor Auth Server 同步處理項目清單刪除一個或多個同步處理項目。</span><span class="sxs-lookup"><span data-stu-id="475d8-352">The **Remove** button allows the administrator to delete one or more synchronization items from the Multi-Factor Auth Server synchronization item list.</span></span>

> [!WARNING]
> <span data-ttu-id="475d8-353">一旦移除同步處理項目記錄就無法復原。</span><span class="sxs-lookup"><span data-stu-id="475d8-353">Once a synchronization item record has been removed, it cannot be recovered.</span></span> <span data-ttu-id="475d8-354">如果不小心刪除，則必須再次新增同步處理項目記錄。</span><span class="sxs-lookup"><span data-stu-id="475d8-354">You will need to add the synchronization item record again if you deleted it by mistake.</span></span>

<span data-ttu-id="475d8-355">同步處理項目已從 Multi-Factor Auth Server 中移除。</span><span class="sxs-lookup"><span data-stu-id="475d8-355">The synchronization item or synchronization items have been removed from Multi-Factor Auth Server.</span></span>  <span data-ttu-id="475d8-356">Multi-Factor Auth Server 服務將不再處理這些同步處理項目。</span><span class="sxs-lookup"><span data-stu-id="475d8-356">The Multi-Factor Auth Server service will no longer process the synchronization items.</span></span>

<span data-ttu-id="475d8-357">[上移] 和 [下移] 按鈕可讓系統管理員變更同步處理項目的順序。</span><span class="sxs-lookup"><span data-stu-id="475d8-357">The Move Up and Move Down buttons allow the administrator to change the order of the synchronization items.</span></span>  <span data-ttu-id="475d8-358">順序很重要，因為相同的使用者可能是多個同步處理項目 (例如容器和安全性群組) 的成員。</span><span class="sxs-lookup"><span data-stu-id="475d8-358">The order is important since the same user may be a member of more than one synchronization item (e.g. a container and a security group).</span></span>  <span data-ttu-id="475d8-359">在同步處理期間套用至使用者的設定，將來自使用者相關聯的清單中的第一個同步處理項目。</span><span class="sxs-lookup"><span data-stu-id="475d8-359">The settings applied to the user during synchronization will come from the first synchronization item in the list to which the user is associated.</span></span>  <span data-ttu-id="475d8-360">因此，同步處理項目應該依優先順序放置。</span><span class="sxs-lookup"><span data-stu-id="475d8-360">Therefore, the synchronization items should be put in priority order.</span></span>

> [!TIP]
> <span data-ttu-id="475d8-361">移除同步處理項目之後應該執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-361">A full synchronization should be performed after removing synchronization items.</span></span>  <span data-ttu-id="475d8-362">排序同步處理項目之後應該執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-362">A full synchronization should be performed after ordering synchronization items.</span></span>  <span data-ttu-id="475d8-363">按一下 [立即同步處理] 以執行完整同步處理。</span><span class="sxs-lookup"><span data-stu-id="475d8-363">Click **Synchronize Now** to perform a full synchronization.</span></span>

## <a name="multi-factor-auth-servers"></a><span data-ttu-id="475d8-364">Multi-Factor Auth Server</span><span class="sxs-lookup"><span data-stu-id="475d8-364">Multi-Factor Auth Servers</span></span>
<span data-ttu-id="475d8-365">可以設定其他 Multi-Factor Auth Server 做為備份 RADIUS Proxy、LDAP Proxy 或是用於 IIS 驗證。</span><span class="sxs-lookup"><span data-stu-id="475d8-365">Additional Multi-Factor Auth Servers may be set up to serve as a backup RADIUS proxy, LDAP proxy, or for IIS Authentication.</span></span> <span data-ttu-id="475d8-366">所有代理程式會共用同步處理組態。</span><span class="sxs-lookup"><span data-stu-id="475d8-366">The Synchronization configuration is shared among all the agents.</span></span> <span data-ttu-id="475d8-367">但其中只有一個代理程式會執行 Multi-Factor Auth Server 服務。</span><span class="sxs-lookup"><span data-stu-id="475d8-367">However, only one of these agents may have the Multi-Factor Auth Server service running.</span></span> <span data-ttu-id="475d8-368">此索引標籤可讓您選取應該啟用同步處理的 Multi-Factor Auth Server。</span><span class="sxs-lookup"><span data-stu-id="475d8-368">This tab allows you to select the Multi-Factor Auth Server that should be enabled for synchronization.</span></span>

![Multi-Factor-Auth Server](./media/multi-factor-authentication-get-started-server-dirint/dirint6.png)
