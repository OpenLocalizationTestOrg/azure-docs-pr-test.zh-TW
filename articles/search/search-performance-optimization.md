---
title: "aaaAzure 搜尋效能與最佳化考量 |Microsoft 文件"
description: "調整 Azure 搜尋服務效能並設定最佳規模"
services: search
documentationcenter: 
author: LiamCavanagh
manager: pablocas
editor: 
ms.assetid: 4d3cd864-29d2-4921-be0d-a3f1a819de46
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 05/01/2017
ms.author: liamca
ms.openlocfilehash: 725149ba32773ab6b4c9d4b441424aba78db7c42
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/06/2017
---
# <a name="azure-search-performance-and-optimization-considerations"></a><span data-ttu-id="aa94a-103">Azure 搜尋服務的效能與最佳化考量</span><span class="sxs-lookup"><span data-stu-id="aa94a-103">Azure Search performance and optimization considerations</span></span>
<span data-ttu-id="aa94a-104">絕佳搜尋經驗是索引鍵 toosuccess 許多行動應用程式和 web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="aa94a-104">A great search experience is a key toosuccess for many mobile and web applications.</span></span> <span data-ttu-id="aa94a-105">不動產，從 tooused 汽車市場 tooonline 目錄、 快速搜尋和相關的結果將會影響 hello 客戶經驗。</span><span class="sxs-lookup"><span data-stu-id="aa94a-105">From real estate, tooused car marketplaces tooonline catalogs, fast search and relevant results will affect hello customer experience.</span></span> <span data-ttu-id="aa94a-106">本文件是預定的 toohelp 探索如何充分利用 Azure 搜尋中，特別是針對進階案例使用 tooget hello 複雜的延展性、 多重語言支援或自訂的順位需求的最佳作法。</span><span class="sxs-lookup"><span data-stu-id="aa94a-106">This document is intended toohelp you discover best practices for how tooget hello most out of Azure Search, especially for advanced scenarios with sophisticated requirements for scalability, multi-language support, or custom ranking.</span></span>  <span data-ttu-id="aa94a-107">此外，本文件也會概述本質，並涵蓋可在真實世界客戶應用程式中有效率地工作的處理方法。</span><span class="sxs-lookup"><span data-stu-id="aa94a-107">In addition, this document outlines internals and covers approaches that work effectively in real-world customer apps.</span></span>

## <a name="performance-and-scale-tuning-for-search-services"></a><span data-ttu-id="aa94a-108">適用於搜尋服務的效能和規模調整</span><span class="sxs-lookup"><span data-stu-id="aa94a-108">Performance and scale tuning for Search services</span></span>
<span data-ttu-id="aa94a-109">我們為所有使用的 toosearch 引擎等時所提供的 Bing 和 Google 和 hello 高的效能。</span><span class="sxs-lookup"><span data-stu-id="aa94a-109">We are all used toosearch engines such as Bing and Google and hello high performance they offer.</span></span>  <span data-ttu-id="aa94a-110">因此，當客戶使用您已具備搜尋功能的 Web 或行動應用程式時，他們將期望類似的效能特性。</span><span class="sxs-lookup"><span data-stu-id="aa94a-110">As a result, when customers use your search-enabled web or mobile application, they will expect similar performance characteristics.</span></span>  <span data-ttu-id="aa94a-111">最佳化搜尋效能、 hello 最佳方法之一時，對延遲，也就是查詢所需 toocomplete 並傳回結果的 hello 時間 toofocus。</span><span class="sxs-lookup"><span data-stu-id="aa94a-111">When optimizing for search performance, one of hello best approaches is toofocus on latency, which is hello time a query takes toocomplete and return results.</span></span>  <span data-ttu-id="aa94a-112">針對搜尋延遲進行最佳化時，請務必：</span><span class="sxs-lookup"><span data-stu-id="aa94a-112">When optimizing for search latency it is important to:</span></span>

1. <span data-ttu-id="aa94a-113">挑選一般搜尋要求應該採取 toocomplete 目標延遲 （或最大時間量）。</span><span class="sxs-lookup"><span data-stu-id="aa94a-113">Pick a target latency (or maximum amount of time) that a typical search request should take toocomplete.</span></span>
2. <span data-ttu-id="aa94a-114">建立並測試您的搜尋服務與實際的資料集 toomeasure 實際工作負載這些延遲率。</span><span class="sxs-lookup"><span data-stu-id="aa94a-114">Create and test a real workload against your search service with a realistic dataset toomeasure these latency rates.</span></span>
3. <span data-ttu-id="aa94a-115">每秒查詢數 (QPS) 數目最少的開頭，並繼續 tooincrease hello 數目 hello 測試中執行，直到延遲低於 hello hello 查詢定義為目標延遲。</span><span class="sxs-lookup"><span data-stu-id="aa94a-115">Start with a low number of queries per second (QPS) and continue tooincrease hello number executed in hello test until hello query latency drops below hello defined target latency.</span></span>  <span data-ttu-id="aa94a-116">這是您計劃標尺的使用狀況應用程式茁壯重要基準 toohelp。</span><span class="sxs-lookup"><span data-stu-id="aa94a-116">This is an important benchmark toohelp you plan for scale as your application grows in usage.</span></span>
4. <span data-ttu-id="aa94a-117">如果可能，請重複使用 HTTP 連接。</span><span class="sxs-lookup"><span data-stu-id="aa94a-117">Wherever possible, reuse HTTP connections.</span></span>  <span data-ttu-id="aa94a-118">如果您使用 hello Azure 搜尋.NET SDK，這表示您應該重複使用執行個體或[SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient)執行個體，且如果您使用 hello REST API，您應該重複使用單一的 HttpClient。</span><span class="sxs-lookup"><span data-stu-id="aa94a-118">If you are using hello Azure Search .NET SDK, this means you should reuse an instance or [SearchIndexClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchindexclient) instance, and if you are using hello REST API, you should reuse a single HttpClient.</span></span>

<span data-ttu-id="aa94a-119">當建立這些測試工作負載，有個 Azure 搜尋 tookeep 記住一些特性：</span><span class="sxs-lookup"><span data-stu-id="aa94a-119">While creating these test workloads, there are some characteristics of Azure Search tookeep in mind:</span></span>

1. <span data-ttu-id="aa94a-120">很可能 toopush 這麼多的搜尋查詢一次，您的 Azure 搜尋服務中所提供的 hello 資源將會過度負荷。</span><span class="sxs-lookup"><span data-stu-id="aa94a-120">It is possible toopush so many search queries at one time, that hello resources available in your Azure Search service will be overwhelmed.</span></span>  <span data-ttu-id="aa94a-121">發生這種情況時，您將會看到 HTTP 503 回應碼。</span><span class="sxs-lookup"><span data-stu-id="aa94a-121">When this happens, you will see HTTP 503 response codes.</span></span>  <span data-ttu-id="aa94a-122">基於這個理由，是與不同的範圍與延遲率的搜尋要求 toosee hello 差異的最佳 toostart 當您新增更多的搜尋要求。</span><span class="sxs-lookup"><span data-stu-id="aa94a-122">For this reason, it is best toostart with various ranges of search requests toosee hello differences in latency rates as you add more search requests.</span></span>
2. <span data-ttu-id="aa94a-123">上傳的內容將會影響搜尋的 tooAzure hello 整體效能和延遲的 hello Azure 搜尋服務。</span><span class="sxs-lookup"><span data-stu-id="aa94a-123">Uploading of content tooAzure Search will impact hello overall performance and latency of hello Azure Search service.</span></span>  <span data-ttu-id="aa94a-124">如果您預期 toosend 資料，使用者會執行搜尋時，很重要 tootake 到此工作負載測試中的帳戶。</span><span class="sxs-lookup"><span data-stu-id="aa94a-124">If you expect toosend data while users are performing searches, it is important tootake this workload into account in your tests.</span></span>
3. <span data-ttu-id="aa94a-125">並非每個搜尋查詢會在執行 hello 相同的效能層級。</span><span class="sxs-lookup"><span data-stu-id="aa94a-125">Not every search query will perform at hello same performance levels.</span></span>  <span data-ttu-id="aa94a-126">例如，比起具有大量 Facet 和篩選的查詢，文件查閱或搜尋建議的執行速度通常會更快。</span><span class="sxs-lookup"><span data-stu-id="aa94a-126">For example, a document lookup or search suggestion will typically perform faster than a query with a significant number of facets and filters.</span></span>  <span data-ttu-id="aa94a-127">它是您預期到 toosee 的各種查詢帳戶建立您的測試時的最佳 tootake hello。</span><span class="sxs-lookup"><span data-stu-id="aa94a-127">It is best tootake hello various queries you expect toosee into account when building your tests.</span></span>  
4. <span data-ttu-id="aa94a-128">搜尋要求的變化非常重要，因為如果您持續執行 hello 相同搜尋要求，快取的資料將會開始 toomake 效能尋找優於它可能會比較不同的查詢與設定。</span><span class="sxs-lookup"><span data-stu-id="aa94a-128">Variation of search requests is important because if you continually execute hello same search requests, caching of data will start toomake performance look better than it might with a more disparate query set.</span></span>

> [!NOTE]
> <span data-ttu-id="aa94a-129">[Visual Studio 負載測試](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release)是真的很好的方式 tooperform 您基準測試，因為它可讓您 tooexecute HTTP 要求與您需要對 Azure 搜尋執行查詢，並啟用平行處理的要求。</span><span class="sxs-lookup"><span data-stu-id="aa94a-129">[Visual Studio Load Testing](https://www.visualstudio.com/docs/test/performance-testing/run-performance-tests-app-before-release) is a really good way tooperform your benchmark tests as it allows you tooexecute HTTP requests as you would need for executing queries against Azure Search and enables parallelization of requests.</span></span>
> 
> 

## <a name="scaling-azure-search-for-high-query-rates-and-throttled-requests"></a><span data-ttu-id="aa94a-130">調整 Azure 搜尋服務以提供高速查詢和節流要求</span><span class="sxs-lookup"><span data-stu-id="aa94a-130">Scaling Azure Search for high query rates and throttled requests</span></span>
<span data-ttu-id="aa94a-131">當您收到節流的要求太多或超過您從增加的查詢負載的目標延遲率時，您可以查看 toodecrease 延遲率兩種方式之一：</span><span class="sxs-lookup"><span data-stu-id="aa94a-131">When you are receiving too many throttled requests or exceed your target latency rates from an increased query load, you can look toodecrease latency rates in one of two ways:</span></span>

1. <span data-ttu-id="aa94a-132">**增加複本：**複本就像是您的資料複本允許對 hello Azure 搜尋 tooload 平衡要求多個複本。</span><span class="sxs-lookup"><span data-stu-id="aa94a-132">**Increase Replicas:**  A replica is like a copy of your data allowing Azure Search tooload balance requests against hello multiple copies.</span></span>  <span data-ttu-id="aa94a-133">所有的負載平衡和複本之間的資料複寫由 Azure 搜尋管理及您可以變更 hello 隨時為您的服務配置的複本數目。</span><span class="sxs-lookup"><span data-stu-id="aa94a-133">All load balancing and replication of data across replicas is managed by Azure Search and you can alter hello number of replicas allocated for your service at any time.</span></span>  <span data-ttu-id="aa94a-134">您可以配置在標準搜尋服務 too12 複本和基本搜尋服務中的 3 個複本。</span><span class="sxs-lookup"><span data-stu-id="aa94a-134">You can allocate up too12 replicas in a Standard search service and 3 replicas in a Basic search service.</span></span> <span data-ttu-id="aa94a-135">複本可調整從 hello [Azure 入口網站](search-create-service-portal.md)或[PowerShell](search-manage-powershell.md)。</span><span class="sxs-lookup"><span data-stu-id="aa94a-135">Replicas can be adjusted either from hello [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="aa94a-136">**增加搜尋服務層︰**Azure 搜尋服務來自[層數](https://azure.microsoft.com/pricing/details/search/)，而這其中的每一層都會提供不同等級的效能。</span><span class="sxs-lookup"><span data-stu-id="aa94a-136">**Increase Search Tier:**  Azure Search comes in a [number of tiers](https://azure.microsoft.com/pricing/details/search/) and each of these tiers offers different levels of performance.</span></span>  <span data-ttu-id="aa94a-137">在某些情況下，您可能需要您位於該 hello 層無法提供夠低度延遲率，複本會超量時，即使這麼多的查詢。在此情況下，您可能想 tooconsider 運用 hello Azure 搜尋 S3 層非常適合具有大量的文件和極高的查詢工作負載的情況下，例如 hello 更高搜尋階層的其中一個。</span><span class="sxs-lookup"><span data-stu-id="aa94a-137">In some cases, you may have so many queries that hello tier you are on cannot provide sufficiently low latency rates, even when replicas are maxed out.  In this case, you may want tooconsider leveraging one of hello higher search tiers such as hello Azure Search S3 tier that is well suited for scenarios with large numbers of documents and extremely high query workloads.</span></span>

## <a name="scaling-azure-search-for-slow-individual-queries"></a><span data-ttu-id="aa94a-138">針對速度較慢的個別查詢調整 Azure 搜尋服務</span><span class="sxs-lookup"><span data-stu-id="aa94a-138">Scaling Azure Search for slow individual queries</span></span>
<span data-ttu-id="aa94a-139">為什麼延遲速率可能很慢的另一個原因是來自單一查詢花費太長 toocomplete。</span><span class="sxs-lookup"><span data-stu-id="aa94a-139">Another reason why latency rates can be slow is from a single query taking too long toocomplete.</span></span>  <span data-ttu-id="aa94a-140">在此情況下，新增複本將無法改善延遲率。</span><span class="sxs-lookup"><span data-stu-id="aa94a-140">In this case, adding replicas will not improve latency rates.</span></span>  <span data-ttu-id="aa94a-141">在此情況下，有兩個可用選項：</span><span class="sxs-lookup"><span data-stu-id="aa94a-141">For this case there are two options available:</span></span>

1. <span data-ttu-id="aa94a-142">**增加分割區** 分割區是一種機制，可分割資料以分散到額外的資源上。</span><span class="sxs-lookup"><span data-stu-id="aa94a-142">**Increase Partitions** A partition is a mechanism for splitting your data across extra resources.</span></span>  <span data-ttu-id="aa94a-143">基於這個理由，當您新增第二個分割區時，您的資料就會一分為二。</span><span class="sxs-lookup"><span data-stu-id="aa94a-143">For this reason, when you add a second partition, your data gets split into two.</span></span>  <span data-ttu-id="aa94a-144">第三個分割區會將您的索引分成三等份，依此類推。這也有 hello 效果，在某些情況下，緩慢的查詢將會執行得更快到期的計算 toohello 平行化作業。</span><span class="sxs-lookup"><span data-stu-id="aa94a-144">A third partition splits your index into three, etc.  This also has hello effect that in some cases, slow queries will perform faster due toohello parallelization of computation.</span></span>  <span data-ttu-id="aa94a-145">我們可以在一些範例中看見這個平行處理搭配具有低度選擇性查詢的查詢時運作得非常好。</span><span class="sxs-lookup"><span data-stu-id="aa94a-145">There are a few examples of where we have seen this parallelization work extremely well with queries that have low selectivity queries.</span></span>  <span data-ttu-id="aa94a-146">這包含比對許多文件的查詢或 tooprovide faceting 需要時計算透過大量文件。</span><span class="sxs-lookup"><span data-stu-id="aa94a-146">This consists of queries that match many documents or when faceting needs tooprovide counts over large numbers of documents.</span></span>  <span data-ttu-id="aa94a-147">因為有大量計算所需的 hello 文件或 toocount hello 的數字的文件，加入額外的資料分割可以幫助 tooprovide 額外計算 tooscore hello 相關性。</span><span class="sxs-lookup"><span data-stu-id="aa94a-147">Since there is a lot of computation needed tooscore hello relevancy of hello documents or toocount hello numbers of documents, adding extra partitions can help tooprovide additional computation.</span></span>  
   
   <span data-ttu-id="aa94a-148">可以在標準搜尋服務中的 12 個資料分割最多和 1 hello 基本搜尋服務中的資料分割。</span><span class="sxs-lookup"><span data-stu-id="aa94a-148">There can be a maximum of 12 partitions in Standard search service and 1 partition in hello basic search service.</span></span>  <span data-ttu-id="aa94a-149">資料分割可以調整從 hello [Azure 入口網站](search-create-service-portal.md)或[PowerShell](search-manage-powershell.md)。</span><span class="sxs-lookup"><span data-stu-id="aa94a-149">Partitions can be adjusted either from hello [Azure portal](search-create-service-portal.md) or [PowerShell](search-manage-powershell.md).</span></span>
2. <span data-ttu-id="aa94a-150">**高基數欄位限制：**高基數欄位所組成的可進行 facet 處理或有大量的唯一值，而且如此一來，就會大量的資源 toocompute 結果的可篩選欄位。</span><span class="sxs-lookup"><span data-stu-id="aa94a-150">**Limit High Cardinality Fields:** A high cardinality field consists of a facetable or filterable field that has a significant number of unique values, and as a result, takes a lot of resources toocompute results over.</span></span>   <span data-ttu-id="aa94a-151">例如，產品識別碼或描述欄位設定為可進行 facet 處理/篩選會使高基數的因為大部分的文件 toodocument hello 值都是唯一。</span><span class="sxs-lookup"><span data-stu-id="aa94a-151">For example, setting a Product ID or Description field as facetable/filterable would make for high cardinality because most of hello values from document toodocument are unique.</span></span> <span data-ttu-id="aa94a-152">可能的話，高基數欄位的 hello 數目限制。</span><span class="sxs-lookup"><span data-stu-id="aa94a-152">Wherever possible, limit hello number of high cardinality fields.</span></span>
3. <span data-ttu-id="aa94a-153">**增加搜尋層：** tooa 更高版本上移 Azure 搜尋層可以另一個方式 tooimprove 效能緩慢的查詢。</span><span class="sxs-lookup"><span data-stu-id="aa94a-153">**Increase Search Tier:**  Moving up tooa higher Azure Search tier can be another way tooimprove performance of slow queries.</span></span>  <span data-ttu-id="aa94a-154">每一個較高的層也會提供更快速的 CPU 和更多記憶體，可以對查詢效能產生正面的影響。</span><span class="sxs-lookup"><span data-stu-id="aa94a-154">Each higher tier also provides faster CPU’s and more memory which can have a positive impact on query performance.</span></span>

## <a name="scaling-for-availability"></a><span data-ttu-id="aa94a-155">調整可用性</span><span class="sxs-lookup"><span data-stu-id="aa94a-155">Scaling for availability</span></span>
<span data-ttu-id="aa94a-156">複本不僅有助於減少查詢延遲，也可以允許高可用性。</span><span class="sxs-lookup"><span data-stu-id="aa94a-156">Replicas not only help reduce query latency but can also allow for high availability.</span></span>  <span data-ttu-id="aa94a-157">與單一的複本，您應該會定期停機 tooserver 重新開機後軟體更新或其他維護活動，將會出現。</span><span class="sxs-lookup"><span data-stu-id="aa94a-157">With a single replica, you should expect periodic downtime due tooserver reboots after software updates or for other maintenance events that will occur.</span></span>  <span data-ttu-id="aa94a-158">如此一來，它是重要 tooconsider 如果應用程式所需的搜尋 （查詢） 的高可用性和寫入 （索引事件）。</span><span class="sxs-lookup"><span data-stu-id="aa94a-158">As a result, it is important tooconsider if your application requires high availability of searches (queries) as well as writes (indexing events).</span></span>  <span data-ttu-id="aa94a-159">Azure 搜尋會提供所有的 SLA 選項具有下列屬性的 hello hello 付費的搜尋供應項目：</span><span class="sxs-lookup"><span data-stu-id="aa94a-159">Azure Search offers SLA options on all hello paid search offerings with hello following attributes:</span></span>

* <span data-ttu-id="aa94a-160">針對唯讀工作負載 (查詢)，需有 2 個複本才能達到高可用性</span><span class="sxs-lookup"><span data-stu-id="aa94a-160">2 replicas for high availability of read-only workloads (queries)</span></span>
* <span data-ttu-id="aa94a-161">針對讀取/寫入工作負載 (查詢和索引) 的高可用性為 3 或更多個複本</span><span class="sxs-lookup"><span data-stu-id="aa94a-161">3 or more replicas for high availability of read-write workloads (queries and indexing)</span></span>

<span data-ttu-id="aa94a-162">如需詳細資訊，在此，請瀏覽 hello [Azure 搜尋服務等級協定](https://azure.microsoft.com/support/legal/sla/search/v1_0/)。</span><span class="sxs-lookup"><span data-stu-id="aa94a-162">For more details on this, please visit hello [Azure Search Service Level Agreement](https://azure.microsoft.com/support/legal/sla/search/v1_0/).</span></span>

<span data-ttu-id="aa94a-163">由於複本位於您資料副本，具有多個複本，可讓 Azure 搜尋 toodo 機器重新開機，並維護一個複本，同時允許一次針對查詢 toocontinue toobe 針對執行 hello 其他複本。</span><span class="sxs-lookup"><span data-stu-id="aa94a-163">Since replicas are copies of your data, having multiple replicas allows Azure Search toodo machine reboots and maintenance against one replica at a time while allowing queries toocontinue toobe executed against hello other replicas.</span></span>  <span data-ttu-id="aa94a-164">基於這個原因，您也必須的 tooconsider 這個停機時間可能會如何影響 hello 現在有 toobe 針對 hello 資料較少複本執行的查詢。</span><span class="sxs-lookup"><span data-stu-id="aa94a-164">For that reason, you will also need tooconsider how this downtime may impact hello queries that now have toobe executed against one less copy of hello data.</span></span>

## <a name="scaling-geo-distributed-workloads-and-provide-geo-redundancy"></a><span data-ttu-id="aa94a-165">調整異地分散的工作負載並提供異地備援</span><span class="sxs-lookup"><span data-stu-id="aa94a-165">Scaling geo-distributed workloads and provide geo-redundancy</span></span>
<span data-ttu-id="aa94a-166">針對地理分散工作負載，您會發現遠離 hello 資料中心裝載您的 Azure 搜尋服務的使用者會有較高的延遲率。</span><span class="sxs-lookup"><span data-stu-id="aa94a-166">For geo-distributed workloads, you will find that users located far from hello data center where your Azure Search service is hosted will have higher latency rates.</span></span>  <span data-ttu-id="aa94a-167">基於這個理由，通常很重要的 toohave 位於更接近鄰近 toothese 使用者的區域中的多個搜尋服務。</span><span class="sxs-lookup"><span data-stu-id="aa94a-167">For this reason, it is often important toohave multiple search services in regions that are in closer proximity toothese users.</span></span>  <span data-ttu-id="aa94a-168">Azure 搜尋目前未提供自動化的方法的地理複寫的 Azure 搜尋索引跨區域，但有一些技術可以使用，可以讓此程序簡單 tooimplement 並管理。</span><span class="sxs-lookup"><span data-stu-id="aa94a-168">Azure Search does not currently provide an automated method of geo-replicating Azure Search indexes across regions, but there are some techniques that can be used that can make this process simple tooimplement and manage.</span></span> <span data-ttu-id="aa94a-169">這些述 hello 接下來的章節。</span><span class="sxs-lookup"><span data-stu-id="aa94a-169">These are outlined in hello next few sections.</span></span>

<span data-ttu-id="aa94a-170">hello 地理分散的一組搜尋服務的目標是 toohave 兩個或多個索引可在兩個或多個區域，將使用者路由傳送 toohello Azure 搜尋服務，可提供 hello 最低延遲，如本範例所示：</span><span class="sxs-lookup"><span data-stu-id="aa94a-170">hello goal of a geo-distributed set of search services is toohave two or more indexes available in two or more regions where a user will be routed toohello Azure Search service that provides hello lowest latency as seen in this example:</span></span>

   ![依區域交叉分析服務][1]

### <a name="keeping-data-in-sync-across-multiple-azure-search-services"></a><span data-ttu-id="aa94a-172">跨多個 Azure 搜尋服務，讓資料維持同步</span><span class="sxs-lookup"><span data-stu-id="aa94a-172">Keeping data in sync across multiple Azure Search services</span></span>
<span data-ttu-id="aa94a-173">有兩個選項，將保持在分散式的搜尋服務同步組成使用 hello [Azure 搜尋索引子](search-indexer-overview.md)或 hello 推送 API (也稱為 tooas hello [Azure 搜尋 REST API](https://docs.microsoft.com/rest/api/searchservice/))。</span><span class="sxs-lookup"><span data-stu-id="aa94a-173">There are two options for keeping your distributed search services in sync which consist of either using hello [Azure Search Indexer](search-indexer-overview.md) or hello Push API (also referred tooas hello [Azure Search REST API](https://docs.microsoft.com/rest/api/searchservice/)).</span></span>  

### <a name="azure-search-indexers"></a><span data-ttu-id="aa94a-174">Azure 搜尋服務索引子</span><span class="sxs-lookup"><span data-stu-id="aa94a-174">Azure Search Indexers</span></span>
<span data-ttu-id="aa94a-175">如果您使用 hello Azure 搜尋索引子，您已匯入資料的變更集中的資料存放區，例如 Azure SQL DB 或 Azure Cosmos DB。</span><span class="sxs-lookup"><span data-stu-id="aa94a-175">If you are using hello Azure Search Indexer, you are already importing data changes from a central datastore such as Azure SQL DB or Azure Cosmos DB.</span></span> <span data-ttu-id="aa94a-176">當您建立新的搜尋服務，您只需也建立了新的 Azure 搜尋索引子，該服務該點 toothis 相同的資料存放區。</span><span class="sxs-lookup"><span data-stu-id="aa94a-176">When you create a new search Service, you simply also create a new Azure Search Indexer for that service that points toothis same datastore.</span></span> <span data-ttu-id="aa94a-177">這樣一來，每當新的變更進入 hello 資料存放區，則會以編製索引 hello 各種索引子。</span><span class="sxs-lookup"><span data-stu-id="aa94a-177">That way, whenever new changes come into hello data store, they will then be indexed by hello various Indexers.</span></span>  

<span data-ttu-id="aa94a-178">以下範例為該架構所呈現的樣子。</span><span class="sxs-lookup"><span data-stu-id="aa94a-178">Here is an example of what that architecture would look like.</span></span>

   ![具有分散式索引子和服務組合的單一資料來源][2]

### <a name="push-api"></a><span data-ttu-id="aa94a-180">推送 API</span><span class="sxs-lookup"><span data-stu-id="aa94a-180">Push API</span></span>
<span data-ttu-id="aa94a-181">如果您使用 hello Azure 搜尋推送 API 太[更新您的 Azure 搜尋索引中的內容](https://docs.microsoft.com/rest/api/searchservice/update-index)，您可以將各種不同的搜尋服務同步推送變更 tooall 搜尋服務，需要更新時。</span><span class="sxs-lookup"><span data-stu-id="aa94a-181">If you are using hello Azure Search Push API too[update content in your Azure Search index](https://docs.microsoft.com/rest/api/searchservice/update-index), you can keep your various search services in sync by pushing changes tooall search services whenever an update is required.</span></span>  <span data-ttu-id="aa94a-182">這項操作時很重要的 toomake 確定 toohandle 情況下更新 tooone 搜尋服務失敗而一或多個更新成功。</span><span class="sxs-lookup"><span data-stu-id="aa94a-182">When doing this it is important toomake sure toohandle cases where an update tooone search service fails and one or more updates succeed.</span></span>

## <a name="leveraging-azure-traffic-manager"></a><span data-ttu-id="aa94a-183">運用 Azure 流量管理員</span><span class="sxs-lookup"><span data-stu-id="aa94a-183">Leveraging Azure Traffic Manager</span></span>
<span data-ttu-id="aa94a-184">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md)可讓您 tooroute 要求 toomultiple 地理位置網站，然後由多個 Azure 搜尋服務。</span><span class="sxs-lookup"><span data-stu-id="aa94a-184">[Azure Traffic Manager](../traffic-manager/traffic-manager-overview.md) allows you tooroute requests toomultiple geo-located websites that are then backed by multiple Azure Search Services.</span></span>  <span data-ttu-id="aa94a-185">Hello Traffic Manager 的其中一個優點是可以探查是可用的 Azure 搜尋 tooensure 和路由的停機時間的 hello 事件中的使用者 tooalternate 搜尋服務。</span><span class="sxs-lookup"><span data-stu-id="aa94a-185">One advantage of hello Traffic Manager is that it can probe Azure Search tooensure that it is available and route users tooalternate search services in hello event of downtime.</span></span>  <span data-ttu-id="aa94a-186">此外，如果您要路由傳送 search 要求是透過 Azure Web Sites，Azure Traffic Manager 可讓您 tooload 平衡案例 hello 網站已啟動但不是 Azure 搜尋。</span><span class="sxs-lookup"><span data-stu-id="aa94a-186">In addition, if you are routing search requests through Azure Web Sites, Azure Traffic Manager allows you tooload balance cases where hello Website is up but not Azure Search.</span></span>  <span data-ttu-id="aa94a-187">以下是哪一個 hello 架構運用 Traffic Manager 的範例。</span><span class="sxs-lookup"><span data-stu-id="aa94a-187">Here is an example of what hello architecture that leverages Traffic Manager.</span></span>

   ![利用中央流量管理員依區域交叉分析服務][3]

## <a name="monitoring-performance"></a><span data-ttu-id="aa94a-189">監視效能</span><span class="sxs-lookup"><span data-stu-id="aa94a-189">Monitoring performance</span></span>
<span data-ttu-id="aa94a-190">Azure Search 提供 hello 能力 tooanalyze 和監視器 hello 的效能，您的服務透過[搜尋流量分析 (STA)](search-traffic-analytics.md)。</span><span class="sxs-lookup"><span data-stu-id="aa94a-190">Azure Search offers hello ability tooanalyze and monitor hello performance of your service through [Search Traffic Analytics (STA)](search-traffic-analytics.md).</span></span> <span data-ttu-id="aa94a-191">STA，透過您選擇性地可以在 Power BI 中記錄 hello 個別的搜尋作業，以及彙總度量資訊，然後可以處理的分析或以視覺化方式檢視 tooan Azure 儲存體帳戶。</span><span class="sxs-lookup"><span data-stu-id="aa94a-191">Through STA, you can optionally log hello individual search operations as well as aggregated metrics tooan Azure Storage account that can then be processed for analysis or visualized in Power BI.</span></span>  <span data-ttu-id="aa94a-192">使用 STA 計量，您可以檢閱效能統計資料，例如查詢或查詢回應時間的平均數目。</span><span class="sxs-lookup"><span data-stu-id="aa94a-192">Using STA metrics, you can review performance statistics such as average number of queries or query response times.</span></span>  <span data-ttu-id="aa94a-193">此外，hello 作業記錄可讓您 toodrill 為特定的搜尋作業的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="aa94a-193">In addition, hello operation logging allows you toodrill into details of specific search operations.</span></span>

<span data-ttu-id="aa94a-194">STA 是從 Azure 搜尋檢視方塊的寶貴工具 toounderstand 延遲速率。</span><span class="sxs-lookup"><span data-stu-id="aa94a-194">STA is a valuable tool toounderstand latency rates from that Azure Search perspective.</span></span>  <span data-ttu-id="aa94a-195">因為記錄 hello 查詢效能度量依據 hello 時間查詢需要耗費 toobe 完全處理 Azure 搜尋中 （從是送出要求的 toowhen hello 時間），您就可以 toouse 此 toodetermine 如果延遲問題會從 hello Azure 搜尋服務側邊或外部的 hello 服務，例如從網路延遲。</span><span class="sxs-lookup"><span data-stu-id="aa94a-195">Since hello query performance metrics logged are based on hello time a query takes toobe fully processed in Azure Search (from hello time it is requested toowhen it is sent out), you are able toouse this toodetermine if latency issues are from hello Azure Search service side or outside of hello service, such as from network latency.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="aa94a-196">後續步驟</span><span class="sxs-lookup"><span data-stu-id="aa94a-196">Next steps</span></span>
<span data-ttu-id="aa94a-197">請參閱深入了解每個定價層和服務限制的 hello toolearn[服務在 Azure 搜尋中的限制](search-limits-quotas-capacity.md)。</span><span class="sxs-lookup"><span data-stu-id="aa94a-197">toolearn more about hello pricing tiers and services limits for each one, see [Service limits in Azure Search](search-limits-quotas-capacity.md).</span></span>

<span data-ttu-id="aa94a-198">請瀏覽[容量規劃](search-capacity-planning.md)toolearn 更多關於資料分割和複本組合。</span><span class="sxs-lookup"><span data-stu-id="aa94a-198">Visit [Capacity planning](search-capacity-planning.md) toolearn more about partition and replica combinations.</span></span>

<span data-ttu-id="aa94a-199">向下鑽研更多的效能與本文所討論的 tooimplement hello 最佳化的方式有些示範 toosee，監看下列影片 hello:</span><span class="sxs-lookup"><span data-stu-id="aa94a-199">For more drilldown on performance and toosee some demonstrations of how tooimplement hello optimizations discussed in this article, watch hello following video:</span></span>

> [!VIDEO https://channel9.msdn.com/Events/Microsoft-Azure/AzureCon-2015/ACON319/player]
> 
> 

<!--Image references-->
[1]: ./media/search-performance-optimization/geo-redundancy.png
[2]: ./media/search-performance-optimization/scale-indexers.png
[3]: ./media/search-performance-optimization/geo-search-traffic-mgr.png
