<span data-ttu-id="b6b88-101">如果您在 Azure 中的虛擬機器 (VM) 會發生開機或磁碟錯誤，您可能需要 tooperform 疑難排解 hello 虛擬硬碟上本身的步驟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-101">If your virtual machine (VM) in Azure encounters a boot or disk error, you may need tooperform troubleshooting steps on hello virtual hard disk itself.</span></span> <span data-ttu-id="b6b88-102">常見範例是防止 hello VM 成功開機失敗的應用程式更新。</span><span class="sxs-lookup"><span data-stu-id="b6b88-102">A common example would be a failed application update that prevents hello VM from booting successfully.</span></span> <span data-ttu-id="b6b88-103">本文說明如何 toouse Azure 入口網站 tooconnect 您的虛擬硬碟 tooanother VM toofix 任何錯誤，然後重新建立原始 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-103">This article describes how toouse Azure portal tooconnect your virtual hard disk tooanother VM toofix any errors and then re-create your original VM.</span></span>

## <a name="recovery-process-overview"></a><span data-ttu-id="b6b88-104">復原程序概觀</span><span class="sxs-lookup"><span data-stu-id="b6b88-104">Recovery process overview</span></span>
<span data-ttu-id="b6b88-105">hello 疑難排解程序如下所示：</span><span class="sxs-lookup"><span data-stu-id="b6b88-105">hello troubleshooting process is as follows:</span></span>

1. <span data-ttu-id="b6b88-106">刪除 hello 發生問題的 VM，但保留 hello 虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-106">Delete hello VM that's encountering issues, but retain hello virtual hard disks.</span></span>
2. <span data-ttu-id="b6b88-107">附加和掛接 hello 虛擬硬碟 tooanother VM 進行疑難排解。</span><span class="sxs-lookup"><span data-stu-id="b6b88-107">Attach and mount hello virtual hard disk tooanother VM for troubleshooting.</span></span>
3. <span data-ttu-id="b6b88-108">連接 toohello 疑難排解 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-108">Connect toohello troubleshooting VM.</span></span> <span data-ttu-id="b6b88-109">編輯檔案，或在 hello 原始虛擬硬碟上執行工具 toofix 錯誤。</span><span class="sxs-lookup"><span data-stu-id="b6b88-109">Edit files or run tools toofix errors on hello original virtual hard disk.</span></span>
4. <span data-ttu-id="b6b88-110">取消掛接並卸離 hello 虛擬硬碟從 hello 疑難排解 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-110">Unmount and detach hello virtual hard disk from hello troubleshooting VM.</span></span>
5. <span data-ttu-id="b6b88-111">使用 hello 原始虛擬硬碟建立 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-111">Create a VM by using hello original virtual hard disk.</span></span>

## <a name="delete-hello-original-vm"></a><span data-ttu-id="b6b88-112">刪除 hello 原始 VM</span><span class="sxs-lookup"><span data-stu-id="b6b88-112">Delete hello original VM</span></span>
<span data-ttu-id="b6b88-113">虛擬硬碟和 VM 在 Azure 中是兩個不同的資源。</span><span class="sxs-lookup"><span data-stu-id="b6b88-113">Virtual hard disks and VMs are two distinct resources in Azure.</span></span> <span data-ttu-id="b6b88-114">虛擬硬碟是存放 hello 作業系統、 應用程式和組態的位置。</span><span class="sxs-lookup"><span data-stu-id="b6b88-114">A virtual hard disk is where hello operating system, applications, and configurations are stored.</span></span> <span data-ttu-id="b6b88-115">hello VM 不只是中繼資料，來定義 hello 大小或位置，會參考資源，例如虛擬硬碟或虛擬網路介面卡 (NIC)。</span><span class="sxs-lookup"><span data-stu-id="b6b88-115">hello VM is just metadata that defines hello size or location and that references resources such as a virtual hard disk or virtual network interface card (NIC).</span></span> <span data-ttu-id="b6b88-116">每個虛擬硬碟取得該磁碟已附加的 tooa VM 時指定的租用。</span><span class="sxs-lookup"><span data-stu-id="b6b88-116">Each virtual hard disk gets a lease assigned when that disk is attached tooa VM.</span></span> <span data-ttu-id="b6b88-117">雖然可以附加和卸離 hello VM 正在執行時，即使資料磁碟，除非刪除 hello VM 資源無法中斷 hello 作業系統磁碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-117">Although data disks can be attached and detached even while hello VM is running, hello OS disk cannot be detached unless hello VM resource is deleted.</span></span> <span data-ttu-id="b6b88-118">hello 租用會繼續 tooassociate hello OS 磁碟 tooa VM，即使該 VM 是處於已停止和取消配置狀態。</span><span class="sxs-lookup"><span data-stu-id="b6b88-118">hello lease continues tooassociate hello OS disk tooa VM even when that VM is in a stopped and deallocated state.</span></span>

<span data-ttu-id="b6b88-119">hello 第一個步驟 toorecovering VM 是 toodelete hello VM 資源本身。</span><span class="sxs-lookup"><span data-stu-id="b6b88-119">hello first step toorecovering your VM is toodelete hello VM resource itself.</span></span> <span data-ttu-id="b6b88-120">刪除 hello VM 離開您的儲存體帳戶中的 hello 虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-120">Deleting hello VM leaves hello virtual hard disks in your storage account.</span></span> <span data-ttu-id="b6b88-121">刪除 VM hello 之後, 您可以附加 hello 虛擬硬碟 tooanother VM tootroubleshoot，並解決 hello 錯誤。</span><span class="sxs-lookup"><span data-stu-id="b6b88-121">After hello VM is deleted, you can attach hello virtual hard disk tooanother VM tootroubleshoot and resolve hello errors.</span></span> 

1. <span data-ttu-id="b6b88-122">登入 toohello [Azure 入口網站](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="b6b88-122">Sign in toohello [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="b6b88-123">在左邊為 hello hello 功能表上，按一下**虛擬機器 （傳統）**。</span><span class="sxs-lookup"><span data-stu-id="b6b88-123">On hello menu on hello left side, click **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="b6b88-124">VM 具有 hello 問題，請按一下 選取 hello**磁碟**，然後識別 hello hello 虛擬硬碟的名稱。</span><span class="sxs-lookup"><span data-stu-id="b6b88-124">Select hello VM that has hello problem, click **Disks**, and then identify hello name of hello virtual hard disk.</span></span> 
4. <span data-ttu-id="b6b88-125">選取 hello 作業系統虛擬硬碟，並檢查 hello**位置**tooidentify hello 儲存體帳戶，其中包含虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-125">Select hello OS virtual hard disk and check hello **Location** tooidentify hello storage account that contains that virtual hard disk.</span></span> <span data-ttu-id="b6b88-126">在下列範例的 hello，hello 字串前面 「。 account>.blob.core.windows.net 」 是 hello 儲存體帳戶名稱。</span><span class="sxs-lookup"><span data-stu-id="b6b88-126">In hello following example, hello string immediately before ".blob.core.windows.net" is hello storage account name.</span></span>

    ```
    https://portalvhds73fmhrw5xkp43.blob.core.windows.net/vhds/SCCM2012-2015-08-28.vhd
    ```

    ![VM 的位置相關的 hello 映像](./media/virtual-machines-classic-recovery-disks-portal/vm-location.png)

5. <span data-ttu-id="b6b88-128">Hello VM 上按一下滑鼠右鍵，然後選取**刪除**。</span><span class="sxs-lookup"><span data-stu-id="b6b88-128">Right-click hello VM and then select **Delete**.</span></span> <span data-ttu-id="b6b88-129">請確定當您刪除 hello VM 時未選取 hello 磁碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-129">Make sure that hello disks are not selected when you delete hello VM.</span></span>
6. <span data-ttu-id="b6b88-130">建立新的復原 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-130">Create a new recovery VM.</span></span> <span data-ttu-id="b6b88-131">此 VM 必須在 hello 相同區域或資源群組 （雲端服務） 稱為 hello 問題 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-131">This VM must be in hello same region and resource group (Cloud Service) as hello problem VM.</span></span>
7. <span data-ttu-id="b6b88-132">選取 hello 修復 VM，然後選取**磁碟** > **附加現有**。</span><span class="sxs-lookup"><span data-stu-id="b6b88-132">Select hello recovery VM, and then select **Disks** > **Attach Existing**.</span></span>
8. <span data-ttu-id="b6b88-133">tooselect 現有虛擬硬碟，按一下  **VHD 檔案**:</span><span class="sxs-lookup"><span data-stu-id="b6b88-133">tooselect your existing virtual hard disk, click **VHD File**:</span></span>

    ![瀏覽現有 VHD](./media/virtual-machines-classic-recovery-disks-portal/select-vhd-location.png)

9. <span data-ttu-id="b6b88-135">選取 hello 儲存體帳戶 > VHD 容器 > hello 虛擬硬碟，請按一下 hello**選取**按鈕 tooconfirm 您的選擇。</span><span class="sxs-lookup"><span data-stu-id="b6b88-135">Select hello storage account > VHD container > hello virtual hard disk, click hello **Select** button tooconfirm your choice.</span></span>

    ![選取現有 VHD](./media/virtual-machines-classic-recovery-disks-portal/select-vhd.png)

10. <span data-ttu-id="b6b88-137">您現在已選取的 VHD，然後選取 **確定**tooattach hello 現有虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-137">With your VHD now selected, select **OK** tooattach hello existing virtual hard disk.</span></span>
11. <span data-ttu-id="b6b88-138">幾秒之後，hello**磁碟**vm 的窗格會顯示您現有虛擬硬碟連接當做資料磁碟：</span><span class="sxs-lookup"><span data-stu-id="b6b88-138">After a few seconds, hello **Disks** pane for your VM will display your existing virtual hard disk connected as a data disk:</span></span>

    ![現有虛擬硬碟已連結為資料磁碟](./media/virtual-machines-classic-recovery-disks-portal/attached-disk.png)

## <a name="fix-issues-on-hello-original-virtual-hard-disk"></a><span data-ttu-id="b6b88-140">Hello 原始虛擬硬碟上修正問題</span><span class="sxs-lookup"><span data-stu-id="b6b88-140">Fix issues on hello original virtual hard disk</span></span>
<span data-ttu-id="b6b88-141">當已裝載 hello 現有虛擬硬碟時，您現在可以執行任何維護和疑難排解步驟，視需要。</span><span class="sxs-lookup"><span data-stu-id="b6b88-141">When hello existing virtual hard disk is mounted, you can now perform any maintenance and troubleshooting steps as needed.</span></span> <span data-ttu-id="b6b88-142">一旦解決 hello 問題之後，繼續進行步驟 hello。</span><span class="sxs-lookup"><span data-stu-id="b6b88-142">Once you have addressed hello issues, continue with hello following steps.</span></span>

## <a name="unmount-and-detach-hello-original-virtual-hard-disk"></a><span data-ttu-id="b6b88-143">取消掛接並卸離 hello 原始虛擬硬碟</span><span class="sxs-lookup"><span data-stu-id="b6b88-143">Unmount and detach hello original virtual hard disk</span></span>
<span data-ttu-id="b6b88-144">一旦解決的任何錯誤，取消掛接並卸離 hello 現有虛擬硬碟從您疑難排解的 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-144">Once any errors are resolved, unmount and detach hello existing virtual hard disk from your troubleshooting VM.</span></span> <span data-ttu-id="b6b88-145">釋放連接 hello 疑難排解 VM 的虛擬硬碟 toohello hello 租用之前，您無法使用您連同任何其他 VM 的虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-145">You cannot use your virtual hard disk together with any other VM until hello lease that attaches hello virtual hard disk toohello troubleshooting VM is released.</span></span>  

1. <span data-ttu-id="b6b88-146">登入 toohello [Azure 入口網站](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="b6b88-146">Sign in toohello [Azure portal](https://portal.azure.com).</span></span> 
2. <span data-ttu-id="b6b88-147">在左邊為 hello hello 功能表上，選取**虛擬機器 （傳統）**。</span><span class="sxs-lookup"><span data-stu-id="b6b88-147">On hello menu on hello left side, select **Virtual Machines (classic)**.</span></span>
3. <span data-ttu-id="b6b88-148">找出 hello 修復 VM。</span><span class="sxs-lookup"><span data-stu-id="b6b88-148">Locate hello recovery VM.</span></span> <span data-ttu-id="b6b88-149">選取磁碟，以滑鼠右鍵按一下 hello 磁碟，然後再選取**卸離**。</span><span class="sxs-lookup"><span data-stu-id="b6b88-149">Select Disks, right-click hello disk, and then select **Detach**.</span></span>

## <a name="create-a-vm-from-hello-original-hard-disk"></a><span data-ttu-id="b6b88-150">從原始硬碟 hello 建立 VM</span><span class="sxs-lookup"><span data-stu-id="b6b88-150">Create a VM from hello original hard disk</span></span>

<span data-ttu-id="b6b88-151">toocreate 原始虛擬硬碟，從 VM 使用[Azure 傳統入口網站](https://manage.windowsazure.com)。</span><span class="sxs-lookup"><span data-stu-id="b6b88-151">toocreate a VM from your original virtual hard disk, use [Azure classic portal](https://manage.windowsazure.com).</span></span>

1. <span data-ttu-id="b6b88-152">登入 [Azure 傳統入口網站](https://manage.windowsazure.com)。</span><span class="sxs-lookup"><span data-stu-id="b6b88-152">Sign into [Azure classic portal](https://manage.windowsazure.com).</span></span>
2. <span data-ttu-id="b6b88-153">在 hello hello 入口網站底部，選取**新增** > **計算** > **虛擬機器** > **從組件庫**.</span><span class="sxs-lookup"><span data-stu-id="b6b88-153">At hello bottom of hello portal, select **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span>
3. <span data-ttu-id="b6b88-154">在 hello**選擇映像**區段中，選取**我的磁碟**，，然後選取 hello 原始虛擬硬碟。</span><span class="sxs-lookup"><span data-stu-id="b6b88-154">In hello **Choose an Image** section, select **My disks**, and then select hello original virtual hard disk.</span></span> <span data-ttu-id="b6b88-155">請檢查 hello 位置資訊。</span><span class="sxs-lookup"><span data-stu-id="b6b88-155">Check hello location information.</span></span> <span data-ttu-id="b6b88-156">這是 hello hello VM 必須部署所在的區域。</span><span class="sxs-lookup"><span data-stu-id="b6b88-156">This is hello region where hello VM must be deployed.</span></span> <span data-ttu-id="b6b88-157">選取 hello 下一步 按鈕。</span><span class="sxs-lookup"><span data-stu-id="b6b88-157">Select hello next button.</span></span>
4. <span data-ttu-id="b6b88-158">在 hello**虛擬機器組態**區段中，輸入 hello VM 名稱，然後選取 hello VM 的大小。</span><span class="sxs-lookup"><span data-stu-id="b6b88-158">In hello **Virtual machine configuration** section, type hello VM name and select a size for hello VM.</span></span>
