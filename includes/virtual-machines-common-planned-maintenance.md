<span data-ttu-id="99957-101">Azure 會定期執行更新 tooimprove hello 可靠性、 效能及 hello 主機基礎結構安全性的虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="99957-101">Azure periodically performs updates tooimprove hello reliability, performance, and security of hello host infrastructure for virtual machines.</span></span> <span data-ttu-id="99957-102">這些更新的範圍從修補程式的軟體元件 hello 裝載環境 （如作業系統、 hypervisor 和各種 hello 主機上部署的代理程式），在升級網路元件，toohardware 解除委任。</span><span class="sxs-lookup"><span data-stu-id="99957-102">These updates range from patching software components in hello hosting environment (like operating system, hypervisor, and various agents deployed on hello host), upgrading networking components, toohardware decommissioning.</span></span> <span data-ttu-id="99957-103">hello 的大部分這些更新會執行沒有任何影響 toohello 裝載虛擬機器。</span><span class="sxs-lookup"><span data-stu-id="99957-103">hello majority of these updates are performed without any impact toohello hosted virtual machines.</span></span> <span data-ttu-id="99957-104">不過，更新在某些情況下確實會造成影響：</span><span class="sxs-lookup"><span data-stu-id="99957-104">However, there are cases where updates do have an impact:</span></span>

- <span data-ttu-id="99957-105">如果 hello 維護不需要重新開機，Azure 會在更新 hello 主機時使用就地移轉 toopause hello VM。</span><span class="sxs-lookup"><span data-stu-id="99957-105">If hello maintenance does not require a reboot, Azure uses in-place migration toopause hello VM while hello host is updated.</span></span>

- <span data-ttu-id="99957-106">維護需要重新開機，如果您已規劃 hello 維護時出現的通知。</span><span class="sxs-lookup"><span data-stu-id="99957-106">If maintenance requires a reboot, you get a notice of when hello maintenance is planned.</span></span> <span data-ttu-id="99957-107">在這些情況下，您也將提供的時間窗口開始 hello 維護您自己，適用於您一次。</span><span class="sxs-lookup"><span data-stu-id="99957-107">In these cases, you'll also be given a time window where you can start hello maintenance yourself, at a time that works for you.</span></span>

<span data-ttu-id="99957-108">本頁面說明 Microsoft Azure 如何執行這兩種類型的維護。</span><span class="sxs-lookup"><span data-stu-id="99957-108">This page describes how Microsoft Azure performs both types of maintenance.</span></span> <span data-ttu-id="99957-109">未計劃的事件 （中斷） 的詳細資訊，請參閱管理 hello 可用性的虛擬機器，適用於 [Windows] (.../ articles/virtual-machines/windows/manage-availability.md) 或[Linux](../articles/virtual-machines/linux/manage-availability.md)。</span><span class="sxs-lookup"><span data-stu-id="99957-109">For more information about unplanned events (outages), see Manage hello availability of virtual machines for [Windows] (../articles/virtual-machines/windows/manage-availability.md) or [Linux](../articles/virtual-machines/linux/manage-availability.md).</span></span>

<span data-ttu-id="99957-110">虛擬機器中執行的應用程式可以使用的未來更新的蒐集資訊 hello Azure 中繼資料服務進行[Windows](../articles/virtual-machines/windows/instance-metadata-service.md)或 [Linux] (.../ articles/virtual-machines/linux/instance-metadata-service.md)。</span><span class="sxs-lookup"><span data-stu-id="99957-110">Applications running in a virtual machine can gather information about upcoming updates by using hello Azure Metadata Service for [Windows](../articles/virtual-machines/windows/instance-metadata-service.md) or [Linux] (../articles/virtual-machines/linux/instance-metadata-service.md).</span></span>

## <a name="in-place-vm-migration"></a><span data-ttu-id="99957-111">就地 VM 移轉</span><span class="sxs-lookup"><span data-stu-id="99957-111">In-place VM migration</span></span>

<span data-ttu-id="99957-112">當更新不需要完整重新開機時，則會使用就地即時移轉。</span><span class="sxs-lookup"><span data-stu-id="99957-112">When updates don't require a full reboot, an in-place live migration is used.</span></span> <span data-ttu-id="99957-113">Hello 更新期間 hello 虛擬機器已經暫停大約 30 秒，而裝載環境的 hello 適用於 hello 必要更新和修補程式保留在 RAM 而 hello 記憶體。</span><span class="sxs-lookup"><span data-stu-id="99957-113">During hello update hello virtual machine is paused for about 30 seconds, preserving hello memory in RAM, while hello hosting environment applies hello necessary updates and patches.</span></span> <span data-ttu-id="99957-114">hello 虛擬機器再繼續執行，而且 hello 時鐘 hello 虛擬機器的自動同步處理。</span><span class="sxs-lookup"><span data-stu-id="99957-114">hello virtual machine is then resumed and hello clock of hello virtual machine is automatically synchronized.</span></span>

<span data-ttu-id="99957-115">對於可用性設定組中的 VM，更新網域會一次更新一個。</span><span class="sxs-lookup"><span data-stu-id="99957-115">For VMs in availability sets, update domains are updated one at a time.</span></span> <span data-ttu-id="99957-116">暫停、 更新，然後繼續進行之前計劃性的維護移 toohello 上一個更新網域 (UD) 中的所有 Vm UD 下一步。</span><span class="sxs-lookup"><span data-stu-id="99957-116">All VMs in one update domain (UD) are paused, updated and then resumed before planned maintenance moves on toohello next UD.</span></span>

<span data-ttu-id="99957-117">這些類型的更新會對某些應用程式造成影響。</span><span class="sxs-lookup"><span data-stu-id="99957-117">Some applications may be impacted by these types of updates.</span></span> <span data-ttu-id="99957-118">執行處理，例如媒體串流處理或轉碼或高輸送量網路案例中，即時事件的應用程式可能不是設計的 tootolerate 暫停 30 秒。</span><span class="sxs-lookup"><span data-stu-id="99957-118">Applications that perform real-time event processing, like media streaming or transcoding, or high throughput networking scenarios, may not be designed tootolerate a 30 second pause.</span></span> <!-- sooooo, what should they do? --> 


## <a name="maintenance-requiring-a-reboot"></a><span data-ttu-id="99957-119">維護需要重新開機</span><span class="sxs-lookup"><span data-stu-id="99957-119">Maintenance requiring a reboot</span></span>

<span data-ttu-id="99957-120">當 Vm 需要 toobe 計劃性維護重新開機時，就會事先通知。</span><span class="sxs-lookup"><span data-stu-id="99957-120">When VMs need toobe rebooted for planned maintenance, you are notified in advance.</span></span> <span data-ttu-id="99957-121">規劃的維護有兩個階段： hello 自助服務 視窗和排程的維護期間。</span><span class="sxs-lookup"><span data-stu-id="99957-121">Planned maintenance has two phases: hello self-service window and a scheduled maintenance window.</span></span>

<span data-ttu-id="99957-122">hello**自助視窗**可讓您起始 hello 維護您的 Vm 上。</span><span class="sxs-lookup"><span data-stu-id="99957-122">hello **self-service window** lets you initiate hello maintenance on your VMs.</span></span> <span data-ttu-id="99957-123">在此期間，您可以查詢每個 VM toosee 其狀態，並檢查您的最後一個維護要求 hello 結果。</span><span class="sxs-lookup"><span data-stu-id="99957-123">During this time, you can query each VM toosee their status and check hello result of your last maintenance request.</span></span>

<span data-ttu-id="99957-124">當您啟動自助服務維護時，您的 VM 是移動的 tooa 節點已經更新，然後開啟電源時它傳回。</span><span class="sxs-lookup"><span data-stu-id="99957-124">When you start self-service maintenance, your VM is moved tooa node that has already been updated and then powers it back on.</span></span> <span data-ttu-id="99957-125">Hello VM 重新開機，因為 hello 暫存磁碟遺失，且會更新虛擬網路介面相關聯的動態 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="99957-125">Because hello VM reboots, hello temporary disk is lost and dynamic IP addresses associated with virtual network interface are updated.</span></span>

<span data-ttu-id="99957-126">如果您啟動自助服務維護，而且 hello 程序期間沒有錯誤，hello 作業已停止，hello VM 不會更新，它也會移除從 hello 計劃的維護反覆項目。</span><span class="sxs-lookup"><span data-stu-id="99957-126">If you start self-service maintenance and there is an error during hello process, hello operation is stopped, hello VM is not updated and it is also removed from hello planned maintenance iteration.</span></span> <span data-ttu-id="99957-127">您會在與新的排程更新的時間內連絡並提供新商機 toodo 自助服務維護。</span><span class="sxs-lookup"><span data-stu-id="99957-127">You will be contacted in a later time with a new schedule and offered a new opportunity toodo self-service maintenance.</span></span> 

<span data-ttu-id="99957-128">經過 hello 自助服務視窗之後，hello**排程的維護期間**開始。</span><span class="sxs-lookup"><span data-stu-id="99957-128">When hello self-service window has passed, hello **scheduled maintenance window** begins.</span></span> <span data-ttu-id="99957-129">這段期間，您可以仍然 hello 維護視窗，請查詢，但不再能 toostart hello 維護自己。</span><span class="sxs-lookup"><span data-stu-id="99957-129">During this time window, you can still query for hello maintenance window, but no longer be able toostart hello maintenance yourself.</span></span>

## <a name="availability-considerations-during-planned-maintenance"></a><span data-ttu-id="99957-130">規劃維護期間的可用性考量</span><span class="sxs-lookup"><span data-stu-id="99957-130">Availability Considerations during Planned Maintenance</span></span> 

<span data-ttu-id="99957-131">如果您決定 toowait，直到 hello 計劃的維護期間，有幾件事 tooconsider 維護 hello 最高可用性 Vm。</span><span class="sxs-lookup"><span data-stu-id="99957-131">If you decide toowait until hello planned maintenance window, there are a few things tooconsider for maintaining hello highest availabilty of your VMs.</span></span> 

### <a name="paired-regions"></a><span data-ttu-id="99957-132">配對的區域</span><span class="sxs-lookup"><span data-stu-id="99957-132">Paired Regions</span></span>

<span data-ttu-id="99957-133">每個 Azure 區域搭配另一個地區內 hello 相同的地理位置，同時讓地區組。</span><span class="sxs-lookup"><span data-stu-id="99957-133">Each Azure region is paired with another region within hello same geography, together they make a regional pair.</span></span> <span data-ttu-id="99957-134">計劃在維護期間，Azure 只會更新 hello 單一區域的區域配對中的 Vm。</span><span class="sxs-lookup"><span data-stu-id="99957-134">During planned maintenance, Azure will only update hello VMs in a single region of a region pair.</span></span> <span data-ttu-id="99957-135">例如，在更新 hello 美國中北部的虛擬機器時，Azure 不會更新在美國中南部任何虛擬機器在 hello 相同的時間。</span><span class="sxs-lookup"><span data-stu-id="99957-135">For example, when updating hello Virtual Machines in North Central US, Azure will not update any Virtual Machines in South Central US at hello same time.</span></span> <span data-ttu-id="99957-136">不過，其他地區為北歐可以進行維護在 hello 相同時間為美國東部。</span><span class="sxs-lookup"><span data-stu-id="99957-136">However, other regions such as North Europe can be under maintenance at hello same time as East US.</span></span> <span data-ttu-id="99957-137">了解區域配對的運作方式可協助您將 VM 更妥善地分散於各區域。</span><span class="sxs-lookup"><span data-stu-id="99957-137">Understanding how region pairs work can help you better distribute your VMs across regions.</span></span> <span data-ttu-id="99957-138">如需詳細資訊，請參閱 [Azure 區域配對](https://docs.microsoft.com/azure/best-practices-availability-paired-regions)。</span><span class="sxs-lookup"><span data-stu-id="99957-138">For more information, see [Azure region pairs](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span></span>

### <a name="availability-sets-and-scale-sets"></a><span data-ttu-id="99957-139">可用性設定組和擴展集</span><span class="sxs-lookup"><span data-stu-id="99957-139">Availability sets and scale sets</span></span>

<span data-ttu-id="99957-140">在部署 Azure Vm 上的工作負載時，您可以建立可用性集 tooprovide 高可用性 tooyour 應用程式中的 hello Vm。</span><span class="sxs-lookup"><span data-stu-id="99957-140">When deploying a workload on Azure VMs, you can create hello VMs within an availability set tooprovide high availability tooyour application.</span></span> <span data-ttu-id="99957-141">這可確保在中斷或維護事件期間，至少有一部虛擬機器可供使用。</span><span class="sxs-lookup"><span data-stu-id="99957-141">This ensures that during either an outage or maintenance events, at least one virtual machine is available.</span></span>

<span data-ttu-id="99957-142">在可用性設定組，個別的 Vm 會散佈 too20 升級網域 (Ud) 組成。</span><span class="sxs-lookup"><span data-stu-id="99957-142">Within an availability set, individual VMs are spread across up too20 update domains (UDs).</span></span> <span data-ttu-id="99957-143">在規劃維護期間，在任何指定時間只有單一更新網域受影響。</span><span class="sxs-lookup"><span data-stu-id="99957-143">During planned maintenance, only a single update domain is impacted at any given time.</span></span> <span data-ttu-id="99957-144">請注意，受到影響的更新網域的 hello 順序不一定會以循序方式。</span><span class="sxs-lookup"><span data-stu-id="99957-144">Be aware that hello order of update domains being impacted does not necessarily happen sequentially.</span></span> 

<span data-ttu-id="99957-145">虛擬機器擴展集都可讓您的 Azure 計算資源 toodeploy 和管理一組相同的 Vm 為單一資源。</span><span class="sxs-lookup"><span data-stu-id="99957-145">Virtual machine scale sets are an Azure compute resource that enables you toodeploy and manage a set of identical VMs as a single resource.</span></span> <span data-ttu-id="99957-146">更新網域，例如可用性設定組中的 Vm 之間，會自動部署 hello 規模集。</span><span class="sxs-lookup"><span data-stu-id="99957-146">hello scale set is automatically deployed across update domains, like VMs in an availability set.</span></span> <span data-ttu-id="99957-147">就如同可用性設定組，使用擴展集，在任何指定時間只有單一更新網域受影響。</span><span class="sxs-lookup"><span data-stu-id="99957-147">Just like with availability sets, with scale sets only a single update domain is impacted at any given time.</span></span>

<span data-ttu-id="99957-148">如需設定您的虛擬機器的高可用性的詳細資訊，請參閱 < 管理 hello 可用性的虛擬機器適用於 Windows (../ articles/virtual-machines/windows/manage-availability.md) 或[Linux](../articles/virtual-machines/linux/manage-availability.md)。</span><span class="sxs-lookup"><span data-stu-id="99957-148">For more information about configuring your virtual machines for high availability, see Manage hello availability of your virtual machines for Windows (../articles/virtual-machines/windows/manage-availability.md) or [Linux](../articles/virtual-machines/linux/manage-availability.md).</span></span>
