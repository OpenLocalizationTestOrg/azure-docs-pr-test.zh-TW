

<span data-ttu-id="f75e6-101">Azure 基礎結構服務提供兩種負載平衡層級︰</span><span class="sxs-lookup"><span data-stu-id="f75e6-101">There are two levels of load balancing available for Azure infrastructure services:</span></span>

* <span data-ttu-id="f75e6-102">**DNS 層級**： 負載平衡流量 toodifferent 雲端服務位於不同的資料中心、 toodifferent Azure 網站位於不同的資料中心或 tooexternal 端點。</span><span class="sxs-lookup"><span data-stu-id="f75e6-102">**DNS Level**:  Load balancing for traffic toodifferent cloud services located in different data centers, toodifferent Azure websites located in different data centers, or tooexternal endpoints.</span></span> <span data-ttu-id="f75e6-103">這是使用 Azure Traffic Manager 和 hello 循環配置資源負載平衡方法。</span><span class="sxs-lookup"><span data-stu-id="f75e6-103">This is done with Azure Traffic Manager and hello Round Robin load balancing method.</span></span>
* <span data-ttu-id="f75e6-104">**網路層級**： 負載平衡的連入網際網路流量 toodifferent 虛擬機器的雲端服務或雲端服務或虛擬網路中的虛擬機器之間流量的負載平衡。</span><span class="sxs-lookup"><span data-stu-id="f75e6-104">**Network Level**:  Load balancing of incoming Internet traffic toodifferent virtual machines of a cloud service, or load balancing of traffic between virtual machines in a cloud service or virtual network.</span></span> <span data-ttu-id="f75e6-105">這是與 hello Azure 負載平衡器。</span><span class="sxs-lookup"><span data-stu-id="f75e6-105">This is done with hello Azure load balancer.</span></span>

## <a name="traffic-manager-load-balancing-for-cloud-services-and-websites"></a><span data-ttu-id="f75e6-106">雲端服務及網站的流量管理員負載平衡</span><span class="sxs-lookup"><span data-stu-id="f75e6-106">Traffic Manager load balancing for cloud services and websites</span></span>
<span data-ttu-id="f75e6-107">Traffic Manager 可讓您的使用者流量 tooendpoints 可以包括雲端服務、 網站、 外部網站，以及其他流量管理員設定檔的 toocontrol hello 發佈。</span><span class="sxs-lookup"><span data-stu-id="f75e6-107">Traffic Manager allows you toocontrol hello distribution of user traffic tooendpoints, which can include cloud services, websites, external sites, and other Traffic Manager profiles.</span></span> <span data-ttu-id="f75e6-108">流量管理員會藉由套用智慧型原則引擎 tooDomain 名稱系統 (DNS) 查詢的 hello 的網際網路資源的網域名稱。</span><span class="sxs-lookup"><span data-stu-id="f75e6-108">Traffic Manager works by applying an intelligent policy engine tooDomain Name System (DNS) queries for hello domain names of your Internet resources.</span></span> <span data-ttu-id="f75e6-109">您的雲端服務或網站可以在不同的資料中心 hello 世界各地執行。</span><span class="sxs-lookup"><span data-stu-id="f75e6-109">Your cloud services or websites can be running in different datacenters across hello world.</span></span>

<span data-ttu-id="f75e6-110">您必須使用 REST 或 Windows PowerShell tooconfigure 外部端點或 Traffic Manager 設定檔作為端點。</span><span class="sxs-lookup"><span data-stu-id="f75e6-110">You must use either REST or Windows PowerShell tooconfigure external endpoints or Traffic Manager profiles as endpoints.</span></span>

<span data-ttu-id="f75e6-111">Traffic Manager 會使用三種負載平衡方法 toodistribute 流量：</span><span class="sxs-lookup"><span data-stu-id="f75e6-111">Traffic Manager uses three load-balancing methods toodistribute traffic:</span></span>

* <span data-ttu-id="f75e6-112">**容錯移轉**： 使用這個方法，當您想 toouse 主要端點來處理所有流量，但提供備份以防主要 hello 變得無法使用。</span><span class="sxs-lookup"><span data-stu-id="f75e6-112">**Failover**:  Use this method when you want toouse a primary endpoint for all traffic, but provide backups in case hello primary becomes unavailable.</span></span>
* <span data-ttu-id="f75e6-113">**效能**： 當您在不同的地理位置擁有端點，而且您想要求依據 hello 最低延遲的用戶端 toouse hello 「 最靠近 」 端點時使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="f75e6-113">**Performance**:  Use this method when you have endpoints in different geographic locations and you want requesting clients toouse hello "closest" endpoint in terms of hello lowest latency.</span></span>
* <span data-ttu-id="f75e6-114">**循環配置資源：**使用這個方法，當您想 toodistribute 負載透過一組雲端服務的 hello 相同資料中心或跨越雲端服務或不同資料中心內的網站。</span><span class="sxs-lookup"><span data-stu-id="f75e6-114">**Round Robin:**  Use this method when you want toodistribute load across a set of cloud services in hello same datacenter or across cloud services or websites in different datacenters.</span></span>

<span data-ttu-id="f75e6-115">如需詳細資訊，請參閱[關於流量管理員負載平衡方法](../articles/traffic-manager/traffic-manager-routing-methods.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-115">For more information, see [About Traffic Manager Load Balancing Methods](../articles/traffic-manager/traffic-manager-routing-methods.md).</span></span>

<span data-ttu-id="f75e6-116">hello 下列圖表顯示 hello 的不同雲端服務之間的流量分散至循環配置資源負載平衡方法範例。</span><span class="sxs-lookup"><span data-stu-id="f75e6-116">hello following diagram shows an example of hello Round Robin load balancing method for distributing traffic between different cloud services.</span></span>

![負載平衡](./media/virtual-machines-common-load-balance/TMSummary.png)

<span data-ttu-id="f75e6-118">hello 基本程序是 hello 下列：</span><span class="sxs-lookup"><span data-stu-id="f75e6-118">hello basic process is hello following:</span></span>

1. <span data-ttu-id="f75e6-119">網際網路用戶端會查詢網域名稱對應 tooa web 服務。</span><span class="sxs-lookup"><span data-stu-id="f75e6-119">An Internet client queries a domain name corresponding tooa web service.</span></span>
2. <span data-ttu-id="f75e6-120">DNS 會轉送 hello 名稱查詢要求 tooTraffic 管理員。</span><span class="sxs-lookup"><span data-stu-id="f75e6-120">DNS forwards hello name query request tooTraffic Manager.</span></span>
3. <span data-ttu-id="f75e6-121">Traffic Manager 在 hello 循環配置資源的清單中選擇 hello 下一個雲端服務，並傳送回 hello DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="f75e6-121">Traffic Manager chooses hello next cloud service in hello Round Robin list and sends back hello DNS name.</span></span> <span data-ttu-id="f75e6-122">hello 網際網路用戶端的 DNS 伺服器解析 hello 名稱 tooan IP 位址，並將它傳送 toohello 網際網路用戶端。</span><span class="sxs-lookup"><span data-stu-id="f75e6-122">hello Internet client's DNS server resolves hello name tooan IP address and sends it toohello Internet client.</span></span>
4. <span data-ttu-id="f75e6-123">hello 網際網路用戶端與 hello 選擇由 Traffic Manager 的雲端服務連線。</span><span class="sxs-lookup"><span data-stu-id="f75e6-123">hello Internet client connects with hello cloud service chosen by Traffic Manager.</span></span>

<span data-ttu-id="f75e6-124">如需詳細資訊，請參閱 [Traffic Manager](../articles/traffic-manager/traffic-manager-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-124">For more information, see [Traffic Manager](../articles/traffic-manager/traffic-manager-overview.md).</span></span>

## <a name="azure-load-balancing-for-virtual-machines"></a><span data-ttu-id="f75e6-125">虛擬機器的 Azure 負載平衡</span><span class="sxs-lookup"><span data-stu-id="f75e6-125">Azure load balancing for virtual machines</span></span>
<span data-ttu-id="f75e6-126">中的虛擬機器 hello 相同雲端服務或虛擬網路可以彼此直接使用其私人 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f75e6-126">Virtual machines in hello same cloud service or virtual network can communicate with each other directly using their private IP addresses.</span></span> <span data-ttu-id="f75e6-127">電腦及服務外 hello 雲端服務或虛擬網路只能與虛擬機器中的雲端服務或虛擬網路設定的端點通訊。</span><span class="sxs-lookup"><span data-stu-id="f75e6-127">Computers and services outside hello cloud service or virtual network can only communicate with virtual machines in a cloud service or virtual network with a configured endpoint.</span></span> <span data-ttu-id="f75e6-128">端點是對應的公用 IP 位址和連接埠 toothat 私人 IP 位址和連接埠的虛擬機器或 Azure 雲端服務內的 web 角色。</span><span class="sxs-lookup"><span data-stu-id="f75e6-128">An endpoint is a mapping of a public IP address and port toothat private IP address and port of a virtual machine or web role within an Azure cloud service.</span></span>

<span data-ttu-id="f75e6-129">隨機 hello Azure 負載平衡器會將特定類型的連入流量分散到多個虛擬機器或服務設定，稱為 負載平衡的集合中。</span><span class="sxs-lookup"><span data-stu-id="f75e6-129">hello Azure Load Balancer randomly distributes a specific type of incoming traffic across multiple virtual machines or services in a configuration known as a load-balanced set.</span></span> <span data-ttu-id="f75e6-130">例如，您可以 hello 負載分散 web 要求流量的多個 web 伺服器或 web 角色。</span><span class="sxs-lookup"><span data-stu-id="f75e6-130">For example, you can spread hello load of web request traffic across multiple web servers or web roles.</span></span>

<span data-ttu-id="f75e6-131">hello 下列圖表顯示 hello 公用和私人 TCP 連接埠 80 的三部虛擬機器之間共用的標準 （未加密） 的 web 流量的負載平衡端點。</span><span class="sxs-lookup"><span data-stu-id="f75e6-131">hello following diagram shows a load-balanced endpoint for standard (unencrypted) web traffic that is shared among three virtual machines for hello public and private TCP port of 80.</span></span> <span data-ttu-id="f75e6-132">這三部虛擬機器均位在負載平衡集合中。</span><span class="sxs-lookup"><span data-stu-id="f75e6-132">These three virtual machines are in a load-balanced set.</span></span>

![負載平衡](./media/virtual-machines-common-load-balance/LoadBalancing.png)

<span data-ttu-id="f75e6-134">如需詳細資訊，請參閱 [Azure 負載平衡器](../articles/load-balancer/load-balancer-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-134">For more information, see [Azure Load Balancer](../articles/load-balancer/load-balancer-overview.md).</span></span> <span data-ttu-id="f75e6-135">Hello 步驟 toocreate 一組負載平衡，請參閱[設定一組負載平衡](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-135">For hello steps toocreate a load-balanced set, see [Configure a load-balanced set](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md).</span></span>

<span data-ttu-id="f75e6-136">Azure 也可在雲端服務或虛擬網路中進行負載平衡。</span><span class="sxs-lookup"><span data-stu-id="f75e6-136">Azure can also load balance within a cloud service or virtual network.</span></span> <span data-ttu-id="f75e6-137">這稱為內部負載平衡，並可用於下列方式 hello:</span><span class="sxs-lookup"><span data-stu-id="f75e6-137">This is known as internal load balancing and can be used in hello following ways:</span></span>

* <span data-ttu-id="f75e6-138">在多層式應用程式 （例如，web 和資料庫層） 之間的不同層級中的伺服器之間的 tooload 達成平衡。</span><span class="sxs-lookup"><span data-stu-id="f75e6-138">tooload balance between servers in different tiers of a multi-tier application (for example, between web and database tiers).</span></span>
* <span data-ttu-id="f75e6-139">tooload 平衡的特定業務 (LOB) 應用程式裝載於 Azure，而不需要額外的負載平衡器硬體或軟體。</span><span class="sxs-lookup"><span data-stu-id="f75e6-139">tooload balance line-of-business (LOB) applications hosted in Azure without requiring additional load balancer hardware or software.</span></span>
* <span data-ttu-id="f75e6-140">tooinclude 內部 hello 的一組電腦的流量進行負載平衡的伺服器。</span><span class="sxs-lookup"><span data-stu-id="f75e6-140">tooinclude on-premises servers in hello set of computers whose traffic is load balanced.</span></span>

<span data-ttu-id="f75e6-141">類似 tooAzure 負載平衡，內部負載平衡是透過實現藉由設定內部負載平衡集。</span><span class="sxs-lookup"><span data-stu-id="f75e6-141">Similar tooAzure load balancing, internal load balancing is facilitated by configuring an internal load-balanced set.</span></span>

<span data-ttu-id="f75e6-142">hello 下列圖表顯示三個虛擬機器之間共用的跨單位虛擬網路中的企業營運 (LOB) 應用程式的內部負載平衡端點的範例。</span><span class="sxs-lookup"><span data-stu-id="f75e6-142">hello following diagram shows an example of an internal load-balanced endpoint for a line of business (LOB) application that is shared among three virtual machines in a cross-premises virtual network.</span></span>

![負載平衡](./media/virtual-machines-common-load-balance/LOBServers.png)

## <a name="load-balancer-considerations"></a><span data-ttu-id="f75e6-144">負載平衡器考量</span><span class="sxs-lookup"><span data-stu-id="f75e6-144">Load balancer considerations</span></span>
<span data-ttu-id="f75e6-145">預設會設定負載平衡器 tootimeout 閒置工作階段在 4 分鐘。</span><span class="sxs-lookup"><span data-stu-id="f75e6-145">A load balancer is configured by default tootimeout an idle session in 4 minutes.</span></span> <span data-ttu-id="f75e6-146">如果您的應用程式負載平衡器後方離開連接閒置超過 4 分鐘，而且沒有保持運作的組態，hello 連線皆會予以捨棄。</span><span class="sxs-lookup"><span data-stu-id="f75e6-146">If your application behind a load balancer leaves a connection idle for more than 4 minutes and it doesn't have a Keep-Alive configuration, hello connection will be dropped.</span></span> <span data-ttu-id="f75e6-147">您可以變更 hello 負載平衡器行為 tooallow [Azure 負載平衡器的較長逾時設定](../articles/load-balancer/load-balancer-tcp-idle-timeout.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-147">You can change hello load balancer behavior tooallow a [longer timeout setting for Azure load balancer](../articles/load-balancer/load-balancer-tcp-idle-timeout.md).</span></span>

<span data-ttu-id="f75e6-148">另一個考量是 hello Azure 負載平衡器所支援的通訊模式類型。</span><span class="sxs-lookup"><span data-stu-id="f75e6-148">Other consideration is hello type of distribution mode supported by Azure Load Balancer.</span></span> <span data-ttu-id="f75e6-149">您可以設定來源 IP 同質性 (來源 IP、目的地 IP) 或來源 IP 通訊協定 (來源 IP、目的地 IP 及通訊協定)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-149">You can configure source IP affinity (source IP, destination IP) or source IP protocol (source IP , destination IP and protocol).</span></span> <span data-ttu-id="f75e6-150">如需詳細資訊，請參閱 [Azure 負載平衡器分佈模式 (來源 IP 同質性)](../articles/load-balancer/load-balancer-distribution-mode.md) 。</span><span class="sxs-lookup"><span data-stu-id="f75e6-150">Check out [Azure Load Balancer distribution mode (source IP affinity)](../articles/load-balancer/load-balancer-distribution-mode.md) for more information.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f75e6-151">後續步驟</span><span class="sxs-lookup"><span data-stu-id="f75e6-151">Next steps</span></span>
<span data-ttu-id="f75e6-152">Hello 步驟 toocreate 一組負載平衡，請參閱[設定內部負載平衡集](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-152">For hello steps toocreate a load-balanced set, see [Configure an internal load-balanced set](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md).</span></span>

<span data-ttu-id="f75e6-153">如需負載平衡器的詳細資訊，請參閱 [內部負載平衡](../articles/load-balancer/load-balancer-internal-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="f75e6-153">For more information about load balancer, see [Internal load balancing](../articles/load-balancer/load-balancer-internal-overview.md).</span></span>

