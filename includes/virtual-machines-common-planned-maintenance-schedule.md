

## <a name="multi-and-single-instance-vms"></a><span data-ttu-id="2ba39-101">多重和單一執行個體 VM</span><span class="sxs-lookup"><span data-stu-id="2ba39-101">Multi and Single Instance VMs</span></span>
<span data-ttu-id="2ba39-102">許多客戶執行於 Azure 計數重大其 Vm 經歷 toohello 停機時間-因為計劃性的維護時可以排程大約 15 分鐘-，就會發生在維護期間。</span><span class="sxs-lookup"><span data-stu-id="2ba39-102">Many customers running on Azure count it critical that they can schedule when their VMs undergo planned maintenance due toohello downtime--about 15 minutes--that occurs during maintenance.</span></span> <span data-ttu-id="2ba39-103">佈建的 Vm 接收計劃性的維護時，您可以使用可用性集合 toohelp 控制項。</span><span class="sxs-lookup"><span data-stu-id="2ba39-103">You can use availability sets toohelp control when provisioned VMs receive planned maintenance.</span></span>

<span data-ttu-id="2ba39-104">有兩個可能的 VM 設定在 Azure 上執行。</span><span class="sxs-lookup"><span data-stu-id="2ba39-104">There are two possible configurations for VMs running on Azure.</span></span> <span data-ttu-id="2ba39-105">VM 可能會設定為多重執行個體或單一執行個體。</span><span class="sxs-lookup"><span data-stu-id="2ba39-105">VMs are either configured as multi-instance or single-instance.</span></span> <span data-ttu-id="2ba39-106">如果 VM 在可用性設定組中，它們會隨後設定為多重執行個體。</span><span class="sxs-lookup"><span data-stu-id="2ba39-106">If VMs are in an availability set, then they are configured as multi-instance.</span></span> <span data-ttu-id="2ba39-107">請注意，即使單一 VM 也可以部署在可用性設定組中，所以才會被視為多重執行個體。</span><span class="sxs-lookup"><span data-stu-id="2ba39-107">Note, even single VMs can be deployed in an availability set, so that they are treated as multi-instance.</span></span> <span data-ttu-id="2ba39-108">如果 VM 不在可用性設定組中，它們會隨後設定為單一執行個體。</span><span class="sxs-lookup"><span data-stu-id="2ba39-108">If VMs are NOT in an availability set, then they are configured as single-instance.</span></span>  <span data-ttu-id="2ba39-109">如需可用性設定組的詳細資訊，請參閱[管理 hello 可用性的 Windows 虛擬機器](../articles/virtual-machines/windows/manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)或[管理 hello 可用性的 Linux 虛擬機器](../articles/virtual-machines/linux/manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)。</span><span class="sxs-lookup"><span data-stu-id="2ba39-109">For details on availability sets, see [Manage hello Availability of your Windows Virtual Machines](../articles/virtual-machines/windows/manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) or [Manage hello Availability of your Linux Virtual Machines](../articles/virtual-machines/linux/manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

<span data-ttu-id="2ba39-110">規劃的維護更新 toosingle 執行個體，且多個執行個體的 Vm 會個別進行。</span><span class="sxs-lookup"><span data-stu-id="2ba39-110">Planned maintenance updates toosingle-instance and multi-instance VMs happen separately.</span></span> <span data-ttu-id="2ba39-111">藉由重新設定您的 Vm toobe 單一執行個體 （如果它們是多重執行個體） 或 toobe 多重執行個體 （如果它們是單一執行個體），您可以控制其 Vm 當收到 hello 計劃的維護。</span><span class="sxs-lookup"><span data-stu-id="2ba39-111">By reconfiguring your VMs toobe single-instance (if they are multi-instance) or toobe multi-instance (if they are single-instance), you can control when their VMs receive hello planned maintenance.</span></span> <span data-ttu-id="2ba39-112">如需 Azure VM 計劃性維護的詳細資料，請參閱 [Azure Linux 虛擬機器的維護計劃](../articles/virtual-machines/linux/planned-maintenance.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)或 [Azure Windows 虛擬機器的維護計劃](../articles/virtual-machines/windows/planned-maintenance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)。</span><span class="sxs-lookup"><span data-stu-id="2ba39-112">See [Planned maintenance for Azure Linux virtual machines](../articles/virtual-machines/linux/planned-maintenance.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or [Planned maintenance for Azure Windows virtual machines](../articles/virtual-machines/windows/planned-maintenance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) for details on planned maintenance for Azure VMs.</span></span>

## <a name="for-multi-instance-configuration"></a><span data-ttu-id="2ba39-113">對於多重執行個體組態</span><span class="sxs-lookup"><span data-stu-id="2ba39-113">For Multi-instance Configuration</span></span>
<span data-ttu-id="2ba39-114">您可以選取 hello 時間計劃性的維護，將會影響您在可用性設定組的組態中部署可用性設定組中移除這些 Vm 的 Vm。</span><span class="sxs-lookup"><span data-stu-id="2ba39-114">You can select hello time planned maintenance impacts your VMs that are deployed in an Availability Set configuration by removing these VMs from availability sets.</span></span>

1. <span data-ttu-id="2ba39-115">電子郵件會傳送 tooyou hello 計劃在多個執行個體設定的維護 tooyour Vm 之前的七個行事曆日期。</span><span class="sxs-lookup"><span data-stu-id="2ba39-115">An email is sent tooyou seven calendar days before hello planned maintenance tooyour VMs in a Multi-instance configuration.</span></span> <span data-ttu-id="2ba39-116">hello 訂用帳戶 Id 和 hello 電子郵件的 hello 主體中未包含 hello 影響多個執行個體 Vm 的名稱。</span><span class="sxs-lookup"><span data-stu-id="2ba39-116">hello subscription IDs and names of hello affected Multi-instance VMs are included in hello body of hello email.</span></span>
2. <span data-ttu-id="2ba39-117">在這些七天，您可以選擇 hello 時間將執行個體從其可用性設定組，在該區域中移除多個執行個體 Vm 會更新。</span><span class="sxs-lookup"><span data-stu-id="2ba39-117">During those seven days, you can choose hello time your instances are updated by removing your multi-instance VMs in that region from their availability set.</span></span> <span data-ttu-id="2ba39-118">這項變更的設定會導致重新開機，為 hello 虛擬機器移動從一部實體主機，以維護，不是針對維護 tooanother 實體主機為目標。</span><span class="sxs-lookup"><span data-stu-id="2ba39-118">This change in configuration causes a reboot, as hello Virtual Machine is moving from one physical host, targeted for maintenance, tooanother physical host that isn’t targeted for maintenance.</span></span>
3. <span data-ttu-id="2ba39-119">您可以從其可用性設定組中 hello Azure 入口網站移除 hello VM。</span><span class="sxs-lookup"><span data-stu-id="2ba39-119">You can remove hello VM from its availability set in hello Azure portal.</span></span>

   1. <span data-ttu-id="2ba39-120">在 hello 入口網站中，選取 hello VM tooremove 從 hello 可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="2ba39-120">In hello portal, select hello VM tooremove from hello Availability Set.</span></span>  

   2. <span data-ttu-id="2ba39-121">在 [設定] 之下，按一下 [可用性設定組]。</span><span class="sxs-lookup"><span data-stu-id="2ba39-121">Under **settings**, click **Availability set**.</span></span>

      ![可用性設定組選取](./media/virtual-machines-planned-maintenance-schedule/availabilitysetselection.png)

   3. <span data-ttu-id="2ba39-123">在 hello 可用性設定下拉式功能表中，選取 「 不屬於可用性設定組。 」</span><span class="sxs-lookup"><span data-stu-id="2ba39-123">In hello availability set dropdown menu, select “Not part of an availability set.”</span></span>

      ![從設定組移除](./media/virtual-machines-planned-maintenance-schedule/availabilitysetwarning.png)

   4. <span data-ttu-id="2ba39-125">在 hello 頂端，按一下**儲存**。</span><span class="sxs-lookup"><span data-stu-id="2ba39-125">At hello top, click **Save**.</span></span> <span data-ttu-id="2ba39-126">按一下**是**這個動作會重新啟動的 tooacknowledge hello VM。</span><span class="sxs-lookup"><span data-stu-id="2ba39-126">Click **Yes** tooacknowledge that this action restarts hello VM.</span></span>

   >[!TIP]
   ><span data-ttu-id="2ba39-127">您可以選取其中一個列出的 hello 可用性設定組稍後重新設定 hello VM toomulti 執行個體。</span><span class="sxs-lookup"><span data-stu-id="2ba39-127">You can reconfigure hello VM toomulti-instance later by selecting one of hello listed availability sets.</span></span>

4. <span data-ttu-id="2ba39-128">從可用性設定組中移除的 Vm 主機移動的 tooSingle 執行個體且 hello 計劃的維護 tooAvailability 設定組態期間未更新。</span><span class="sxs-lookup"><span data-stu-id="2ba39-128">VMs removed from availability sets are moved tooSingle-Instance hosts and are not updated during hello planned maintenance tooAvailability Set Configurations.</span></span>
5. <span data-ttu-id="2ba39-129">一旦完成 hello 更新 tooAvailability 設定 Vm （依據 tooschedule hello 原始電子郵件中所述），您應該將 hello Vm 回其可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="2ba39-129">Once hello update tooAvailability Set VMs is complete (according tooschedule outlined in hello original email), you should add hello VMs back into their availability sets.</span></span> <span data-ttu-id="2ba39-130">可用性設定組的一部分而變得重新 hello Vm 設定為多執行個體，並會導致重新開機。</span><span class="sxs-lookup"><span data-stu-id="2ba39-130">Becoming part of an Availability set reconfigures hello VMs as multi-instance, and results in a reboot.</span></span> <span data-ttu-id="2ba39-131">一般而言，一旦完成所有的多個執行個體更新 hello 整個 Azure 環境之間，單一執行個體維護遵循。</span><span class="sxs-lookup"><span data-stu-id="2ba39-131">Typically, once all multi-instance updates are completed across hello entire Azure environment, single-instance maintenance follows.</span></span>

<span data-ttu-id="2ba39-132">使用 Azure PowerShell 也可以達成從可用性設定組中移除 VM：</span><span class="sxs-lookup"><span data-stu-id="2ba39-132">Removing a VM from an availability set can also be achieved using Azure PowerShell:</span></span>

```
Get-AzureVM -ServiceName "<VmCloudServiceName>" -Name "<VmName>" | Remove-AzureAvailabilitySet | Update-AzureVM
```

## <a name="for-single-instance-configuration"></a><span data-ttu-id="2ba39-133">對於單一執行個體組態</span><span class="sxs-lookup"><span data-stu-id="2ba39-133">For Single-instance Configuration</span></span>
<span data-ttu-id="2ba39-134">您可以選取 hello 計劃性的維護，將會影響您 Vm 單一執行個體組態中將這些 Vm 新增至可用性設定組的時間。</span><span class="sxs-lookup"><span data-stu-id="2ba39-134">You can select hello time planned maintenance impacts you VMs in a Single-instance configuration by adding these VMs into availability sets.</span></span>

<span data-ttu-id="2ba39-135">逐步說明</span><span class="sxs-lookup"><span data-stu-id="2ba39-135">Step-by-step</span></span>

1. <span data-ttu-id="2ba39-136">電子郵件會傳送 tooyou hello 計劃的維護 tooVMs 單一執行個體組態中的前七個的行事曆日期。</span><span class="sxs-lookup"><span data-stu-id="2ba39-136">An email is sent tooyou seven calendar days before hello planned maintenance tooVMs in a Single-instance configuration.</span></span> <span data-ttu-id="2ba39-137">hello 訂用帳戶 Id 和 hello 電子郵件的 hello 主體中未包含的受影響的 hello 單一執行個體 Vm 的名稱。</span><span class="sxs-lookup"><span data-stu-id="2ba39-137">hello subscription IDs and names of hello affected Single-Instance VMs are included in hello body of hello email.</span></span>
2. <span data-ttu-id="2ba39-138">在這些七天，您可以選擇 hello 時間執行個體中該相同的地區設定加入您的單一執行個體 Vm tooan 可用性的重新開機。</span><span class="sxs-lookup"><span data-stu-id="2ba39-138">During those seven days, you can choose hello time your instance reboots by adding your Single-instance VMs tooan availability set in that same region.</span></span> <span data-ttu-id="2ba39-139">這項變更的設定會導致重新開機，為 hello 虛擬機器移動從一部實體主機，以維護，不是針對維護 tooanother 實體主機為目標。</span><span class="sxs-lookup"><span data-stu-id="2ba39-139">This change in configuration causes a reboot, as hello Virtual Machine is moving from one physical host, targeted for maintenance, tooanother physical host that isn’t targeted for maintenance.</span></span>
3. <span data-ttu-id="2ba39-140">請依照下列指示這裡 tooadd 現有 Vm 到使用 hello Azure 入口網站和 Azure PowerShell 的可用性設定組。</span><span class="sxs-lookup"><span data-stu-id="2ba39-140">Follow instructions here tooadd existing VMs into availability sets using hello Azure portal and Azure PowerShell.</span></span> <span data-ttu-id="2ba39-141">(請參閱 hello Azure PowerShell 範例所示步驟執行。)</span><span class="sxs-lookup"><span data-stu-id="2ba39-141">(See hello Azure PowerShell sample that follows these steps.)</span></span>
4. <span data-ttu-id="2ba39-142">一旦這些 Vm 會重新設定為多執行個體，將它們排除 hello 計劃的維護 tooSingle 執行個體 Vm。</span><span class="sxs-lookup"><span data-stu-id="2ba39-142">Once these VMs are reconfigured as Multi-instance, they are excluded from hello planned maintenance tooSingle-instance VMs.</span></span>
5. <span data-ttu-id="2ba39-143">Hello 單一執行個體 VM 更新完成之後 （依據 tooschedule hello 原始電子郵件），您可以傳回 hello Vm toosingle 執行個體，移除其可用性設定組中的 hello Vm。</span><span class="sxs-lookup"><span data-stu-id="2ba39-143">Once hello single-instance VM update completes (according tooschedule in hello original email), you can return hello VMs toosingle-instance by removing hello VMs from their availability sets.</span></span>

<span data-ttu-id="2ba39-144">新增 VM tooan 可用性設定組，也可以使用 PowerShell 來達成 Azure:</span><span class="sxs-lookup"><span data-stu-id="2ba39-144">Adding a VM tooan availability set also can be achieved using Azure PowerShell:</span></span>

    Get-AzureVM -ServiceName "<VmCloudServiceName>" -Name "<VmName>" | Set-AzureAvailabilitySet -AvailabilitySetName "<AvSetName>" | Update-AzureVM

<!--Anchors-->



<!--Link references-->
[Virtual Machines Manage Availability]: virtual-machines-windows-tutorial.md
[Understand planned versus unplanned maintenance]: virtual-machines-manage-availability.md#Understand-planned-versus-unplanned-maintenance/
